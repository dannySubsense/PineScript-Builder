<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><script data-astro-exec="">
			const url = window.location.href;
			const expectedUrl = url.replace(
				/^https:\/\/(?!beta)(\w+\.)?tradingview\.com/,
				'https://www.tradingview.com',
			);
			if (url !== expectedUrl) {
				window.location.replace(expectedUrl);
			}
		</script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="none"><link rel="icon" href="https://static.tradingview.com/static/images/favicon.ico"><link rel="icon" type="image/svg+xml" href="/pine-script-docs/favicon.svg"><title>Concepts / Time</title><meta name="og:title" content="Concepts / Time"><meta name="twitter:title" content="Concepts / Time"><meta name="description" content="Everything you need to know about Pine Script®."><meta name="og:description" content="Everything you need to know about Pine Script®."><meta name="twitter:description" content="Everything you need to know about Pine Script®."><meta name="keywords" content="tradingview, pine, script, indicators, strategies"><meta name="og:image" content="/pine-script-docs/meta-image.png?1"><meta name="twitter:image" content="/pine-script-docs/meta-image.png?1"><meta name="og:image:width" content="1200"><meta name="og:image:height" content="630"><meta name="og:url" content="https://www.tradingview.com/pine-script-docs/concepts/time/"><meta name="twitter:url" content="https://www.tradingview.com/pine-script-docs/concepts/time/"><meta name="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@TradingView"><link rel="canonical" href="https://www.tradingview.com/pine-script-docs/concepts/time/"><link rel="sitemap" href="/pine-script-docs/sitemap-index.xml"><link rel="stylesheet" href="/pine-script-docs/_astro/index.DfaRTfPD.css">
<link rel="stylesheet" href="/pine-script-docs/_astro/index.B9ah8c5K.css">
<style>.tv-spinner{display:none;position:absolute;margin:0 auto;border:0 solid rgb(149 152 161 / 20%);border-radius:50%;border-top-color:var(--tv-spinner-color, #2962ff);border-left-color:var(--tv-spinner-color, #2962ff);animation:tv-spinner-container-rotate .9s linear infinite}.tv-spinner-shown{display:block}.tv-spinner-size-large{top:calc(50% - 32px);left:calc(50% - 32px);width:56px;height:56px;border-width:4px}@keyframes tv-spinner-container-rotate{to{transform:rotate(360deg)}}:root{--page-background-color: #fff;background-color:var(--page-background-color)}:root[data-theme=dark]{--page-background-color: #000}body{background-color:var(--page-background-color)}#redirect-link{display:flex;position:absolute;inset:0;align-items:center;justify-content:center}#spinner{display:block;position:absolute;opacity:1;transition:opacity .2s}
.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}lite-vimeo{font-size:10px;background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover}lite-vimeo:after{content:"";display:block;padding-bottom:56.25%}lite-vimeo>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}lite-vimeo>.ltv-playbtn{content:"";position:absolute;inset:0;width:100%;background:transparent;outline:0;border:0;cursor:pointer}lite-vimeo>.ltv-playbtn:before{width:6.5em;height:4em;background:#172322bf;opacity:.8;border-radius:.25rem;transition:all .2s cubic-bezier(0,0,.2,1)}lite-vimeo>.ltv-playbtn:focus:before{outline:auto}lite-vimeo:hover>.ltv-playbtn:before{background-color:#00adef;background-color:var(--ltv-color, #00adef);opacity:1}lite-vimeo>.ltv-playbtn:after{border-style:solid;border-width:1em 0 1em 1.7em;border-color:transparent transparent transparent #fff}lite-vimeo>.ltv-playbtn:before,lite-vimeo>.ltv-playbtn:after{content:"";position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}lite-vimeo.ltv-activated:before,lite-vimeo.ltv-activated>.ltv-playbtn{cursor:unset;opacity:0;pointer-events:none}
</style><script type="module" src="/pine-script-docs/_astro/hoisted.wfEHaJbk.js" data-astro-exec=""></script><style id="tv-pine-light" type="text/css" media="screen">.monaco-editor-tv-pine-light { 
.mtk1 { color: #131722; }
.mtk2 { color: #ffffff; }
.mtk3 { color: #808080; }
.mtk4 { color: #ff0000; }
.mtk5 { color: #0451a5; }
.mtk6 { color: #0000ff; }
.mtk7 { color: #098658; }
.mtk8 { color: #008000; }
.mtk9 { color: #9598a1; }
.mtk10 { color: #dd0000; }
.mtk11 { color: #cc2929; }
.mtk12 { color: #f57f17; }
.mtk13 { color: #000000; }
.mtk14 { color: #383838; }
.mtk15 { color: #0c3299; }
.mtk16 { color: #2962ff; }
.mtk17 { color: #8e24aa; }
.mtk18 { color: #22ab94; }
.mtk19 { color: #cd3131; }
.mtk20 { color: #863b00; }
.mtk21 { color: #af00db; }
.mtk22 { color: #800000; }
.mtk23 { color: #e00000; }
.mtk24 { color: #3030c0; }
.mtk25 { color: #666666; }
.mtk26 { color: #778899; }
.mtk27 { color: #c700c7; }
.mtk28 { color: #a31515; }
.mtk29 { color: #388e3c; }
.mtk30 { color: #4f76ac; }
.mtk31 { color: #008080; }
.mtk32 { color: #001188; }
.mtk33 { color: #2a2e39; }
.mtk34 { color: #4864aa; }
.mtki { font-style: italic; }
.mtkb { font-weight: bold; }
.mtku { text-decoration: underline; text-underline-position: under; }
.mtks { text-decoration: line-through; }
.mtks.mtku { text-decoration: underline line-through; text-underline-position: under; } }</style></head> <body> <div id="search-content-blur" hidden=""></div> <script data-astro-exec="">
	/* eslint-disable @typescript-eslint/typedef */
	window.ThemeProvider = (() => {
		function getCurrent() {
			return (
				// eslint-disable-next-line no-restricted-syntax
				typeof localStorage !== 'undefined' &&
				localStorage.getItem('tv-docs-theme')
			);
		}
		const storedTheme = getCurrent();
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ?
				'light'
			:	'dark');
		document.documentElement.dataset.theme =
			theme === 'light' ? 'light' : 'dark';
		document.documentElement.classList.toggle(
			'theme-dark',
			theme === 'dark',
		); // add support for ui-lib themes
		document.documentElement.classList.toggle(
			'sl-theme-dark',
			theme === 'dark',
		); // add support for shoelace themes

		return {
			updatePickers(themeArg = storedTheme || 'auto') {
				let currentTheme = themeArg;
				if (currentTheme === 'unknown') {
					currentTheme = getCurrent() || 'auto';
				}
				document
					.querySelectorAll('docs-theme-select')
					.forEach((picker) => {
						const select = picker.querySelector('select');
						if (select) select.value = currentTheme;
						/** @type {HTMLTemplateElement | null} */
						const tmpl = document.querySelector(`#theme-icons`);
						const newIcon =
							tmpl &&
							tmpl.content.querySelector('.' + currentTheme);
						if (newIcon) {
							const oldIcon =
								picker.querySelector('svg.label-icon');
							if (oldIcon) {
								oldIcon.replaceChildren(
									...newIcon.cloneNode(true).childNodes,
								);
							}
						}
					});
			},
		};
	})();
	/* eslint-enable @typescript-eslint/typedef */
</script><template id="theme-icons"><svg width="16" height="16" viewBox="0 0 28 28" class="light" data-icon="theme/sun-28">  <symbol id="ai:local:theme/sun-28"><g fill="currentColor"><path d="M14 3h1.5v5H14zm0 18h1.5v5H14zm12-5.5V14h-5v1.5zM8 14v1.5H3V14zm15.3-7-1-1-3.6 3.6 1.1 1 3.5-3.5ZM9.5 18.7l1.1 1.1-3.5 3.5-1-1zM22 23.3l1-1-3.6-3.6-1 1.1 3.5 3.5ZM10.3 9.6l-1.1 1-3.5-3.5 1-1z"></path><path fill-rule="evenodd" d="M19 14.5a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m-1.5 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0" clip-rule="evenodd"></path></g></symbol><use xlink:href="#ai:local:theme/sun-28"></use>  </svg><svg width="16" height="16" viewBox="0 0 28 28" class="dark" data-icon="theme/moon-28">  <symbol id="ai:local:theme/moon-28"><path fill="currentColor" fill-rule="evenodd" d="M21 7.02A9.23 9.23 0 0 0 15.2 5 9.1 9.1 0 0 0 6 14c0 4.97 4.12 9 9.2 9a9.33 9.33 0 0 0 5.8-2.02A7 7 0 0 1 14.36 14 7 7 0 0 1 21 7.02m-3.95-.3a8 8 0 0 0-1.85-.22A7.6 7.6 0 0 0 7.5 14a7.6 7.6 0 0 0 7.7 7.5 8 8 0 0 0 1.85-.22A8.46 8.46 0 0 1 12.86 14c0-3.1 1.69-5.8 4.19-7.28" clip-rule="evenodd"></path></symbol><use xlink:href="#ai:local:theme/moon-28"></use>  </svg><svg width="16" height="16" viewBox="0 0 28 28" class="auto" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg></template> <div class="backdrop" data-mobile-menu-backdrop="" data-astro-cid-h2irkosh=""></div> <div class="menu-container" data-astro-cid-h2irkosh=""> <div class="header" data-astro-cid-h2irkosh=""> <div class="header-group" data-astro-cid-h2irkosh=""> <div id="version-select" data-astro-cid-kx7qoxgq=""> <label style="--sl-select-width: undefined; --sl-label-icon-size: 16px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Version</span>  <select value="v6" data-has-border="" no-icon="true" data-astro-cid-lmznfliq=""> <option value="v6" selected="true" data-astro-cid-lmznfliq="">Version 6</option><option value="v5" data-astro-cid-lmznfliq="">Version 5</option><option value="v4" data-astro-cid-lmznfliq="">Version 4</option><option value="v3" data-astro-cid-lmznfliq="">Version 3</option> </select> <svg width="16" height="16" viewBox="0 0 24 24" class="icon caret" data-astro-cid-lmznfliq="" data-icon="theme/down-caret">  <symbol id="ai:local:theme/down-caret"><path fill="currentColor" d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1 1 0 0 0 1.42 0L17 10.59a1 1 0 0 0 0-1.42"></path></symbol><use xlink:href="#ai:local:theme/down-caret"></use>  </svg> </label>  </div>   <docs-theme-select class="" data-astro-cid-3wpspbi7=""> <label style="--sl-select-width: 48px; --sl-label-icon-size: 28px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Theme</span> <svg width="28" height="28" viewBox="0 0 28 28" class="icon label-icon" data-button="" data-round="" data-astro-cid-lmznfliq="" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg> <select value="auto" data-button="" data-astro-cid-lmznfliq=""> <option value="dark" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Dark&nbsp;&nbsp;</option><option value="light" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Light&nbsp;&nbsp;</option><option value="auto" selected="true" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Auto&nbsp;&nbsp;</option> </select>  </label>  </docs-theme-select>   <script data-astro-exec="">
	ThemeProvider.updatePickers('unknown');
</script>  </div> <div class="header-group" data-astro-cid-h2irkosh="">  <div class="not-content" style="stroke-width:2px" data-astro-cid-pkzv2hgs=""> <button id="mobile-menu-back-button" title="Close menu" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-primary stvb-icon">  <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-h2irkosh="" data-icon="theme/arrow-back">  <symbol id="ai:local:theme/arrow-back"><g fill="none"><g clip-path="url(#a)"><path stroke="var(--arrow-fill-color, #131722)" d="m17 20-6-6 6-6"></path></g><defs><clipPath id="a"><path fill="#fff" d="M28 28H0V0h28z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/arrow-back"></use>  </svg>  </button> </div>  </div> </div> <aside id="nav" class="keep-visible" style="--navbar-right-border-width: 0px" data-astro-cid-sa57sq6l=""> <div class="sidebar-viewport slick-scroll" data-astro-cid-sa57sq6l=""> <div class="sidebar" data-mobile="" data-astro-cid-sa57sq6l=""> <ul class="toc" aria-label="Docs sidebar" data-astro-cid-sa57sq6l=""> <li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/welcome" data-astro-cid-omxx3dey="">Welcome to Pine Script® v6</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Pine Script® primer</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-steps" data-astro-cid-omxx3dey="">First steps</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-indicator" data-astro-cid-omxx3dey="">First indicator</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/next-steps" data-astro-cid-omxx3dey="">Next steps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Language</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/execution-model" data-astro-cid-omxx3dey="">Execution model</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/type-system" data-astro-cid-omxx3dey="">Type system</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/script-structure" data-astro-cid-omxx3dey="">Script structure</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/identifiers" data-astro-cid-omxx3dey="">Identifiers</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/variable-declarations" data-astro-cid-omxx3dey="">Variable declarations</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/operators" data-astro-cid-omxx3dey="">Operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/conditional-structures" data-astro-cid-omxx3dey="">Conditional structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/loops" data-astro-cid-omxx3dey="">Loops</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/built-ins" data-astro-cid-omxx3dey="">Built-ins</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/user-defined-functions" data-astro-cid-omxx3dey="">User-defined functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/objects" data-astro-cid-omxx3dey="">Objects</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/enums" data-astro-cid-omxx3dey="">Enums</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/methods" data-astro-cid-omxx3dey="">Methods</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/arrays" data-astro-cid-omxx3dey="">Arrays</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/matrices" data-astro-cid-omxx3dey="">Matrices</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/maps" data-astro-cid-omxx3dey="">Maps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Visuals</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/backgrounds" data-astro-cid-omxx3dey="">Backgrounds</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-coloring" data-astro-cid-omxx3dey="">Bar coloring</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-plotting" data-astro-cid-omxx3dey="">Bar plotting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/colors" data-astro-cid-omxx3dey="">Colors</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/fills" data-astro-cid-omxx3dey="">Fills</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/levels" data-astro-cid-omxx3dey="">Levels</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/lines-and-boxes" data-astro-cid-omxx3dey="">Lines and boxes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/plots" data-astro-cid-omxx3dey="">Plots</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/tables" data-astro-cid-omxx3dey="">Tables</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/text-and-shapes" data-astro-cid-omxx3dey="">Text and shapes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details open="" data-is-parent="" data-is-on-path="" data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Concepts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/bar-states" data-astro-cid-omxx3dey="">Bar states</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/chart-information" data-astro-cid-omxx3dey="">Chart information</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/inputs" data-astro-cid-omxx3dey="">Inputs</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/libraries" data-astro-cid-omxx3dey="">Libraries</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/non-standard-charts-data" data-astro-cid-omxx3dey="">Non-standard charts data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/other-timeframes-and-data" data-astro-cid-omxx3dey="">Other timeframes and data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/repainting" data-astro-cid-omxx3dey="">Repainting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/sessions" data-astro-cid-omxx3dey="">Sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strings" data-astro-cid-omxx3dey="">Strings</a></li><li class="item" data-current="" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/time" data-astro-cid-omxx3dey="">Time</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/timeframes" data-astro-cid-omxx3dey="">Timeframes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Writing scripts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/style-guide" data-astro-cid-omxx3dey="">Style guide</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/debugging" data-astro-cid-omxx3dey="">Debugging</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/profiling-and-optimization" data-astro-cid-omxx3dey="">Profiling and optimization</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/publishing" data-astro-cid-omxx3dey="">Publishing scripts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/limitations" data-astro-cid-omxx3dey="">Limitations</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">FAQ</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/general" data-astro-cid-omxx3dey="">General</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/data-structures" data-astro-cid-omxx3dey="">Data structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/functions" data-astro-cid-omxx3dey="">Functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/indicators" data-astro-cid-omxx3dey="">Indicators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/other-data-and-timeframes" data-astro-cid-omxx3dey="">Other data and timeframes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/programming" data-astro-cid-omxx3dey="">Programming</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strings-and-formatting" data-astro-cid-omxx3dey="">Strings and formatting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/techniques" data-astro-cid-omxx3dey="">Techniques</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/times-dates-and-sessions" data-astro-cid-omxx3dey="">Times, dates, and sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/variables-and-operators" data-astro-cid-omxx3dey="">Variables and operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/visuals" data-astro-cid-omxx3dey="">Visuals</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/error-messages" data-astro-cid-omxx3dey="">Error messages</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/release-notes" data-astro-cid-omxx3dey="">Release notes</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Migration guides</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-6" data-astro-cid-omxx3dey="">To Pine Script® version 6</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-5" data-astro-cid-omxx3dey="">To Pine Script® version 5</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-4" data-astro-cid-omxx3dey="">To Pine Script® version 4</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-3" data-astro-cid-omxx3dey="">To Pine Script® version 3</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-2" data-astro-cid-omxx3dey="">To Pine Script® version 2</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/where-can-i-get-more-information" data-astro-cid-omxx3dey="">Where can I get more information?</a></li> </ul> <div class="toc-bottom" data-astro-cid-sa57sq6l=""></div> </div> </div> </aside>  </div>   <header class="header" data-astro-cid-d74r2unp=""> <nav role="navigation" aria-label="Main Navigation" data-astro-cid-d74r2unp=""> <mobile-menu-button id="mobile-menu-button-wc" data-astro-cid-oojooh3d=""> <!-- Annoyingly I need to wrap this. TODO: improve this --> <div id="mobile-menu-button-header" data-astro-cid-oojooh3d=""> <div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <button title="Open navigation menu" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-secondary stvb-icon stvb-icon-force-color stvb-force-no-border">  <svg width="28" height="28" viewBox="0 0 24 24" data-astro-cid-oojooh3d="" data-icon="theme/bars">  <symbol id="ai:local:theme/bars"><path fill="currentColor" d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2m18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2m0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2"></path></symbol><use xlink:href="#ai:local:theme/bars"></use>  </svg>  </button> </div>  </div> </mobile-menu-button>   <div data-hide-when-search="" data-astro-cid-d74r2unp=""> <div class="header-logo" data-astro-cid-tycb33lk=""> <a href="/pine-script-docs/" aria-label="Home button" data-astro-cid-tycb33lk=""> <div class="documentation-logo logo" data-astro-cid-tycb33lk=""><!-- Old Christmas icon -->
<!-- 
<svg width="184" height="44" viewBox="0 0 184 44" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M33.8209 5.1219C33.885 4.95937 34.115 4.95937 34.1791 5.1219L35.2253 7.77465L37.8781 8.82088C38.0406 8.88499 38.0406 9.11501 37.8781 9.17912L35.2253 10.2253L34.1791 12.8781C34.115 13.0406 33.885 13.0406 33.8209 12.8781L32.7747 10.2253L30.1219 9.17912C29.9594 9.11501 29.9594 8.88499 30.1219 8.82088L32.7747 7.77465L33.8209 5.1219Z" fill="#F9A825"/>
    <path d="M5.30092 15.1478C5.37479 14.9605 5.63986 14.9605 5.71373 15.1478L6.60557 17.4091L8.86685 18.3009C9.05415 18.3748 9.05415 18.6399 8.86685 18.7137L6.60557 19.6056L5.71373 21.8669C5.63986 22.0541 5.37479 22.0541 5.30092 21.8669L4.40908 19.6056L2.1478 18.7137C1.9605 18.6399 1.9605 18.3748 2.1478 18.3009L4.40908 17.4091L5.30092 15.1478Z" fill="#F9A825"/>
    <path d="M11.8231 3.12041C11.8864 2.95986 12.1136 2.95986 12.1769 3.12041L12.9414 5.05865L14.8796 5.82308C15.0401 5.8864 15.0401 6.1136 14.8796 6.17692L12.9414 6.94135L12.1769 8.87959C12.1136 9.04014 11.8864 9.04014 11.8231 8.87959L11.0586 6.94135L9.12041 6.17692C8.95986 6.1136 8.95986 5.8864 9.12041 5.82308L11.0586 5.05865L11.8231 3.12041Z" fill="#F9A825"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.6478 7.35459L34.7627 21.6923C35.1531 22.1543 35.0472 22.8544 34.5376 23.1802L26.9989 28.0001L18.4281 20.7531L11.3382 23.2611C10.402 23.5923 9.60771 22.5041 10.2085 21.7134L21.0877 7.39502C21.4749 6.88536 22.2346 6.86567 22.6478 7.35459ZM33.432 28.0842L38.3592 34.7471C38.7427 35.2657 38.3724 36 37.7274 36H6.27248C5.62746 36 5.25722 35.2657 5.64074 34.7471L10.8523 27.6996C10.9484 27.5697 11.0822 27.4725 11.2356 27.4214L17.6878 25.2707C17.9285 25.1904 18.1932 25.2314 18.3984 25.3806L26.2854 31.1166C26.5445 31.3051 26.8922 31.3173 27.1639 31.1475L32.3838 27.885C32.7316 27.6677 33.1881 27.7544 33.432 28.0842Z" fill="#089981"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6363 11.9375C20.7386 12.451 23.1213 11.505 24.9187 10.0422L25.8869 11.1881C23.6236 13.0379 20.553 14.1584 16.6261 13.267L17.6363 11.9375ZM34.0572 20.8573C30.0669 21.363 26.2864 20.8179 23.1264 19.7076C20.7393 18.8689 18.6873 17.7013 17.155 16.3997C16.5283 15.8674 15.9767 15.3021 15.5241 14.7174L16.4708 13.4713C16.8706 14.0544 17.4225 14.6588 18.1262 15.2565C19.5001 16.4237 21.3856 17.5061 23.6236 18.2924C26.3235 19.241 29.5087 19.7493 32.8863 19.4716L34.0572 20.8573ZM9.06812 30.1123C15.4775 33.3909 23.0493 33.8897 29.0345 32.0941C31.0827 31.4796 32.9275 30.6019 34.4713 29.4897L35.3633 30.6959C33.6586 31.9268 31.6497 32.8756 29.4655 33.5309C23.053 35.4546 14.9758 34.8964 8.16479 31.3339L9.06812 30.1123Z" fill="#45E5CB"/>
    <path d="M55.56 13.96C59.016 13.96 61.536 16.456 61.536 19.696C61.536 22.936 59.016 25.432 55.56 25.432H53.376V31H49.896V13.96H55.56ZM55.512 22.168C57.096 22.168 58.152 21.088 58.152 19.696C58.152 18.304 57.096 17.224 55.512 17.224H53.376V22.168H55.512ZM66.8636 14.944C66.8636 16.096 65.9276 17.032 64.7516 17.032C63.6236 17.032 62.6636 16.096 62.6636 14.944C62.6636 13.792 63.6236 12.856 64.7516 12.856C65.9276 12.856 66.8636 13.792 66.8636 14.944ZM63.1196 31V19H66.4076V31H63.1196ZM69.0849 31V19H72.3729V20.368C72.9969 19.408 74.2449 18.736 75.8049 18.736C78.7089 18.736 80.4369 20.848 80.4369 23.968V31H77.1489V24.52C77.1489 22.792 76.4049 21.736 75.0369 21.736C73.5249 21.736 72.3729 22.84 72.3729 25.144V31H69.0849ZM82.2041 25C82.2041 21.448 84.8681 18.736 88.5161 18.736C91.6601 18.736 94.4201 20.752 94.4201 24.64C94.4201 24.928 94.4201 25.264 94.3721 25.768H85.3961C85.5881 27.376 87.0041 28.264 88.5881 28.264C90.0761 28.264 91.1561 27.568 91.6841 26.752L94.1321 28.576C93.0281 30.184 91.0841 31.264 88.5641 31.264C84.9881 31.264 82.2041 28.792 82.2041 25ZM88.4201 21.448C87.1961 21.448 85.8281 22.072 85.5161 23.536H91.1321C90.8441 22.12 89.6441 21.448 88.4201 21.448ZM100.412 28.24L103.076 26.008C103.916 27.28 105.38 28.024 106.772 28.024C108.14 28.024 109.052 27.352 109.052 26.368C109.052 25.408 108.356 24.736 106.676 24.16L105.236 23.656C102.5 22.696 101.036 21.112 101.036 18.784C101.036 15.568 103.484 13.672 106.796 13.672C108.884 13.672 110.708 14.392 112.172 16.024L109.868 18.4C109.052 17.416 107.996 16.936 106.82 16.936C105.644 16.936 104.54 17.44 104.54 18.448C104.54 19.48 105.38 19.936 107.18 20.584L108.548 21.088C111.044 22 112.604 23.584 112.604 26.152C112.58 29.2 110.156 31.288 106.628 31.288C103.916 31.288 101.636 30.112 100.412 28.24ZM125.859 27.808C124.827 29.872 122.667 31.264 120.171 31.264C116.619 31.264 113.811 28.624 113.811 25C113.811 21.376 116.619 18.736 120.171 18.736C122.667 18.736 124.827 20.128 125.859 22.192L123.003 23.728C122.523 22.624 121.491 21.808 120.171 21.808C118.443 21.808 117.123 23.152 117.123 25C117.123 26.848 118.443 28.192 120.171 28.192C121.491 28.192 122.523 27.376 123.003 26.272L125.859 27.808ZM127.482 31V19H130.77V20.92C131.178 19.744 132.402 18.856 133.746 18.856C134.082 18.856 134.442 18.88 134.85 19V22.336C134.346 22.168 133.89 22.072 133.362 22.072C131.802 22.072 130.77 23.296 130.77 25.264V31H127.482ZM140.215 14.944C140.215 16.096 139.279 17.032 138.103 17.032C136.975 17.032 136.015 16.096 136.015 14.944C136.015 13.792 136.975 12.856 138.103 12.856C139.279 12.856 140.215 13.792 140.215 14.944ZM136.471 31V19H139.759V31H136.471ZM142.436 36.016V19H145.724V20.344C146.276 19.576 147.548 18.736 149.204 18.736C152.396 18.736 154.844 21.592 154.844 25C154.844 28.408 152.396 31.264 149.204 31.264C147.548 31.264 146.276 30.424 145.724 29.656V36.016H142.436ZM151.508 25C151.508 23.128 150.284 21.736 148.484 21.736C146.684 21.736 145.46 23.128 145.46 25C145.46 26.872 146.684 28.264 148.484 28.264C150.284 28.264 151.508 26.872 151.508 25ZM164.407 30.88C163.879 31.048 163.231 31.144 162.319 31.144C159.775 31.144 157.735 29.728 157.735 26.8V21.88H155.311V19H157.735V15.664H161.023V19H164.407V21.88H161.023V26.152C161.023 27.616 161.647 28.192 163.063 28.192C163.591 28.192 164.023 28.12 164.407 27.976V30.88ZM173.626 22.648V13.96H175.978L177.874 16.888L179.746 13.96H182.122V22.648H179.698V18.184L177.874 20.968L176.026 18.136V22.648H173.626ZM167.386 22.648V16.456H165.058V13.96H172.258V16.456H169.93V22.648H167.386Z" fill="currentColor"/>
</svg> -->



<!-- Regular icon -->

<svg width="177" height="44" viewBox="0 0 177 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.6876 25.2705C17.9283 25.1902 18.1933 25.2316 18.3985 25.3808L26.2852 31.1162C26.5444 31.3047 26.8924 31.3173 27.1641 31.1474L32.3839 27.8847C32.7316 27.6675 33.1878 27.7545 33.4317 28.084L38.3594 34.7471C38.7428 35.2656 38.3725 35.9999 37.7276 36H6.27253C5.62754 36 5.25723 35.2657 5.64069 34.7471L10.8526 27.6992C10.9486 27.5695 11.0824 27.4729 11.2354 27.4219L17.6876 25.2705ZM21.088 7.39451C21.4752 6.88532 22.2345 6.8659 22.6475 7.35448L34.7628 21.6924C35.1531 22.1544 35.0468 22.8548 34.5372 23.1806L26.9991 28L18.4278 20.7529L11.338 23.2607C10.4021 23.5917 9.60809 22.5044 10.2081 21.7139L21.088 7.39451ZM13.8243 20.2597L17.7608 18.8672C18.4309 18.6301 19.1771 18.7667 19.7198 19.2256L27.1641 25.5205L32.4981 22.1103L21.9259 9.59862L13.8243 20.2597Z" fill="currentColor"></path>
<path d="M147.308 16.959C150.499 16.959 152.948 19.8149 152.948 23.2227C152.948 26.6307 150.5 29.4873 147.308 29.4873C145.652 29.4872 144.38 28.6469 143.828 27.8789V34.2393H140.54V17.2227H143.828V18.5674C144.38 17.7994 145.652 16.9591 147.308 16.959ZM104.9 11.8955C106.988 11.8956 108.812 12.6152 110.276 14.2471L107.972 16.623C107.156 15.6392 106.1 15.1592 104.924 15.1592C103.748 15.1592 102.645 15.6631 102.645 16.6709C102.645 17.7029 103.484 18.1596 105.284 18.8076L106.652 19.3115C109.148 20.2235 110.708 21.8072 110.708 24.375C110.684 27.4229 108.26 29.5106 104.732 29.5107C102.02 29.5107 99.7396 28.3349 98.5156 26.4629L101.18 24.2314C102.02 25.5034 103.484 26.247 104.876 26.2471C106.244 26.2471 107.156 25.5748 107.156 24.5908C107.156 23.631 106.46 22.9587 104.78 22.3828L103.34 21.8789C100.604 20.9189 99.1396 19.3348 99.1396 17.0068C99.1398 13.791 101.588 11.8955 104.9 11.8955ZM86.6201 16.959C89.7641 16.959 92.5244 18.9753 92.5244 22.8633C92.5244 23.1513 92.5246 23.4873 92.4766 23.9912H83.5C83.692 25.5992 85.1084 26.4873 86.6924 26.4873C88.18 26.4872 89.26 25.7914 89.7881 24.9756L92.2363 26.7988C91.1323 28.4068 89.188 29.4873 86.668 29.4873C83.092 29.4872 80.3086 27.0146 80.3086 23.2227C80.3088 19.6709 82.9723 16.959 86.6201 16.959ZM118.275 16.959C120.771 16.9591 122.931 18.3512 123.963 20.415L121.107 21.9512C120.627 20.8473 119.595 20.0314 118.275 20.0312C116.548 20.0312 115.227 21.3749 115.227 23.2227C115.227 25.0707 116.547 26.415 118.275 26.415C119.595 26.4149 120.627 25.599 121.107 24.4951L123.963 26.0312C122.931 28.0951 120.771 29.4872 118.275 29.4873C114.723 29.4873 111.915 26.8467 111.915 23.2227C111.915 19.5989 114.724 16.959 118.275 16.959ZM159.127 17.2227H162.511V20.1035H159.127V24.375C159.127 25.839 159.751 26.415 161.167 26.415C161.695 26.415 162.127 26.3432 162.511 26.1992V29.1035C161.983 29.2715 161.335 29.3672 160.423 29.3672C157.879 29.3672 155.839 27.9512 155.839 25.0234V20.1035H153.415V17.2227H155.839V13.8867H159.127V17.2227ZM53.6641 12.1836C57.12 12.1836 59.6395 14.6791 59.6396 17.9189C59.6396 21.1589 57.12 23.6552 53.6641 23.6553H51.4805V29.2227H48V12.1836H53.6641ZM64.5117 29.2227H61.2236V17.2227H64.5117V29.2227ZM73.9092 16.959C76.813 16.9591 78.541 19.0715 78.541 22.1914V29.2227H75.2529V22.7432C75.2529 21.0152 74.5086 19.959 73.1406 19.959C71.6288 19.9591 70.4766 21.0633 70.4766 23.3672V29.2227H67.1885V17.2227H70.4766V18.5908C71.1006 17.6308 72.3492 16.959 73.9092 16.959ZM131.85 17.0791C132.186 17.0791 132.546 17.1027 132.954 17.2227V20.5596C132.45 20.3916 131.994 20.2949 131.466 20.2949C129.906 20.2949 128.874 21.5193 128.874 23.4873V29.2227H125.586V17.2227H128.874V19.1436C129.282 17.9676 130.506 17.0792 131.85 17.0791ZM137.862 29.2227H134.574V17.2227H137.862V29.2227ZM146.588 19.959C144.788 19.959 143.564 21.3509 143.563 23.2227C143.563 25.0947 144.788 26.4873 146.588 26.4873C148.388 26.4873 149.612 25.0947 149.612 23.2227C149.612 21.3509 148.388 19.959 146.588 19.959ZM169.993 9.76074C170.876 9.76079 171.697 9.9237 172.455 10.25C173.213 10.5764 173.881 11.0326 174.457 11.6182C175.043 12.1942 175.499 12.8617 175.825 13.6201C176.151 14.3783 176.314 15.1991 176.314 16.082C176.314 16.9556 176.152 17.7769 175.825 18.5449C175.499 19.3032 175.043 19.975 174.457 20.5605C173.881 21.1365 173.208 21.5877 172.44 21.9141C171.682 22.2404 170.867 22.4042 169.993 22.4043C169.12 22.4043 168.298 22.2405 167.53 21.9141C166.772 21.5877 166.1 21.1365 165.515 20.5605C164.939 19.975 164.488 19.3032 164.161 18.5449C163.835 17.7769 163.671 16.9556 163.671 16.082C163.671 15.2086 163.835 14.393 164.161 13.6348C164.488 12.8668 164.939 12.1942 165.515 11.6182C166.1 11.0327 166.772 10.5764 167.53 10.25C168.298 9.92362 169.12 9.76074 169.993 9.76074ZM86.5244 19.6709C85.3005 19.6709 83.9323 20.295 83.6201 21.7588H89.2363C88.9482 20.3431 87.7482 19.671 86.5244 19.6709ZM169.993 11.1865C169.312 11.1865 168.672 11.3109 168.077 11.5605C167.492 11.8101 166.974 12.1612 166.522 12.6123C166.071 13.0635 165.72 13.5865 165.471 14.1816C165.221 14.7671 165.097 15.4006 165.097 16.082C165.097 16.7634 165.221 17.402 165.471 17.9971C165.72 18.5827 166.071 19.1015 166.522 19.5527C166.974 20.0038 167.492 20.3539 168.077 20.6035C168.672 20.8531 169.312 20.9785 169.993 20.9785C170.675 20.9785 171.308 20.8531 171.894 20.6035C172.489 20.3539 173.012 20.0038 173.463 19.5527C173.914 19.1015 174.265 18.5827 174.515 17.9971C174.764 17.402 174.889 16.7634 174.889 16.082C174.889 15.4006 174.764 14.7671 174.515 14.1816C174.265 13.5865 173.914 13.0635 173.463 12.6123C173.012 12.1611 172.489 11.8101 171.894 11.5605C171.308 11.311 170.675 11.1866 169.993 11.1865ZM51.4805 20.3916H53.6162C55.2001 20.3915 56.2559 19.3109 56.2559 17.9189C56.2558 16.5271 55.2 15.4474 53.6162 15.4473H51.4805V20.3916ZM169.878 13.2314C170.406 13.2315 170.838 13.2932 171.174 13.418C171.519 13.5332 171.773 13.7163 171.937 13.9658C172.1 14.2154 172.182 14.5271 172.182 14.9014C172.182 15.2469 172.09 15.5494 171.908 15.8086C171.726 16.0581 171.481 16.2646 171.174 16.4277L172.815 18.9336H171.217L169.964 16.8027H169.445V18.9336H168.034V13.2314H169.878ZM169.445 15.751H169.849C170.127 15.751 170.348 15.6932 170.511 15.5781C170.674 15.4533 170.756 15.247 170.756 14.959C170.756 14.7383 170.684 14.5703 170.54 14.4551C170.396 14.3399 170.165 14.2822 169.849 14.2822H169.445V15.751ZM62.8555 11.0791C64.0314 11.0791 64.9677 12.0151 64.9678 13.167C64.9678 14.319 64.0315 15.2549 62.8555 15.2549C61.7275 15.2548 60.7676 14.3189 60.7676 13.167C60.7677 12.0151 61.7276 11.0792 62.8555 11.0791ZM136.207 11.0791C137.383 11.0793 138.318 12.0152 138.318 13.167C138.318 14.3188 137.383 15.2546 136.207 15.2549C135.079 15.2549 134.118 14.319 134.118 13.167C134.118 12.0151 135.079 11.0791 136.207 11.0791Z" fill="currentColor"></path>
</svg>
</div> </a> </div>  </div> <div class="flex" data-astro-cid-d74r2unp=""></div> <div class="flex" data-astro-cid-d74r2unp=""> <div class="search-container" data-astro-cid-fg37foga=""> <div class="search-wrapper" data-astro-cid-fg37foga=""> <input class="search-input" type="text" placeholder="Search docs" name="s" value="" data-astro-cid-fg37foga="" data-has-input-listener="true"> <svg width="28" height="28" viewBox="0 0 28 28" class="search-button" data-astro-cid-fg37foga="" data-icon="theme/search">  <symbol id="ai:local:theme/search"><path fill="currentColor" fill-rule="evenodd" d="M18.5 12.5a6 6 0 1 1-12 0 6 6 0 0 1 12 0m-1.25 5.8a7.5 7.5 0 1 1 1.06-1.06l4.22 4.23.53.53L22 23.06l-.53-.53-4.22-4.22Z" clip-rule="evenodd"></path></symbol><use xlink:href="#ai:local:theme/search"></use>  </svg> <button class="search-clear" type="button" title="Reset" data-search-clear="" data-astro-cid-fg37foga="">Clear</button> <span class="divider" data-astro-cid-fg37foga=""></span> <button class="search-close" type="button" title="Close" data-search-close="" data-astro-cid-fg37foga=""> <svg width="18" height="18" viewBox="0 0 18 18" data-astro-cid-fg37foga="" data-icon="theme/cross-18">  <use xlink:href="#ai:local:theme/cross-18"></use>  </svg> </button> </div> <div id="search-results-wrapper" data-astro-cid-fg37foga=""> <aside id="search-results" hidden="" data-astro-cid-fg37foga="" data-has-button-listener="true"> <!-- Don't use h1 because when built it will be used as the first heading on the page --> <div class="heading" data-astro-cid-fg37foga="">Search results</div> <div id="search-results-contents" data-astro-cid-fg37foga=""></div> </aside> </div> </div>   </div> <ul class="links" data-astro-cid-d74r2unp="">  </ul> <div class="flex" data-astro-cid-d74r2unp=""></div> <div data-hide-when-search="" data-astro-cid-d74r2unp=""> <div id="version-select" data-hideable="true" data-astro-cid-kx7qoxgq=""> <label style="--sl-select-width: undefined; --sl-label-icon-size: 16px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Version</span>  <select value="v6" data-has-border="" no-icon="true" data-astro-cid-lmznfliq=""> <option value="v6" selected="true" data-astro-cid-lmznfliq="">Version 6</option><option value="v5" data-astro-cid-lmznfliq="">Version 5</option><option value="v4" data-astro-cid-lmznfliq="">Version 4</option><option value="v3" data-astro-cid-lmznfliq="">Version 3</option> </select> <svg width="16" height="16" viewBox="0 0 24 24" class="icon caret" data-astro-cid-lmznfliq="" data-icon="theme/down-caret">  <use xlink:href="#ai:local:theme/down-caret"></use>  </svg> </label>  </div>   </div> <button id="search-button" data-astro-cid-6zeqadij="" data-has-listener="true"> <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-6zeqadij="" data-icon="theme/search">  <use xlink:href="#ai:local:theme/search"></use>  </svg> </button>  <script data-base-url="/pine-script-docs" data-astro-exec="">
	async function loadPageFind() {
		const base = document.currentScript.getAttribute('data-base-url');
		const pageFindBundleUrl = `${base}/pagefind/`;
		const pagefind = await import(`${pageFindBundleUrl}pagefind.js`);
		await pagefind.options({
			bundlePath: pageFindBundleUrl,
		});
		window.pagefind = pagefind;
	}
	loadPageFind().catch();
</script>  <docs-theme-select class="hide-with-breakpoint-568" data-astro-cid-3wpspbi7=""> <label style="--sl-select-width: 48px; --sl-label-icon-size: 28px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Theme</span> <svg width="28" height="28" viewBox="0 0 28 28" class="icon label-icon" data-button="" data-round="" data-astro-cid-lmznfliq="" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg> <select value="auto" data-button="" data-astro-cid-lmznfliq=""> <option value="dark" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Dark&nbsp;&nbsp;</option><option value="light" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Light&nbsp;&nbsp;</option><option value="auto" selected="true" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Auto&nbsp;&nbsp;</option> </select>  </label>  </docs-theme-select>   <script data-astro-exec="">
	ThemeProvider.updatePickers('unknown');
</script>  </nav> </header>        <div id="image-lightbox" class="not-content" hidden="" data-astro-cid-kws7taxh=""> <div class="button-wrapper" data-astro-cid-kws7taxh=""> <div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <button id="lightbox-close-button" title="Close image preview" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-black stvb-medium stvb-secondary stvb-icon stvb-force-no-border">  <svg width="24" height="24" viewBox="0 0 18 18" data-astro-cid-kws7taxh="" data-icon="theme/cross-18">  <symbol id="ai:local:theme/cross-18"><g fill="none"><g clip-path="url(#a)"><path fill="currentColor" fill-rule="evenodd" d="M5.53 4.47 4.47 5.53 7.94 9l-3.47 3.47 1.06 1.06L9 10.06l3.47 3.47 1.06-1.06L10.06 9l3.47-3.47-1.06-1.06L9 7.94z" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h18v18H0z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/cross-18"></use>  </svg>  </button> </div>  </div> <img id="lightbox-image" src="" data-astro-cid-kws7taxh=""> </div>   <div id="page-container" data-astro-cid-xgirumru=""> <aside id="nav" class="" style="" data-astro-cid-sa57sq6l=""> <div class="sidebar-viewport slick-scroll" data-astro-cid-sa57sq6l=""> <div class="sidebar" data-astro-cid-sa57sq6l=""> <ul class="toc" aria-label="Docs sidebar" data-astro-cid-sa57sq6l=""> <li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/welcome" data-astro-cid-omxx3dey="">Welcome to Pine Script® v6</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Pine Script® primer</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <symbol id="ai:local:theme/right-caret"><path fill="currentColor" d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1 1 0 0 0 0-1.42"></path></symbol><use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-steps" data-astro-cid-omxx3dey="">First steps</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-indicator" data-astro-cid-omxx3dey="">First indicator</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/next-steps" data-astro-cid-omxx3dey="">Next steps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Language</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/execution-model" data-astro-cid-omxx3dey="">Execution model</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/type-system" data-astro-cid-omxx3dey="">Type system</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/script-structure" data-astro-cid-omxx3dey="">Script structure</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/identifiers" data-astro-cid-omxx3dey="">Identifiers</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/variable-declarations" data-astro-cid-omxx3dey="">Variable declarations</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/operators" data-astro-cid-omxx3dey="">Operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/conditional-structures" data-astro-cid-omxx3dey="">Conditional structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/loops" data-astro-cid-omxx3dey="">Loops</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/built-ins" data-astro-cid-omxx3dey="">Built-ins</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/user-defined-functions" data-astro-cid-omxx3dey="">User-defined functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/objects" data-astro-cid-omxx3dey="">Objects</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/enums" data-astro-cid-omxx3dey="">Enums</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/methods" data-astro-cid-omxx3dey="">Methods</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/arrays" data-astro-cid-omxx3dey="">Arrays</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/matrices" data-astro-cid-omxx3dey="">Matrices</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/maps" data-astro-cid-omxx3dey="">Maps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Visuals</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/backgrounds" data-astro-cid-omxx3dey="">Backgrounds</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-coloring" data-astro-cid-omxx3dey="">Bar coloring</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-plotting" data-astro-cid-omxx3dey="">Bar plotting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/colors" data-astro-cid-omxx3dey="">Colors</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/fills" data-astro-cid-omxx3dey="">Fills</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/levels" data-astro-cid-omxx3dey="">Levels</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/lines-and-boxes" data-astro-cid-omxx3dey="">Lines and boxes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/plots" data-astro-cid-omxx3dey="">Plots</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/tables" data-astro-cid-omxx3dey="">Tables</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/text-and-shapes" data-astro-cid-omxx3dey="">Text and shapes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details open="" data-is-parent="" data-is-on-path="" data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Concepts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/bar-states" data-astro-cid-omxx3dey="">Bar states</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/chart-information" data-astro-cid-omxx3dey="">Chart information</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/inputs" data-astro-cid-omxx3dey="">Inputs</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/libraries" data-astro-cid-omxx3dey="">Libraries</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/non-standard-charts-data" data-astro-cid-omxx3dey="">Non-standard charts data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/other-timeframes-and-data" data-astro-cid-omxx3dey="">Other timeframes and data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/repainting" data-astro-cid-omxx3dey="">Repainting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/sessions" data-astro-cid-omxx3dey="">Sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strings" data-astro-cid-omxx3dey="">Strings</a></li><li class="item" data-current="" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/time" data-astro-cid-omxx3dey="">Time</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/timeframes" data-astro-cid-omxx3dey="">Timeframes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Writing scripts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/style-guide" data-astro-cid-omxx3dey="">Style guide</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/debugging" data-astro-cid-omxx3dey="">Debugging</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/profiling-and-optimization" data-astro-cid-omxx3dey="">Profiling and optimization</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/publishing" data-astro-cid-omxx3dey="">Publishing scripts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/limitations" data-astro-cid-omxx3dey="">Limitations</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">FAQ</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/general" data-astro-cid-omxx3dey="">General</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/data-structures" data-astro-cid-omxx3dey="">Data structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/functions" data-astro-cid-omxx3dey="">Functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/indicators" data-astro-cid-omxx3dey="">Indicators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/other-data-and-timeframes" data-astro-cid-omxx3dey="">Other data and timeframes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/programming" data-astro-cid-omxx3dey="">Programming</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strings-and-formatting" data-astro-cid-omxx3dey="">Strings and formatting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/techniques" data-astro-cid-omxx3dey="">Techniques</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/times-dates-and-sessions" data-astro-cid-omxx3dey="">Times, dates, and sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/variables-and-operators" data-astro-cid-omxx3dey="">Variables and operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/visuals" data-astro-cid-omxx3dey="">Visuals</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/error-messages" data-astro-cid-omxx3dey="">Error messages</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/release-notes" data-astro-cid-omxx3dey="">Release notes</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Migration guides</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-6" data-astro-cid-omxx3dey="">To Pine Script® version 6</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-5" data-astro-cid-omxx3dey="">To Pine Script® version 5</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-4" data-astro-cid-omxx3dey="">To Pine Script® version 4</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-3" data-astro-cid-omxx3dey="">To Pine Script® version 3</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-2" data-astro-cid-omxx3dey="">To Pine Script® version 2</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/where-can-i-get-more-information" data-astro-cid-omxx3dey="">Where can I get more information?</a></li> </ul> <div class="toc-bottom" data-astro-cid-sa57sq6l=""></div> </div> </div> </aside>  <main class="main-pane" data-page-type="md" data-astro-cid-xgirumru=""> <a id="top" data-astro-cid-xgirumru=""></a> <main class="content" data-toc-shown="" data-astro-cid-ju3wuhkz="">  <div class="content-width" data-astro-cid-xgirumru=""> <div class="breadcrumbs" data-pagefind-ignore="" data-astro-cid-wlavna2o=""> <a href="/pine-script-docs" aria-label="Return back to the documentation home page." data-astro-cid-wlavna2o=""> <span data-astro-cid-wlavna2o="">User Manual</span>  </a>  <span class="divider" data-astro-cid-wlavna2o="">/</span> <a href="/pine-script-docs/concepts/alerts" data-astro-cid-wlavna2o="">Concepts</a> <span class="divider" data-astro-cid-wlavna2o="">/</span> <span class="current-item" data-astro-cid-wlavna2o="">Time</span> </div>     </div> <div id="slot-container" data-astro-cid-xgirumru=""> <h1 id="time" class="md-heading"><a href="#time"> <span class="fancy-wrap">Time<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h1>
<h2 id="introduction" class="md-heading"><a href="#introduction"> <span class="fancy-wrap">Introduction<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>In Pine Script®, the following key aspects apply when working with date and time values:</p>
<ul>
<li><strong>UNIX timestamp</strong>: The native format for time values in Pine, representing the absolute number of <em>milliseconds</em> elapsed since midnight <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" rel="nofollow">UTC</a> on 1970-01-01. Several built-ins return UNIX timestamps directly, which users can <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">format</a> into readable dates and times. See the <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> section below for more information.</li>
<li><strong>Exchange time zone</strong>: The <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a> of the instrument’s exchange. All <a href="/pine-script-docs/concepts/time/#calendar-based-variables">calendar-based variables</a> hold values expressed in the exchange time zone, and all built-in function overloads that have a <code dir="auto">timezone</code> parameter use this time zone by default.</li>
<li><strong>Chart time zone</strong>: The time zone the chart and <a href="/pine-script-docs/writing/debugging/#pine-logs">Pine Logs</a> message prefixes use to express time values. Users can set the chart time zone using the “Timezone” input in the “Symbol” tab of the chart’s settings. This setting only changes the <em>display</em> of dates and times on the chart and the times that prefix logged messages. It does <strong>not</strong> affect the behavior of Pine scripts because they cannot access a chart’s time zone information.</li>
<li><strong><code dir="auto">timezone</code> parameter</strong>: A “string” parameter of time-related functions that specifies the time zone used in their calculations. For <a href="/pine-script-docs/concepts/time/#calendar-based-functions">calendar-based functions</a>, such as <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a>, the <code dir="auto">timezone</code> parameter determines the time zone of the returned value. For functions that return UNIX timestamps, such as <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a>, the specified <code dir="auto">timezone</code> defines the time zone of other applicable parameters, e.g., <code dir="auto">session</code>. See the <a href="/pine-script-docs/concepts/time/#time-zone-strings">Time zone strings</a> section to learn more.</li>
</ul>
<h2 id="unix-timestamps" class="md-heading"><a href="#unix-timestamps">UNIX <span class="fancy-wrap">timestamps<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p><a href="https://en.wikipedia.org/wiki/Unix_time" rel="nofollow">UNIX time</a> is a standardized date and time representation that measures the number of <em>non-leap seconds</em> elapsed since January 1, 1970 at 00:00:00 <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" rel="nofollow">UTC</a> (the <em>UNIX Epoch</em>), typically expressed in seconds or smaller time units. A UNIX time value in Pine Script is an “int” <em>timestamp</em> representing the number of <em>milliseconds</em> from the UNIX Epoch to a specific point in time.</p>
<p>Because a UNIX timestamp represents the number of consistent time units elapsed from a fixed historical point (epoch), its value is <strong>time zone-agnostic</strong>. A UNIX timestamp in Pine always corresponds to the same distinct point in time, accurate to the millisecond, regardless of a user’s location.</p>
<p>For example, the UNIX timestamp <code dir="auto">1723472500000</code> always represents the time 1,723,472,500,000 milliseconds (1,723,472,500 seconds) after the UNIX Epoch. This timestamp’s meaning does <strong>not</strong> change relative to any <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>.</p>
<p>To <em>format</em> an “int” UNIX timestamp into a readable date/time “string” expressed in a specific time zone, use the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function. The function does not <em>modify</em> UNIX timestamps. It simply <em>represents</em> timestamps in a desired human-readable format.</p>
<p>For instance, the function can represent the UNIX timestamp <code dir="auto">1723472500000</code> as a “string” in several ways, depending on its <code dir="auto">format</code> and <code dir="auto">timezone</code> arguments, without changing the <em>absolute</em> point in time that it refers to. The simple script below calculates three valid representations of this timestamp and displays them in the <a href="/pine-script-docs/writing/debugging/#pine-logs">Pine Logs</a> pane:</p>
<p><img src="/pine-script-docs/_astro/Time-Unix-timestamps-1.CTbXturQ_ZA7lsx.webp" alt="image" width="1040" height="316" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="7dk"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"UNIX&nbsp;timestamps&nbsp;demo"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;UNIX&nbsp;time&nbsp;value&nbsp;representing&nbsp;the&nbsp;specific&nbsp;point</span><span class="mtk9">&nbsp;1,723,472,500,000&nbsp;ms&nbsp;after&nbsp;the&nbsp;UNIX&nbsp;Epoch.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">unixTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1723472500000</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;These&nbsp;are&nbsp;a&nbsp;few&nbsp;different&nbsp;ways&nbsp;to&nbsp;express&nbsp;the&nbsp;`</span><span class="mtk9">unixTimestamp`&nbsp;in&nbsp;a&nbsp;relative,&nbsp;human-readable&nbsp;forma</span><span class="mtk9">t.</span></span><br><span><span class="mtk9">//&nbsp;Despite&nbsp;their&nbsp;format&nbsp;and&nbsp;time&nbsp;zone&nbsp;differences,</span><span class="mtk9">&nbsp;all&nbsp;the&nbsp;calculated&nbsp;strings&nbsp;represent&nbsp;the&nbsp;SAME&nbsp;dis</span><span class="mtk9">tinct&nbsp;point:&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">isoExchange</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">unixTimestamp</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">utcDateTime</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">unixTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"MM/dd/yyyy&nbsp;HH:mm:ss.S"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+0"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">utc4TimeDate</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">unixTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"hh:mm:ss&nbsp;a,&nbsp;MMMM&nbsp;dd,&nbsp;yyyy&nbsp;z"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+4"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Log&nbsp;the&nbsp;`unixTimestamp`&nbsp;and&nbsp;the&nbsp;custom&nbsp;"string"</span><span class="mtk9">&nbsp;representations&nbsp;on&nbsp;the&nbsp;first&nbsp;bar.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isfirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">log.info</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"\nUNIX&nbsp;time&nbsp;(ms):&nbsp;{0,&nbsp;number,&nbsp;#}\nISO&nbsp;8601&nbsp;repres</span><span class="mtk29">entation&nbsp;(Exchange&nbsp;time&nbsp;zone):&nbsp;{1}"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nCustom&nbsp;date&nbsp;and&nbsp;time&nbsp;representation&nbsp;(UTC+0&nbsp;time</span><span class="mtk29">&nbsp;zone):&nbsp;{2}"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nCustom&nbsp;time&nbsp;and&nbsp;date&nbsp;representation&nbsp;(UTC+4&nbsp;time</span><span class="mtk29">&nbsp;zone):&nbsp;{3}"</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">unixTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">isoExchange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">utcDateTime</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">utc4TimeDate</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The value enclosed within square brackets in the logged message is an <em>automatic</em> prefix representing the historical time of the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_log.info">log.info()</a> call in <a href="https://en.wikipedia.org/wiki/ISO_8601" rel="nofollow">ISO 8601</a> format, expressed in the <a href="/pine-script-docs/concepts/time/#time-zones">chart time zone</a>.</li>
<li>The script <a href="/pine-script-docs/concepts/strings/#concatenation">concatenates</a> three <a href="/pine-script-docs/concepts/strings/#literal-strings">literal strings</a> to create one long <code dir="auto">formatString</code> argument for the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_log.info">log.info()</a> call.</li>
</ul>
<p>See the <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">Formatting dates and times</a> section to learn more about representing UNIX timestamps with formatted strings.</p>
<h2 id="time-zones" class="md-heading"><a href="#time-zones">Time <span class="fancy-wrap">zones<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Time_zone" rel="nofollow">time zone</a> is a geographic region with an assigned <em>local time</em>. The specific time within a time zone is consistent throughout the region. Time zone boundaries typically relate to a location’s longitude. However, in practice, they tend to align with administrative boundaries rather than strictly following longitudinal lines.</p>
<p>The local time within a time zone depends on its defined <em>offset</em> from <a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time" rel="nofollow">Coordinated Universal Time (UTC)</a>, which can range from UTC-12:00 (12 hours <em>behind</em> UTC) to UTC+14:00 (14 hours <em>ahead</em> of UTC). Some regions maintain a consistent offset from UTC, and others have an offset that changes over time due to <a href="https://en.wikipedia.org/wiki/Daylight_saving_time" rel="nofollow">daylight saving time (DST)</a> and other factors.</p>
<p>Two primary time zones apply to data feeds and TradingView charts: the <em>exchange time zone</em> and the <em>chart time zone</em>.</p>
<p>The exchange time zone represents the time zone of the current symbol’s <em>exchange</em>, which Pine scripts can access with the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> variable. <a href="/pine-script-docs/concepts/time/#calendar-based-variables">Calendar-based variables</a>, such as <a href="https://www.tradingview.com/pine-script-reference/v6/#var_month">month</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofweek">dayofweek</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_hour">hour</a>, always hold values expressed in the exchange time zone, and all time function overloads that have a <code dir="auto">timezone</code> parameter use this time zone by default.</p>
<p>The chart time zone is a <em>visual preference</em> that defines how the chart and the time prefixes of <a href="/pine-script-docs/writing/debugging/#pine-logs">Pine Logs</a> represent time values. To set the chart time zone, use the “Timezone” input in the “Symbol” tab of the chart’s settings or click on the current time shown below the chart. The specified time zone does <strong>not</strong> affect time calculations in Pine scripts because they cannot access this chart information. Although scripts cannot access a chart’s time zone, programmers can provide <a href="/pine-script-docs/concepts/inputs/">inputs</a> that users can adjust to match the time zone.</p>
<p>For example, the script below uses <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> to represent the last historical bar’s opening and closing <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> values) as date-time strings expressed in the function’s default time zone, the exchange time zone, UTC-0, and a user-specified time zone. It uses a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> to display all four representations in the bottom-right corner of the chart for comparison:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-zones-1.BAv9QYBX_jNyY.webp" alt="image" width="1336" height="506" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="7fq"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Time&nbsp;zone&nbsp;comparison&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;time&nbsp;zone&nbsp;of&nbsp;the&nbsp;time&nbsp;values&nbsp;in&nbsp;the&nbsp;last&nbsp;tabl</span><span class="mtk9">e&nbsp;row.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;"string"&nbsp;can&nbsp;contain&nbsp;either&nbsp;UTC&nbsp;of</span><span class="mtk9">fset&nbsp;notation&nbsp;or&nbsp;an&nbsp;IANA&nbsp;time&nbsp;zone&nbsp;identifier.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.string</span><span class="mtk13">(</span><span class="mtk29">"UTC+4:00"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;zone"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`table`&nbsp;showing&nbsp;strings&nbsp;representing&nbsp;bar&nbsp;times&nbsp;</span><span class="mtk9">in&nbsp;three&nbsp;preset&nbsp;time&nbsp;zones&nbsp;and&nbsp;a&nbsp;custom&nbsp;time&nbsp;zone.</span><span class="mtk9">&nbsp;</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">position.bottom_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">columns</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rows</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">5</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Initializes&nbsp;three&nbsp;`displayTable`&nbsp;cells&nbsp;on&nbsp;the&nbsp;`ro</span><span class="mtk9">w`&nbsp;that&nbsp;show&nbsp;the&nbsp;`title`,&nbsp;`text1`,&nbsp;and&nbsp;`text2`&nbsp;str</span><span class="mtk9">ings.&nbsp;</span></span><br><span><span class="mtk15">tableRow</span><span class="mtk13">(</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">row</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">text1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">text2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">titleColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9b27b066</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">infoColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">row</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">titleColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">row</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">infoColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">row</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">infoColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;an&nbsp;empty&nbsp;label&nbsp;to&nbsp;signify&nbsp;the&nbsp;bar&nbsp;that&nbsp;the</span><span class="mtk9">&nbsp;displayed&nbsp;time&nbsp;strings&nbsp;represent.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9b27b066</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.huge</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;formatting&nbsp;string&nbsp;for&nbsp;all&nbsp;`str.format_time()`</span><span class="mtk9">&nbsp;calls.&nbsp;Sets&nbsp;the&nbsp;format&nbsp;of&nbsp;the&nbsp;date-time&nbsp;strings.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"yyyy-MM-dd&nbsp;&nbsp;HH:mm:ss"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;header&nbsp;row&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;`disp</span><span class="mtk9">layTable`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tableRow</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">""</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"OPEN&nbsp;time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"CLOSE&nbsp;time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9b27b066</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;row&nbsp;showing&nbsp;the&nbsp;bar's&nbsp;times&nbsp;in&nbsp;the</span><span class="mtk9">&nbsp;default&nbsp;time&nbsp;zone&nbsp;(no&nbsp;specified&nbsp;`timezone`&nbsp;argume</span><span class="mtk9">nts).</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tableRow</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Default"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;row&nbsp;showing&nbsp;the&nbsp;bar's&nbsp;times&nbsp;in&nbsp;the</span><span class="mtk9">&nbsp;exchange&nbsp;time&nbsp;zone&nbsp;(`syminfo.timezone`).</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tableRow</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Exchange:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk13">)</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span><span class="mtk1">&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;row&nbsp;showing&nbsp;the&nbsp;bar's&nbsp;times&nbsp;in&nbsp;the</span><span class="mtk9">&nbsp;UTC-0&nbsp;time&nbsp;zone&nbsp;(using&nbsp;"UTC"&nbsp;as&nbsp;the&nbsp;`timezone`&nbsp;ar</span><span class="mtk9">guments).</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tableRow</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC-0"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC"</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;row&nbsp;showing&nbsp;the&nbsp;bar's&nbsp;times&nbsp;in&nbsp;the</span><span class="mtk9">&nbsp;custom&nbsp;time&nbsp;zone&nbsp;(`timezoneInput`).</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tableRow</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Custom:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a> on the chart signifies which bar’s times the displayed strings represent.</li>
<li>The “Default” and “Exchange” rows in the table show identical results because <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> is the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function’s default <code dir="auto">timezone</code> argument.</li>
<li>The exchange time zone on our example chart appears as <code dir="auto">"America/New_York"</code>, the <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" rel="nofollow">IANA identifier</a> for the NASDAQ exchange’s time zone. It represents UTC-4 <em>or</em> UTC-5, depending on the time of year. See the <a href="/pine-script-docs/concepts/time/#time-zone-strings">next section</a> to learn more about time zone strings.</li>
</ul>
<h3 id="time-zone-strings" class="md-heading"><a href="#time-zone-strings">Time zone <span class="fancy-wrap">strings<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>All built-in functions with a <code dir="auto">timezone</code> parameter accept a “string” argument specifying the <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a> they use in their calculations. These functions can accept time zone strings in either of the following formats:</p>
<ul>
<li><strong>UTC</strong> (or <em>GMT</em>) offset notation, e.g., <code dir="auto">"UTC-5"</code>, <code dir="auto">"UTC+05:30"</code>, <code dir="auto">"GMT+0100"</code></li>
<li><strong>IANA database</strong> notation, e.g., <code dir="auto">"America/New_York"</code>, <code dir="auto">"Asia/Calcutta"</code>, <code dir="auto">"Europe/Paris"</code></li>
</ul>
<p>The <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" rel="nofollow">IANA time zone database</a> reference page lists possible time zone identifiers and their respective UTC offsets. The listed identifiers are valid as <code dir="auto">timezone</code> arguments.</p>
<p>Note that various time zone strings expressed in UTC or IANA notation can represent the <em>same</em> offset from Coordinated Universal Time. For instance, these strings all represent a local time three hours ahead of UTC:</p>
<ul>
<li><code dir="auto">"UTC+3"</code></li>
<li><code dir="auto">"GMT+03:00"</code></li>
<li><code dir="auto">"Asia/Kuwait"</code></li>
<li><code dir="auto">"Europe/Moscow"</code></li>
<li><code dir="auto">"Africa/Nairobi"</code></li>
</ul>
<p>For the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function and the functions that calculate calendar-based values from a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a>, including <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a>, the “string” passed to the <code dir="auto">timezone</code> parameter changes the returned value’s calculation to express the result in the specified time zone. See the <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">Formatting dates and times</a> and <a href="/pine-script-docs/concepts/time/#calendar-based-functions">Calendar-based functions</a> sections for more information.</p>
<p>The example below shows how time zone strings affect the returned values of calendar-based functions. This script uses three <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a> function calls to calculate “int” values representing the opening hour of each bar in the exchange time zone, UTC-0, and a user-specified UTC offset. It plots all three calculated hours in a separate pane for comparison:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-1.CWMAwPYS_ZN7mN7.webp" alt="image" width="1336" height="570" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="9t"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Time&nbsp;zone&nbsp;strings&nbsp;in&nbsp;calendar&nbsp;functions&nbsp;demo"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;"int"&nbsp;representing&nbsp;the&nbsp;user-specified&nbsp;hourly&nbsp;o</span><span class="mtk9">ffset&nbsp;from&nbsp;UTC.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">utcOffsetInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk33">defval</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk29">"Timezone&nbsp;offset&nbsp;UTC&nbsp;(+/-)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">minval</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">-12</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">maxval</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">14</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;valid&nbsp;time&nbsp;zone&nbsp;string&nbsp;based&nbsp;on&nbsp;the&nbsp;`utcOffsetI</span><span class="mtk9">nput`,&nbsp;in&nbsp;UTC&nbsp;offset&nbsp;notation&nbsp;(e.g.,&nbsp;"UTC-4").</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">customOffset</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">utcOffsetInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"+"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">""</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">utcOffsetInput</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;bar's&nbsp;opening&nbsp;hour&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone&nbsp;</span><span class="mtk9">(default).&nbsp;Equivalent&nbsp;to&nbsp;the&nbsp;`hour`&nbsp;variable.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">exchangeHour</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">hour</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;bar's&nbsp;opening&nbsp;hour&nbsp;in&nbsp;the&nbsp;"UTC-0"&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">utcHour</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">hour</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC-0"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;bar's&nbsp;opening&nbsp;hour&nbsp;in&nbsp;the&nbsp;`customOffset`&nbsp;time</span><span class="mtk9">&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">customOffsetHour</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">hour</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">customOffset</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;`exchangeHour`,&nbsp;`utcHour`,&nbsp;and&nbsp;`custom</span><span class="mtk9">OffsetHour`&nbsp;for&nbsp;comparison.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">exchangeHour</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"Exchange&nbsp;hour"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">#E100FF5B</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">8</span><span class="mtk13">)</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">utcHour</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"UTC-0&nbsp;hour"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">customOffsetHour</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Custom&nbsp;offset&nbsp;hour"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <code dir="auto">exchangeHour</code> value is four <em>or</em> five hours behind the <code dir="auto">utcHour</code> because the NASDAQ exchange is in the “America/New_York” time zone. This time zone has a UTC offset that <em>changes</em> during the year due to daylight saving time (DST). The script’s default <code dir="auto">customOffsetHour</code> is consistently four hours ahead of the <code dir="auto">utcHour</code> because its time zone is UTC+4.</li>
<li>The call to the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a> function without a specified <code dir="auto">timezone</code> argument returns the same value that the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_hour">hour</a> <em>variable</em> holds because both represent the bar’s opening hour in the exchange time zone (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a>).</li>
</ul>
<p>For functions that return <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> directly, such as <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a>, the <code dir="auto">timezone</code> parameter defines the time zone of the function’s calendar-based <em>parameters</em>, including <code dir="auto">session</code>, <code dir="auto">year</code>, <code dir="auto">month</code>, <code dir="auto">day</code>, <code dir="auto">hour</code>, <code dir="auto">minute</code>, and <code dir="auto">second</code>. The parameter does <em>not</em> determine the time zone of the returned value, as UNIX timestamps are <em>time zone-agnostic</em>. See the <a href="/pine-script-docs/concepts/time/#testing-for-sessions">Testing for sessions</a> and <a href="/pine-script-docs/concepts/time/#timestamp">`timestamp()`</a> sections to learn more.</p>
<p>The following script calls the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function to calculate the UNIX timestamp of a specific date and time, and it draws a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a> at the timestamp’s corresponding bar location. The user-selected <code dir="auto">timezone</code> argument (<code dir="auto">timezoneInput</code>) determines the time zone of the call’s calendar-based arguments. Consequently, the calculated timestamp varies with the <code dir="auto">timezoneInput</code> value because identical local times in various time zones correspond to <em>different</em> amounts of time elapsed since the <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX Epoch</a>:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-2.Bgcl5BRA_Z1UUd3e.webp" alt="image" width="1336" height="500" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="6a5"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Time&nbsp;zone&nbsp;strings&nbsp;in&nbsp;UNIX&nbsp;timestamp&nbsp;functions&nbsp;dem</span><span class="mtk29">o"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`timezone`&nbsp;argument&nbsp;of&nbsp;the&nbsp;`timestamp()`&nbsp;call</span><span class="mtk9">,&nbsp;which&nbsp;sets&nbsp;the&nbsp;time&nbsp;zone&nbsp;of&nbsp;all&nbsp;date&nbsp;and&nbsp;time&nbsp;pa</span><span class="mtk9">rameters.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.string</span><span class="mtk13">(</span><span class="mtk29">"Etc/UTC"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;zone"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;specific&nbsp;ca</span><span class="mtk9">lendar&nbsp;date&nbsp;and&nbsp;time.</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;specified&nbsp;`year`,&nbsp;`month`,&nbsp;`day`,&nbsp;</span><span class="mtk9">`hour`,&nbsp;`minute`,&nbsp;and&nbsp;`second`&nbsp;represent&nbsp;calendar&nbsp;</span><span class="mtk9">values&nbsp;in&nbsp;the&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`timezoneInput`&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Different&nbsp;`timezone`&nbsp;arguments&nbsp;produce</span><span class="mtk9">&nbsp;different&nbsp;UNIX&nbsp;timestamps&nbsp;because&nbsp;an&nbsp;identical&nbsp;da</span><span class="mtk9">te&nbsp;in&nbsp;another&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time&nbsp;zone&nbsp;does&nbsp;NOT&nbsp;represent&nbsp;the&nbsp;same&nbsp;</span><span class="mtk9">absolute&nbsp;point&nbsp;in&nbsp;time.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">unixTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timezone</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">year</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2024</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">month</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">10</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">day</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">31</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">hour</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">minute</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">second</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`close`&nbsp;value&nbsp;when&nbsp;the&nbsp;bar's&nbsp;opening&nbsp;time&nbsp;cro</span><span class="mtk9">sses&nbsp;the&nbsp;`unixTimestamp`.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelPrice</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.valuewhen</span><span class="mtk13">(</span><span class="mtk16">ta.cross</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">unixTimestamp</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;On&nbsp;the&nbsp;last&nbsp;historical&nbsp;bar,&nbsp;draw&nbsp;a&nbsp;label&nbsp;showin</span><span class="mtk9">g&nbsp;the&nbsp;`unixTimestamp`&nbsp;value&nbsp;at&nbsp;the&nbsp;corresponding&nbsp;b</span><span class="mtk9">ar&nbsp;location.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">unixTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">nz</span><span class="mtk13">(</span><span class="mtk33">labelPrice</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UNIX&nbsp;timestamp:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">unixTimestamp</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.price</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_down</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.bg_color</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li><code dir="auto">"Etc/UTC"</code> is the <em>IANA identifier</em> for the UTC+0 time zone.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_label.new">label.new()</a> call uses <a href="https://www.tradingview.com/pine-script-reference/v6/#const_xloc.bar_time">xloc.bar_time</a> as its <code dir="auto">xloc</code> argument, which is required to anchor the drawing to an absolute time value. Without this argument, the function treats the <code dir="auto">unixTimestamp</code> as a relative bar index, leading to an incorrect location.</li>
<li>The label’s <code dir="auto">y</code> value is the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_close">close</a> of the bar where the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value crosses the <code dir="auto">unixTimestamp</code> value. If the timestamp represents a future time, the label displays the last historical bar’s price.</li>
</ul>
<p>Although time zone strings can use either UTC or IANA notation, we recommend using <em>IANA notation</em> for <code dir="auto">timezone</code> arguments in most cases, especially if a script’s time calculations must align with the observed time offset in a specific country or subdivision. When a time function call uses an <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones" rel="nofollow">IANA time zone identifier</a> for its <code dir="auto">timezone</code> argument, its calculations adjust automatically for historical and future changes to the specified region’s observed time, such as daylight saving time (DST) and updates to time zone boundaries, instead of using a fixed offset from UTC.</p>
<p>The following script demonstrates how UTC and IANA time zone strings can affect time calculations differently. It uses two calls to the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a> function to calculate the hour from the current bar’s opening timestamp using <code dir="auto">"UTC-4"</code> and <code dir="auto">"America/New_York"</code> as <code dir="auto">timezone</code> arguments. The script plots the results of both calls for comparison and colors the main pane’s background when the returned values do not match. Although these two <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a> calls may seem similar because UTC-4 is an observed UTC offset in New York, they <em>do not</em> always return the same results, as shown below:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-3.dJwwxe9V_1a20aC.webp" alt="image" width="1422" height="602" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="2k0"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"UTC&nbsp;vs&nbsp;IANA&nbsp;time&nbsp;zone&nbsp;strings&nbsp;demo"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;hour&nbsp;of&nbsp;the&nbsp;current&nbsp;`time`&nbsp;in&nbsp;the&nbsp;"UTC-4"&nbsp;tim</span><span class="mtk9">e&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;variable's&nbsp;value&nbsp;represents&nbsp;the&nbsp;h</span><span class="mtk9">our&nbsp;in&nbsp;New&nbsp;York&nbsp;only&nbsp;during&nbsp;DST.&nbsp;It&nbsp;is&nbsp;one&nbsp;hour&nbsp;ah</span><span class="mtk9">ead&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">hourUTC</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">hour</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC-4"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;hour&nbsp;of&nbsp;the&nbsp;current&nbsp;`time`&nbsp;in&nbsp;the&nbsp;"America/Ne</span><span class="mtk9">w_York"&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;form&nbsp;adjusts&nbsp;to&nbsp;UTC&nbsp;offset&nbsp;change</span><span class="mtk9">s&nbsp;automatically,&nbsp;so&nbsp;the&nbsp;value&nbsp;always&nbsp;represents&nbsp;th</span><span class="mtk9">e&nbsp;hour&nbsp;in&nbsp;New&nbsp;York.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">hourIANA</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">hour</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"America/New_York"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;translucent&nbsp;blue&nbsp;when&nbsp;`hourUTC`&nbsp;does&nbsp;not&nbsp;equal</span><span class="mtk9">&nbsp;`hourIANA`,&nbsp;`na`&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">hourUTC</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk33">hourIANA</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">33</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">149</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">243</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;values&nbsp;of&nbsp;`hourUTC`&nbsp;and&nbsp;`hourIANA`&nbsp;for</span><span class="mtk9">&nbsp;comparison.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">hourUTC</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk29">"UTC-4"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">6</span><span class="mtk13">)</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">hourIANA</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"America/New_York"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;main&nbsp;chart&nbsp;pane&nbsp;with&nbsp;the&nbsp;`bgColor</span><span class="mtk9">`.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">bgColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Unequal&nbsp;result&nbsp;highlight"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">force_overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br></code></div>
<p>The plots in the chart above diverge periodically because New York observes daylight saving time, meaning its UTC offset <em>changes</em> at specific points in a year. During DST, New York’s local time follows UTC-4. Otherwise, it follows UTC-5. Because the script’s first <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a> call uses <code dir="auto">"UTC-4"</code> as its <code dir="auto">timezone</code> argument, it returns the correct hour in New York <em>only</em> during DST. In contrast, the call that uses the <code dir="auto">"America/New_York"</code> time zone string adjusts its UTC offset automatically to return the correct hour in New York at <em>any</em> time of the year.</p>
<h2 id="time-variables" class="md-heading"><a href="#time-variables">Time <span class="fancy-wrap">variables<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Pine Script has several built-in variables that provide scripts access to different forms of time information:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> variables hold <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> representing the current bar’s opening and closing times, respectively.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> variable holds a UNIX timestamp representing the starting time of the last UTC calendar day in a session.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> variable holds a UNIX timestamp representing the current time when the script executes.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_year">year</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_month">month</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_weekofyear">weekofyear</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofmonth">dayofmonth</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofweek">dayofweek</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_hour">hour</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_minute">minute</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_second">second</a> variables reference calendar values based on the current bar’s opening time, expressed in the <a href="/pine-script-docs/concepts/time/#time-zones">exchange time zone</a>.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> variable holds a UNIX timestamp representing the last available bar’s opening time.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.left_visible_bar_time">chart.left_visible_bar_time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.right_visible_bar_time">chart.right_visible_bar_time</a> variables hold UNIX timestamps representing the opening times of the leftmost and rightmost visible chart bars.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> variable holds a “string” value representing the <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a> of the current symbol’s exchange in <a href="/pine-script-docs/concepts/time/#time-zone-strings">IANA database notation</a>. All time-related function overloads with a <code dir="auto">timezone</code> parameter use this variable as the default argument.</li>
</ul>
<h3 id="time-and-time_close-variables" class="md-heading"><a href="#time-and-time_close-variables"><span>​<code dir="auto">time</code>​ and ​<code dir="auto">time_close</code>​ variables</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> variable holds the <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> of the current bar’s <em>opening time</em>, and the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> variable holds the UNIX timestamp of the bar’s <em>closing time</em>.</p>
<p>These timestamps are unique, time zone-agnostic “int” values, which programmers can use to anchor <a href="/pine-script-docs/language/type-system/#drawing-types">drawing objects</a> to specific bar times, calculate and inspect bar time differences, construct readable date/time strings with the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function, and more.</p>
<p>The script below displays bar opening and closing times in different ways. On each bar, it <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formats</a> the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> timestamps into strings containing the hour, minute, and second in the <a href="/pine-script-docs/concepts/time/#time-zones">exchange time zone</a>, and it draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> displaying the formatted strings at the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_open">open</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_close">close</a> prices. Additionally, the script displays strings containing the unformatted UNIX timestamps of the last chart bar within a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> in the bottom-right corner:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Time-and-time-close-1.SQRlfJYt_Z2oHBgb.webp" alt="image" width="1280" height="576" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="1ca"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`time`&nbsp;and&nbsp;`time_close`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_labels_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;sec</span><span class="mtk9">ond&nbsp;of&nbsp;the&nbsp;bar's&nbsp;opening&nbsp;time&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time</span><span class="mtk9">&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">openTimeString</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;hour,&nbsp;minute,&nbsp;and&nbsp;sec</span><span class="mtk9">ond&nbsp;of&nbsp;the&nbsp;bar's&nbsp;closing&nbsp;time&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time</span><span class="mtk9">&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeString</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`label.style_label_down`&nbsp;when&nbsp;the&nbsp;`open`&nbsp;is&nbsp;hi</span><span class="mtk9">gher&nbsp;than&nbsp;`close`,&nbsp;`label.style_label_up`&nbsp;otherwis</span><span class="mtk9">e.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">openLabelStyle</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_down</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_up</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`label.style_label_down`&nbsp;when&nbsp;the&nbsp;`close`&nbsp;is&nbsp;h</span><span class="mtk9">igher&nbsp;than&nbsp;`open`,&nbsp;`label.style_label_up`&nbsp;otherwis</span><span class="mtk9">e.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeLabelStyle</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_down</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_up</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;labels&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's&nbsp;`time`&nbsp;to&nbsp;dis</span><span class="mtk9">play&nbsp;the&nbsp;`openTimeString`&nbsp;and&nbsp;`closeTimeString`.</span></span><br><span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk33">openTimeString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.price</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">openLabelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.price</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closeLabelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`table`&nbsp;displaying&nbsp;the&nbsp;last&nbsp;bar's&nbsp;*unformatted*</span><span class="mtk9">&nbsp;UNIX&nbsp;timestamps.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">t</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.bottom_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#ffe70d</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Populate&nbsp;the&nbsp;`t`&nbsp;table&nbsp;with&nbsp;"string"&nbsp;representa</span><span class="mtk9">tions&nbsp;of&nbsp;the&nbsp;the&nbsp;"int"&nbsp;`time`&nbsp;and&nbsp;`time_close`&nbsp;val</span><span class="mtk9">ues.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`time`"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`time_close`"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">))</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This script’s <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_label.new">label.new()</a> calls include <a href="https://www.tradingview.com/pine-script-reference/v6/#const_xloc.bar_time">xloc.bar_time</a> as the <code dir="auto">xloc</code> argument and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> as the <code dir="auto">x</code> argument to anchor the drawings to bar opening times.</li>
<li>The formatted strings express time in the exchange time zone because we did not specify <code dir="auto">timezone</code> arguments in the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> calls. NYSE, our chart symbol’s exchange, is in the “America/New_York” time zone (UTC-4/-5).</li>
<li>Although our example chart uses an <em>hourly</em> timeframe, the <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> and the <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> at the end of the chart show that the last bar closes only <em>30 minutes</em> (1,800,000 milliseconds) after opening. This behavior occurs because the chart aligns bars with <a href="/pine-script-docs/concepts/sessions/">session</a> opening and closing times. A session’s final bar closes when the session ends, and a new bar opens when a new session starts. A typical session on our 60-minute chart with regular trading hours (RTH) spans from 09:30 to 16:00 (6.5 hours). The chart divides this interval into as many 60-minute bars as possible, starting from the session’s opening time, which leaves only 30 minutes for the final bar to cover.</li>
</ul>
<p>It’s crucial to note that unlike the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> variable, which has consistent behavior across chart types, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> behaves differently on <em>time-based</em> and <em>non-time-based</em> charts.</p>
<p>Time-based charts have bars that typically open and close at regular, <em>predictable</em> times within a session. Thanks to this predictability, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> can accurately represent the <em>expected</em> closing time of an open bar on a time-based chart, as shown on the last bar in the example above.</p>
<p>In contrast, the bars on <a href="https://www.tradingview.com/support/solutions/43000709225/">tick charts</a> and <em>price-based</em> charts (all <a href="/pine-script-docs/concepts/non-standard-charts-data/">non-standard charts</a> excluding <a href="https://www.tradingview.com/support/solutions/43000619436/">Heikin Ashi</a>) cover <em>irregular</em> time intervals. Tick charts construct bars based on successive ticks in the data feed, and price-based charts construct bars based on significant price movements. The time it takes for new ticks or price changes to occur is <em>unpredictable</em>. As such, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> value is <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> on the <em>open realtime bars</em> of these charts.</p>
<p>The following script uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> variables with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.tostring">str.tostring()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> to create strings containing bar opening and closing <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> and <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> date-time representations, which it displays in <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> at each bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#var_high">high</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_low">low</a> prices.</p>
<p>When applied to a <a href="https://www.tradingview.com/support/solutions/43000502284/">Renko</a> chart, which forms new bars based on <em>price movements</em>, the labels show correct results on all historical bars. However, the last bar has a <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> value of <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> because the future closing time is unpredictable. Consequently, the bar’s closing time label shows a timestamp of <code dir="auto">"NaN"</code> and an <em>incorrect</em> date and time:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Time-and-time-close-2.DgbsHPgj_1bCOHq.webp" alt="image" width="1336" height="610" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="7h9"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`time_close`&nbsp;on&nbsp;non-time-based&nbsp;chart&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;formatted&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;date&nbsp;and&nbsp;time</span><span class="mtk9">&nbsp;that&nbsp;`time_close`&nbsp;represents&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time</span><span class="mtk9">&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedCloseTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">format</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Date&nbsp;and&nbsp;time:'&nbsp;yyyy-MM-dd&nbsp;HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;formatted&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;date&nbsp;and&nbsp;time</span><span class="mtk9">&nbsp;that&nbsp;`time`&nbsp;represents&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedOpenTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">format</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Date&nbsp;and&nbsp;time:'&nbsp;yyyy-MM-dd&nbsp;HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`time_close`&nbsp;UNIX&nbsp;times</span><span class="mtk9">tamp&nbsp;and&nbsp;the&nbsp;`formattedCloseTime`.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span><span class="mtk29">"Close&nbsp;timestamp:&nbsp;{0,number,#}\n{1}"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">time_close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedCloseTime</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`time`&nbsp;UNIX&nbsp;timestamp&nbsp;a</span><span class="mtk9">nd&nbsp;the&nbsp;`formattedOpenTime`.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">openTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span><span class="mtk29">"Open&nbsp;timestamp:&nbsp;{0,number,#}\n{1}"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedOpenTime</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Define&nbsp;label&nbsp;colors&nbsp;for&nbsp;historical&nbsp;and&nbsp;realtime</span><span class="mtk9">&nbsp;bars.&nbsp;</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeLabelColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">openLabelColor</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.green</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;label&nbsp;at&nbsp;the&nbsp;`high`&nbsp;to&nbsp;display&nbsp;the&nbsp;`clos</span><span class="mtk9">eTimeText`&nbsp;and&nbsp;a&nbsp;label&nbsp;at&nbsp;the&nbsp;`low`&nbsp;to&nbsp;display&nbsp;the</span><span class="mtk9">&nbsp;`openTimeText`,&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;both&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's&nbsp;`time`.&nbsp;</span></span><br><span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeLabelColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textalign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">openTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">openLabelColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">style</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_up</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textalign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;yellow&nbsp;on&nbsp;the&nbsp;latest&nbsp;b</span><span class="mtk9">ar.&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">#f3de22cb</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Latest&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The script draws up to 50 <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> because we did not specify a <code dir="auto">max_labels_count</code> argument in the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a> declaration statement.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function replaces <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> values with 0 in its calculations, which is why it returns an incorrect date-time “string” on the last bar. A timestamp of 0 corresponds to the <em>UNIX Epoch</em> (00:00:00 UTC on January 1, 1970). However, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> call does not specify a <code dir="auto">timezone</code> argument, so it expresses the epoch’s date and time in the <em>exchange time zone</em>, which was five hours behind UTC at that point in time.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> function, which returns the closing timestamp of a bar on a specified timeframe within a given session, also returns <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> on the open realtime bars of tick-based and price-based charts.</li>
</ul>
<p>Scripts can retrieve a realtime bar’s closing time on tick charts and price-based charts once the bar is <em>confirmed</em>. The closing timestamp of an <em>elapsed realtime bar</em> is committed to the realtime data feed as soon as the bar closes, so its <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> value is no longer <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>.</p>
<p>To demonstrate this, we can modify the script above to use <code dir="auto">time_close[1]</code> to output the previous bar’s closing time on each bar. The image below shows two highlighted realtime bars. When we executed the script on the chart, the first bar was initially an unconfirmed realtime bar. Its label shows the previous <em>historical</em> bar’s closing time. After some time, this realtime bar closed, and the second highlighted bar opened. The label on the new realtime bar shows the <em>elapsed realtime</em> bar’s closing time:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Time-and-time-close-3.n-klv93m_Z1gi8Rh.webp" alt="image" width="2286" height="1134" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="4cu"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`time_close[1]`&nbsp;on&nbsp;non-time-based&nbsp;chart&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;formatted&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;date&nbsp;and&nbsp;time</span><span class="mtk9">&nbsp;that&nbsp;`time_close[1]`&nbsp;represents&nbsp;in&nbsp;the&nbsp;exchange&nbsp;t</span><span class="mtk9">ime&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedCloseTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">format</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Date&nbsp;and&nbsp;time:'&nbsp;yyyy-MM-dd&nbsp;HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`time_close[1]`&nbsp;UNIX&nbsp;ti</span><span class="mtk9">mestamp&nbsp;and&nbsp;the&nbsp;`formattedCloseTime`.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span><span class="mtk29">"Close&nbsp;timestamp&nbsp;of&nbsp;previous&nbsp;bar:&nbsp;{0,number,#}\n{1</span><span class="mtk29">}"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">time_close</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedCloseTime</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Define&nbsp;label&nbsp;colors&nbsp;for&nbsp;historical&nbsp;and&nbsp;realtime</span><span class="mtk9">&nbsp;bars.&nbsp;</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeLabelColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;label&nbsp;at&nbsp;the&nbsp;`high`&nbsp;to&nbsp;display&nbsp;the&nbsp;`clos</span><span class="mtk9">eTimeText`&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's&nbsp;`time`.&nbsp;</span></span><br><span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeLabelColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textalign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;yellow&nbsp;on&nbsp;the&nbsp;realtime</span><span class="mtk9">&nbsp;bar.&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">#f3de22cb</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Realtime&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>A confirmed realtime bar is <strong>not</strong> the same as a historical bar. Pine’s <a href="/pine-script-docs/language/execution-model/">execution model</a> uses separate data feeds for realtime and historical data. The closing time of a confirmed realtime bar is committed to the <em>realtime</em> feed, until the script re-executes on the chart. Only then will this bar’s closing time load <em>historically</em> along with all the other closed bars.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_barstate.islast">barstate.islast</a> value is <code dir="auto">true</code> for all realtime bars in the dataset. Therefore, the elapsed realtime bar and the latest realtime bar both display a purple <a href="/pine-script-docs/concepts/text-and-shapes/#labels">label</a> and highlighted <a href="/pine-script-docs/concepts/backgrounds/">background</a>. See the <a href="/pine-script-docs/concepts/bar-states/">Bar states</a> page to learn more about the different <code dir="auto">barstate.*</code> variables in Pine Script.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> function can similarly retrieve the previous bar’s closing time on price-based charts using a <code dir="auto">bar_back = 1</code> argument.</li>
</ul>
<h3 id="time_tradingday" class="md-heading"><a href="#time_tradingday"><span>​<code dir="auto">time_tradingday</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> variable holds a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> representing the starting time (00:00 UTC) of the last trading day in the current bar’s final session. It is helpful primarily for date and time calculations on <em>time-based</em> charts for symbols with overnight sessions that start and end on <em>different</em> calendar days.</p>
<p>On “1D” and lower timeframes, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> timestamp corresponds to the beginning of the day when the current session <em>ends</em>, even for bars that open and close on the previous day. For example, the “Monday” session for “EURUSD” starts on Sunday at 17:00 and ends on Monday at 17:00 in the <a href="/pine-script-docs/concepts/time/#time-zones">exchange time zone</a>. The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> values of <em>all</em> intraday bars within the session represent Monday at 00:00 UTC.</p>
<p>On timeframes higher than “1D”, which can cover <em>multiple</em> sessions, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> holds the timestamp representing the beginning of the last calendar day of the bar’s <em>final</em> trading session. For example, on a “EURUSD, 1W” chart, the timestamp represents the start of the last trading day in the week, which is typically Friday at 00:00 UTC.</p>
<p>The script below demonstrates how the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> variables differ on Forex symbols. On each bar, it draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> to display strings containing the variables’ <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> and <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted dates and times</a>. It also uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> function to calculate the UTC calendar day from both timestamps, highlighting the background when the calculated days do not match.</p>
<p>When applied to the “FXCM:EURUSD” chart with the “3h” (“180”) timeframe, the script highlights the background of the <em>first bar</em> in each session, as each session opens on the <em>previous</em> calendar day. The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> call that uses <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> calculates the opening day on the session’s first bar, whereas the call that uses <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> calculates the day when the session <em>ends</em>:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Time-tradingday-1.oi6pPbd1_Z2d200U.webp" alt="image" width="1336" height="612" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="5s0"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`time_tradingday`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;concatenated&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`time_trad</span><span class="mtk9">ingday`&nbsp;timestamp&nbsp;and&nbsp;a&nbsp;formatted&nbsp;representation&nbsp;i</span><span class="mtk9">n&nbsp;UTC.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">tradingDayText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`time_tradingday`:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">time_tradingday</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time_tradingday</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd&nbsp;MMM&nbsp;yyyy,&nbsp;HH:mm&nbsp;(z)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+0"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;concatenated&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`time`&nbsp;tim</span><span class="mtk9">estamp&nbsp;and&nbsp;a&nbsp;formatted&nbsp;representation&nbsp;in&nbsp;UTC.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">barOpenText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`time`:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd&nbsp;MMM&nbsp;yyyy,&nbsp;HH:mm&nbsp;(z)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+0"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;on&nbsp;every&nbsp;even&nbsp;bar,&nbsp;`false`&nbsp;otherwise.&nbsp;T</span><span class="mtk9">his&nbsp;condition&nbsp;determines&nbsp;the&nbsp;appearance&nbsp;of&nbsp;the&nbsp;lab</span><span class="mtk9">els.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">isEven</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;The&nbsp;`yloc`&nbsp;and&nbsp;`style`&nbsp;properties&nbsp;of&nbsp;the&nbsp;labels</span><span class="mtk9">.&nbsp;They&nbsp;alternate&nbsp;on&nbsp;every&nbsp;other&nbsp;bar&nbsp;for&nbsp;visibility</span><span class="mtk9">.&nbsp;</span></span><br><span><span class="mtk33">labelYloc</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">isEven</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.abovebar</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.belowbar</span></span><br><span><span class="mtk33">labelStyle</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">isEven</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_down</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_up</span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;alternating&nbsp;labels&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's&nbsp;`</span><span class="mtk9">time`&nbsp;to&nbsp;display&nbsp;the&nbsp;`tradingDayText`&nbsp;and&nbsp;`barOpen</span><span class="mtk9">Text`.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">isEven</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">tradingDayText</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n\n\n"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelYloc</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">barOpenText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelYloc</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span class="mtk18">else</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n\n\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">barOpenText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelYloc</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">tradingDayText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelYloc</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;day&nbsp;of&nbsp;the&nbsp;month,&nbsp;in&nbsp;UTC,&nbsp;that&nbsp;the&nbsp;`time_trad</span><span class="mtk9">ingday`&nbsp;timestamp&nbsp;corresponds&nbsp;to.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tradingDayOfMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk11">time_tradingday</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+0"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;day&nbsp;of&nbsp;the&nbsp;month,&nbsp;in&nbsp;UTC,&nbsp;that&nbsp;the&nbsp;`time`&nbsp;tim</span><span class="mtk9">estamp&nbsp;corresponds&nbsp;to.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">openingDayOfMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"UTC+0"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;the&nbsp;`tradingDayOf</span><span class="mtk9">Month`&nbsp;does&nbsp;not&nbsp;equal&nbsp;the&nbsp;`openingDayOfMonth`.&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">tradingDayOfMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk33">openingDayOfMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">174</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">89</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">243</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">85</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Different&nbsp;day&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> calls use <code dir="auto">"UTC+0"</code> as the <code dir="auto">timezone</code> argument, meaning the results represent calendar time values with no offset from UTC. In the screenshot, the first bar opens at 21:00 UTC, 17:00 in the exchange time zone (“America/New_York”).</li>
<li>The formatted strings show <code dir="auto">"GMT"</code> as the acronym of the time zone, which is equivalent to <code dir="auto">"UTC+0"</code> in this context.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_tradingday">time_tradingday</a> value is the same for <em>all</em> three-hour bars within each session, even for the initial bar that opens on the previous UTC calendar day. The assigned timestamp changes only when a new session starts.</li>
</ul>
<h3 id="timenow" class="md-heading"><a href="#timenow"><span>​<code dir="auto">timenow</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> variable holds a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> representing the script’s <em>current time</em>. Unlike the values of other variables that hold UNIX timestamps, the values in the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> series correspond to times when the script <em>executes</em>, not the times of specific bars or trading days.</p>
<p>A Pine script executes only <em>once</em> per historical bar, and all historical executions occur when the script first <em>loads</em> on the chart. As such, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> value is relatively consistent on historical bars, with only occasional millisecond changes across the series. In contrast, on realtime bars, a script executes once for <em>each new update</em> in the data feed, which can happen several times per bar. With each new execution, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> value updates on the latest bar to represent the current time.</p>
<aside aria-label="Note" class="tv-informer not-content" style="--informer-header-color:#6A6D78;--informer-back-color-light:#F0F3FA;--informer-back-color-dark:#2A2E39"><div class="tv-informer-icon"><svg viewBox="0 0 18 18" width="18" height="18"><path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM8 6a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1 2c.49 0 1 .59 1 1v3.01c0 .42-.51.99-1 .99s-1-.57-1-.99V9c0-.41.51-1 1-1Z" fill="currentColor"></path></svg></div><div class="tv-informer-content"><p><span class="tv-informer-header">Note</span>Because <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> updates only after script executions, its value does <strong>not</strong> always correspond to the <em>continuous</em> time displayed below the chart. When no new updates are available in the realtime data feed, a script on the chart remains <em>idle</em>, in which case the variable’s timestamp does not change.</p></div></aside>
<p>This variable is most useful on realtime bars, where programmers can apply it to track the times of the latest script executions, count the time elapsed within open bars, control drawings based on bar updates, and more.</p>
<p>The script below inspects the value of <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> on the latest chart bars and uses it to analyze realtime bar updates. When the script first reaches the last chart bar, it declares three variables with the <a href="https://www.tradingview.com/pine-script-reference/v6/#kw_varip">varip</a> keyword to hold the latest <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> value, the total time elapsed between the bar’s updates, and the total number of updates. It uses these values to calculate the average number of milliseconds between updates, which it displays in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a> along with the current execution’s timestamp, a <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> time and date in the <a href="/pine-script-docs/concepts/time/#time-zones">exchange time zone</a>, and the current number of bar updates:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Timenow-1.OYWKIkvY_Z1MUwEq.webp" alt="image" width="1336" height="678" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="3hg"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`timenow`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_labels_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Holds&nbsp;the&nbsp;UNIX&nbsp;timestamp&nbsp;of&nbsp;the&nbsp;latest&nbsp;script&nbsp;exe</span><span class="mtk9">cution&nbsp;for&nbsp;timing&nbsp;updates&nbsp;in&nbsp;the&nbsp;data&nbsp;feed.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">varip</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastUpdateTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;total&nbsp;number&nbsp;of&nbsp;milliseconds&nbsp;elapsed&nbsp;across&nbsp;t</span><span class="mtk9">he&nbsp;bar's&nbsp;data&nbsp;updates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">varip</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalUpdateTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;updates&nbsp;that&nbsp;have&nbsp;occurred&nbsp;on&nbsp;the&nbsp;c</span><span class="mtk9">urrent&nbsp;bar.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">varip</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numUpdates</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;time&nbsp;elapsed&nbsp;from&nbsp;the&nbsp;`lastUpdateTimest</span><span class="mtk9">amp`&nbsp;to&nbsp;`totalUpdateTime`,&nbsp;increase&nbsp;the&nbsp;`numUpdate</span><span class="mtk9">s`&nbsp;counter,&nbsp;and&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;update&nbsp;the&nbsp;`lastUpdateTimestamp`&nbsp;when&nbsp;the&nbsp;`time</span><span class="mtk9">now`&nbsp;value&nbsp;changes.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastUpdateTimestamp</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">totalUpdateTime</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastUpdateTimestamp</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">numUpdates</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lastUpdateTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;average&nbsp;number&nbsp;of&nbsp;milliseconds&nbsp;elapsed&nbsp;betwee</span><span class="mtk9">n&nbsp;the&nbsp;bar's&nbsp;updates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">avgUpdateTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">nz</span><span class="mtk13">(</span><span class="mtk33">totalUpdateTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">numUpdates</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Contains&nbsp;the&nbsp;`timenow`&nbsp;value,&nbsp;a&nbsp;custom&nbsp;representa</span><span class="mtk9">tion,&nbsp;and&nbsp;the&nbsp;`numUpdates`&nbsp;and&nbsp;`avgUpdateTime`&nbsp;val</span><span class="mtk9">ues.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timenow`:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">timenow</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nTime&nbsp;and&nbsp;date&nbsp;(exchange):&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">timenow</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss&nbsp;MM/dd/yy"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nNumber&nbsp;of&nbsp;updates:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">numUpdates</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nAvg.&nbsp;time&nbsp;between&nbsp;updates:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">avgUpdateTime</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"#.###"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;ms"</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;color&nbsp;of&nbsp;the&nbsp;label.&nbsp;Is&nbsp;blue&nbsp;when&nbsp;the&nbsp;bar&nbsp;is&nbsp;o</span><span class="mtk9">pen,&nbsp;and&nbsp;gray&nbsp;after&nbsp;it&nbsp;closes.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isconfirmed</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.gray</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;label's&nbsp;y-coordinate.&nbsp;Alternates&nbsp;between&nbsp;`hig</span><span class="mtk9">h`&nbsp;and&nbsp;`low`&nbsp;on&nbsp;every&nbsp;other&nbsp;bar.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelPrice</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;label's&nbsp;style.&nbsp;Alternates&nbsp;between&nbsp;"lower-righ</span><span class="mtk9">t"&nbsp;and&nbsp;"upper-right"&nbsp;styles.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_lower_right</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_upper_right</span><span class="mtk1">&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;`labelColor`&nbsp;label&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's</span><span class="mtk9">&nbsp;`time`&nbsp;to&nbsp;show&nbsp;the&nbsp;`displayText`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelPrice</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">style</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelStyle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Reset&nbsp;the&nbsp;`totalUpdateTime`&nbsp;and&nbsp;`numUpdates`&nbsp;co</span><span class="mtk9">unters&nbsp;when&nbsp;the&nbsp;bar&nbsp;is&nbsp;confirmed&nbsp;(closes).&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isconfirmed</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">totalUpdateTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">numUpdates</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>When a bar is open, the drawn label is blue to signify that additional updates can occur. After the bar closes, the final label’s color is gray.</li>
<li>Although we’ve set the chart <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a> to match the exchange time zone, the formatted time in the open bar’s label and the time shown below the chart <em>do not</em> always align. The script records a new timestamp only when a <em>new execution</em> occurs, whereas the time below the chart updates <em>continuously</em>.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#kw_varip">varip</a> keyword specifies that a variable does not revert to the last committed value in its series when new updates occur. This behavior allows the script to use variables to track changes in <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> on an open bar.</li>
<li>Updates to <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> on open realtime bars do not affect the recorded timestamps on confirmed bars as the script executes. However, the historical series changes (<em>repaints</em>) after reloading the chart because <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> references the script’s <em>current time</em>, not the times of specific bars.</li>
</ul>
<h3 id="calendar-based-variables" class="md-heading"><a href="#calendar-based-variables">Calendar-based <span class="fancy-wrap">variables<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_year">year</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_month">month</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_weekofyear">weekofyear</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofmonth">dayofmonth</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofweek">dayofweek</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_hour">hour</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_minute">minute</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_second">second</a> variables hold <em>calendar-based</em> “int” values calculated from the current bar’s <em>opening time</em>, expressed in the <a href="/pine-script-docs/concepts/time/#time-zones">exchange time zone</a>. These variables reference the same values that <a href="/pine-script-docs/concepts/time/#calendar-based-functions">calendar-based functions</a> return when they use the default <code dir="auto">timezone</code> argument and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> as the <code dir="auto">time</code> argument. For instance, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_year">year</a> variable holds the same value that a <code dir="auto">year(time)</code> call returns.</p>
<p>Programmers can use these calendar-based variables for several purposes, such as:</p>
<ul>
<li>Identifying a bar’s opening date and time.</li>
<li>Passing the variables to the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function to calculate <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a>.</li>
<li>Testing when date/time values or ranges occur in a data feed.</li>
</ul>
<p>One of the most common use cases for these variables is checking for date or time ranges to control when a script displays visuals or executes calculations. This simple example inspects the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_year">year</a> variable to determine when to plot a visible value. If the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_year">year</a> is 2022 or higher, the script plots the bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#var_close">close</a>. Otherwise, it plots <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Calendar-based-variables-1.kYa8Z75h_KDMyu.webp" alt="image" width="1376" height="550" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="170"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`year`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;`close`&nbsp;price&nbsp;on&nbsp;bars&nbsp;that&nbsp;open&nbsp;in&nbsp;the</span><span class="mtk9">&nbsp;`year`&nbsp;2022&nbsp;onward.&nbsp;Otherwise,&nbsp;plot&nbsp;`na`&nbsp;to&nbsp;displ</span><span class="mtk9">ay&nbsp;nothing.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk11">year</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2022</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`close`&nbsp;price&nbsp;(year&nbsp;2022&nbsp;and&nbsp;later)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br></code></div>
<p>When using these variables in conditions that isolate specific dates or times rather than ranges, it’s crucial to consider that certain conditions might not detect some occurrences of the values due to a chart’s timeframe, the opening times of chart bars, or the symbol’s active session.</p>
<p>For instance, suppose we want to detect when the first calendar day of each month occurs on the chart. Intuitively, one might consider simply checking when the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofmonth">dayofmonth</a> value equals 1. However, this condition only identifies when a bar <em>opens</em> on a month’s first day. The bars on some charts can open and close in <em>different</em> months. Additionally, a chart bar might not contain the first day of a month if the market is <em>closed</em> on that day. Therefore, we must create extra conditions that work in these scenarios to identify the first day in <em>any</em> month on the chart.</p>
<p>The script below uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofmonth">dayofmonth</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_month">month</a> variables, and the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a> function, to create three conditions that detect the first day of the month in different ways. The first condition detects if the bar opens on the first day, the second checks if the bar opens in one month and closes in another, and the third checks if the chart skips the date entirely. The script draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> showing bar opening dates and highlights the background with different colors to visualize when each condition occurs:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Calendar-based-variables-2.xQSXmhyL_Zw0zRE.webp" alt="image" width="1336" height="636" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="31t"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Detecting&nbsp;the&nbsp;first&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_labels_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;only&nbsp;if&nbsp;the&nbsp;current&nbsp;bar&nbsp;opens&nbsp;on&nbsp;the&nbsp;fi</span><span class="mtk9">rst&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;in&nbsp;exchange&nbsp;time,&nbsp;`false`&nbsp;oth</span><span class="mtk9">erwise.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">opensOnFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">dayofmonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;if&nbsp;the&nbsp;bar&nbsp;opens&nbsp;in&nbsp;one&nbsp;month&nbsp;and&nbsp;close</span><span class="mtk9">s&nbsp;in&nbsp;another,&nbsp;meaning&nbsp;its&nbsp;time&nbsp;span&nbsp;includes&nbsp;the&nbsp;f</span><span class="mtk9">irst&nbsp;day.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">containsFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">month</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk16">month</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;only&nbsp;if&nbsp;the&nbsp;bar&nbsp;opens&nbsp;in&nbsp;a&nbsp;new&nbsp;month&nbsp;an</span><span class="mtk9">d&nbsp;the&nbsp;current&nbsp;or&nbsp;previous&nbsp;bar&nbsp;does&nbsp;not&nbsp;cover&nbsp;the&nbsp;f</span><span class="mtk9">irst&nbsp;day.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">skipsFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">month</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk11">month</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">opensOnFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">or</span><span class="mtk1">&nbsp;</span><span class="mtk33">containsFirst</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">])</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;current&nbsp;bar's&nbsp;opening&nbsp;weekday.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">weekdayName</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">switch</span><span class="mtk1">&nbsp;</span><span class="mtk11">dayofweek</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.sunday</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Sunday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.monday</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Monday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.tuesday</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Tuesday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.wednesday</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Wednesday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.thursday</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Thursday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.friday</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Friday"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">dayofweek.saturday</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Saturday"</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;custom&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;bar's&nbsp;opening&nbsp;</span><span class="mtk9">date,&nbsp;including&nbsp;the&nbsp;weekday&nbsp;name.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">openDateText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">weekdayName</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">",&nbsp;MMM&nbsp;d,&nbsp;yyyy"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;green&nbsp;label&nbsp;when&nbsp;the&nbsp;bar&nbsp;opens&nbsp;on&nbsp;the&nbsp;fi</span><span class="mtk9">rst&nbsp;day&nbsp;of&nbsp;the&nbsp;month.&nbsp;</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">opensOnFirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Bar&nbsp;opened&nbsp;on\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">openDateText</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.green</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;blue&nbsp;label&nbsp;when&nbsp;the&nbsp;bar&nbsp;opens&nbsp;and&nbsp;closes</span><span class="mtk9">&nbsp;in&nbsp;different&nbsp;months.&nbsp;</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">containsFirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Bar&nbsp;includes&nbsp;the&nbsp;first&nbsp;day,\nbut&nbsp;opened&nbsp;on\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">openDateText</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;red&nbsp;label&nbsp;when&nbsp;the&nbsp;chart&nbsp;skips&nbsp;the&nbsp;first</span><span class="mtk9">&nbsp;day&nbsp;of&nbsp;the&nbsp;month.&nbsp;</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">skipsFirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Chart&nbsp;doesn't&nbsp;include&nbsp;the&nbsp;first&nbsp;day.\nBar&nbsp;opened&nbsp;</span><span class="mtk29">on\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">openDateText</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;the&nbsp;conditions&nbsp;oc</span><span class="mtk9">cur.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">opensOnFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.green</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`opensOnFirst`&nbsp;condition&nbsp;highlight"</span><span class="mtk13">)</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">containsFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`containsFirst`&nbsp;condition&nbsp;highlight"</span><span class="mtk13">)</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">skipsFirst</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.red</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`skipsFirst`&nbsp;condition&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The script calls the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a> function with <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> as the <code dir="auto">time</code> argument to calculate each bar’s <em>closing</em> month for the <code dir="auto">containsFirst</code> condition.</li>
<li>The <code dir="auto">dayofweek.*</code> namespace contains variables that hold each possible <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofweek">dayofweek</a> value, e.g., <a href="https://www.tradingview.com/pine-script-reference/v6/#const_dayofweek.sunday">dayofweek.sunday</a> has a constant value of 1 and <a href="https://www.tradingview.com/pine-script-reference/v6/#const_dayofweek.saturday">dayofweek.saturday</a> has a constant value of 7. The script compares <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofweek">dayofweek</a> to these variables in a <a href="https://www.tradingview.com/pine-script-reference/v6/#kw_switch">switch</a> structure to determine the weekday name shown inside each <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a>.</li>
<li>To detect the <em>first opening time</em> in a monthly timeframe, not strictly the first day in a calendar month, use <code dir="auto">ta.change(time("1M")) &gt; 0</code> or <code dir="auto">timeframe.change("1M")</code> instead of conditions based on these variables. See the <a href="/pine-script-docs/concepts/time/#testing-for-changes-in-higher-timeframes">Testing for changes in higher timeframes</a> section to learn more.</li>
</ul>
<h3 id="last_bar_time" class="md-heading"><a href="#last_bar_time"><span>​<code dir="auto">last_bar_time</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> variable holds a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> representing the <em>last</em> available bar’s opening time. It is similar to <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_index">last_bar_index</a>, which references the latest bar index. On historical bars, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> consistently references the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value of the last bar available when the script first <em>loads</em> on the chart. The only time the variable’s value updates across script executions is when a new realtime bar opens.</p>
<p>The following script uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> variable to get the opening timestamp of the last chart bar during its execution on the <em>first bar</em>. It displays the UNIX timestamp and a <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted date and time</a> using a single-cell <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> created only on that bar. When the script executes on the last available bar, it creates a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a> to show the bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value and its formatted representation for visual comparison.</p>
<p>As the chart below shows, both drawings display <em>identical</em> times, verifying that <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> correctly references the last bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value on previous historical bars:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Last-bar-time-1.COWu3Po-_Z26jRdL.webp" alt="image" width="1336" height="540" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="1c1"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`last_bar_time`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isfirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;single-cell&nbsp;`table`,&nbsp;created&nbsp;only&nbsp;on&nbsp;the&nbsp;*first</span><span class="mtk9">*&nbsp;bar,&nbsp;showing&nbsp;the&nbsp;*last*&nbsp;available&nbsp;bar's&nbsp;opening&nbsp;</span><span class="mtk9">time.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.bottom_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;`last_bar_time`&nbsp;UNIX&nbsp;ti</span><span class="mtk9">mestamp&nbsp;and&nbsp;a&nbsp;custom&nbsp;date&nbsp;and&nbsp;time&nbsp;representation.</span><span class="mtk9">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastBarTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`last_bar_time`:&nbsp;"</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">last_bar_time</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nDate&nbsp;and&nbsp;time&nbsp;(exchange):&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">last_bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;the&nbsp;`displayTable`&nbsp;cell&nbsp;with&nbsp;the&nbsp;`la</span><span class="mtk9">stBarTimeText`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastBarTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;only&nbsp;on&nbsp;the&nbsp;first&nbsp;occurrence&nbsp;of&nbsp;`barsta</span><span class="mtk9">te.islast`,&nbsp;`false`&nbsp;otherwise.</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;condition&nbsp;occurs&nbsp;on&nbsp;the&nbsp;bar&nbsp;whose</span><span class="mtk9">&nbsp;`time`&nbsp;the&nbsp;`last_bar_time`&nbsp;variable&nbsp;refers&nbsp;to&nbsp;on&nbsp;</span><span class="mtk9">historical&nbsp;bars.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">isInitialLastBar</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">isInitialLastBar</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;the&nbsp;last&nbsp;available&nbsp;bar's&nbsp;`t</span><span class="mtk9">ime`&nbsp;value&nbsp;and&nbsp;a&nbsp;custom&nbsp;date&nbsp;and&nbsp;time&nbsp;representati</span><span class="mtk9">on.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matches&nbsp;the&nbsp;`lastBarTimeText`&nbsp;from&nbsp;the</span><span class="mtk9">&nbsp;first&nbsp;bar&nbsp;because&nbsp;`last_bar_time`&nbsp;equals&nbsp;this&nbsp;bar</span><span class="mtk9">'s&nbsp;`time`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">openTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`time`:&nbsp;"</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nDate&nbsp;and&nbsp;time&nbsp;(exchange):&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;label&nbsp;anchored&nbsp;to&nbsp;the&nbsp;bar's&nbsp;`time`&nbsp;to&nbsp;di</span><span class="mtk9">splay&nbsp;the&nbsp;`openTimeText`.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">openTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textalign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;`isInitialLastBar</span><span class="mtk9">`&nbsp;is&nbsp;`true`&nbsp;for&nbsp;visual&nbsp;reference.&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.islast</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">155</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">39</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">176</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Initial&nbsp;last&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The script creates the <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a> only on the <em>first</em> bar with the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_barstate.islast">barstate.islast</a> state because that bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value is what <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> equals on all historical bars. On subsequent bars, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> value <em>updates</em> to represent the latest realtime bar’s opening time.</li>
<li>Updates to <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> on realtime bars do not affect the values on historical bars as the script executes. However, the variable’s series <em>repaints</em> when the script restarts because <a href="https://www.tradingview.com/pine-script-reference/v6/#var_last_bar_time">last_bar_time</a> always references the latest available bar’s opening time.</li>
<li>This script expresses dates using the <code dir="auto">"dd/MM/yy"</code> format, meaning the two-digit day appears before the two-digit month, and the month appears before the two-digit representation of the year. See <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">this section</a> below for more information.</li>
</ul>
<h3 id="visible-bar-times" class="md-heading"><a href="#visible-bar-times">Visible bar <span class="fancy-wrap">times<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.left_visible_bar_time">chart.left_visible_bar_time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.right_visible_bar_time">chart.right_visible_bar_time</a> variables reference the opening <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> of the chart’s leftmost (first) and rightmost (last) <em>visible bars</em> on every script execution. When a script uses these variables, it responds dynamically to visible chart changes, such as users scrolling across bars or zooming in/out. Each time the visible window changes, the script <em>re-executes</em> automatically to update the variables’ values on all available bars.</p>
<p>The example below demonstrates how the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.left_visible_bar_time">chart.left_visible_bar_time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.right_visible_bar_time">chart.right_visible_bar_time</a> variables work across script executions. The script draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> anchored to the visible bars’ times to display the UNIX timestamps. In addition, it draws two single-cell <a href="/pine-script-docs/visuals/tables/">tables</a> showing corresponding dates and times in the standard <a href="https://en.wikipedia.org/wiki/ISO_8601" rel="nofollow">ISO 8601</a> format. The script creates these drawings only when it executes on the first bar. As the script continues to execute on subsequent bars, it identifies each bar whose <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value equals either visible bars’ timestamp and colors it on the chart:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Visible-bar-times-1.Cm54dJVW_rV6wP.webp" alt="image" width="1336" height="642" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="mm"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Visible&nbsp;bar&nbsp;times&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Create&nbsp;strings&nbsp;on&nbsp;the&nbsp;first&nbsp;chart&nbsp;bar&nbsp;that&nbsp;cont</span><span class="mtk9">ain&nbsp;the&nbsp;first&nbsp;and&nbsp;last&nbsp;visible&nbsp;bars'&nbsp;UNIX&nbsp;timestam</span><span class="mtk9">ps.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftTimestampText</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span><span class="mtk29">"UNIX&nbsp;timestamp:&nbsp;{0,number,#}"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.left_visible_bar_time</span><span class="mtk13">)</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightTimestampText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span><span class="mtk29">"UNIX&nbsp;timestamp:&nbsp;{0,number,#}"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.right_visible_bar_time</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Create&nbsp;strings&nbsp;on&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;contain&nbsp;th</span><span class="mtk9">e&nbsp;exchange&nbsp;date&nbsp;and&nbsp;time&nbsp;of&nbsp;the&nbsp;visible&nbsp;bars&nbsp;in&nbsp;IS</span><span class="mtk9">O&nbsp;8601&nbsp;format.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftDateTimeText</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">chart.left_visible_bar_time</span><span class="mtk13">)</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightDateTimeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">chart.right_visible_bar_time</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`label`&nbsp;object&nbsp;anchored&nbsp;to&nbsp;the&nbsp;first&nbsp;visible&nbsp;ba</span><span class="mtk9">r's&nbsp;time.&nbsp;Shows&nbsp;the&nbsp;`leftTimestampText`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">label</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftTimeLabel</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">chart.left_visible_bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftTimestampText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.abovebar</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">label.style_label_lower_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`label`&nbsp;object&nbsp;anchored&nbsp;to&nbsp;the&nbsp;last&nbsp;visible&nbsp;bar</span><span class="mtk9">'s&nbsp;time.&nbsp;Shows&nbsp;the&nbsp;`rightTimestampText`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">label</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightTimeLabel</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">chart.right_visible_bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightTimestampText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.abovebar</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">label.style_label_lower_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;single-cell&nbsp;`table`&nbsp;object&nbsp;showing&nbsp;the&nbsp;`leftDat</span><span class="mtk9">eTimeText`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftTimeTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.middle_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;single-cell&nbsp;`table`&nbsp;object&nbsp;showing&nbsp;the&nbsp;`rightDa</span><span class="mtk9">teTimeText`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightTimeTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.middle_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;On&nbsp;the&nbsp;first&nbsp;bar,&nbsp;initialize&nbsp;the&nbsp;`leftTimeTable</span><span class="mtk9">`&nbsp;and&nbsp;`rightTimeTable`&nbsp;with&nbsp;the&nbsp;corresponding&nbsp;date</span><span class="mtk9">-time&nbsp;text.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isfirst</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">leftTimeTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">leftDateTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">rightTimeTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rightDateTimeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;purple&nbsp;at&nbsp;the&nbsp;left&nbsp;visible&nbsp;bar's&nbsp;opening&nbsp;time,</span><span class="mtk9">&nbsp;teal&nbsp;at&nbsp;the&nbsp;right&nbsp;bar's&nbsp;opening&nbsp;time,&nbsp;`na`&nbsp;otherw</span><span class="mtk9">ise.&nbsp;</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">barColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">switch</span><span class="mtk1">&nbsp;</span><span class="mtk11">time</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">chart.left_visible_bar_time</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">chart.right_visible_bar_time</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;the&nbsp;leftmost&nbsp;and&nbsp;rightmost&nbsp;visible&nbsp;bars&nbsp;u</span><span class="mtk9">sing&nbsp;the&nbsp;`barColor`.</span></span><br><span><span class="mtk16">barcolor</span><span class="mtk13">(</span><span class="mtk33">barColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Leftmost&nbsp;and&nbsp;rightmost&nbsp;visible&nbsp;bar&nbsp;color"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.left_visible_bar_time">chart.left_visible_bar_time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_chart.right_visible_bar_time">chart.right_visible_bar_time</a> values are consistent across all executions, which allows the script to identify the visible bars’ timestamps on the <em>first</em> bar and check when the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> value equals them. The script restarts on any chart window changes, updating the variables’ series to reference the new timestamps on every bar.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function uses ISO 8601 format by default when the call does not include a <code dir="auto">format</code> argument because it is the <em>international standard</em> for expressing dates and times. See the <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">Formatting dates and times</a> section to learn more about time string formats.</li>
</ul>
<h3 id="syminfotimezone" class="md-heading"><a href="#syminfotimezone"><span>​<code dir="auto">syminfo.timezone</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> variable holds a <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> representing the current symbol’s <em>exchange</em> time zone. The “string” value expresses the time zone as an <em>IANA identifier</em> (e.g., <code dir="auto">"America/New_York"</code>). The overloads of <a href="/pine-script-docs/concepts/time/#time-functions">time functions</a> that include a <code dir="auto">timezone</code> parameter use <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> as the default argument.</p>
<p>Because this variable is the default <code dir="auto">timezone</code> argument for all applicable time function overloads, it is unnecessary to use as an explicit argument, except for stylistic purposes. However, programmers can use the variable in other ways, such as:</p>
<ul>
<li>Displaying the “string” in <a href="/pine-script-docs/writing/debugging/#pine-logs">Pine Logs</a> or <a href="/pine-script-docs/language/type-system/#drawing-types">drawings</a> to inspect the exchange time zone’s IANA identifier.</li>
<li>Comparing the value to other time zone strings to create time zone-based conditional logic.</li>
<li>Requesting the exchange time zones of other symbols with <code dir="auto">request.*()</code> function calls.</li>
</ul>
<p>The following script uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> variable to retrieve the <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> of its latest execution. It <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formats</a> the timestamp into date-time strings expressed in the main symbol’s exchange time zone and a requested symbol’s exchange time zone, which it displays along with the IANA identifiers in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> on the last chart bar:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-variables-Syminfo-timezone-1.BAiDPB0L_Z1tzhco.webp" alt="image" width="1336" height="580" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="1kp"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`syminfo.timezone`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;symbol&nbsp;to&nbsp;request&nbsp;exchange&nbsp;time&nbsp;zone&nbsp;informat</span><span class="mtk9">ion&nbsp;for.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">symbolInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.symbol</span><span class="mtk13">(</span><span class="mtk29">"NSE:BANKNIFTY"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Requested&nbsp;symbol"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`table`&nbsp;object&nbsp;displaying&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zon</span><span class="mtk9">e&nbsp;and&nbsp;the&nbsp;time&nbsp;of&nbsp;the&nbsp;script's&nbsp;execution.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">t</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.bottom_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.yellow</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;IANA&nbsp;identifier&nbsp;of&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone&nbsp;req</span><span class="mtk9">uested&nbsp;for&nbsp;the&nbsp;`symbolInput`&nbsp;symbol.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">requestedTimezone</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Retrieve&nbsp;the&nbsp;time&nbsp;zone&nbsp;of&nbsp;the&nbsp;user-specified&nbsp;sy</span><span class="mtk9">mbol's&nbsp;exchange.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">requestedTimezone</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">request.security</span><span class="mtk13">(</span><span class="mtk33">symbolInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">""</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">calc_bars_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;the&nbsp;`t`&nbsp;table's&nbsp;header&nbsp;cells.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Exchange&nbsp;prefix&nbsp;and&nbsp;time&nbsp;zone&nbsp;string"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Last&nbsp;execution&nbsp;date&nbsp;and&nbsp;time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">syminfo.prefix</span><span class="mtk13">(</span><span class="mtk11">syminfo.tickerid</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;("</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">")"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">syminfo.prefix</span><span class="mtk13">(</span><span class="mtk33">symbolInput</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;("</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">requestedTimezone</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">")"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;formatting&nbsp;string&nbsp;for&nbsp;all&nbsp;`str.format_time()`</span><span class="mtk9">&nbsp;calls.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss&nbsp;'on'&nbsp;MMM&nbsp;dd,&nbsp;YYYY"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;table&nbsp;cells&nbsp;to&nbsp;display&nbsp;the&nbsp;formatted</span><span class="mtk9">&nbsp;text.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">timenow</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">t</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">timenow</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">requestedTimezone</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>Pine scripts execute on realtime bars only when new updates occur in the data feed, and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> updates only on script executions. As such, when no realtime updates are available, the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> timestamp does not change. See <a href="/pine-script-docs/concepts/time/#timenow">this section</a> above for more information.</li>
<li>The default <code dir="auto">symbolInput</code> value is <code dir="auto">"NSE:BANKNIFTY"</code>. NSE is in the “Asia/Kolkata” <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>, which is 9.5 hours ahead of the main symbol’s exchange time zone (“America/New_York”) at the time of the screenshot. Although the <em>local</em> time representations differ, both refer to the same <em>absolute</em> time that the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a> timestamp represents.</li>
<li>Pine v6 scripts use dynamic <code dir="auto">request.*()</code> calls by default, which allows the script to call <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_request.security">request.security()</a> dynamically inside the <a href="https://www.tradingview.com/pine-script-reference/v6/#kw_if">if</a> structure’s <em>local scope</em>. See the <a href="/pine-script-docs/concepts/other-timeframes-and-data/#dynamic-requests">Dynamic requests</a> section of the <a href="/pine-script-docs/concepts/other-timeframes-and-data/">Other timeframes and data</a> page to learn more.</li>
</ul>
<h2 id="time-functions" class="md-heading"><a href="#time-functions">Time <span class="fancy-wrap">functions<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Pine Script features several built-in functions that scripts can use to retrieve, calculate, and express time values:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions allow scripts to retrieve <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> for the opening and closing times of bars within a session on a specified timeframe, without requiring <code dir="auto">request.*()</code> function calls.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_year">year()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_weekofyear">weekofyear()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_minute">minute()</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_second">second()</a> functions calculate calendar-based values, expressed in a specified <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>, from a UNIX timestamp.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function calculates a UNIX timestamp from a specified calendar date and time.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function formats a UNIX timestamp into a human-readable date/time “string”, expressed in a specified time zone. The <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">Formatting dates and times</a> section below provides detailed information about formatting timestamps with this function.</li>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_input.time">input.time()</a> function returns a UNIX timestamp corresponding to the user-specified date and time, and the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_input.session">input.session()</a> function returns a valid <a href="/pine-script-docs/concepts/sessions/#time-based-sessions">time-based session string</a> corresponding to the user-specified start and end times. See the <a href="/pine-script-docs/concepts/inputs/#time-input">Time input</a> and <a href="/pine-script-docs/concepts/inputs/#session-input">Session input</a> sections of the <a href="/pine-script-docs/concepts/inputs/">Inputs</a> page to learn more about these functions.</li>
</ul>
<h3 id="time-and-time_close-functions" class="md-heading"><a href="#time-and-time_close-functions"><span>​<code dir="auto">time()</code>​ and ​<code dir="auto">time_close()</code>​ functions</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions return <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> representing the opening and closing times of bars on a specified timeframe. Both functions can <em>filter</em> their returned values based on a given <a href="/pine-script-docs/concepts/sessions/">session</a> in a specific <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>. They each have the following signatures:</p>
<div class="expressive-code not-content"><link rel="stylesheet" href="/pine-script-docs/_astro/ec.dtidy.css"><script type="module" src="/pine-script-docs/_astro/ec.qopfj.js" data-astro-exec=""></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text" tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">functionName(timeframe, session, bars_back, timeframe_bars_back) → series int</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">functionName(timeframe, session, timezone, bars_back, timeframe_bars_back) → series int</span></div></div></code></pre></figure></div>
<p>Where:</p>
<ul>
<li><code dir="auto">functionName</code> is the function’s identifier.</li>
<li>The <code dir="auto">timeframe</code> parameter accepts a <a href="/pine-script-docs/concepts/timeframes/#timeframe-string-specifications">timeframe string</a> that defines the timeframe for the calculation. The function uses the script’s main timeframe if the argument is <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timeframe.period">timeframe.period</a> or an empty string <code dir="auto">""</code>.</li>
<li>The optional <code dir="auto">session</code> parameter accepts a <a href="/pine-script-docs/concepts/sessions/#time-based-sessions">time-based session string</a> that defines the session’s start and end times (e.g., <code dir="auto">"0930-1600"</code>) and the days for which it applies (e.g., <code dir="auto">":23456"</code> means Monday - Friday). If the value does not specify the days, the session applies to <em>all</em> trading days automatically. The function returns UNIX timestamps only for the bars <em>within</em> the session. It returns <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> if a bar’s time is <em>outside</em> the session. If the <code dir="auto">session</code> argument is an empty string or not specified, the function uses the symbol’s session information.</li>
<li>The optional <code dir="auto">timezone</code> parameter accepts a valid <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> that defines the time zone of the specified <code dir="auto">session</code>. It does <strong>not</strong> change the meaning of returned UNIX timestamps, as they are <em>time zone-agnostic</em>. If the <code dir="auto">timezone</code> argument is not specified, the function uses the exchange time zone (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a>).</li>
<li>The optional <code dir="auto">bars_back</code> parameter accepts an “int” value specifying the bar offset on the script’s main timeframe. If the value is positive, the function finds the bar that is N bars before the current bar on the main timeframe, then retrieves the timestamp of the corresponding bar on the timeframe specified by the <code dir="auto">timeframe</code> argument. If the value is a negative number from -1 to -500, the function calculates the expected timestamp of the <code dir="auto">timeframe</code> bar corresponding to N bars after the current bar on the main timeframe. The default is 0. See the <a href="/pine-script-docs/concepts/time/#calculating-timestamps-at-bar-offsets">Calculating timestamps at bar offsets</a> section to learn more about this parameter.</li>
<li>The optional <code dir="auto">timeframe_bars_back</code> parameter accepts an “int” value specifying the additional bar offset on the timeframe specified by the <code dir="auto">timeframe</code> argument. If the value is positive, the function retrieves the timestamp of the <code dir="auto">timeframe</code> bar that is N <code dir="auto">timeframe</code> bars before the one corresponding to the <code dir="auto">bars_back</code> offset. If the value is a negative number from -1 to -500, the function calculates the expected timestamp of the <code dir="auto">timeframe</code> bar that is N <code dir="auto">timeframe</code> bars after the one corresponding to the <code dir="auto">bars_back</code> offset. The default is 0. See the <a href="/pine-script-docs/concepts/time/#calculating-timestamps-at-bar-offsets">Calculating timestamps at bar offsets</a> section to learn more about this parameter.</li>
</ul>
<p>Similar to the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> variables, these functions behave differently on <em>time-based</em> and <em>non-time-based</em> charts.</p>
<p>Time-based charts have bars that open and close at <em>predictable</em> times, whereas the bars on <a href="https://www.tradingview.com/support/solutions/43000709225/">tick charts</a> and all <a href="/pine-script-docs/concepts/non-standard-charts-data/">non-standard charts</a>, excluding <a href="https://www.tradingview.com/support/solutions/43000619436/">Heikin Ashi</a>, open and close at irregular, <em>unpredictable</em> times. Consequently, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> cannot calculate the expected closing time of an open realtime bar on non-time-based charts, so it returns <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> on that bar. Similarly, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> function with a negative bar offset cannot accurately calculate the expected opening time of a future realtime bar on these charts. See the <em>second example</em> in <a href="/pine-script-docs/concepts/time/#time-and-time_close-variables">this section</a> above. That example script exhibits the same behavior on a price-based chart if it uses a <code dir="auto">time_close("")</code> call instead of the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> variable.</p>
<p>On non-time-based charts, a new bar’s closing time is available in the realtime data feed once the bar closes. Therefore, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> can retrieve valid closing timestamps for <em>confirmed realtime bars</em> without needing to restart the script to load them historically. See the <em>third example</em> in <a href="/pine-script-docs/concepts/time/#time-and-time_close-variables">this section</a> above. Replacing the <code dir="auto">time_close[1]</code> variable in the example script with a <code dir="auto">time_close("", 1)</code> call achieves the same result to retrieve the closing time of the elapsed realtime bar.</p>
<p>Typical use cases for the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions include:</p>
<ul>
<li>Testing for bars that open or close in <a href="/pine-script-docs/concepts/time/#testing-for-sessions">specific sessions</a> defined by the <code dir="auto">session</code> and <code dir="auto">timezone</code> parameters.</li>
<li><a href="/pine-script-docs/concepts/time/#testing-for-changes-in-higher-timeframes">Testing for changes</a> or measuring time differences on specified higher timeframes.</li>
<li><a href="/pine-script-docs/concepts/time/#calculating-timestamps-at-bar-offsets">Calculating timestamps at bar offsets</a> on the script’s main timeframe, a specified timeframe, or both.</li>
</ul>
<h4 id="testing-for-sessions" class="md-heading"><a href="#testing-for-sessions">Testing for <span class="fancy-wrap">sessions<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h4>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions’ <code dir="auto">session</code> and <code dir="auto">timezone</code> parameters define the <a href="/pine-script-docs/concepts/sessions/">sessions</a> for which they can return <em>non-na</em> values. If a call to either function references a bar that opens/closes within the defined session in a given <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>, it returns a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> for that bar. Otherwise, it returns <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>. Programmers can pass the returned values to the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_na">na()</a> function to identify which bars open or close within specified intervals, which is helpful for session-based calculations and logic.</p>
<p>This simple script identifies when a bar on the chart’s timeframe opens at or after 11:00 and before 13:00 in the exchange time zone on any trading day. It calls <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> with <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timeframe.period">timeframe.period</a> as the <code dir="auto">timeframe</code> argument and the <code dir="auto">"1100-1300"</code> <a href="/pine-script-docs/concepts/sessions/#time-based-sessions">session string</a> as the <code dir="auto">session</code> argument, and then verifies whether the returned value is <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a> with the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_na">na()</a> function. When the value is <strong>not</strong> <a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>, the script highlights the chart’s background to indicate that the bar opened in the session:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-sessions-1.CJeOvGxZ_Z1sBkKc.webp" alt="image" width="1458" height="534" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="73f"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Testing&nbsp;for&nbsp;session&nbsp;bars&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Checks&nbsp;if&nbsp;the&nbsp;bar&nbsp;opens&nbsp;between&nbsp;11:00&nbsp;and&nbsp;13:00.&nbsp;</span><span class="mtk9">Is&nbsp;`true`&nbsp;if&nbsp;the&nbsp;`time()`&nbsp;function&nbsp;does&nbsp;not&nbsp;return</span><span class="mtk9">&nbsp;`na`.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">inSession</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk16">na</span><span class="mtk13">(</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk11">timeframe.period</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"1100-1300"</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;of&nbsp;the&nbsp;bars&nbsp;that&nbsp;are&nbsp;i</span><span class="mtk9">n&nbsp;the&nbsp;session&nbsp;"11:00-13:00".&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">inSession</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">155</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">39</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">176</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <code dir="auto">session</code> argument in the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> call represents an interval in the <em>exchange</em> time zone because <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> is the default <code dir="auto">timezone</code> argument.</li>
<li>The session string expresses the start and end times in the <code dir="auto">"HHmm-HHmm"</code> format, where <code dir="auto">"HH"</code> is the two-digit <em>hour</em> and <code dir="auto">"mm"</code> is the two-digit <em>minute</em>. Session strings can also specify the <em>weekdays</em> a session applies to. However, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> call’s <code dir="auto">session</code> argument (<code dir="auto">"1100-1300"</code>) does not include this information, which is why it considers the session valid for <em>every</em> day. See the <a href="/pine-script-docs/concepts/sessions/">Sessions</a> page to learn more.</li>
</ul>
<p>When using session strings in <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> calls, it’s crucial to understand that such strings define start and end times in a <em>specific</em> <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>. The local hour and minute in one region may not correspond to the same point in UNIX time as that same hour and minute in another region. Therefore, calls to these functions with different <code dir="auto">timezone</code> arguments can return non-na timestamps at <em>different</em> times, as the specified <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> changes the meaning of the local times represented in the <code dir="auto">session</code> argument.</p>
<p>This example demonstrates how the <code dir="auto">timezone</code> parameter affects the <code dir="auto">session</code> parameter in a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> function call. The script calculates an <code dir="auto">opensInSession</code> condition that uses a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> call with arguments based on <a href="/pine-script-docs/concepts/inputs/">inputs</a>. The <a href="/pine-script-docs/concepts/inputs/#session-input">session input</a> for the <code dir="auto">session</code> argument includes four preset options: <code dir="auto">"0000-0400"</code>, <code dir="auto">"0930-1400"</code>, <code dir="auto">"1300-1700"</code>, and <code dir="auto">"1700-2100"</code>. The <a href="/pine-script-docs/concepts/inputs/#string-input">string input</a> that defines the <code dir="auto">timezone</code> argument includes four IANA time zone options representing different offsets from UTC: <code dir="auto">"America/Vancouver"</code> (UTC-7/-8), <code dir="auto">"America/New_York"</code> (UTC-4/-5), <code dir="auto">"Asia/Dubai"</code> (UTC+4), and <code dir="auto">"Austrailia/Sydney"</code> (UTC+10/+11).</p>
<p>For any chosen <code dir="auto">sessionInput</code> value, changing the <code dir="auto">timezoneInput</code> value changes the specified session’s time zone. The script highlights <em>different bars</em> with each time zone choice because, unlike <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a>, the <em>absolute</em> times that local hour and minute values correspond to <em>varies</em> across time zones:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-sessions-2.DKRpvO46_Z1pg5HR.webp" alt="image" width="1566" height="570" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="7pf"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Testing&nbsp;session&nbsp;time&nbsp;zones&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;timeframe&nbsp;of&nbsp;the&nbsp;analyzed&nbsp;bars.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeframeInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.timeframe</span><span class="mtk13">(</span><span class="mtk29">"60"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Timeframe"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;session&nbsp;to&nbsp;check.&nbsp;Features&nbsp;four&nbsp;interval&nbsp;opti</span><span class="mtk9">ons.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">sessionInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.session</span><span class="mtk13">(</span><span class="mtk29">"1300-1700"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Session"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk13">[</span><span class="mtk29">"0000-0400"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"0930-1400"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"1300-1700"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"1700-2100"</span><span class="mtk13">])</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;IANA&nbsp;identifier&nbsp;representing&nbsp;the&nbsp;time&nbsp;zone&nbsp;of&nbsp;</span><span class="mtk9">the&nbsp;`sessionInput`.&nbsp;Fetures&nbsp;four&nbsp;preset&nbsp;options.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.string</span><span class="mtk13">(</span><span class="mtk29">"America/New_York"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;zone"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">[</span><span class="mtk29">"America/Vancouver"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"America/New_York"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Asia/Dubai"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Australia/Sydney"</span><span class="mtk13">]</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;if&nbsp;a&nbsp;`timeframeInput`&nbsp;bar&nbsp;opens&nbsp;within&nbsp;</span><span class="mtk9">the&nbsp;`sessionInput`&nbsp;session&nbsp;in&nbsp;the&nbsp;`timezoneInput`&nbsp;</span><span class="mtk9">time&nbsp;zone.</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;condition&nbsp;detects&nbsp;the&nbsp;session&nbsp;on&nbsp;d</span><span class="mtk9">ifferent&nbsp;bars,&nbsp;depending&nbsp;on&nbsp;the&nbsp;chosesn&nbsp;time&nbsp;zone,</span><span class="mtk9">&nbsp;because&nbsp;identical&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;times&nbsp;in&nbsp;different&nbsp;time&nbsp;zones&nbsp;re</span><span class="mtk9">fer&nbsp;to&nbsp;different&nbsp;absolute&nbsp;points&nbsp;in&nbsp;UNIX&nbsp;time.&nbsp;&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">opensInSession</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk16">na</span><span class="mtk13">(</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk33">timeframeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">sessionInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneInput</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;`opensInSession`&nbsp;</span><span class="mtk9">is&nbsp;`true`.&nbsp;</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">opensInSession</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">33</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">149</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">243</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Open&nbsp;in&nbsp;session&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This script uses <em>IANA notation</em> for all <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone strings</a> because it is the recommended format. Using an IANA identifier allows the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> call to automatically adjust the session’s UTC offset based on a region’s local time policies, such as daylight saving time.</li>
</ul>
<h4 id="testing-for-changes-in-higher-timeframes" class="md-heading"><a href="#testing-for-changes-in-higher-timeframes">Testing for changes in higher <span class="fancy-wrap">timeframes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h4>
<p>The <code dir="auto">timeframe</code> parameter of the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions specifies the timeframe of the bars in the calculation, allowing scripts to retrieve opening/closing <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> from <em>higher timeframes</em> than the current chart’s timeframe without requiring <code dir="auto">request.*()</code> function calls.</p>
<p>Programmers can use the opening/closing timestamps from higher-timeframe (HTF) bars to detect timeframe changes. One common approach is to call <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> or <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> with a consistent <code dir="auto">timeframe</code> argument across all executions on a time-based chart and measure the one-bar change in the returned value with the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_ta.change">ta.change()</a> function. The result is a <em>nonzero</em> value only when an HTF bar opens. One can also check whether the data has a time gap at that point by comparing the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> value to the previous bar’s <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> value. A gap is present when the opening timestamp on the current bar is greater than the closing timestamp on the previous bar.</p>
<p>The script below uses the call <code dir="auto">time("1M")</code> to get the opening UNIX timestamp of the current bar on the “1M” timeframe, then assigns the result to the <code dir="auto">currMonthlyOpenTime</code> variable. It detects when bars on that timeframe open by checking when the one-bar change in the <code dir="auto">currMonthlyOpenTime</code> value is above zero. On each occurrence of the condition, the script detects whether the HTF bar opened after a gap by checking if the new opening timestamp is greater than the “1M” closing timestamp from the previous chart bar (<code dir="auto">time_close("1M")[1]</code>).</p>
<p>The script draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a> containing <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> “1M” opening times to indicate the chart bars that mark the start of monthly bars. If a monthly bar opens without a gap from the previous closing time, the script draws a blue label. If a monthly bar starts after a gap, it draws a red label. Additionally, if the “1M” opening time does not match the opening time of the chart bar, the script displays that bar’s formatted time in the label for comparison:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-changes-in-higher-timeframes-1.EwKXV91R_16xSC0.webp" alt="image" width="1336" height="640" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="4x0"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Detecting&nbsp;changes&nbsp;in&nbsp;higher&nbsp;timeframes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;opening&nbsp;UNIX&nbsp;timestamp&nbsp;of&nbsp;the&nbsp;current&nbsp;bar&nbsp;on&nbsp;</span><span class="mtk9">the&nbsp;"1M"&nbsp;timeframe.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">currMonthlyOpenTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk29">"1M"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;closing&nbsp;timestamp&nbsp;on&nbsp;the&nbsp;"1M"&nbsp;timeframe&nbsp;as&nbsp;of</span><span class="mtk9">&nbsp;the&nbsp;previous&nbsp;chart&nbsp;bar.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">prevMonthlyCloseTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time_close</span><span class="mtk13">(</span><span class="mtk29">"1M"</span><span class="mtk13">)[</span><span class="mtk12">1</span><span class="mtk13">]</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;opening&nbsp;time&nbsp;on&nbsp;the&nbsp;"1M"&nbsp;timef</span><span class="mtk9">rame&nbsp;changes,&nbsp;indicating&nbsp;a&nbsp;new&nbsp;monthly&nbsp;bar.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">isNewTf</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.change</span><span class="mtk13">(</span><span class="mtk33">currMonthlyOpenTime</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">isNewTf</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;variables&nbsp;for&nbsp;the&nbsp;`text`&nbsp;and&nbsp;`color`</span><span class="mtk9">&nbsp;properties&nbsp;of&nbsp;the&nbsp;label&nbsp;drawing.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">lblText</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;'1M'&nbsp;opening&nbsp;time:\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">currMonthlyOpenTime</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk33">lblColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.blue</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;`currMonthlyOpenTime`&nbsp;exceeds&nbsp;</span><span class="mtk9">the&nbsp;`prevMonthlyCloseTime`,&nbsp;indicating&nbsp;a&nbsp;time&nbsp;gap.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">hasGap</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">currMonthlyOpenTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">prevMonthlyCloseTime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Modify&nbsp;the&nbsp;`lblText`&nbsp;and&nbsp;`lblColor`&nbsp;based&nbsp;on&nbsp;th</span><span class="mtk9">e&nbsp;`hasGap`&nbsp;value.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">hasGap</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lblText</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Gap&nbsp;from&nbsp;previous&nbsp;'1M'&nbsp;close.\n\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">lblText</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lblColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Include&nbsp;the&nbsp;formatted&nbsp;`time`&nbsp;value&nbsp;if&nbsp;the&nbsp;`curr</span><span class="mtk9">MonthlyOpenTime`&nbsp;is&nbsp;before&nbsp;the&nbsp;first&nbsp;available&nbsp;cha</span><span class="mtk9">rt&nbsp;bar's&nbsp;`time`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">time</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">currMonthlyOpenTime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lblText</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\nFirst&nbsp;chart&nbsp;bar&nbsp;has&nbsp;a&nbsp;later&nbsp;time:\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;`lblColor`&nbsp;label&nbsp;anchored&nbsp;to&nbsp;the&nbsp;`time`&nbsp;</span><span class="mtk9">to&nbsp;display&nbsp;the&nbsp;`lblText`.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lblText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">lblColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">style</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_lower_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>Using <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_ta.change">ta.change()</a> on a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> or <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> call’s result is not the <em>only</em> way to detect changes in a higher timeframe. The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timeframe.change">timeframe.change()</a> function is an equivalent, more convenient option for scripts that do not need to <em>use</em> the UNIX timestamps from HTF bars in other calculations, as it returns a “bool” value directly without extra code.</li>
<li>The detected monthly opening times do not always correspond to the first calendar day of the month. Instead, they correspond to the first time assigned to a “1M” bar, which can be <em>after</em> the first calendar day. For symbols with overnight sessions, such as “USDJPY” in our example chart, a “1M” bar can also open <em>before</em> the first calendar day.</li>
<li>Sometimes, the opening time assigned to an HTF bar might <em>not</em> equal the opening time of any chart bar, which is why other conditions such as <code dir="auto">time == time("1M")</code> cannot detect new monthly bars consistently. For example, on our “USDJPY” chart, the “1M” opening time <code dir="auto">2023-12-31T17:00:00-0500</code> does not match an opening time on the “1D” timeframe. The first available “1D” bar after that point opened at <code dir="auto">2024-01-01T17:00:00-0500</code>.</li>
</ul>
<h4 id="calculating-timestamps-at-bar-offsets" class="md-heading"><a href="#calculating-timestamps-at-bar-offsets">Calculating timestamps at bar <span class="fancy-wrap">offsets<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h4>
<p>The <code dir="auto">bars_back</code> and <code dir="auto">timeframe_bars_back</code> parameters of the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> functions control <em>bar offsets</em> in the calculations, enabling the functions to compute the opening/closing <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> for bars that are <em>before</em> or <em>after</em> the current bar, on a given timeframe, without requiring <code dir="auto">request.*()</code> calls or history-referencing operations.</p>
<p>The <code dir="auto">bars_back</code> parameter controls the bar offset on the script’s <strong>main timeframe</strong>, and the <code dir="auto">timeframe_bars_back</code> parameter controls the bar offset on the <strong>separate timeframe</strong> specified by the <code dir="auto">timeframe</code> argument. A call to either function evaluates <em>both</em> offsets in succession to determine the returned timestamp:</p>
<ol>
<li>
<p>The call evaluates the <code dir="auto">bars_back</code> offset. If the value is a positive number from 1 to 5000, the call finds the bar that is the specified number of bars <em>before</em> the current one on the main timeframe, then retrieves the time of the corresponding <code dir="auto">timeframe</code> bar. If the value is a negative number from -1 to -500, the call calculates the <em>expected</em> time of the <code dir="auto">timeframe</code> bar corresponding to N main-timeframe bars <em>after</em> the current bar. If the value is 0 (default), the call retrieves the time of the <em>current</em> <code dir="auto">timeframe</code> bar.</p>
</li>
<li>
<p>The call evaluates the <code dir="auto">timeframe_bars_back</code> offset for the specified timeframe to determine the final timestamp. If the value is positive and less than or equal to 5000, the call returns the timestamp for the <code dir="auto">timeframe</code> bar that is the specified number of periods <em>before</em> the one corresponding to the <code dir="auto">bars_back</code> offset. If the value is negative and greater than or equal to -500, the call returns the <em>expected</em> timestamp of the <code dir="auto">timeframe</code> bar that is N periods <em>after</em> the one corresponding to the <code dir="auto">bars_back</code> offset. If the value is 0 (default), the call does not apply an additional timeframe-based offset to the calculation.</p>
</li>
</ol>
<p>The following example shows how the <code dir="auto">bars_back</code> and <code dir="auto">timeframe_bars_back</code> parameters work together in timestamp calculations. The script below creates three drawings on the last historical bar, anchored to the results from different <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> calls that return timestamps based on a specified chart bar offset (<code dir="auto">chartOffsetInput</code>) and a higher-timeframe (HTF) offset (<code dir="auto">tfOffsetInput</code>):</p>
<ul>
<li>The first drawing is a vertical <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">line</a> indicating the chart bar at the <code dir="auto">bars_back</code> offset (<code dir="auto">chartOffsetInput</code>), which the other drawings use in their timestamp calculations. The line uses the value from <code dir="auto">time("", bars_back = chartOffsetInput)</code> as the <code dir="auto">x1</code> and <code dir="auto">x2</code> coordinates.</li>
<li>The second is a blue <a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">box</a> showing the range of the higher-timeframe (HTF) bar that <em>contains</em> the offset chart bar indicated by the line. It uses the value of <code dir="auto">time(tfInput, bars_back = chartOffsetInput)</code> as the <code dir="auto">left</code> coordinate, and the value of <code dir="auto">time_close(tfInput, bars_back = chartOffsetInput)</code> as the <code dir="auto">right</code> coordinate.</li>
<li>The third is a purple box that shows the range of the HTF bar that is <code dir="auto">tfOffsetInput</code> periods <em>away</em> from the HTF bar represented by the blue box. The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> calls for this box use the same <code dir="auto">timeframe</code> and <code dir="auto">bars_back</code> arguments as those for the blue box, and they include <code dir="auto">timeframe_bars_back = tfOffsetInput</code> to apply the additional HTF bar offset.</li>
</ul>
<p>Both boxes also display <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> opening and closing timestamps, expressed in the exchange time zone, to show the time ranges covered by their respective periods:</p>
<div class="pine-colorizer not-content colorized" data-id="4x3"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Calculating&nbsp;timestamps&nbsp;at&nbsp;bar&nbsp;offsets&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">behind_chart</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Sets&nbsp;the&nbsp;timeframe&nbsp;for&nbsp;the&nbsp;box&nbsp;timestamp&nbsp;calculat</span><span class="mtk9">ions.&nbsp;</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.timeframe</span><span class="mtk13">(</span><span class="mtk29">"1D"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Higher&nbsp;timeframe"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;offset&nbsp;on&nbsp;the&nbsp;script's&nbsp;main&nbsp;timeframe&nbsp;(chart&nbsp;</span><span class="mtk9">timeframe&nbsp;in&nbsp;this&nbsp;example).</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Chart&nbsp;bar&nbsp;offset"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">-500</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;offset&nbsp;on&nbsp;the&nbsp;higher&nbsp;timeframe&nbsp;specified&nbsp;by&nbsp;`</span><span class="mtk9">tfInput`.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOffsetInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HTF&nbsp;offset"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">-500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Create&nbsp;persistent&nbsp;arrays&nbsp;to&nbsp;store&nbsp;opening&nbsp;time,</span><span class="mtk9">&nbsp;high,&nbsp;and&nbsp;low&nbsp;values&nbsp;for&nbsp;the&nbsp;chart&nbsp;drawings.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">array</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">int</span><span class="mtk13">&gt;</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk33">times</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">int</span><span class="mtk13">&gt;()</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">array</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">float</span><span class="mtk13">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">highs</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">float</span><span class="mtk13">&gt;()</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">array</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">float</span><span class="mtk13">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">lows</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">float</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;opening&nbsp;time&nbsp;of&nbsp;the&nbsp;current&nbsp;bar&nbsp;on&nbsp;the&nbsp;`tfInp</span><span class="mtk9">ut`&nbsp;timeframe,&nbsp;with&nbsp;no&nbsp;offset.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOpen0</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk33">tfInput</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">switch</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;a&nbsp;new&nbsp;element&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;all&nbsp;three&nbsp;array</span><span class="mtk9">s&nbsp;if&nbsp;the&nbsp;`tfOpen0`&nbsp;value&nbsp;changes,&nbsp;indicating&nbsp;a&nbsp;new</span><span class="mtk9">&nbsp;HTF&nbsp;bar.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">ta.change</span><span class="mtk13">(</span><span class="mtk33">tfOpen0</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">highs</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lows</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk11">low</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">times</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk33">tfOpen0</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Otherwise,&nbsp;set&nbsp;the&nbsp;last&nbsp;element&nbsp;in&nbsp;the&nbsp;`highs`&nbsp;</span><span class="mtk9">and&nbsp;`lows`&nbsp;arrays&nbsp;to&nbsp;track&nbsp;the&nbsp;period's&nbsp;highest&nbsp;an</span><span class="mtk9">d&nbsp;lowest&nbsp;values.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">times</span><span class="mtk1">.</span><span class="mtk15">size</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">highs</span><span class="mtk1">.</span><span class="mtk15">set</span><span class="mtk13">(</span><span class="mtk12">-1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk33">highs</span><span class="mtk1">.</span><span class="mtk15">last</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk13">))</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lows</span><span class="mtk1">.</span><span class="mtk15">set</span><span class="mtk13">(</span><span class="mtk12">-1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.min</span><span class="mtk13">(</span><span class="mtk33">lows</span><span class="mtk1">.</span><span class="mtk15">last</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk33">times</span><span class="mtk1">.</span><span class="mtk15">size</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Get&nbsp;the&nbsp;opening&nbsp;timestamp&nbsp;for&nbsp;the&nbsp;*chart&nbsp;bar*&nbsp;t</span><span class="mtk9">hat&nbsp;is&nbsp;`chartOffsetInput`&nbsp;bars&nbsp;back,&nbsp;relative&nbsp;to&nbsp;t</span><span class="mtk9">he&nbsp;current&nbsp;bar.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartTFOpen</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk29">""</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;line&nbsp;to&nbsp;show&nbsp;the&nbsp;offset&nbsp;bar's&nbsp;position.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">chartTFOpen</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">[</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk33">chartOffsetInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">chartTFOpen</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk13">[</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk33">chartOffsetInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)]</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">extend.both</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Get&nbsp;the&nbsp;timestamps&nbsp;of&nbsp;the&nbsp;HTF&nbsp;bar&nbsp;that&nbsp;*contain</span><span class="mtk9">s*&nbsp;the&nbsp;chart&nbsp;bar&nbsp;at&nbsp;`chartOffsetInput`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOpen1</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk33">tfInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfClose1</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time_close</span><span class="mtk13">(</span><span class="mtk33">tfInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Get&nbsp;the&nbsp;`times`&nbsp;index&nbsp;for&nbsp;`tfOpen1`&nbsp;to&nbsp;retrieve</span><span class="mtk9">&nbsp;the&nbsp;first&nbsp;offset&nbsp;HTF&nbsp;bar's&nbsp;high&nbsp;and&nbsp;low&nbsp;values.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">offsetIndex1</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">times</span><span class="mtk1">.</span><span class="mtk15">binary_search_leftmost</span><span class="mtk13">(</span><span class="mtk33">tfOpen1</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;box&nbsp;to&nbsp;show&nbsp;the&nbsp;HTF&nbsp;bar&nbsp;that&nbsp;opens&nbsp;at&nbsp;`t</span><span class="mtk9">fOpen1`&nbsp;and&nbsp;closes&nbsp;at&nbsp;`tfClose1`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tfOpen1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">highs</span><span class="mtk1">.</span><span class="mtk15">get</span><span class="mtk13">(</span><span class="mtk33">offsetIndex1</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfClose1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lows</span><span class="mtk1">.</span><span class="mtk15">get</span><span class="mtk13">(</span><span class="mtk33">offsetIndex1</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#2196f399</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Open:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">tfOpen1</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n\nClose:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">tfClose1</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Get&nbsp;the&nbsp;timestamps&nbsp;of&nbsp;the&nbsp;HTF&nbsp;bar&nbsp;that&nbsp;is&nbsp;`tfOf</span><span class="mtk9">fsetInput`&nbsp;*HTF&nbsp;periods&nbsp;back*,&nbsp;relative&nbsp;to&nbsp;the&nbsp;one</span><span class="mtk9">&nbsp;that&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;opens&nbsp;at&nbsp;`tfOpen1`&nbsp;and&nbsp;closes&nbsp;at&nbsp;`tfClose1`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOpen2</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time</span><span class="mtk13">(</span><span class="mtk33">tfInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeframe_bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOffsetInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfClose2</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time_close</span><span class="mtk13">(</span><span class="mtk33">tfInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">chartOffsetInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeframe_bars_back</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfOffsetInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Get&nbsp;the&nbsp;`times`&nbsp;index&nbsp;for&nbsp;`tfOpen2`&nbsp;to&nbsp;retrieve</span><span class="mtk9">&nbsp;the&nbsp;second&nbsp;offset&nbsp;HTF&nbsp;bar's&nbsp;high&nbsp;and&nbsp;low&nbsp;values.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">offsetIndex2</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">times</span><span class="mtk1">.</span><span class="mtk15">binary_search_leftmost</span><span class="mtk13">(</span><span class="mtk33">tfOpen2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;box&nbsp;to&nbsp;show&nbsp;the&nbsp;HTF&nbsp;bar&nbsp;that&nbsp;opens&nbsp;at&nbsp;`t</span><span class="mtk9">fOpen2`&nbsp;and&nbsp;closes&nbsp;at&nbsp;`tfClose2`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">tfOpen2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">highs</span><span class="mtk1">.</span><span class="mtk15">get</span><span class="mtk13">(</span><span class="mtk33">offsetIndex2</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">tfClose2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lows</span><span class="mtk1">.</span><span class="mtk15">get</span><span class="mtk13">(</span><span class="mtk33">offsetIndex2</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9c27b099</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Open:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">tfOpen2</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n\nClose:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">tfClose2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;the&nbsp;background&nbsp;of&nbsp;the&nbsp;last&nbsp;historical&nbsp;bar</span><span class="mtk9">&nbsp;for&nbsp;visual&nbsp;reference.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.islastconfirmedhistory</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Last&nbsp;historical&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The script tracks high, low, and opening time values for each HTF period in <a href="/pine-script-docs/language/arrays/">arrays</a> to determine the price ranges of the boxes. The arrays contain one element for each successive <a href="/pine-script-docs/concepts/time/#testing-for-changes-in-higher-timeframes">change</a> in the value of <code dir="auto">time(tfInput)</code>. The script <a href="/pine-script-docs/language/arrays/#searching-arrays">searches</a> through the <code dir="auto">times</code> array and finds the indices of the earliest elements that match the calculated HTF opening times, then uses the <code dir="auto">highs</code> and <code dir="auto">lows</code> array elements at those indices to set the top and bottom edges of the boxes.</li>
</ul>
<p>In the image below, we applied the script to a chart with the “240” (4 hour) timeframe, using the default settings. The vertical line is at the last historical bar because the “Chart bar offset” input’s value is 0, and the blue box displays the HTF range that contains that chart bar. The purple box shows the range that is one HTF period <em>before</em> the blue box, because the “HTF offset” input’s value is 1:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-functions-Calculating-timestamps-at-bar-offsets-1.DcEMMg3B_RUoKE.webp" alt="image" width="2358" height="1354" loading="lazy" decoding="async"></p>
<p>If we change the chart bar offset to -4, the vertical line moves four bars <em>forward</em> on the chart. In the following image, that chart bar belongs to the <em>next</em> HTF period, not the current one. Therefore, the blue box now displays the <em>expected</em> time range of the future HTF bar. With the same HTF offset of 1, the purple box now shows the <em>current</em> HTF bar’s range, because its timestamps are always one HTF period behind those for the blue box:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-functions-Calculating-timestamps-at-bar-offsets-2.CrnGcGog_Z1sVFWd.webp" alt="image" width="2358" height="1350" loading="lazy" decoding="async"></p>
<p>If we increase the HTF offset to 3, the distance from the purple box to the blue box is three HTF periods, regardless of how we change the chart bar offset. In this image, the purple box now shows the range from two HTF bars before the current one, because our chart offset still refers to the upcoming HTF bar:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-functions-Calculating-timestamps-at-bar-offsets-3.CwaV-eSs_17y787.webp" alt="image" width="2354" height="1356" loading="lazy" decoding="async"></p>
<h3 id="calendar-based-functions" class="md-heading"><a href="#calendar-based-functions">Calendar-based <span class="fancy-wrap">functions<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_year">year()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_weekofyear">weekofyear()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_hour">hour()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_minute">minute()</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_second">second()</a> functions calculate <em>calendar-based</em> “int” values from a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a>. Unlike the <a href="/pine-script-docs/concepts/time/#calendar-based-variables">calendar-based variables</a>, which always hold exchange calendar values based on the current bar’s opening timestamp, these functions can return calendar values for any valid timestamp and express them in a chosen <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>.</p>
<p>Each of these calendar-based functions has the following two signatures:</p>
<div class="expressive-code not-content"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">functionName(time) → series int</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">functionName(time, timezone) → series int</span></div></div></code></pre></figure></div>
<p>Where:</p>
<ul>
<li><code dir="auto">functionName</code> is the function’s identifier.</li>
<li>The <code dir="auto">time</code> parameter accepts an “int” UNIX timestamp for which the function calculates a corresponding calendar value.</li>
<li>The <code dir="auto">timezone</code> parameter accepts a <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> specifying the returned value’s time zone. If the <code dir="auto">timezone</code> argument is not specified, the function uses the exchange time zone (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a>).</li>
</ul>
<p>In contrast to the functions that return UNIX timestamps, a calendar-based function returns different “int” results for various time zones, as calendar values represent parts of a <em>local time</em> in a <em>specific region</em>.</p>
<p>For instance, the simple script below uses two calls to <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> to calculate each bar’s opening day in the exchange time zone and the “Australia/Sydney” time zone. It plots the results of the two calls in a separate pane for comparison:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-1.7yz46qU5_56taF.webp" alt="image" width="1792" height="736" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="4y7"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`dayofmonth()`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;"int"&nbsp;representing&nbsp;the&nbsp;current&nbsp;bar's&nbsp;opening&nbsp;c</span><span class="mtk9">alendar&nbsp;day&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalent&nbsp;to&nbsp;the&nbsp;`dayofmonth`&nbsp;variabl</span><span class="mtk9">e.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">openingDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;"int"&nbsp;representing&nbsp;the&nbsp;current&nbsp;bar's&nbsp;opening&nbsp;c</span><span class="mtk9">alendar&nbsp;day&nbsp;in&nbsp;the&nbsp;"Australia/Sydney"&nbsp;time&nbsp;zone.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">openingDaySydney</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Australia/Sydney"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;calendar&nbsp;day&nbsp;values.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">openingDay</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"Day&nbsp;of&nbsp;Month&nbsp;(Exchange)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.blue</span><span class="mtk13">)</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">openingDaySydney</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Day&nbsp;of&nbsp;Month&nbsp;(Sydney)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The first <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> call calculates the bar’s opening day in the exchange time zone because it does not include a <code dir="auto">timezone</code> argument. This call returns the same value that the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_dayofmonth">dayofmonth</a> variable references.</li>
<li>Our example symbol’s exchange time zone is “America/New_York”, which follows UTC-5 during standard time and UTC-4 during daylight saving time (DST). The “Australia/Sydney” time zone follows UTC+10 during standard time and UTC+11 during DST. However, Sydney observes DST at <em>different</em> times of the year than New York. As such, its time zone is 14, 15, or 16 hours ahead of the exchange time zone, depending on the time of year. The plots on our “1D” chart diverge when the difference is at least 15 hours because the bars open at 09:30 in exchange time, and 15 hours ahead is 00:30 on the <em>next</em> calendar day.</li>
</ul>
<p>It’s important to understand that although the <code dir="auto">time</code> argument in a calendar-based function call represents a single, absolute point in time, each function returns only <em>part</em> of the date and time information available from the timestamp. Consequently, a calendar-based function’s returned value does <strong>not</strong> directly correspond to a <em>unique</em> time point, and conditions based on individual calendar values can apply to <em>multiple</em> bars.</p>
<p>For example, this script uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function to calculate a UNIX timestamp from a date “string”, and it calculates the calendar day from that timestamp, in the exchange time zone, with the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> function. The script compares each bar’s opening day to the calculated day and highlights the background when the two are equal:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-2.CLs3hZaQ_Z1mTUCj.webp" alt="image" width="1468" height="494" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="1e2"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`dayofmonth()`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;August&nbsp;29,&nbsp;20</span><span class="mtk9">24&nbsp;at&nbsp;00:00:00&nbsp;UTC.</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">fixedTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"29&nbsp;Aug&nbsp;2024"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;day&nbsp;of&nbsp;the&nbsp;month&nbsp;calculated&nbsp;from&nbsp;the&nbsp;`fixedTi</span><span class="mtk9">mestamp`,&nbsp;expressed&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone&nbsp;has&nbsp;a&nbsp;negati</span><span class="mtk9">ve&nbsp;UTC&nbsp;offset,&nbsp;this&nbsp;variable's&nbsp;value&nbsp;is&nbsp;28&nbsp;instead</span><span class="mtk9">&nbsp;of&nbsp;29.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">dayFromTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk33">fixedTimestamp</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;"int"&nbsp;representing&nbsp;the&nbsp;current&nbsp;bar's&nbsp;opening&nbsp;c</span><span class="mtk9">alendar&nbsp;day&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Equivalent&nbsp;to&nbsp;the&nbsp;`dayofmonth`&nbsp;variabl</span><span class="mtk9">e.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">openingDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;`openingDay`.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">openingDay</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Opening&nbsp;day&nbsp;of&nbsp;month"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">linewidth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;the&nbsp;`openingDay`&nbsp;</span><span class="mtk9">equals&nbsp;the&nbsp;`dayFromTimestamp`.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">openingDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk33">dayFromTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Day&nbsp;detected&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call treats its argument as a <em>UTC</em> calendar date because its <code dir="auto">dateString</code> argument does not specify time zone information. However, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> call calculates the day in the <em>exchange time zone</em>. Our example symbol’s exchange time zone is “America/New_York” (UTC-4/-5). Therefore, the returned value on this chart is 28 instead of 29.</li>
<li>The script highlights <em>any</em> bar on our chart that opens on the 28th day of <em>any</em> month instead of only a specific bar because the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofmonth">dayofmonth()</a> function’s returned value does <strong>not</strong> represent a specific point in time on its own.</li>
<li>This script highlights the bars that <em>open</em> on the day of the month calculated from the timestamp. However, some months on our chart have no trading activity on that day. For example, the script does not highlight when the July 28, 2024 occurs on our chart because NASDAQ is closed on Sundays.</li>
</ul>
<p>Similar to <a href="/pine-script-docs/concepts/time/#calendar-based-variables">calendar-based variables</a>, these functions are also helpful when testing for dates/times and detecting calendar changes on the chart. The example below uses the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_year">year()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_month">month()</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_weekofyear">weekofyear()</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a> functions on the <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> timestamp to create conditions that test if the current bar is the first bar that closes in a new year, quarter, month, week, and day. The script <a href="/pine-script-docs/concepts/text-and-shapes/#plotshape">plots shapes</a>, draws <a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a>, and uses <a href="/pine-script-docs/concepts/backgrounds/">background colors</a> to visualize the conditions on the chart:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-3.BgN06lg1_1QVzL3.webp" alt="image" width="1336" height="640" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="3b8"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Calendar&nbsp;changes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_labels_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Calculate&nbsp;the&nbsp;year,&nbsp;month,&nbsp;week&nbsp;of&nbsp;year,&nbsp;and&nbsp;da</span><span class="mtk9">y&nbsp;of&nbsp;week&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;`time_close`&nbsp;UNIX&nbsp;t</span><span class="mtk9">imestamp.</span></span><br><span><span class="mtk9">//&nbsp;All&nbsp;values&nbsp;are&nbsp;expressed&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;z</span><span class="mtk9">one.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeYear</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">year</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeMonth</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">month</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeWeekOfYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">weekofyear</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeDayOfWeek</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofweek</span><span class="mtk13">(</span><span class="mtk11">time_close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;change&nbsp;in&nbsp;`closeYear`&nbsp;exceeds&nbsp;</span><span class="mtk9">0,&nbsp;marking&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;closes&nbsp;in&nbsp;a&nbsp;new&nbsp;year</span><span class="mtk9">.&nbsp;&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.change</span><span class="mtk13">(</span><span class="mtk33">closeYear</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;difference&nbsp;in&nbsp;`closeMonth`&nbsp;is&nbsp;</span><span class="mtk9">not&nbsp;0,&nbsp;marking&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;closes&nbsp;in&nbsp;a&nbsp;new&nbsp;</span><span class="mtk9">month.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeMonth</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;`closeMonth&nbsp;-&nbsp;1`&nbsp;becomes&nbsp;divisible</span><span class="mtk9">&nbsp;by&nbsp;3,&nbsp;marking&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;closes&nbsp;in&nbsp;a&nbsp;new&nbsp;</span><span class="mtk9">quarter.&nbsp;</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewQuarter</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">closeMonth</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">closeMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;change&nbsp;in&nbsp;`closeWeekOfYear`&nbsp;is</span><span class="mtk9">&nbsp;not&nbsp;0,&nbsp;marking&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;closes&nbsp;in&nbsp;a&nbsp;new</span><span class="mtk9">&nbsp;week.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewWeek</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.change</span><span class="mtk13">(</span><span class="mtk33">closeWeekOfYear</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;the&nbsp;`closeDayOfWeek`&nbsp;changes,&nbsp;mark</span><span class="mtk9">ing&nbsp;the&nbsp;first&nbsp;bar&nbsp;that&nbsp;closes&nbsp;in&nbsp;the&nbsp;new&nbsp;day.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeDayOfWeek</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeDayOfWeek</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">]</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Switches&nbsp;between&nbsp;`true`&nbsp;and&nbsp;`false`&nbsp;after&nbsp;every&nbsp;`</span><span class="mtk9">closeInNewDay`&nbsp;occurrence&nbsp;for&nbsp;background&nbsp;color&nbsp;cal</span><span class="mtk9">culation.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">alternateDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewDay</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">alternateDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk33">alternateDay</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;label&nbsp;above&nbsp;the&nbsp;bar&nbsp;to&nbsp;display&nbsp;the&nbsp;`clos</span><span class="mtk9">eWeekOfYear`&nbsp;when&nbsp;`closeInNewWeek`&nbsp;is&nbsp;`true`.&nbsp;</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeInNewWeek</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"W"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">closeWeekOfYear</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">yloc.abovebar</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.normal</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;label&nbsp;shapes&nbsp;at&nbsp;the&nbsp;bottom&nbsp;and&nbsp;top&nbsp;of&nbsp;the&nbsp;</span><span class="mtk9">chart&nbsp;for&nbsp;the&nbsp;`closeInNewYear`&nbsp;and&nbsp;`closeInNewMont</span><span class="mtk9">h`&nbsp;conditions.&nbsp;</span></span><br><span><span class="mtk16">plotshape</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closeInNewYear</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Close&nbsp;in&nbsp;new&nbsp;year"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">shape.labelup</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">location.bottom</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;year"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.huge</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk16">plotshape</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closeInNewMonth</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Close&nbsp;in&nbsp;new&nbsp;month"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">shape.labeldown</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">location.top</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;month"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;a&nbsp;triangle&nbsp;below&nbsp;the&nbsp;chart&nbsp;bar&nbsp;when&nbsp;`close</span><span class="mtk9">InNewQuarter`&nbsp;occurs.&nbsp;</span></span><br><span><span class="mtk16">plotshape</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closeInNewQuarter</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Close&nbsp;in&nbsp;new&nbsp;quarter"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">shape.triangleup</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">location.belowbar</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;quarter"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;in&nbsp;alternating&nbsp;colors&nbsp;</span><span class="mtk9">based&nbsp;on&nbsp;occurrences&nbsp;of&nbsp;`closeInNewDay`.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">alternateDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.aqua</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.fuchsia</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Closing&nbsp;day&nbsp;change"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This script’s conditions check for the first bar that closes after each calendar unit changes its value. The bar where each condition is <code dir="auto">true</code> varies with the data available on the chart. For example, the <code dir="auto">closeInNewMonth</code> condition can be <code dir="auto">true</code> <em>after</em> the first calendar day of the month if a chart bar did not close on that day.</li>
<li>To detect when new bars start on a specific <em>timeframe</em> rather than strictly calendar changes, check when the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_ta.change">ta.change()</a> of a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time">time()</a> or <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_time_close">time_close()</a> call’s returned value is nonzero, or use the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timeframe.change">timeframe.change()</a> function. See <a href="/pine-script-docs/concepts/time/#testing-for-changes-in-higher-timeframes">this section</a> above for more information.</li>
</ul>
<h3 id="timestamp" class="md-heading"><a href="#timestamp"><span>​<code dir="auto">timestamp()</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function calculates a <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> from a specified calendar date and time. It has the following three signatures:</p>
<div class="expressive-code not-content"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text" tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">timestamp(year, month, day, hour, minute, second) → simple/series int</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">timestamp(timezone, year, month, day, hour, minute, second) → simple/series int</span></div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">timestamp(dateString) → const int</span></div></div></code></pre></figure></div>
<p>The first two signatures listed include <code dir="auto">year</code>, <code dir="auto">month</code>, <code dir="auto">day</code>, <code dir="auto">hour</code>, <code dir="auto">minute</code>, and <code dir="auto">second</code> parameters that accept “int” values defining the calendar date and time. A <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call with either signature must include <code dir="auto">year</code>, <code dir="auto">month</code>, and <code dir="auto">day</code> arguments. The other parameters are optional, each with a default value of 0. Both signatures can return either <em>“simple”</em> or <em>“series”</em> values, depending on the <a href="/pine-script-docs/language/type-system/#qualifiers">qualified types</a> of the specified arguments.</p>
<p>The primary difference between the first two signatures is the <code dir="auto">timezone</code> parameter, which accepts a <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> that determines the <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a> of the <em>date and time</em> specified by the other parameters. If a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call with “int” calendar arguments does not include a <code dir="auto">timezone</code> argument, it uses the exchange time zone (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a>) by default.</p>
<p>The third signature listed has only <em>one</em> parameter, <code dir="auto">dateString</code>, which accepts a “string” representing a valid calendar date (e.g., <code dir="auto">"20 Aug 2024"</code>). The value can also include the time of day and time zone (e.g., <code dir="auto">"20 Aug 2024 00:00:00 UTC+0"</code>). If the <code dir="auto">dateString</code> argument does not specify the time of day, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call considers the time 00:00 (midnight).</p>
<p>Unlike the other two signatures, the default time zone for the third signature is <strong>GMT+0</strong>. It does <strong>not</strong> use the exchange time zone by default because it interprets time zone information from the <code dir="auto">dateString</code> directly. Additionally, the third signature is the only one that returns a <em>“const int”</em> value. As shown in the <a href="/pine-script-docs/concepts/inputs/#time-input">Time input</a> section of the <a href="/pine-script-docs/concepts/inputs/">Inputs</a> page, programmers can use this overload’s returned value as the <code dir="auto">defval</code> argument in an <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_input.time">input.time()</a> function call.</p>
<p>When using the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> function, it’s crucial to understand how time zone information affects its calculations. The <em>absolute</em> point in time represented by a specific calendar date <em>depends</em> on its time zone, as an identical date and time in various time zones can refer to <strong>different</strong> amounts of time elapsed since the <em>UNIX Epoch</em>. Therefore, changing the time zone of the calendar date and time in a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call <em>can change</em> its returned <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a>.</p>
<p>The following script compares the results of four different <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> calls that evaluate the date 2021-01-01 in different time zones. The first <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call does not specify time zone information in its <code dir="auto">dateString</code> argument, so it treats the value as a <em>UTC</em> calendar date. The fourth call also evaluates the calendar date in UTC because it includes <code dir="auto">"UTC0"</code> as the <code dir="auto">timezone</code> argument. The second <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call uses the first signature listed above, meaning it uses the exchange time zone, and the third call uses the second signature with <code dir="auto">"America/New_York"</code> as the <code dir="auto">timezone</code> argument.</p>
<p>The script draws a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> with rows displaying each <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> call, its assigned variable, the calculated UNIX timestamp, and a <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> representation of the time. As we see on the “NASDAQ:MSFT” chart below, the first and fourth table rows show <em>different</em> timestamps than the second and third, leading to different formatted strings in the last column:</p>
<p><img src="/pine-script-docs/_astro/Time-Time-functions-Timestamp-1.CFLoCdL8_A5DD7.webp" alt="image" width="1378" height="472" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="661"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"`timestamp()`&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`table`&nbsp;that&nbsp;displays&nbsp;the&nbsp;different&nbsp;`timestamp(</span><span class="mtk9">)`&nbsp;calls,&nbsp;their&nbsp;returned&nbsp;timestamps,&nbsp;and&nbsp;formatted</span><span class="mtk9">&nbsp;results.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">position.middle_center</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">5</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Initializes&nbsp;a&nbsp;`displayTable`&nbsp;cell&nbsp;showing&nbsp;the&nbsp;`di</span><span class="mtk9">splayText`&nbsp;with&nbsp;an&nbsp;optional&nbsp;`specialFormat`.</span></span><br><span><span class="mtk15">printCell</span><span class="mtk13">(</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">specialFormat</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">""</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">switch</span><span class="mtk1">&nbsp;</span><span class="mtk33">specialFormat</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"header"</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell_set_bgcolor</span><span class="mtk13">(</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">76</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">175</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">79</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"code"</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell_set_text_font_family</span><span class="mtk13">(</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">font.family_monospace</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell_set_text_size</span><span class="mtk13">(</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.normal</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell_set_text_halign</span><span class="mtk13">(</span><span class="mtk33">colID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;January&nbsp;1,&nbsp;20</span><span class="mtk9">21&nbsp;in&nbsp;the&nbsp;UTC+0&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">dateTimestamp1</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"2021-01-01"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;January&nbsp;1,&nbsp;20</span><span class="mtk9">21&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">dateTimestamp2</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk12">2021</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;January&nbsp;1,&nbsp;20</span><span class="mtk9">21&nbsp;in&nbsp;the&nbsp;"America/New_York"&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">dateTimestamp3</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"America/New_York"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2021</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;UNIX&nbsp;timestamp&nbsp;corresponding&nbsp;to&nbsp;January&nbsp;1,&nbsp;20</span><span class="mtk9">21&nbsp;in&nbsp;the&nbsp;"UTC0"&nbsp;(UTC+0)&nbsp;time&nbsp;zone.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">dateTimestamp4</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"UTC0"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2021</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;the&nbsp;top&nbsp;header&nbsp;cells&nbsp;in&nbsp;the&nbsp;`display</span><span class="mtk9">Table`.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Variable"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Function&nbsp;call"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Timestamp&nbsp;returned"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Formatted&nbsp;date/time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;table&nbsp;row&nbsp;for&nbsp;`dateTimestamp1`&nbsp;res</span><span class="mtk9">ults.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`dateTimestamp1`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timestamp(\"2021-01-01\")`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"code"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp1</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"yyyy.MM.dd&nbsp;&nbsp;HH:mm&nbsp;(Z)"</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;table&nbsp;row&nbsp;for&nbsp;`dateTimestamp2`&nbsp;res</span><span class="mtk9">ults.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`dateTimestamp2`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timestamp(2021,&nbsp;1,&nbsp;1,&nbsp;0,&nbsp;0)`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"code"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp2</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"yyyy.MM.dd&nbsp;&nbsp;HH:mm&nbsp;(Z)"</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;table&nbsp;row&nbsp;for&nbsp;`dateTimestamp3`&nbsp;res</span><span class="mtk9">ults.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`dateTimestamp3`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timestamp(\"America/New_York\",&nbsp;2021,&nbsp;1,&nbsp;1,&nbsp;0,&nbsp;0</span><span class="mtk29">)`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"code"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp3</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"yyyy.MM.dd&nbsp;&nbsp;HH:mm&nbsp;(Z)"</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;table&nbsp;row&nbsp;for&nbsp;`dateTimestamp4`&nbsp;res</span><span class="mtk9">ults.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`dateTimestamp4`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"header"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timestamp(\"UTC0\",&nbsp;2021,&nbsp;1,&nbsp;1,&nbsp;0,&nbsp;0)`"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"code"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp4</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">printCell</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">dateTimestamp4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"yyyy.MM.dd&nbsp;&nbsp;HH:mm&nbsp;(Z)"</span><span class="mtk13">))</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> date-time strings express results in the exchange time zone because the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function uses <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> as the default <code dir="auto">timezone</code> argument. The formatted values on our example chart show the offset string <code dir="auto">"-0500"</code> because NASDAQ’s time zone (“America/New_York”) follows UTC-5 during <em>standard time</em>.</li>
<li>The formatted strings on the first and fourth rows show the date and time five hours <em>before</em> January 1, 2021, because the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> calls evaluated the date in <em>UTC</em> and the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> calls used a time zone five hours <em>behind</em> UTC.</li>
<li>On our chart, the second and third rows have matching timestamps because both corresponding <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timestamp">timestamp()</a> calls evaluated the date in the “America/New_York” time zone. The two rows would show different results if we applied the script to a symbol with a different exchange time zone.</li>
</ul>
<h2 id="formatting-dates-and-times" class="md-heading"><a href="#formatting-dates-and-times">Formatting dates and <span class="fancy-wrap">times<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Programmers can format <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a> into human-readable dates and times, expressed in specific <a href="/pine-script-docs/concepts/time/#time-zones">time zones</a>, using the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function. The function has the following signature:</p>
<div class="expressive-code not-content"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">str.format_time(time, format, timezone) → series string</span></div></div></code></pre></figure></div>
<p>Where:</p>
<ul>
<li>The <code dir="auto">time</code> parameter specifies the “int” UNIX timestamp to express as a readable time.</li>
<li>The <code dir="auto">format</code> parameter accepts a “string” consisting of <em>formatting tokens</em> that determine the returned information. If the function call does not include a <code dir="auto">format</code> argument, it uses the <a href="https://en.wikipedia.org/wiki/ISO_8601" rel="nofollow">ISO 8601</a> standard format: <code dir="auto">"yyyy-MM-dd'T'HH:mm:ssZ"</code>. See the table below for a list of valid tokens and the information they represent.</li>
<li>The <code dir="auto">timezone</code> parameter determines the time zone of the formatted result. It accepts a <a href="/pine-script-docs/concepts/time/#time-zone-strings">time zone string</a> in UTC or IANA notation. If the call does not specify a <code dir="auto">timezone</code>, it uses the exchange time zone (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a>).</li>
</ul>
<p>The general-purpose <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format">str.format()</a> function can also format UNIX timestamps into readable dates and times. However, the function <strong>cannot</strong> express time information in <em>different</em> time zones. It always expresses dates and times in <strong>UTC+0</strong>. In turn, using this function to format timestamps often results in <em>erroneous</em> practices, such as mathematically modifying a timestamp to try and represent the time in another time zone. However, a UNIX timestamp is a unique, <strong>time zone-agnostic</strong> representation of a specific point in time. As such, modifying a UNIX timestamp changes the <em>absolute time</em> it represents rather than expressing the same time in a different time zone.</p>
<p>The <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function does not have this limitation, as it can calculate dates and times in <em>any</em> time zone correctly without changing the meaning of a UNIX timestamp. In addition, unlike <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format">str.format()</a>, it is optimized specifically for processing time values. Therefore, we recommend that programmers use <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> instead of <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format">str.format()</a> to format UNIX timestamps into readable dates and times.</p>
<p>A <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> call’s <code dir="auto">format</code> argument determines the time information its returned value contains. The function treats characters and sequences in the argument as <em>formatting tokens</em>, which act as <em>placeholders</em> for values in the returned date/time “string”. The following table outlines the most commonly used formatting tokens and explains what each represents:</p>































































































<table><thead><tr><th style="text-align:center">Token</th><th style="text-align:center">Represents</th><th style="text-align:left">Remarks and examples</th></tr></thead><tbody><tr><td style="text-align:center"><code dir="auto">"y"</code></td><td style="text-align:center">Year</td><td style="text-align:left">Use <code dir="auto">"yy"</code> to include the last two digits of the year (e.g., <code dir="auto">"00"</code>), or <code dir="auto">"yyyy"</code> to include the complete year number (e.g., <code dir="auto">"2000"</code>).</td></tr><tr><td style="text-align:center"><code dir="auto">"M"</code></td><td style="text-align:center">Month</td><td style="text-align:left">Uppercase <code dir="auto">"M"</code> for the month, not to be confused with <em>lowercase</em> <code dir="auto">"m"</code> for the minute. <br>Use <code dir="auto">"MM"</code> to include the two-digit month number with a leading zero for single-digit values (e.g., <code dir="auto">"01"</code>), <code dir="auto">"MMM"</code> to include the three-letter abbreviation of month (e.g., <code dir="auto">"Jan"</code>), or <code dir="auto">"MMMM"</code> for the full month name (e.g., <code dir="auto">"January"</code>).</td></tr><tr><td style="text-align:center"><code dir="auto">"d"</code></td><td style="text-align:center">Day of the <strong>month</strong></td><td style="text-align:left">Lowercase <code dir="auto">"d"</code>. <br>Includes the numeric day of the month (<code dir="auto">"1"</code> to <code dir="auto">"31"</code>). <br> Use <code dir="auto">"dd"</code> for the two-digit day number with a leading zero for single-digit values. <br>It is <em>not</em> a placeholder for the day number of the <em>week</em> (1-7). Use <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_dayofweek">dayofweek()</a> to calculate that value.</td></tr><tr><td style="text-align:center"><code dir="auto">"D"</code></td><td style="text-align:center">Day of the <strong>year</strong></td><td style="text-align:left">Uppercase <code dir="auto">"D"</code>. <br> Includes the numeric day of the year (<code dir="auto">"1"</code> to <code dir="auto">"366"</code>). <br> Use <code dir="auto">"DD"</code> or <code dir="auto">"DDD"</code> for the two-digit or three-digit day number with leading zeros.</td></tr><tr><td style="text-align:center"><code dir="auto">"E"</code></td><td style="text-align:center">Day of the <strong>week</strong></td><td style="text-align:left">Includes the abbreviation of the weekday <em>name</em> (e.g., <code dir="auto">"Mon"</code>). <br> Use <code dir="auto">"EEEE"</code> for the weekday’s full name (e.g., <code dir="auto">"Monday"</code>)</td></tr><tr><td style="text-align:center"><code dir="auto">"w"</code></td><td style="text-align:center">Week of the <strong>year</strong></td><td style="text-align:left">Lowercase <code dir="auto">"w"</code>. <br>Includes the week number of the year (<code dir="auto">"1"</code> to <code dir="auto">"53"</code>). <br>Use <code dir="auto">"ww"</code> for the two-digit week number with a leading zero for single-digit values.</td></tr><tr><td style="text-align:center"><code dir="auto">"W"</code></td><td style="text-align:center">Week of the <strong>month</strong></td><td style="text-align:left">Uppercase <code dir="auto">"W"</code>. <br>Includes the week number of the month (<code dir="auto">"1"</code> to <code dir="auto">"5"</code>).</td></tr><tr><td style="text-align:center"><code dir="auto">"a"</code></td><td style="text-align:center">AM/PM postfix</td><td style="text-align:left">Lowercase <code dir="auto">"a"</code>. <br>Includes <code dir="auto">"AM"</code> if the time of day is before noon, <code dir="auto">"PM"</code> otherwise.</td></tr><tr><td style="text-align:center"><code dir="auto">"h"</code></td><td style="text-align:center">Hour in the <strong>12-hour</strong> format</td><td style="text-align:left">Lowercase <code dir="auto">"h"</code>. <br>The included hour number from this token ranges from <code dir="auto">"0"</code> to <code dir="auto">"11"</code>. <br>Use <code dir="auto">"hh"</code> for the two-digit hour with a leading zero for single-digit values.</td></tr><tr><td style="text-align:center"><code dir="auto">"H"</code></td><td style="text-align:center">Hour in the <strong>24-hour</strong> format</td><td style="text-align:left">Uppercase <code dir="auto">"H"</code>. <br>The included hour number from this token ranges from <code dir="auto">"0"</code> to <code dir="auto">"23"</code>. <br>Use <code dir="auto">"HH"</code> for the two-digit hour with a leading zero for single-digit values.</td></tr><tr><td style="text-align:center"><code dir="auto">"m"</code></td><td style="text-align:center">Minute</td><td style="text-align:left">Lowercase <code dir="auto">"m"</code> for the minute, not to be confused with <em>uppercase</em> <code dir="auto">"M"</code> for the month. <br>Use <code dir="auto">"mm"</code> for the two-digit minute with a leading zero for single-digit values.</td></tr><tr><td style="text-align:center"><code dir="auto">"s"</code></td><td style="text-align:center">Second</td><td style="text-align:left">Lowercase <code dir="auto">"s"</code> for the second, not to be confused with <em>uppercase</em> <code dir="auto">"S"</code> for fractions of a second. <br>Use <code dir="auto">"ss"</code> for the two-digit second with a leading zero for single-digit values.</td></tr><tr><td style="text-align:center"><code dir="auto">"S"</code></td><td style="text-align:center">Fractions of a second</td><td style="text-align:left">Uppercase <code dir="auto">"S"</code>. <br> Includes the number of milliseconds in the fractional second (<code dir="auto">"0"</code> to <code dir="auto">"999"</code>). <br> Use <code dir="auto">"SS"</code> or <code dir="auto">"SSS"</code> for the two-digit or three-digit millisecond number with leading zeros.</td></tr><tr><td style="text-align:center"><code dir="auto">"Z"</code></td><td style="text-align:center">Time zone (<strong>UTC offset</strong>)</td><td style="text-align:left">Uppercase <code dir="auto">"Z"</code>. <br> Includes the hour and minute UTC offset value in <code dir="auto">"HHmm"</code> format, preceded by its sign (e.g., <code dir="auto">"-0400"</code>).</td></tr><tr><td style="text-align:center"><code dir="auto">"z"</code></td><td style="text-align:center">Time zone (<strong>abbreviation or name</strong>)</td><td style="text-align:left">Lowercase <code dir="auto">"z"</code>. <br> A single <code dir="auto">"z"</code> includes the abbreviation of the time zone (e.g., <code dir="auto">"EDT"</code>). <br> Use <code dir="auto">"zzzz"</code> for the time zone’s name (e.g., <code dir="auto">"Eastern Daylight Time"</code>). <br>It is not a placeholder for the <em>IANA identifier</em>. Use <a href="https://www.tradingview.com/pine-script-reference/v6/#var_syminfo.timezone">syminfo.timezone</a> to retrieve the exchange time zone’s IANA representation.</td></tr><tr><td style="text-align:center"><code dir="auto">":"</code>, <code dir="auto">"/"</code>, <code dir="auto">"-"</code>, <code dir="auto">"."</code>, <code dir="auto">","</code>, <code dir="auto">"("</code>, <code dir="auto">")"</code>, <code dir="auto">" "</code></td><td style="text-align:center">Separators</td><td style="text-align:left">These characters are separators for formatting tokens. <br>They appear as they are in the formatted text. (e.g., <code dir="auto">"01/01/24"</code>, <code dir="auto">"12:30:00"</code>, <code dir="auto">"Jan 1, 2024"</code>). <br> Some other characters can also act as separators. However, the ones listed are the most common.</td></tr><tr><td style="text-align:center"><code dir="auto">"'"</code></td><td style="text-align:center">Escape character</td><td style="text-align:left">Characters enclosed within <em>two single quotes</em> appear as they are in the result, even if they otherwise act as formatting tokens. For example, <code dir="auto">" 'Day' "</code> appears as-is in the resulting “string” instead of listing the day of the year, AM/PM postfix, and year.</td></tr></tbody></table>
<p>The following example demonstrates how various formatting tokens affect the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function’s result. The script calls the function with different <code dir="auto">format</code> arguments to create date/time strings from <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>, <a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a>, and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_time_close">time_close</a> timestamps. It displays each <code dir="auto">format</code> value and the corresponding formatted result in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> on the last bar:</p>
<p><img src="/pine-script-docs/_astro/Time-Formatting-dates-and-times-1.BsC0g9qz_29jz4f.webp" alt="image" width="1338" height="528" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="6lf"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Formatting&nbsp;dates&nbsp;and&nbsp;times&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`table`&nbsp;that&nbsp;displays&nbsp;different&nbsp;date/time&nbsp;`form</span><span class="mtk9">at`&nbsp;strings&nbsp;and&nbsp;their&nbsp;results.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">position.middle_center</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">15</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">frame_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">frame_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">border_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Initializes&nbsp;a&nbsp;`displayTable`&nbsp;row&nbsp;showing&nbsp;a&nbsp;`forma</span><span class="mtk9">tString`&nbsp;and&nbsp;its&nbsp;formatted&nbsp;result&nbsp;for&nbsp;a&nbsp;specified&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`timeValue`&nbsp;and&nbsp;`timezoneValue`.</span></span><br><span><span class="mtk15">displayText</span><span class="mtk13">(</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">syminfo.timezone</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;light&nbsp;blue&nbsp;if&nbsp;the&nbsp;`rowID`&nbsp;is&nbsp;even,&nbsp;white&nbsp;other</span><span class="mtk9">wise.&nbsp;Used&nbsp;to&nbsp;set&nbsp;alternating&nbsp;table&nbsp;row&nbsp;colors.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">33</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">149</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">243</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">75</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Display&nbsp;the&nbsp;`formatString`&nbsp;in&nbsp;the&nbsp;row's&nbsp;first&nbsp;c</span><span class="mtk9">ell.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowColor</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Show&nbsp;the&nbsp;result&nbsp;of&nbsp;formatting&nbsp;the&nbsp;`timeValue`&nbsp;b</span><span class="mtk9">ased&nbsp;on&nbsp;the&nbsp;`formatString`&nbsp;and&nbsp;`timezoneValue`&nbsp;in&nbsp;</span><span class="mtk9">the&nbsp;second&nbsp;cell.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowID</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">timeValue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatString</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneValue</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">rowColor</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;the&nbsp;table's&nbsp;header&nbsp;cells.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"FORMAT&nbsp;STRINGS"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"FORMATTED&nbsp;DATE/TIME&nbsp;OUTPUT"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;row&nbsp;to&nbsp;show&nbsp;the&nbsp;default&nbsp;date-time&nbsp;</span><span class="mtk9">"string"&nbsp;format&nbsp;and&nbsp;its&nbsp;result&nbsp;for&nbsp;`time`.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"(Default&nbsp;`str.format_time()`&nbsp;format)"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.yellow</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.black</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.yellow</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;rows&nbsp;to&nbsp;show&nbsp;different&nbsp;formatting&nbsp;st</span><span class="mtk9">rings&nbsp;and&nbsp;their&nbsp;results&nbsp;for&nbsp;`time`,&nbsp;`time_close`,&nbsp;</span><span class="mtk9">and&nbsp;`timenow`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"MMMM&nbsp;dd,&nbsp;yyyy"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"hh:mm:ss.SS&nbsp;a"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">5</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm&nbsp;'UTC'Z"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"H:mm&nbsp;a&nbsp;(zzzz)"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">7</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"my&nbsp;day&nbsp;/&nbsp;'my&nbsp;day'&nbsp;('escaped')"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">8</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Month'&nbsp;M,&nbsp;'Week'&nbsp;w,&nbsp;'Day'&nbsp;DDD"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">9</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Bar&nbsp;expected&nbsp;closing&nbsp;time':&nbsp;ha"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">time_close</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">10</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Current&nbsp;date/time':&nbsp;MMM-d-y&nbsp;HH:mm:ss&nbsp;z"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">11</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'New&nbsp;Time&nbsp;zone':&nbsp;zzzz"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timezoneValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Australia/Sydney"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayText</span><span class="mtk13">(</span><span class="mtk12">12</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"'Time&nbsp;zone&nbsp;change':&nbsp;MMM-d-y&nbsp;HH:mm:ss&nbsp;z"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Australia/Sydney"</span><span class="mtk13">)</span></span><br></code></div>
<h2 id="expressing-time-differences" class="md-heading"><a href="#expressing-time-differences">Expressing time <span class="fancy-wrap">differences<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Every <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamp</a> represents a specific point in time as the absolute <em>time difference</em> from a fixed historical point (epoch). The specific epoch all UNIX timestamps reference is <em>midnight UTC on January 1, 1970</em>. Programmers can <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">format</a> UNIX timestamps into readable date-time strings with the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function because it uses the time difference from the UNIX Epoch in its date and time calculations.</p>
<p>In contrast, the difference between two nonzero UNIX timestamps represents the number of milliseconds elapsed from one absolute point to another. The difference does not directly refer to a specific point in UNIX time if neither timestamp in the operation has a value of 0 (corresponding to the UNIX Epoch).</p>
<p>Programmers may want to express the millisecond difference between two UNIX timestamps in <em>other time units</em>, such as seconds, days, etc. Some might assume they can use the difference as the <code dir="auto">time</code> argument in a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> call to achieve this result. However, the function always treats its <code dir="auto">time</code> argument as the time elapsed from the <em>UNIX Epoch</em> to derive a <em>calendar date/time</em> representation in a specific <a href="/pine-script-docs/concepts/time/#time-zones">time zone</a>. It <strong>does not</strong> express time differences directly. Therefore, attempting to format timestamp <em>differences</em> rather than timestamps with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> leads to unintended results.</p>
<p>For example, the following script calculates the millisecond difference between the current execution time (<a href="https://www.tradingview.com/pine-script-reference/v6/#var_timenow">timenow</a>) and the “1M” bar’s closing time (<code dir="auto">time_close("1M")</code>) for a monthly countdown timer display. It attempts to express the time difference in another format using <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a>. It displays the function call’s result in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a>, along with the original millisecond difference (<code dir="auto">timeLeft</code>) and <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> date-time representations of the timestamps.</p>
<p>As we see below, the table shows correct results for the formatted timestamps and the <code dir="auto">timeLeft</code> value. However, the formatted time difference appears as <code dir="auto">"1970-01-12T16:47:10-0500"</code>. Although the <code dir="auto">timeLeft</code> value is supposed to represent a difference between timestamps rather than a specific point in time, the <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format_time">str.format_time()</a> function still treats the value as a <strong>UNIX timestamp</strong>. Consequently, it creates a “string” expressing the value as a <em>date and time</em> in the UTC-5 time zone:</p>
<p><img src="/pine-script-docs/_astro/Time-Relative-time-differences-1.Bn5sSvwp_ZWpy0r.webp" alt="image" width="1666" height="562" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="343"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Incorrectly&nbsp;formatting&nbsp;time&nbsp;difference&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;table&nbsp;that&nbsp;displays&nbsp;monthly&nbsp;close&nbsp;countdown&nbsp;inf</span><span class="mtk9">ormation.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.top_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">188</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">212</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">60</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islast</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;UNIX&nbsp;timestamp&nbsp;representing&nbsp;the&nbsp;current&nbsp;time&nbsp;as</span><span class="mtk9">&nbsp;of&nbsp;the&nbsp;script's&nbsp;latest&nbsp;execution.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">currentTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">timenow</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;UNIX&nbsp;timestamp&nbsp;representing&nbsp;the&nbsp;expected&nbsp;closin</span><span class="mtk9">g&nbsp;time&nbsp;of&nbsp;the&nbsp;current&nbsp;"1M"&nbsp;bar.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">monthCloseTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time_close</span><span class="mtk13">(</span><span class="mtk29">"1M"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;milliseconds&nbsp;between&nbsp;the&nbsp;`currentTi</span><span class="mtk9">me`&nbsp;and&nbsp;the&nbsp;`monthCloseTime`.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;value&nbsp;is&nbsp;NOT&nbsp;intended&nbsp;as&nbsp;a&nbsp;UNIX&nbsp;t</span><span class="mtk9">imestamp.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeLeft</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">monthCloseTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">currentTime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;`timeLeft`&nbsp;as&nbsp;a&nbsp;date&nbsp;</span><span class="mtk9">and&nbsp;time&nbsp;in&nbsp;the&nbsp;exchange&nbsp;time&nbsp;zone,&nbsp;in&nbsp;ISO&nbsp;8601&nbsp;fo</span><span class="mtk9">rmat.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;format&nbsp;is&nbsp;INCORRECT&nbsp;for&nbsp;the&nbsp;`time</span><span class="mtk9">Left`&nbsp;value&nbsp;because&nbsp;it's&nbsp;supposed&nbsp;to&nbsp;represent&nbsp;the</span><span class="mtk9">&nbsp;time&nbsp;between&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;two&nbsp;nonzero&nbsp;UNIX&nbsp;timestamps,&nbsp;NOT&nbsp;a&nbsp;spe</span><span class="mtk9">cific&nbsp;point&nbsp;in&nbsp;time.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">incorrectTimeFormat</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">timeLeft</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;`displayTable`&nbsp;cells&nbsp;to&nbsp;initialize&nbsp;t</span><span class="mtk9">he&nbsp;`currentTime`&nbsp;and&nbsp;`monthCloseTime`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Current&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">currentTime</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss.S&nbsp;dd/MM/yy&nbsp;(z)"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_right</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`1M`&nbsp;Bar&nbsp;closing&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">monthCloseTime</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"HH:mm:ss.SS&nbsp;dd/MM/yy&nbsp;(z)"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_right</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;cell&nbsp;to&nbsp;display&nbsp;the&nbsp;`timeLeft`&nbsp;mil</span><span class="mtk9">lisecond&nbsp;difference.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"`timeLeft`&nbsp;value:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">timeLeft</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.yellow</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;a&nbsp;cell&nbsp;to&nbsp;display&nbsp;the&nbsp;`incorrectTime</span><span class="mtk9">Format`&nbsp;representation.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;left&nbsp;(incorrect&nbsp;format):&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">incorrectTimeFormat</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>To express the difference between timestamps in other time units correctly, programmers must write code that <em>calculates</em> the number of units elapsed instead of erroneously formatting the difference as a specific date or time.</p>
<p>The calculations required to express time differences depend on the chosen time units. The sections below explain how to express millisecond differences in <a href="/pine-script-docs/concepts/time/#weekly-and-smaller-units">weekly and smaller units</a>, and <a href="/pine-script-docs/concepts/time/#monthly-and-larger-units">monthly and larger units</a>.</p>
<h3 id="weekly-and-smaller-units" class="md-heading"><a href="#weekly-and-smaller-units">Weekly and smaller <span class="fancy-wrap">units<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Weeks and smaller time units (days, hours, minutes, seconds, and milliseconds) cover <em>consistent</em> blocks of time. These units have the following relationship:</p>
<ul>
<li>One week equals seven days.</li>
<li>One day equals 24 hours.</li>
<li>One hour equals 60 minutes.</li>
<li>One minute equals 60 seconds.</li>
<li>One second equals 1000 milliseconds.</li>
</ul>
<p>Using this relationship, programmers can define the span of these units by the number of <em>milliseconds</em> they contain. For example, since every hour has 60 minutes, every minute has 60 seconds, and every second has 1000 milliseconds, the number of milliseconds per hour is <code dir="auto">60 * 60 * 1000</code>, which equals <code dir="auto">3600000</code>.</p>
<p>Programmers can use <em>modular arithmetic</em> based on the milliseconds in each unit to calculate the total number of weeks, days, and smaller spans covered by the difference between two <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a>. The process is as follows, starting from the <em>largest</em> time unit in the calculation:</p>
<ol>
<li>Calculate the number of milliseconds in the time unit.</li>
<li>Divide the remaining millisecond difference by the calculated value and round down to the nearest whole number. The result represents the number of <em>complete</em> time units within the interval.</li>
<li>Use the <em>remainder</em> from the division as the new remaining millisecond difference.</li>
<li>Repeat steps 1-3 for each time unit in the calculation, in <em>descending</em> order based on size.</li>
</ol>
<p>The following script implements this process in a custom <code dir="auto">formatTimeSpan()</code> function. The function accepts two UNIX timestamps defining a start and end point, and its “bool” parameters control whether it calculates the number of weeks or smaller units covered by the time range. The function calculates the millisecond distance between the two timestamps. It then calculates the numbers of complete units covered by that distance and formats the results into a “string”.</p>
<p>The script calls <code dir="auto">formatTimeSpan()</code> to express the difference between two separate <a href="/pine-script-docs/concepts/inputs/#time-input">time input</a> values in selected time units. It then displays the resulting “string” in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a> alongside <a href="/pine-script-docs/concepts/time/#formatting-dates-and-times">formatted</a> representations of the start and end times:</p>
<p><img src="/pine-script-docs/_astro/Time-Relative-time-differences-Weekly-and-smaller-units-1.CkIHycnQ_yxUkv.webp" alt="image" width="1256" height="412" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="7dn"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Calculating&nbsp;time&nbsp;span&nbsp;demo"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Assign&nbsp;the&nbsp;number&nbsp;of&nbsp;milliseconds&nbsp;in&nbsp;weekly&nbsp;and</span><span class="mtk9">&nbsp;smaller&nbsp;units&nbsp;to&nbsp;"const"&nbsp;variables&nbsp;for&nbsp;convenienc</span><span class="mtk9">e.</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_WEEK</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">604800000</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_DAY</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk12">86400000</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_HOUR</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk12">3600000</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_MINUTE</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">60000</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_SECOND</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">1000</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;UNIX&nbsp;timestamp&nbsp;calculated&nbsp;from&nbsp;the&nbsp;user-input&nbsp;s</span><span class="mtk9">tart&nbsp;date&nbsp;and&nbsp;time.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTimeInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.time</span><span class="mtk13">(</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"1&nbsp;May&nbsp;2022&nbsp;00:00&nbsp;-0400"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Start&nbsp;date&nbsp;and&nbsp;time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;between"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;UNIX&nbsp;timestamp&nbsp;calculated&nbsp;from&nbsp;the&nbsp;user-input&nbsp;e</span><span class="mtk9">nd&nbsp;date&nbsp;and&nbsp;time.&nbsp;</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTimeInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk16">input.time</span><span class="mtk13">(</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"7&nbsp;Sep&nbsp;2024&nbsp;20:37&nbsp;-0400"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"End&nbsp;date&nbsp;and&nbsp;time"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;between"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Create&nbsp;"bool"&nbsp;inputs&nbsp;to&nbsp;toggle&nbsp;weeks,&nbsp;days,&nbsp;hou</span><span class="mtk9">rs,&nbsp;minutes,&nbsp;seconds,&nbsp;and&nbsp;milliseconds&nbsp;in&nbsp;the&nbsp;calc</span><span class="mtk9">ulation.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">weeksInput</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Weeks"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"A"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInput</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Days"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"A"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">hoursInput</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Hours"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"B"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">minutesInput</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Minutes"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"B"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondsInput</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Seconds"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"B"</span><span class="mtk13">)</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">millisecondsInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.bool</span><span class="mtk13">(</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Milliseconds"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;units"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">inline</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"B"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Calculates&nbsp;the&nbsp;difference&nbsp;between&nbsp;two&nbsp;UNIX&nbsp;timest</span><span class="mtk9">amps&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;complete&nbsp;time&nbsp;units&nbsp;in&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;descending&nbsp;order&nbsp;of&nbsp;size,&nbsp;formatting&nbsp;t</span><span class="mtk9">he&nbsp;results&nbsp;into&nbsp;a&nbsp;"string".&nbsp;The&nbsp;"int"&nbsp;parameters&nbsp;a</span><span class="mtk9">ccept&nbsp;timestamps,&nbsp;</span></span><br><span><span class="mtk9">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;the&nbsp;"bool"&nbsp;parameters&nbsp;determine&nbsp;wh</span><span class="mtk9">ich&nbsp;units&nbsp;the&nbsp;function&nbsp;uses&nbsp;in&nbsp;its&nbsp;calculations.&nbsp;</span></span><br><span><span class="mtk15">formatTimeSpan</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTimestamp</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateWeeks</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateDays</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateHours</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateMinutes</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateSeconds</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateMilliseconds</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;milliseconds&nbsp;between&nbsp;the&nbsp;`startTimestamp`&nbsp;and</span><span class="mtk9">&nbsp;`endTimestamp`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.abs</span><span class="mtk13">(</span><span class="mtk33">endTimestamp</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTimestamp</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representation&nbsp;of&nbsp;the&nbsp;interval&nbsp;in&nbsp;mixe</span><span class="mtk9">d&nbsp;time&nbsp;units.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Calculate&nbsp;complete&nbsp;units&nbsp;within&nbsp;the&nbsp;interval&nbsp;fo</span><span class="mtk9">r&nbsp;each&nbsp;toggled&nbsp;unit,&nbsp;reducing&nbsp;the&nbsp;`timeDifference`</span><span class="mtk9">&nbsp;by&nbsp;those&nbsp;sizes.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateWeeks</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalWeeks</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_WEEK</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_WEEK</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">totalWeeks</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">totalWeeks</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;week&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;weeks&nbsp;"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateDays</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalDays</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_DAY</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_DAY</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">totalDays</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">totalDays</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;day&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;days&nbsp;"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateHours</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalHours</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_HOUR</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_HOUR</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">totalHours</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">totalHours</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;hour&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;hours&nbsp;"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateMinutes</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalMinutes</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_MINUTE</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_MINUTE</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">totalMinutes</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">totalMinutes</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;minute&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;minutes&nbsp;"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateSeconds</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">totalSeconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_SECOND</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk33">ONE_SECOND</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">totalSeconds</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">totalSeconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;second&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;seconds&nbsp;"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">calculateMilliseconds</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;`timeDifference`&nbsp;is&nbsp;in&nbsp;milliseconds&nbsp;already,&nbsp;so</span><span class="mtk9">&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;`formattedString`&nbsp;directly.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">timeDifference</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;millisecond"</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk29">"&nbsp;milliseconds"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Return&nbsp;the&nbsp;`formattedString`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">formattedString</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;table&nbsp;that&nbsp;that&nbsp;displays&nbsp;formatted&nbsp;start&nbsp;and&nbsp;en</span><span class="mtk9">d&nbsp;times&nbsp;and&nbsp;their&nbsp;custom-formatted&nbsp;time&nbsp;difference</span><span class="mtk9">.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">table</span><span class="mtk1">&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">table.new</span><span class="mtk13">(</span><span class="mtk11">position.middle_center</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;containing&nbsp;formatted&nbsp;`startTimeInput`&nbsp;</span><span class="mtk9">and&nbsp;`endTimeInput`&nbsp;values.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Start&nbsp;date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">startTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss&nbsp;(z)"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n&nbsp;&nbsp;End&nbsp;date&nbsp;and&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">endTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss&nbsp;(z)"</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;span&nbsp;between&nbsp;`startTi</span><span class="mtk9">meInput`&nbsp;and&nbsp;`endTimeInput`&nbsp;in&nbsp;mixed&nbsp;time&nbsp;units.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">userTimeSpan</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatTimeSpan</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">startTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">weeksInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">hoursInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">minutesInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondsInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">millisecondsInput</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Display&nbsp;the&nbsp;`timeText`&nbsp;in&nbsp;the&nbsp;table.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Display&nbsp;the&nbsp;`userTimeSpan`&nbsp;in&nbsp;the&nbsp;table.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">displayTable</span><span class="mtk1">.</span><span class="mtk15">cell</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;span:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">userTimeSpan</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.white</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_halign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.navy</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <a href="/pine-script-docs/language/user-defined-functions/">user-defined function</a> uses <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_math.floor">math.floor()</a> to round each divided result down to the nearest “int” value to get the number of <em>complete</em> units in the interval. After division, it uses the modulo assignment operator (<a href="https://www.tradingview.com/pine-script-reference/v6/#op_%25=">%=</a>) to get the <em>remainder</em> and assign that value to the <code dir="auto">timeDifference</code> variable. This process repeats for each selected unit.</li>
</ul>
<p>The image above shows the calculated time difference in mixed time units. By toggling the “bool” inputs, users can also isolate specific units in the calculation. For example, this image shows the result after enabling only the “Milliseconds” input:</p>
<p><img src="/pine-script-docs/_astro/Time-Relative-time-differences-Weekly-and-smaller-units-2.CwvuIXRj_ZdIqWW.webp" alt="image" width="988" height="338" loading="lazy" decoding="async"></p>
<h3 id="monthly-and-larger-units" class="md-heading"><a href="#monthly-and-larger-units">Monthly and larger <span class="fancy-wrap">units<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Unlike weeks and smaller units, months and larger units <em>vary</em> in length based on calendar rules. For example, a month can contain 28, 29, 30, or 31 days, and a year can contain 365 or 366 days.</p>
<p>Some programmers prefer to use the modular arithmetic outlined in the <a href="/pine-script-docs/concepts/time/#weekly-and-smaller-units">previous section</a>, with <em>approximate lengths</em> for these irregular units, to calculate large-unit durations between <a href="/pine-script-docs/concepts/time/#unix-timestamps">UNIX timestamps</a>. With this process, programmers usually define the units in either of the following ways:</p>
<ul>
<li>Using <em>common</em> lengths, e.g., a common year equals 365 days, and a common month equals 30 days.</li>
<li>Using the <em>average</em> lengths, e.g., an average year equals 365.25 days, and an average month equals 30.4375 days.</li>
</ul>
<p>Calculations involving approximate units produce <em>rough estimates</em> of the elapsed time. Such estimates are often practical when expressing relatively short durations. However, their precision diminishes with the size of the difference, drifting further away from the actual time elapsed.</p>
<p>Therefore, expressing time differences in monthly and larger units with precision requires a different calculation than the process outlined above. For a more precise estimate of months, years, and larger units elapsed, the calculations should use the <em>actual</em> span of each individual unit rather than approximations, meaning it must account for <em>leap years</em> and <em>variations</em> in month sizes.</p>
<p>The advanced example below contains a custom <code dir="auto">formatTimeDifference()</code> function that calculates the years and months, in addition to days and smaller units, elapsed between two UNIX timestamps.</p>
<p>The function uses the process outlined in the <a href="/pine-script-docs/concepts/time/#weekly-and-smaller-units">previous section</a> to calculate the daily and smaller units within the interval. For the monthly and yearly units, which have <em>irregular</em> lengths, the function uses a <a href="/pine-script-docs/language/loops/#while-loops">while</a> loop to iterate across calendar months. On each iteration, it increments monthly and yearly counters and subtracts the number of days in the added month from the day counter. After the loop ends, the function adjusts the year, month, and day counters to account for partial months elapsed between the timestamps. Finally, it uses the counters in a <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_str.format">str.format()</a> call to create a formatted “string” containing the calculated values.</p>
<p>The script calls this <code dir="auto">formatTimeDifference()</code> function to calculate the years, months, days, hours, minutes, seconds, and milliseconds elapsed between two separate <a href="/pine-script-docs/concepts/inputs/#time-input">time input</a> values and displays the result in a <a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a>:</p>
<p><img src="/pine-script-docs/_astro/Time-Relative-time-differences-Monthly-and-larger-units-1.BhYyGmym_1QIbUd.webp" alt="image" width="1060" height="428" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="6ev"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Calculating&nbsp;time&nbsp;span&nbsp;for&nbsp;larger&nbsp;units&nbsp;demo"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;starting&nbsp;date&nbsp;and&nbsp;time&nbsp;of&nbsp;the&nbsp;time&nbsp;span,&nbsp;inpu</span><span class="mtk9">t&nbsp;by&nbsp;the&nbsp;user.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTimeInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.time</span><span class="mtk13">(</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"3&nbsp;Apr&nbsp;2022&nbsp;20:00&nbsp;-0400"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Start&nbsp;date"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;between"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;ending&nbsp;date&nbsp;and&nbsp;time&nbsp;of&nbsp;the&nbsp;time&nbsp;span,&nbsp;input&nbsp;</span><span class="mtk9">by&nbsp;the&nbsp;user.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTimeInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk16">input.time</span><span class="mtk13">(</span><span class="mtk16">timestamp</span><span class="mtk13">(</span><span class="mtk29">"3&nbsp;Sep&nbsp;2024&nbsp;15:45&nbsp;-0400"</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"End&nbsp;date"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk33">group</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Time&nbsp;between"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Returns&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;the&nbsp;`monthNumber`&nbsp;m</span><span class="mtk9">onth&nbsp;of&nbsp;the&nbsp;`yearNumber`&nbsp;year.</span></span><br><span><span class="mtk15">daysPerMonth</span><span class="mtk13">(</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">yearNumber</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">monthNumber</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;if&nbsp;the&nbsp;`yearNumber`&nbsp;represents&nbsp;a&nbsp;leap&nbsp;y</span><span class="mtk9">ear.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">leapYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">yearNumber</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk33">yearNumber</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk1">&nbsp;</span><span class="mtk18">!=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">or</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">yearNumber</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">400</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;days&nbsp;calculated&nbsp;for&nbsp;the&nbsp;month.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">result</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">switch</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">monthNumber</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">leapYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk12">29</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk12">28</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk12">31</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">monthNumber</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">7</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Calculates&nbsp;the&nbsp;relative&nbsp;time&nbsp;difference&nbsp;between&nbsp;t</span><span class="mtk9">wo&nbsp;timestamps,&nbsp;covering&nbsp;monthly&nbsp;and&nbsp;larger&nbsp;units.</span></span><br><span><span class="mtk15">formatTimeDifference</span><span class="mtk13">(</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">timestamp1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">timestamp2</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;The&nbsp;starting&nbsp;time&nbsp;and&nbsp;ending&nbsp;time.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.min</span><span class="mtk13">(</span><span class="mtk33">timestamp1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timestamp2</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk33">timestamp1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">timestamp2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;The&nbsp;year,&nbsp;month,&nbsp;and&nbsp;day&nbsp;of&nbsp;the&nbsp;`startTime`&nbsp;and</span><span class="mtk9">&nbsp;`endTime`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">year</span><span class="mtk13">(</span><span class="mtk33">startTime</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">month</span><span class="mtk13">(</span><span class="mtk33">startTime</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">startDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk33">startTime</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endYear</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">year</span><span class="mtk13">(</span><span class="mtk33">endTime</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endMonth</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">month</span><span class="mtk13">(</span><span class="mtk33">endTime</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">endDay</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">dayofmonth</span><span class="mtk13">(</span><span class="mtk33">endTime</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Calculate&nbsp;the&nbsp;total&nbsp;number&nbsp;of&nbsp;days,&nbsp;hours,&nbsp;minu</span><span class="mtk9">tes,&nbsp;seconds,&nbsp;and&nbsp;milliseconds&nbsp;in&nbsp;the&nbsp;interval.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">startTime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">86400000</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk12">86400000</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">hours</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">3600000</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3600000</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">minutes</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">60000</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk12">60000</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">seconds</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.floor</span><span class="mtk13">(</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">1000</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">milliseconds</span><span class="mtk1">&nbsp;</span><span class="mtk18">%=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1000</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Calculate&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;the&nbsp;`startMonth</span><span class="mtk9">`&nbsp;and&nbsp;`endMonth`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInStartMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysPerMonth</span><span class="mtk13">(</span><span class="mtk33">startYear</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInEndMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysPerMonth</span><span class="mtk13">(</span><span class="mtk33">endYear</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">endMonth</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;days&nbsp;remaining&nbsp;in&nbsp;the&nbsp;`startMonth`.</span><span class="mtk9">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">remainingInMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInStartMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">startDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Subtract&nbsp;`remainingInMonth`&nbsp;from&nbsp;the&nbsp;`days`,&nbsp;an</span><span class="mtk9">d&nbsp;offset&nbsp;the&nbsp;`startDay`&nbsp;and&nbsp;`startMonth`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">-=</span><span class="mtk1">&nbsp;</span><span class="mtk33">remainingInMonth</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Set&nbsp;`startMonth`&nbsp;to&nbsp;1,&nbsp;and&nbsp;increase&nbsp;the&nbsp;`startY</span><span class="mtk9">ear`&nbsp;if&nbsp;the&nbsp;`startMonth`&nbsp;exceeds&nbsp;12.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">12</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Initialize&nbsp;variables&nbsp;to&nbsp;count&nbsp;the&nbsp;total&nbsp;number&nbsp;</span><span class="mtk9">of&nbsp;months&nbsp;and&nbsp;years&nbsp;in&nbsp;the&nbsp;interval.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">years</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Loop&nbsp;to&nbsp;increment&nbsp;`months`&nbsp;and&nbsp;`years`&nbsp;values&nbsp;b</span><span class="mtk9">ased&nbsp;on&nbsp;the&nbsp;`days`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">while</span><span class="mtk1">&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;days&nbsp;in&nbsp;the&nbsp;current&nbsp;`startMonth`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysPerMonth</span><span class="mtk13">(</span><span class="mtk33">startYear</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Break&nbsp;the&nbsp;loop&nbsp;if&nbsp;the&nbsp;number&nbsp;of&nbsp;remaining&nbsp;days&nbsp;</span><span class="mtk9">is&nbsp;less&nbsp;than&nbsp;the&nbsp;`daysInMonth`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInMonth</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">break</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Reduce&nbsp;the&nbsp;`days`&nbsp;by&nbsp;the&nbsp;`daysInMonth`&nbsp;and&nbsp;incr</span><span class="mtk9">ement&nbsp;the&nbsp;`months`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">-=</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInMonth</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Increase&nbsp;the&nbsp;`years`&nbsp;and&nbsp;reset&nbsp;the&nbsp;`months`&nbsp;to&nbsp;</span><span class="mtk9">0&nbsp;when&nbsp;`months`&nbsp;is&nbsp;12.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">12</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">years</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Increase&nbsp;the&nbsp;`startMonth`&nbsp;and&nbsp;adjust&nbsp;the&nbsp;`start</span><span class="mtk9">Month`&nbsp;and&nbsp;`startYear`&nbsp;if&nbsp;its&nbsp;value&nbsp;exceeds&nbsp;12.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">12</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">startMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">startYear</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Re-add&nbsp;the&nbsp;`remainingInMonth`&nbsp;value&nbsp;to&nbsp;the&nbsp;numb</span><span class="mtk9">er&nbsp;of&nbsp;`days`.&nbsp;Adjust&nbsp;the&nbsp;`days`,&nbsp;`months`,&nbsp;and&nbsp;`ye</span><span class="mtk9">ars`&nbsp;if&nbsp;the&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;new&nbsp;value&nbsp;exceeds&nbsp;the&nbsp;`daysInStartMonth`&nbsp;or&nbsp;`da</span><span class="mtk9">ysInEndMonth`,&nbsp;depending&nbsp;on&nbsp;the&nbsp;`startDay`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk33">remainingInMonth</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">startDay</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInStartMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInStartMonth</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk33">daysInEndMonth</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">12</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">months</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">years</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">days</span><span class="mtk1">&nbsp;</span><span class="mtk18">-=</span><span class="mtk1">&nbsp;</span><span class="mtk33">remainingInMonth</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Format&nbsp;the&nbsp;calculated&nbsp;values&nbsp;into&nbsp;a&nbsp;"string"&nbsp;an</span><span class="mtk9">d&nbsp;return&nbsp;the&nbsp;result.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">str.format</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk29">"&nbsp;Years:&nbsp;  {0}\n&nbsp;Months: {1}\n&nbsp;Days:&nbsp;  &nbsp;{2}\n&nbsp;</span><span class="mtk29">Hours:   &nbsp;{3}\n&nbsp;Minutes:  {4}\n&nbsp;Seconds: {5}\n&nbsp;</span><span class="mtk29">Milliseconds:&nbsp;{6}"</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">years</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">months</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">days</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">hours</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">minutes</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">seconds</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">milliseconds</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;"string"&nbsp;representing&nbsp;the&nbsp;time&nbsp;between&nbsp;the&nbsp;`sta</span><span class="mtk9">rtTimeInput`&nbsp;and&nbsp;`endTimeInput`&nbsp;in&nbsp;mixed&nbsp;units.&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">userTimeSpan</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">formatTimeDifference</span><span class="mtk13">(</span><span class="mtk33">startTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">endTimeInput</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Text&nbsp;shown&nbsp;in&nbsp;the&nbsp;label.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Start&nbsp;time:&nbsp;"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">startTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss&nbsp;(z)"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n&nbsp;&nbsp;End&nbsp;time:&nbsp;"</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk16">str.format_time</span><span class="mtk13">(</span><span class="mtk33">endTimeInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"dd/MM/yy&nbsp;HH:mm:ss&nbsp;(z)"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk29">"\n---------\nTime&nbsp;difference:\n"</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">userTimeSpan</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">label.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">labelText</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#ff946e</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">textcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#363a45</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">size</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">size.large</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">textalign</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">text.align_left</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">style</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">label.style_label_center</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The script determines the number of days in each month with the user-defined <code dir="auto">daysPerMonth()</code> function. The function identifies whether a month has 28, 29, 30, or 31 days based on its month number and the year it belongs to. Its calculation accounts for leap years. A leap year occurs when the year is divisible by 4 or 400 but not by 100.</li>
<li>Before the <a href="/pine-script-docs/language/loops/#while-loops">while</a> loop, the function subtracts the number of days in a partial starting month from the initial day count, aligning the counters with the beginning of a new month. It re-adds the subtracted days after the loop to adjust the counters for partial months. It adjusts the month and year counters based on the days in the <code dir="auto">startMonth</code> if the <code dir="auto">startDay</code> is less than halfway through that month. Otherwise, it adjusts the values based on the days in the <code dir="auto">endMonth</code>.</li>
</ul>      </div> <div class="pagination-buttons not-content" data-astro-cid-xgirumru=""> <a href="/pine-script-docs/concepts/strings" class="pagination-card" data-pagefind-ignore="" data-astro-cid-assl6cvf=""> <p data-astro-cid-assl6cvf="">Previous</p> <h4 class="pagination-card-header" data-astro-cid-assl6cvf=""> <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-assl6cvf="" data-icon="theme/arrow-back">  <use xlink:href="#ai:local:theme/arrow-back"></use>  </svg> Strings  </h4> </a>  <a href="/pine-script-docs/concepts/timeframes" class="pagination-card" data-pagefind-ignore="" data-astro-cid-assl6cvf=""> <p data-astro-cid-assl6cvf="">Next</p> <h4 class="pagination-card-header" data-astro-cid-assl6cvf="">  Timeframes <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-assl6cvf="" data-icon="theme/arrow">  <symbol id="ai:local:theme/arrow"><path fill="none" stroke="var(--arrow-fill-color, #131722)" d="m11 8 6 6-6 6"></path></symbol><use xlink:href="#ai:local:theme/arrow"></use>  </svg> </h4> </a>  </div>  </main>   <div id="toc" data-pagefind-ignore="all" data-astro-cid-oor6cujd=""><aside class="document-toc-container ml-4 w-48" data-astro-cid-oor6cujd=""><section id="toc-scroll-section" class="slick-scroll" data-astro-cid-oor6cujd=""><header data-astro-cid-oor6cujd=""><h2 class="toc-header" data-astro-cid-oor6cujd="">On this page</h2></header><ul class="" id="toc-entries" data-astro-cid-oor6cujd=""><a href="#introduction" aria-current="true" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-current="" data-astro-cid-oor6cujd="">Introduction</li></a><a href="#unix-timestamps" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">UNIX timestamps</li></a><a href="#time-zones" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Time zones</li></a><a href="#time-zone-strings" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Time zone strings</li></a><a href="#time-variables" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Time variables</li></a><a href="#time-and-time_close-variables" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>time</code> and <code>time_close</code> variables</li></a><a href="#time_tradingday" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>time_tradingday</code></li></a><a href="#timenow" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>timenow</code></li></a><a href="#calendar-based-variables" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Calendar-based variables</li></a><a href="#last_bar_time" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>last_bar_time</code></li></a><a href="#visible-bar-times" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Visible bar times</li></a><a href="#syminfotimezone" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>syminfo.timezone</code></li></a><a href="#time-functions" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Time functions</li></a><a href="#time-and-time_close-functions" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>time()</code> and <code>time_close()</code> functions</li></a><a href="#testing-for-sessions" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-4" data-astro-cid-oor6cujd="">Testing for sessions</li></a><a href="#testing-for-changes-in-higher-timeframes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-4" data-astro-cid-oor6cujd="">Testing for changes in higher timeframes</li></a><a href="#calculating-timestamps-at-bar-offsets" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-4" data-astro-cid-oor6cujd="">Calculating timestamps at bar offsets</li></a><a href="#calendar-based-functions" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Calendar-based functions</li></a><a href="#timestamp" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd=""><code>timestamp()</code></li></a><a href="#formatting-dates-and-times" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Formatting dates and times</li></a><a href="#expressing-time-differences" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Expressing time differences</li></a><a href="#weekly-and-smaller-units" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Weekly and smaller units</li></a><a href="#monthly-and-larger-units" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Monthly and larger units</li></a></ul></section><div class="toc-bottom-fade" data-astro-cid-oor6cujd=""></div><div class="back-top-space" data-astro-cid-oor6cujd=""><div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <a id="back-top-button" title="Back to top" href="#top" data-astro-cid-pkzv2hgs="" class="floating-button not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-secondary stvb-icon stvb-icon-force-color stvb-force-no-border"> <svg width="18" height="18" viewBox="0 0 18 18" data-astro-cid-oor6cujd="" data-icon="theme/arrow-up">  <symbol id="ai:local:theme/arrow-up"><g fill="none"><g clip-path="url(#a)"><path fill="currentColor" fill-rule="evenodd" d="m9 3.5.5.44 4 3.5-1 1.12-2.75-2.4V14h-1.5V6.15L5.49 8.56l-.98-1.12 4-3.5z" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h18v18H0z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/arrow-up"></use>  </svg> </a> </div> </div></aside></div> </main> </div>   <footer data-astro-cid-b6pf7ola=""> <div class="footer-content" data-astro-cid-b6pf7ola="">  <ul data-astro-cid-b6pf7ola=""> <li data-astro-cid-b6pf7ola=""> <a href="https://www.tradingview.com/chat/#BfmVowG1TZkKO235" data-astro-cid-b6pf7ola="">Pine Q&amp;A chat</a>  </li><li data-astro-cid-b6pf7ola=""> <a href="https://stackoverflow.com/questions/tagged/pine-script" data-astro-cid-b6pf7ola="">Stack Overflow</a>  ↗ </li><li data-astro-cid-b6pf7ola=""> <a href="https://t.me/PineCodersQA" data-astro-cid-b6pf7ola="">Telegram</a>  ↗ </li><li data-astro-cid-b6pf7ola=""> <a href="https://www.reddit.com/r/TradingView/" data-astro-cid-b6pf7ola="">Reddit</a>  ↗ </li> </ul> <div class="flex" data-astro-cid-b6pf7ola=""></div> <div class="copyright" data-astro-cid-b6pf7ola="">Copyright © 2025 TradingView, Inc.</div> </div> </footer>         </body></html>