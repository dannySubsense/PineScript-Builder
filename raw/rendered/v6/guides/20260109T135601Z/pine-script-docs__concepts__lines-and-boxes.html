<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><script data-astro-exec="">
			const url = window.location.href;
			const expectedUrl = url.replace(
				/^https:\/\/(?!beta)(\w+\.)?tradingview\.com/,
				'https://www.tradingview.com',
			);
			if (url !== expectedUrl) {
				window.location.replace(expectedUrl);
			}
		</script><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="none"><link rel="icon" href="https://static.tradingview.com/static/images/favicon.ico"><link rel="icon" type="image/svg+xml" href="/pine-script-docs/favicon.svg"><title>Visuals / Lines and boxes</title><meta name="og:title" content="Visuals / Lines and boxes"><meta name="twitter:title" content="Visuals / Lines and boxes"><meta name="description" content="Everything you need to know about Pine Script®."><meta name="og:description" content="Everything you need to know about Pine Script®."><meta name="twitter:description" content="Everything you need to know about Pine Script®."><meta name="keywords" content="tradingview, pine, script, indicators, strategies"><meta name="og:image" content="/pine-script-docs/meta-image.png?1"><meta name="twitter:image" content="/pine-script-docs/meta-image.png?1"><meta name="og:image:width" content="1200"><meta name="og:image:height" content="630"><meta name="og:url" content="https://www.tradingview.com/pine-script-docs/visuals/lines-and-boxes/"><meta name="twitter:url" content="https://www.tradingview.com/pine-script-docs/visuals/lines-and-boxes/"><meta name="og:type" content="website"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@TradingView"><link rel="canonical" href="https://www.tradingview.com/pine-script-docs/visuals/lines-and-boxes/"><link rel="sitemap" href="/pine-script-docs/sitemap-index.xml"><link rel="stylesheet" href="/pine-script-docs/_astro/index.DfaRTfPD.css">
<link rel="stylesheet" href="/pine-script-docs/_astro/index.B9ah8c5K.css">
<style>.tv-spinner{display:none;position:absolute;margin:0 auto;border:0 solid rgb(149 152 161 / 20%);border-radius:50%;border-top-color:var(--tv-spinner-color, #2962ff);border-left-color:var(--tv-spinner-color, #2962ff);animation:tv-spinner-container-rotate .9s linear infinite}.tv-spinner-shown{display:block}.tv-spinner-size-large{top:calc(50% - 32px);left:calc(50% - 32px);width:56px;height:56px;border-width:4px}@keyframes tv-spinner-container-rotate{to{transform:rotate(360deg)}}:root{--page-background-color: #fff;background-color:var(--page-background-color)}:root[data-theme=dark]{--page-background-color: #000}body{background-color:var(--page-background-color)}#redirect-link{display:flex;position:absolute;inset:0;align-items:center;justify-content:center}#spinner{display:block;position:absolute;opacity:1;transition:opacity .2s}
.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:attr(data-title);display:block;position:absolute;top:0;background-image:linear-gradient(180deg,#000000ab,#0000008a 14%,#00000026 54%,#0000000d 72%,#0000 94%);height:99px;width:100%;font-family:YouTube Noto,Roboto,Arial,Helvetica,sans-serif;color:#eee;text-shadow:0 0 2px rgba(0,0,0,.5);font-size:18px;padding:25px 20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box}lite-youtube:hover:before{color:#fff}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{display:block;width:100%;height:100%;background:no-repeat center/68px 48px;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.52 7.74c-.78-2.93-2.49-5.41-5.42-6.19C55.79.13 34 0 34 0S12.21.13 6.9 1.55c-2.93.78-4.63 3.26-5.42 6.19C.06 13.05 0 24 0 24s.06 10.95 1.48 16.26c.78 2.93 2.49 5.41 5.42 6.19C12.21 47.87 34 48 34 48s21.79-.13 27.1-1.55c2.93-.78 4.64-3.26 5.42-6.19C67.94 34.95 68 24 68 24s-.06-10.95-1.48-16.26z" fill="red"/><path d="M45 24 27 14v20" fill="white"/></svg>');position:absolute;cursor:pointer;z-index:1;filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:0}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}lite-youtube>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}lite-vimeo{font-size:10px;background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover}lite-vimeo:after{content:"";display:block;padding-bottom:56.25%}lite-vimeo>iframe{all:unset!important;width:100%!important;height:100%!important;position:absolute!important;inset:0!important;border:0!important}lite-vimeo>.ltv-playbtn{content:"";position:absolute;inset:0;width:100%;background:transparent;outline:0;border:0;cursor:pointer}lite-vimeo>.ltv-playbtn:before{width:6.5em;height:4em;background:#172322bf;opacity:.8;border-radius:.25rem;transition:all .2s cubic-bezier(0,0,.2,1)}lite-vimeo>.ltv-playbtn:focus:before{outline:auto}lite-vimeo:hover>.ltv-playbtn:before{background-color:#00adef;background-color:var(--ltv-color, #00adef);opacity:1}lite-vimeo>.ltv-playbtn:after{border-style:solid;border-width:1em 0 1em 1.7em;border-color:transparent transparent transparent #fff}lite-vimeo>.ltv-playbtn:before,lite-vimeo>.ltv-playbtn:after{content:"";position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}lite-vimeo.ltv-activated:before,lite-vimeo.ltv-activated>.ltv-playbtn{cursor:unset;opacity:0;pointer-events:none}
</style><script type="module" src="/pine-script-docs/_astro/hoisted.wfEHaJbk.js" data-astro-exec=""></script><style id="tv-pine-light" type="text/css" media="screen">.monaco-editor-tv-pine-light { 
.mtk1 { color: #131722; }
.mtk2 { color: #ffffff; }
.mtk3 { color: #808080; }
.mtk4 { color: #ff0000; }
.mtk5 { color: #0451a5; }
.mtk6 { color: #0000ff; }
.mtk7 { color: #098658; }
.mtk8 { color: #008000; }
.mtk9 { color: #9598a1; }
.mtk10 { color: #dd0000; }
.mtk11 { color: #cc2929; }
.mtk12 { color: #f57f17; }
.mtk13 { color: #000000; }
.mtk14 { color: #383838; }
.mtk15 { color: #0c3299; }
.mtk16 { color: #2962ff; }
.mtk17 { color: #8e24aa; }
.mtk18 { color: #22ab94; }
.mtk19 { color: #cd3131; }
.mtk20 { color: #863b00; }
.mtk21 { color: #af00db; }
.mtk22 { color: #800000; }
.mtk23 { color: #e00000; }
.mtk24 { color: #3030c0; }
.mtk25 { color: #666666; }
.mtk26 { color: #778899; }
.mtk27 { color: #c700c7; }
.mtk28 { color: #a31515; }
.mtk29 { color: #388e3c; }
.mtk30 { color: #4f76ac; }
.mtk31 { color: #008080; }
.mtk32 { color: #001188; }
.mtk33 { color: #2a2e39; }
.mtk34 { color: #4864aa; }
.mtki { font-style: italic; }
.mtkb { font-weight: bold; }
.mtku { text-decoration: underline; text-underline-position: under; }
.mtks { text-decoration: line-through; }
.mtks.mtku { text-decoration: underline line-through; text-underline-position: under; } }</style></head> <body> <div id="search-content-blur" hidden=""></div> <script data-astro-exec="">
	/* eslint-disable @typescript-eslint/typedef */
	window.ThemeProvider = (() => {
		function getCurrent() {
			return (
				// eslint-disable-next-line no-restricted-syntax
				typeof localStorage !== 'undefined' &&
				localStorage.getItem('tv-docs-theme')
			);
		}
		const storedTheme = getCurrent();
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ?
				'light'
			:	'dark');
		document.documentElement.dataset.theme =
			theme === 'light' ? 'light' : 'dark';
		document.documentElement.classList.toggle(
			'theme-dark',
			theme === 'dark',
		); // add support for ui-lib themes
		document.documentElement.classList.toggle(
			'sl-theme-dark',
			theme === 'dark',
		); // add support for shoelace themes

		return {
			updatePickers(themeArg = storedTheme || 'auto') {
				let currentTheme = themeArg;
				if (currentTheme === 'unknown') {
					currentTheme = getCurrent() || 'auto';
				}
				document
					.querySelectorAll('docs-theme-select')
					.forEach((picker) => {
						const select = picker.querySelector('select');
						if (select) select.value = currentTheme;
						/** @type {HTMLTemplateElement | null} */
						const tmpl = document.querySelector(`#theme-icons`);
						const newIcon =
							tmpl &&
							tmpl.content.querySelector('.' + currentTheme);
						if (newIcon) {
							const oldIcon =
								picker.querySelector('svg.label-icon');
							if (oldIcon) {
								oldIcon.replaceChildren(
									...newIcon.cloneNode(true).childNodes,
								);
							}
						}
					});
			},
		};
	})();
	/* eslint-enable @typescript-eslint/typedef */
</script><template id="theme-icons"><svg width="16" height="16" viewBox="0 0 28 28" class="light" data-icon="theme/sun-28">  <symbol id="ai:local:theme/sun-28"><g fill="currentColor"><path d="M14 3h1.5v5H14zm0 18h1.5v5H14zm12-5.5V14h-5v1.5zM8 14v1.5H3V14zm15.3-7-1-1-3.6 3.6 1.1 1 3.5-3.5ZM9.5 18.7l1.1 1.1-3.5 3.5-1-1zM22 23.3l1-1-3.6-3.6-1 1.1 3.5 3.5ZM10.3 9.6l-1.1 1-3.5-3.5 1-1z"></path><path fill-rule="evenodd" d="M19 14.5a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m-1.5 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0" clip-rule="evenodd"></path></g></symbol><use xlink:href="#ai:local:theme/sun-28"></use>  </svg><svg width="16" height="16" viewBox="0 0 28 28" class="dark" data-icon="theme/moon-28">  <symbol id="ai:local:theme/moon-28"><path fill="currentColor" fill-rule="evenodd" d="M21 7.02A9.23 9.23 0 0 0 15.2 5 9.1 9.1 0 0 0 6 14c0 4.97 4.12 9 9.2 9a9.33 9.33 0 0 0 5.8-2.02A7 7 0 0 1 14.36 14 7 7 0 0 1 21 7.02m-3.95-.3a8 8 0 0 0-1.85-.22A7.6 7.6 0 0 0 7.5 14a7.6 7.6 0 0 0 7.7 7.5 8 8 0 0 0 1.85-.22A8.46 8.46 0 0 1 12.86 14c0-3.1 1.69-5.8 4.19-7.28" clip-rule="evenodd"></path></symbol><use xlink:href="#ai:local:theme/moon-28"></use>  </svg><svg width="16" height="16" viewBox="0 0 28 28" class="auto" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg></template> <div class="backdrop" data-mobile-menu-backdrop="" data-astro-cid-h2irkosh=""></div> <div class="menu-container" data-astro-cid-h2irkosh=""> <div class="header" data-astro-cid-h2irkosh=""> <div class="header-group" data-astro-cid-h2irkosh=""> <div id="version-select" data-astro-cid-kx7qoxgq=""> <label style="--sl-select-width: undefined; --sl-label-icon-size: 16px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Version</span>  <select value="v6" data-has-border="" no-icon="true" data-astro-cid-lmznfliq=""> <option value="v6" selected="true" data-astro-cid-lmznfliq="">Version 6</option><option value="v5" data-astro-cid-lmznfliq="">Version 5</option><option value="v4" data-astro-cid-lmznfliq="">Version 4</option><option value="v3" data-astro-cid-lmznfliq="">Version 3</option> </select> <svg width="16" height="16" viewBox="0 0 24 24" class="icon caret" data-astro-cid-lmznfliq="" data-icon="theme/down-caret">  <symbol id="ai:local:theme/down-caret"><path fill="currentColor" d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1 1 0 0 0 1.42 0L17 10.59a1 1 0 0 0 0-1.42"></path></symbol><use xlink:href="#ai:local:theme/down-caret"></use>  </svg> </label>  </div>   <docs-theme-select class="" data-astro-cid-3wpspbi7=""> <label style="--sl-select-width: 48px; --sl-label-icon-size: 28px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Theme</span> <svg width="28" height="28" viewBox="0 0 28 28" class="icon label-icon" data-button="" data-round="" data-astro-cid-lmznfliq="" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg> <select value="auto" data-button="" data-astro-cid-lmznfliq=""> <option value="dark" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Dark&nbsp;&nbsp;</option><option value="light" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Light&nbsp;&nbsp;</option><option value="auto" selected="true" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Auto&nbsp;&nbsp;</option> </select>  </label>  </docs-theme-select>   <script data-astro-exec="">
	ThemeProvider.updatePickers('unknown');
</script>  </div> <div class="header-group" data-astro-cid-h2irkosh="">  <div class="not-content" style="stroke-width:2px" data-astro-cid-pkzv2hgs=""> <button id="mobile-menu-back-button" title="Close menu" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-primary stvb-icon">  <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-h2irkosh="" data-icon="theme/arrow-back">  <symbol id="ai:local:theme/arrow-back"><g fill="none"><g clip-path="url(#a)"><path stroke="var(--arrow-fill-color, #131722)" d="m17 20-6-6 6-6"></path></g><defs><clipPath id="a"><path fill="#fff" d="M28 28H0V0h28z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/arrow-back"></use>  </svg>  </button> </div>  </div> </div> <aside id="nav" class="keep-visible" style="--navbar-right-border-width: 0px" data-astro-cid-sa57sq6l=""> <div class="sidebar-viewport slick-scroll" data-astro-cid-sa57sq6l=""> <div class="sidebar" data-mobile="" data-astro-cid-sa57sq6l=""> <ul class="toc" aria-label="Docs sidebar" data-astro-cid-sa57sq6l=""> <li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/welcome" data-astro-cid-omxx3dey="">Welcome to Pine Script® v6</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Pine Script® primer</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-steps" data-astro-cid-omxx3dey="">First steps</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-indicator" data-astro-cid-omxx3dey="">First indicator</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/next-steps" data-astro-cid-omxx3dey="">Next steps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Language</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/execution-model" data-astro-cid-omxx3dey="">Execution model</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/type-system" data-astro-cid-omxx3dey="">Type system</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/script-structure" data-astro-cid-omxx3dey="">Script structure</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/identifiers" data-astro-cid-omxx3dey="">Identifiers</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/variable-declarations" data-astro-cid-omxx3dey="">Variable declarations</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/operators" data-astro-cid-omxx3dey="">Operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/conditional-structures" data-astro-cid-omxx3dey="">Conditional structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/loops" data-astro-cid-omxx3dey="">Loops</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/built-ins" data-astro-cid-omxx3dey="">Built-ins</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/user-defined-functions" data-astro-cid-omxx3dey="">User-defined functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/objects" data-astro-cid-omxx3dey="">Objects</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/enums" data-astro-cid-omxx3dey="">Enums</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/methods" data-astro-cid-omxx3dey="">Methods</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/arrays" data-astro-cid-omxx3dey="">Arrays</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/matrices" data-astro-cid-omxx3dey="">Matrices</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/maps" data-astro-cid-omxx3dey="">Maps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details open="" data-is-parent="" data-is-on-path="" data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Visuals</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/backgrounds" data-astro-cid-omxx3dey="">Backgrounds</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-coloring" data-astro-cid-omxx3dey="">Bar coloring</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-plotting" data-astro-cid-omxx3dey="">Bar plotting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/colors" data-astro-cid-omxx3dey="">Colors</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/fills" data-astro-cid-omxx3dey="">Fills</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/levels" data-astro-cid-omxx3dey="">Levels</a></li><li class="item" data-current="" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/lines-and-boxes" data-astro-cid-omxx3dey="">Lines and boxes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/plots" data-astro-cid-omxx3dey="">Plots</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/tables" data-astro-cid-omxx3dey="">Tables</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/text-and-shapes" data-astro-cid-omxx3dey="">Text and shapes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Concepts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/bar-states" data-astro-cid-omxx3dey="">Bar states</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/chart-information" data-astro-cid-omxx3dey="">Chart information</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/inputs" data-astro-cid-omxx3dey="">Inputs</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/libraries" data-astro-cid-omxx3dey="">Libraries</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/non-standard-charts-data" data-astro-cid-omxx3dey="">Non-standard charts data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/other-timeframes-and-data" data-astro-cid-omxx3dey="">Other timeframes and data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/repainting" data-astro-cid-omxx3dey="">Repainting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/sessions" data-astro-cid-omxx3dey="">Sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strings" data-astro-cid-omxx3dey="">Strings</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/time" data-astro-cid-omxx3dey="">Time</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/timeframes" data-astro-cid-omxx3dey="">Timeframes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Writing scripts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/style-guide" data-astro-cid-omxx3dey="">Style guide</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/debugging" data-astro-cid-omxx3dey="">Debugging</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/profiling-and-optimization" data-astro-cid-omxx3dey="">Profiling and optimization</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/publishing" data-astro-cid-omxx3dey="">Publishing scripts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/limitations" data-astro-cid-omxx3dey="">Limitations</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">FAQ</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/general" data-astro-cid-omxx3dey="">General</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/data-structures" data-astro-cid-omxx3dey="">Data structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/functions" data-astro-cid-omxx3dey="">Functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/indicators" data-astro-cid-omxx3dey="">Indicators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/other-data-and-timeframes" data-astro-cid-omxx3dey="">Other data and timeframes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/programming" data-astro-cid-omxx3dey="">Programming</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strings-and-formatting" data-astro-cid-omxx3dey="">Strings and formatting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/techniques" data-astro-cid-omxx3dey="">Techniques</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/times-dates-and-sessions" data-astro-cid-omxx3dey="">Times, dates, and sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/variables-and-operators" data-astro-cid-omxx3dey="">Variables and operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/visuals" data-astro-cid-omxx3dey="">Visuals</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/error-messages" data-astro-cid-omxx3dey="">Error messages</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/release-notes" data-astro-cid-omxx3dey="">Release notes</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Migration guides</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-6" data-astro-cid-omxx3dey="">To Pine Script® version 6</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-5" data-astro-cid-omxx3dey="">To Pine Script® version 5</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-4" data-astro-cid-omxx3dey="">To Pine Script® version 4</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-3" data-astro-cid-omxx3dey="">To Pine Script® version 3</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-2" data-astro-cid-omxx3dey="">To Pine Script® version 2</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/where-can-i-get-more-information" data-astro-cid-omxx3dey="">Where can I get more information?</a></li> </ul> <div class="toc-bottom" data-astro-cid-sa57sq6l=""></div> </div> </div> </aside>  </div>   <header class="header" data-astro-cid-d74r2unp=""> <nav role="navigation" aria-label="Main Navigation" data-astro-cid-d74r2unp=""> <mobile-menu-button id="mobile-menu-button-wc" data-astro-cid-oojooh3d=""> <!-- Annoyingly I need to wrap this. TODO: improve this --> <div id="mobile-menu-button-header" data-astro-cid-oojooh3d=""> <div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <button title="Open navigation menu" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-secondary stvb-icon stvb-icon-force-color stvb-force-no-border">  <svg width="28" height="28" viewBox="0 0 24 24" data-astro-cid-oojooh3d="" data-icon="theme/bars">  <symbol id="ai:local:theme/bars"><path fill="currentColor" d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2m18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2m0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2"></path></symbol><use xlink:href="#ai:local:theme/bars"></use>  </svg>  </button> </div>  </div> </mobile-menu-button>   <div data-hide-when-search="" data-astro-cid-d74r2unp=""> <div class="header-logo" data-astro-cid-tycb33lk=""> <a href="/pine-script-docs/" aria-label="Home button" data-astro-cid-tycb33lk=""> <div class="documentation-logo logo" data-astro-cid-tycb33lk=""><!-- Old Christmas icon -->
<!-- 
<svg width="184" height="44" viewBox="0 0 184 44" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path fill-rule="evenodd" clip-rule="evenodd" d="M33.8209 5.1219C33.885 4.95937 34.115 4.95937 34.1791 5.1219L35.2253 7.77465L37.8781 8.82088C38.0406 8.88499 38.0406 9.11501 37.8781 9.17912L35.2253 10.2253L34.1791 12.8781C34.115 13.0406 33.885 13.0406 33.8209 12.8781L32.7747 10.2253L30.1219 9.17912C29.9594 9.11501 29.9594 8.88499 30.1219 8.82088L32.7747 7.77465L33.8209 5.1219Z" fill="#F9A825"/>
    <path d="M5.30092 15.1478C5.37479 14.9605 5.63986 14.9605 5.71373 15.1478L6.60557 17.4091L8.86685 18.3009C9.05415 18.3748 9.05415 18.6399 8.86685 18.7137L6.60557 19.6056L5.71373 21.8669C5.63986 22.0541 5.37479 22.0541 5.30092 21.8669L4.40908 19.6056L2.1478 18.7137C1.9605 18.6399 1.9605 18.3748 2.1478 18.3009L4.40908 17.4091L5.30092 15.1478Z" fill="#F9A825"/>
    <path d="M11.8231 3.12041C11.8864 2.95986 12.1136 2.95986 12.1769 3.12041L12.9414 5.05865L14.8796 5.82308C15.0401 5.8864 15.0401 6.1136 14.8796 6.17692L12.9414 6.94135L12.1769 8.87959C12.1136 9.04014 11.8864 9.04014 11.8231 8.87959L11.0586 6.94135L9.12041 6.17692C8.95986 6.1136 8.95986 5.8864 9.12041 5.82308L11.0586 5.05865L11.8231 3.12041Z" fill="#F9A825"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.6478 7.35459L34.7627 21.6923C35.1531 22.1543 35.0472 22.8544 34.5376 23.1802L26.9989 28.0001L18.4281 20.7531L11.3382 23.2611C10.402 23.5923 9.60771 22.5041 10.2085 21.7134L21.0877 7.39502C21.4749 6.88536 22.2346 6.86567 22.6478 7.35459ZM33.432 28.0842L38.3592 34.7471C38.7427 35.2657 38.3724 36 37.7274 36H6.27248C5.62746 36 5.25722 35.2657 5.64074 34.7471L10.8523 27.6996C10.9484 27.5697 11.0822 27.4725 11.2356 27.4214L17.6878 25.2707C17.9285 25.1904 18.1932 25.2314 18.3984 25.3806L26.2854 31.1166C26.5445 31.3051 26.8922 31.3173 27.1639 31.1475L32.3838 27.885C32.7316 27.6677 33.1881 27.7544 33.432 28.0842Z" fill="#089981"/>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6363 11.9375C20.7386 12.451 23.1213 11.505 24.9187 10.0422L25.8869 11.1881C23.6236 13.0379 20.553 14.1584 16.6261 13.267L17.6363 11.9375ZM34.0572 20.8573C30.0669 21.363 26.2864 20.8179 23.1264 19.7076C20.7393 18.8689 18.6873 17.7013 17.155 16.3997C16.5283 15.8674 15.9767 15.3021 15.5241 14.7174L16.4708 13.4713C16.8706 14.0544 17.4225 14.6588 18.1262 15.2565C19.5001 16.4237 21.3856 17.5061 23.6236 18.2924C26.3235 19.241 29.5087 19.7493 32.8863 19.4716L34.0572 20.8573ZM9.06812 30.1123C15.4775 33.3909 23.0493 33.8897 29.0345 32.0941C31.0827 31.4796 32.9275 30.6019 34.4713 29.4897L35.3633 30.6959C33.6586 31.9268 31.6497 32.8756 29.4655 33.5309C23.053 35.4546 14.9758 34.8964 8.16479 31.3339L9.06812 30.1123Z" fill="#45E5CB"/>
    <path d="M55.56 13.96C59.016 13.96 61.536 16.456 61.536 19.696C61.536 22.936 59.016 25.432 55.56 25.432H53.376V31H49.896V13.96H55.56ZM55.512 22.168C57.096 22.168 58.152 21.088 58.152 19.696C58.152 18.304 57.096 17.224 55.512 17.224H53.376V22.168H55.512ZM66.8636 14.944C66.8636 16.096 65.9276 17.032 64.7516 17.032C63.6236 17.032 62.6636 16.096 62.6636 14.944C62.6636 13.792 63.6236 12.856 64.7516 12.856C65.9276 12.856 66.8636 13.792 66.8636 14.944ZM63.1196 31V19H66.4076V31H63.1196ZM69.0849 31V19H72.3729V20.368C72.9969 19.408 74.2449 18.736 75.8049 18.736C78.7089 18.736 80.4369 20.848 80.4369 23.968V31H77.1489V24.52C77.1489 22.792 76.4049 21.736 75.0369 21.736C73.5249 21.736 72.3729 22.84 72.3729 25.144V31H69.0849ZM82.2041 25C82.2041 21.448 84.8681 18.736 88.5161 18.736C91.6601 18.736 94.4201 20.752 94.4201 24.64C94.4201 24.928 94.4201 25.264 94.3721 25.768H85.3961C85.5881 27.376 87.0041 28.264 88.5881 28.264C90.0761 28.264 91.1561 27.568 91.6841 26.752L94.1321 28.576C93.0281 30.184 91.0841 31.264 88.5641 31.264C84.9881 31.264 82.2041 28.792 82.2041 25ZM88.4201 21.448C87.1961 21.448 85.8281 22.072 85.5161 23.536H91.1321C90.8441 22.12 89.6441 21.448 88.4201 21.448ZM100.412 28.24L103.076 26.008C103.916 27.28 105.38 28.024 106.772 28.024C108.14 28.024 109.052 27.352 109.052 26.368C109.052 25.408 108.356 24.736 106.676 24.16L105.236 23.656C102.5 22.696 101.036 21.112 101.036 18.784C101.036 15.568 103.484 13.672 106.796 13.672C108.884 13.672 110.708 14.392 112.172 16.024L109.868 18.4C109.052 17.416 107.996 16.936 106.82 16.936C105.644 16.936 104.54 17.44 104.54 18.448C104.54 19.48 105.38 19.936 107.18 20.584L108.548 21.088C111.044 22 112.604 23.584 112.604 26.152C112.58 29.2 110.156 31.288 106.628 31.288C103.916 31.288 101.636 30.112 100.412 28.24ZM125.859 27.808C124.827 29.872 122.667 31.264 120.171 31.264C116.619 31.264 113.811 28.624 113.811 25C113.811 21.376 116.619 18.736 120.171 18.736C122.667 18.736 124.827 20.128 125.859 22.192L123.003 23.728C122.523 22.624 121.491 21.808 120.171 21.808C118.443 21.808 117.123 23.152 117.123 25C117.123 26.848 118.443 28.192 120.171 28.192C121.491 28.192 122.523 27.376 123.003 26.272L125.859 27.808ZM127.482 31V19H130.77V20.92C131.178 19.744 132.402 18.856 133.746 18.856C134.082 18.856 134.442 18.88 134.85 19V22.336C134.346 22.168 133.89 22.072 133.362 22.072C131.802 22.072 130.77 23.296 130.77 25.264V31H127.482ZM140.215 14.944C140.215 16.096 139.279 17.032 138.103 17.032C136.975 17.032 136.015 16.096 136.015 14.944C136.015 13.792 136.975 12.856 138.103 12.856C139.279 12.856 140.215 13.792 140.215 14.944ZM136.471 31V19H139.759V31H136.471ZM142.436 36.016V19H145.724V20.344C146.276 19.576 147.548 18.736 149.204 18.736C152.396 18.736 154.844 21.592 154.844 25C154.844 28.408 152.396 31.264 149.204 31.264C147.548 31.264 146.276 30.424 145.724 29.656V36.016H142.436ZM151.508 25C151.508 23.128 150.284 21.736 148.484 21.736C146.684 21.736 145.46 23.128 145.46 25C145.46 26.872 146.684 28.264 148.484 28.264C150.284 28.264 151.508 26.872 151.508 25ZM164.407 30.88C163.879 31.048 163.231 31.144 162.319 31.144C159.775 31.144 157.735 29.728 157.735 26.8V21.88H155.311V19H157.735V15.664H161.023V19H164.407V21.88H161.023V26.152C161.023 27.616 161.647 28.192 163.063 28.192C163.591 28.192 164.023 28.12 164.407 27.976V30.88ZM173.626 22.648V13.96H175.978L177.874 16.888L179.746 13.96H182.122V22.648H179.698V18.184L177.874 20.968L176.026 18.136V22.648H173.626ZM167.386 22.648V16.456H165.058V13.96H172.258V16.456H169.93V22.648H167.386Z" fill="currentColor"/>
</svg> -->



<!-- Regular icon -->

<svg width="177" height="44" viewBox="0 0 177 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.6876 25.2705C17.9283 25.1902 18.1933 25.2316 18.3985 25.3808L26.2852 31.1162C26.5444 31.3047 26.8924 31.3173 27.1641 31.1474L32.3839 27.8847C32.7316 27.6675 33.1878 27.7545 33.4317 28.084L38.3594 34.7471C38.7428 35.2656 38.3725 35.9999 37.7276 36H6.27253C5.62754 36 5.25723 35.2657 5.64069 34.7471L10.8526 27.6992C10.9486 27.5695 11.0824 27.4729 11.2354 27.4219L17.6876 25.2705ZM21.088 7.39451C21.4752 6.88532 22.2345 6.8659 22.6475 7.35448L34.7628 21.6924C35.1531 22.1544 35.0468 22.8548 34.5372 23.1806L26.9991 28L18.4278 20.7529L11.338 23.2607C10.4021 23.5917 9.60809 22.5044 10.2081 21.7139L21.088 7.39451ZM13.8243 20.2597L17.7608 18.8672C18.4309 18.6301 19.1771 18.7667 19.7198 19.2256L27.1641 25.5205L32.4981 22.1103L21.9259 9.59862L13.8243 20.2597Z" fill="currentColor"></path>
<path d="M147.308 16.959C150.499 16.959 152.948 19.8149 152.948 23.2227C152.948 26.6307 150.5 29.4873 147.308 29.4873C145.652 29.4872 144.38 28.6469 143.828 27.8789V34.2393H140.54V17.2227H143.828V18.5674C144.38 17.7994 145.652 16.9591 147.308 16.959ZM104.9 11.8955C106.988 11.8956 108.812 12.6152 110.276 14.2471L107.972 16.623C107.156 15.6392 106.1 15.1592 104.924 15.1592C103.748 15.1592 102.645 15.6631 102.645 16.6709C102.645 17.7029 103.484 18.1596 105.284 18.8076L106.652 19.3115C109.148 20.2235 110.708 21.8072 110.708 24.375C110.684 27.4229 108.26 29.5106 104.732 29.5107C102.02 29.5107 99.7396 28.3349 98.5156 26.4629L101.18 24.2314C102.02 25.5034 103.484 26.247 104.876 26.2471C106.244 26.2471 107.156 25.5748 107.156 24.5908C107.156 23.631 106.46 22.9587 104.78 22.3828L103.34 21.8789C100.604 20.9189 99.1396 19.3348 99.1396 17.0068C99.1398 13.791 101.588 11.8955 104.9 11.8955ZM86.6201 16.959C89.7641 16.959 92.5244 18.9753 92.5244 22.8633C92.5244 23.1513 92.5246 23.4873 92.4766 23.9912H83.5C83.692 25.5992 85.1084 26.4873 86.6924 26.4873C88.18 26.4872 89.26 25.7914 89.7881 24.9756L92.2363 26.7988C91.1323 28.4068 89.188 29.4873 86.668 29.4873C83.092 29.4872 80.3086 27.0146 80.3086 23.2227C80.3088 19.6709 82.9723 16.959 86.6201 16.959ZM118.275 16.959C120.771 16.9591 122.931 18.3512 123.963 20.415L121.107 21.9512C120.627 20.8473 119.595 20.0314 118.275 20.0312C116.548 20.0312 115.227 21.3749 115.227 23.2227C115.227 25.0707 116.547 26.415 118.275 26.415C119.595 26.4149 120.627 25.599 121.107 24.4951L123.963 26.0312C122.931 28.0951 120.771 29.4872 118.275 29.4873C114.723 29.4873 111.915 26.8467 111.915 23.2227C111.915 19.5989 114.724 16.959 118.275 16.959ZM159.127 17.2227H162.511V20.1035H159.127V24.375C159.127 25.839 159.751 26.415 161.167 26.415C161.695 26.415 162.127 26.3432 162.511 26.1992V29.1035C161.983 29.2715 161.335 29.3672 160.423 29.3672C157.879 29.3672 155.839 27.9512 155.839 25.0234V20.1035H153.415V17.2227H155.839V13.8867H159.127V17.2227ZM53.6641 12.1836C57.12 12.1836 59.6395 14.6791 59.6396 17.9189C59.6396 21.1589 57.12 23.6552 53.6641 23.6553H51.4805V29.2227H48V12.1836H53.6641ZM64.5117 29.2227H61.2236V17.2227H64.5117V29.2227ZM73.9092 16.959C76.813 16.9591 78.541 19.0715 78.541 22.1914V29.2227H75.2529V22.7432C75.2529 21.0152 74.5086 19.959 73.1406 19.959C71.6288 19.9591 70.4766 21.0633 70.4766 23.3672V29.2227H67.1885V17.2227H70.4766V18.5908C71.1006 17.6308 72.3492 16.959 73.9092 16.959ZM131.85 17.0791C132.186 17.0791 132.546 17.1027 132.954 17.2227V20.5596C132.45 20.3916 131.994 20.2949 131.466 20.2949C129.906 20.2949 128.874 21.5193 128.874 23.4873V29.2227H125.586V17.2227H128.874V19.1436C129.282 17.9676 130.506 17.0792 131.85 17.0791ZM137.862 29.2227H134.574V17.2227H137.862V29.2227ZM146.588 19.959C144.788 19.959 143.564 21.3509 143.563 23.2227C143.563 25.0947 144.788 26.4873 146.588 26.4873C148.388 26.4873 149.612 25.0947 149.612 23.2227C149.612 21.3509 148.388 19.959 146.588 19.959ZM169.993 9.76074C170.876 9.76079 171.697 9.9237 172.455 10.25C173.213 10.5764 173.881 11.0326 174.457 11.6182C175.043 12.1942 175.499 12.8617 175.825 13.6201C176.151 14.3783 176.314 15.1991 176.314 16.082C176.314 16.9556 176.152 17.7769 175.825 18.5449C175.499 19.3032 175.043 19.975 174.457 20.5605C173.881 21.1365 173.208 21.5877 172.44 21.9141C171.682 22.2404 170.867 22.4042 169.993 22.4043C169.12 22.4043 168.298 22.2405 167.53 21.9141C166.772 21.5877 166.1 21.1365 165.515 20.5605C164.939 19.975 164.488 19.3032 164.161 18.5449C163.835 17.7769 163.671 16.9556 163.671 16.082C163.671 15.2086 163.835 14.393 164.161 13.6348C164.488 12.8668 164.939 12.1942 165.515 11.6182C166.1 11.0327 166.772 10.5764 167.53 10.25C168.298 9.92362 169.12 9.76074 169.993 9.76074ZM86.5244 19.6709C85.3005 19.6709 83.9323 20.295 83.6201 21.7588H89.2363C88.9482 20.3431 87.7482 19.671 86.5244 19.6709ZM169.993 11.1865C169.312 11.1865 168.672 11.3109 168.077 11.5605C167.492 11.8101 166.974 12.1612 166.522 12.6123C166.071 13.0635 165.72 13.5865 165.471 14.1816C165.221 14.7671 165.097 15.4006 165.097 16.082C165.097 16.7634 165.221 17.402 165.471 17.9971C165.72 18.5827 166.071 19.1015 166.522 19.5527C166.974 20.0038 167.492 20.3539 168.077 20.6035C168.672 20.8531 169.312 20.9785 169.993 20.9785C170.675 20.9785 171.308 20.8531 171.894 20.6035C172.489 20.3539 173.012 20.0038 173.463 19.5527C173.914 19.1015 174.265 18.5827 174.515 17.9971C174.764 17.402 174.889 16.7634 174.889 16.082C174.889 15.4006 174.764 14.7671 174.515 14.1816C174.265 13.5865 173.914 13.0635 173.463 12.6123C173.012 12.1611 172.489 11.8101 171.894 11.5605C171.308 11.311 170.675 11.1866 169.993 11.1865ZM51.4805 20.3916H53.6162C55.2001 20.3915 56.2559 19.3109 56.2559 17.9189C56.2558 16.5271 55.2 15.4474 53.6162 15.4473H51.4805V20.3916ZM169.878 13.2314C170.406 13.2315 170.838 13.2932 171.174 13.418C171.519 13.5332 171.773 13.7163 171.937 13.9658C172.1 14.2154 172.182 14.5271 172.182 14.9014C172.182 15.2469 172.09 15.5494 171.908 15.8086C171.726 16.0581 171.481 16.2646 171.174 16.4277L172.815 18.9336H171.217L169.964 16.8027H169.445V18.9336H168.034V13.2314H169.878ZM169.445 15.751H169.849C170.127 15.751 170.348 15.6932 170.511 15.5781C170.674 15.4533 170.756 15.247 170.756 14.959C170.756 14.7383 170.684 14.5703 170.54 14.4551C170.396 14.3399 170.165 14.2822 169.849 14.2822H169.445V15.751ZM62.8555 11.0791C64.0314 11.0791 64.9677 12.0151 64.9678 13.167C64.9678 14.319 64.0315 15.2549 62.8555 15.2549C61.7275 15.2548 60.7676 14.3189 60.7676 13.167C60.7677 12.0151 61.7276 11.0792 62.8555 11.0791ZM136.207 11.0791C137.383 11.0793 138.318 12.0152 138.318 13.167C138.318 14.3188 137.383 15.2546 136.207 15.2549C135.079 15.2549 134.118 14.319 134.118 13.167C134.118 12.0151 135.079 11.0791 136.207 11.0791Z" fill="currentColor"></path>
</svg>
</div> </a> </div>  </div> <div class="flex" data-astro-cid-d74r2unp=""></div> <div class="flex" data-astro-cid-d74r2unp=""> <div class="search-container" data-astro-cid-fg37foga=""> <div class="search-wrapper" data-astro-cid-fg37foga=""> <input class="search-input" type="text" placeholder="Search docs" name="s" value="" data-astro-cid-fg37foga="" data-has-input-listener="true"> <svg width="28" height="28" viewBox="0 0 28 28" class="search-button" data-astro-cid-fg37foga="" data-icon="theme/search">  <symbol id="ai:local:theme/search"><path fill="currentColor" fill-rule="evenodd" d="M18.5 12.5a6 6 0 1 1-12 0 6 6 0 0 1 12 0m-1.25 5.8a7.5 7.5 0 1 1 1.06-1.06l4.22 4.23.53.53L22 23.06l-.53-.53-4.22-4.22Z" clip-rule="evenodd"></path></symbol><use xlink:href="#ai:local:theme/search"></use>  </svg> <button class="search-clear" type="button" title="Reset" data-search-clear="" data-astro-cid-fg37foga="">Clear</button> <span class="divider" data-astro-cid-fg37foga=""></span> <button class="search-close" type="button" title="Close" data-search-close="" data-astro-cid-fg37foga=""> <svg width="18" height="18" viewBox="0 0 18 18" data-astro-cid-fg37foga="" data-icon="theme/cross-18">  <use xlink:href="#ai:local:theme/cross-18"></use>  </svg> </button> </div> <div id="search-results-wrapper" data-astro-cid-fg37foga=""> <aside id="search-results" hidden="" data-astro-cid-fg37foga="" data-has-button-listener="true"> <!-- Don't use h1 because when built it will be used as the first heading on the page --> <div class="heading" data-astro-cid-fg37foga="">Search results</div> <div id="search-results-contents" data-astro-cid-fg37foga=""></div> </aside> </div> </div>   </div> <ul class="links" data-astro-cid-d74r2unp="">  </ul> <div class="flex" data-astro-cid-d74r2unp=""></div> <div data-hide-when-search="" data-astro-cid-d74r2unp=""> <div id="version-select" data-hideable="true" data-astro-cid-kx7qoxgq=""> <label style="--sl-select-width: undefined; --sl-label-icon-size: 16px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Version</span>  <select value="v6" data-has-border="" no-icon="true" data-astro-cid-lmznfliq=""> <option value="v6" selected="true" data-astro-cid-lmznfliq="">Version 6</option><option value="v5" data-astro-cid-lmznfliq="">Version 5</option><option value="v4" data-astro-cid-lmznfliq="">Version 4</option><option value="v3" data-astro-cid-lmznfliq="">Version 3</option> </select> <svg width="16" height="16" viewBox="0 0 24 24" class="icon caret" data-astro-cid-lmznfliq="" data-icon="theme/down-caret">  <use xlink:href="#ai:local:theme/down-caret"></use>  </svg> </label>  </div>   </div> <button id="search-button" data-astro-cid-6zeqadij="" data-has-listener="true"> <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-6zeqadij="" data-icon="theme/search">  <use xlink:href="#ai:local:theme/search"></use>  </svg> </button>  <script data-base-url="/pine-script-docs" data-astro-exec="">
	async function loadPageFind() {
		const base = document.currentScript.getAttribute('data-base-url');
		const pageFindBundleUrl = `${base}/pagefind/`;
		const pagefind = await import(`${pageFindBundleUrl}pagefind.js`);
		await pagefind.options({
			bundlePath: pageFindBundleUrl,
		});
		window.pagefind = pagefind;
	}
	loadPageFind().catch();
</script>  <docs-theme-select class="hide-with-breakpoint-568" data-astro-cid-3wpspbi7=""> <label style="--sl-select-width: 48px; --sl-label-icon-size: 28px;" data-astro-cid-lmznfliq=""> <span class="sr-only" data-astro-cid-lmznfliq="">Theme</span> <svg width="28" height="28" viewBox="0 0 28 28" class="icon label-icon" data-button="" data-round="" data-astro-cid-lmznfliq="" data-icon="theme/system-28">  <symbol id="ai:local:theme/system-28"><path fill="currentColor" d="M8 4h1v2H8zm0 9v2h1v-2zm6-3V9h-2v1zM3 9v1h2V9zm5.5 3a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5m4.2-6-.7-.7-1.4 1.4.7.7zM5 13.7l-.7-.7 1.4-1.4.7.7zm7.7-.7-.7.7-1.4-1.4.7-.7zM4.3 6l.7-.7 1.4 1.4-.7.7zm3 17 14-14 .8.7L8 23.7zm17.2-.1a3.5 3.5 0 0 1-3.4-5.9H21a4 4 0 1 0 3.5 5.9"></path></symbol><use xlink:href="#ai:local:theme/system-28"></use>  </svg> <select value="auto" data-button="" data-astro-cid-lmznfliq=""> <option value="dark" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Dark&nbsp;&nbsp;</option><option value="light" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Light&nbsp;&nbsp;</option><option value="auto" selected="true" data-astro-cid-lmznfliq="">&nbsp;&nbsp;Auto&nbsp;&nbsp;</option> </select>  </label>  </docs-theme-select>   <script data-astro-exec="">
	ThemeProvider.updatePickers('unknown');
</script>  </nav> </header>        <div id="image-lightbox" class="not-content" hidden="" data-astro-cid-kws7taxh=""> <div class="button-wrapper" data-astro-cid-kws7taxh=""> <div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <button id="lightbox-close-button" title="Close image preview" data-astro-cid-pkzv2hgs="" class="not-content stvb-base stvb-pointer stvb-black stvb-medium stvb-secondary stvb-icon stvb-force-no-border">  <svg width="24" height="24" viewBox="0 0 18 18" data-astro-cid-kws7taxh="" data-icon="theme/cross-18">  <symbol id="ai:local:theme/cross-18"><g fill="none"><g clip-path="url(#a)"><path fill="currentColor" fill-rule="evenodd" d="M5.53 4.47 4.47 5.53 7.94 9l-3.47 3.47 1.06 1.06L9 10.06l3.47 3.47 1.06-1.06L10.06 9l3.47-3.47-1.06-1.06L9 7.94z" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h18v18H0z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/cross-18"></use>  </svg>  </button> </div>  </div> <img id="lightbox-image" src="" data-astro-cid-kws7taxh=""> </div>   <div id="page-container" data-astro-cid-xgirumru=""> <aside id="nav" class="" style="" data-astro-cid-sa57sq6l=""> <div class="sidebar-viewport slick-scroll" data-astro-cid-sa57sq6l=""> <div class="sidebar" data-astro-cid-sa57sq6l=""> <ul class="toc" aria-label="Docs sidebar" data-astro-cid-sa57sq6l=""> <li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/welcome" data-astro-cid-omxx3dey="">Welcome to Pine Script® v6</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Pine Script® primer</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <symbol id="ai:local:theme/right-caret"><path fill="currentColor" d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1 1 0 0 0 0-1.42"></path></symbol><use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-steps" data-astro-cid-omxx3dey="">First steps</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/first-indicator" data-astro-cid-omxx3dey="">First indicator</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/primer/next-steps" data-astro-cid-omxx3dey="">Next steps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Language</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/execution-model" data-astro-cid-omxx3dey="">Execution model</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/type-system" data-astro-cid-omxx3dey="">Type system</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/script-structure" data-astro-cid-omxx3dey="">Script structure</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/identifiers" data-astro-cid-omxx3dey="">Identifiers</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/variable-declarations" data-astro-cid-omxx3dey="">Variable declarations</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/operators" data-astro-cid-omxx3dey="">Operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/conditional-structures" data-astro-cid-omxx3dey="">Conditional structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/loops" data-astro-cid-omxx3dey="">Loops</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/built-ins" data-astro-cid-omxx3dey="">Built-ins</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/user-defined-functions" data-astro-cid-omxx3dey="">User-defined functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/objects" data-astro-cid-omxx3dey="">Objects</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/enums" data-astro-cid-omxx3dey="">Enums</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/methods" data-astro-cid-omxx3dey="">Methods</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/arrays" data-astro-cid-omxx3dey="">Arrays</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/matrices" data-astro-cid-omxx3dey="">Matrices</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/language/maps" data-astro-cid-omxx3dey="">Maps</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details open="" data-is-parent="" data-is-on-path="" data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Visuals</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/backgrounds" data-astro-cid-omxx3dey="">Backgrounds</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-coloring" data-astro-cid-omxx3dey="">Bar coloring</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/bar-plotting" data-astro-cid-omxx3dey="">Bar plotting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/colors" data-astro-cid-omxx3dey="">Colors</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/fills" data-astro-cid-omxx3dey="">Fills</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/levels" data-astro-cid-omxx3dey="">Levels</a></li><li class="item" data-current="" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/lines-and-boxes" data-astro-cid-omxx3dey="">Lines and boxes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/plots" data-astro-cid-omxx3dey="">Plots</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/tables" data-astro-cid-omxx3dey="">Tables</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/visuals/text-and-shapes" data-astro-cid-omxx3dey="">Text and shapes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Concepts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/bar-states" data-astro-cid-omxx3dey="">Bar states</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/chart-information" data-astro-cid-omxx3dey="">Chart information</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/inputs" data-astro-cid-omxx3dey="">Inputs</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/libraries" data-astro-cid-omxx3dey="">Libraries</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/non-standard-charts-data" data-astro-cid-omxx3dey="">Non-standard charts data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/other-timeframes-and-data" data-astro-cid-omxx3dey="">Other timeframes and data</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/repainting" data-astro-cid-omxx3dey="">Repainting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/sessions" data-astro-cid-omxx3dey="">Sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/strings" data-astro-cid-omxx3dey="">Strings</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/time" data-astro-cid-omxx3dey="">Time</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/concepts/timeframes" data-astro-cid-omxx3dey="">Timeframes</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Writing scripts</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/style-guide" data-astro-cid-omxx3dey="">Style guide</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/debugging" data-astro-cid-omxx3dey="">Debugging</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/profiling-and-optimization" data-astro-cid-omxx3dey="">Profiling and optimization</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/publishing" data-astro-cid-omxx3dey="">Publishing scripts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/writing/limitations" data-astro-cid-omxx3dey="">Limitations</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">FAQ</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/general" data-astro-cid-omxx3dey="">General</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/alerts" data-astro-cid-omxx3dey="">Alerts</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/data-structures" data-astro-cid-omxx3dey="">Data structures</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/functions" data-astro-cid-omxx3dey="">Functions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/indicators" data-astro-cid-omxx3dey="">Indicators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/other-data-and-timeframes" data-astro-cid-omxx3dey="">Other data and timeframes</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/programming" data-astro-cid-omxx3dey="">Programming</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strategies" data-astro-cid-omxx3dey="">Strategies</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/strings-and-formatting" data-astro-cid-omxx3dey="">Strings and formatting</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/techniques" data-astro-cid-omxx3dey="">Techniques</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/times-dates-and-sessions" data-astro-cid-omxx3dey="">Times, dates, and sessions</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/variables-and-operators" data-astro-cid-omxx3dey="">Variables and operators</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/faq/visuals" data-astro-cid-omxx3dey="">Visuals</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/error-messages" data-astro-cid-omxx3dey="">Error messages</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/release-notes" data-astro-cid-omxx3dey="">Release notes</a></li><li class="item" data-astro-cid-omxx3dey=""><details data-astro-cid-omxx3dey=""><summary data-astro-cid-omxx3dey=""><div class="summary-link" data-astro-cid-omxx3dey="">Migration guides</div><div class="caret" data-astro-cid-omxx3dey=""><svg width="18" height="18" viewBox="0 0 24 24" class="icon" data-astro-cid-omxx3dey="" data-icon="theme/right-caret">  <use xlink:href="#ai:local:theme/right-caret"></use>  </svg></div></summary><ul class="children" data-astro-cid-omxx3dey=""><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/overview" data-astro-cid-omxx3dey="">Overview</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-6" data-astro-cid-omxx3dey="">To Pine Script® version 6</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-5" data-astro-cid-omxx3dey="">To Pine Script® version 5</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-4" data-astro-cid-omxx3dey="">To Pine Script® version 4</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-3" data-astro-cid-omxx3dey="">To Pine Script® version 3</a></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/migration-guides/to-pine-version-2" data-astro-cid-omxx3dey="">To Pine Script® version 2</a></li></ul></details></li><li class="item" data-astro-cid-omxx3dey=""><a class="page-link" href="/pine-script-docs/where-can-i-get-more-information" data-astro-cid-omxx3dey="">Where can I get more information?</a></li> </ul> <div class="toc-bottom" data-astro-cid-sa57sq6l=""></div> </div> </div> </aside>  <main class="main-pane" data-page-type="md" data-astro-cid-xgirumru=""> <a id="top" data-astro-cid-xgirumru=""></a> <main class="content" data-toc-shown="" data-astro-cid-ju3wuhkz="">  <div class="content-width" data-astro-cid-xgirumru=""> <div class="breadcrumbs" data-pagefind-ignore="" data-astro-cid-wlavna2o=""> <a href="/pine-script-docs" aria-label="Return back to the documentation home page." data-astro-cid-wlavna2o=""> <span data-astro-cid-wlavna2o="">User Manual</span>  </a>  <span class="divider" data-astro-cid-wlavna2o="">/</span> <a href="/pine-script-docs/visuals/overview" data-astro-cid-wlavna2o="">Visuals</a> <span class="divider" data-astro-cid-wlavna2o="">/</span> <span class="current-item" data-astro-cid-wlavna2o="">Lines and boxes</span> </div>     </div> <div id="slot-container" data-astro-cid-xgirumru=""> <h1 id="lines-and-boxes" class="md-heading"><a href="#lines-and-boxes">Lines and <span class="fancy-wrap">boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h1>
<h2 id="introduction" class="md-heading"><a href="#introduction"> <span class="fancy-wrap">Introduction<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Pine Script® facilitates drawing lines, boxes, and other geometric
formations from code using the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>,
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_polyline">polyline</a>
types. These types provide utility for programmatically drawing support
and resistance levels, trend lines, price ranges, and other custom
formations on a chart.</p>
<p>Unlike <a href="/pine-script-docs/visuals/plots/">plots</a>, the
flexibility of these types makes them particularly well-suited for
visualizing current calculated data at virtually any available point on
the chart, irrespective of the chart bar the script executes on.</p>
<p><a href="/pine-script-docs/visuals/lines-and-boxes/#lines">Lines</a>,
<a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>, and
<a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a>
are <em>objects</em>, like
<a href="/pine-script-docs/visuals/text-and-shapes/#labels">labels</a>,
<a href="/pine-script-docs/visuals/tables/">tables</a>, and other <em>special
types</em>. Scripts reference objects of these types using IDs, which act
like <em>pointers</em>. As with other objects,
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>,
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_polyline">polyline</a>
IDs are qualified as “series” values, and all functions that manage
these objects accept “series” arguments.</p>
<aside aria-label="Tip" class="tv-informer not-content" style="--informer-header-color:#089981;--informer-back-color-light:#DAF2EE;--informer-back-color-dark:#082621"><div class="tv-informer-icon"><svg viewBox="0 0 18 18" width="18" height="18"><path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16Zm3.87-12.15c.36.2.49.66.28 1.02l-4 7a.75.75 0 0 1-1.18.16l-3-3a.75.75 0 1 1 1.06-1.06l2.3 2.3 3.52-6.14a.75.75 0 0 1 1.02-.28Z" fill="currentColor"></path></svg></div><div class="tv-informer-content"><p><span class="tv-informer-header">Tip</span>Using the types we discuss on this page often involves working with <em>arrays</em>, especially when creating <a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a> or managing active drawings on the chart. Therefore, we recommend reading and understanding the <a href="/pine-script-docs/language/arrays/">Arrays</a> page to make the most of these drawing types in your scripts.</p></div></aside>
<p>Lines drawn by a script may be vertical, horizontal, or angled. Boxes
are always rectangular. Polylines sequentially connect multiple
vertical, horizontal, angled, or curved line segments. Although all of
these drawing types have different characteristics, they do have some
things in common:</p>
<ul>
<li><a href="/pine-script-docs/visuals/lines-and-boxes/#lines">Lines</a>,
<a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>, and
<a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a> can have coordinates at any available location on the
chart, including ones at future times beyond the last chart bar.</li>
<li>Objects of these types can use
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
instances to set their coordinates.</li>
<li>The x-coordinates of each object can be bar index or time values,
depending on their specified <code dir="auto">xloc</code> property.</li>
<li>Each object can have one of multiple predefined line styles.</li>
<li>Scripts can call the functions that manage these objects from within
the scopes of <a href="/pine-script-docs/language/loops/">loops</a> and
<a href="/pine-script-docs/language/conditional-structures/">conditional structures</a>, allowing iterative and conditional control of their
drawings.</li>
<li>There are limits on the number of these objects that a script can
reference and display on the chart. A single script instance can
display up to 500 lines, 500 boxes, and 100 polylines. Users can
specify the maximum number allowed for each type via the
<code dir="auto">max_lines_count</code>, <code dir="auto">max_boxes_count</code>, and <code dir="auto">max_polylines_count</code>
parameters of the script’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_strategy">strategy()</a>
declaration statement. If unspecified, the default is ~50. As with
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_label">label</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_table">table</a>
types, lines, boxes, and polylines utilize a <em>garbage collection</em>
mechanism that deletes the oldest objects on the chart when the
total number of drawings exceeds the script’s limit.</li>
</ul>
<aside aria-label="Note" class="tv-informer not-content" style="--informer-header-color:#6A6D78;--informer-back-color-light:#F0F3FA;--informer-back-color-dark:#2A2E39"><div class="tv-informer-icon"><svg viewBox="0 0 18 18" width="18" height="18"><path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM8 6a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1 2c.49 0 1 .59 1 1v3.01c0 .42-.51.99-1 .99s-1-.57-1-.99V9c0-.41.51-1 1-1Z" fill="currentColor"></path></svg></div><div class="tv-informer-content"><p><span class="tv-informer-header">Note</span>The Supercharts interface features a set of <em>drawing tools</em> that enable users to draw on the chart using mouse actions. Although some of those drawings might resemble the outputs of a script’s drawing objects, it’s crucial to understand that they are <strong>unrelated</strong> entities. Scripts cannot interact with the chart’s drawing tools. Additionally, mouse actions do not directly affect a script’s drawing objects.</p></div></aside>
<h2 id="lines" class="md-heading"><a href="#lines"> <span class="fancy-wrap">Lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>The built-ins in the <code dir="auto">line.*</code> namespace control the creation and
management of
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
objects:</p>
<ul>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
function creates a new line.</li>
<li>The <code dir="auto">line.set_*()</code> functions modify line properties.</li>
<li>The <code dir="auto">line.get_*()</code> functions retrieve values from a line instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.copy">line.copy()</a>
function clones a line instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.delete">line.delete()</a>
function deletes an existing line instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_line.all">line.all</a>
variable references a read-only
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
containing the IDs of all lines displayed by the script. The
array’s size
depends on the <code dir="auto">max_lines_count</code> of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_strategy">strategy()</a>
declaration statement and the number of lines the script has drawn.</li>
</ul>
<p>Scripts can call <code dir="auto">line.set_*()</code>, <code dir="auto">line.get_*()</code>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.copy">line.copy()</a>,
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.delete">line.delete()</a>
built-ins as functions or <a href="/pine-script-docs/language/methods/">methods</a>.</p>
<h3 id="creating-lines" class="md-heading"><a href="#creating-lines">Creating <span class="fancy-wrap">lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
function creates a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
instance to display on the chart. It has the following signatures:</p>
<div class="expressive-code not-content"><link rel="stylesheet" href="/pine-script-docs/_astro/ec.dtidy.css"><script type="module" src="/pine-script-docs/_astro/ec.qopfj.js" data-astro-exec=""></script><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text" tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">line.new(first_point, second_point, xloc, extend, color, style, width, force_overlay) → series line</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">line.new(x1, y1, x2, y2, xloc, extend, color, style, width, force_overlay) → series line</span></div></div></code></pre></figure></div>
<p>The first overload of this function contains the <code dir="auto">first_point</code> and
<code dir="auto">second_point</code> parameters. The <code dir="auto">first_point</code> is a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
representing the start of the line, and the <code dir="auto">second_point</code> is a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
representing the line’s end. The function copies the information from
these
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> to determine the line’s coordinates. Whether it uses the
<code dir="auto">index</code> or <code dir="auto">time</code> fields from the <code dir="auto">first_point</code> and <code dir="auto">second_point</code> as
x-coordinates depends on the function’s <code dir="auto">xloc</code> value.</p>
<p>The second overload specifies <code dir="auto">x1</code>, <code dir="auto">y1</code>, <code dir="auto">x2</code>, and <code dir="auto">y2</code> values
independently, where <code dir="auto">x1</code> and <code dir="auto">x2</code> are
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_int">int</a>
values representing the starting and ending x-coordinates of the line,
and <code dir="auto">y1</code> and <code dir="auto">y2</code> are
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_float">float</a>
values representing the y-coordinates. Whether the line considers the
<code dir="auto">x</code> values as bar indices or timestamps depends on the <code dir="auto">xloc</code> value in
the function call.</p>
<p>Both overloads share the same additional parameters:</p>
<p><code dir="auto">xloc</code></p>
<p class="spacer-wrapper"><spacer></spacer>Controls whether the x-coordinates of the new line use bar index or
time values. Its default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>.</p>
<p class="spacer-wrapper"><spacer></spacer>When calling the first overload, using an <code dir="auto">xloc</code> value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
tells the function to use the <code dir="auto">index</code> fields of the <code dir="auto">first_point</code>
and <code dir="auto">second_point</code>, and a value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>
tells the function to use the <code dir="auto">time</code> fields of the points.</p>
<p class="spacer-wrapper"><spacer></spacer>When calling the second overload, an <code dir="auto">xloc</code> value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
prompts the function to treat the <code dir="auto">x1</code> and <code dir="auto">x2</code> arguments as bar
index values. When using
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>,
the function will treat <code dir="auto">x1</code> and <code dir="auto">x2</code> as time values.</p>
<p class="spacer-wrapper"><spacer></spacer>When the specified x-coordinates represent <em>bar index</em> values, it’s
important to note that the minimum x-coordinate allowed is
<code dir="auto">bar_index - 10000</code>. For larger offsets, one can use
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>.</p>
<p><code dir="auto">extend</code></p>
<p class="spacer-wrapper"><spacer></spacer>Determines whether the drawn line will infinitely extend beyond its
defined start and end coordinates. It accepts one of the following
values:
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.left">extend.left</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.right">extend.right</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.both">extend.both</a>,
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.none">extend.none</a>
(default).</p>
<p><code dir="auto">color</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the color of the line drawing. The default is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_color.blue">color.blue</a>.</p>
<p><code dir="auto">style</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the line’s style, which can be any of the options listed
in this page’s
<a href="/pine-script-docs/visuals/lines-and-boxes/#line-styles">Line styles</a> section. The default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_line.style_solid">line.style_solid</a>.</p>
<p><code dir="auto">width</code></p>
<p class="spacer-wrapper"><spacer></spacer>Controls the width of the line, in pixels. The default value is 1.</p>
<p><code dir="auto">force_overlay</code></p>
<p class="spacer-wrapper"><spacer></spacer>If <code dir="auto">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir="auto">false</code>.</p>
<p>The example below demonstrates how one can draw lines in their simplest
form. This script draws a new vertical line connecting the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_open">open</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_close">close</a>
prices at the horizontal center of each chart bar:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Creating-lines-1.B2RdyvXG_1Vqnm2.webp" alt="image" width="1334" height="550" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="5ar"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Creating&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;line.&nbsp;Cont</span><span class="mtk9">ains&nbsp;`index`&nbsp;and&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;line.&nbsp;Contai</span><span class="mtk9">ns&nbsp;`index`&nbsp;and&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;basic&nbsp;line&nbsp;with&nbsp;a&nbsp;`width`&nbsp;of&nbsp;5&nbsp;connectin</span><span class="mtk9">g&nbsp;the&nbsp;`firstPoint`&nbsp;to&nbsp;the&nbsp;`secondPoint`.</span></span><br><span><span class="mtk9">//&nbsp;This&nbsp;line&nbsp;uses&nbsp;the&nbsp;`index`&nbsp;field&nbsp;from&nbsp;each&nbsp;poin</span><span class="mtk9">t&nbsp;for&nbsp;its&nbsp;x-coordinates.</span></span><br><span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">5</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;the&nbsp;background&nbsp;on&nbsp;the&nbsp;unconfirmed&nbsp;bar.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.isconfirmed</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Unconfirmed&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>If the <code dir="auto">firstPoint</code> and <code dir="auto">secondPoint</code> reference identical
coordinates, the script will <em>not</em> display a line since there is
no distance between them to draw. However, the line ID will
still exist.</li>
<li>The script will only display approximately the last 50 lines on
the chart, as it does not have a specified <code dir="auto">max_lines_count</code> in
the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call. Line drawings persist on the chart until deleted
using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.delete">line.delete()</a>
or removed by the garbage collector.</li>
<li>The script <em>redraws</em> the line on the open chart bar (i.e., the
bar with an orange background highlight) until it closes. After
the bar closes, it will no longer update the drawing.</li>
</ul>
<p>Let’s look at a more involved example. This script uses the previous
bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_hl2">hl2</a>
price and the current bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_high">high</a>
and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_low">low</a>
prices to draw a fan with a user-specified number of lines projecting a
range of hypothetical price values for the following chart bar. It calls
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
within a <a href="/pine-script-docs/language/loops/#for-loops">for</a> loop to
create <code dir="auto">linesPerBar</code> lines on each bar:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Creating-lines-2.DqR4SD_f_2jEAVG.webp" alt="image" width="1328" height="598" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="5v4"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Creating&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Simple&nbsp;projection&nbsp;fan"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_lines_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;fan&nbsp;lines&nbsp;drawn&nbsp;on&nbsp;each&nbsp;chart&nbsp;bar.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">linesPerBar</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Line&nbsp;drawings&nbsp;per&nbsp;bar"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;distance&nbsp;between&nbsp;each&nbsp;y&nbsp;point&nbsp;on&nbsp;the&nbsp;current&nbsp;</span><span class="mtk9">bar.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">linesPerBar</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;start&nbsp;of&nbsp;each&nbsp;line.&nbsp;Doe</span><span class="mtk9">s&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">])</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;end&nbsp;of&nbsp;each&nbsp;line.&nbsp;Does&nbsp;</span><span class="mtk9">not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">float</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;stepped&nbsp;y&nbsp;value&nbsp;on&nbsp;the&nbsp;current&nbsp;bar&nbsp;for&nbsp;`secon</span><span class="mtk9">dPoint.price`&nbsp;calculation,&nbsp;starting&nbsp;from&nbsp;the&nbsp;`low`</span><span class="mtk9">.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">barValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span></span><br><span><span class="mtk9">//&nbsp;Loop&nbsp;to&nbsp;draw&nbsp;the&nbsp;fan.</span></span><br><span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">to</span><span class="mtk1">&nbsp;</span><span class="mtk33">linesPerBar</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;`price`&nbsp;of&nbsp;the&nbsp;`secondPoint`&nbsp;using&nbsp;t</span><span class="mtk9">he&nbsp;difference&nbsp;between&nbsp;the&nbsp;`barValue`&nbsp;and&nbsp;`firstPoi</span><span class="mtk9">nt.price`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2.0</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">barValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">firstPoint</span><span class="mtk1">.</span><span class="mtk33">price</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`color.aqua`&nbsp;when&nbsp;the&nbsp;line's&nbsp;slope&nbsp;is&nbsp;positive</span><span class="mtk9">,&nbsp;`color.fuchsia`&nbsp;otherwise.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">firstPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.fuchsia</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`lineColor`&nbsp;line&nbsp;connecting&nbsp;the&nbsp;`fir</span><span class="mtk9">stPoint`&nbsp;and&nbsp;`secondPoint`&nbsp;coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;This&nbsp;line&nbsp;uses&nbsp;the&nbsp;`index`&nbsp;field&nbsp;from&nbsp;each&nbsp;poin</span><span class="mtk9">t&nbsp;for&nbsp;its&nbsp;x-coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;`step`&nbsp;to&nbsp;the&nbsp;`barValue`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">barValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;the&nbsp;background&nbsp;on&nbsp;the&nbsp;unconfirmed&nbsp;bar.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.isconfirmed</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Unconfirmed&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>We’ve included <code dir="auto">max_lines_count = 500</code> in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call, meaning the script preserves up to 500 lines on
the chart.</li>
<li>Each
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
call <em>copies</em> the information from the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
referenced by the <code dir="auto">firstPoint</code> and <code dir="auto">secondPoint</code> variables. As
such, the script can change the <code dir="auto">price</code> field of the
<code dir="auto">secondPoint</code> on each loop iteration without affecting the
y-coordinates in other lines.</li>
</ul>
<h3 id="modifying-lines" class="md-heading"><a href="#modifying-lines">Modifying <span class="fancy-wrap">lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <code dir="auto">line.*</code> namespace contains multiple <em>setter</em> functions that modify
the properties of
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
instances:</p>
<ul>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_first_point">line.set_first_point()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_second_point">line.set_second_point()</a>
respectively update the start and end points of the <code dir="auto">id</code> line using
information from the specified <code dir="auto">point</code>.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_x1">line.set_x1()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_x2">line.set_x2()</a>
set one of the x-coordinates of the <code dir="auto">id</code> line to a new <code dir="auto">x</code> value,
which can represent a bar index or time value depending on the
line’s <code dir="auto">xloc</code> property.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_y1">line.set_y1()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_y2">line.set_y2()</a>
set one of the y-coordinates of the <code dir="auto">id</code> line to a new <code dir="auto">y</code> value.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_xy1">line.set_xy1()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_xy2">line.set_xy2()</a>
update one of the <code dir="auto">id</code> line’s points with new <code dir="auto">x</code> and <code dir="auto">y</code> values.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_xloc">line.set_xloc()</a>
sets the <code dir="auto">xloc</code> of the <code dir="auto">id</code> line and updates both of its
x-coordinates with new <code dir="auto">x1</code> and <code dir="auto">x2</code> values.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_extend">line.set_extend()</a>
sets the <code dir="auto">extend</code> property of the <code dir="auto">id</code> line.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_color">line.set_color()</a>
updates the <code dir="auto">id</code> line’s <code dir="auto">color</code> value.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_style">line.set_style()</a>
changes the <code dir="auto">style</code> of the <code dir="auto">id</code> line.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_width">line.set_width()</a>
sets the <code dir="auto">width</code> of the <code dir="auto">id</code> line.</li>
</ul>
<p>All setter functions directly modify the <code dir="auto">id</code> line passed into the call
and do not return any value. Each setter function accepts “series”
arguments, as a script can change a line’s properties throughout its
execution.</p>
<p>The following example draws lines connecting the opening price of a
<code dir="auto">timeframe</code> to its closing price. The script uses the
<a href="https://www.tradingview.com/pine-script-reference/v6/#kw_var">var</a>
keyword to declare <code dir="auto">periodLine</code> and the variables that reference
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects (<code dir="auto">openPoint</code> and <code dir="auto">closePoint</code>) only on the <em>first</em> chart bar, and
it assigns new references to these variables over its execution. After
detecting a new bar on the specified timeframe with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timeframe.change">timeframe.change</a>, the script uses <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_color">line.set_color()</a> to set the <code dir="auto">color</code> property of the current line referenced by <code dir="auto">periodLine</code>, creates new chart points for <code dir="auto">openPoint</code> and <code dir="auto">closePoint</code> using <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.now">chart.point.now()</a>, calls <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a> to create another line anchored to those points, then assigns the new line’s reference to <code dir="auto">periodLine</code>.</p>
<p>On other bars where the <code dir="auto">periodLine</code> reference is not
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>, the
script assigns a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a> reference to the <code dir="auto">closePoint</code> variable, then uses
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_second_point">line.set_second_point()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_color">line.set_color()</a>
as <a href="/pine-script-docs/language/methods/">methods</a> to update the end coordinate and color of the latest line:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Modifying-lines-1.9MbH8maN_1T4Dvi.webp" alt="image" width="1334" height="604" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="5lv"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Modifying&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;size&nbsp;of&nbsp;each&nbsp;period.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeframe</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.timeframe</span><span class="mtk13">(</span><span class="mtk29">"D"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Timeframe"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;line&nbsp;connecting&nbsp;the&nbsp;period's&nbsp;opening&nbsp;and&nbsp;closin</span><span class="mtk9">g&nbsp;prices.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">periodLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;first&nbsp;point&nbsp;of&nbsp;the&nbsp;line.&nbsp;Contains&nbsp;`time`&nbsp;and&nbsp;</span><span class="mtk9">`index`&nbsp;information.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;closing&nbsp;point&nbsp;of&nbsp;the&nbsp;line.&nbsp;Contains&nbsp;`time`&nbsp;an</span><span class="mtk9">d&nbsp;`index`&nbsp;information.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk16">timeframe.change</span><span class="mtk13">(</span><span class="mtk33">timeframe</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;final&nbsp;color&nbsp;of&nbsp;the&nbsp;`periodLine`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">finalColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">switch</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.green</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.gray</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;color&nbsp;of&nbsp;the&nbsp;current&nbsp;`periodLine`&nbsp;to</span><span class="mtk9">&nbsp;the&nbsp;`finalColor`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.set_color</span><span class="mtk13">(</span><span class="mtk33">periodLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">finalColor</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;new&nbsp;points&nbsp;to&nbsp;the&nbsp;`openPoint`&nbsp;and&nbsp;`close</span><span class="mtk9">Point`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;line&nbsp;to&nbsp;the&nbsp;`periodLine`.&nbsp;Uses&nbsp;`ti</span><span class="mtk9">me`&nbsp;fields&nbsp;from&nbsp;the&nbsp;`openPoint`&nbsp;and&nbsp;`closePoint`&nbsp;a</span><span class="mtk9">s&nbsp;x-coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">periodLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">openPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">style</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">line.style_arrow_right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">else</span><span class="mtk1">&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk16">na</span><span class="mtk13">(</span><span class="mtk33">periodLine</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;point&nbsp;to&nbsp;the&nbsp;`closePoint`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;color&nbsp;of&nbsp;the&nbsp;developing&nbsp;`periodLine`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">developingColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk18">switch</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.aqua</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.fuchsia</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=&gt;</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk11">color.gray</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;line's&nbsp;second&nbsp;poi</span><span class="mtk9">nt&nbsp;using&nbsp;the&nbsp;new&nbsp;`closePoint`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;It&nbsp;uses&nbsp;the&nbsp;`time`&nbsp;field&nbsp;from&nbsp;the&nbsp;point&nbsp;for&nbsp;its</span><span class="mtk9">&nbsp;new&nbsp;x-coordinate.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">periodLine</span><span class="mtk1">.</span><span class="mtk15">set_second_point</span><span class="mtk13">(</span><span class="mtk33">closePoint</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;color&nbsp;of&nbsp;the&nbsp;line&nbsp;using&nbsp;the&nbsp;`develop</span><span class="mtk9">ingColor`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">periodLine</span><span class="mtk1">.</span><span class="mtk15">set_color</span><span class="mtk13">(</span><span class="mtk33">developingColor</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>Each line drawing in this example uses the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_line.style_arrow_right">line.style_arrow_right</a>
style. See the
<a href="/pine-script-docs/visuals/lines-and-boxes/#line-styles">Line styles</a> section below for an overview of all available style
settings.</li>
</ul>
<h3 id="line-styles" class="md-heading"><a href="#line-styles">Line <span class="fancy-wrap">styles<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Users can control the style of their scripts’ line drawings by passing
one of the following variables as the <code dir="auto">style</code> argument in their
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.set_style">line.set_style()</a>
function calls:</p>

































<table><thead><tr><th>Argument</th><th>Line</th></tr></thead><tbody><tr><td><code dir="auto">line.style_solid</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-solid.DhD1RUy8_12kPg2.webp" alt="line_style_solid" width="744" height="652" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_dotted</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-dotted.ChjUGoWk_Z25Ho6S.webp" alt="line_style_dotted" width="744" height="652" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_dashed</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-dashed.RIt4NsM6_DFkrB.webp" alt="line_style_dashed" width="744" height="652" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_arrow_left</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_left.CASIwsfy_Z1JIiS0.webp" alt="line_style_arrow_left" width="744" height="652" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_arrow_right</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_right.Ch2Ohee9_C6Kmb.webp" alt="line_style_arrow_right" width="744" height="652" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_arrow_both</code></td><td><img src="/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_both.CDMgsUYf_Z1hzmym.webp" alt="line_style_arrow_both" width="744" height="652" loading="lazy" decoding="async"></td></tr></tbody></table>
<p>Note that:</p>
<ul>
<li><em>Polylines</em> can also use any of these variables as their
<code dir="auto">line_style</code> value. See the
<a href="/pine-script-docs/visuals/lines-and-boxes/#creating-polylines">Creating polylines</a> section of this page.</li>
</ul>
<h3 id="reading-line-values" class="md-heading"><a href="#reading-line-values">Reading line <span class="fancy-wrap">values<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <code dir="auto">line.*</code> namespace includes <em>getter</em> functions, which allow a script
to retrieve values from a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
object for further use:</p>
<ul>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_x1">line.get_x1()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_x2">line.get_x2()</a>
respectively get the first and second x-coordinate from the <code dir="auto">id</code>
line. Whether the value returned represents a bar index or time
value depends on the line’s <code dir="auto">xloc</code> property.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_y1">line.get_y1()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_y2">line.get_y2()</a>
respectively get the <code dir="auto">id</code> line’s first and second y-coordinate.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_price">line.get_price()</a>
retrieves the price (y-coordinate) from a line <code dir="auto">id</code> at a specified
<code dir="auto">x</code> value, including at bar indices outside the line’s start and
end points. This function is only compatible with lines that use
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
as the <code dir="auto">xloc</code> value.</li>
</ul>
<p>The script below draws a new line upon the onset of a rising or falling
price pattern forming over <code dir="auto">length</code> bars. It uses the
<a href="https://www.tradingview.com/pine-script-reference/v6/#kw_var">var</a>
keyword to declare the <code dir="auto">directionLine</code> variable on the first chart bar.
The line reference assigned to <code dir="auto">directionLine</code> persists over subsequent bars
until the <code dir="auto">newDirection</code> condition occurs, in which case the script
assigns a creates a new line with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new</a> and assigns that line’s reference to the variable.</p>
<p>On every bar, the script calls the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_y2">line.get_y2()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_y1">line.get_y1()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_x2">line.get_x2()</a>,
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_x1">line.get_x1()</a>
getters as <a href="/pine-script-docs/language/methods/">methods</a> to
retrieve values from the current line referenced by <code dir="auto">directionLine</code> and calculate its slope, then uses the result to determine the color of each drawing and plot.
The script retrieves an extended value of the current line from <em>beyond</em> its second point using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_price">line.get_price()</a>
and <a href="/pine-script-docs/visuals/plots/">plots</a> the returned value on the chart:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Reading-line-values-1.C9ypOdeZ_Gv53Q.webp" alt="image" width="1276" height="562" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="142"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Reading&nbsp;line&nbsp;values&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;for&nbsp;rising&nbsp;and&nbsp;falling&nbsp;calcula</span><span class="mtk9">tions.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;line&nbsp;that's&nbsp;drawn&nbsp;whenever&nbsp;`hlc3`&nbsp;starts&nbsp;rising</span><span class="mtk9">&nbsp;or&nbsp;falling&nbsp;over&nbsp;`length`&nbsp;bars.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">directionLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;`hlc3`&nbsp;is&nbsp;rising&nbsp;over&nbsp;`length`&nbsp;bar</span><span class="mtk9">s,&nbsp;`false`&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">rising</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.rising</span><span class="mtk13">(</span><span class="mtk11">hlc3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;`hlc3`&nbsp;is&nbsp;falling&nbsp;over&nbsp;`length`&nbsp;ba</span><span class="mtk9">rs,&nbsp;`false`&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">falling</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.falling</span><span class="mtk13">(</span><span class="mtk11">hlc3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;a&nbsp;rising&nbsp;or&nbsp;falling&nbsp;pattern&nbsp;begins</span><span class="mtk9">,&nbsp;`false`&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newDirection</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">rising</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk33">rising</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">])</span><span class="mtk1">&nbsp;</span><span class="mtk18">or</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">falling</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk33">falling</span><span class="mtk13">[</span><span class="mtk12">1</span><span class="mtk13">])</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;`directionLine`&nbsp;when&nbsp;`newDirection`&nbsp;</span><span class="mtk9">is&nbsp;`true`.&nbsp;The&nbsp;line&nbsp;uses&nbsp;the&nbsp;default&nbsp;`xloc.bar_ind</span><span class="mtk9">ex`.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newDirection</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">directionLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hlc3</span><span class="mtk13">[</span><span class="mtk33">length</span><span class="mtk13">]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hlc3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;slope&nbsp;of&nbsp;the&nbsp;`directionLine`.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">slope</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">directionLine</span><span class="mtk1">.</span><span class="mtk15">get_y2</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">directionLine</span><span class="mtk1">.</span><span class="mtk15">get_y1</span><span class="mtk13">())</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">directionLine</span><span class="mtk1">.</span><span class="mtk15">get_x2</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">directionLine</span><span class="mtk1">.</span><span class="mtk15">get_x1</span><span class="mtk13">())</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;value&nbsp;extrapolated&nbsp;from&nbsp;the&nbsp;`directionLine`&nbsp;a</span><span class="mtk9">t&nbsp;the&nbsp;`bar_index`.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.get_price</span><span class="mtk13">(</span><span class="mtk33">directionLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`color.green`&nbsp;when&nbsp;the&nbsp;`slope`&nbsp;is&nbsp;positive,&nbsp;`c</span><span class="mtk9">olor.red`&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">slopeColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">slope</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.green</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;color&nbsp;of&nbsp;the&nbsp;`directionLine`.</span></span><br><span><span class="mtk33">directionLine</span><span class="mtk1">.</span><span class="mtk15">set_color</span><span class="mtk13">(</span><span class="mtk33">slopeColor</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;`lineValue`.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">lineValue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Extrapolated&nbsp;value"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">slopeColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">plot.style_circles</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This example calls the second overload of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
function, which uses <code dir="auto">x1</code>, <code dir="auto">y1</code>, <code dir="auto">x2</code>, and <code dir="auto">y2</code> parameters to
define the start and end points of the line. The <code dir="auto">x1</code> value is
<code dir="auto">length</code> bars behind the current
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_bar_index">bar_index</a>,
and the <code dir="auto">y1</code> value is the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_hlc3">hlc3</a>
value at that index. The <code dir="auto">x2</code> and <code dir="auto">y2</code> in the function call use
the current bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_bar_index">bar_index</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_hlc3">hlc3</a>
values.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.get_price">line.get_price()</a>
function call treats the <code dir="auto">directionLine</code> as though it extends
infinitely, regardless of its <code dir="auto">extend</code> property.</li>
<li>The script only displays approximately the last 50 lines on the
chart, but the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_plot">plot</a>
of extrapolated values spans throughout the chart’s history.</li>
</ul>
<h3 id="cloning-lines" class="md-heading"><a href="#cloning-lines">Cloning <span class="fancy-wrap">lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Scripts can clone a line <code dir="auto">id</code> and all its properties with the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.copy">line.copy()</a>
function. Any changes to the copied line instance do not affect the
original.</p>
<p>For example, this script creates a horizontal line at the the bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_open">open</a>
price once every <code dir="auto">length</code> bars, which it assigns to a <code dir="auto">mainLine</code>
variable. On all other bars, it creates a <code dir="auto">copiedLine</code> using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.copy">line.copy()</a>
and calls <code dir="auto">line.set_*()</code> functions to
<a href="/pine-script-docs/visuals/lines-and-boxes/#modifying-lines">modify</a> its properties. As we see below, altering the <code dir="auto">copiedLine</code>
does not affect the <code dir="auto">mainLine</code> in any way:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Cloning-lines-1.C-hcIuCO_ZfTxYF.webp" alt="image" width="1330" height="584" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="5ov"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Cloning&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_lines_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;between&nbsp;each&nbsp;new&nbsp;mainLine&nbsp;assi</span><span class="mtk9">gnment.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;first&nbsp;`chart.point`&nbsp;used&nbsp;by&nbsp;the&nbsp;`mainLine`.&nbsp;C</span><span class="mtk9">ontains&nbsp;`index`&nbsp;and&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;second&nbsp;`chart.point`&nbsp;used&nbsp;by&nbsp;the&nbsp;`mainLine`.&nbsp;</span><span class="mtk9">Does&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;horizontal&nbsp;line&nbsp;drawn&nbsp;at&nbsp;the&nbsp;`open`&nbsp;price&nbsp;once&nbsp;</span><span class="mtk9">every&nbsp;`length`&nbsp;bars.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">mainLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;line&nbsp;to&nbsp;the&nbsp;`mainLine`&nbsp;that&nbsp;connec</span><span class="mtk9">ts&nbsp;the&nbsp;`firstPoint`&nbsp;to&nbsp;the&nbsp;`secondPoint`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;This&nbsp;line&nbsp;uses&nbsp;the&nbsp;`index`&nbsp;fields&nbsp;from&nbsp;both&nbsp;poi</span><span class="mtk9">nts&nbsp;as&nbsp;x-coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">mainLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;copy&nbsp;of&nbsp;the&nbsp;`mainLine`.&nbsp;Changes&nbsp;to&nbsp;this&nbsp;line&nbsp;do</span><span class="mtk9">&nbsp;not&nbsp;affect&nbsp;the&nbsp;original.</span></span><br><span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">copiedLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.copy</span><span class="mtk13">(</span><span class="mtk33">mainLine</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;color,&nbsp;style,&nbsp;and&nbsp;second&nbsp;point&nbsp;of&nbsp;th</span><span class="mtk9">e&nbsp;`copiedLine`.</span></span><br><span><span class="mtk16">line.set_color</span><span class="mtk13">(</span><span class="mtk33">copiedLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk13">)</span></span><br><span><span class="mtk16">line.set_style</span><span class="mtk13">(</span><span class="mtk33">copiedLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">line.style_dotted</span><span class="mtk13">)</span></span><br><span><span class="mtk16">line.set_second_point</span><span class="mtk13">(</span><span class="mtk33">copiedLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">))</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <code dir="auto">index</code> field of the <code dir="auto">secondPoint</code> is <code dir="auto">length</code> bars beyond
the current
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_bar_index">bar_index</a>.
Since the maximum x-coordinate allowed with
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
is <code dir="auto">bar_index + 500</code>, we’ve set the <code dir="auto">maxval</code> of the <code dir="auto">length</code>
input to 500.</li>
</ul>
<h3 id="deleting-lines" class="md-heading"><a href="#deleting-lines">Deleting <span class="fancy-wrap">lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>To delete a line drawn by a script, use the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.delete">line.delete()</a>
function. This function removes the line instance from the script and
its drawing on the chart.</p>
<p>Deleting line instances is often handy when one wants to only keep a
specific number of lines on the chart at any given time or conditionally
remove drawings as a chart progresses.</p>
<p>For example, this script creates a horizontal line with the <code dir="auto">extend</code> property set to <a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.right">extend.right</a> whenever an RSI crosses its EMA.</p>
<p>The script stores all line IDs in a <code dir="auto">lines</code> array that it
<a href="/pine-script-docs/language/arrays/#using-an-array-as-a-queue">uses as a queue</a> to display only a specified number of lines on the chart. When
the size of the <a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a> exceeds the specified <code dir="auto">numberOfLines</code> value, the script removes the array’s
oldest line ID using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.shift">array.shift()</a>
and deletes it with
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.delete">line.delete()</a>:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Lines-Deleting-lines-1.BO7dBacB_Z1bhgfD.webp" alt="image" width="1280" height="562" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="2vq"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;lines&nbsp;allowed&nbsp;on&nbsp;the&nbsp;chart.</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_LINES_COUNT</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span></span><br><span><span></span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Deleting&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"RSI&nbsp;cross&nbsp;levels"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_lines_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_LINES_COUNT</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;length&nbsp;of&nbsp;the&nbsp;RSI.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiLength</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">14</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"RSI&nbsp;length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;length&nbsp;of&nbsp;the&nbsp;RSI's&nbsp;EMA.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">emaLength</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">28</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"RSI&nbsp;average&nbsp;length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;lines&nbsp;to&nbsp;keep&nbsp;on&nbsp;the&nbsp;chart.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfLines</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Lines&nbsp;on&nbsp;the&nbsp;chart"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_LINES_COUNT</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;containing&nbsp;the&nbsp;IDs&nbsp;of&nbsp;lines&nbsp;on&nbsp;the&nbsp;chart</span><span class="mtk9">.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">array</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">line</span><span class="mtk13">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">lines</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">line</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;`rsiLength`&nbsp;RSI&nbsp;of&nbsp;`close`.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsi</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.rsi</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiLength</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`maLength`&nbsp;EMA&nbsp;of&nbsp;the&nbsp;`rsi`.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiMA</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.ema</span><span class="mtk13">(</span><span class="mtk33">rsi</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">emaLength</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.cross</span><span class="mtk13">(</span><span class="mtk33">rsi</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiMA</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;color&nbsp;of&nbsp;the&nbsp;horizontal&nbsp;line.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsi</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiMA</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.green</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;horizontal&nbsp;line.&nbsp;Uses&nbsp;the&nbsp;default&nbsp;`x</span><span class="mtk9">loc.bar_index`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">newLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiMA</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">rsiMA</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">extend</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">extend.right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;the&nbsp;`newLine`&nbsp;into&nbsp;the&nbsp;`lines`&nbsp;array.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lines</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk33">newLine</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Delete&nbsp;the&nbsp;oldest&nbsp;line&nbsp;when&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;arr</span><span class="mtk9">ay&nbsp;exceeds&nbsp;the&nbsp;specified&nbsp;`numberOfLines`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.size</span><span class="mtk13">(</span><span class="mtk33">lines</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfLines</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.delete</span><span class="mtk13">(</span><span class="mtk33">lines</span><span class="mtk1">.</span><span class="mtk15">shift</span><span class="mtk13">())</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Plot&nbsp;the&nbsp;`rsi`&nbsp;and&nbsp;`rsiMA`.</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">rsi</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"RSI"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">40</span><span class="mtk13">))</span></span><br><span><span class="mtk16">plot</span><span class="mtk13">(</span><span class="mtk33">rsiMA</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"EMA&nbsp;of&nbsp;RSI"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.gray</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">30</span><span class="mtk13">))</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>We declared a <code dir="auto">MAX_LINES_COUNT</code> variable with the “const int”
<em>qualified type</em>, which the script uses as the <code dir="auto">max_lines_count</code>
in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function and the <code dir="auto">maxval</code> of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_input.int">input.int()</a>
assigned to the <code dir="auto">numberOfLines</code> variable.</li>
<li>This example uses the second overload of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
function, which specifies <code dir="auto">x1</code>, <code dir="auto">y1</code>, <code dir="auto">x2</code>, and <code dir="auto">y2</code> coordinates
independently.</li>
</ul>
<h3 id="filling-the-space-between-lines" class="md-heading"><a href="#filling-the-space-between-lines">Filling the space between <span class="fancy-wrap">lines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Scripts can <em>fill</em> the space between two
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
drawings by creating a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_linefill">linefill</a>
object that references them with the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_linefill.new">linefill.new()</a>
function. Linefills automatically determine their fill boundaries using
the properties from the <code dir="auto">line1</code> and <code dir="auto">line2</code> IDs that they reference.</p>
<p>For example, this script calculates a simple linear regression channel.
On the first chart bar, the script declares the <code dir="auto">basisLine</code>,
<code dir="auto">upperLine</code>, and <code dir="auto">lowerLine</code> variables to reference the channel’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
IDs, then it makes two
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_linefill.new">linefill.new()</a>
calls to create
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_linefill">linefill</a>
objects that fill the upper and lower portions of the channel. The first
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_linefill">linefill</a>
fills the space between the <code dir="auto">basisLine</code> and the <code dir="auto">upperLine</code>, and the
second fills the space between the <code dir="auto">basisLine</code> and <code dir="auto">lowerLine</code>.</p>
<p>The script updates the coordinates of the lines across subsequent bars.
However, notice that the script never needs to update the linefills
declared on the first bar. They automatically update their fill regions
based on the coordinates of their assigned lines:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Filling-the-space-between-lines-1.BXRTQC1Z_ZJxot8.webp" alt="image" width="1342" height="558" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="672"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Filling&nbsp;the&nbsp;space&nbsp;between&nbsp;lines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Simple&nbsp;linreg&nbsp;channel"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;in&nbsp;the&nbsp;linear&nbsp;regression&nbsp;calcu</span><span class="mtk9">lation.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">100</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;basis&nbsp;line&nbsp;of&nbsp;the&nbsp;regression&nbsp;channel.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">basisLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">extend</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">extend.right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">chart.fg_color</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;channel's&nbsp;upper&nbsp;line.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">upperLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">extend</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">extend.right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;channel's&nbsp;lower&nbsp;line.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">line</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowerLine</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">extend</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">extend.right</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;linefill&nbsp;instance&nbsp;that&nbsp;fills&nbsp;the&nbsp;space&nbsp;between&nbsp;</span><span class="mtk9">the&nbsp;`basisLine`&nbsp;and&nbsp;`upperLine`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">linefill</span><span class="mtk1">&nbsp;</span><span class="mtk33">upperFill</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">linefill.new</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">upperLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">))</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;linefill&nbsp;instance&nbsp;that&nbsp;fills&nbsp;the&nbsp;space&nbsp;between&nbsp;</span><span class="mtk9">the&nbsp;`basisLine`&nbsp;and&nbsp;`lowerLine`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">linefill</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowerFill</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">linefill.new</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowerLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">80</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;`basisLine`&nbsp;coordinates&nbsp;with&nbsp;current</span><span class="mtk9">&nbsp;linear&nbsp;regression&nbsp;values.</span></span><br><span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">set_xy1</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.linreg</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">))</span></span><br><span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">set_xy2</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.linreg</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;channel's&nbsp;standard&nbsp;deviation.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">stDev</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.0</span></span><br><span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">to</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">stDev</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.pow</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">[</span><span class="mtk33">i</span><span class="mtk13">]</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk16">line.get_price</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk33">stDev</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.sqrt</span><span class="mtk13">(</span><span class="mtk33">stDev</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">lengthInput</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk12">2.0</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;`upperLine`&nbsp;and&nbsp;`lowerLine`&nbsp;using&nbsp;th</span><span class="mtk9">e&nbsp;values&nbsp;from&nbsp;the&nbsp;`basisLine`&nbsp;and&nbsp;the&nbsp;`stDev`.</span></span><br><span><span class="mtk33">upperLine</span><span class="mtk1">.</span><span class="mtk15">set_xy1</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_x1</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_y1</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">stDev</span><span class="mtk13">)</span></span><br><span><span class="mtk33">upperLine</span><span class="mtk1">.</span><span class="mtk15">set_xy2</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_x2</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_y2</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">stDev</span><span class="mtk13">)</span></span><br><span><span class="mtk33">lowerLine</span><span class="mtk1">.</span><span class="mtk15">set_xy1</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_x1</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_y1</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">stDev</span><span class="mtk13">)</span></span><br><span><span class="mtk33">lowerLine</span><span class="mtk1">.</span><span class="mtk15">set_xy2</span><span class="mtk13">(</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_x2</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">basisLine</span><span class="mtk1">.</span><span class="mtk15">get_y2</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">stDev</span><span class="mtk13">)</span></span><br></code></div>
<p>To learn more about the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_linefill">linefill</a>
type, see <a href="/pine-script-docs/visuals/fills/#line-fills">this</a>
section of the <a href="/pine-script-docs/visuals/fills/">Fills</a> page.</p>
<h2 id="boxes" class="md-heading"><a href="#boxes"> <span class="fancy-wrap">Boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>The built-ins in the <code dir="auto">box.*</code> namespace create and manage
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>
objects:</p>
<ul>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
function creates a new box.</li>
<li>The <code dir="auto">box.set_*()</code> functions modify box properties.</li>
<li>The <code dir="auto">box.get_*()</code> functions retrieve values from a box instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.copy">box.copy()</a>
function clones a box instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.delete">box.delete()</a>
function deletes a box instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_box.all">box.all</a>
variable references a read-only
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
containing the IDs of all boxes displayed by the script. The
array’s size depends on the <code dir="auto">max_boxes_count</code> of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_strategy">strategy()</a>
declaration statement and the number of boxes the script has drawn.</li>
</ul>
<p>As with <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>,
users can call <code dir="auto">box.set_*()</code>, <code dir="auto">box.get_*()</code>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.copy">box.copy()</a>,
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.delete">box.delete()</a>
built-ins as functions or <a href="/pine-script-docs/language/methods/">methods</a>.</p>
<h3 id="creating-boxes" class="md-heading"><a href="#creating-boxes">Creating <span class="fancy-wrap">boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
function creates a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>
object to display on the chart. It has the following signatures:</p>
<div class="expressive-code not-content"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text" tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">box.new(top_left, bottom_right, border_color, border_width, border_style, extend, xloc, bgcolor, text, text_size, text_color, text_halign, text_valign, text_wrap, text_font_family, force_overlay, text_formatting) → series box</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">box.new(left, top, right, bottom, border_color, border_width, border_style, extend, xloc, bgcolor, text, text_size, text_color, text_halign, text_valign, text_wrap, text_font_family, force_overlay, text_formatting) → series box</span></div></div></code></pre></figure></div>
<p>This function’s first overload includes the <code dir="auto">top_left</code> and
<code dir="auto">bottom_right</code> parameters, which accept
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects representing the top-left and bottom-right corners of the box,
respectively. The function copies the information from these
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> to set the coordinates of the box’s corners. Whether it
uses the <code dir="auto">index</code> or <code dir="auto">time</code> fields of the <code dir="auto">top_left</code> and <code dir="auto">bottom_right</code>
points as x-coordinates depends on the function’s <code dir="auto">xloc</code> value.</p>
<p>The second overload specifies <code dir="auto">left</code>, <code dir="auto">top</code>, <code dir="auto">right</code>, and <code dir="auto">bottom</code> edges
of the box. The <code dir="auto">left</code> and <code dir="auto">right</code> parameters accept
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_int">int</a>
values specifying the box’s left and right x-coordinates, which can be
bar index or time values depending on the <code dir="auto">xloc</code> value in the function
call. The <code dir="auto">top</code> and <code dir="auto">bottom</code> parameters accept
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_float">float</a>
values representing the box’s top and bottom y-coordinates.</p>
<p>The function’s additional parameters are identical in both overloads:</p>
<p><code dir="auto">border_color</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the color of all four of the box’s borders. The default
is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_color.blue">color.blue</a>.</p>
<p><code dir="auto">border_width</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the width of the borders, in pixels. Its default value is
1.</p>
<p><code dir="auto">border_style</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the style of the borders, which can be any of the options
in the
<a href="/pine-script-docs/visuals/lines-and-boxes/#box-styles">Box styles</a> section of this page.</p>
<p><code dir="auto">extend</code></p>
<p class="spacer-wrapper"><spacer></spacer>Determines whether the box’s borders extend infinitely beyond the
left or right x-coordinates. It accepts one of the following values:
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.left">extend.left</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.right">extend.right</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.both">extend.both</a>,
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_extend.none">extend.none</a>
(default).</p>
<p><code dir="auto">xloc</code></p>
<p class="spacer-wrapper"><spacer></spacer>Determines whether the left and right edges of the box use bar index
or time values as x-coordinates. The default is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>.</p>
<p class="spacer-wrapper"><spacer></spacer>In the first overload, an <code dir="auto">xloc</code> value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
means that the function will use the <code dir="auto">index</code> fields of the
<code dir="auto">top_left</code> and <code dir="auto">bottom_right</code> chart points, and an <code dir="auto">xloc</code> value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>
means that it will use their <code dir="auto">time</code> fields.</p>
<p class="spacer-wrapper"><spacer></spacer>In the second overload, using an <code dir="auto">xloc</code> value of
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>
means the function treats the <code dir="auto">left</code> and <code dir="auto">right</code> values as bar
indices, and
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>
means it will treat them as timestamps.</p>
<p class="spacer-wrapper"><spacer></spacer>When the specified x-coordinates represent <em>bar index</em> values, it’s
important to note that the minimum x-coordinate allowed is
<code dir="auto">bar_index - 10000</code>. For larger offsets, one can use
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>.</p>
<p><code dir="auto">bgcolor</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the background color of the space inside the box. The
default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_color.blue">color.blue</a>.</p>
<p><code dir="auto">text</code></p>
<p class="spacer-wrapper"><spacer></spacer>The text to display inside the box. By default, its value is an
empty string.</p>
<p><code dir="auto">text_size</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the size of the text within the box. It accepts both “int” size values and “string” <code dir="auto">size.*</code> constants. The “int” size can be any positive integer. The <code dir="auto">size.*</code> constants and their equivalent “int” sizes are:
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.auto">size.auto</a> (0),
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.tiny">size.tiny</a> (8),
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.small">size.small</a> (10),
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.normal">size.normal</a> (14),
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.large">size.large</a> (20),
and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.huge">size.huge</a> (36).
The default value is <a href="https://www.tradingview.com/pine-script-reference/v6/#var_size.auto">size.auto</a>.</p>
<p><code dir="auto">text_color</code></p>
<p class="spacer-wrapper"><spacer></spacer>Controls the color of the text. Its default is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_color.black">color.black</a>.</p>
<p><code dir="auto">text_halign</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the horizontal alignment of the text within the box’s
boundaries. It accepts one of the following:
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_left">text.align_left</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_right">text.align_right</a>,
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_center">text.align_center</a>
(default).</p>
<p><code dir="auto">text_valign</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the vertical alignment of the text within the box’s
boundaries. It accepts one of the following:
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_top">text.align_top</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_bottom">text.align_bottom</a>,
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.align_center">text.align_center</a>
(default).</p>
<p><code dir="auto">text_wrap</code></p>
<p class="spacer-wrapper"><spacer></spacer>Determines whether the box will wrap the text within it. If its
value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.wrap_auto">text.wrap_auto</a>,
the box wraps the text to ensure it does not span past its vertical
borders. It also clips the wrapped text when it extends past the
bottom. If the value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.wrap_none">text.wrap_none</a>,
the box displays the text on a single line that can extend beyond
its borders. The default is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_text.wrap_none">text.wrap_none</a>.</p>
<p><code dir="auto">text_font_family</code></p>
<p class="spacer-wrapper"><spacer></spacer>Defines the font family of the box’s text. Using
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_font.family_default">font.family_default</a>
displays the box’s text with the system’s default font. The
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_font.family_monospace">font.family_monospace</a>
displays the text in a monospace format. The default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_font.family_default">font.family_default</a>.</p>
<p><code dir="auto">force_overlay</code></p>
<p class="spacer-wrapper"><spacer></spacer>If <code dir="auto">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir="auto">false</code>.</p>
<p><code dir="auto">text_formatting</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the formatting of the box’s text. Using <a href="https://www.tradingview.com/pine-script-reference/v6/#const_text.format_none">text.format_none</a> displays the text with no special formatting. This parameter also accepts the arguments <a href="https://www.tradingview.com/pine-script-reference/v6/#const_text.format_bold">text.format_bold</a> or <a href="https://www.tradingview.com/pine-script-reference/v6/#const_text.format_italic">text.format_italic</a>. Using <code dir="auto">text.format_bold + text.format_italic</code> applies both formats together to display text that is both bold and italicized. The default value is <a href="https://www.tradingview.com/pine-script-reference/v6/#const_text.format_none">text.format_none</a>.</p>
<p>Let’s write a simple script to display boxes on a chart. The example
below draws a box projecting each bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_high">high</a>
and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_low">low</a>
values from the horizontal center of the current bar to the center of
the next available bar.</p>
<p>On each bar, the script creates <code dir="auto">topLeft</code> and <code dir="auto">bottomRight</code> points via
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.now">chart.point.now()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.from_index">chart.point.from_index()</a>,
then calls
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
to construct a new box and display it on the chart. It also highlights
the background on the unconfirmed chart bar using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_bgcolor">bgcolor()</a>
to indicate that it redraws that box until the bar’s last update:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Boxes-Creating-boxes-1.BfHkiDpJ_2qyzFB.webp" alt="image" width="1334" height="608" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="1ks"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Creating&nbsp;boxes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;top-left&nbsp;corner&nbsp;of&nbsp;the&nbsp;</span><span class="mtk9">box.&nbsp;Contains&nbsp;`index`&nbsp;and&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">topLeft</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;bottom-right&nbsp;corner&nbsp;of&nbsp;</span><span class="mtk9">the&nbsp;box.&nbsp;Does&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">bottomRight</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;box&nbsp;using&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;`bottomRight</span><span class="mtk9">`&nbsp;corner&nbsp;points.&nbsp;Uses&nbsp;the&nbsp;`index`&nbsp;fields&nbsp;as&nbsp;x-coor</span><span class="mtk9">dinates.</span></span><br><span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.gray</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;the&nbsp;background&nbsp;on&nbsp;the&nbsp;unconfirmed&nbsp;bar.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk11">barstate.isconfirmed</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Unconfirmed&nbsp;bar&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The <code dir="auto">bottomRight</code> point’s <code dir="auto">index</code> field is one bar greater than
the <code dir="auto">index</code> in the <code dir="auto">topLeft</code>. If the x-coordinates of the
corners were equal, the script would draw a vertical line at the
horizontal center of each bar, resembling the example in this
page’s
<a href="/pine-script-docs/visuals/lines-and-boxes/#creating-lines">Creating lines</a> section.</li>
<li>Similar to <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>, if the <code dir="auto">topLeft</code> and <code dir="auto">bottomRight</code> contained
identical coordinates, the box wouldn’t display on the chart
since there would be no space between them to draw. However, its
ID would still exist.</li>
<li>This script only displays approximately the last 50 boxes on the
chart, as we have not specified a <code dir="auto">max_boxes_count</code> in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call.</li>
</ul>
<h3 id="modifying-boxes" class="md-heading"><a href="#modifying-boxes">Modifying <span class="fancy-wrap">boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Multiple <em>setter</em> functions exist in the <code dir="auto">box.*</code> namespace, allowing
scripts to modify the properties of
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>
objects:</p>
<ul>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_top_left_point">box.set_top_left_point()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_bottom_right_point">box.set_bottom_right_point()</a>
respectively update the top-left and bottom-right coordinates of the
<code dir="auto">id</code> box using information from the specified <code dir="auto">point</code>.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_left">box.set_left()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_right">box.set_right()</a>
set the left or right x-coordinate of the <code dir="auto">id</code> box to a new
<code dir="auto">left/right</code> value, which can be a bar index or time value depending
on the box’s <code dir="auto">xloc</code> property.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_top">box.set_top()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_bottom">box.set_bottom()</a>
set the top or bottom y-coordinate of the <code dir="auto">id</code> box to a new
<code dir="auto">top/bottom</code> value.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_lefttop">box.set_lefttop()</a>
sets the <code dir="auto">left</code> and <code dir="auto">top</code> coordinates of the <code dir="auto">id</code> box, and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_rightbottom">box.set_rightbottom()</a>
sets its <code dir="auto">right</code> and <code dir="auto">bottom</code> coordinates.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_xloc">box.set_xloc()</a> sets the <code dir="auto">xloc</code> property of the <code dir="auto">id</code> box and updates its x-coordinates to new <code dir="auto">left</code> and <code dir="auto">right</code> values, which represent bar index or time values accordingly.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_border_color">box.set_border_color()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_border_width">box.set_border_width()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_border_style">box.set_border_style()</a>
respectively update the <code dir="auto">color</code>, <code dir="auto">width</code>, and <code dir="auto">style</code> of the <code dir="auto">id</code>
box’s border.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_extend">box.set_extend()</a>
sets the horizontal <code dir="auto">extend</code> property of the <code dir="auto">id</code> box.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_bgcolor">box.set_bgcolor()</a>
sets the color of the space inside the <code dir="auto">id</code> box to a new <code dir="auto">color</code>.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text">box.set_text()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_size">box.set_text_size()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_color">box.set_text_color()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_halign">box.set_text_halign()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_valign">box.set_text_valign()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_wrap">box.set_text_wrap()</a>,
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_font_family">box.set_text_font_family()</a>,
and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_text_formatting">box.set_text_formatting()</a>
update the <code dir="auto">id</code> box’s text-related properties.</li>
</ul>
<p>As with setter functions in the <code dir="auto">line.*</code> namespace, all box setters
modify the <code dir="auto">id</code> box directly without returning a value, and each setter
function accepts “series” arguments.</p>
<p>This example uses boxes to visualize the ranges of upward and downward
bars with the highest
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_volume">volume</a>
over a user-defined <code dir="auto">timeframe</code>. When the script detects a new bar on the specified timeframe with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_timeframe.change">timeframe.change()</a>, it assigns new boxes to the <code dir="auto">upBox</code> and <code dir="auto">downBox</code> variables, resets the <code dir="auto">upVolume</code> and
<code dir="auto">downVolume</code> values, and highlights the chart background.</p>
<p>When an upward or downward bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_volume">volume</a>
exceeds the <code dir="auto">upVolume</code> or <code dir="auto">downVolume</code>, the script updates the
volume-tracking variables and calls
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_top_left_point">box.set_top_left_point()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_bottom_right_point">box.set_bottom_right_point()</a>
to update the <code dir="auto">upBox</code> or <code dir="auto">downBox</code> coordinates. The setters use the
information from the
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> created with
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.now">chart.point.now()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.from_time">chart.point.from_time()</a>
to project that bar’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_high">high</a>
and <a href="https://www.tradingview.com/pine-script-reference/v6/#var_low">low</a>
values from the current time to the closing time of the specified timeframe:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Boxes-Modifying-boxes-1.Bj141v5c_297ln.webp" alt="image" width="1330" height="604" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="4sa"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Modifying&nbsp;boxes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"High&nbsp;volume&nbsp;boxes"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_boxes_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;timeframe&nbsp;of&nbsp;the&nbsp;calculation.</span></span><br><span><span class="mtk18 mtkb">string</span><span class="mtk1">&nbsp;</span><span class="mtk33">timeframe</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.timeframe</span><span class="mtk13">(</span><span class="mtk29">"D"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Timeframe"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;box&nbsp;projecting&nbsp;the&nbsp;range&nbsp;of&nbsp;the&nbsp;upward&nbsp;bar&nbsp;with</span><span class="mtk9">&nbsp;the&nbsp;highest&nbsp;`volume`&nbsp;over&nbsp;the&nbsp;`timeframe`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">upBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;box&nbsp;projecting&nbsp;the&nbsp;range&nbsp;of&nbsp;the&nbsp;downward&nbsp;bar&nbsp;wi</span><span class="mtk9">th&nbsp;the&nbsp;lowest&nbsp;`volume`&nbsp;over&nbsp;the&nbsp;`timeframe`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">downBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;highest&nbsp;volume&nbsp;of&nbsp;upward&nbsp;bars&nbsp;over&nbsp;the&nbsp;`timef</span><span class="mtk9">rame`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">upVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;highest&nbsp;volume&nbsp;of&nbsp;downward&nbsp;bars&nbsp;over&nbsp;the&nbsp;`tim</span><span class="mtk9">eframe`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">downVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Color&nbsp;variables.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">upBorder</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">upFill</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.teal</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">90</span><span class="mtk13">)</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">downBorder</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">downFill</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.maroon</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">90</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;closing&nbsp;time&nbsp;of&nbsp;the&nbsp;`timeframe`.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">closeTime</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">time_close</span><span class="mtk13">(</span><span class="mtk33">timeframe</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;when&nbsp;a&nbsp;new&nbsp;bar&nbsp;starts&nbsp;on&nbsp;the&nbsp;`timeframe</span><span class="mtk9">`.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">changeTF</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">timeframe.change</span><span class="mtk13">(</span><span class="mtk33">timeframe</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;top-left&nbsp;corner&nbsp;of&nbsp;the&nbsp;</span><span class="mtk9">boxes.&nbsp;Contains&nbsp;`index`&nbsp;and&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">topLeft</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;bottom-right&nbsp;corner&nbsp;of&nbsp;</span><span class="mtk9">the&nbsp;boxes.&nbsp;Does&nbsp;not&nbsp;contain&nbsp;`index`&nbsp;information.</span></span><br><span><span class="mtk33">bottomRight</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_time</span><span class="mtk13">(</span><span class="mtk33">closeTime</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">changeTF</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk16">na</span><span class="mtk13">(</span><span class="mtk11">volume</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;`upVolume`&nbsp;and&nbsp;`downVolume`&nbsp;values.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">upVolume</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">downVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`upBox`&nbsp;using&nbsp;`time`&nbsp;and&nbsp;`price`&nbsp;inf</span><span class="mtk9">o&nbsp;from&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;`bottomRight`&nbsp;points.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">upBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">upBorder</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">upFill</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`downBox`&nbsp;with&nbsp;`na`&nbsp;coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">downBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">downBorder</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">downFill</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">else</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;`upVolume`&nbsp;and&nbsp;`downVolume`&nbsp;values.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">upVolume</span><span class="mtk1">&nbsp;&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">downVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`upBox`&nbsp;with&nbsp;`na`&nbsp;coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">upBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">upBorder</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">upFill</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`downBox`&nbsp;using&nbsp;`time`&nbsp;and&nbsp;`price`&nbsp;i</span><span class="mtk9">nfo&nbsp;from&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;`bottomRight`&nbsp;points.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">downBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">downBorder</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">downFill</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;``upVolume``&nbsp;and&nbsp;change&nbsp;the&nbsp;``upBox`</span><span class="mtk9">`&nbsp;coordinates&nbsp;when&nbsp;volume&nbsp;increases&nbsp;on&nbsp;an&nbsp;upward&nbsp;b</span><span class="mtk9">ar.</span></span><br><span><span class="mtk18">else</span><span class="mtk1">&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">upVolume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">upVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_top_left_point</span><span class="mtk13">(</span><span class="mtk33">upBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">topLeft</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_bottom_right_point</span><span class="mtk13">(</span><span class="mtk33">upBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;``downVolume``&nbsp;and&nbsp;change&nbsp;the&nbsp;``down</span><span class="mtk9">Box``&nbsp;coordinates&nbsp;when&nbsp;volume&nbsp;increases&nbsp;on&nbsp;a&nbsp;downw</span><span class="mtk9">ard&nbsp;bar.</span></span><br><span><span class="mtk18">else</span><span class="mtk1">&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;=</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">downVolume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">downVolume</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_top_left_point</span><span class="mtk13">(</span><span class="mtk33">downBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">topLeft</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_bottom_right_point</span><span class="mtk13">(</span><span class="mtk33">downBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;a&nbsp;new&nbsp;`timeframe`</span><span class="mtk9">&nbsp;bar&nbsp;starts.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">changeTF</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Timeframe&nbsp;change&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call contains <code dir="auto">max_boxes_count = 100</code>, meaning the
script will preserve the last 100 boxes on the chart.</li>
<li>We utilized <em>both overloads</em> of
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
in this example. On the first bar of the <code dir="auto">timeframe</code>, the script
calls the first overload for the <code dir="auto">upBox</code> when the bar is rising,
and it calls that overload for the <code dir="auto">downBox</code> when the bar is
falling. It uses the second overload to assign a new box with
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>
values to the other box variable on that bar.</li>
</ul>
<h3 id="box-styles" class="md-heading"><a href="#box-styles">Box <span class="fancy-wrap">styles<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Users can include one of the following <code dir="auto">line.style_*</code> variables in their
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.set_border_style">box.set_border_style()</a>
function calls to set the border styles of boxes drawn by their scripts:</p>
<hr>





















<table><thead><tr><th>Argument</th><th>Box</th></tr></thead><tbody><tr><td><code dir="auto">line.style_solid</code></td><td><img src="/pine-script-docs/_astro/box.style_solid.DpZnFQGZ_2oQNCW.webp" alt="box_style_solid" width="125" height="88" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_dotted</code></td><td><img src="/pine-script-docs/_astro/box.style_dotted.DQk4-fDM_Z23lye8.webp" alt="box_style_dotted" width="125" height="88" loading="lazy" decoding="async"></td></tr><tr><td><code dir="auto">line.style_dashed</code></td><td><img src="/pine-script-docs/_astro/box.style_dashed.BezJLOhC_Z1FMPte.webp" alt="box_style_dashed" width="125" height="88" loading="lazy" decoding="async"></td></tr></tbody></table>
<h3 id="reading-box-values" class="md-heading"><a href="#reading-box-values">Reading box <span class="fancy-wrap">values<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The <code dir="auto">box.*</code> namespace features <em>getter</em> functions that allow scripts to
retrieve coordinate values from a box instance:</p>
<ul>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_left">box.get_left()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_right">box.get_right()</a>
respectively get the x-coordinates of the left and right edges of
the <code dir="auto">id</code> box. Whether the value returned represents a bar index or
time value depends on the box’s <code dir="auto">xloc</code> property.</li>
<li><a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_top">box.get_top()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_bottom">box.get_bottom()</a>
respectively get the top and bottom y-coordinates of the <code dir="auto">id</code> box.</li>
</ul>
<p>The example below draws boxes to visualize hypothetical price ranges
over a period of <code dir="auto">length</code> bars. At the start of each new period, it uses
the average candle range multiplied by the <code dir="auto">scaleFactor</code> input to
calculate the corner points of a box centered at the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_hl2">hl2</a>
price with an <code dir="auto">initialRange</code> height. After drawing the first box, it
creates <code dir="auto">numberOfBoxes - 1</code> new boxes inside a
<a href="https://www.tradingview.com/pine-script-reference/v6/#kw_for">for</a>
loop.</p>
<p>Within each loop iteration, the script gets the <code dir="auto">lastBoxDrawn</code> reference by retrieving the last element from the read-only <a href="https://www.tradingview.com/pine-script-reference/v6/#var_box.all">box.all</a> array, then calls <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_top">box.get_top()</a> and <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_bottom">box.get_bottom()</a> to get the y-coordinates of the referenced box. It uses these values to calculate the coordinates for a new box that’s <code dir="auto">scaleFactor</code> times taller than the previous:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Boxes-Reading-box-values-1.BjHiyYzc_1hj7GF.webp" alt="image" width="1332" height="608" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="382"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Reading&nbsp;box&nbsp;values&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Nested&nbsp;boxes"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_boxes_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;in&nbsp;the&nbsp;range&nbsp;calculation.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">10</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;nested&nbsp;boxes&nbsp;drawn&nbsp;on&nbsp;each&nbsp;period.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfBoxes</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">5</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Nested&nbsp;box&nbsp;count"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;scale&nbsp;factor&nbsp;applied&nbsp;to&nbsp;each&nbsp;box.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">scaleFactor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.float</span><span class="mtk13">(</span><span class="mtk12">1.6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Scale&nbsp;factor"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;initial&nbsp;box&nbsp;range.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">initialRange</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">scaleFactor</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.sma</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;top-left&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;initial&nbsp;box.&nbsp;D</span><span class="mtk9">oes&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">topLeft</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">initialRange</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;bottom-right&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;initial&nbsp;bo</span><span class="mtk9">x.&nbsp;Does&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">initialRange</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Calculate&nbsp;border&nbsp;and&nbsp;fill&nbsp;colors&nbsp;of&nbsp;the&nbsp;boxes.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">borderColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">100</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">255</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">100</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">255</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">bgColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk33">borderColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk12">100</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">/</span><span class="mtk33">numberOfBoxes</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">90</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;box&nbsp;using&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;`bottomR</span><span class="mtk9">ight`&nbsp;points.&nbsp;Uses&nbsp;their&nbsp;`index`&nbsp;fields&nbsp;as&nbsp;x-coord</span><span class="mtk9">inates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">borderColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgColor</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfBoxes</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Loop&nbsp;to&nbsp;create&nbsp;additional&nbsp;boxes.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">to</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfBoxes</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;last&nbsp;box&nbsp;drawn&nbsp;by&nbsp;the&nbsp;script.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastBoxDrawn</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">box.all</span><span class="mtk1">.</span><span class="mtk15">last</span><span class="mtk13">()</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;top&nbsp;price&nbsp;of&nbsp;the&nbsp;last&nbsp;box.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">top</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.get_top</span><span class="mtk13">(</span><span class="mtk33">lastBoxDrawn</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;bottom&nbsp;price&nbsp;of&nbsp;the&nbsp;last&nbsp;box.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottom</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.get_bottom</span><span class="mtk13">(</span><span class="mtk33">lastBoxDrawn</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;scaled&nbsp;range&nbsp;of&nbsp;the&nbsp;new&nbsp;box.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">newRange</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">scaleFactor</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk13">(</span><span class="mtk33">top</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottom</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.5</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Update&nbsp;the&nbsp;`price`&nbsp;fields&nbsp;of&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;</span><span class="mtk9">`bottomRight`&nbsp;points.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;This&nbsp;does&nbsp;not&nbsp;affect&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;previou</span><span class="mtk9">s&nbsp;boxes.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">topLeft</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">newRange</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">newRange</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;box&nbsp;using&nbsp;the&nbsp;updated&nbsp;`topLeft`&nbsp;and&nbsp;</span><span class="mtk9">`bottomRight`&nbsp;points.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">borderColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgColor</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call uses <code dir="auto">max_boxes_count = 500</code>, meaning the script
can display up to 500 boxes on the chart.</li>
<li>Each drawing has a <code dir="auto">right</code> index <code dir="auto">length</code> bars beyond the <code dir="auto">left</code>
index. Since the x-coordinates of these drawings can be up to
500 bars into the future, we’ve set the <code dir="auto">maxval</code> of the
<code dir="auto">length</code> input to 500.</li>
<li>On each new period, the script uses randomized
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_color.rgb">color.rgb()</a>
values for the <code dir="auto">border_color</code> and <code dir="auto">bgcolor</code> of the boxes.</li>
<li>Each
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
call copies the coordinates from the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects assigned to the <code dir="auto">topLeft</code> and <code dir="auto">bottomRight</code> variables,
which is why the script can modify their <code dir="auto">price</code> fields on each
loop iteration without affecting the other boxes.</li>
</ul>
<h3 id="cloning-boxes" class="md-heading"><a href="#cloning-boxes">Cloning <span class="fancy-wrap">boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>To clone a specific box <code dir="auto">id</code>, use
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.copy">box.copy()</a>.
This function copies the box and its properties. Any changes to the
copied box do not affect the original.</p>
<p>For example, this script declares an <code dir="auto">originalBox</code> variable on the first
bar and assigns a new box reference to it once every <code dir="auto">length</code> bars. On other bars, it uses
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.copy">box.copy()</a>
to create a copy of the box, assigns that copy to the <code dir="auto">copiedBox</code> variable, then calls <code dir="auto">box.set_*()</code> functions to
<a href="/pine-script-docs/visuals/lines-and-boxes/#modifying-boxes">modify</a> the copy’s properties. As shown on the chart below, changes to the copied box do not modify the box referenced by <code dir="auto">originalBox</code>:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Boxes-Cloning-boxes-1.C3LhZvV5_2sfgJn.webp" alt="image" width="1334" height="604" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="3pq"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Cloning&nbsp;boxes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_boxes_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;between&nbsp;each&nbsp;new&nbsp;mainLine&nbsp;assi</span><span class="mtk9">gnment.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;top-left&nbsp;of&nbsp;the&nbsp;`origin</span><span class="mtk9">alBox`.&nbsp;Contains&nbsp;`time`&nbsp;and&nbsp;`index`&nbsp;information.</span></span><br><span><span class="mtk33">topLeft</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;`chart.point`&nbsp;for&nbsp;the&nbsp;bottom-right&nbsp;of&nbsp;the&nbsp;`or</span><span class="mtk9">iginalBox`.&nbsp;Does&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;information.</span></span><br><span><span class="mtk33">bottomRight</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;box&nbsp;with&nbsp;`topLeft`&nbsp;and&nbsp;`bottomRight`&nbsp;corner</span><span class="mtk9">s&nbsp;on&nbsp;every&nbsp;`length`&nbsp;bars.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">originalBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;teal&nbsp;when&nbsp;the&nbsp;bar&nbsp;is&nbsp;rising,&nbsp;maroon&nbsp;when&nbsp;it's&nbsp;</span><span class="mtk9">falling.</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">originalColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk11">open</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;box&nbsp;using&nbsp;the&nbsp;`topLeft`&nbsp;and&nbsp;`botto</span><span class="mtk9">mRight`&nbsp;info&nbsp;to&nbsp;the&nbsp;`originalBox`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;This&nbsp;box&nbsp;uses&nbsp;the&nbsp;`index`&nbsp;fields&nbsp;from&nbsp;the&nbsp;point</span><span class="mtk9">s&nbsp;as&nbsp;x-coordinates.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">originalBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">topLeft</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">originalColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk33">originalColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">60</span><span class="mtk13">))</span></span><br><span><span class="mtk18">else</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;clone&nbsp;of&nbsp;the&nbsp;`originalBox`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">copiedBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">box.copy</span><span class="mtk13">(</span><span class="mtk33">originalBox</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Modify&nbsp;the&nbsp;`copiedBox`.&nbsp;These&nbsp;changes&nbsp;do&nbsp;not&nbsp;af</span><span class="mtk9">fect&nbsp;the&nbsp;`originalBox`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_top</span><span class="mtk13">(</span><span class="mtk33">copiedBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_bottom_right_point</span><span class="mtk13">(</span><span class="mtk33">copiedBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bottomRight</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_border_color</span><span class="mtk13">(</span><span class="mtk33">copiedBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.gray</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_border_width</span><span class="mtk13">(</span><span class="mtk33">copiedBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.set_bgcolor</span><span class="mtk13">(</span><span class="mtk33">copiedBox</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk13">)</span></span><br></code></div>
<h3 id="deleting-boxes" class="md-heading"><a href="#deleting-boxes">Deleting <span class="fancy-wrap">boxes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>To delete boxes drawn by a script, use
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.delete">box.delete()</a>.
As with <code dir="auto">*.delete()</code> functions in other drawing namespaces, this
function is handy for conditionally removing boxes or maintaining a
specific number of boxes on the chart.</p>
<p>This example displays boxes representing periodic cumulative volume
values. The script
<a href="/pine-script-docs/visuals/lines-and-boxes/#creating-boxes">creates</a> a new box ID and stores it in a <code dir="auto">boxes</code> array once every
<code dir="auto">length</code> bars. If the array’s size
exceeds the <code dir="auto">numberOfBoxes</code> value, the script removes the oldest box
from the array using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.shift">array.shift()</a>
and deletes it using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.delete">box.delete()</a>.</p>
<p>On other bars, it accumulates
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_volume">volume</a>
over each period by
<a href="/pine-script-docs/visuals/lines-and-boxes/#modifying-boxes">modifying</a> the <code dir="auto">top</code> property of the last
box in the <code dir="auto">boxes</code> array. The script then uses
<a href="/pine-script-docs/language/loops/#for-loops">`for` loops</a> to find the
<code dir="auto">highestTop</code> of all the array’s boxes and set the <code dir="auto">bgcolor</code> of each box
with a gradient color created using <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_color.from_gradient">color.from_gradient()</a>
based on its
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.get_top">box.get_top()</a>
value relative to the <code dir="auto">highestTop</code>:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Boxes-Deleting-boxes-1.CnAZt6YV_ZXP4os.webp" alt="image" width="1326" height="608" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="72m"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;boxes&nbsp;to&nbsp;show&nbsp;on&nbsp;the&nbsp;chart.</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_BOXES_COUNT</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">500</span></span><br><span><span></span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Deleting&nbsp;boxes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Cumulative&nbsp;volume&nbsp;boxes"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">format</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">format.volume</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_boxes_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_BOXES_COUNT</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;in&nbsp;each&nbsp;period.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;volume&nbsp;boxes&nbsp;in&nbsp;the&nbsp;calcula</span><span class="mtk9">tion.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfBoxes</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">10</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Number&nbsp;of&nbsp;boxes"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_BOXES_COUNT</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;containing&nbsp;the&nbsp;ID&nbsp;of&nbsp;each&nbsp;box&nbsp;displayed&nbsp;</span><span class="mtk9">by&nbsp;the&nbsp;script.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">boxes</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">box</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;a&nbsp;new&nbsp;box&nbsp;into&nbsp;the&nbsp;`boxes`&nbsp;array.&nbsp;The&nbsp;box&nbsp;</span><span class="mtk9">has&nbsp;the&nbsp;default&nbsp;`xloc.bar_index`&nbsp;property.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">boxes</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">#000000</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">text_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#000000</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Shift&nbsp;the&nbsp;oldest&nbsp;box&nbsp;out&nbsp;of&nbsp;the&nbsp;array&nbsp;and&nbsp;delet</span><span class="mtk9">e&nbsp;it&nbsp;when&nbsp;the&nbsp;array's&nbsp;size&nbsp;exceeds&nbsp;the&nbsp;`numberOfBo</span><span class="mtk9">xes`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">boxes</span><span class="mtk1">.</span><span class="mtk15">size</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfBoxes</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">box.delete</span><span class="mtk13">(</span><span class="mtk33">boxes</span><span class="mtk1">.</span><span class="mtk15">shift</span><span class="mtk13">())</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;last&nbsp;box&nbsp;drawn&nbsp;by&nbsp;the&nbsp;script&nbsp;as&nbsp;of&nbsp;the&nbsp;curren</span><span class="mtk9">t&nbsp;chart&nbsp;bar.</span></span><br><span><span class="mtk18 mtkb">box</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastBox</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">boxes</span><span class="mtk1">.</span><span class="mtk15">last</span><span class="mtk13">()</span></span><br><span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;current&nbsp;bar's&nbsp;volume&nbsp;to&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;</span><span class="mtk9">`lastBox`&nbsp;and&nbsp;update&nbsp;the&nbsp;`right`&nbsp;index.</span></span><br><span><span class="mtk33">lastBox</span><span class="mtk1">.</span><span class="mtk15">set_top</span><span class="mtk13">(</span><span class="mtk33">lastBox</span><span class="mtk1">.</span><span class="mtk15">get_top</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk11">volume</span><span class="mtk13">)</span></span><br><span><span class="mtk33">lastBox</span><span class="mtk1">.</span><span class="mtk15">set_right</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Display&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;`lastBox`&nbsp;as&nbsp;volume-form</span><span class="mtk9">atted&nbsp;text.</span></span><br><span><span class="mtk33">lastBox</span><span class="mtk1">.</span><span class="mtk15">set_text</span><span class="mtk13">(</span><span class="mtk16">str.tostring</span><span class="mtk13">(</span><span class="mtk33">lastBox</span><span class="mtk1">.</span><span class="mtk15">get_top</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">format.volume</span><span class="mtk13">))</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;highest&nbsp;`top`&nbsp;of&nbsp;all&nbsp;boxes&nbsp;in&nbsp;the&nbsp;`boxes`&nbsp;arr</span><span class="mtk9">ay.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">highestTop</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.0</span></span><br><span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">id</span><span class="mtk1">&nbsp;</span><span class="mtk18">in</span><span class="mtk1">&nbsp;</span><span class="mtk33">boxes</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">highestTop</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.max</span><span class="mtk13">(</span><span class="mtk33">id</span><span class="mtk1">.</span><span class="mtk15">get_top</span><span class="mtk13">()</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">highestTop</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Set&nbsp;the&nbsp;`bgcolor`&nbsp;of&nbsp;each&nbsp;`id`&nbsp;in&nbsp;`boxes`&nbsp;with&nbsp;</span><span class="mtk9">a&nbsp;gradient&nbsp;based&nbsp;on&nbsp;the&nbsp;ratio&nbsp;of&nbsp;its&nbsp;`top`&nbsp;to&nbsp;the&nbsp;</span><span class="mtk9">`highestTop`.</span></span><br><span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">id</span><span class="mtk1">&nbsp;</span><span class="mtk18">in</span><span class="mtk1">&nbsp;</span><span class="mtk33">boxes</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">id</span><span class="mtk1">.</span><span class="mtk15">set_bgcolor</span><span class="mtk13">(</span><span class="mtk16">color.from_gradient</span><span class="mtk13">(</span><span class="mtk33">id</span><span class="mtk1">.</span><span class="mtk15">get_top</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">highestTop</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span><span class="mtk13">))</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>At the top of the code, we’ve declared a <code dir="auto">MAX_BOXES_COUNT</code>
variable with the “const int” <em>qualified type</em>. We use this
value as the <code dir="auto">max_boxes_count</code> in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function and the maximum possible value of the <code dir="auto">numberOfBoxes</code>
input.</li>
<li>This script uses the second overload of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_box.new">box.new()</a>
function, which specifies the box’s <code dir="auto">left</code>, <code dir="auto">top</code>, <code dir="auto">right</code>, and
<code dir="auto">bottom</code> coordinates separately.</li>
<li>We’ve included
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_format.volume">format.volume</a>
as the <code dir="auto">format</code> argument in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
call, which tells the script that the y-axis of the chart pane
represents <em>volume</em> values. Each box also displays its <code dir="auto">top</code> coordinate as volume-formatted text.</li>
</ul>
<h2 id="polylines" class="md-heading"><a href="#polylines"> <span class="fancy-wrap">Polylines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p>Pine Script polylines are <strong>advanced</strong> drawings that sequentially
connect the coordinates from an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
of
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
instances using straight or <em>curved</em> line segments.</p>
<p>These powerful drawings can connect up to 10,000 points at any available
location on the chart, allowing scripts to draw custom series, polygons,
and other complex geometric formations that are otherwise difficult or
impossible to draw using
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
or <a href="https://www.tradingview.com/pine-script-reference/v6/#type_box">box</a>
objects.</p>
<p>The <code dir="auto">polyline.*</code> namespace features the following built-ins for creating
and managing
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_polyline">polyline</a>
objects:</p>
<ul>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
function creates a new polyline instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.delete">polyline.delete()</a>
function deletes an existing polyline instance.</li>
<li>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_polyline.all">polyline.all</a>
variable references a read-only
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
containing the IDs of all polylines displayed by the script. The
array’s size depends on the <code dir="auto">max_polylines_count</code> of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_strategy">strategy()</a>
declaration statement and the number of polylines drawn by the
script.</li>
</ul>
<p>Unlike <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>
or <a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>,
polylines do not have functions for modification or reading their
properties. To redraw a polyline on the chart, one can <em>delete</em> the
existing instance and <em>create</em> a new polyline with the desired changes.</p>
<h3 id="creating-polylines" class="md-heading"><a href="#creating-polylines">Creating <span class="fancy-wrap">polylines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
function creates a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_polyline">polyline</a>
instance to display on the chart. It has the following signature:</p>
<div class="expressive-code not-content"><figure class="frame"><figcaption class="header"></figcaption><pre data-language="text" tabindex="0"><code><div class="ec-line"><div class="code"><span style="--0:#e1e4e8;--1:#24292e">polyline.new(points, curved, closed, xloc, line_color, fill_color, line_style, line_width, force_overlay) → series polyline</span></div></div></code></pre></figure></div>
<p>The following eight parameters affect the behavior of a polyline
drawing:</p>
<p><code dir="auto">points</code></p>
<p class="spacer-wrapper"><spacer></spacer>Accepts an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
of
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects that determine the coordinates of each point in the
polyline. The drawing connects the coordinates from each element in
the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
sequentially, starting from the <em>first</em>. Whether the polyline uses
the <code dir="auto">index</code> or <code dir="auto">time</code> field from each
<a href="/pine-script-docs/language/type-system/#chart-points">chart point</a> for its x-coordinates depends on the <code dir="auto">xloc</code> value in the
function call.</p>
<p><code dir="auto">curved</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies whether the drawing uses curved line segments to connect
each
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
in the <code dir="auto">points</code> array. The default value is <code dir="auto">false</code>, meaning it uses
straight line segments.</p>
<p><code dir="auto">closed</code></p>
<p class="spacer-wrapper"><spacer></spacer>Controls whether the polyline will connect the last
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
in the <code dir="auto">points</code> array to the first, forming a <em>closed polyline</em>. The
default value is <code dir="auto">false</code>.</p>
<p><code dir="auto">xloc</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies which field from each
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
in the <code dir="auto">points</code> array the polyline uses for its x-coordinates. When
its value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>,
the function uses the <code dir="auto">index</code> fields to create the polyline. When
its value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_time">xloc.bar_time</a>,
the function uses the <code dir="auto">time</code> fields. The default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a>.</p>
<p><code dir="auto">line_color</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the color of all line segments in the polyline drawing.
The default is <code dir="auto">color.blue</code>.</p>
<p><code dir="auto">fill_color</code></p>
<p class="spacer-wrapper"><spacer></spacer>Controls the color of the closed space filled by the polyline
drawing. Its default value is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_na">na</a>.</p>
<p><code dir="auto">line_style</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the style of the polyline, which can be any of the
available options in the
<a href="/pine-script-docs/visuals/lines-and-boxes/#line-styles">Line styles</a> section of this page. The default is
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_line.style_solid">line.style_solid</a>.</p>
<p><code dir="auto">line_width</code></p>
<p class="spacer-wrapper"><spacer></spacer>Specifies the width of the polyline, in pixels. The default value is
1.</p>
<p><code dir="auto">force_overlay</code></p>
<p class="spacer-wrapper"><spacer></spacer>If <code dir="auto">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir="auto">false</code>.</p>
<p>This script demonstrates a simple example of drawing a polyline on the
chart. It uses <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.push">array.push</a> to push
the reference of a new <a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a> object
with an alternating <code dir="auto">price</code> value into a <code dir="auto">points</code> array and colors the background with
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_bgcolor">bgcolor()</a>
once every <code dir="auto">length</code> bars.</p>
<p>On the last confirmed historical bar, where <a href="https://www.tradingview.com/pine-script-reference/v6/#var_barstate.islastconfirmedhistory">barstate.islastconfirmedhistory</a> is <code dir="auto">true</code>, the script creates a new polyline with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>. The polyline drawing passes through the coordinates of each <a href="/pine-script-docs/language/type-system/#chart-points">chart point</a> in the <code dir="auto">points</code> array in order, starting from the first point:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-1.trunruUb_1O2zpI.webp" alt="image" width="1348" height="552" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="2ds"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Creating&nbsp;polylines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Oscillating&nbsp;polyline"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;between&nbsp;each&nbsp;point&nbsp;in&nbsp;the&nbsp;draw</span><span class="mtk9">ing.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length&nbsp;between&nbsp;points"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;`chart.point`&nbsp;objects&nbsp;to&nbsp;sequentially</span><span class="mtk9">&nbsp;connect&nbsp;with&nbsp;a&nbsp;polyline.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">points</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;y-coordinate&nbsp;of&nbsp;each&nbsp;point&nbsp;in&nbsp;the&nbsp;`points`.&nbsp;A</span><span class="mtk9">lternates&nbsp;between&nbsp;1&nbsp;and&nbsp;-1&nbsp;on&nbsp;each&nbsp;`newPoint`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;once&nbsp;every&nbsp;`length`&nbsp;bars,&nbsp;`false`&nbsp;other</span><span class="mtk9">wise.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;into&nbsp;the&nbsp;`points`.&nbsp;The</span><span class="mtk9">&nbsp;new&nbsp;point&nbsp;contains&nbsp;`time`&nbsp;and&nbsp;`index`&nbsp;info.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk33">yValue</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Change&nbsp;the&nbsp;sign&nbsp;of&nbsp;the&nbsp;`yValue`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">*=</span><span class="mtk1">&nbsp;</span><span class="mtk12">-1</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`polyline`&nbsp;on&nbsp;the&nbsp;last&nbsp;confirmed&nbsp;his</span><span class="mtk9">torical&nbsp;chart&nbsp;bar.</span></span><br><span><span class="mtk9">//&nbsp;The&nbsp;polyline&nbsp;uses&nbsp;the&nbsp;`time`&nbsp;field&nbsp;from&nbsp;each&nbsp;`c</span><span class="mtk9">hart.point`&nbsp;in&nbsp;the&nbsp;`points`&nbsp;array&nbsp;as&nbsp;x-coordinates</span><span class="mtk9">.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9151A6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;chart&nbsp;background&nbsp;on&nbsp;every&nbsp;`newPoi</span><span class="mtk9">nt`&nbsp;condition.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.gray</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;point&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This script uses only <em>one</em> polyline to connect each
<a href="/pine-script-docs/language/type-system/#chart-points">chart point</a> from the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
with straight line segments, and this drawing spans throughout
the available chart data, starting from the first bar.</li>
<li>While one can achieve a similar effect using
<a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>,
doing so would require a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
instance on each occurrence of the <code dir="auto">newPoint</code> condition, and
such a drawing would be limited to a maximum of 500 line
segments. This single unclosed polyline drawing, on the other
hand, can contain up to 9,999 line segments.</li>
</ul>
<h4 id="curved-drawings" class="md-heading"><a href="#curved-drawings">Curved <span class="fancy-wrap">drawings<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h4>
<p>Polylines can draw <em>curves</em> that are otherwise impossible to produce
with <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a> or
<a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>. When
enabling the <code dir="auto">curved</code> parameter of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
function, the resulting polyline interpolates <em>nonlinear</em> values between
the coordinates from each
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
in its
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
of <code dir="auto">points</code> to generate a curvy effect.</p>
<p>For instance, the “Oscillating polyline” script in our previous
example uses <em>straight</em> line segments to produce a drawing resembling a
triangle wave, meaning a waveform that zig-zags between its peaks and
valleys. If we set the <code dir="auto">curved</code> parameter in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
call from that example to <code dir="auto">true</code>, the resulting drawing would connect
the points using <em>curved</em> segments, producing a smooth, nonlinear shape
similar to a sine wave:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Curved-drawings-1.BWGXS3tj_10tSGQ.webp" alt="image" width="1348" height="552" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="67c"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Curved&nbsp;drawings&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Smooth&nbsp;oscillating&nbsp;polyline"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;between&nbsp;each&nbsp;point&nbsp;in&nbsp;the&nbsp;draw</span><span class="mtk9">ing.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length&nbsp;between&nbsp;points"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;`chart.point`&nbsp;objects&nbsp;to&nbsp;sequentially</span><span class="mtk9">&nbsp;connect&nbsp;with&nbsp;a&nbsp;polyline.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">points</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;y-coordinate&nbsp;of&nbsp;each&nbsp;point&nbsp;in&nbsp;the&nbsp;`points`.&nbsp;A</span><span class="mtk9">lternates&nbsp;between&nbsp;1&nbsp;and&nbsp;-1&nbsp;on&nbsp;each&nbsp;`newPoint`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;once&nbsp;every&nbsp;`length`&nbsp;bars,&nbsp;`false`&nbsp;other</span><span class="mtk9">wise.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;into&nbsp;the&nbsp;`points`.&nbsp;The</span><span class="mtk9">&nbsp;new&nbsp;point&nbsp;contains&nbsp;`time`&nbsp;and&nbsp;`index`&nbsp;info.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk33">yValue</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Change&nbsp;the&nbsp;sign&nbsp;of&nbsp;the&nbsp;`yValue`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">*=</span><span class="mtk1">&nbsp;</span><span class="mtk12">-1</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;curved&nbsp;`polyline`&nbsp;on&nbsp;the&nbsp;last&nbsp;confir</span><span class="mtk9">med&nbsp;historical&nbsp;chart&nbsp;bar.</span></span><br><span><span class="mtk9">//&nbsp;The&nbsp;polyline&nbsp;uses&nbsp;the&nbsp;`time`&nbsp;field&nbsp;from&nbsp;each&nbsp;`c</span><span class="mtk9">hart.point`&nbsp;in&nbsp;the&nbsp;`points`&nbsp;array&nbsp;as&nbsp;x-coordinates</span><span class="mtk9">.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">curved</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9151A6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;chart&nbsp;background&nbsp;on&nbsp;every&nbsp;`newPoi</span><span class="mtk9">nt`&nbsp;condition.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.gray</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;point&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Notice that in this example, the smooth curves have relatively
consistent behavior, and no portion of the drawing extends past its
defined coordinates, which is not always the case when drawing curved
polylines. The data used to construct a polyline heavily impacts the
smooth, piecewise function it interpolates between its points. In some
cases, the interpolated curve <em>can</em> reach beyond its actual coordinates.</p>
<p>Let’s add some variation to the
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> in our example’s <code dir="auto">points</code> array to demonstrate this
behavior. In the version below, the script multiplies <code dir="auto">yValue</code> by a pseudorandom value in each
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_chart.point.now">chart.point.now()</a>
call.</p>
<p>To visualize the behavior, this script also creates a horizontal
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
at the <code dir="auto">price</code> value from each
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a> instance
in the <code dir="auto">points</code> array, and it displays another polyline connecting the
same points with straight line segments. As we see on the chart, both
polylines pass through all coordinates from the <code dir="auto">points</code> array. However,
the curvy polyline occasionally reaches <em>beyond</em> the vertical boundaries
indicated by the horizontal
<a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>, whereas
the polyline drawn using straight segments does not:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Curved-drawings-2.Bh30lTw9_2uiiOc.webp" alt="image" width="1348" height="552" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="2xc"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Curved&nbsp;drawings&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Random&nbsp;oscillating&nbsp;polylines"</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;bars&nbsp;between&nbsp;each&nbsp;point&nbsp;in&nbsp;the&nbsp;draw</span><span class="mtk9">ing.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">20</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length&nbsp;between&nbsp;points"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;`chart.point`&nbsp;objects&nbsp;to&nbsp;sequentially</span><span class="mtk9">&nbsp;connect&nbsp;with&nbsp;a&nbsp;polyline.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">points</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;sign&nbsp;of&nbsp;each&nbsp;`price`&nbsp;in&nbsp;the&nbsp;`points`.&nbsp;Alterna</span><span class="mtk9">tes&nbsp;between&nbsp;1&nbsp;and&nbsp;-1&nbsp;on&nbsp;each&nbsp;`newPoint`.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;once&nbsp;every&nbsp;`length`&nbsp;bars.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;with&nbsp;a&nbsp;randomized&nbsp;`pri</span><span class="mtk9">ce`&nbsp;into&nbsp;the&nbsp;`points`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;The&nbsp;new&nbsp;point&nbsp;contains&nbsp;`time`&nbsp;and&nbsp;`index`&nbsp;info.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">()))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Change&nbsp;the&nbsp;sign&nbsp;of&nbsp;the&nbsp;`yValue`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">*=</span><span class="mtk1">&nbsp;</span><span class="mtk12">-1</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;newest&nbsp;`chart.point`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lastPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">last</span><span class="mtk13">()</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;horizontal&nbsp;line&nbsp;at&nbsp;the&nbsp;`lastPoint.price`</span><span class="mtk9">.&nbsp;This&nbsp;line&nbsp;uses&nbsp;the&nbsp;default&nbsp;`xloc.bar_index`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">lastPoint</span><span class="mtk1">.</span><span class="mtk33">index</span><span class="mtk1">&nbsp;</span><span class="mtk18">-</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastPoint</span><span class="mtk1">.</span><span class="mtk33">index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lastPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;two&nbsp;`polyline`&nbsp;instances&nbsp;on&nbsp;the&nbsp;last&nbsp;confi</span><span class="mtk9">rmed&nbsp;chart&nbsp;bar.</span></span><br><span><span class="mtk9">//&nbsp;Both&nbsp;polylines&nbsp;use&nbsp;the&nbsp;`time`&nbsp;field&nbsp;from&nbsp;each&nbsp;`</span><span class="mtk9">chart.point`&nbsp;in&nbsp;the&nbsp;`points`&nbsp;array&nbsp;as&nbsp;x-coordinate</span><span class="mtk9">s.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.islastconfirmedhistory</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">curved</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">false</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#EB8A3B</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">curved</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">xloc</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">xloc.bar_time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">#9151A6</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;chart&nbsp;background&nbsp;on&nbsp;every&nbsp;`newPoi</span><span class="mtk9">nt`&nbsp;condition.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.gray</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;point&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<h4 id="closed-shapes" class="md-heading"><a href="#closed-shapes">Closed <span class="fancy-wrap">shapes<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h4>
<p>Since a single polyline can contain numerous straight or curved line
segments, and the <code dir="auto">closed</code> parameter allows the drawing to connect the
coordinates from the first and last
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
in its
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
of <code dir="auto">points</code>, programmers can use polylines to draw many different types of closed
polygonal shapes.</p>
<p>Let’s draw some polygons in Pine. The following script periodically
draws randomized polygons centered at
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_hl2">hl2</a>
price values.</p>
<p>On each occurrence of the <code dir="auto">newPolygon</code> condition, the script
clears the <code dir="auto">points</code> array with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.clear">array.clear()</a>, calculates <code dir="auto">numberOfSides</code> and <code dir="auto">rotationOffset</code> values based on values from <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_math.random">math.random()</a> calls, then uses a <a href="/pine-script-docs/language/loops/#for-loops">`for` loop</a> to push <code dir="auto">numberOfSides</code> new
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> into the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>. The chart points contain stepped coordinates from an elliptical path with <code dir="auto">xScale</code>
and <code dir="auto">yScale</code> semi-axes. The script draws the polygon by connecting each point from the <code dir="auto">points</code> array using a <em>closed polyline</em> with straight line
segments:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Closed-shapes-1.DX7VAEme_ZOQPTt.webp" alt="image" width="1332" height="612" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="3ns"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Closed&nbsp;shapes&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"N-sided&nbsp;polygons"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;size&nbsp;of&nbsp;the&nbsp;horizontal&nbsp;semi-axis.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">xScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.float</span><span class="mtk13">(</span><span class="mtk12">3.0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"X&nbsp;scale"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1.0</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;size&nbsp;of&nbsp;the&nbsp;vertical&nbsp;semi-axis.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">yScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.float</span><span class="mtk13">(</span><span class="mtk12">1.0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Y&nbsp;scale"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.atr</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;`chart.point`&nbsp;objects&nbsp;containing&nbsp;vert</span><span class="mtk9">ex&nbsp;coordinates.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">points</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;condition&nbsp;that&nbsp;triggers&nbsp;a&nbsp;new&nbsp;polygon&nbsp;drawing</span><span class="mtk9">.&nbsp;Based&nbsp;on&nbsp;the&nbsp;horizontal&nbsp;axis&nbsp;to&nbsp;prevent&nbsp;overlaps</span><span class="mtk9">.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPolygon</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk16">int</span><span class="mtk13">(</span><span class="mtk16">math.round</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">xScale</span><span class="mtk13">))</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">and</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isconfirmed</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPolygon</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Clear&nbsp;the&nbsp;`points`&nbsp;array.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">clear</span><span class="mtk13">()</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;sides&nbsp;and&nbsp;vertices&nbsp;in&nbsp;the&nbsp;new&nbsp;polyg</span><span class="mtk9">on.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfSides</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">int</span><span class="mtk13">(</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">3</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">7</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;random&nbsp;rotation&nbsp;offset&nbsp;applied&nbsp;to&nbsp;the&nbsp;new&nbsp;polyg</span><span class="mtk9">on,&nbsp;in&nbsp;radians.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">rotationOffset</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">0.0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2.0</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk11">math.pi</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;size&nbsp;of&nbsp;the&nbsp;angle&nbsp;between&nbsp;each&nbsp;vertex,&nbsp;in&nbsp;rad</span><span class="mtk9">ians.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk11">math.pi</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfSides</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;counter-clockwise&nbsp;rotation&nbsp;angle&nbsp;of&nbsp;each&nbsp;vert</span><span class="mtk9">ex.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">angle</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">rotationOffset</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk1">&nbsp;</span><span class="mtk18">to</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfSides</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;approximate&nbsp;x-coordinate&nbsp;from&nbsp;an&nbsp;ellipse&nbsp;at&nbsp;t</span><span class="mtk9">he&nbsp;`angle`,&nbsp;rounded&nbsp;to&nbsp;the&nbsp;nearest&nbsp;integer.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">xValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">int</span><span class="mtk13">(</span><span class="mtk16">math.round</span><span class="mtk13">(</span><span class="mtk33">xScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.cos</span><span class="mtk13">(</span><span class="mtk33">angle</span><span class="mtk13">)))</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;y-coordinate&nbsp;from&nbsp;an&nbsp;ellipse&nbsp;at&nbsp;the&nbsp;`angle`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">yValue</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">yScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.sin</span><span class="mtk13">(</span><span class="mtk33">angle</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;containing&nbsp;the&nbsp;`xValue</span><span class="mtk9">`&nbsp;and&nbsp;`yValue`&nbsp;into&nbsp;the&nbsp;`points`&nbsp;array.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;The&nbsp;new&nbsp;point&nbsp;does&nbsp;not&nbsp;contain&nbsp;`time`&nbsp;informati</span><span class="mtk9">on.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk33">xValue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">yValue</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;`step`&nbsp;to&nbsp;the&nbsp;`angle`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">angle</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;closed&nbsp;polyline&nbsp;connecting&nbsp;the&nbsp;`points`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;The&nbsp;polyline&nbsp;uses&nbsp;the&nbsp;`index`&nbsp;field&nbsp;from&nbsp;each&nbsp;`</span><span class="mtk9">chart.point`&nbsp;in&nbsp;the&nbsp;`points`&nbsp;array.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closed</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.navy</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">fill_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.orange</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">50</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>This example shows the last ~50 polylines on the chart, as we
have not specified a <code dir="auto">max_polylines_count</code> value in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call.</li>
<li>The <code dir="auto">yScale</code> calculation multiplies an
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_input.float">input.float()</a>
by <code dir="auto">ta.atr(2)</code> to adapt the vertical scale of the drawings to recent price
ranges.</li>
<li>The resulting polygons have a maximum width of twice the
horizontal semi-axis (<code dir="auto">2 * xScale</code>), rounded to the nearest
integer. The <code dir="auto">newPolygon</code> condition uses this value to prevent
the polygon drawings from overlapping.</li>
<li>The script rounds the <code dir="auto">xValue</code> calculation to the nearest
integer because the <code dir="auto">index</code> field of a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
only accepts an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_int">int</a>
value, as the x-axis of the chart does not include fractional
bar indices.</li>
</ul>
<h3 id="deleting-polylines" class="md-heading"><a href="#deleting-polylines">Deleting <span class="fancy-wrap">polylines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>To delete a specific polyline, use
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.delete">polyline.delete()</a>.
This function removes the
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_polyline">polyline</a>
object from the script and its drawing on the chart.</p>
<p>As with other drawing objects, we can use
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.delete">polyline.delete()</a>
to maintain a specific number of polyline drawings or conditionally
remove drawings from a chart.</p>
<p>For example, the script below periodically draws approximate arithmetic
spirals and stores their polyline references in an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>,
which it
<a href="/pine-script-docs/language/arrays/#using-an-array-as-a-queue">uses as a queue</a> to manage the number of drawings it displays.</p>
<p>When the <code dir="auto">newSpiral</code> condition occurs, the script creates a <code dir="auto">points</code>
array and adds
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> within a <a href="/pine-script-docs/language/loops/#for-loops">`for` loop</a>. On each loop iteration, it calls the <code dir="auto">spiralPoint()</code>
<a href="/pine-script-docs/language/user-defined-functions/">user-defined function</a> to create a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
containing stepped values from an elliptical path that grows with
respect to the <code dir="auto">angle</code> value. The script then creates a randomly colored
<em>curved polyline</em> connecting the coordinates from the <code dir="auto">points</code> and pushes its reference into the <code dir="auto">polylines</code> array.</p>
<p>When the array’s size
exceeds the <code dir="auto">numberOfSpirals</code> value, the script removes the oldest polyline reference using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.shift">array.shift()</a>
and deletes the object using
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.delete">polyline.delete()</a>:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Deleting-polylines-1.CAlL6dPB_1NJJpi.webp" alt="image" width="1332" height="610" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="3zr"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;polylines&nbsp;allowed&nbsp;on&nbsp;the&nbsp;ch</span><span class="mtk9">art.</span></span><br><span><span class="mtk18 mtkb">const</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_POLYLINES_COUNT</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span></span><br><span><span></span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Deleting&nbsp;polylines&nbsp;example"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Spirals"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_polylines_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_POLYLINES_COUNT</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;spiral&nbsp;drawings&nbsp;on&nbsp;the&nbsp;chart.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfSpirals</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">10</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Spirals&nbsp;shown"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">MAX_POLYLINES_COUNT</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;number&nbsp;of&nbsp;full&nbsp;spiral&nbsp;rotations&nbsp;to&nbsp;draw.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">rotations</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">5</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Rotations"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;scale&nbsp;of&nbsp;the&nbsp;horizontal&nbsp;semi-axis.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">xScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.float</span><span class="mtk13">(</span><span class="mtk12">1.0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"X&nbsp;scale"</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;scale&nbsp;of&nbsp;the&nbsp;vertical&nbsp;semi-axis.</span></span><br><span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">yScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.float</span><span class="mtk13">(</span><span class="mtk12">0.2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Y&nbsp;scale"</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">ta.atr</span><span class="mtk13">(</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@function</span><span class="mtk9">&nbsp;Calculates&nbsp;an&nbsp;approximate&nbsp;point&nbsp;from&nbsp;an&nbsp;elliptica</span><span class="mtk9">lly-scaled&nbsp;arithmetic&nbsp;spiral.</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@returns</span><span class="mtk9">&nbsp;&nbsp;A&nbsp;`chart.point`&nbsp;with&nbsp;`index`&nbsp;and&nbsp;`price`&nbsp;informa</span><span class="mtk9">tion.</span></span><br><span><span class="mtk15">spiralPoint</span><span class="mtk13">(</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">angle</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">xOffset</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">yOffset</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">=&gt;</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">result</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">int</span><span class="mtk13">(</span><span class="mtk16">math.round</span><span class="mtk13">(</span><span class="mtk33">angle</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">xScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.cos</span><span class="mtk13">(</span><span class="mtk33">angle</span><span class="mtk13">)))</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">xOffset</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">angle</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">yScale</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.sin</span><span class="mtk13">(</span><span class="mtk33">angle</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk33">yOffset</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;polylines.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk33">polylines</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">polyline</span><span class="mtk13">&gt;()</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;condition&nbsp;to&nbsp;create&nbsp;a&nbsp;new&nbsp;spiral.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newSpiral</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk16">int</span><span class="mtk13">(</span><span class="mtk16">math.round</span><span class="mtk13">(</span><span class="mtk12">4</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk11">math.pi</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">rotations</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk33">xScale</span><span class="mtk13">))</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newSpiral</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;An&nbsp;array&nbsp;of&nbsp;`chart.point`&nbsp;objects&nbsp;for&nbsp;the&nbsp;`spiral</span><span class="mtk9">`&nbsp;drawing.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">array.new</span><span class="mtk13">&lt;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk13">&gt;()</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;counter-clockwise&nbsp;angle&nbsp;between&nbsp;calculated&nbsp;po</span><span class="mtk9">ints,&nbsp;in&nbsp;radians.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">math.pi</span><span class="mtk1">&nbsp;</span><span class="mtk18">/</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;rotation&nbsp;angle&nbsp;of&nbsp;each&nbsp;calculated&nbsp;point&nbsp;on&nbsp;th</span><span class="mtk9">e&nbsp;spiral,&nbsp;in&nbsp;radians.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">float</span><span class="mtk1">&nbsp;</span><span class="mtk33">theta</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0.0</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Loop&nbsp;to&nbsp;create&nbsp;the&nbsp;spiral's&nbsp;points.&nbsp;Creates&nbsp;4&nbsp;p</span><span class="mtk9">oints&nbsp;per&nbsp;full&nbsp;rotation.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">for</span><span class="mtk1">&nbsp;</span><span class="mtk33">i</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span><span class="mtk1">&nbsp;</span><span class="mtk18">to</span><span class="mtk1">&nbsp;</span><span class="mtk33">rotations</span><span class="mtk1">&nbsp;</span><span class="mtk18">*</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;point&nbsp;on&nbsp;the&nbsp;calculated&nbsp;spiral.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">spiralPoint</span><span class="mtk13">(</span><span class="mtk33">theta</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">ohlc4</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;`newPoint`&nbsp;to&nbsp;the&nbsp;`points`&nbsp;array.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">points</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk33">newPoint</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Add&nbsp;the&nbsp;`step`&nbsp;to&nbsp;the&nbsp;`theta`&nbsp;angle.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">theta</span><span class="mtk1">&nbsp;</span><span class="mtk18">+=</span><span class="mtk1">&nbsp;</span><span class="mtk33">step</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;random&nbsp;color&nbsp;for&nbsp;the&nbsp;new&nbsp;`spiral`&nbsp;drawing.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">spiralColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.rgb</span><span class="mtk13">(</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">150</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">255</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">0</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk16">math.random</span><span class="mtk13">(</span><span class="mtk12">150</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">255</span><span class="mtk13">))</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;polyline&nbsp;connecting&nbsp;the&nbsp;spiral&nbsp;points.&nbsp;Uses</span><span class="mtk9">&nbsp;the&nbsp;`index`&nbsp;field&nbsp;from&nbsp;each&nbsp;point&nbsp;as&nbsp;x-coordinate</span><span class="mtk9">s.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18 mtkb">polyline</span><span class="mtk1">&nbsp;</span><span class="mtk33">spiral</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk33">points</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">spiralColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">3</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Push&nbsp;the&nbsp;new&nbsp;`spiral`&nbsp;into&nbsp;the&nbsp;`polylines`&nbsp;arra</span><span class="mtk9">y.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">polylines</span><span class="mtk1">.</span><span class="mtk15">push</span><span class="mtk13">(</span><span class="mtk33">spiral</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Shift&nbsp;the&nbsp;first&nbsp;polyline&nbsp;out&nbsp;of&nbsp;the&nbsp;array&nbsp;and&nbsp;d</span><span class="mtk9">elete&nbsp;it&nbsp;when&nbsp;the&nbsp;array's&nbsp;size&nbsp;exceeds&nbsp;the&nbsp;`number</span><span class="mtk9">OfSpirals`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">polylines</span><span class="mtk1">.</span><span class="mtk15">size</span><span class="mtk13">()</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">numberOfSpirals</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.delete</span><span class="mtk13">(</span><span class="mtk33">polylines</span><span class="mtk1">.</span><span class="mtk15">shift</span><span class="mtk13">())</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Highlight&nbsp;the&nbsp;background&nbsp;when&nbsp;`newSpiral`&nbsp;is&nbsp;`t</span><span class="mtk9">rue`.</span></span><br><span><span class="mtk16">bgcolor</span><span class="mtk13">(</span><span class="mtk33">newSpiral</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk11">color.blue</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">70</span><span class="mtk13">)</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">title</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk29">"New&nbsp;drawing&nbsp;highlight"</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>We declared a <code dir="auto">MAX_POLYLINES_COUNT</code> global variable with a
constant value of 100. The script uses this constant as the
<code dir="auto">max_polylines_count</code> value in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function and the <code dir="auto">maxval</code> of the <code dir="auto">numberOfSpirals</code> input.</li>
<li>As with our “N-sided polygons” example in the
<a href="/pine-script-docs/visuals/lines-and-boxes/#closed-shapes">previous section</a>, we round the calculation of x-coordinates to the
nearest integer since the <code dir="auto">index</code> field of a
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
can only accept an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_int">int</a>
value.</li>
<li>Despite the smooth appearance of the drawings, each polyline’s
<code dir="auto">points</code> array only contains <em>four</em>
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects per spiral rotation. Since the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
call includes <code dir="auto">curved = true</code>, each polyline uses <em>smooth
curves</em> to connect their <code dir="auto">points</code>, producing a visual
approximation of the spiral’s actual curvature.</li>
<li>The width of each spiral is approximately
<code dir="auto">4 * math.pi * rotations * xScale</code>, rounded to the nearest
integer. We use this value in the <code dir="auto">newSpiral</code> condition to space
each drawing and prevent overlaps.</li>
</ul>
<h3 id="redrawing-polylines" class="md-heading"><a href="#redrawing-polylines">Redrawing <span class="fancy-wrap">polylines<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>It may be desirable in some cases to change a polyline drawing
throughout a script’s execution. While the <code dir="auto">polyline.*</code> namespace does
not contain built-in setter functions, we can <em>redraw</em> polylines
referenced by variables or
<a href="/pine-script-docs/language/type-system/#collections">collections</a> by <em>deleting</em> the existing polylines and assigning <em>new
instances</em> with the desired changes.</p>
<p>The following example uses
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.delete">polyline.delete()</a>
and
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>
calls to update the value of a polyline variable.</p>
<p>This script draws closed polylines that connect the open, high, low, and
close points of periods containing <code dir="auto">length</code> bars. It creates a
<code dir="auto">currentDrawing</code> variable on the first bar and assigns a polyline reference to
it on every chart bar. It uses the <code dir="auto">openPoint</code>, <code dir="auto">highPoint</code>, <code dir="auto">lowPoint</code>,
and <code dir="auto">closePoint</code> variables to reference
<a href="/pine-script-docs/language/type-system/#chart-points">chart points</a> that track the period’s developing OHLC values. As new
values emerge, the script assigns new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_chart.point">chart.point</a>
objects to the variables, collects them in an
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_array">array</a>
using <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_array.from">array.from()</a>,
then creates a new polyline connecting the coordinates from the array’s points with <a href="https://www.tradingview.com/pine-script-reference/v6/#fun_polyline.new">polyline.new()</a>.</p>
<p>When the <code dir="auto">newPeriod</code> condition is <code dir="auto">false</code> (i.e., the current period is not complete), the script
<a href="/pine-script-docs/visuals/lines-and-boxes/#deleting-polylines">deletes</a> the polyline referenced by the <code dir="auto">currentDrawing</code> variable before
<a href="/pine-script-docs/visuals/lines-and-boxes/#creating-polylines">creating a new one</a>, resulting in a dynamic drawing that changes over the
developing period:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Polylines-Redrawing-polylines-1.CzU1g71o_2i3aBU.webp" alt="image" width="1278" height="540" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="6st"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Redrawing&nbsp;polylines&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"OHLC&nbsp;polygons"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">max_polylines_count</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">100</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;length&nbsp;of&nbsp;the&nbsp;period.</span></span><br><span><span class="mtk18 mtkb">int</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">input.int</span><span class="mtk13">(</span><span class="mtk12">100</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk29">"Length"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;representing&nbsp;the&nbsp;start&nbsp;of&nbsp;each&nbsp;pe</span><span class="mtk9">riod.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;representing&nbsp;the&nbsp;highest&nbsp;point&nbsp;of</span><span class="mtk9">&nbsp;each&nbsp;period.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">highPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;representing&nbsp;the&nbsp;lowest&nbsp;point&nbsp;of&nbsp;</span><span class="mtk9">each&nbsp;period.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">chart.point</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;representing&nbsp;the&nbsp;current&nbsp;bar's&nbsp;cl</span><span class="mtk9">osing&nbsp;point.</span></span><br><span><span class="mtk33">closePoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;current&nbsp;period's&nbsp;polyline&nbsp;drawing.</span></span><br><span><span class="mtk18">var</span><span class="mtk1">&nbsp;</span><span class="mtk18 mtkb">polyline</span><span class="mtk1">&nbsp;</span><span class="mtk33">currentDrawing</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;`true`&nbsp;once&nbsp;every&nbsp;`length`&nbsp;bars.</span></span><br><span><span class="mtk18 mtkb">bool</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPeriod</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">%</span><span class="mtk1">&nbsp;</span><span class="mtk33">length</span><span class="mtk1">&nbsp;</span><span class="mtk18">==</span><span class="mtk1">&nbsp;</span><span class="mtk12">0</span></span><br><span><span></span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPeriod</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;new&nbsp;chart&nbsp;points&nbsp;to&nbsp;the&nbsp;`openPoint`,&nbsp;`hi</span><span class="mtk9">ghPoint`,&nbsp;and&nbsp;`closePoint`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">open</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">highPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lowPoint</span><span class="mtk1">&nbsp;&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span class="mtk18">else</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;to&nbsp;the&nbsp;`highPoint`&nbsp;w</span><span class="mtk9">hen&nbsp;the&nbsp;`high`&nbsp;is&nbsp;greater&nbsp;than&nbsp;its&nbsp;`price`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">highPoint</span><span class="mtk1">.</span><span class="mtk33">price</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">highPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;`chart.point`&nbsp;to&nbsp;the&nbsp;`lowPoint`&nbsp;wh</span><span class="mtk9">en&nbsp;the&nbsp;`low`&nbsp;is&nbsp;less&nbsp;than&nbsp;its&nbsp;`price`.</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk1">&nbsp;</span><span class="mtk18">&lt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowPoint</span><span class="mtk1">.</span><span class="mtk33">price</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">lowPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;teal&nbsp;when&nbsp;the&nbsp;`closePoint.price`&nbsp;is&nbsp;greater&nbsp;th</span><span class="mtk9">an&nbsp;the&nbsp;`openPoint.price`,&nbsp;maroon&nbsp;otherwise.</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">drawingColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">&gt;</span><span class="mtk1">&nbsp;</span><span class="mtk33">openPoint</span><span class="mtk1">.</span><span class="mtk33">price</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.teal</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.maroon</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Delete&nbsp;the&nbsp;polyline&nbsp;assigned&nbsp;to&nbsp;the&nbsp;`currentDra</span><span class="mtk9">wing`&nbsp;if&nbsp;it's&nbsp;not&nbsp;a&nbsp;`newPeriod`.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk18">not</span><span class="mtk1">&nbsp;</span><span class="mtk33">newPeriod</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">polyline.delete</span><span class="mtk13">(</span><span class="mtk33">currentDrawing</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Assign&nbsp;a&nbsp;new&nbsp;polyline&nbsp;to&nbsp;the&nbsp;`currentDrawing`.</span></span><br><span><span class="mtk9">//&nbsp;Uses&nbsp;the&nbsp;`index`&nbsp;field&nbsp;from&nbsp;each&nbsp;`chart.point`&nbsp;</span><span class="mtk9">in&nbsp;its&nbsp;array&nbsp;as&nbsp;x-coordinates.</span></span><br><span><span class="mtk33">currentDrawing</span><span class="mtk1">&nbsp;</span><span class="mtk18">:=</span><span class="mtk1">&nbsp;</span><span class="mtk16">polyline.new</span><span class="mtk13">(</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">array.from</span><span class="mtk13">(</span><span class="mtk33">openPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">highPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closePoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">lowPoint</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">closed</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk33">line_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">drawingColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">fill_color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">color.new</span><span class="mtk13">(</span><span class="mtk33">drawingColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">60</span><span class="mtk13">)</span></span><br><span><span class="mtk1">&nbsp;</span><span class="mtk13">)</span></span><br></code></div>
<h2 id="realtime-behavior" class="md-heading"><a href="#realtime-behavior">Realtime <span class="fancy-wrap">behavior<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<p><a href="/pine-script-docs/visuals/lines-and-boxes/#lines">Lines</a>,
<a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>, and
<a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a>
are subject to both <em>commit</em> and <em>rollback</em> actions, which affect the
behavior of a script when it executes on a realtime bar. See the page on
Pine Script’s <a href="/pine-script-docs/language/execution-model/">Execution model</a>.</p>
<p>This script demonstrates the effect of rollback when it executes on the
realtime, <em>unconfirmed</em> chart bar:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Realtime-behavior-1.CJQjybQE_1WvIDG.webp" alt="image" width="1328" height="474" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="2y2"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Realtime&nbsp;behavior&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;Is&nbsp;orange&nbsp;when&nbsp;the&nbsp;`line`&nbsp;is&nbsp;subject&nbsp;to&nbsp;rollback&nbsp;</span><span class="mtk9">and&nbsp;gray&nbsp;after&nbsp;the&nbsp;`line`&nbsp;is&nbsp;committed.</span></span><br><span><span class="mtk18 mtkb">color</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isconfirmed</span><span class="mtk1">&nbsp;</span><span class="mtk18">?</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.gray</span><span class="mtk1">&nbsp;</span><span class="mtk18">:</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.orange</span></span><br><span><span></span></span><br><span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">hl2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk33">lineColor</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">4</span><span class="mtk13">)</span></span><br></code></div>
<p>The
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_line.new">line.new()</a>
call in this example creates a new
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
ID on each iteration when values change on the unconfirmed bar. The
script automatically deletes the objects created on each change in that
bar because of the <em>rollback</em> before each iteration. It only <em>commits</em>
the last line created before the bar closes, and that
<a href="https://www.tradingview.com/pine-script-reference/v6/#type_line">line</a>
instance is the one that persists on the confirmed bar.</p>
<h2 id="limitations" class="md-heading"><a href="#limitations"> <span class="fancy-wrap">Limitations<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h2>
<h3 id="total-number-of-objects" class="md-heading"><a href="#total-number-of-objects">Total number of <span class="fancy-wrap">objects<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p><a href="/pine-script-docs/visuals/lines-and-boxes/#lines">Lines</a>,
<a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>, and
<a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a>
consume server resources, which is why there are limits on the total
number of drawings per script. When a script creates more drawing
objects than the allowed limit, the Pine Script runtime automatically
deletes the oldest ones in a process referred to as <em>garbage
collection</em>.</p>
<p>A single script can contain up to 500 lines, 500 boxes, and 100
polylines. Users can control the garbage collection limits by specifying
the <code dir="auto">max_lines_count</code>, <code dir="auto">max_boxes_count</code>, and <code dir="auto">max_polylines_count</code>
values in their script’s
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
or
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_strategy">strategy()</a>
declaration statement.</p>
<p>This script demonstrates how garbage collection works in Pine. It
creates a new line, box, and polyline on each chart bar. We haven’t
specified values for the <code dir="auto">max_lines_count</code>, <code dir="auto">max_boxes_count</code>, or
<code dir="auto">max_polylines_count</code> parameters in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
function call, so the script will maintain the most recent ~50 lines,
boxes, and polylines on the chart, as this is the default setting for
each parameter:</p>
<p><img src="/pine-script-docs/_astro/Lines-and-boxes-Limitations-Total-number-of-objects-1.BBu4sL-b_2tzxSR.webp" alt="image" width="1196" height="534" loading="lazy" decoding="async"></p>
<div class="pine-colorizer not-content colorized" data-id="6b"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Garbage&nbsp;collection&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;`chart.point`&nbsp;at&nbsp;the&nbsp;current&nbsp;`bar_index`&nbsp;an</span><span class="mtk9">d&nbsp;`high`.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;`chart.point`&nbsp;one&nbsp;bar&nbsp;into&nbsp;the&nbsp;future&nbsp;at&nbsp;th</span><span class="mtk9">e&nbsp;current&nbsp;`low`.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">low</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;new&nbsp;`chart.point`&nbsp;one&nbsp;bar&nbsp;into&nbsp;the&nbsp;future&nbsp;at&nbsp;th</span><span class="mtk9">e&nbsp;current&nbsp;`high`.</span></span><br><span><span class="mtk33">thirdPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk1">&nbsp;</span><span class="mtk18">+</span><span class="mtk1">&nbsp;</span><span class="mtk12">1</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">high</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`line`&nbsp;connecting&nbsp;the&nbsp;`firstPoint`&nbsp;t</span><span class="mtk9">o&nbsp;the&nbsp;`secondPoint`.</span></span><br><span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">color</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.red</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`box`&nbsp;with&nbsp;the&nbsp;`firstPoint`&nbsp;top-left</span><span class="mtk9">&nbsp;corner&nbsp;and&nbsp;`secondPoint`&nbsp;bottom-right&nbsp;corner.</span></span><br><span><span class="mtk16">box.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">color.purple</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">bgcolor</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">na</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;`polyline`&nbsp;connecting&nbsp;the&nbsp;`firstPoin</span><span class="mtk9">t`,&nbsp;`secondPoint`,&nbsp;and&nbsp;`thirdPoint`&nbsp;sequentially.</span></span><br><span><span class="mtk16">polyline.new</span><span class="mtk13">(</span><span class="mtk16">array.from</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">thirdPoint</span><span class="mtk13">)</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">line_width</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk12">2</span><span class="mtk13">)</span></span><br></code></div>
<p>Note that:</p>
<ul>
<li>We’ve used TradingView’s “Measure” drawing tool to measure
the number of bars covered by the script’s drawing objects.</li>
</ul>
<h3 id="past-and-future-references-with-xlocbar_index" class="md-heading"><a href="#past-and-future-references-with-xlocbar_index"><span>Past and future references with ​<code dir="auto">xloc.bar_index</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>Objects positioned using <a href="https://www.tradingview.com/pine-script-reference/v6/#var_xloc.bar_index">xloc.bar_index</a> can contain x-coordinates no further than 500 bars into the future or 10,000 bars into the past.</p>
<h3 id="other-contexts" class="md-heading"><a href="#other-contexts">Other <span class="fancy-wrap">contexts<span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></span></a></h3>
<p>Scripts cannot use <a href="/pine-script-docs/visuals/lines-and-boxes/#lines">lines</a>, <a href="/pine-script-docs/visuals/lines-and-boxes/#boxes">boxes</a>, or
<a href="/pine-script-docs/visuals/lines-and-boxes/#polylines">polylines</a>
in <code dir="auto">request.*()</code> functions. Instances of these types can use the values
from <code dir="auto">request.*()</code> calls, but scripts can only create and draw them in
the chart’s context.</p>
<p>This limitation is also why drawing objects will not work when using the
<code dir="auto">timeframe</code> parameter in the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_indicator">indicator()</a>
declaration statement.</p>
<h3 id="historical-buffer-and-max_bars_back" class="md-heading"><a href="#historical-buffer-and-max_bars_back"><span>Historical buffer and ​<code dir="auto">max_bars_back</code>​</span><span class="icon icon-link" aria-hidden="true"><svg width="28" height="28" viewBox="0 0 28 28"><g fill="currentColor" clip-path="url(#a)"><path d="M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z"></path><path d="m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h28v28H0z"></path></clipPath></defs></svg></span></a></h3>
<p>Using
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_barstate.isrealtime">barstate.isrealtime</a>
in combination with drawings may sometimes produce unexpected results.
For example, the intention of this script is to ignore all historical
bars and draw horizontal lines spanning 300 bars back on <em>realtime</em>
bars:</p>
<div class="pine-colorizer not-content colorized" data-id="2fk"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Historical&nbsp;buffer&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;at&nbsp;the&nbsp;`bar_index`&nbsp;from&nbsp;300&nbsp;bars&nbsp;</span><span class="mtk9">ago&nbsp;and&nbsp;current&nbsp;`close`.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk13">[</span><span class="mtk12">300</span><span class="mtk13">]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;current&nbsp;bar's&nbsp;`chart.point`&nbsp;containing&nbsp;the&nbsp;cu</span><span class="mtk9">rrent&nbsp;`close`.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;line&nbsp;on&nbsp;realtime&nbsp;bars.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isrealtime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk13">)</span></span><br></code></div>
<p>However, it will fail at runtime and raise an error. The script fails
because it cannot determine the buffer size for historical values of the
underlying
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>
series. Although the code doesn’t contain the built-in
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>
variable, the built-in
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_bar_index">bar_index</a>
uses the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>
series in its inner workings. Therefore, accessing the value of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_bar_index">bar_index</a>
from 300 bars back requires the history buffer of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>
series to be at least 300 bars.</p>
<p>Pine Script includes a mechanism that detects the required historical
buffer size automatically in most cases. It works by letting the script
access historical values any number of bars back for a limited duration.
In this script’s case, using
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_barstate.isrealtime">barstate.isrealtime</a>
to control the drawing of lines prevents it from accessing the
historical series, so it cannot infer the required historical buffer
size, and the script fails.</p>
<p>The simple solution to this issue is to use the
<a href="https://www.tradingview.com/pine-script-reference/v6/#fun_max_bars_back">max_bars_back()</a>
function to <em>explicitly define</em> the historical buffer of the
<a href="https://www.tradingview.com/pine-script-reference/v6/#var_time">time</a>
series before evaluating the
<a href="/pine-script-docs/language/conditional-structures/">conditional structure</a>:</p>
<div class="pine-colorizer not-content colorized" data-id="7pg"><div class="pine-colorizer__header"><a class="pine-colorizer__title" href="https://tradingview.com/pine-script-docs" target="_blank" rel="noopener"><span>Pine Script®</span></a><button class="pine-colorizer__copy-btn"><div class="pine-colorizer__tooltip">Copied</div></button></div><code class="monaco-editor-tv-pine-light"><span><span class="mtk9">//</span><span class="mtk9 mtkb">@version=</span><span class="mtk9">6</span></span><br><span><span class="mtk16">indicator</span><span class="mtk13">(</span><span class="mtk29">"Historical&nbsp;buffer&nbsp;demo"</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">overlay</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk11">true</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;A&nbsp;`chart.point`&nbsp;at&nbsp;the&nbsp;`bar_index`&nbsp;from&nbsp;300&nbsp;bars&nbsp;</span><span class="mtk9">ago&nbsp;and&nbsp;current&nbsp;`close.</span></span><br><span><span class="mtk33">firstPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.from_index</span><span class="mtk13">(</span><span class="mtk11">bar_index</span><span class="mtk13">[</span><span class="mtk12">300</span><span class="mtk13">]</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span class="mtk9">//</span><span class="mtk9 mtkb">@variable</span><span class="mtk9">&nbsp;The&nbsp;current&nbsp;bar's&nbsp;`chart.point`&nbsp;containing&nbsp;the&nbsp;cu</span><span class="mtk9">rrent&nbsp;`close`.</span></span><br><span><span class="mtk33">secondPoint</span><span class="mtk1">&nbsp;</span><span class="mtk18">=</span><span class="mtk1">&nbsp;</span><span class="mtk16">chart.point.now</span><span class="mtk13">(</span><span class="mtk11">close</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Explicitly&nbsp;set&nbsp;the&nbsp;historical&nbsp;buffer&nbsp;of&nbsp;the&nbsp;`ti</span><span class="mtk9">me`&nbsp;series&nbsp;to&nbsp;300&nbsp;bars.</span></span><br><span><span class="mtk16">max_bars_back</span><span class="mtk13">(</span><span class="mtk11">time</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk12">300</span><span class="mtk13">)</span></span><br><span><span></span></span><br><span><span class="mtk9">//&nbsp;Draw&nbsp;a&nbsp;new&nbsp;line&nbsp;on&nbsp;realtime&nbsp;bars.</span></span><br><span><span class="mtk18">if</span><span class="mtk1">&nbsp;</span><span class="mtk11">barstate.isrealtime</span></span><br><span><span class="mtk1">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="mtk16">line.new</span><span class="mtk13">(</span><span class="mtk33">firstPoint</span><span class="mtk18">,</span><span class="mtk1">&nbsp;</span><span class="mtk33">secondPoint</span><span class="mtk13">)</span></span><br></code></div>
<p>Such issues can be confusing, but they’re quite rare. The Pine Script
team hopes to eliminate them over time.</p>      </div> <div class="pagination-buttons not-content" data-astro-cid-xgirumru=""> <a href="/pine-script-docs/visuals/levels" class="pagination-card" data-pagefind-ignore="" data-astro-cid-assl6cvf=""> <p data-astro-cid-assl6cvf="">Previous</p> <h4 class="pagination-card-header" data-astro-cid-assl6cvf=""> <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-assl6cvf="" data-icon="theme/arrow-back">  <use xlink:href="#ai:local:theme/arrow-back"></use>  </svg> Levels  </h4> </a>  <a href="/pine-script-docs/visuals/plots" class="pagination-card" data-pagefind-ignore="" data-astro-cid-assl6cvf=""> <p data-astro-cid-assl6cvf="">Next</p> <h4 class="pagination-card-header" data-astro-cid-assl6cvf="">  Plots <svg width="28" height="28" viewBox="0 0 28 28" data-astro-cid-assl6cvf="" data-icon="theme/arrow">  <symbol id="ai:local:theme/arrow"><path fill="none" stroke="var(--arrow-fill-color, #131722)" d="m11 8 6 6-6 6"></path></symbol><use xlink:href="#ai:local:theme/arrow"></use>  </svg> </h4> </a>  </div>  </main>   <div id="toc" data-pagefind-ignore="all" data-astro-cid-oor6cujd=""><aside class="document-toc-container ml-4 w-48" data-astro-cid-oor6cujd=""><section id="toc-scroll-section" class="slick-scroll" data-astro-cid-oor6cujd=""><header data-astro-cid-oor6cujd=""><h2 class="toc-header" data-astro-cid-oor6cujd="">On this page</h2></header><ul class="" id="toc-entries" data-astro-cid-oor6cujd=""><a href="#introduction" aria-current="true" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-current="" data-astro-cid-oor6cujd="">Introduction</li></a><a href="#lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Lines</li></a><a href="#creating-lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Creating lines</li></a><a href="#modifying-lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Modifying lines</li></a><a href="#line-styles" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Line styles</li></a><a href="#reading-line-values" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Reading line values</li></a><a href="#cloning-lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Cloning lines</li></a><a href="#deleting-lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Deleting lines</li></a><a href="#filling-the-space-between-lines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Filling the space between lines</li></a><a href="#boxes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Boxes</li></a><a href="#creating-boxes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Creating boxes</li></a><a href="#modifying-boxes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Modifying boxes</li></a><a href="#box-styles" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Box styles</li></a><a href="#reading-box-values" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Reading box values</li></a><a href="#cloning-boxes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Cloning boxes</li></a><a href="#deleting-boxes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Deleting boxes</li></a><a href="#polylines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Polylines</li></a><a href="#creating-polylines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Creating polylines</li></a><a href="#curved-drawings" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-4" data-astro-cid-oor6cujd="">Curved drawings</li></a><a href="#closed-shapes" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-4" data-astro-cid-oor6cujd="">Closed shapes</li></a><a href="#deleting-polylines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Deleting polylines</li></a><a href="#redrawing-polylines" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Redrawing polylines</li></a><a href="#realtime-behavior" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Realtime behavior</li></a><a href="#limitations" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-2" data-astro-cid-oor6cujd="">Limitations</li></a><a href="#total-number-of-objects" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Total number of objects</li></a><a href="#past-and-future-references-with-xlocbar_index" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Past and future references with <code>xloc.bar_index</code></li></a><a href="#other-contexts" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Other contexts</li></a><a href="#historical-buffer-and-max_bars_back" class="document-toc-link" data-astro-cid-oor6cujd=""><li class="l-3" data-astro-cid-oor6cujd="">Historical buffer and <code>max_bars_back</code></li></a></ul></section><div class="toc-bottom-fade" data-astro-cid-oor6cujd=""></div><div class="back-top-space" data-astro-cid-oor6cujd=""><div class="not-content" style="" data-astro-cid-pkzv2hgs=""> <a id="back-top-button" title="Back to top" href="#top" data-astro-cid-pkzv2hgs="" class="floating-button not-content stvb-base stvb-pointer stvb-gray stvb-medium stvb-secondary stvb-icon stvb-icon-force-color stvb-force-no-border"> <svg width="18" height="18" viewBox="0 0 18 18" data-astro-cid-oor6cujd="" data-icon="theme/arrow-up">  <symbol id="ai:local:theme/arrow-up"><g fill="none"><g clip-path="url(#a)"><path fill="currentColor" fill-rule="evenodd" d="m9 3.5.5.44 4 3.5-1 1.12-2.75-2.4V14h-1.5V6.15L5.49 8.56l-.98-1.12 4-3.5z" clip-rule="evenodd"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 0h18v18H0z"></path></clipPath></defs></g></symbol><use xlink:href="#ai:local:theme/arrow-up"></use>  </svg> </a> </div> </div></aside></div> </main> </div>   <footer data-astro-cid-b6pf7ola=""> <div class="footer-content" data-astro-cid-b6pf7ola="">  <ul data-astro-cid-b6pf7ola=""> <li data-astro-cid-b6pf7ola=""> <a href="https://www.tradingview.com/chat/#BfmVowG1TZkKO235" data-astro-cid-b6pf7ola="">Pine Q&amp;A chat</a>  </li><li data-astro-cid-b6pf7ola=""> <a href="https://stackoverflow.com/questions/tagged/pine-script" data-astro-cid-b6pf7ola="">Stack Overflow</a>  ↗ </li><li data-astro-cid-b6pf7ola=""> <a href="https://t.me/PineCodersQA" data-astro-cid-b6pf7ola="">Telegram</a>  ↗ </li><li data-astro-cid-b6pf7ola=""> <a href="https://www.reddit.com/r/TradingView/" data-astro-cid-b6pf7ola="">Reddit</a>  ↗ </li> </ul> <div class="flex" data-astro-cid-b6pf7ola=""></div> <div class="copyright" data-astro-cid-b6pf7ola="">Copyright © 2025 TradingView, Inc.</div> </div> </footer>         </body></html>