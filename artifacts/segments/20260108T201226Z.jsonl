{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/alerts\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"alerts\"><a href=\"#alerts\">Alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView alerts run 24x7 on our servers and do not require users to\nbe logged in to execute. Alerts are created from the charts user\ninterface (<em>UI</em>). You will find all the information necessary to\nunderstand how alerts work and how to create them from the charts UI in\nthe Help Center\u2019s <a href=\"https://www.tradingview.com/support/solutions/43000520149\">About TradingView\nalerts</a> page.</p>\n<p>Some of the alert types available on TradingView (<em>generic alerts</em>,\n<em>drawing alerts</em> and <em>script alerts</em> on order fill events) are created\nfrom symbols or scripts loaded on the chart and do not require specific\ncoding. Any user can create these types of alerts from the charts UI.</p>\n<p>Other types of alerts (<em>script alerts</em> triggering on <em>alert() function\ncalls</em>, and <em>alertcondition() alerts</em>) require specific Pine Script\u00ae\ncode to be present in a script to create an <em>alert event</em> before script\nusers can create alerts from them using the charts UI. Additionally,\nwhile script users can create <em>script alerts</em> triggering on <em>order fill\nevents</em> from the charts UI on any strategy loaded on their chart,\nProgrammers can specify explicit order fill alert messages in their\nscript for each type of order filled by the broker emulator.</p>\n<p>This page covers the different ways Pine Script programmers can code\ntheir scripts to create alert events from which script users will in\nturn be able to create alerts from the charts UI. We will cover:</p>\n<ul>\n<li>How to use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction to <em>alert() function calls</em> in indicators or strategies,\nwhich can then be included in <em>script alerts</em> created from the\ncharts UI.</li>\n<li>How to add custom alert messages to be included in <em>script alerts</em>\ntriggering on the <em>order fill events</em> of strategies.</li>\n<li>How to use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction to generate, in indicators only, <em>alertcondition() events</em>\nwhich can then be used to create <em>alertcondition() alerts</em> from the\ncharts UI.</li>\n</ul>\n<p>Keep in mind that:</p>\n<ul>\n<li>No alert-related Pine Script code can create a running alert in the\ncharts UI; it merely creates alert events which can then be used by\nscript users to create running alerts from the charts UI.</li>\n<li>Alerts only trigger in the realtime bar. The operational scope of\nPine Script code dealing with any type of alert is therefore\nrestricted to realtime bars only.</li>\n<li>When an alert is created in the charts UI, TradingView saves a\nmirror image of the script and its inputs, along with the chart\u2019s\nmain symbol and timeframe to run the alert on its servers.\nSubsequent changes to your script\u2019s inputs or the chart will thus\nnot affect running alerts previously created from them. If you want\nany changes to your context to be reflected in a running alert\u2019s\nbehavior, you will need to delete the alert and create a new one in\nthe new context.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"background\"><a href=\"#background\">Background<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The different methods Pine programmers can use today to create alert\nevents in their script are the result of successive enhancements\ndeployed throughout Pine Script\u2019s evolution. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction, which works in indicators only, was the first feature allowing\nPine Script programmers to create alert events. Then came order fill\nalerts for strategies, which trigger when the broker emulator creates\n<em>order fill events</em>. <em>Order fill events</em> require no special code for\nscript users to create alerts on them, but by way of the <code dir=\"auto\">alert_message</code>\nparameter for order-generating <code dir=\"auto\">strategy.*()</code> functions, programmers can\ncustomize the message of alerts triggering on <em>order fill events</em> by\ndefining a distinct alert message for any number of order fulfillment\nevents.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction is the most recent addition to Pine Script. It more or less\nsupersedes\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>,\nand when used in strategies, provides a useful complement to alerts on\n<em>order fill events</em>.</p>\n<h3 class=\"md-heading\" id=\"which-type-of-alert-is-best\"><a href=\"#which-type-of-alert-is-best\">Which type of alert is best?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>For Pine Script programmers, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction will generally be easier and more flexible to work with.\nContrary to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>,\nit allows for dynamic alert messages, works in both indicators and\nstrategies and the programmer decides on the frequency of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nevents.</p>\n<p>While\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls can be generated on any logic programmable in Pine, including when\norders are <strong>sent</strong> to the broker emulator in strategies, they cannot be\ncoded to trigger when orders are <strong>executed</strong> (or <em>filled</em>) because\nafter orders are sent to the broker emulator, the emulator controls\ntheir execution and does not report fill events back to the script\ndirectly.</p>\n<p>When a script user wants to generate an alert on a strategy\u2019s order\nfill events, he must include those events when creating a <em>script alert</em>\non the strategy in the \u201cCreate Alert\u201d dialog box. No special code is\nrequired in scripts for users to be able to do this. The message sent\nwith order fill events can, however, be customized by programmers\nthrough use of the <code dir=\"auto\">alert_message</code> parameter in order-generating\n<code dir=\"auto\">strategy.*()</code> function calls. A combination of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls and the use of custom <code dir=\"auto\">alert_message</code> arguments in\norder-generating <code dir=\"auto\">strategy.*()</code> calls should allow programmers to\ngenerate alert events on most conditions occurring in their script\u2019s\nexecution.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction remains in Pine Script for backward compatibility, but it can\nalso be used advantageously to generate distinct alerts available for\nselection as individual items in the \u201cCreate Alert\u201d dialog box\u2019s\n\u201cCondition\u201d field.</p>", "segment_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-alerts\"><a href=\"#script-alerts\">Script alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When a script user creates a <em>script alert</em> using the \u201cCreate Alert\u201d\ndialog box, the events able to trigger the alert will vary depending on\nwhether the alert is created from an indicator or a strategy.</p>\n<p>A <em>script alert</em> created from an <strong>indicator</strong> will trigger when:</p>\n<ul>\n<li>The indicator contains\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls.</li>\n<li>The code\u2019s logic allows a specific\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall to execute.</li>\n<li>The frequency specified in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall allows the alert to trigger.</li>\n</ul>\n<p>A <em>script alert</em> created from a <strong>strategy</strong> can trigger on <em>alert()\nfunction calls</em>, on <em>order fill events</em>, or both. The script user\ncreating an alert on a strategy decides which type of events he wishes\nto include in his <em>script alert</em>. While users can create a <em>script\nalert</em> on <em>order fill events</em> without the need for a strategy to include\nspecial code, it must contain\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls for users to include <em>alert() function calls</em> in their <em>script\nalert</em>.</p>\n<h3 class=\"md-heading\" id=\"alert-function-events\"><a href=\"#alert-function-events\"><span>\u200b<code dir=\"auto\">alert()</code>\u200b function events</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction has the following signature:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">alert(message, freq)</span></div></div></code></pre></figure></link></div>\n<p><code dir=\"auto\">message</code></p>\n<p>A \u201cseries string\u201d representing the message text sent when the\nalert triggers. Because this argument allows \u201cseries\u201d values, it\ncan be generated at runtime and differ bar to bar, making it\ndynamic.</p>\n<p><code dir=\"auto\">freq</code></p>\n<p>An \u201cinput string\u201d specifying the triggering frequency of the\nalert. Valid arguments are:</p>\n<ul>\n<li><code dir=\"auto\">alert.freq_once_per_bar</code>: Only the first call per realtime bar\ntriggers the alert (default value).</li>\n<li><code dir=\"auto\">alert.freq_once_per_bar_close</code>: An alert is only triggered when\nthe realtime bar closes and an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall is executed during that script iteration.</li>\n<li><code dir=\"auto\">alert.freq_all</code>: All calls during the realtime bar trigger the\nalert.</li>\n</ul>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction can be used in both indicators and strategies. For an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall to trigger a <em>script alert</em> configured on <em>alert() function calls</em>,\nthe script\u2019s logic must allow the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall to execute, <strong>and</strong> the frequency determined by the <code dir=\"auto\">freq</code>\nparameter must allow the alert to trigger.</p>\n<p>Note that by default, strategies are recalculated at the bar\u2019s close,\nso if the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction with the frequency <code dir=\"auto\">alert.freq_all</code> or\n<code dir=\"auto\">alert.freq_once_per_bar</code> is used in a strategy, then it will be called\nno more often than once at the bar\u2019s close. In order to enable the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction to be called during the bar construction process, you need to\nenable the <code dir=\"auto\">calc_on_every_tick</code> option.</p>\n<h4 class=\"md-heading\" id=\"using-all-alert-calls\"><a href=\"#using-all-alert-calls\"><span>Using all \u200b<code dir=\"auto\">alert()</code>\u200b calls</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Let\u2019s look at an example where we detect crosses of the RSI centerline:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"All `alert()` calls\")\nr = ta.rsi(close, 20)\n\n// Detect crosses.\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n// Trigger an alert on crosses.\nif xUp\n    alert(\"Go long (RSI is \" + str.tostring(r, \"#.00)\"))\nelse if xDn\n    alert(\"Go short (RSI is \" + str.tostring(r, \"#.00)\"))\n\nplotchar(xUp, \"Go Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(xDn, \"Go Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\nhline(50)\nplot(r)</div>\n<p>If a <em>script alert</em> is created from this script:</p>\n<ul>\n<li>When RSI crosses the centerline up, the <em>script alert</em> will trigger\nwith the \u201cGo long\u2026\u201d message. When RSI crosses the centerline\ndown, the <em>script alert</em> will trigger with the \u201cGo short\u2026\u201d\nmessage.</li>\n<li>Because no argument is specified for the <code dir=\"auto\">freq</code> parameter in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall, the default value of <code dir=\"auto\">alert.freq_once_per_bar</code> will be used,\nso the alert will only trigger the first time each of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls is executed during the realtime bar.</li>\n<li>The message sent with the alert is composed of two parts: a constant\nstring and then the result of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>\ncall which will include the value of RSI at the moment where the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall is executed by the script. An alert message for a cross up\nwould look like: \u201cGo long (RSI is 53.41)\u201c.</li>\n<li>Because a <em>script alert</em> always triggers on any occurrence of a call\nto\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>,\nas long as the frequency used in the call allows for it, this\nparticular script does not allow a script user to restrict his\n<em>script alert</em> to longs only, for example.</li>\n</ul>\n<p>Note that:</p>\n<ul>\n<li>Contrary to an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncall which is always placed at column 0 (in the script\u2019s global\nscope), the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall is placed in the local scope of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nbranch so it only executes when our triggering condition is met. If\nan\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall was placed in the script\u2019s global scope at column 0, it would\nexecute on all bars, which would likely not be the desired behavior.</li>\n<li>An\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncould not accept the same string we use for our alert\u2019s message\nbecause of its use of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>\ncall.\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nmessages must be constant strings.</li>\n</ul>\n<p>Lastly, because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nmessages can be constructed dynamically at runtime, we could have used\nthe following code to generate our alert events:</p>\n<div class=\"pine-colorizer not-content\">// Trigger an alert on crosses.\nif xUp or xDn\n    firstPart = (xUp ? \"Go long\" : \"Go short\") + \" (RSI is \"\n    alert(firstPart + str.tostring(r, \"#.00)\"))</div>\n<h4 class=\"md-heading\" id=\"using-selective-alert-calls\"><a href=\"#using-selective-alert-calls\"><span>Using selective \u200b<code dir=\"auto\">alert()</code>\u200b calls</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When users create a <em>script alert</em> on <em>alert() function calls</em>, the\nalert will trigger on any call the script makes to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction, provided its frequency constraints are met. If you want to\nallow your script\u2019s users to select which\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction call in your script will trigger a <em>script alert</em>, you will\nneed to provide them with the means to indicate their preference in your\nscript\u2019s inputs, and code the appropriate logic in your script. This\nway, script users will be able to create multiple <em>script alerts</em> from a\nsingle script, each behaving differently as per the choices made in the\nscript\u2019s inputs prior to creating the alert in the charts UI.</p>\n<p>Suppose, for our next example, that we want to provide the option of\ntriggering alerts on only longs, only shorts, or both. You could code\nyour script like this:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Selective `alert()` calls\")\ndetectLongsInput  = input.bool(true,  \"Detect Longs\")\ndetectShortsInput = input.bool(true,  \"Detect Shorts\")\nrepaintInput      = input.bool(false, \"Allow Repainting\")\n\nr = ta.rsi(close, 20)\n// Detect crosses.\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n// Only generate entries when the trade's direction is allowed in inputs.\nenterLong  = detectLongsInput  and xUp and (repaintInput or barstate.isconfirmed)\nenterShort = detectShortsInput and xDn and (repaintInput or barstate.isconfirmed)\n// Trigger the alerts only when the compound condition is met.\nif enterLong\n    alert(\"Go long (RSI is \" + str.tostring(r, \"#.00)\"))\nelse if enterShort\n    alert(\"Go short (RSI is \" + str.tostring(r, \"#.00)\"))\n\nplotchar(enterLong,  \"Go Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(enterShort, \"Go Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\nhline(50)\nplot(r)</div>\n<p>Note how:</p>\n<ul>\n<li>We create a compound condition that is met only when the user\u2019s\nselection allows for an entry in that direction. A long entry on a\ncrossover of the centerline only triggers the alert when long\nentries have been enabled in the script\u2019s Inputs.</li>\n<li>We offer the user to indicate his repainting preference. When he\ndoes not allow the calculations to repaint, we wait until the bar\u2019s\nconfirmation to trigger the compound condition. This way, the alert\nand the marker only appear at the end of the realtime bar.</li>\n<li>If a user of this script wanted to create two distinct script alerts\nfrom this script, i.e., one triggering only on longs, and one only\non shorts, then he would need to:\n<ul>\n<li>Select only \u201cDetect Longs\u201d in the inputs and create a first\n<em>script alert</em> on the script.</li>\n<li>Select only \u201cDetect Shorts\u201d in the Inputs and create another\n<em>script alert</em> on the script.</li>\n</ul>\n</li>\n</ul>\n<h4 class=\"md-heading\" id=\"in-strategies\"><a href=\"#in-strategies\">In strategies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction calls can be used in strategies also, with the provision that\nstrategies, by default, only execute on the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nof realtime bars. Unless <code dir=\"auto\">calc_on_every_tick = true</code> is used in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement, all\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls will use the <code dir=\"auto\">alert.freq_once_per_bar_close</code> frequency, regardless\nof the argument used for <code dir=\"auto\">freq</code>.</p>\n<p>While <em>script alerts</em> on strategies will use <em>order fill events</em> to\ntrigger alerts when the broker emulator fills orders,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncan be used advantageously to generate other alert events in strategies.</p>\n<p>This strategy creates <em>alert() function calls</em> when RSI moves against\nthe trade for three consecutive bars:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Strategy with selective `alert()` calls\")\nr = ta.rsi(close, 20)\n\n// Detect crosses.\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n// Place orders on crosses.\nif xUp\n    strategy.entry(\"Long\", strategy.long)\nelse if xDn\n    strategy.entry(\"Short\", strategy.short)\n\n// Trigger an alert when RSI diverges from our trade's direction.\ndivInLongTrade  = strategy.position_size &gt; 0 and ta.falling(r, 3)\ndivInShortTrade = strategy.position_size &lt; 0 and ta.rising( r, 3)\nif divInLongTrade \n    alert(\"WARNING: Falling RSI\", alert.freq_once_per_bar_close)\nif divInShortTrade\n    alert(\"WARNING: Rising RSI\", alert.freq_once_per_bar_close)\n\nplotchar(xUp, \"Go Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(xDn, \"Go Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\nplotchar(divInLongTrade,  \"WARNING: Falling RSI\", \"\u2022\", location.top,    color.red,  size = size.tiny)\nplotchar(divInShortTrade, \"WARNING: Rising RSI\",  \"\u2022\", location.bottom, color.lime, size = size.tiny)\nhline(50)\nplot(r)</div>\n<p>If a user created a <em>script alert</em> from this strategy and included both\n<em>order fill events</em> and <em>alert() function calls</em> in his alert, the alert\nwould trigger whenever an order is executed, or when one of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls was executed by the script on the realtime bar\u2019s closing\niteration, i.e., when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disrealtime\">barstate.isrealtime</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nare both true. The <em>alert() function events</em> in the script would only\ntrigger the alert when the realtime bar closes because\n<code dir=\"auto\">alert.freq_once_per_bar_close</code> is the argument used for the <code dir=\"auto\">freq</code>\nparameter in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncalls.</p>\n<h3 class=\"md-heading\" id=\"order-fill-events\"><a href=\"#order-fill-events\">Order fill events<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a <em>script alert</em> is created from an indicator, it can only trigger\non <em>alert() function calls</em>. However, when a <em>script alert</em> is created\nfrom a strategy, the user can specify that <em>order fill events</em> also\ntrigger the <em>script alert</em>. An <em>order fill event</em> is any event generated\nby the broker emulator which causes a simulated order to be executed. It\nis the equivalent of a trade order being filled by a broker/exchange.\nOrders are not necessarily executed when they are placed. In a strategy,\nthe execution of orders can only be detected indirectly and after the\nfact, by analyzing changes in built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dopentrades\">strategy.opentrades</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dposition_size\">strategy.position_size</a>.\n<em>Script alerts</em> configured on <em>order fill events</em> are thus useful in\nthat they allow the triggering of alerts at the precise moment of an\norder\u2019s execution, before a script\u2019s logic can detect it.</p>\n<p>Pine Script programmers can customize the alert message sent when\nspecific orders are executed. While this is not a pre-requisite for\n<em>order fill events</em> to trigger, custom alert messages can be useful\nbecause they allow custom syntax to be included with alerts in order to\nroute actual orders to a third-party execution engine, for example.\nSpecifying custom alert messages for specific <em>order fill events</em> is\ndone by means of the <code dir=\"auto\">alert_message</code> parameter in functions which can\ngenerate orders:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dorder\">strategy.order()</a>.</p>\n<p>The argument used for the <code dir=\"auto\">alert_message</code> parameter is a \u201cseries\nstring\u201d, so it can be constructed dynamically using any variable\navailable to the script, as long as it is converted to string format.</p>\n<p>Let\u2019s look at a strategy where we use the <code dir=\"auto\">alert_message</code> parameter in\nboth our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>\ncalls:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Strategy using `alert_message`\")\nr = ta.rsi(close, 20)\n\n// Detect crosses.\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n// Place order on crosses using a custom alert message for each.\nif xUp\n    strategy.entry(\"Long\", strategy.long, stop = high, alert_message = \"Stop-buy executed (stop was \" + str.tostring(high) + \")\")\nelse if xDn\n    strategy.entry(\"Short\", strategy.short, stop = low, alert_message = \"Stop-sell executed (stop was \" + str.tostring(low) + \")\")\n\nplotchar(xUp, \"Go Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(xDn, \"Go Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\nhline(50)\nplot(r)</div>\n<p>Note that:</p>\n<ul>\n<li>We use the <code dir=\"auto\">stop</code> parameter in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>\ncalls, which creates stop-buy and stop-sell orders. This entails\nthat buy orders will only execute once price is higher than the\n<code dir=\"auto\">high</code> on the bar where the order is placed, and sell orders will\nonly execute once price is lower than the [low] on the\nbar where the order is placed.</li>\n<li>The up/down arrows which we plot with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nare plotted when orders are <strong>placed</strong>. Any number of bars may\nelapse before the order is actually executed, and in some cases the\norder will never be executed because price does not meet the\nrequired condition.</li>\n<li>Because we use the same <code dir=\"auto\">id</code> argument for all buy orders, any new\nbuy order placed before a previous order\u2019s condition is met will\nreplace that order. The same applies to sell orders.</li>\n<li>Variables included in the <code dir=\"auto\">alert_message</code> argument are evaluated\nwhen the order is executed, so when the alert triggers.</li>\n</ul>\n<p>When the <code dir=\"auto\">alert_message</code> parameter is used in a strategy\u2019s\norder-generating <code dir=\"auto\">strategy.*()</code> function calls, script users must\ninclude the <code dir=\"auto\">{{strategy.order.alert_message}}</code> placeholder in the\n\u201cCreate Alert\u201d dialog box\u2019s \u201cMessage\u201d field when creating <em>script\nalerts</em> on <em>order fill events</em>. This is required so the <code dir=\"auto\">alert_message</code>\nargument used in the order-generating <code dir=\"auto\">strategy.*()</code> function calls is\nused in the message of alerts triggering on each <em>order fill event</em>.\nWhen only using the <code dir=\"auto\">{{strategy.order.alert_message}}</code> placeholder in\nthe \u201cMessage\u201d field and the <code dir=\"auto\">alert_message</code> parameter is present in\nonly some of the order-generating <code dir=\"auto\">strategy.*()</code> function calls in your\nstrategy, an empty string will replace the placeholder in the message of\nalerts triggered by any order-generating <code dir=\"auto\">strategy.*()</code> function call\nnot using the <code dir=\"auto\">alert_message</code> parameter.</p>\n<p>While other placeholders can be used in the \u201cCreate Alert\u201d dialog\nbox\u2019s \u201cMessage\u201d field by users creating alerts on <em>order fill\nevents</em>, they cannot be used in the argument of <code dir=\"auto\">alert_message</code>.</p>", "segment_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"alertcondition-events\"><a href=\"#alertcondition-events\"><span>\u200b<code dir=\"auto\">alertcondition()</code>\u200b events</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction allows programmers to create individual <em>alertcondition events</em>\nin their indicators. One indicator may contain more than one\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncall. Each call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nin a script will create a corresponding alert selectable in the\n\u201cCondition\u201d dropdown menu of the \u201cCreate Alert\u201d dialog box.</p>\n<p>While the presence of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls in a <strong>strategy</strong> script will not cause a compilation error,\nalerts cannot be created from them.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">alertcondition(condition, title, message)</span></div></div></code></pre></figure></div>\n<p><code dir=\"auto\">condition</code></p>\n<p>A \u201cseries bool\u201d value (<code dir=\"auto\">true</code> or <code dir=\"auto\">false</code>) which determines when\nthe alert will trigger. It is a required argument. When the value is\n<code dir=\"auto\">true</code> the alert will trigger. When the value is <code dir=\"auto\">false</code> the alert\nwill not trigger. Contrary to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nfunction calls,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls must start at column zero of a line, so cannot be placed in\nconditional blocks.</p>\n<p><code dir=\"auto\">title</code></p>\n<p>A \u201cconst string\u201d optional argument that sets the name of the alert\ncondition as it will appear in the \u201cCreate Alert\u201d dialog box\u2019s\n\u201cCondition\u201d field in the charts UI. If no argument is supplied,\n\u201cAlert\u201d will be used.</p>\n<p><code dir=\"auto\">message</code></p>\n<p>A \u201cconst string\u201d optional argument that specifies the text message\nto display when the alert triggers. The text will appear in the\n\u201cMessage\u201d field of the \u201cCreate Alert\u201d dialog box, from where\nscript users can then modify it when creating an alert. <strong>As this\nargument must be a \u201cconst string\u201d, it must be known at compilation\ntime and thus cannot vary bar to bar.</strong> It can, however, contain\nplaceholders which will be replaced at runtime by dynamic values\nthat may change bar to bar. See this page\u2019s\n<a href=\"#placeholders\">Placeholders</a> section for a list.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nfunction does not include a <code dir=\"auto\">freq</code> parameter. The frequency of\n<em>alertcondition() alerts</em> is determined by users in the \u201cCreate Alert\u201d\ndialog box.</p>\n<h3 class=\"md-heading\" id=\"using-one-condition\"><a href=\"#using-one-condition\">Using one condition<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Here is an example of code creating <em>alertcondition() events</em>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`alertcondition()` on single condition\")\nr = ta.rsi(close, 20)\n\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n\nplot(r, \"RSI\")\nhline(50)\nplotchar(xUp, \"Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(xDn, \"Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\n\nalertcondition(xUp, \"Long Alert\",  \"Go long\")\nalertcondition(xDn, \"Short Alert\", \"Go short \")</div>\n<p>Because we have two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls in our script, two different alerts will be available in the\n\u201cCreate Alert\u201d dialog box\u2019s \u201cCondition\u201d field: \u201cLong Alert\u201d and\n\u201cShort Alert\u201d.</p>\n<p>If we wanted to include the value of RSI when the cross occurs, we could\nnot simply add its value to the <code dir=\"auto\">message</code> string using\n<code dir=\"auto\">str.tostring(r)</code>, as we could in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\ncall or in an <code dir=\"auto\">alert_message</code> argument in a strategy. We can, however,\ninclude it using a placeholder. This shows two alternatives:</p>\n<div class=\"pine-colorizer not-content\">alertcondition(xUp, \"Long Alert\",  \"Go long. RSI is {{plot_0}}\")\nalertcondition(xDn, \"Short Alert\", 'Go short. RSI is {{plot(\"RSI\")}}')</div>\n<p>Note that:</p>\n<ul>\n<li>The first line uses the <code dir=\"auto\">{{plot_0}}</code> placeholder, where the plot\nnumber corresponds to the order of the plot in the script.</li>\n<li>The second line uses the <code dir=\"auto\">{{plot(\"[plot_title]\")}}</code> type of\nplaceholder, which must include the <code dir=\"auto\">title</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall used in our script to plot RSI. Double quotes are used to wrap\nthe plot\u2019s title inside the <code dir=\"auto\">{{plot(\"RSI\")}}</code> placeholder. This\nrequires that we use single quotes to wrap the <code dir=\"auto\">message</code> string.</li>\n<li>Using one of these methods, we can include any numeric value that is\nplotted by our indicator, but as strings cannot be plotted, no\nstring variable can be used.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"using-compound-conditions\"><a href=\"#using-compound-conditions\">Using compound conditions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If we want to offer script users the possiblity of creating a single\nalert from an indicator using multiple\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls, we will need to provide options in the script\u2019s inputs through\nwhich users will indicate the conditions they want to trigger their\nalert before creating it.</p>\n<p>This script demonstrates one way to do it:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`alertcondition()` on multiple conditions\")\ndetectLongsInput  = input.bool(true, \"Detect Longs\")\ndetectShortsInput = input.bool(true, \"Detect Shorts\")\n\nr = ta.rsi(close, 20)\n// Detect crosses.\nxUp = ta.crossover( r, 50)\nxDn = ta.crossunder(r, 50)\n// Only generate entries when the trade's direction is allowed in inputs.\nenterLong  = detectLongsInput  and xUp\nenterShort = detectShortsInput and xDn\n\nplot(r)\nplotchar(enterLong,  \"Go Long\",  \"\u25b2\", location.bottom, color.lime, size = size.tiny)\nplotchar(enterShort, \"Go Short\", \"\u25bc\", location.top,    color.red,  size = size.tiny)\nhline(50)\n// Trigger the alert when one of the conditions is met.\nalertcondition(enterLong or enterShort, \"Compound alert\", \"Entry\")</div>\n<p>Note how the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncall is allowed to trigger on one of two conditions. Each condition can\nonly trigger the alert if the user enables it in the script\u2019s inputs\nbefore creating the alert.</p>\n<h3 class=\"md-heading\" id=\"placeholders\"><a href=\"#placeholders\">Placeholders<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>These placeholders can be used in the <code dir=\"auto\">message</code> argument of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls. They will be replaced with dynamic values when the alert\ntriggers. They are the only way to include dynamic values (values that\ncan vary bar to bar) in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\nmessages.</p>\n<p>Note that users creating <em>alertcondition() alerts</em> from the \u201cCreate\nAlert\u201d dialog box in the charts UI are also able to use these\nplaceholders in the dialog box\u2019s \u201cMessage\u201d field.</p>\n<p><code dir=\"auto\">{{exchange}}</code></p>\n<p>Exchange of the symbol used in the alert (NASDAQ, NYSE, MOEX, etc.).\nNote that for delayed symbols, the exchange will end with \u201c_DL\u201d or\n\u201c_DLY.\u201d For example, \u201cNYMEX_DL.\u201d</p>\n<p><code dir=\"auto\">{{interval}}</code></p>\n<p>Returns the timeframe of the chart the alert is created on. Note\nthat Range charts are calculated based on 1m data, so the\nplaceholder will always return \u201c1\u201d on any alert created on a Range\nchart.</p>\n<p><code dir=\"auto\">{{open}}</code>, <code dir=\"auto\">{{high}}</code>, <code dir=\"auto\">{{low}}</code>, <code dir=\"auto\">{{close}}</code>, <code dir=\"auto\">{{volume}}</code></p>\n<p>Corresponding values of the bar on which the alert has been\ntriggered.</p>\n<p><code dir=\"auto\">{{plot_0}}</code>, <code dir=\"auto\">{{plot_1}}</code>, [\u2026], <code dir=\"auto\">{{plot_19}}</code></p>\n<p>Value of the corresponding plot number. Plots are numbered from zero\nto 19 in order of appearance in the script, so only one of the first\n20 plots can be used. For example, the built-in \u201cVolume\u201d indicator\nhas two output series: Volume and Volume MA, so you could use the\nfollowing:</p>\n<div class=\"pine-colorizer not-content\">alertcondition(volume &gt; ta.sma(volume,20), \"Volume alert\", \"Volume ({{plot_0}}) &gt; average ({{plot_1}})\")</div>\n<p><code dir=\"auto\">{{plot(\"[plot_title]\")}}</code></p>\n<p>This placeholder can be used when one needs to refer to a plot using\nthe <code dir=\"auto\">title</code> argument used in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall. Note that double quotation marks (<code dir=\"auto\">\"</code>) <strong>must</strong> be used inside\nthe placeholder to wrap the <code dir=\"auto\">title</code> argument. This requires that a\nsingle quotation mark (<code dir=\"auto\">'</code>) be used to wrap the <code dir=\"auto\">message</code> string:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nr = ta.rsi(close, 14)\nxUp = ta.crossover(r, 50)\nplot(r, \"RSI\", display = display.none)\nalertcondition(xUp, \"xUp alert\", message = 'RSI is bullish at: {{plot(\"RSI\")}}')</div>\n<p><code dir=\"auto\">{{ticker}}</code></p>\n<p>Ticker of the symbol used in the alert (AAPL, BTCUSD, etc.).</p>\n<p><code dir=\"auto\">{{time}}</code></p>\n<p>Returns the time at the beginning of the bar. Time is UTC, formatted\nas <code dir=\"auto\">yyyy-MM-ddTHH:mm:ssZ</code>, so for example: <code dir=\"auto\">2019-08-27T09:56:00Z</code>.</p>\n<p><code dir=\"auto\">{{timenow}}</code></p>\n<p>Current time when the alert triggers, formatted in the same way as\n<code dir=\"auto\">{{time}}</code>. The precision is to the nearest second, regardless of\nthe chart\u2019s timeframe.</p>", "segment_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"avoiding-repainting-with-alerts\"><a href=\"#avoiding-repainting-with-alerts\">Avoiding repainting with alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The most common instances of repainting traders want to avoid with\nalerts are ones where they must prevent an alert from triggering at some\npoint during the realtime bar when it would <strong>not</strong> have triggered at\nits close. This can happen when these conditions are met:</p>\n<ul>\n<li>The calculations used in the condition triggering the alert can vary\nduring the realtime bar. This will be the case with any calculation\nusing <code dir=\"auto\">high</code>, <code dir=\"auto\">low</code> or <code dir=\"auto\">close</code>, for example, which includes almost\nall built-in indicators. It will also be the case with the result of\nany\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\ncall using a higher timeframe than the chart\u2019s, when the higher\ntimeframe\u2019s current bar has not closed yet.</li>\n<li>The alert can trigger before the close of the realtime bar, so with\nany frequency other than \u201cOnce Per Bar Close\u201d.</li>\n</ul>\n<p>The simplest way to avoid this type of repainting is to configure the\ntriggering frequency of alerts so they only trigger on the close of the\nrealtime bar. There is no panacea; avoiding this type of repainting\n<strong>always</strong> entails waiting for confirmed information, which means the\ntrader must sacrifice immediacy to achieve reliability.</p>\n<p>Note that other types of repainting such as those documented in our\n<a href=\"/pine-script-docs/v5/concepts/repainting/\">Repainting</a> section may\nnot be preventable by simply triggering alerts on the close of realtime\nbars.</p>", "segment_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "8b5640bd051f374fc09e379311c93f3b287859d9eef9cd1d3355025ecbea70ca", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-plotting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"bar-plotting\"><a href=\"#bar-plotting\">Bar plotting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-plotting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\nbuilt-in function is used to plot candles.\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>\nis used to plot conventional bars.</p>\n<p>Both functions require four arguments that will be used for the OHLC\nprices\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>)\nof the bars they will be plotting. If one of those is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, no\nbar is plotted.</p>", "segment_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-plotting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotting-candles-with-plotcandle\"><a href=\"#plotting-candles-with-plotcandle\"><span>Plotting candles with \u200b<code dir=\"auto\">plotcandle()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The signature of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\nis:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plotcandle(open, high, low, close, title, color, wickcolor, editable, show_last, bordercolor, display) \u2192 void</span></div></div></code></pre></figure></link></div>\n<p>This plots simple candles, all in blue, using the habitual OHLC values,\nin a separate pane:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Single-color candles\")\nplotcandle(open, high, low, close)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"604\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarPlotting-Plotcandle-1.DRLnC2kq_Z1j0wjf.webp\" width=\"1350\"/></p>\n<p>To color them green or red, we can use the following code:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 2\")\npaletteColor = close &gt;= open ? color.lime : color.red\nplotbar(open, high, low, close, color = paletteColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"604\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarPlotting-Plotcandle-2.CJRFcfps_Z1tzvoP.webp\" width=\"1350\"/></p>\n<p>Note that the <code dir=\"auto\">color</code> parameter accepts \u201cseries color\u201d arguments, so\nconstant values such as <code dir=\"auto\">color.red</code>, <code dir=\"auto\">color.lime</code>, <code dir=\"auto\">\"#FF9090\"</code>, as well\nas expressions that calculate colors at runtime, as is done with the\n<code dir=\"auto\">paletteColor</code> variable here, will all work.</p>\n<p>You can build bars or candles using values other than the actual OHLC\nvalues. For example you could calculate and plot smoothed candles using\nthe following code, which also colors wicks depending on the position of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nrelative to the smoothed close (<code dir=\"auto\">c</code>) of our indicator:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Smoothed candles\", overlay = true)\nlenInput = input.int(9)\nsmooth(source, length) =&gt;\n    ta.sma(source, length)\no = smooth(open, lenInput)\nh = smooth(high, lenInput)\nl = smooth(low, lenInput)\nc = smooth(close, lenInput)\nourWickColor = close &gt; c ? color.green : color.red\nplotcandle(o, h, l, c, wickcolor = ourWickColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"602\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarPlotting-Plotcandle-3.C3UsErKE_Z1DDKH.webp\" width=\"1356\"/></p>\n<p>You may find it useful to plot OHLC values taken from a higher\ntimeframe. You can, for example, plot daily bars on an intraday chart:</p>\n<div class=\"pine-colorizer not-content\">// NOTE: Use this script on an intraday chart.\n//@version=5\nindicator(\"Daily bars\")\n\n// Use gaps to only return data when the 1D timeframe completes, `na` otherwise.\n[o, h, l, c] = request.security(syminfo.tickerid, \"D\", [open, high, low, close], gaps = barmerge.gaps_on)\n\nvar color UP_COLOR = color.silver\nvar color DN_COLOR = color.blue\ncolor wickColor = c &gt;= o ? UP_COLOR : DN_COLOR\ncolor bodyColor = c &gt;= o ? color.new(UP_COLOR, 70) : color.new(DN_COLOR, 70)\n// Only plot candles on intraday timeframes, \n// and when non `na` values are returned by `request.security()` because a HTF has completed.\nplotcandle(timeframe.isintraday ? o : na, h, l, c, color = bodyColor, wickcolor = wickColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"836\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarPlotting-Plotcandle-4.BBez67E-_6Ng96.webp\" width=\"1762\"/></p>\n<p>Note that:</p>\n<ul>\n<li>\n<p>We show the script\u2019s plot after having used \u201cVisual Order/Bring to\nFront\u201d from the script\u2019s \u201cMore\u201d menu. This causes our script\u2019s\ncandles to appear on top of the chart\u2019s candles.</p>\n</li>\n<li>\n<p>The script will only display candles when two conditions are met:</p>\n<ul>\n<li>The chart is using an intraday timeframe (see the check on</li>\n</ul>\n<blockquote>\n<p><code dir=\"auto\">timeframe.isintraday</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\ncall). We do this because it\u2019s not useful to show a daily\nvalue on timeframes higher or equal to 1D.</p>\n</blockquote>\n<ul>\n<li>The</li>\n</ul>\n<blockquote>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nfunction returns non\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues (see <code dir=\"auto\">gaps = barmerge.gaps_on</code> in the function call).</p>\n</blockquote>\n</li>\n<li>\n<p>We use a tuple (<code dir=\"auto\">[open, high, low, close]</code>) with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch four values in one call.</p>\n</li>\n<li>\n<p>We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nto declare our <code dir=\"auto\">UP_COLOR</code> and <code dir=\"auto\">DN_COLOR</code> color constants on bar zero\nonly. We use constants because those colors are used in more than\none place in our code. This way, if we need to change them, we need\nonly do so in one place.</p>\n</li>\n<li>\n<p>We create a lighter transparency for the body of our candles in the\n<code dir=\"auto\">bodyColor</code> variable initialization, so they don\u2019t obstruct the\nchart\u2019s candles.</p>\n</li>\n</ul>", "segment_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-plotting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotting-bars-with-plotbar\"><a href=\"#plotting-bars-with-plotbar\"><span>Plotting bars with \u200b<code dir=\"auto\">plotbar()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The signature of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>\nis:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plotbar(open, high, low, close, title, color, editable, show_last, display, force_overlay) \u2192 void</span></div></div></code></pre></figure></div>\n<p>Note that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>\nhas no parameter for <code dir=\"auto\">bordercolor</code> or <code dir=\"auto\">wickcolor</code>, as there are no\nborders or wicks on conventional bars.</p>\n<p>This plots conventional bars using the same coloring logic as in the\nsecond example of the previous section:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Dual-color bars\")\npaletteColor = close &gt;= open ? color.lime : color.red\nplotbar(open, high, low, close, color = paletteColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"434\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarPlotting-Plotbar-1.Dolh7dC6_1AVTd1.webp\" width=\"1354\"/></p>", "segment_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "8066c7b8d53cfcbc870797e8e348849d9c44a4fd67e9cff6ead8d58a8b4812ab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-states", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/bar-states\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"bar-states\"><a href=\"#bar-states\">Bar states<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-states", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A set of built-in variables in the <code dir=\"auto\">barstate</code> namespace allow your\nscript to detect different properties of the bar on which the script is\ncurrently executing.</p>\n<p>These states can be used to restrict the execution or the logic of your\ncode to specific bars.</p>\n<p>Some built-ins return information on the trading session the current bar\nbelongs to. They are explained in the\n<a href=\"/pine-script-docs/v5/concepts/sessions/#session-states\">Session states</a> section.</p>", "segment_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-states", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"bar-state-built-in-variables\"><a href=\"#bar-state-built-in-variables\">Bar state built-in variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Note that while indicators and libraries run on all price or volume\nupdates in real time, strategies not using <code dir=\"auto\">calc_on_every_tick</code> will\nnot; they will only execute when the realtime bar closes. This will\naffect the detection of bar states in that type of script. On open\nmarkets, for example, this code will not display a background until the\nrealtime closes because that is when the strategy runs:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"S\")\nbgcolor(barstate.islast ? color.silver : na)</div>\n<h3 class=\"md-heading\" id=\"barstateisfirst\"><a href=\"#barstateisfirst\"><span>\u200b<code dir=\"auto\">barstate.isfirst</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disfirst\">barstate.isfirst</a>\nis only <code dir=\"auto\">true</code> on the dataset\u2019s first bar, i.e., when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nis zero.</p>\n<p>It can be useful to initialize variables on the first bar only, e.g.:</p>\n<div class=\"pine-colorizer not-content\">// Declare array and set its values on the first bar only.\nFILL_COLOR = color.green\nvar fillColors = array.new_color(0)\nif barstate.isfirst\n    // Initialize the array elements with progressively lighter shades of the fill color.\n    array.push(fillColors, color.new(FILL_COLOR, 70))\n    array.push(fillColors, color.new(FILL_COLOR, 75))\n    array.push(fillColors, color.new(FILL_COLOR, 80))\n    array.push(fillColors, color.new(FILL_COLOR, 85))\n    array.push(fillColors, color.new(FILL_COLOR, 90))</div>\n<h3 class=\"md-heading\" id=\"barstateislast\"><a href=\"#barstateislast\"><span>\u200b<code dir=\"auto\">barstate.islast</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nis <code dir=\"auto\">true</code> if the current bar is the last one on the chart, whether that\nbar is a realtime bar or not.</p>\n<p>It can be used to restrict the execution of code to the chart\u2019s last\nbar, which is often useful when drawing lines, labels or tables. Here,\nwe use it to determine when to update a label which we want to appear\nonly on the last bar. We create the label only once and then update its\nproperties using <code dir=\"auto\">label.set_*()</code> functions because it is more efficient:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n// Create label on the first bar only.\nvar label hiLabel = label.new(na, na, \"\")\n// Update the label's position and text on the last bar,\n// including on all realtime bar updates.\nif barstate.islast\n    label.set_xy(hiLabel, bar_index, high)\n    label.set_text(hiLabel, str.tostring(high, format.mintick))</div>\n<h3 class=\"md-heading\" id=\"barstateishistory\"><a href=\"#barstateishistory\"><span>\u200b<code dir=\"auto\">barstate.ishistory</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dishistory\">barstate.ishistory</a>\nis <code dir=\"auto\">true</code> on all historical bars. It can never be <code dir=\"auto\">true</code> on a bar when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disrealtime\">barstate.isrealtime</a>\nis also <code dir=\"auto\">true</code>, and it does not become <code dir=\"auto\">true</code> on a realtime bar\u2019s\nclosing update, when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nbecomes <code dir=\"auto\">true</code>. On closed markets, it can be <code dir=\"auto\">true</code> on the same bar\nwhere\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nis also <code dir=\"auto\">true</code>.</p>\n<h3 class=\"md-heading\" id=\"barstateisrealtime\"><a href=\"#barstateisrealtime\"><span>\u200b<code dir=\"auto\">barstate.isrealtime</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disrealtime\">barstate.isrealtime</a>\nis <code dir=\"auto\">true</code> if the current data update is a real-time bar update, <code dir=\"auto\">false</code>\notherwise (thus it is historical). Note that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nis also <code dir=\"auto\">true</code> on all realtime bars.</p>\n<h3 class=\"md-heading\" id=\"barstateisnew\"><a href=\"#barstateisnew\"><span>\u200b<code dir=\"auto\">barstate.isnew</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nis <code dir=\"auto\">true</code> on all historical bars and on the realtime bar\u2019s first\n(opening) update.</p>\n<p>All historical bars are considered <em>new</em> bars because the Pine Script\u00ae\nruntime executes your script on each bar sequentially, from the chart\u2019s\nfirst bar in time, to the last. Each historical bar is thus <em>discovered</em>\nby your script as it executes, bar to bar.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\ncan be useful to reset\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nvariables when a new realtime bar comes in. The following code will\nreset <code dir=\"auto\">updateNo</code> to 1 on all historical bars and at the beginning of\neach realtime bar. It calculates the number of realtime updates during\neach realtime bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nupdateNo() =&gt; \n    varip int updateNo = na\n    if barstate.isnew\n        updateNo := 1\n    else\n        updateNo += 1\nplot(updateNo())</div>\n<h3 class=\"md-heading\" id=\"barstateisconfirmed\"><a href=\"#barstateisconfirmed\"><span>\u200b<code dir=\"auto\">barstate.isconfirmed</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nis <code dir=\"auto\">true</code> on all historical bars and on the last (closing) update of a\nrealtime bar.</p>\n<p>It can be useful to avoid repainting by requiring the realtime bar to be\nclosed before a condition can become <code dir=\"auto\">true</code>. We use it here to hold\nplotting of our RSI until the realtime bar closes and becomes an elapsed\nrealtime bar. It will plot on historical bars because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nis always <code dir=\"auto\">true</code> on them:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nmyRSI = ta.rsi(close, 20)\nplot(barstate.isconfirmed ? myRSI : na)</div>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nwill not work when used in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\ncall.</p>\n<h3 class=\"md-heading\" id=\"barstateislastconfirmedhistory\"><a href=\"#barstateislastconfirmedhistory\"><span>\u200b<code dir=\"auto\">barstate.islastconfirmedhistory</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislastconfirmedhistory\">barstate.islastconfirmedhistory</a>\nis <code dir=\"auto\">true</code> if the script is executing on the dataset\u2019s last bar when the\nmarket is closed, or on the bar immediately preceding the realtime bar\nif the market is open.</p>\n<p>It can be used to detect the first realtime bar with\n<code dir=\"auto\">barstate.islastconfirmedhistory[1]</code>, or to postpone server-intensive\ncalculations until the last historical bar, which would otherwise be\nundetectable on open markets.</p>", "segment_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/bar-states", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"example\"><a href=\"#example\">Example<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Here is an example of a script using <code dir=\"auto\">barstate.*</code> variables:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Bar States\", overlay = true, max_labels_count = 500)\n\nstateText() =&gt;\n    string txt = \"\"\n    txt += barstate.isfirst     ? \"isfirst\\n\"     : \"\"\n    txt += barstate.islast      ? \"islast\\n\"      : \"\"\n    txt += barstate.ishistory   ? \"ishistory\\n\"   : \"\"\n    txt += barstate.isrealtime  ? \"isrealtime\\n\"  : \"\"\n    txt += barstate.isnew       ? \"isnew\\n\"       : \"\"\n    txt += barstate.isconfirmed ? \"isconfirmed\\n\" : \"\"\n    txt += barstate.islastconfirmedhistory ? \"islastconfirmedhistory\\n\" : \"\"\n\nlabelColor = switch\n    barstate.isfirst                =&gt; color.fuchsia\n    barstate.islastconfirmedhistory =&gt; color.gray\n    barstate.ishistory              =&gt; color.silver\n    barstate.isconfirmed            =&gt; color.orange\n    barstate.isnew                  =&gt; color.red\n    =&gt; color.yellow\n\nlabel.new(bar_index, na, stateText(), yloc = yloc.abovebar, color = labelColor)</div>\n<p>Note that:</p>\n<ul>\n<li>Each state\u2019s name will appear in the label\u2019s text when it is\n<code dir=\"auto\">true</code>.</li>\n<li>There are five possible colors for the label\u2019s background:\n<ul>\n<li>fuchsia on the first bar</li>\n<li>silver on historical bars</li>\n<li>gray on the last confirmed historical bar</li>\n<li>orange when a realtime bar is confirmed (when it closes and\nbecomes an elapsed realtime bar)</li>\n<li>red on the realtime bar\u2019s first execution</li>\n<li>yellow for other executions of the realtime bar</li>\n</ul>\n</li>\n</ul>\n<p>We begin by adding the indicator to the chart of an open market, but\nbefore any realtime update is received. Note how the last confirmed\nhistory bar is identified in #1, and how the last bar is identified as\nthe last one, but is still considered a historical bar because no\nrealtime updates have been received.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"862\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarStates-Example-01.C2adOFU8_1Hn1tm.webp\" width=\"1786\"/></p>\n<p>Let\u2019s look at what happens when realtime updates start coming in:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"672\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarStates-Example-02.B_WDB0Io_Z2snO6O.webp\" width=\"1768\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The realtime bar is red because it is its first execution, because\n<code dir=\"auto\">barstate.isnew</code> is <code dir=\"auto\">true</code> and <code dir=\"auto\">barstate.ishistory</code> is no longer\n<code dir=\"auto\">true</code>, so our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure determing our color uses the <code dir=\"auto\">barstate.isnew =&gt; color.red</code>\nbranch. This will usually not last long because on the next update\n<code dir=\"auto\">barstate.isnew</code> will no longer be <code dir=\"auto\">true</code> so the label\u2019s color will\nturn yellow.</li>\n<li>The label of elapsed realtime bars is orange because those bars were\nnot historical bars when they closed. Accordingly, the\n<code dir=\"auto\">barstate.ishistory =&gt; color.silver</code> branch in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure was not executed, but the next one,\n<code dir=\"auto\">barstate.isconfirmed =&gt; color.orange</code> was.</li>\n</ul>\n<p>This last example shows how the realtime bar\u2019s label will turn yellow\nafter the first execution on the bar. This is the way the label will\nusually appear on realtime bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"864\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BarStates-Example-03.DTQntSqN_1JGkwK.webp\" width=\"1784\"/></p>", "segment_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "90ce3a3372b7376eae27dc43f0c385563258c1efd6bd27be9352bfe8399ae889", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/chart-information\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"chart-information\"><a href=\"#chart-information\">Chart information<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The way scripts can obtain information about the chart and symbol they\nare currently running on is through a subset of Pine Script\u00ae\u2018s\n<a href=\"/pine-script-docs/v5/language/built-ins/#built-in-variables\">built-in variables</a>. The ones we cover here allow scripts to access information\nrelating to:</p>\n<ul>\n<li>The chart\u2019s prices and volume</li>\n<li>The chart\u2019s symbol</li>\n<li>The chart\u2019s timeframe</li>\n<li>The session (or time period) the symbol trades on</li>\n</ul>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"prices-and-volume\"><a href=\"#prices-and-volume\">Prices and volume<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The built-in variables for OHLCV values are:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>:\nthe bar\u2019s opening price.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>:\nthe bar\u2019s highest price, or the highest price reached during the\nrealtime bar\u2019s elapsed time.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>:\nthe bar\u2019s lowest price, or the lowest price reached during the\nrealtime bar\u2019s elapsed time.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>:\nthe bar\u2019s closing price, or the <strong>current price</strong> in the realtime\nbar.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>:\nthe volume traded during the bar, or the volume traded during the\nrealtime bar\u2019s elapsed time. The unit of volume information varies\nwith the instrument. It is in shares for stocks, in lots for forex,\nin contracts for futures, in the base currency for crypto, etc.</li>\n</ul>\n<p>Other values are available through:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>:\nthe average of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>:\nthe average of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>:\nthe average of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues.</li>\n</ul>\n<p>On historical bars, the values of the above variables do not vary during\nthe bar because only OHLCV information is available on them. When\nrunning on historical bars, scripts execute on the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\nwhen all the bar\u2019s information is known and cannot change during the\nscript\u2019s execution on the bar.</p>\n<p>Realtime bars are another story altogether. When indicators (or\nstrategies using <code dir=\"auto\">calc_on_every_tick = true</code>) run in realtime, the\nvalues of the above variables (except\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>)\nwill vary between successive iterations of the script on the realtime\nbar, because they represent their <strong>current</strong> value at one point in time\nduring the progress of the realtime bar. This may lead to one form of\n<a href=\"/pine-script-docs/v5/concepts/repainting/\">repainting</a>. See the\npage on Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> for\nmore details.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\n<a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">history-referencing operator</a> can be used to refer to past values of the built-in\nvariables, e.g., <code dir=\"auto\">close[1]</code> refers to the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\non the previous bar, relative to the particular bar the script is\nexecuting on.</p>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"symbol-information\"><a href=\"#symbol-information\">Symbol information<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Built-in variables in the <code dir=\"auto\">syminfo</code> namespace provide scripts with\ninformation on the symbol of the chart the script is running on. This\ninformation changes every time a script user changes the chart\u2019s\nsymbol. The script then re-executes on all the chart\u2019s bars using the\nnew values of the built-in variables:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dbasecurrency\">syminfo.basecurrency</a>:\nthe base currency, e.g., \u201cBTC\u201d in \u201cBTCUSD\u201d, or \u201cEUR\u201d in\n\u201cEURUSD\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dcurrency\">syminfo.currency</a>:\nthe quote currency, e.g., \u201cUSD\u201d in \u201cBTCUSD\u201d, or \u201cCAD\u201d in\n\u201cUSDCAD\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Ddescription\">syminfo.description</a>:\nThe long description of the symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dmintick\">syminfo.mintick</a>:\nThe symbol\u2019s tick value, or the minimum increment price can move\nin. Not to be confused with <em>pips</em> or <em>points</em>. On \u201cES1!\u201d (\u201cS&amp;P\n500 E-Mini\u201d) the tick size is 0.25 because that is the minimal\nincrement the price moves in.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dpointvalue\">syminfo.pointvalue</a>:\nThe point value is the multiple of the underlying asset determining\na contract\u2019s value. On \u201cES1!\u201d (\u201cS&amp;P 500 E-Mini\u201d) the point\nvalue is 50, so a contract is worth 50 times the price of the\ninstrument.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dprefix\">syminfo.prefix</a>:\nThe prefix is the exchange or broker\u2019s identifier: \u201cNASDAQ\u201d or\n\u201cBATS\u201d for \u201cAAPL\u201d, \u201cCME_MINI_DL\u201d for \u201cES1!\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Droot\">syminfo.root</a>:\nIt is the ticker\u2019s prefix for structured tickers like those of\nfutures. It is \u201cES\u201d for \u201cES1!\u201d, \u201cZW\u201d for \u201cZW1!\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dsession\">syminfo.session</a>:\nIt reflects the session setting on the chart for that symbol. If the\n\u201cChart settings/Symbol/Session\u201d field is set to \u201cExtended\u201d, it\nwill only return \u201cextended\u201d if the symbol and the user\u2019s feed\nallow for extended sessions. It is rarely displayed and used mostly\nas an argument to the <code dir=\"auto\">session</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dticker\">syminfo.ticker</a>:\nIt is the symbol\u2019s name, without the exchange part\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dprefix\">syminfo.prefix</a>):\n\u201cBTCUSD\u201d, \u201cAAPL\u201d, \u201cES1!\u201d, \u201cUSDCAD\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtickerid\">syminfo.tickerid</a>:\nThis string is rarely displayed. It is mostly used as an argument\nfor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\u2018s\n<code dir=\"auto\">symbol</code> parameter. It includes session, prefix and ticker\ninformation.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtimezone\">syminfo.timezone</a>:\nThe timezone the symbol is traded in. The string is an <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow\">IANA time\nzone database\nname</a>\n(e.g., \u201cAmerica/New_York\u201d).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtype\">syminfo.type</a>:\nThe type of market the symbol belongs to. The values are \u201cstock\u201d,\n\u201cfutures\u201d, \u201cindex\u201d, \u201cforex\u201d, \u201ccrypto\u201d, \u201cfund\u201d, \u201cdr\u201d,\n\u201ccfd\u201d, \u201cbond\u201d, \u201cwarrant\u201d, \u201cstructured\u201d and \u201cright\u201d.</li>\n</ul>\n<p>This script will display the values of those built-in variables on the\nchart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`syminfo.*` built-ins\", \"\", true)\nprintTable(txtLeft, txtRight) =&gt; \n    var table t = table.new(position.middle_right, 2, 1)\n    table.cell(t, 0, 0, txtLeft, bgcolor = color.yellow, text_halign = text.align_right)\n    table.cell(t, 1, 0, txtRight, bgcolor = color.yellow, text_halign = text.align_left)\n\nnl = \"\\n\"\nleft =\n  \"syminfo.basecurrency: \"  + nl +\n  \"syminfo.currency: \"      + nl +\n  \"syminfo.description: \"   + nl +\n  \"syminfo.mintick: \"       + nl +\n  \"syminfo.pointvalue: \"    + nl +\n  \"syminfo.prefix: \"        + nl +\n  \"syminfo.root: \"          + nl +\n  \"syminfo.session: \"       + nl +\n  \"syminfo.ticker: \"        + nl +\n  \"syminfo.tickerid: \"      + nl +\n  \"syminfo.timezone: \"      + nl +\n  \"syminfo.type: \"\n\nright =\n  syminfo.basecurrency              + nl +\n  syminfo.currency                  + nl +\n  syminfo.description               + nl +\n  str.tostring(syminfo.mintick)     + nl +\n  str.tostring(syminfo.pointvalue)  + nl +\n  syminfo.prefix                    + nl +\n  syminfo.root                      + nl +\n  syminfo.session                   + nl +\n  syminfo.ticker                    + nl +\n  syminfo.tickerid                  + nl +\n  syminfo.timezone                  + nl +\n  syminfo.type\n\nprintTable(left, right)</div>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"chart-timeframe\"><a href=\"#chart-timeframe\">Chart timeframe<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A script can obtain information on the type of timeframe used on the\nchart using these built-ins, which all return a \u201csimple bool\u201d result:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disseconds\">timeframe.isseconds</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disminutes\">timeframe.isminutes</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disintraday\">timeframe.isintraday</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdaily\">timeframe.isdaily</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disweekly\">timeframe.isweekly</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dismonthly\">timeframe.ismonthly</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdwm\">timeframe.isdwm</a></li>\n</ul>\n<p>Two additional built-ins return more specific timeframe information:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dmultiplier\">timeframe.multiplier</a>\nreturns a \u201csimple int\u201d containing the multiplier of the timeframe\nunit. A chart timeframe of one hour will return <code dir=\"auto\">60</code> because\nintraday timeframes are expressed in minutes. A 30sec timeframe will\nreturn <code dir=\"auto\">30</code> (seconds), a daily chart will return <code dir=\"auto\">1</code> (day), a\nquarterly chart will return <code dir=\"auto\">3</code> (months), and a yearly chart will\nreturn <code dir=\"auto\">12</code> (months). The value of this variable cannot be used as\nan argument to <code dir=\"auto\">timeframe</code> parameters in built-in functions, as they\nexpect a string in timeframe specifications format.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dperiod\">timeframe.period</a>\nreturns a string in Pine Script\u2019s timeframe specification format.</li>\n</ul>\n<p>See the page on <a href=\"/pine-script-docs/v5/concepts/timeframes/\">Timeframes</a> for more information.</p>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/chart-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"session-information\"><a href=\"#session-information\">Session information<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Session information is available in different forms:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dsession\">syminfo.session</a>\nbuilt-in variable returns a value that is either\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_session%7Bdot%7Dregular\">session.regular</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_session%7Bdot%7Dextended\">session.extended</a>.\nIt reflects the session setting on the chart for that symbol. If the\n\u201cChart settings/Symbol/Session\u201d field is set to \u201cExtended\u201d, it\nwill only return \u201cextended\u201d if the symbol and the user\u2019s feed\nallow for extended sessions. It is used when a session type is\nexpected, for example as the argument for the <code dir=\"auto\">session</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/sessions/#session-states\">Session state built-ins</a> provide information on the trading session a bar belongs\nto.</li>\n</ul>", "segment_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "808616dcc0ca49c0a747baba5cb9988bf1e4e7942bbc1b02845f986d995ed58e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"colors\"><a href=\"#colors\">Colors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Script visuals can play a critical role in the usability of the indicators we write in Pine Script\u00ae. Well-designed plots and drawings make indicators easier to use and understand. Good visual designs establish a visual hierarchy that allows the more important information to stand out, and the less important one to not get in the way.</p>\n<p>Using colors in Pine can be as simple as you want, or as involved as your concept requires. The 4,294,967,296 possible assemblies of color and transparency available in Pine Script can be applied to:</p>\n<ul>\n<li>Any element you can plot or draw in an indicator\u2019s visual space, be\nit lines, fills, text or candles.</li>\n<li>The background of a script\u2019s visual space, whether the script is\nrunning in its own pane, or in overlay mode on the chart.</li>\n<li>The color of bars or the body of candles appearing on a chart.</li>\n</ul>\n<p>A script can only color the elements it places in its own visual space. The only exception to this rule is that a pane indicator can color chart bars or candles.</p>\n<p>Pine Script has built-in colors such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dgreen\">color.green</a>, as well as functions like <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a> which allow you to dynamically generate any color in the RGBA color space.</p>\n<h3 class=\"md-heading\" id=\"transparency\"><a href=\"#transparency\">Transparency<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Each color in Pine Script is defined by four values:</p>\n<ul>\n<li>Its red, green and blue components (0-255), following the <a href=\"https://en.wikipedia.org/wiki/RGB_color_space\" rel=\"nofollow\">RGB color\nmodel</a>.</li>\n<li>Its transparency (0-100), often referred to as the Alpha channel\noutside Pine, as defined in the <a href=\"https://en.wikipedia.org/wiki/RGB_color_space\" rel=\"nofollow\">RGBA color\nmodel</a>. Even though\ntransparency is expressed in the 0-100 range, its value can be a\n\u201cfloat\u201d when used in functions, which gives you access to the 256\nunderlying values of the alpha channel.</li>\n</ul>\n<p>The transparency of a color defines how opaque it is: zero is fully opaque, 100 makes the color \u2014 whichever it is \u2014 invisible. Modulating transparency can be crucial in more involved color visuals or when using backgrounds, to control which colors dominate the others, and how they mix together when superimposed.</p>\n<h3 class=\"md-heading\" id=\"z-index\"><a href=\"#z-index\">Z-index<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When you place elements in a script\u2019s visual space, they have relative depth on the <em>z</em> axis; some will appear on top of others. The <em>z-index</em> is a value that represents the position of elements on the <em>z</em> axis. Elements with the highest z-index appear on top.</p>\n<p>Elements drawn in Pine Script are divided in groups. Each group has its own position in the <em>z</em> space, and <strong>within the same group</strong>, elements created last in the script\u2019s logic will appear on top of other elements from the same group. An element of one group cannot be placed outside the region of the <em>z</em> space attributed to its group, so a plot can never appear on top of a table, for example, because tables have the highest z-index.</p>\n<p>This list contains the groups of visual elements, ordered by increasing z-index, so background colors are always at the bottom of <em>z</em> space, and tables will always appear on top of all other elements:</p>\n<ul>\n<li>Background colors</li>\n<li>Fills</li>\n<li>Plots</li>\n<li>Hlines</li>\n<li>LineFills</li>\n<li>Lines</li>\n<li>Boxes</li>\n<li>Labels</li>\n<li>Tables</li>\n</ul>\n<p>Note that by using <code dir=\"auto\">explicit_plot_zorder = true</code> in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>, you can control the relative z-index of <code dir=\"auto\">plot*()</code>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a> visuals using their sequential order in the script.</p>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"constant-colors\"><a href=\"#constant-colors\">Constant colors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are 17 built-in colors in Pine Script. This table lists their names, hexadecimal equivalent, and RGB values as arguments to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a>:</p>\n<table><thead><tr><th>Name</th><th>Hex</th><th>RGB values</th></tr></thead><tbody><tr><td>color.aqua</td><td>#00BCD4</td><td>color.rgb(0, 188, 212)</td></tr><tr><td>color.black</td><td>#363A45</td><td>color.rgb(54, 58, 69)</td></tr><tr><td>color.blue</td><td>#2196F3</td><td>color.rgb(33, 150, 243)</td></tr><tr><td>color.fuchsia</td><td>#E040FB</td><td>color.rgb(224, 64, 251)</td></tr><tr><td>color.gray</td><td>#787B86</td><td>color.rgb(120, 123, 134)</td></tr><tr><td>color.green</td><td>#4CAF50</td><td>color.rgb(76, 175, 80)</td></tr><tr><td>color.lime</td><td>#00E676</td><td>color.rgb(0, 230, 118)</td></tr><tr><td>color.maroon</td><td>#880E4F</td><td>color.rgb(136, 14, 79)</td></tr><tr><td>color.navy</td><td>#311B92</td><td>color.rgb(49, 27, 146)</td></tr><tr><td>color.olive</td><td>#808000</td><td>color.rgb(128, 128, 0)</td></tr><tr><td>color.orange</td><td>#FF9800</td><td>color.rgb(255, 152, 0)</td></tr><tr><td>color.purple</td><td>#9C27B0</td><td>color.rgb(156, 39, 176)</td></tr><tr><td>color.red</td><td>#FF5252</td><td>color.rgb(255, 82, 82)</td></tr><tr><td>color.silver</td><td>#B2B5BE</td><td>color.rgb(178, 181, 190)</td></tr><tr><td>color.teal</td><td>#00897B</td><td>color.rgb(0, 137, 123)</td></tr><tr><td>color.white</td><td>#FFFFFF</td><td>color.rgb(255, 255, 255)</td></tr><tr><td>color.yellow</td><td>#FFEB3B</td><td>color.rgb(255, 235, 59)</td></tr></tbody></table>\n<p>In the following script, all plots use the same <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dolive\">color.olive</a> color with a transparency of 40, but expressed in different ways. All five methods are functionally equivalent:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"540\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-UsingColors-1.C5Rg2jRj_PLjh5.webp\" width=\"1796\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n// \u2014\u2014\u2014\u2014  Transparency (#99) is included in the hex value.\nplot(ta.sma(close, 10), \"10\", #80800099)\n// \u2014\u2014\u2014\u2014  Transparency is included in the color-generating function's arguments.\nplot(ta.sma(close, 30), \"30\", color.new(color.olive, 40))\nplot(ta.sma(close, 50), \"50\", color.rgb(128, 128, 0, 40))\n  // \u2014\u2014\u2014\u2014  Use `transp` parameter (deprecated and advised against)\nplot(ta.sma(close, 70), \"70\", color.olive, transp = 40)\nplot(ta.sma(close, 90), \"90\", #808000, transp = 40)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The last two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls specify transparency using the <code dir=\"auto\">transp</code> parameter. This use should\nbe avoided as the <code dir=\"auto\">transp</code> is deprecated in Pine Script v5. Using the\n<code dir=\"auto\">transp</code> parameter to define transparency is not as flexible because it\nrequires an argument of <em>input integer</em> type, which entails it must be\nknown before the script is executed, and so cannot be calculated\ndynamically, as your script executes bar to bar. Additionally, if you\nuse a <code dir=\"auto\">color</code> argument that already includes transparency information,\nas is done in the next three\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls, any argument used for the <code dir=\"auto\">transp</code> parameter would have no\neffect. This is also true for other functions with a <code dir=\"auto\">transp</code> parameter.</p></div></aside>\n<p>The colors in the previous script do not vary as the script executes bar to bar. Sometimes, however, colors need to be created as the script executes on each bar because they depend on conditions that are unknown at compile time, or when the script begins execution on bar zero. For those cases, programmers have two options:</p>\n<ol>\n<li>Use conditional statements to select colors from a few\npre-determined base colors.</li>\n<li>Build new colors dynamically, by calculating them as the script\nexecutes bar to bar, to implement color gradients, for example.</li>\n</ol>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"conditional-coloring\"><a href=\"#conditional-coloring\">Conditional coloring<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Let\u2019s say you want to color a moving average in different colors, depending on some conditions you define. To do so, you can use a conditional statement that will select a different color for each of your states. Let\u2019s start by coloring a moving average in a bull color when it\u2019s rising, and in a bear color when it\u2019s not:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"468\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-ConditionalColors-1.D1QaF3Y-_ZumNWi.webp\" width=\"1534\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional colors\", \"\", true)\nint   lengthInput = input.int(20, \"Length\", minval = 2)\ncolor maBullColorInput = input.color(color.green, \"Bull\")\ncolor maBearColorInput = input.color(color.maroon, \"Bear\")\nfloat ma = ta.sma(close, lengthInput)\n// Define our states.\nbool maRising  = ta.rising(ma, 1)\n// Build our color.\ncolor c_ma = maRising ? maBullColorInput : maBearColorInput\nplot(ma, \"MA\", c_ma, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>We provide users of our script a selection of colors for our\nbull/bear colors.</li>\n<li>We define an <code dir=\"auto\">maRising</code> boolean variable which will hold <code dir=\"auto\">true</code> when\nthe moving average is higher on the current bar than it was on the\nlast.</li>\n<li>We define a <code dir=\"auto\">c_ma</code> color variable that is assigned one of our two\ncolors, depending on the value of the <code dir=\"auto\">maRising</code> boolean. We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%7Bquestion%7D%7Bcolon%7D\">? : ternary\noperator</a>\nto write our conditional statement.</li>\n</ul>\n<p>You can also use conditional colors to avoid plotting under certain conditions. Here, we plot high and low pivots using a line, but we do not want to plot anything when a new pivot comes in, to avoid the joints that would otherwise appear in pivot transitions. To do so, we test for pivot changes and use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> as the color value when a change is detected, so that no line is plotted on that bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"472\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-ConditionalColors-2.erY98c4P_Z1OwyIO.webp\" width=\"1530\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional colors\", \"\", true)\nint legsInput = input.int(5, \"Pivot Legs\", minval = 1)\ncolor pHiColorInput = input.color(color.olive, \"High pivots\")\ncolor pLoColorInput = input.color(color.orange, \"Low pivots\")\n// Intialize the pivot level variables.\nvar float pHi = na\nvar float pLo = na\n// When a new pivot is detected, save its value.\npHi := nz(ta.pivothigh(legsInput, legsInput), pHi)\npLo := nz(ta.pivotlow( legsInput, legsInput), pLo)\n// When a new pivot is detected, do not plot a color.\nplot(pHi, \"High\", ta.change(pHi) ? na : pHiColorInput, 2, plot.style_line)\nplot(pLo, \"Low\",  ta.change(pLo) ? na : pLoColorInput, 2, plot.style_line)</div>\n<p>To undertand how this code works, one must first know that <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">ta.pivothigh()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivotlow\">ta.pivotlow()</a>, used as they are here without an argument to the <code dir=\"auto\">source</code> parameter, will return a value when they find a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>/<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> pivot, otherwise they return <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>When we test the value returned by the pivot function for <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> function, we allow the value returned to be assigned to the <code dir=\"auto\">pHi</code> or <code dir=\"auto\">pLo</code> variables only when it is not <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, otherwise the previous value of the variable is simply reassigned to it, which has no impact on its value. Keep in mind that previous values of <code dir=\"auto\">pHi</code> and <code dir=\"auto\">pLo</code> are preserved bar to bar because we use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> keyword when initializing them, which causes the initialization to only occur on the first bar.</p>\n<p>All that\u2019s left to do next is, when we plot our lines, to insert a ternary conditional statement that will yield <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> for the color when the pivot value changes, or the color selected in the script\u2019s inputs when the pivot level does not change.</p>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"calculated-colors\"><a href=\"#calculated-colors\">Calculated colors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Using functions like <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.new()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>, one can build colors on the fly, as the script executes bar to bar.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.new()</a> is most useful when you need to generate different transparency levels from a base color.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a> is useful when you need to build colors dynamically from red, green, blue, or tranparency components. While <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a> creates a color, its sister functions <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dr\">color.r()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dg\">color.g()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Db\">color.b()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dt\">color.t()</a> can be used to extract the red, green, blue or transparency values from a color, which can in turn be used to generate a variant.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a> is useful to create linear gradients between two base colors. It determines which intermediary color to use by evaluating a source value against minimum and maximum values.</p>\n<h3 class=\"md-heading\" id=\"colornew\"><a href=\"#colornew\">color.new()<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Let\u2019s put <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.new(color, transp)</a> to use to create different transparencies for volume columns using one of two bull/bear base colors:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"548\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-CalculatingColors-1.BtEyXAO2_Z2dfpcb.webp\" width=\"1407\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Volume\")\n// We name our color constants to make them more readable.\nvar color GOLD_COLOR   = #CCCC00ff\nvar color VIOLET_COLOR = #AA00FFff\ncolor bullColorInput = input.color(GOLD_COLOR,   \"Bull\")\ncolor bearColorInput = input.color(VIOLET_COLOR, \"Bear\")\nint levelsInput = input.int(10, \"Gradient levels\", minval = 1)\n// We initialize only once on bar zero with `var`, otherwise the count would reset to zero on each bar.\nvar float riseFallCnt = 0\n// Count the rises/falls, clamping the range to: 1 to `i_levels`.\nriseFallCnt := math.max(1, math.min(levelsInput, riseFallCnt + math.sign(volume - nz(volume[1]))))\n// Rescale the count on a scale of 80, reverse it and cap transparency to &lt;80 so that colors remains visible.\nfloat transparency = 80 - math.abs(80 * riseFallCnt / levelsInput)\n// Build the correct transparency of either the bull or bear color.\ncolor volumeColor = color.new(close &gt; open ? bullColorInput : bearColorInput, transparency)\nplot(volume, \"Volume\", volumeColor, 1, plot.style_columns)</div>\n<p>Note that:</p>\n<ul>\n<li>In the next to last line of our script, we dynamically calculate the\ncolumn color by varying both the base color used, depending on\nwhether the bar is up or down, <strong>and</strong> the transparency level, which\nis calculated from the cumulative rises or falls of volume.</li>\n<li>We offer the script user control over not only the base bull/bear\ncolors used, but also on the number of brightness levels we use. We\nuse this value to determine the maximum number of rises or falls we\nwill track. Giving users the possiblity to manage this value allows\nthem to adapt the indicator\u2019s visuals to the timeframe or market\nthey use.</li>\n<li>We take care to control the maximum level of transparency we use so\nthat it never goes higher than 80. This ensures our colors always\nretain some visibility.</li>\n<li>We also set the minimum value for the number of levels to 1 in the\ninputs. When the user selects 1, the volume columns will be either\nin bull or bear color of maximum brightness \u2014 or transparency zero.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"colorrgb\"><a href=\"#colorrgb\">color.rgb()<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In our next example we use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb(red, green, blue, transp)</a> to build colors from RGBA values. We use the result in a holiday season gift for our friends, so they can bring their TradingView charts to parties:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"548\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-CalculatingColors-2.B7PJa61g_ZI19Ev.webp\" width=\"1786\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Holiday candles\", \"\", true)\nfloat r = math.random(0, 255)\nfloat g = math.random(0, 255)\nfloat b = math.random(0, 255)\nfloat t = math.random(0, 100)\ncolor holidayColor = color.rgb(r, g, b, t)\nplotcandle(open, high, low, close, color = c_holiday, wickcolor = holidayColor, bordercolor = c_holiday)</div>\n<p>Note that:</p>\n<ul>\n<li>We generate values in the zero to 255 range for the red, green and\nblue channels, and in the zero to 100 range for transparency. Also\nnote that because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Drandom\">math.random()</a>\nreturns float values, the float 0.0-100.0 range provides access to\nthe full 0-255 transparency values of the underlying alpha channel.</li>\n<li>We use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Drandom\">math.random(min, max,\nseed)</a>\nfunction to generate pseudo-random values. We do not use an argument\nfor the third parameter of the function: <code dir=\"auto\">seed</code>. Using it is handy\nwhen you want to ensure the repeatability of the function\u2019s\nresults. Called with the same seed, it will produce the same\nsequence of values.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"colorfrom_gradient\"><a href=\"#colorfrom_gradient\">color.from_gradient()<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Our last examples of color calculations will use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient(value, bottom_value, top_value, bottom_color, top_color)</a>. Let\u2019s first use it in its simplest form, to color a CCI signal in a version of the indicator that otherwise looks like the built-in:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"250\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-CalculatingColors-3.BWe7BFsC_Zg2kjC.webp\" width=\"1450\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(title=\"CCI line gradient\", precision=2, timeframe=\"\")\nvar color GOLD_COLOR   = #CCCC00\nvar color VIOLET_COLOR = #AA00FF\nvar color BEIGE_COLOR  = #9C6E1B\nfloat srcInput = input.source(close, title=\"Source\")\nint   lenInput = input.int(20, \"Length\", minval = 5)\ncolor bullColorInput = input.color(GOLD_COLOR,   \"Bull\")\ncolor bearColorInput = input.color(BEIGE_COLOR, \"Bear\")\nfloat signal = ta.cci(srcInput, lenInput)\ncolor signalColor = color.from_gradient(signal, -200, 200, bearColorInput, bullColorInput)\nplot(signal, \"CCI\", signalColor)\nbandTopPlotID = hline(100,  \"Upper Band\", color.silver, hline.style_dashed)\nbandBotPlotID = hline(-100, \"Lower Band\", color.silver, hline.style_dashed)\nfill(bandTopPlotID, bandBotPlotID, color.new(BEIGE_COLOR, 90), \"Background\")</div>\n<p>Note that:</p>\n<ul>\n<li>To calculate the gradient,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>\nrequires minimum and maximum values against which the argument used\nfor the <code dir=\"auto\">value</code> parameter will be compared. The fact that we want a\ngradient for an unbounded signal like CCI (i.e., without fixed\nboundaries such as RSI, which always oscillates between 0-100), does\nnot entail we cannot use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>.\nHere, we solve our conundrum by providing values of -200 and 200 as\narguments. They do not represent the real minimum and maximum values\nfor CCI, but they are at levels from which we do not mind the colors\nno longer changing, as whenever the series is outside the\n<code dir=\"auto\">bottom_value</code> and <code dir=\"auto\">top_value</code> limits, the colors used for\n<code dir=\"auto\">bottom_color</code> and <code dir=\"auto\">top_color</code> will apply.</li>\n<li>The color progression calculated by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>\nis linear. If the value of the series is halfway between the\n<code dir=\"auto\">bottom_value</code> and <code dir=\"auto\">top_value</code> arguments, the generated color\u2019s\nRGBA components will also be halfway between those of <code dir=\"auto\">bottom_color</code>\nand <code dir=\"auto\">top_color</code>.</li>\n<li>Many common indicator calculations are available in Pine Script as\nbuilt-in functions. Here we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dcci\">ta.cci()</a>\ninstead of calculating it the long way.</li>\n</ul>\n<p>The argument used for <code dir=\"auto\">value</code> in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a> does not necessarily have to be the value of the line we are calculating. Anything we want can be used, as long as arguments for <code dir=\"auto\">bottom_value</code> and <code dir=\"auto\">top_value</code> can be supplied. Here, we enhance our CCI indicator by coloring the band using the number of bars since the signal has been above/below the centerline:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"250\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-CalculatingColors-4.-U0l6lwc_Zd5X5K.webp\" width=\"1459\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(title=\"CCI line gradient\", precision=2, timeframe=\"\")\nvar color GOLD_COLOR   = #CCCC00\nvar color VIOLET_COLOR = #AA00FF  \nvar color GREEN_BG_COLOR = color.new(color.green, 70)\nvar color RED_BG_COLOR   = color.new(color.maroon, 70)\nfloat srcInput      = input.source(close, \"Source\")\nint   lenInput      = input.int(20, \"Length\", minval = 5)\nint   stepsInput    = input.int(50, \"Gradient levels\", minval = 1)\ncolor bullColorInput   = input.color(GOLD_COLOR, \"Line: Bull\", inline = \"11\")\ncolor bearColorInput   = input.color(VIOLET_COLOR, \"Bear\", inline = \"11\")\ncolor bullBgColorInput = input.color(GREEN_BG_COLOR, \"Background: Bull\", inline = \"12\")\ncolor bearBgColorInput = input.color(RED_BG_COLOR, \"Bear\", inline = \"12\")\n\n// Plot colored signal line.\nfloat signal = ta.cci(srcInput, lenInput)\ncolor signalColor = color.from_gradient(signal, -200, 200, color.new(bearColorInput, 0), color.new(bullColorInput, 0))\nplot(signal, \"CCI\", signalColor, 2)\n\n// Detect crosses of the centerline.\nbool signalX = ta.cross(signal, 0)\n// Count no of bars since cross. Capping it to the no of steps from inputs.\nint gradientStep = math.min(stepsInput, nz(ta.barssince(signalX)))\n// Choose bull/bear end color for the gradient.\ncolor endColor = signal &gt; 0 ? bullBgColorInput : bearBgColorInput\n// Get color from gradient going from no color to `c_endColor` \ncolor bandColor = color.from_gradient(gradientStep, 0, stepsInput, na, endColor)\nbandTopPlotID = hline(100,  \"Upper Band\", color.silver, hline.style_dashed)\nbandBotPlotID = hline(-100, \"Lower Band\", color.silver, hline.style_dashed)\nfill(bandTopPlotID, bandBotPlotID, bandColor, title = \"Band\")</div>\n<p>Note that:</p>\n<ul>\n<li>The signal plot uses the same base colors and gradient as in our\nprevious example. We have however increased the width of the line\nfrom the default 1 to 2. It is the most important component of our\nvisuals; increasing its width is a way to give it more prominence,\nand ensure users are not distracted by the band, which has become\nbusier than it was in its original, flat beige color.</li>\n<li>The fill must remain unobtrusive for two reasons. First, it is of\nsecondary importance to the visuals, as it provides complementary\ninformation, i.e., the duration for which the signal has been in\nbull/bear territory. Second, since fills have a greater z-index than\nplots, the fill will cover the signal plot. For these reasons, we\nmake the fill\u2019s base colors fairly transparent, at 70, so they do\nnot mask the plots. The gradient used for the band starts with no\ncolor at all (see the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nused as the argument to <code dir=\"auto\">bottom_color</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>\ncall), and goes to the base bull/bear colors from the inputs, which\nthe conditional, <code dir=\"auto\">c_endColor</code> color variable contains.</li>\n<li>We provide users with distinct bull/bear color selections for the\nline and the band.</li>\n<li>When we calculate the <code dir=\"auto\">gradientStep</code> variable, we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a>\non\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dbarssince\">ta.barssince()</a>\nbecause in early bars of the dataset, when the condition tested has\nnot occurred yet,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dbarssince\">ta.barssince()</a>\nwill return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.\nBecause we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a>,\nthe value returned is replaced with zero in those cases.</li>\n</ul>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"mixing-transparencies\"><a href=\"#mixing-transparencies\">Mixing transparencies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In this example we take our CCI indicator in another direction. We will build dynamically adjusting extremes zone buffers using a Donchian Channel (historical highs/lows) calculated from the CCI. We build the top/bottom bands by making them 1/4 the height of the DC. We will use a dynamically adjusting lookback to calculate the DC. To modulate the lookback, we will calculate a simple measure of volatility by keeping a ratio of a short-period ATR to a long one. When that ratio is higher than 50 of its last 100 values, we consider the volatility high. When the volatility is high/low, we decrease/increase the lookback.</p>\n<p>Our aim is to provide users of our indicator with:</p>\n<ul>\n<li>The CCI line colored using a bull/bear gradient, as we illustrated\nin our most recent examples.</li>\n<li>The top and bottom bands of the Donchian Channel, filled in such a\nway that their color darkens as a historical high/low becomes older\nand older.</li>\n<li>A way to appreciate the state of our volatility measure, which we\nwill do by painting the background with one color whose intensity\nincreases when volatility increases.</li>\n</ul>\n<p>This is what our indicator looks like using the light theme:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"180\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MixingTransparencies-1.DJ-yTBxm_1VcSbJ.webp\" width=\"1788\"/></p>\n<p>And with the dark theme:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"178\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MixingTransparencies-2.BJOvmETq_Z1CqQBv.webp\" width=\"1786\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"CCI DC\", precision = 6)\ncolor GOLD_COLOR   = #CCCC00ff\ncolor VIOLET_COLOR = #AA00FFff\nint lengthInput = input.int(20, \"Length\", minval = 5)\ncolor bullColorInput = input.color(GOLD_COLOR,   \"Bull\")\ncolor bearColorInput = input.color(VIOLET_COLOR, \"Bear\")\n\n// \u2014\u2014\u2014\u2014\u2014 Function clamps `val` between `min` and `max`.\nclamp(val, min, max) =&gt;\n    math.max(min, math.min(max, val))\n\n// \u2014\u2014\u2014\u2014\u2014 Volatility expressed as 0-100 value.\nfloat v = ta.atr(lengthInput / 5) / ta.atr(lengthInput * 5)\nfloat vPct = ta.percentrank(v, lengthInput * 5)\n\n// \u2014\u2014\u2014\u2014\u2014 Calculate dynamic lookback for DC. It increases/decreases on low/high volatility.\nbool highVolatility = vPct &gt; 50\nvar int lookBackMin = lengthInput * 2\nvar int lookBackMax = lengthInput * 10\nvar float lookBack = math.avg(lookBackMin, lookBackMax)\nlookBack += highVolatility ? -2 : 2\nlookBack := clamp(lookBack, lookBackMin, lookBackMax)\n\n// \u2014\u2014\u2014\u2014\u2014 Dynamic lookback length Donchian channel of signal.\nfloat signal = ta.cci(close, lengthInput)\n// `lookBack` is a float; need to cast it to int to be used a length.\nfloat hiTop  = ta.highest(signal, int(lookBack))\nfloat loBot  = ta.lowest( signal, int(lookBack))\n// Get margin of 25% of the DC height to build high and low bands.\nfloat margin = (hiTop - loBot) / 4\nfloat hiBot  = hiTop - margin\nfloat loTop  = loBot + margin\n// Center of DC.\nfloat center = math.avg(hiTop, loBot)\n\n// \u2014\u2014\u2014\u2014\u2014 Create colors.\ncolor signalColor = color.from_gradient(signal, -200, 200, bearColorInput, bullColorInput)\n// Bands: Calculate transparencies so the longer since the hi/lo has changed, \n//        the darker the color becomes. Cap highest transparency to 90.\nfloat hiTransp = clamp(100 - (100 * math.max(1, nz(ta.barssince(ta.change(hiTop)) + 1)) / 255), 60, 90)\nfloat loTransp = clamp(100 - (100 * math.max(1, nz(ta.barssince(ta.change(loBot)) + 1)) / 255), 60, 90)\ncolor hiColor = color.new(bullColorInput, hiTransp)\ncolor loColor = color.new(bearColorInput, loTransp)\n// Background: Rescale the 0-100 range of `vPct` to 0-25 to create 75-100 transparencies.\ncolor bgColor = color.new(color.gray, 100 - (vPct / 4))\n\n// \u2014\u2014\u2014\u2014\u2014 Plots\n// Invisible lines for band fills.\nhiTopPlotID = plot(hiTop, color = na)\nhiBotPlotID = plot(hiBot, color = na)\nloTopPlotID = plot(loTop, color = na)\nloBotPlotID = plot(loBot, color = na)\n// Plot signal and centerline.\np_signal = plot(signal, \"CCI\", signalColor, 2)\nplot(center, \"Centerline\", color.silver, 1)\n\n// Fill the bands.\nfill(hiTopPlotID, hiBotPlotID, hiColor)\nfill(loTopPlotID, loBotPlotID, loColor)\n\n// \u2014\u2014\u2014\u2014\u2014 Background.\nbgcolor(bgColor)</div>\n<p>Note that:</p>\n<ul>\n<li>We clamp the transparency of the background to a 100-75 range so\nthat it doesn\u2019t overwhelm. We also use a neutral color that will\nnot distract too much. The darker the background is, the higher our\nmeasure of volatility.</li>\n<li>We also clamp the transparency values for the band fills between 60\nand 90. We use 90 so that when a new high/low is found and the\ngradient resets, the starting transparency makes the color somewhat\nvisible. We do not use a transparency lower than 60 because we\ndon\u2019t want those bands to hide the signal line.</li>\n<li>We use the very handy\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpercentrank\">ta.percentrank()</a>\nfunction to generate a 0-100 value from our ATR ratio measuring\nvolatility. It is useful to convert values whose scale is unknown\ninto known values that can be used to produce transparencies.</li>\n<li>Because we must clamp values three times in our script, we wrote an\n<code dir=\"auto\">f_clamp()</code> function, instead of explicitly coding the logic three\ntimes.</li>\n</ul>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/colors", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tips\"><a href=\"#tips\">Tips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"maintaining-automatic-color-selectors\"><a href=\"#maintaining-automatic-color-selectors\">Maintaining automatic color selectors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Under certain conditions, PineScript can automatically display all of the colors used in script\u2019s plots in the \u201cSettings/Styles\u201d menu. These plots are graphics created by all <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot*()</a> functions, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>. The user can change the colors using a color picker. This feature allows colors in scripts to be customized without any extra code.</p>\n<p>For example, this simple script has a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> that is colored either teal or red, depending on the relationship between the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>. The script does not specify that these colors should be editable, nor does it create any color-related inputs. Nevertheless, PineScript automatically displays the colors in the \u201cSettings/Styles\u201d menu and allows the user to change them, along with the style of the plot:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"962\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MaintainAutomaticColorSelection-1.BHISUteP_LNVpG.webp\" width=\"752\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Color picker showcase\")\nplotColor = close &gt; open ? color.teal : color.red\nplot(close, color = plotColor)</div>\n<aside aria-label=\"Tip\" class=\"tv-informer not-content\" style=\"--informer-header-color:#089981;--informer-back-color-light:#DAF2EE;--informer-back-color-dark:#082621\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16Zm3.87-12.15c.36.2.49.66.28 1.02l-4 7a.75.75 0 0 1-1.18.16l-3-3a.75.75 0 1 1 1.06-1.06l2.3 2.3 3.52-6.14a.75.75 0 0 1 1.02-.28Z\" fill=\"currentColor\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Tip</span>To prevent the user from changing the color or the type of the plot via the \u201cStyles\u201d tab, include <code dir=\"auto\">editable = false</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> call.</p></div></aside>\n<p>The colors in the above script can be automatically displayed in this way because they are already known <em>during compilation</em>. Colors that are known during compilation are of type <a href=\"/pine-script-docs/v5/language/type-system/#const\">\u201cconst\u201d</a> or <a href=\"/pine-script-docs/v5/language/type-system/#input\">\u201cinput\u201d</a> only.</p>\n<p>However, if <em>even a</em> <em>single calculated color</em> is of type \u201csimple color\u201d or \u201cseries color\u201d, <em>all</em> colors are calculated in the script\u2019s runtime, and no color pickers are available in the \u201cStyle\u201d section.</p>\n<p>In practice, the creation of <a href=\"/pine-script-docs/v5/language/type-system/#simple\">\u201csimple\u201d</a> or <a href=\"/pine-script-docs/v5/language/type-system/#series\">\u201cseries\u201d</a> colors is most often due to using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.rgb\">color.rgb()</a> functions. The qualifier of the color that they return is the strongest qualifier of the values passed to these functions. If each call to these functions passes only <a href=\"/pine-script-docs/v5/language/type-system/#const\">\u201cconst\u201d</a> or <a href=\"/pine-script-docs/v5/language/type-system/#input\">\u201cinput\u201d</a> values, the resulting colors are also <a href=\"/pine-script-docs/v5/language/type-system/#const\">\u201cconst\u201d</a> or <a href=\"/pine-script-docs/v5/language/type-system/#input\">\u201cinput\u201d</a>, and the script <em>does</em> display them in the \u201cStyles\u201d menu.</p>\n<aside aria-label=\"Warning\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Warning</span>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.from_gradient\">color.from_gradient()</a> function always returns a \u201cseries color\u201d value, regardless of the parameters passed to it. If it\u2019s used in a script, all that script\u2019s colors are calculated at runtime.</p></div></aside>\n<p>For example, let\u2019s try to make the plots in the script above semi-transparent by adding a transparency of <code dir=\"auto\">50</code> to its colors via <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a>. The easiest way to do this is to wrap the <code dir=\"auto\">plotColor</code> variable with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a>, like in the example below:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Color picker showcase\")\nplotColor = color.new(close &gt; open ? color.teal : color.red, 50)\nplot(close, color = plotColor)</div>\n<p>Unfortunately, with these changes the \u201cStyle\u201d tab does not display a color picker any longer. This is because we use the \u201cseries bool\u201d condition <code dir=\"auto\">close &gt; open</code> to decide the color, and then pass the result of this expression to a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a> call. The qualified type of the calculated color that it returns is \u201cseries color\u201d.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"810\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MaintainAutomaticColorSelection-2.BO3w97fq_14utEv.webp\" width=\"752\"/></p>\n<p><img alt=\"image\" decoding=\"async\" height=\"384\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MaintainAutomaticColorSelection-3.B0TUMw_p_Z2hnihX.webp\" width=\"1304\"/></p>\n<p>To avoid this, we can ensure that every calculated color created by <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a> is a \u201cconst color\u201d. Below, we wrap teal and red separately with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a> \u2013 creating two constant calculated colors in the process \u2013 and then decide which one to assign to <code dir=\"auto\">plotColor</code> based on the condition. And while the <code dir=\"auto\">plotColor</code> variable is a \u201cseries color\u201d, each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a> call returns a constant color, so the script displays a color picker n the \u201cStyle\u201d tab:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Color picker showcase\")\nplotColor = close &gt; open ? color.new(color.teal, 50) : color.new(color.red, 50)\nplot(close, color = plotColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"966\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-MaintainAutomaticColorSelection-4.B7QSrDzd_18UfnH.webp\" width=\"752\"/></p>\n<p>To calculate the colors at runtime, create custom color inputs for all of the colors that are to be editable. This approach requires more effort, but allows significantly more control over what the user can affect. Learn more about creating color inputs on the Inputs page.</p>\n<h3 class=\"md-heading\" id=\"designing-usable-colors-schemes\"><a href=\"#designing-usable-colors-schemes\">Designing usable colors schemes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If you write scripts intended for other traders, try to avoid colors that will not work well in some environments, whether it be for plots, labels, tables or fills. At a minimum, test your visuals to ensure they perform satisfactorily with both the light and dark TradingView themes; they are the most commonly used. Colors such as black and white, for example, should be avoided.</p>\n<p>Build the appropriate inputs to provide script users the flexibility to adapt your script\u2019s visuals to their particular environments.</p>\n<p>Take care to build a visual hierarchy of the colors you use that matches the relative importance of your script\u2019s visual components. Good designers understand how to achieve the optimal balance of color and weight so the eye is naturally drawn to the most important elements of the design. When you make everything stand out, nothing does. Make room for some elements to stand out by toning down the visuals surrounding it.</p>\n<p>Providing a selection of color presets in your inputs \u2014 rather than a single color that can be changed \u2014 can help color-challenged users. Our <a href=\"https://www.tradingview.com/script/Jdw7wW2g-Technical-Ratings/\">Technical Ratings</a> demonstrates one way of achieving this.</p>\n<h3 class=\"md-heading\" id=\"plot-crisp-lines\"><a href=\"#plot-crisp-lines\">Plot crisp lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It is best to use zero transparency to plot the important lines in your visuals, to keep them crisp. This way, they will show through fills more precisely. Keep in mind that fills have a higher z-index than plots, so they are placed on top of them. A slight increase of a line\u2019s width can also go a long way in making it stand out.</p>\n<p>If you want a special plot to stand out, you can also give it more importance by using multiple plots for the same line. These are examples where we modulate the successive width and transparency of plots to achieve this:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"206\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Colors-PlotCrispLines-1.CJkrlPd__Z1Me4S0.webp\" width=\"1794\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nplot(high, \"\", color.new(color.orange, 80), 8)\nplot(high, \"\", color.new(color.orange, 60), 4)\nplot(high, \"\", color.new(color.orange, 00), 1)\n\nplot(hl2, \"\", color.new(color.orange, 60), 4)\nplot(hl2, \"\", color.new(color.orange, 00), 1)\n\nplot(low, \"\", color.new(color.orange, 0), 1)</div>\n<h3 class=\"md-heading\" id=\"customize-gradients\"><a href=\"#customize-gradients\">Customize gradients<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When building gradients, adapt them to the visuals they apply to. If you are using a gradient to color candles, for example, it is usually best to limit the number of steps in the gradient to ten or less, as it is more difficult for the eye to perceive intensity variations of discrete objects. As we did in our examples, cap minimum and maximum transparency levels so your visual elements remain visible and do not overwhelm when it\u2019s not necessary.</p>", "segment_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "2c18951a9909fe44a644d9da69b35e001dcda3f26b6053e588a37cd48e2778d1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/fills", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"fills\"><a href=\"#fills\">Fills<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/fills", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Some of Pine Script\u2019s visual outputs, including\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">plots</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">hlines</a>, <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nallow one to fill the chart space they occupy with colors. Three\ndifferent mechanisms facilitate filling the space between such outputs:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction fills the space between two plots from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls or two horizontal lines (hlines) from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\ncalls with a specified color.</li>\n<li>Objects of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\ntype fill the space between\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstances created with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>.</li>\n<li>Other drawing types, namely\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>, have built-in properties that allow the drawings to\nfill the visual spaces they occupy.</li>\n</ul>", "segment_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/fills", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-and-hline-fills\"><a href=\"#plot-and-hline-fills\"><span>\u200b<code dir=\"auto\">plot()</code>\u200b and \u200b<code dir=\"auto\">hline()</code>\u200b fills</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction fills the space between two plots or horizontal lines. It has\nthe following two signatures:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">fill(plot1, plot2, color, title, editable, show_last, fillgaps) \u2192 void</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">fill(hline1, hline2, color, title, editable, fillgaps) \u2192 void</span></div></div></code></pre></figure></link></div>\n<p>The <code dir=\"auto\">plot1</code>, <code dir=\"auto\">plot2</code>, <code dir=\"auto\">hline1</code>, and <code dir=\"auto\">hline2</code> parameters accept\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">plot</a>\nor <a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">hline</a> IDs returned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfunction calls. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction is the only built-in that can use these IDs.</p>\n<p>This simple example demonstrates how the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction works with\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">plot and hline</a> IDs. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nthree times to display arbitrary values on the chart. Each of these\ncalls returns an ID, which the script assigns to variables for use in\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction. The values of <code dir=\"auto\">p1</code>, <code dir=\"auto\">p2</code>, and <code dir=\"auto\">p3</code> are \u201cplot\u201d IDs, whereas\n<code dir=\"auto\">h1</code>, <code dir=\"auto\">h2</code>, and <code dir=\"auto\">h3</code> reference \u201chline\u201d IDs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"627\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Fills-Fill-1.D9hBk6j5_24U1rL.webp\" width=\"1348\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 1\")\n\n// Assign \"plot\" IDs to the `p1`, `p2`, and `p3` variables.\np1 = plot(math.sin(high), \"Sine of `high`\")\np2 = plot(math.cos(low), \"Cosine of `low`\")\np3 = plot(math.sin(close), \"Sine of `close`\")\n// Fill the space between `p1` and `p2` with 90% transparent red.\nfill(p1, p3, color.new(color.red, 90), \"`p1`-`p3` fill\")\n// Fill the space between `p2` and `p3` with 90% transparent blue.\nfill(p2, p3, color.new(color.blue, 90), \"`p2`-`p3` fill\")\n\n// Assign \"hline\" IDs to the `h1`, `h2`, and `h3` variables.\nh1 = hline(0, \"First level\")\nh2 = hline(1.0, \"Second level\")\nh3 = hline(0.5, \"Third level\")\nh4 = hline(1.5, \"Fourth level\")\n// Fill the space between `h1` and `h2` with 90% transparent yellow.\nfill(h1, h2, color.new(color.yellow, 90), \"`h1`-`h2` fill\")\n// Fill the space between `h3` and `h4` with 90% transparent lime.\nfill(h3, h4, color.new(color.lime, 90), \"`h3`-`h4` fill\")</div>\n<p>It\u2019s important to note that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction requires <em>either</em> two \u201cplot\u201d IDs or two \u201chline\u201d IDs. One\n<em>cannot</em> mix and match these types in the function call. Consequently,\nprogrammers will sometimes need to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nwhere they otherwise might have used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nif they want to fill the space between a consistent level and a\nfluctuating series.</p>\n<p>For example, this script calculates an <code dir=\"auto\">oscillator</code> based on the\npercentage distance between the chart\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice and a 10-bar\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">SMA</a>,\nthen plots it on the chart pane. In this case, we wanted to fill the\narea between the <code dir=\"auto\">oscillator</code> and zero. Although we can display the zero\nlevel with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nsince its value does not change, we cannot pass a \u201cplot\u201d and \u201chline\u201d\nID to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction. Therefore, we must use a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall for the level to allow the script to fill the space:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"628\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Fills-Fill-2.DlLq_93-_g6Y93.webp\" width=\"1352\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 2\")\n\n//@variable The 10-bar moving average of `close` prices.\nfloat ma = ta.sma(close, 10)\n//@variable The distance from the `ma` to the `close` price, as a percentage of the `ma`.\nfloat oscillator = 100 * (ma - close) / ma\n\n//@variable The ID of the `oscillator` plot for use in the `fill()` function.\noscPlotID = plot(oscillator, \"Oscillator\")\n//@variable The ID of the zero level plot for use in the `fill()` function. \n//          Requires a \"plot\" ID since the `fill()` function can't use \"plot\" and \"hline\" IDs at the same time.\nzeroPlotID = plot(0, \"Zero level\", color.silver, 1, plot.style_circles)\n\n// Filll the space between the `oscPlotID` and `zeroPlotID` with 90% transparent blue. \nfill(oscPlotID, zeroPlotID, color.new(color.blue, 90), \"Oscillator fill\")</div>\n<p>The <code dir=\"auto\">color</code> parameter of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction accepts a \u201cseries color\u201d argument, meaning the fill\u2019s color\ncan change across chart bars. For example, this code fills the space\nbetween two moving average plots with 90% transparent green or red\ncolors based on whether <code dir=\"auto\">ma1</code> is above <code dir=\"auto\">ma2</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"632\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Fills-Fill-3.CN7oIx5s_1vmNq4.webp\" width=\"1352\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 3\", overlay = true)\n\n//@variable The 5-bar moving average of `close` prices.\nfloat ma1 = ta.sma(close, 5)\n//@variable The 20-bar moving average of `close` prices.\nfloat ma2 = ta.sma(close, 20)\n\n//@variable The 90% transparent color of the space between MA plots. Green if `ma1 &gt; ma2`, red otherwise. \ncolor fillColor = ma1 &gt; ma2 ? color.new(color.green, 90) : color.new(color.red, 90) \n\n//@variable The ID of the `ma1` plot for use in the `fill()` function.\nma1PlotID = plot(ma1, \"5-bar SMA\")\n//@variable The ID of the `ma2` plot for use in the `fill()` function.\nma2PlotID = plot(ma2, \"20-bar SMA\")\n\n// Fill the space between the `ma1PlotID` and `ma2PlotID` using the `fillColor`.\nfill(ma1PlotID, ma2PlotID, fillColor, \"SMA plot fill\")</div>", "segment_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/fills", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"line-fills\"><a href=\"#line-fills\">Line fills<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>While the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction allows a script to fill the space between two\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">plots or hlines</a>, it does not work with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nobjects. When a script needs to fill the space between\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, it\nrequires a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nobject created by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>\nfunction. The function has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">linefill.new(line1, line2, color) \u2192 series linefill</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">line1</code> and <code dir=\"auto\">line2</code> parameters accept\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nIDs. These IDs determine the chart region that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nobject will fill with its specified <code dir=\"auto\">color</code>. A script can update the\n<code dir=\"auto\">color</code> property of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nID returned by this function by calling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.set_color\">linefill.set_color()</a>\nwith the ID as its <code dir=\"auto\">id</code> argument.</p>\n<p>The behavior of linefills depends on the lines they reference. Scripts\ncannot move linefills directly, as the lines that a linefill uses\ndetermine the space it will fill. To retrieve the IDs of the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>\nreferenced by a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nobject, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.get_line1\">linefill.get_line1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.get_line2\">linefill.get_line2()</a>\nfunctions.</p>\n<p>Any pair of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstances can only have <em>one</em>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nbetween them. Successive calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>\nusing the same <code dir=\"auto\">line1</code> and <code dir=\"auto\">line2</code> arguments will create a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nID that <em>replaces</em> the previous one associated with them.</p>\n<p>The example below demonstrates a simple use case for linefills. The\nscript calculates a <code dir=\"auto\">pivotHigh</code> and <code dir=\"auto\">pivotLow</code> series using the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.pivothigh\">ta.pivothigh()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.pivotlow\">ta.pivotlow()</a>\nfunctions with constant <code dir=\"auto\">leftbars</code> and <code dir=\"auto\">rightbars</code> arguments. On the\nlast confirmed historical bar, the script draws two extended lines. The\nfirst line connects the two most recent non-na <code dir=\"auto\">pivotHigh</code> values, and\nthe second connects the most recent non-na <code dir=\"auto\">pivotLow</code> values.</p>\n<p>To emphasize the \u201cchannel\u201d formed by these lines, the script fills the\nspace between them using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"827\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Fills-Linefill-01.CW8L9l90_ZKe1QM.webp\" width=\"1600\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Linefill demo\", \"Channel\", true)\n\n//@variable The number bars to the left of a detected pivot.\nint LEFT_BARS = 15\n//@variable The number bars to the right for pivot confirmation. \nint RIGHT_BARS = 5\n\n//@variable The price of the pivot high point.\nfloat pivotHigh = ta.pivothigh(LEFT_BARS, RIGHT_BARS)\n//@variable The price of the pivot low point.\nfloat pivotLow = ta.pivotlow(LEFT_BARS, RIGHT_BARS)\n\n// Initialize the chart points the lines will use.\nvar firstHighPoint  = chart.point.new(na, na, na)\nvar secondHighPoint = chart.point.new(na, na, na)\nvar firstLowPoint   = chart.point.new(na, na, na)\nvar secondLowPoint  = chart.point.new(na, na, na)\n\n// Update the `firstHighPoint` and `secondHighPoint` when `pivotHigh` is not `na`.\nif not na(pivotHigh)\n    firstHighPoint  := secondHighPoint\n    secondHighPoint := chart.point.from_index(bar_index - RIGHT_BARS, pivotHigh)\n// Update the `firstLowPoint` and `secondLowPoint` when `pivotlow` is not `na`.\nif not na(pivotLow)\n    firstLowPoint  := secondLowPoint\n    secondLowPoint := chart.point.from_index(bar_index - RIGHT_BARS, pivotLow)\n\nif barstate.islastconfirmedhistory\n    //@variable An extended line that passes through the `firstHighPoint` and `secondHighPoint`.\n    line pivotHighLine = line.new(firstHighPoint, secondHighPoint, extend = extend.right)\n    //@variable An extended line that passes through the `firstLowPoint` and `secondLowPoint`.\n    line pivotLowLine = line.new(firstLowPoint, secondLowPoint, extend = extend.right)\n    //@variable The color of the space between the lines.\n    color fillColor = switch\n        secondHighPoint.price &gt; firstHighPoint.price and secondLowPoint.price &gt; firstLowPoint.price =&gt; color.lime\n        secondHighPoint.price &lt; firstHighPoint.price and secondLowPoint.price &lt; firstLowPoint.price =&gt; color.red\n        =&gt;                                                                                             color.silver\n    //@variable A linefill that colors the space between the `pivotHighLine` and `pivotLowLine`.\n    linefill channelFill = linefill.new(pivotHighLine, pivotLowLine, color.new(fillColor, 90))</div>", "segment_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/fills", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"box-and-polyline-fills\"><a href=\"#box-and-polyline-fills\">Box and polyline fills<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\ntypes allow scripts to draw geometric shapes and other formations on the\nchart. Scripts create\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>\nwith the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\nfunctions, which include parameters that allow the drawings to fill\ntheir visual spaces.</p>\n<p>To fill the space inside the borders of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nwith a specified color, include a <code dir=\"auto\">bgcolor</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nfunction. To fill a polyline\u2019s visual space, pass a <code dir=\"auto\">fill_color</code>\nargument to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\nfunction.</p>\n<p>For example, this script draws an octagon with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\nand an inscribed rectangle with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a> on\nthe last confirmed historical bar. It determines the size of the\ndrawings using the value from the <code dir=\"auto\">radius</code> variable, which corresponds\nto approximately one-fourth of the number of bars visible on the chart.\nWe included <code dir=\"auto\">fill_color = color.new(color.blue, 60)</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\ncall to fill the octagon with a translucent blue color, and we used\n<code dir=\"auto\">bgcolor = color.purple</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\ncall to fill the inscribed rectangle with opaque purple:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"554\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Fills-Box-and-polyline-fills-1.FVYvEaBt_1tmoyk.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Box and polyline fills demo\")\n\n//@variable The number of visible chart bars, excluding the leftmost and rightmost bars.\nvar int barCount = 0\nif time &gt; chart.left_visible_bar_time and time &lt; chart.right_visible_bar_time\n    barCount += 1\n\n//@variable The approximate radius used to calculate the octagon and rectangle coordinates.\nint radius = math.ceil(barCount / 4)\n\nif barstate.islastconfirmedhistory\n    //@variable An array of chart points. The polyline uses all points in this array, but the box only needs two.\n    array&lt;chart.point&gt; points = array.new&lt;chart.point&gt;()\n    //@variable The counterclockwise angle of each point, in radians. Updates on each loop iteration. \n    float angle = 0.0\n    //@variable The radians to add to the `angle` on each loop iteration.\n    float increment = 0.25 * math.pi\n    // Loop 8 times to calculate octagonal points.\n    for i = 0 to 7\n        //@variable The point's x-coordinate (bar offset).\n        int x = int(math.round(math.cos(angle) * radius))\n        //@variable The point's y-coordinate.\n        float y = math.round(math.sin(angle) * radius)\n        // Push a new chart point into the `points` array and increase the `angle`.\n        points.push(chart.point.from_index(bar_index - radius + x, y))\n        angle += increment\n    // Create a closed polyline to draw the octagon and fill it with translucent blue. \n    polyline.new(points, closed = true, fill_color = color.new(color.blue, 60))\n    // Create a box for the rectangle using index 3 and 7 for the top-left and bottom-right corners, \n    // and fill it with opaque purple. \n    box.new(points.get(3), points.get(7), bgcolor = color.purple)</div>\n<p>See this manual\u2019s\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">Lines and boxes</a> page\nto learn more about working with these types.</p>", "segment_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "b6fb537f45569b269dcaee2dc0b8fca046b6da1d5914e4477136b9d1c75c6b98", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/inputs\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"inputs\"><a href=\"#inputs\">Inputs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Inputs receive values that users can change from a script\u2019s\n\u201cSettings/Inputs\u201d tab. By utilizing inputs, programmers can write\nscripts that users can more easily adapt to their preferences.</p>\n<p>The following script plots a 20-period <a href=\"https://www.tradingview.com/support/solutions/43000502589\">simple moving average\n(SMA)</a> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(close,\n20)</a>.\nWhile it is straightforward to write, the code is not very <em>flexible</em>\nbecause the function call uses specific <code dir=\"auto\">source</code> and <code dir=\"auto\">length</code> arguments\nthat users cannot change without modifying the code:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nplot(ta.sma(close, 20))</div>\n<p>If we write our script this way instead, it becomes much more flexible,\nas users can select the <code dir=\"auto\">source</code> and the <code dir=\"auto\">length</code> values they want to\nuse from the \u201cSettings/Inputs\u201d tab without changing the source code:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nsourceInput = input(close, \"Source\")\nlengthInput = input(20, \"Length\")\nplot(ta.sma(sourceInput, lengthInput))</div>\n<p>Inputs are only accessible while a script runs on a chart. Users can\naccess script inputs from the \u201cSettings\u201d dialog box. To open this\ndialog, users can:</p>\n<ul>\n<li>Double-click on the name of an on-chart indicator</li>\n<li>Right-click on the script\u2019s name and choose the \u201cSettings\u201d item\nfrom the dropdown menu</li>\n<li>Choose the \u201cSettings\u201d item from the \u201cMore\u201d menu icon (three\ndots) that appears when hovering over the indicator\u2019s name on the\nchart</li>\n<li>Double-click on the indicator\u2019s name from the Data Window (fourth\nicon down to the right of the chart)</li>\n</ul>\n<p>The \u201cSettings\u201d dialog always contains the \u201cStyle\u201d and \u201cVisibility\u201d\ntabs, which allow users to specify their preferences about the script\u2019s\nvisuals and the chart timeframes that can display its outputs.</p>\n<p>When a script contains calls to <code dir=\"auto\">input.*()</code> functions, an \u201cInputs\u201d tab\nalso appears in the \u201cSettings\u201d dialog box.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1052\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-Introduction-1.CNd-sZxz_2qJffB.webp\" width=\"2356\"/></p>\n<p>Scripts process inputs when users add them to the chart or change the\nvalues in the script\u2019s \u201cSettings/Inputs\u201d tab. Any changes to a\nscript\u2019s inputs prompt it to re-execute across all available data using\nthe new specified values.</p>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"input-functions\"><a href=\"#input-functions\">Input functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae features the following input functions:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input\">input()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.float\">input.float()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.bool\">input.bool()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.color\">input.color()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.string\">input.string()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.text_area\">input.text_area()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.timeframe\">input.timeframe()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.symbol\">input.symbol()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.price\">input.price()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.session\">input.session()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a></li>\n</ul>\n<p>Scripts create input <em>widgets</em> in the \u201cInputs\u201d tab that accept\ndifferent types of inputs based on their <code dir=\"auto\">input.*()</code> function calls. By\ndefault, each input appears on a new line of the \u201cInputs\u201d tab in the\norder of the <code dir=\"auto\">input.*()</code> calls. Programmers can also organize inputs in\ndifferent ways by using the <code dir=\"auto\">input.*()</code> functions\u2019 <code dir=\"auto\">group</code> and <code dir=\"auto\">inline</code>\nparameters. See <a href=\"/pine-script-docs/v5/concepts/inputs/#input-function-parameters\">this section</a> below for more information.</p>\n<p>Our <a href=\"/pine-script-docs/v5/writing/style-guide/#style-guide\">Style guide</a>\nrecommends placing <code dir=\"auto\">input.*()</code> calls at the beginning of the script.</p>\n<p>Input functions typically contain several parameters that allow\nprogrammers to define their default values, value limits, their\norganization in the \u201cInputs\u201d tab, and other properties.</p>\n<p>Since an <code dir=\"auto\">input.*()</code> call is simply another function call in Pine\nScript, programmers can combine them with\n<a href=\"/pine-script-docs/v5/language/operators/#arithmetic-operators\">arithmetic</a>, <a href=\"/pine-script-docs/v5/language/operators/#comparison-operators\">comparison</a>,\n<a href=\"/pine-script-docs/v5/language/operators/#logical-operators\">logical</a>, and\n<a href=\"/pine-script-docs/v5/language/operators/#-ternary-operator\">ternary</a>\noperators to assign expressions to variables. This simple script\ncompares the result from a call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.string\">input.string()</a>\nto the \u201cOn\u201d string and assigns the result to the <code dir=\"auto\">plotDisplayInput</code>\nvariable. This variable is of the \u201cinput bool\u201d type because the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_==\">==</a>\noperator returns a \u201cbool\u201d value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Input in an expression`\", \"\", true)\nbool plotDisplayInput = input.string(\"On\", \"Plot Display\", options = [\"On\", \"Off\"]) == \"On\"\nplot(plotDisplayInput ? close : na)</div>\n<p>All values returned by <code dir=\"auto\">input.*()</code> functions except \u201csource\u201d ones are\n\u201cinput\u201d qualified values. See our User Manual\u2019s section on\n<a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">type qualifiers</a> for more information.</p>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"input-function-parameters\"><a href=\"#input-function-parameters\">Input function parameters<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The parameters common to all input functions are: <code dir=\"auto\">defval</code>, <code dir=\"auto\">title</code>,\n<code dir=\"auto\">tooltip</code>, <code dir=\"auto\">inline</code>, <code dir=\"auto\">group</code>, and <code dir=\"auto\">display</code>. Some input functions also\ninclude other parameters: <code dir=\"auto\">options</code>, <code dir=\"auto\">minval</code>, <code dir=\"auto\">maxval</code>, <code dir=\"auto\">step</code> and\n<code dir=\"auto\">confirm</code>.</p>\n<p>All these parameters expect \u201cconst\u201d arguments. The only exceptions are\nfor the <code dir=\"auto\">defval</code> and <code dir=\"auto\">options</code> parameters of the <a href=\"/pine-script-docs/v5/concepts/inputs/#source-input\">source</a>\nand <a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">enum</a>\ninputs, as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a>\nuses \u201cseries float\u201d value, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nuses <em>members</em> of an <a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">enum type</a>.</p>\n<p>Since <code dir=\"auto\">input.*()</code> parameters accept \u201cconst\u201d arguments in most cases\nand the \u201cinput\u201d and other\n<a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">qualifiers</a>\nare stronger than \u201cconst\u201d, it follows that one cannot use the result\nfrom one <code dir=\"auto\">input.*()</code> call as an argument in another <code dir=\"auto\">input.*()</code> call.</p>\n<p>Let\u2019s go over each parameter:</p>\n<ul>\n<li><code dir=\"auto\">defval</code> is the first parameter of all input functions. It is the\ndefault value that appears in the input widget. It requires an\nargument of the type of input value that the function applies to.</li>\n<li><code dir=\"auto\">title</code> requires a \u201cconst string\u201d argument. It is the field\u2019s\nlabel.</li>\n<li><code dir=\"auto\">tooltip</code> requires a \u201cconst string\u201d argument. When the parameter\nis used, a question mark icon will appear to the right of the field.\nWhen users hover over it, the tooltip\u2019s text will appear. Note that\nif multiple input fields are grouped on one line using <code dir=\"auto\">inline</code>, the\ntooltip will always appear to the right of the rightmost field, and\ndisplay the text of the last <code dir=\"auto\">tooltip</code> argument used in the line.\nNewlines (<code dir=\"auto\">\\n</code>) are supported in the argument string.</li>\n<li><code dir=\"auto\">inline</code> requires a \u201cconst string\u201d argument. Using the same\nargument for the parameter in multiple <code dir=\"auto\">input.*()</code> calls will group\ntheir input widgets on the same line. There is a limit to the width\nthe \u201cInputs\u201d tab will expand, so a limited quantity of input\nfields can be fitted on one line. Using one <code dir=\"auto\">input.*()</code> call with a\nunique argument for <code dir=\"auto\">inline</code> has the effect of bringing the input\nfield left, immediately after the label, foregoing the default\nleft-alignment of all input fields used when no <code dir=\"auto\">inline</code> argument is\nused.</li>\n<li><code dir=\"auto\">group</code> requires a \u201cconst string\u201d argument. Use it to group any\nnumber of inputs in an organized section. The string used as the\n<code dir=\"auto\">group</code> argument becomes the section\u2019s heading. All <code dir=\"auto\">input.*()</code>\ncalls to be grouped together must use the same string for their\n<code dir=\"auto\">group</code> argument.</li>\n<li><code dir=\"auto\">options</code> requires a comma-separated list of elements enclosed in\nsquare brackets (e.g., <code dir=\"auto\">[\"ON\", \"OFF\"]</code>, <code dir=\"auto\">[1, 2, 3]</code>,\n<code dir=\"auto\">[myEnum.On, myEnum.Off]</code>). The input uses the specified elements as\nmenu selections in its resulting dropdown widget. Users can only\nselect one menu item at a time. When supplying an <code dir=\"auto\">options</code> list,\nthe <code dir=\"auto\">defval</code> value must be one of the list\u2019s elements. Inputs that\nallow <code dir=\"auto\">minval</code>, <code dir=\"auto\">maxval</code>, or <code dir=\"auto\">step</code> parameters cannot use those\nparameters and the <code dir=\"auto\">options</code> parameter simultaneously.</li>\n<li><code dir=\"auto\">minval</code> requires a \u201cconst int/float\u201d argument, depending on the\ntype of the <code dir=\"auto\">defval</code> value. It is the minimum valid value for the\ninput field.</li>\n<li><code dir=\"auto\">maxval</code> requires a \u201cconst int/float\u201d argument, depending on the\ntype of the <code dir=\"auto\">defval</code> value. It is the maximum valid value for the\ninput field.</li>\n<li><code dir=\"auto\">step</code> is the increment by which the field\u2019s value will move when\nthe widget\u2019s up/down arrows are used.</li>\n<li><code dir=\"auto\">confirm</code> requires a \u201cconst bool\u201d (<code dir=\"auto\">true</code> or <code dir=\"auto\">false</code>) argument.\nThis parameter affects the behavior of the script when it is added\nto a chart. <code dir=\"auto\">input.*()</code> calls using <code dir=\"auto\">confirm = true</code> will cause the\n\u201cSettings/Inputs\u201d tab to popup when the script is added to the\nchart. <code dir=\"auto\">confirm</code> is useful to ensure that users configure a\nparticular field.</li>\n</ul>\n<p>The <code dir=\"auto\">minval</code>, <code dir=\"auto\">maxval</code> and <code dir=\"auto\">step</code> parameters are only present in the\nsignature of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.float\">input.float()</a>\nfunctions.</p>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"input-types\"><a href=\"#input-types\">Input types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The next sections explain what each input function does. As we proceed,\nwe will explore the different ways you can use input functions and\norganize their display.</p>\n<h3 class=\"md-heading\" id=\"generic-input\"><a href=\"#generic-input\">Generic input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input\">input()</a>\nis a simple, generic function that supports the fundamental Pine Script\ntypes: \u201cint\u201d, \u201cfloat\u201d, \u201cbool\u201d, \u201ccolor\u201d and \u201cstring\u201d. It also\nsupports \u201csource\u201d inputs, which are price-related values such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#hl2\">hl2</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlcc4\">hlcc4</a>,\nor which can be used to receive the output value of another script.</p>\n<p>Its signature is:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">input(defval, title, tooltip, inline, group) \u2192 input int/float/bool/color/string | series float</span></div></div></code></pre></figure></link></div>\n<p>The function automatically detects the type of input by analyzing the\ntype of the <code dir=\"auto\">defval</code> argument used in the function call. This script\nshows all the supported types and the qualified type returned by the\nfunction when used with <code dir=\"auto\">defval</code> arguments of different types:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`input()`\", \"\", true)\na = input(1, \"input int\")\nb = input(1.0, \"input float\")\nc = input(true, \"input bool\")\nd = input(color.orange, \"input color\")\ne = input(\"1\", \"input string\")\nf = input(close, \"series float\")\nplot(na)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"782\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-01.Cq1mAVhd_Z1FJl78.webp\" width=\"616\"/></p>\n<h3 class=\"md-heading\" id=\"integer-input\"><a href=\"#integer-input\">Integer input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Two signatures exist for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\nfunction; one when <code dir=\"auto\">options</code> is not used, the other when it is:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">input.int(defval, title, minval, maxval, step, tooltip, inline, group, confirm) \u2192 input int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">input.int(defval, title, options, tooltip, inline, group, confirm) \u2192 input int</span></div></div></code></pre></figure></div>\n<p>This call uses the <code dir=\"auto\">options</code> parameter to propose a pre-defined list of\nlengths for the MA:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nmaLengthInput = input.int(10, options = [3, 5, 7, 10, 14, 20, 50, 100, 200])\nma = ta.sma(close, maLengthInput)\nplot(ma)</div>\n<p>This one uses the <code dir=\"auto\">minval</code> parameter to limit the length:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nmaLengthInput = input.int(10, minval = 2)\nma = ta.sma(close, maLengthInput)\nplot(ma)</div>\n<p>The version with the <code dir=\"auto\">options</code> list uses a dropdown menu for its widget.\nWhen the <code dir=\"auto\">options</code> parameter is not used, a simple input widget is used\nto enter the value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"826\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-02.CZ6pYgBC_2jU4nO.webp\" width=\"1936\"/></p>\n<h3 class=\"md-heading\" id=\"float-input\"><a href=\"#float-input\">Float input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Two signatures exist for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.float\">input.float()</a>\nfunction; one when <code dir=\"auto\">options</code> is not used, the other when it is:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">input.float(defval, title, minval, maxval, step, tooltip, inline, group, confirm) \u2192 input int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">input.float(defval, title, options, tooltip, inline, group, confirm) \u2192 input int</span></div></div></code></pre></figure></div>\n<p>Here, we use a \u201cfloat\u201d input for the factor used to multiple the\nstandard deviation, to calculate Bollinger Bands:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nmaLengthInput = input.int(10, minval = 1)\nbbFactorInput = input.float(1.5, minval = 0, step = 0.5)\nma      = ta.sma(close, maLengthInput)\nbbWidth = ta.stdev(ma, maLengthInput) * bbFactorInput\nbbHi    = ma + bbWidth\nbbLo    = ma - bbWidth\nplot(ma)\nplot(bbHi, \"BB Hi\", color.gray)\nplot(bbLo, \"BB Lo\", color.gray)</div>\n<p>The input widgets for floats are similar to the ones used for integer\ninputs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"670\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-03.3O4JqasJ_ALMjG.webp\" width=\"1748\"/></p>\n<h3 class=\"md-heading\" id=\"boolean-input\"><a href=\"#boolean-input\">Boolean input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Let\u2019s continue to develop our script further, this time by adding a\nboolean input to allow users to toggle the display of the BBs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"674\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-04.BsSpKR3Q_Za4RlV.webp\" width=\"1746\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nmaLengthInput = input.int(10,    \"MA length\", minval = 1)\nbbFactorInput = input.float(1.5, \"BB factor\", inline = \"01\", minval = 0, step = 0.5)\nshowBBInput   = input.bool(true, \"Show BB\",   inline = \"01\")\nma      = ta.sma(close, maLengthInput)\nbbWidth = ta.stdev(ma, maLengthInput) * bbFactorInput\nbbHi    = ma + bbWidth\nbbLo    = ma - bbWidth\nplot(ma, \"MA\", color.aqua)\nplot(showBBInput ? bbHi : na, \"BB Hi\", color.gray)\nplot(showBBInput ? bbLo : na, \"BB Lo\", color.gray)</div>\n<p>Note that:</p>\n<ul>\n<li>We have added an input using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.bool\">input.bool()</a>\nto set the value of <code dir=\"auto\">showBBInput</code>.</li>\n<li>We use the <code dir=\"auto\">inline</code> parameter in that input and in the one for\n<code dir=\"auto\">bbFactorInput</code> to bring them on the same line. We use <code dir=\"auto\">\"01\"</code> for\nits argument in both cases. That is how the Pine Script compiler\nrecognizes that they belong on the same line. The particular string\nused as an argument is unimportant and does not appear anywhere in\nthe \u201cInputs\u201d tab; it is only used to identify which inputs go on\nthe same line.</li>\n<li>We have vertically aligned the <code dir=\"auto\">title</code> arguments of our <code dir=\"auto\">input.*()</code>\ncalls to make them easier to read.</li>\n<li>We use the <code dir=\"auto\">showBBInput</code> variable in our two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls to plot conditionally. When the user unchecks the checkbox of\nthe <code dir=\"auto\">showBBInput</code> input, the variable\u2019s value becomes <code dir=\"auto\">false</code>. When\nthat happens, our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls plot the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalue, which displays nothing. We use <code dir=\"auto\">true</code> as the default value of\nthe input, so the BBs plot by default.</li>\n<li>Because we use the <code dir=\"auto\">inline</code> parameter for the <code dir=\"auto\">bbFactorInput</code>\nvariable, its input field in the \u201cInputs\u201d tab does not align\nvertically with that of <code dir=\"auto\">maLengthInput</code>, which doesn\u2019t use\n<code dir=\"auto\">inline</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"color-input\"><a href=\"#color-input\">Color input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>As explained in\n<a href=\"/pine-script-docs/v5/concepts/colors/#maintaining-automatic-color-selectors\">this</a> section of the <a href=\"/pine-script-docs/v5/concepts/colors/\">Colors</a> page, selecting the colors of a script\u2019s outputs via the\n\u201cSettings/Style\u201d tab is not always possible. In the case where one\ncannot choose colors from the \u201cStyle\u201d tab, programmers can create\ncolor inputs with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.color\">input.color()</a>\nfunction to allow color customization from the \u201cSettings/Inputs\u201d tab.</p>\n<p>Suppose we wanted to plot our BBs with a ligther transparency when the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues are higher/lower than the BBs. We can use a code like this to\ncreate the colors:</p>\n<div class=\"pine-colorizer not-content\">bbHiColor = color.new(color.gray, high &gt; bbHi ? 60 : 0)\nbbLoColor = color.new(color.gray, low  &lt; bbLo ? 60 : 0)</div>\n<p>When using dynamic (\u201cseries\u201d) color components like the <code dir=\"auto\">transp</code>\narguments in the above code, the color widgets in the \u201cSettings/Style\u201d\ntab will no longer appear. Let\u2019s create our own input for color\nselection, which will appear in the \u201cSettings/Inputs\u201d tab:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"676\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-05.D_uuADST_ZadKOP.webp\" width=\"1748\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\nmaLengthInput = input.int(10,           \"MA length\", inline = \"01\", minval = 1)\nmaColorInput  = input.color(color.aqua, \"\",          inline = \"01\")\nbbFactorInput = input.float(1.5,        \"BB factor\", inline = \"02\", minval = 0, step = 0.5)\nbbColorInput  = input.color(color.gray, \"\",          inline = \"02\")\nshowBBInput   = input.bool(true,        \"Show BB\",   inline = \"02\")\nma      = ta.sma(close, maLengthInput)\nbbWidth = ta.stdev(ma, maLengthInput) * bbFactorInput\nbbHi    = ma + bbWidth\nbbLo    = ma - bbWidth\nbbHiColor = color.new(bbColorInput, high &gt; bbHi ? 60 : 0)\nbbLoColor = color.new(bbColorInput, low  &lt; bbLo ? 60 : 0)\nplot(ma, \"MA\", maColorInput)\nplot(showBBInput ? bbHi : na, \"BB Hi\", bbHiColor, 2)\nplot(showBBInput ? bbLo : na, \"BB Lo\", bbLoColor, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>We have added two calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.color\">input.color()</a>\nto gather the values of the <code dir=\"auto\">maColorInput</code> and <code dir=\"auto\">bbColorInput</code>\nvariables. We use <code dir=\"auto\">maColorInput</code> directly in the\n<code dir=\"auto\">plot(ma, \"MA\", maColorInput)</code> call, and we use <code dir=\"auto\">bbColorInput</code> to\nbuild the <code dir=\"auto\">bbHiColor</code> and <code dir=\"auto\">bbLoColor</code> variables, which modulate the\ntransparency using the position of price relative to the BBs. We use\na conditional value for the <code dir=\"auto\">transp</code> value we call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a>\nwith, to generate different transparencies of the same base color.</li>\n<li>We do not use a <code dir=\"auto\">title</code> argument for our new color inputs because\nthey are on the same line as other inputs allowing users to\nunderstand to which plots they apply.</li>\n<li>We have reorganized our <code dir=\"auto\">inline</code> arguments so they reflect the fact\nwe have inputs grouped on two distinct lines.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"timeframe-input\"><a href=\"#timeframe-input\">Timeframe input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Timeframe inputs can be useful when you want to be able to change the\ntimeframe used to calculate values in your scripts.</p>\n<p>Let\u2019s do away with our BBs from the previous sections and add a\ntimeframe input to a simple MA script:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1122\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-06.BvUY6GL6_Z14lcBY.webp\" width=\"1752\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\ntfInput = input.timeframe(\"D\", \"Timeframe\")\nma = ta.sma(close, 20)\nsecurityNoRepaint(sym, tf, src) =&gt;\n    request.security(sym, tf, src[barstate.isrealtime ? 1 : 0])[barstate.isrealtime ? 0 : 1]\nmaHTF = securityNoRepaint(syminfo.tickerid, tfInput, ma)\nplot(maHTF, \"MA\", color.aqua)</div>\n<p>Note that:</p>\n<ul>\n<li>We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.timeframe\">input.timeframe()</a>\nfunction to receive the timeframe input.</li>\n<li>The function creates a dropdown widget where some standard\ntimeframes are proposed. The list of timeframes also includes any\nyou have favorated in the chart user interface.</li>\n<li>We use the <code dir=\"auto\">tfInput</code> in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall. We also use <code dir=\"auto\">gaps = barmerge.gaps_on</code> in the call, so the\nfunction only returns data when the higher timeframe has completed.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"symbol-input\"><a href=\"#symbol-input\">Symbol input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.symbol\">input.symbol()</a>\nfunction creates a widget that allows users to search and select symbols\nlike they would from the chart\u2019s user interface.</p>\n<p>Let\u2019s add a symbol input to our script:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true)\ntfInput = input.timeframe(\"D\", \"Timeframe\")\nsymbolInput = input.symbol(\"\", \"Symbol\")\nma = ta.sma(close, 20)\nsecurityNoRepaint(sym, tf, src) =&gt;\n    request.security(sym, tf, src[barstate.isrealtime ? 1 : 0])[barstate.isrealtime ? 0 : 1]\nmaHTF = securityNoRepaint(symbolInput, tfInput, ma)\nplot(maHTF, \"MA\", color.aqua)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">defval</code> argument we use is an empty string. This causes\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\nwhere we use the <code dir=\"auto\">symbolInput</code> variable containing that input, to\nuse the chart\u2019s symbol by default. If the user selects another\nsymbol and wants to return to the default value using the chart\u2019s\nsymbol, he will need to use the \u201cReset Settings\u201d selection from\nthe \u201cInputs\u201d tab\u2019s \u201cDefaults\u201d menu.</li>\n<li>We use the <code dir=\"auto\">securityNoRepaint()</code> user-defined function to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nin such a way that it does not repaint; it only returns values when\nthe higher timeframe has completed.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"session-input\"><a href=\"#session-input\">Session input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Session inputs are useful to gather start-stop values for periods of\ntime. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.session\">input.session()</a>\nbuilt-in function creates an input widget allowing users to specify the\nbeginning and end time of a session. Selections can be made using a\ndropdown menu, or by entering time values in \u201chh:mm\u201d format.</p>\n<p>The value returned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.session\">input.session()</a>\nis a valid string in session format. See the manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/sessions/\">sessions</a> for more\ninformation.</p>\n<p>Session information can also contain information on the days where the\nsession is valid. We use an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.string\">input.string()</a>\nfunction call here to input that day information:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Session input\", \"\", true)\nstring sessionInput = input.session(\"0600-1700\", \"Session\")\nstring daysInput = input.string(\"1234567\", tooltip = \"1 = Sunday, 7 = Saturday\")\nsessionString = sessionInput + \":\" + daysInput\ninSession = not na(time(timeframe.period, sessionString))\nbgcolor(inSession ? color.silver : na)</div>\n<p>Note that:</p>\n<ul>\n<li>This script proposes a default session of \u201c0600-1700\u201d.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.string\">input.string()</a>\ncall uses a tooltip to provide users with help on the format to use\nto enter day information.</li>\n<li>A complete session string is built by concatenating the two strings\nthe script receives as inputs.</li>\n<li>We explicitly declare the type of our two inputs with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeyword to make it clear those variables will contain a string.</li>\n<li>We detect if the chart bar is in the user-defined session by calling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nwith the session string. If the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nvalue (the time at the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>)\nis not in the session,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nreturns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nso <code dir=\"auto\">inSession</code> will be <code dir=\"auto\">true</code> whenever\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nreturns a value that is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"670\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-07.DBQQqMr6_15fqiC.webp\" width=\"1276\"/></p>\n<h3 class=\"md-heading\" id=\"source-input\"><a href=\"#source-input\">Source input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Source inputs are useful to provide a selection of two types of sources:</p>\n<ul>\n<li>Price values, namely:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>.</li>\n<li>The values plotted by other scripts on the chart. This can be useful\nto \u201clink\u201d two or more scripts together by sending the output of\none as an input to another script.</li>\n</ul>\n<p>This script simply plots the user\u2019s selection of source. We propose the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nas the default value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Source input\", \"\", true)\nsrcInput = input.source(high, \"Source\")\nplot(srcInput, \"Src\", color.new(color.purple, 70), 6)</div>\n<p>This shows a chart where, in addition to our script, we have loaded an\n\u201cArnaud Legoux Moving Average\u201d indicator. See here how we use our\nscript\u2019s source input widget to select the output of the ALMA script as\nan input into our script. Because our script plots that source in a\nlight-purple thick line, you see the plots from the two scripts overlap\nbecause they plot the same value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"820\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-InputTypes-08.SH4c1RFT_1XVzNK.webp\" width=\"1747\"/></p>\n<h3 class=\"md-heading\" id=\"time-input\"><a href=\"#time-input\">Time input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Time inputs use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a>\nfunction. The function returns a Unix time in milliseconds (see the\n<a href=\"/pine-script-docs/v5/concepts/time/\">Time</a> page for more\ninformation). This type of data also contains date information, so the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a>\nfunction returns a time <strong>and</strong> a date. That is the reason why its\nwidget allows for the selection of both.</p>\n<p>Here, we test the bar\u2019s time against an input value, and we plot an\narrow when it is greater:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Time input\", \"T\", true)\ntimeAndDateInput = input.time(timestamp(\"1 Aug 2021 00:00 +0300\"), \"Date and time\")\nbarIsLater = time &gt; timeAndDateInput\nplotchar(barIsLater, \"barIsLater\", \"\ud83e\udc06\", location.top, size = size.tiny)</div>\n<p>Note that the <code dir=\"auto\">defval</code> value we use is a call to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a>\nfunction.</p>\n<h3 class=\"md-heading\" id=\"enum-input\"><a href=\"#enum-input\">Enum input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nfunction creates a dropdown input that displays <em>field titles</em>\ncorresponding to distinct <em>members</em> (possible values) of an\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>. The function returns one of the unique, named values from a\ndeclared <a href=\"/pine-script-docs/v5/language/enums/\">enum</a>, which scripts\ncan use in calculations and logic requiring more strict control over\nallowed values and operations. Supply a list of enum members to the\n<code dir=\"auto\">options</code> parameter to specify the members users can select from the\ndropdown. If one does not specify an enum field\u2019s title, its title is\nthe \u201cstring\u201d representation of its <em>name</em>.</p>\n<p>This example declares a <code dir=\"auto\">SignalType</code> enum with four fields representing\nnamed signal display modes: <code dir=\"auto\">long</code>, <code dir=\"auto\">short</code>, <code dir=\"auto\">both</code>, and <code dir=\"auto\">none</code>. The\nscript uses a member of this\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a> as the <code dir=\"auto\">defval</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\ncall to generate a dropdown in the \u201cInputs\u201d tab, allowing users to\nselect one of the enum\u2019s titles to control which signals it displays on\nthe chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-Input-types-Enum-input-1.D56ry8Yz_4z6vc.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Enum input demo\", overlay = true)\n\n//@enum         An enumeration of named values representing signal display modes.\n//@field long   Named value to specify that only long signals are allowed.\n//@field short  Named value to specify that only short signals are allowed.\n//@field both   Named value to specify that either signal type is allowed.\n//@field none   Named value to specify that no signals are allowed. \nenum SignalType\n    long  = \"Only long signals\"\n    short = \"Only short signals\"\n    both  = \"Long and short signals\"\n    none \n\n//@variable An enumerator (member) of the `SignalType` enum. Controls the script's signals. \nSignalType sigInput = input.enum(SignalType.long, \"Signal type\")\n\n// Calculate moving averages.\nfloat ma1 = ta.sma(ohlc4, 10)\nfloat ma2 = ta.sma(ohlc4, 200)\n// Calculate cross signals. \nbool longCross  = ta.crossover(close, math.max(ma1, ma2))\nbool shortCross = ta.crossunder(close, math.min(ma1, ma2))\n// Calculate long and short signals based on the selected `sigInput` value.\nbool longSignal = (sigInput == SignalType.long or sigInput == SignalType.both) and longCross\nbool shortSignal = (sigInput == SignalType.short or sigInput == SignalType.both) and shortCross\n\n// Plot shapes for the `longSignal` and `shortSignal`.\nplotshape(longSignal, \"Long signal\", shape.triangleup, location.belowbar, color.teal, size = size.normal)\nplotshape(shortSignal, \"Short signal\", shape.triangledown, location.abovebar, color.maroon, size = size.normal)\n// Plot the moving averages.\nplot(ma1, \"Fast MA\")\nplot(ma2, \"Slow MA\") </div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">sigInput</code> value is the <code dir=\"auto\">SignalType</code> member whose field\ncontains the selected title.</li>\n<li>Since we did not specify a title for the <code dir=\"auto\">none</code> field of the\nenum, its title is the \u201cstring\u201d representation of its name\n(\u201cnone\u201d), as we see in the above image of the enum input\u2019s\ndropdown.</li>\n</ul>\n<p>By default, an enum input displays the titles of all an enum\u2019s members\nwithin its dropdown. If we supply an <code dir=\"auto\">options</code> argument to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\ncall, it will only allow users to select the members included in that\nlist, e.g.:</p>\n<div class=\"pine-colorizer not-content\">SignalType sigInput = input.enum(SignalType.long, \"Signal type\", options = [SignalType.long, SignalType.short])</div>\n<p>The above <code dir=\"auto\">options</code> argument specifies that users can only view and\nselect the titles of the <code dir=\"auto\">long</code> and <code dir=\"auto\">short</code> fields from the <code dir=\"auto\">SignalType</code>\nenum. No other options are allowed:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"568\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-Input-types-Enum-input-2.DoT-LWc3_nngA2.webp\" width=\"1338\"/></p>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"other-features-affecting-inputs\"><a href=\"#other-features-affecting-inputs\">Other features affecting Inputs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Some parameters of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">strategy()</a>\nfunctions populate a script\u2019s \u201cSettings/Inputs\u201d tab with additional\ninputs. These parameters are <code dir=\"auto\">timeframe</code>, <code dir=\"auto\">timeframe_gaps</code>, and\n<code dir=\"auto\">calc_bars_count</code>. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MA\", \"\", true, timeframe = \"D\", timeframe_gaps = false)\nplot(ta.vwma(close, 10))</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"634\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-OtherFeaturesAffectingInputs-03.BtNE-F7g_ecT8G.webp\" width=\"1748\"/></p>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/inputs", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tips\"><a href=\"#tips\">Tips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The design of your script\u2019s inputs has an important impact on the\nusability of your scripts. Well-designed inputs are more intuitively\nusable and make for a better user experience:</p>\n<ul>\n<li>Choose clear and concise labels (your input\u2019s <code dir=\"auto\">title</code> argument).</li>\n<li>Choose your default values carefully.</li>\n<li>Provide <code dir=\"auto\">minval</code> and <code dir=\"auto\">maxval</code> values that will prevent your code\nfrom producing unexpected results, e.g., limit the minimal value of\nlengths to 1 or 2, depending on the type of MA you are using.</li>\n<li>Provide a <code dir=\"auto\">step</code> value that is congruent with the value you are\ncapturing. Steps of 5 can be more useful on a 0-200 range, for\nexample, or steps of 0.05 on a 0.0-1.0 scale.</li>\n<li>Group related inputs on the same line using <code dir=\"auto\">inline</code>; bull and bear\ncolors for example, or the width and color of a line.</li>\n<li>When you have many inputs, group them into meaningful sections using\n<code dir=\"auto\">group</code>. Place the most important sections at the top.</li>\n<li>Do the same for individual inputs <strong>within</strong> sections.</li>\n</ul>\n<p>It can be advantageous to vertically align different arguments of\nmultliple <code dir=\"auto\">input.*()</code> calls in your code. When you need to make global\nchanges, this will allow you to use the Editor\u2019s multi-cursor feature\nto operate on all the lines at once.</p>\n<p>Because It is sometimes necessary to use Unicode spaces to In order to\nachieve optimal alignment in inputs. This is an example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Aligned inputs\", \"\", true)\n\nvar GRP1 = \"Not aligned\"\nma1SourceInput   = input(close, \"MA source\",     inline = \"11\", group = GRP1)\nma1LengthInput   = input(close, \"Length\",        inline = \"11\", group = GRP1)\nlong1SourceInput = input(close, \"Signal source\", inline = \"12\", group = GRP1)\nlong1LengthInput = input(close, \"Length\",        inline = \"12\", group = GRP1)\n\nvar GRP2 = \"Aligned\"\n// The three spaces after \"MA source\" are Unicode EN spaces (U+2002).\nma2SourceInput   = input(close, \"MA source\u2002\u2002\u2002\",  inline = \"21\", group = GRP2)\nma2LengthInput   = input(close, \"Length\",        inline = \"21\", group = GRP2)\nlong2SourceInput = input(close, \"Signal source\", inline = \"22\", group = GRP2)\nlong2LengthInput = input(close, \"Length\",        inline = \"22\", group = GRP2)\n\nplot(ta.vwma(close, 10))</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"946\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Inputs-Tips-1.DU-DannF_Eodj8.webp\" width=\"1752\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We use the <code dir=\"auto\">group</code> parameter to distinguish between the two sections\nof inputs. We use a constant to hold the name of the groups. This\nway, if we decide to change the name of the group, we only need to\nchange it in one place.</li>\n<li>The first sections inputs widgets do not align vertically. We are\nusing <code dir=\"auto\">inline</code>, which places the input widgets immediately to the\nright of the label. Because the labels for the <code dir=\"auto\">ma1SourceInput</code> and\n<code dir=\"auto\">long1SourceInput</code> inputs are of different lengths the labels are in\ndifferent <em>y</em> positions.</li>\n<li>To make up for the misalignment, we pad the <code dir=\"auto\">title</code> argument in the\n<code dir=\"auto\">ma2SourceInput</code> line with three Unicode EN spaces (U+2002). Unicode\nspaces are necessary because ordinary spaces would be stripped from\nthe label. You can achieve precise alignment by combining different\nquantities and types of Unicode spaces. See here for a list of\n<a href=\"https://jkorpela.fi/chars/spaces.html\" rel=\"nofollow\">Unicode spaces</a> of different\nwidths.</li>\n</ul>", "segment_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "b424749ea1198d6b2f86bf48f84624fa2ce60439287485357fdf925f4f2d3831", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/levels", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/levels\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"levels\"><a href=\"#levels\">Levels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/levels", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"hline-levels\"><a href=\"#hline-levels\"><span>\u200b<code dir=\"auto\">hline()</code>\u200b levels</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Levels are lines plotted using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfunction. It is designed to plot <strong>horizontal</strong> levels using a <strong>single\ncolor</strong>, i.e., it does not change on different bars. See the\n<a href=\"/pine-script-docs/v5/concepts/plots/#levels\">Levels</a> section of the\npage on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#plot\">plot()</a> for\nalternative ways to plot levels when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nwon\u2019t do what you need.</p>\n<p>The function has the following signature:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">hline(price, title, color, linestyle, linewidth, editable) \u2192 hline</span></div></div></code></pre></figure></link></div>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nhas a few constraints when compared to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>:</p>\n<ul>\n<li>Since the function\u2019s objective is to plot horizontal lines, its\n<code dir=\"auto\">price</code> parameter requires an \u201cinput int/float\u201d argument, which\nmeans that \u201cseries float\u201d values such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nor dynamically-calculated values cannot be used.</li>\n<li>Its <code dir=\"auto\">color</code> parameter requires an \u201cinput int\u201d argument, which\nprecludes the use of dynamic colors, i.e., colors calculated on each\nbar \u2014 or \u201cseries color\u201d values.</li>\n<li>Three different line styles are supported through the <code dir=\"auto\">linestyle</code>\nparameter: <code dir=\"auto\">hline.style_solid</code>, <code dir=\"auto\">hline.style_dotted</code> and\n<code dir=\"auto\">hline.style_dashed</code>.</li>\n</ul>\n<p>Let\u2019s see\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nin action in the \u201cTrue Strength Index\u201d indicator:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"TSI\")\nmyTSI = 100 * ta.tsi(close, 25, 13)\n\nhline( 50, \"+50\",  color.lime)\nhline( 25, \"+25\",  color.green)\nhline(  0, \"Zero\", color.gray, linestyle = hline.style_dotted)\nhline(-25, \"-25\",  color.maroon)\nhline(-50, \"-50\",  color.red)\n\nplot(myTSI)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"376\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Levels-HlineLevels-01.DkWkzgaN_R6tzp.webp\" width=\"1756\"/></p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Levels-HlineLevels-02.rezExM6T_1CI5EH.webp\" width=\"1750\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We display 5 levels, each of a different color.</li>\n<li>We use a different line style for the zero centerline.</li>\n<li>We choose colors that will work well on both light and dark themes.</li>\n<li>The usual range for the indicator\u2019s values is +100 to -100. Since\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dtsi\">ta.tsi()</a>\nbuilt-in returns values in the +1 to -1 range, we make the\nadjustment in our code.</li>\n</ul>", "segment_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/levels", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"fills-between-levels\"><a href=\"#fills-between-levels\">Fills between levels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The space between two levels plotted with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\ncan be colored using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>.\nKeep in mind that <strong>both</strong> plots must have been plotted with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>.</p>\n<p>Let\u2019s put some background colors in our TSI indicator:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"TSI\")\nmyTSI = 100 * ta.tsi(close, 25, 13)\n\nplus50Hline  = hline( 50, \"+50\",  color.lime)\nplus25Hline  = hline( 25, \"+25\",  color.green)\nzeroHline    = hline(  0, \"Zero\", color.gray, linestyle = hline.style_dotted)\nminus25Hline = hline(-25, \"-25\",  color.maroon)\nminus50Hline = hline(-50, \"-50\",  color.red)\n\n// \u2014\u2014\u2014\u2014\u2014 Function returns a color in a light shade for use as a background.\nfillColor(color col) =&gt;\n    color.new(col, 90)\n\nfill(plus50Hline,  plus25Hline,  fillColor(color.lime))\nfill(plus25Hline,  zeroHline,    fillColor(color.teal))\nfill(zeroHline,    minus25Hline, fillColor(color.maroon))\nfill(minus25Hline, minus50Hline, fillColor(color.red))\n\nplot(myTSI)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"260\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Levels-FillBetweenLevels-01.xe2ic_uc_Z2mX9Cm.webp\" width=\"1282\"/></p>\n<p><img alt=\"image\" decoding=\"async\" height=\"262\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Levels-FillBetweenLevels-02.CUTgokP3_Z2tYq6M.webp\" width=\"1280\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We have now used the return value of our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfunction calls, which is of the\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">hline</a> special type. We use the <code dir=\"auto\">plus50Hline</code>, <code dir=\"auto\">plus25Hline</code>,\n<code dir=\"auto\">zeroHline</code>, <code dir=\"auto\">minus25Hline</code> and <code dir=\"auto\">minus50Hline</code> variables to store\nthose \u201chline\u201d IDs because we will need them in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\ncalls later.</li>\n<li>To generate lighter color shades for the background colors, we\ndeclare a <code dir=\"auto\">fillColor()</code> function that accepts a color and returns\nits 90 transparency. We use calls to that function for the <code dir=\"auto\">color</code>\narguments in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\ncalls.</li>\n<li>We make our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\ncalls for each of the four different fills we want, between four\ndifferent pairs of levels.</li>\n<li>We use <code dir=\"auto\">color.teal</code> in our second fill because it produces a green\nthat fits the color scheme better than the <code dir=\"auto\">color.green</code> used for\nthe 25 level.</li>\n</ul>", "segment_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "985191d96fbce7727284017bf526944d32a8a6587054282ee1a00d153a554f3e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/libraries", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/libraries\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"libraries\"><a href=\"#libraries\">Libraries<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/libraries", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae libraries are publications containing functions that can be\nreused in indicators, strategies, or in other libraries. They are useful\nto define frequently-used functions so their source code does not have\nto be included in every script where they are needed.</p>\n<p>A library must be published (privately or publicly) before it can be\nused in another script. All libraries are published open-source. Public\nscripts can only use public libraries and they must be open-source.\nPrivate scripts or personal scripts saved in the Pine Script Editor can\nuse public or private libraries. A library can use other libraries, or\neven previous versions of itself.</p>\n<p>Library programmers should be familiar with Pine Script\u2019s typing\nnomenclature, scopes and user-defined functions. If you need to brush up\non qualified types, see the User Manual\u2019s page on the\n<a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a>. For more\ninformation on user-defined functions and scopes, see the\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">User-defined functions</a> page.</p>\n<p>You can browse the library scripts published publicly by members in\nTradingView\u2019s <a href=\"https://www.tradingview.com/scripts/?script_type=libraries\">Community\nScripts</a>.</p>", "segment_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/libraries", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"creating-a-library\"><a href=\"#creating-a-library\">Creating a library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A library is a special kind of script that begins with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>\ndeclaration statement, rather than\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>.\nA library contains exportable\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">function</a>,\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>,\nand <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum</a> definitions, which constitute the only visible part of the\nlibrary when imported by another script. Like other script types,\nlibraries can also include Pine Script code in their global scopes.\nProgrammers typically use a library\u2019s global code to demonstrate how\nother scripts can use its exported structures.</p>\n<p>A library script has a structure like the following, which must include\none or more exportable functions or types:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// @description &lt;library_description&gt;\nlibrary(title, overlay)\n\n&lt;script_code&gt;\n\n//@type &lt;type_description&gt;\n//@field &lt;field_name&gt; &lt;field_description&gt;\n// ...\nexport type &lt;UDT_identifier&gt;\n    &lt;field_type&gt; &lt;field_name&gt;[ = &lt;value&gt;]   \n    ... \n\n//@enum &lt;enum_description&gt;\n//@field &lt;field_name&gt; &lt;field_description&gt;\n// ...\nexport enum &lt;enum_name&gt;\n    &lt;field_name&gt;[ = &lt;field_title&gt;]\n    ...\n\n//@function &lt;function_description&gt;\n//@param &lt;parameter&gt; &lt;parameter_description&gt;\n//@returns &lt;return_value_description&gt;\nexport &lt;function_name&gt;([simple/series] &lt;parameter_type&gt; &lt;parameter_name&gt; [= &lt;default_value&gt;] [, ...]) =&gt;\n    &lt;function_code&gt;\n\n&lt;script_code&gt;</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">//@description</code>, <code dir=\"auto\">//@enum</code>, <code dir=\"auto\">//@type</code>, <code dir=\"auto\">@field</code>,\n<code dir=\"auto\">// @function</code>, <code dir=\"auto\">// @param</code>, and <code dir=\"auto\">// @returns</code>\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotations</a> are optional but we highly recommend you use them. These\nannotations document the library\u2019s code and populate the default\nlibrary description, which authors can use when publishing the\nlibrary.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_export\">export</a>\nkeyword is mandatory.</li>\n<li>&lt;parameter_type&gt; is mandatory, contrary to user-defined function\nparameter definitions in indicators or strategies, which are\ntypeless.</li>\n<li>&lt;script_code&gt; can be any code one would normally use in an\nindicator, including <a href=\"/pine-script-docs/v5/concepts/inputs/\">inputs</a>.</li>\n</ul>\n<p>This is an example library:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// @description Provides functions calculating the all-time high/low of values.\nlibrary(\"AllTimeHighLow\", true)\n\n// @function Calculates the all-time high of a series.\n// @param val Series to use (`high` is used if no argument is supplied).\n// @returns The all-time high for the series.\nexport hi(float val = high) =&gt;\n    var float ath = val\n    ath := math.max(ath, val)\n\n// @function Calculates the all-time low of a series.\n// @param val Series to use (`low` is used if no argument is supplied).\n// @returns The all-time low for the series.\nexport lo(float val = low) =&gt;\n    var float atl = val\n    atl := math.min(atl, val)\n\nplot(hi())\nplot(lo())</div>\n<h3 class=\"md-heading\" id=\"library-functions\"><a href=\"#library-functions\">Library functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Exported functions and methods have slightly different requirements and constraints compared to non-exported functions.</p>\n<p>In exported library function signatures (their first line):</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_export\">export</a> is mandatory.</li>\n<li>The function\u2019s signature must include type keywords to specify the required <a href=\"/pine-script-docs/v5/language/type-system/#types\">type</a> for each parameter.</li>\n<li>Programmers can include either the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_simple\">simple</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_series\">series</a> qualifier keywords to specify the qualified type each parameter accepts. See the <a href=\"/pine-script-docs/v5/concepts/libraries/#qualified-type-control\">next section</a> for more information.</li>\n</ul>\n<p>Exported library functions have the following constraints:</p>\n<ul>\n<li>They cannot use variables from the library\u2019s global scope except for those with the \u201cconst\u201d qualifier, meaning they cannot use global\nvariables initialized from script inputs, for example, or globally declared <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>.</li>\n<li>They cannot include calls to any <code dir=\"auto\">input.*()</code> functions.</li>\n<li>They cannot call <code dir=\"auto\">request.*()</code> functions in their local scopes unless the script includes <code dir=\"auto\">dynamic_requests = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a> declaration statement. See <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#dynamic-requests\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data\">Other timeframes and data</a> page to learn more about <em>dynamic requests</em>.</li>\n</ul>\n<p>Library functions always return \u201csimple\u201d or \u201cseries\u201d results. Consequently, scripts cannot use their returned values in locations requiring \u201cconst\u201d or \u201cinput\u201d values. For example, a library function cannot calculate an argument for the <code dir=\"auto\">show_last</code> parameter in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> call because the parameter requires an \u201cinput int\u201d qualified type.</p>\n<h3 class=\"md-heading\" id=\"qualified-type-control\"><a href=\"#qualified-type-control\">Qualified type control<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The qualified types of arguments supplied in calls to library functions\nare autodetected based on how each argument is used inside the function.\nIf the argument can be used as a \u201cseries\u201d, it is qualified as such. If\nit cannot, an attempt is made with the \u201csimple\u201d type qualifier. This\nexplains why this code:</p>\n<div class=\"pine-colorizer not-content\">export myEma(int x) =&gt;\n    ta.ema(close, x)</div>\n<p>will work when called using <code dir=\"auto\">myCustomLibrary.myEma(20)</code>, even though\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>\u2018s\n<code dir=\"auto\">length</code> parameter requires a \u201csimple int\u201d argument. When the Pine\nScript compiler detects that a \u201cseries\u201d length cannot be used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>,\nit tries the \u201csimple\u201d qualifier, which in this case is allowed.</p>\n<p>While library functions cannot return \u201cconst\u201d or \u201cinput\u201d values,\nthey can be written to produce \u201csimple\u201d results. This makes them\nuseful in more contexts than functions returning \u201cseries\u201d results, as\nsome built-in functions do not allow \u201cseries\u201d arguments. For example,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nrequires a \u201csimple string\u201d argument for its <code dir=\"auto\">symbol</code> parameter when a script does not allow <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#dynamic-requests\">dynamic requests</a>. If we wrote a\nlibrary function to assemble the argument to <code dir=\"auto\">symbol</code> in the following\nway, the function\u2019s result would not work with a non-dynamic <code dir=\"auto\">request.*()</code> call because it is of the \u201cseries\nstring\u201d qualified type:</p>\n<div class=\"pine-colorizer not-content\">export makeTickerid(string prefix, string ticker) =&gt;\n    prefix + \":\" + ticker</div>\n<p>However, by restricting the parameter qualifiers to \u201csimple\u201d, we can\nforce the function to yield a \u201csimple\u201d result. We can achieve this by\nprefixing the parameters\u2019 type with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_simple\">simple</a>\nkeyword:</p>\n<div class=\"pine-colorizer not-content\">export makeTickerid(simple string prefix, simple string ticker) =&gt;\n    prefix + \":\" + ticker</div>\n<p>Note that for the function to return a \u201csimple\u201d value, no \u201cseries\u201d\nvalues can be used in its calculation; otherwise the result will be a\n\u201cseries\u201d value.</p>\n<p>One can also use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_simple\">series</a>\nkeyword to prefix the type of a library function parameter. However,\nbecause arguments are qualified as \u201cseries\u201d by default, using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_simple\">series</a>\nmodifier is redundant.</p>\n<h3 class=\"md-heading\" id=\"user-defined-types-and-objects\"><a href=\"#user-defined-types-and-objects\">User-defined types and objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Libraries can export <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types (UDTs)</a>, and library functions can return <a href=\"/pine-script-docs/v5/language/objects/\">objects</a> of these types.</p>\n<p>To export a UDT, prefix its definition with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_export\">export</a>\nkeyword, similar to exporting a function:</p>\n<div class=\"pine-colorizer not-content\">//@version=5    \nlibrary(\"Point\")    \n\nexport type point   \n    int x   \n    float y \n    bool isHi   \n    bool wasBreached = false    </div>\n<p>A script importing that library and creating an\n<a href=\"/pine-script-docs/v5/language/objects/\">object</a> of its <code dir=\"auto\">point</code> UDT\nwould look somewhat like this:</p>\n<div class=\"pine-colorizer not-content\">//@version=5  \nindicator(\"\") \nimport userName/Point/1 as pt \nnewPoint = pt.point.new() </div>\n<p>Note that:</p>\n<ul>\n<li>This code won\u2019t compile because no \u201cPoint\u201d library is published,\nand the script doesn\u2019t display anything.</li>\n<li><code dir=\"auto\">userName</code> would need to be replaced by the TradingView user name of\nthe library\u2019s publisher.</li>\n<li>We use the built-in <code dir=\"auto\">new()</code> method to create an object from the\n<code dir=\"auto\">point</code> UDT.</li>\n<li>We prefix the reference to the library\u2019s <code dir=\"auto\">point</code> UDT with the <code dir=\"auto\">pt</code>\nalias defined in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatement, just like we would when using a function from an imported\nlibrary.</li>\n</ul>\n<p>A library <strong>must</strong> export a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a> if\nany exported functions or methods accept or return an\n<a href=\"/pine-script-docs/v5/language/objects/\">object</a> of that type, or if\nthe fields of another exported\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\naccept an instance of the type.</p>\n<p>When a library only uses a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\ninternally, it does not need to export the type. The following library\nuses the <code dir=\"auto\">point</code> type internally, but it only exports the <code dir=\"auto\">drawPivots()</code>\nfunction, which does not have a parameter of the <code dir=\"auto\">point</code> type or return\na <code dir=\"auto\">point</code> <a href=\"/pine-script-docs/v5/language/objects/\">object</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5    \nlibrary(\"PivotLabels\", true)    \n\n// We use this `point` UDT in the library, but it does NOT require exporting because    \n//   1. The exported function's parameters do not use the UDT.  \n//   2. The exported function does not return a UDT result. \ntype point  \n    int x   \n    float y \n    bool isHi   \n    bool wasBreached = false    \n\n\nfillPivotsArray(qtyLabels, leftLegs, rightLegs) =&gt;  \n    // Create an array of the specified qty of pivots to maintain.  \n    var pivotsArray = array.new&lt;point&gt;(math.max(qtyLabels, 0))  \n\n    // Detect pivots.   \n    float pivotHi = ta.pivothigh(leftLegs, rightLegs)   \n    float pivotLo = ta.pivotlow(leftLegs, rightLegs)    \n\n    // Create a new `point` object when a pivot is found.   \n    point foundPoint = switch   \n        pivotHi =&gt; point.new(time[rightLegs], pivotHi, true)    \n        pivotLo =&gt; point.new(time[rightLegs], pivotLo, false)   \n        =&gt; na   \n\n    // Add new pivot info to the array and remove the oldest pivot. \n    if not na(foundPoint)   \n        array.push(pivotsArray, foundPoint) \n        array.shift(pivotsArray)    \n\n    array&lt;point&gt; result = pivotsArray   \n\n\ndetectBreaches(pivotsArray) =&gt;  \n    // Detect breaches. \n    for [i, eachPoint] in pivotsArray   \n        if not na(eachPoint)    \n            if not eachPoint.wasBreached    \n                bool hiWasBreached =     eachPoint.isHi and high[1] &lt;= eachPoint.y and high &gt; eachPoint.y   \n                bool loWasBreached = not eachPoint.isHi and low[1]  &gt;= eachPoint.y and low  &lt; eachPoint.y   \n                if hiWasBreached or loWasBreached   \n                    // This pivot was breached; change its `wasBreached` field. \n                    point p = array.get(pivotsArray, i) \n                    p.wasBreached := true   \n                    array.set(pivotsArray, i, p)    \n\n\ndrawLabels(pivotsArray) =&gt;  \n    for eachPoint in pivotsArray    \n        if not na(eachPoint)    \n            label.new(  \n              eachPoint.x,  \n              eachPoint.y,  \n              str.tostring(eachPoint.y, format.mintick),    \n              xloc.bar_time,    \n              color = eachPoint.wasBreached ? color.gray : eachPoint.isHi ? color.teal : color.red, \n              style = eachPoint.isHi ? label.style_label_down: label.style_label_up,    \n              textcolor = eachPoint.wasBreached ? color.silver : color.white)   \n\n\n// @function        Displays a label for each of the last `qtyLabels` pivots.   \n//                  Colors high pivots in green, low pivots in red, and breached pivots in gray.    \n// @param qtyLabels (simple int) Quantity of last labels to display.    \n// @param leftLegs  (simple int) Left pivot legs.   \n// @param rightLegs (simple int) Right pivot legs.  \n// @returns         Nothing.    \nexport drawPivots(int qtyLabels, int leftLegs, int rightLegs) =&gt;    \n    // Gather pivots as they occur. \n    pointsArray = fillPivotsArray(qtyLabels, leftLegs, rightLegs)   \n\n    // Mark breached pivots.    \n    detectBreaches(pointsArray) \n\n    // Draw labels once.    \n    if barstate.islastconfirmedhistory  \n        drawLabels(pointsArray) \n\n\n// Example use of the function. \ndrawPivots(20, 10, 5)   </div>\n<p>If the TradingView user published the above library, it could be used\nlike this:</p>\n<div class=\"pine-colorizer not-content\">//@version=5  \nindicator(\"\") \nimport TradingView/PivotLabels/1 as dpl   \ndpl.drawPivots(20, 10, 10)</div>\n<h3 class=\"md-heading\" id=\"enum-types\"><a href=\"#enum-types\">Enum types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Libraries can also export\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a>, allowing other scripts to import sets of predefined, named\nvalues that help control the values accepted by variables, conditional\nexpressions, and\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>.</p>\n<p>For example, this library exports a <code dir=\"auto\">State</code> enum with three fields\nrepresenting distinct signal states: <code dir=\"auto\">long</code>, <code dir=\"auto\">short</code>, and <code dir=\"auto\">neutral</code>.\nThese fields represent the <em>possible values</em> a variable, expression, or\ncollection of the\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a> can take on:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nlibrary(\"Signal\")\n\n//@enum           An enumeration of named signal states.\n//@field long     Represents a \"Long\" signal.\n//@field short    Represents a \"Short\" signal.\n//@field neutral  Represents a \"Neutral\" signal. \nexport enum State\n    long    = \"Long\"\n    short   = \"Short\"\n    neutral = \"Neutral\"</div>\n<p>A script that imports this library can use the members (values) of the\n<code dir=\"auto\">State</code> enum as named states in its logic. Here, we show a simple,\nhypothetical script that imports the \u201cSignal\u201d library published by the\n<code dir=\"auto\">userName</code> user and uses the <code dir=\"auto\">Signal.State</code> enum to assign one of three\npossible values to a <code dir=\"auto\">mySignal</code> variable:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\n\nimport userName/Signal/1 as Signal\n\n// Calculate the median and quarter range values. \nfloat medianValue = ta.median(close, 100)\nfloat rangeValue  = ta.range(close, 100) * 0.25\n// Calculate upper and lower channel values.\nfloat upper = medianValue + rangeValue\nfloat lower = medianValue - rangeValue\n\n//@variable Returns `Signal.State.long`, `Signal.State.short`, or `Signal.State.neutral` based on the price action.\nSignal.State mySignal = switch\n    close &gt; upper =&gt; Signal.State.long\n    close &lt; lower =&gt; Signal.State.short\n    =&gt;               Signal.State.neutral\n\nplot(close, color = mySignal == Signal.State.long ? color.green : mySignal == Signal.State.short ? color.red : na)</div>\n<p>Similar to exporting <a href=\"/pine-script-docs/v5/concepts/libraries/#user-defined-types-and-objects\">UDTs</a>, a library <strong>must</strong> export an enum when its exported\nfunctions or methods accept or return the\n<a href=\"/pine-script-docs/v5/language/enums/\">enum\u2019s</a> members, or when the\nfields of an exported\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\naccept values of that\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>.</p>", "segment_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/libraries", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"publishing-a-library\"><a href=\"#publishing-a-library\">Publishing a library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Before you or other Pine Script programmers can reuse any library, it\nmust be published. If you want to share your library with all\nTradingViewers, publish it publicly. To use it privately, use a private\npublication. As with indicators or strategies, the active chart when you\npublish a library will appear in both its widget (the small placeholder\ndenoting libraries in the TradingView scripts stream) and script page\n(the page users see when they click on the widget).</p>\n<p>Private libraries can be used in public Protected or Invite-only\nscripts.</p>\n<p>After adding our example library to the chart and setting up a clean\nchart showing our library plots the way we want them, we use the Pine\nEditor\u2019s \u201cPublish Script\u201d button. The \u201cPublish Library\u201d window\ncomes up:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"855\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Libraries-CreatingALibrary-PublishWindow.DrHv_-QJ_Z2mzOSu.webp\" width=\"1304\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We leave the library\u2019s title as is (the <code dir=\"auto\">title</code> argument in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>\ndeclaration statement is used as the default). While you can change\nthe publication\u2019s title, it is preferable to keep its default value\nbecause the <code dir=\"auto\">title</code> argument is used to reference imported libraries\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatement. It makes life easier for library users when your\npublication\u2019s title matches the actual name of the library.</li>\n<li>A default description is built from the\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotations</a> we used in our library. We will publish the library\nwihout retouching it.</li>\n<li>We chose to publish our library publicly, so it will be visible to\nall TradingViewers.</li>\n<li>We do not have the possibility of selecting a visibility type other\nthan \u201cOpen\u201d because libraries are always open-source.</li>\n<li>The list of categories for libraries is different than for\nindicators and strategies. We have selected the \u201cStatistics and\nMetrics\u201d category.</li>\n<li>We have added some custom tags: \u201call-time\u201d, \u201chigh\u201d and \u201clow\u201d.</li>\n</ul>\n<p>The intended users of public libraries being other Pine programmers; the\nbetter you explain and document your library\u2019s functions, the more\nchances others will use them. Providing examples demonstrating how to\nuse your library\u2019s functions in your publication\u2019s code will also\nhelp.</p>\n<h3 class=\"md-heading\" id=\"house-rules\"><a href=\"#house-rules\">House Rules<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine libraries are considered \u201cpublic domain\u201d code in our <a href=\"https://www.tradingview.com/support/solutions/43000590599\">House Rules\non Script\nPublishing</a>,\nwhich entails that permission is not required from their author if you\ncall their functions or reuse their code in your open-source scripts.\nHowever, if you intend to reuse code from a Pine Script library\u2019s\nfunctions in a public protected or invite-only publication, explicit\npermission for reuse in that form is required from its author.</p>\n<p>Whether using a library\u2019s functions or reusing its code, you must\ncredit the author in your publication\u2019s description. It is also good\nform to credit in open-source comments.</p>", "segment_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/libraries", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"using-a-library\"><a href=\"#using-a-library\">Using a library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Using a library from another script (which can be an indicator, a\nstrategy or another library), is done through the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatement:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">import &lt;username&gt;/&lt;libraryName&gt;/&lt;libraryVersion&gt; [as &lt;alias&gt;]</span></div></div></code></pre></figure></link></div>\n<p>where:</p>\n<ul>\n<li>The &lt;username&gt;/&lt;libraryName&gt;/&lt;libraryVersion&gt; path will\nuniquely identify the library.</li>\n<li>The &lt;libraryVersion&gt; must be specified explicitly. To ensure the\nreliability of scripts using libraries, there is no way to\nautomatically use the latest version of a library. Every time a\nlibrary update is published by its author, the library\u2019s version\nnumber increases. If you intend to use the latest version of the\nlibrary, the &lt;libraryVersion&gt; value will require updating in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatement.</li>\n<li>The <code dir=\"auto\">as &lt;alias&gt;</code> part is optional. When used, it defines the\nnamespace that will refer to the library\u2019s functions. For example,\nif you import a library using the <code dir=\"auto\">allTime</code> alias as we do in the\nexample below, you will refer to that library\u2019s functions as\n<code dir=\"auto\">allTime.&lt;function_mame&gt;()</code>. When no alias is defined, the\nlibrary\u2019s name becomes its namespace.</li>\n</ul>\n<p>To use the library we published in the previous section, our next script\nwill require an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatement:</p>\n<div class=\"pine-colorizer not-content\">import PineCoders/AllTimeHighLow/1 as allTime</div>\n<p>As you type the user name of the library\u2019s author, you can use the\nEditor\u2019s <code dir=\"auto\">ctrl</code> +\n<code dir=\"auto\">space</code> / <code dir=\"auto\">cmd</code> \u201cAuto-complete\u201d\ncommand to display a popup providing selections that match the available\nlibraries:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"111\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Libraries-UsingALibrary-1.PrDno7wM_ZsSrb9.webp\" width=\"726\"/></p>\n<p>This is an indicator that reuses our library:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Using AllTimeHighLow library\", \"\", true)\nimport PineCoders/AllTimeHighLow/1 as allTime\n\nplot(allTime.hi())\nplot(allTime.lo())\nplot(allTime.hi(close))</div>\n<p>Note that:</p>\n<ul>\n<li>We have chosen to use the \u201callTime\u201d alias for the library\u2019s\ninstance in our script. When typing that alias in the Editor, a\npopup will appear to help you select the particular function you\nwant to use from the library.</li>\n<li>We use the library\u2019s <code dir=\"auto\">hi()</code> and <code dir=\"auto\">lo()</code> functions without an\nargument, so the default\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nbuilt-in variables will be used for their series, respectively.</li>\n<li>We use a second call to <code dir=\"auto\">allTime.hi()</code>, but this time using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nas its argument, to plot the highest\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nin the chart\u2019s history.</li>\n</ul>", "segment_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "e89231414557c072295cc7f3ec049278aa432cd1009972ee915eb8610874227e", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"lines-and-boxes\"><a href=\"#lines-and-boxes\">Lines and boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae facilitates drawing lines, boxes, and other geometric\nformations from code using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\ntypes. These types provide utility for programmatically drawing support\nand resistance levels, trend lines, price ranges, and other custom\nformations on a chart.</p>\n<p>Unlike <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a>, the\nflexibility of these types makes them particularly well-suited for\nvisualizing current calculated data at virtually any available point on\nthe chart, irrespective of the chart bar the script executes on.</p>\n<p><a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">Lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>\nare <em>objects</em>, like\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>,\n<a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a>, and other <em>special\ntypes</em>. Scripts reference objects of these types using IDs, which act\nlike <em>pointers</em>. As with other objects,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\nIDs are qualified as \u201cseries\u201d values, and all functions that manage\nthese objects accept \u201cseries\u201d arguments.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Using the types we discuss on this page often involves\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, especially when\nworking with <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>, which <em>require</em> an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ninstances. We therefore recommend you become familiar with\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> to make the most of\nthese drawing types in your scripts.</p></div></aside>\n<p>Lines drawn by a script may be vertical, horizontal, or angled. Boxes\nare always rectangular. Polylines sequentially connect multiple\nvertical, horizontal, angled, or curved line segments. Although all of\nthese drawing types have different characteristics, they do have some\nthings in common:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">Lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a> can have coordinates at any available location on the\nchart, including ones at future times beyond the last chart bar.</li>\n<li>Objects of these types can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ninstances to set their coordinates.</li>\n<li>The x-coordinates of each object can be bar index or time values,\ndepending on their specified <code dir=\"auto\">xloc</code> property.</li>\n<li>Each object can have one of multiple predefined line styles.</li>\n<li>Scripts can call the functions that manage these objects from within\nthe scopes of <a href=\"/pine-script-docs/v5/language/loops/\">loops</a> and\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>, allowing iterative and conditional control of their\ndrawings.</li>\n<li>There are limits on the number of these objects that a script can\nreference and display on the chart. A single script instance can\ndisplay up to 500 lines, 500 boxes, and 100 polylines. Users can\nspecify the maximum number allowed for each type via the\n<code dir=\"auto\">max_lines_count</code>, <code dir=\"auto\">max_boxes_count</code>, and <code dir=\"auto\">max_polylines_count</code>\nparameters of the script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement. If unspecified, the default is ~50. As with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\ntypes, lines, boxes, and polylines utilize a <em>garbage collection</em>\nmechanism that deletes the oldest objects on the chart when the\ntotal number of drawings exceeds the script\u2019s limit.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>On TradingView charts, a complete set of <em>Drawing Tools</em> allows users to\ncreate and modify drawings using mouse actions. While they may sometimes\nresemble drawing objects created with Pine Script code, they are\n<strong>unrelated</strong> entities. Pine scripts cannot interact with drawing tools\nfrom the chart user interface, and mouse actions do not directly affect\nPine drawing objects.</p></div></aside>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"lines\"><a href=\"#lines\">Lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The built-ins in the <code dir=\"auto\">line.*</code> namespace control the creation and\nmanagement of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nobjects:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nfunction creates a new line.</li>\n<li>The <code dir=\"auto\">line.set_*()</code> functions modify line properties.</li>\n<li>The <code dir=\"auto\">line.get_*()</code> functions retrieve values from a line instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.copy\">line.copy()</a>\nfunction clones a line instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>\nfunction deletes an existing line instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_line.all\">line.all</a>\nvariable references a read-only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining the IDs of all lines displayed by the script. The\narray\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\ndepends on the <code dir=\"auto\">max_lines_count</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement and the number of lines the script has drawn.</li>\n</ul>\n<p>Scripts can call <code dir=\"auto\">line.set_*()</code>, <code dir=\"auto\">line.get_*()</code>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.copy\">line.copy()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>\nbuilt-ins as functions or <a href=\"/pine-script-docs/v5/language/methods/\">methods</a>.</p>\n<h3 class=\"md-heading\" id=\"creating-lines\"><a href=\"#creating-lines\">Creating lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nfunction creates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstance to display on the chart. It has the following signatures:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">line.new(first_point, second_point, xloc, extend, color, style, width, force_overlay) \u2192 series line</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">line.new(x1, y1, x2, y2, xloc, extend, color, style, width, force_overlay) \u2192 series line</span></div></div></code></pre></figure></link></div>\n<p>The first overload of this function contains the <code dir=\"auto\">first_point</code> and\n<code dir=\"auto\">second_point</code> parameters. The <code dir=\"auto\">first_point</code> is a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nrepresenting the start of the line, and the <code dir=\"auto\">second_point</code> is a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nrepresenting the line\u2019s end. The function copies the information from\nthese\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> to determine the line\u2019s coordinates. Whether it uses the\n<code dir=\"auto\">index</code> or <code dir=\"auto\">time</code> fields from the <code dir=\"auto\">first_point</code> and <code dir=\"auto\">second_point</code> as\nx-coordinates depends on the function\u2019s <code dir=\"auto\">xloc</code> value.</p>\n<p>The second overload specifies <code dir=\"auto\">x1</code>, <code dir=\"auto\">y1</code>, <code dir=\"auto\">x2</code>, and <code dir=\"auto\">y2</code> values\nindependently, where <code dir=\"auto\">x1</code> and <code dir=\"auto\">x2</code> are\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nvalues representing the starting and ending x-coordinates of the line,\nand <code dir=\"auto\">y1</code> and <code dir=\"auto\">y2</code> are\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues representing the y-coordinates. Whether the line considers the\n<code dir=\"auto\">x</code> values as bar indices or timestamps depends on the <code dir=\"auto\">xloc</code> value in\nthe function call.</p>\n<p>Both overloads share the same additional parameters:</p>\n<p><code dir=\"auto\">xloc</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Controls whether the x-coordinates of the new line use bar index or\ntime values. Its default value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>.</p>\n<p class=\"spacer-wrapper\"><spacer/>When calling the first overload, using an <code dir=\"auto\">xloc</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\ntells the function to use the <code dir=\"auto\">index</code> fields of the <code dir=\"auto\">first_point</code>\nand <code dir=\"auto\">second_point</code>, and a value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>\ntells the function to use the <code dir=\"auto\">time</code> fields of the points.</p>\n<p class=\"spacer-wrapper\"><spacer/>When calling the second overload, an <code dir=\"auto\">xloc</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\nprompts the function to treat the <code dir=\"auto\">x1</code> and <code dir=\"auto\">x2</code> arguments as bar\nindex values. When using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>,\nthe function will treat <code dir=\"auto\">x1</code> and <code dir=\"auto\">x2</code> as time values.</p>\n<p class=\"spacer-wrapper\"><spacer/>When the specified x-coordinates represent <em>bar index</em> values, it\u2019s\nimportant to note that the minimum x-coordinate allowed is\n<code dir=\"auto\">bar_index - 9999</code>. For larger offsets, one can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>.</p>\n<p><code dir=\"auto\">extend</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Determines whether the drawn line will infinitely extend beyond its\ndefined start and end coordinates. It accepts one of the following\nvalues:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.left\">extend.left</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.right\">extend.right</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.both\">extend.both</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.none\">extend.none</a>\n(default).</p>\n<p><code dir=\"auto\">color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the color of the line drawing. The default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.blue\">color.blue</a>.</p>\n<p><code dir=\"auto\">style</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the line\u2019s style, which can be any of the options listed\nin this page\u2019s\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#line-styles\">Line styles</a> section. The default value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_line.style_solid\">line.style_solid</a>.</p>\n<p><code dir=\"auto\">width</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Controls the width of the line, in pixels. The default value is 1.</p>\n<p><code dir=\"auto\">force_overlay</code></p>\n<p class=\"spacer-wrapper\"><spacer/>If <code dir=\"auto\">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir=\"auto\">false</code>.</p>\n<p>The example below demonstrates how one can draw lines in their simplest\nform. This script draws a new vertical line connecting the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices at the horizontal center of each chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"550\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Creating-lines-1.B2RdyvXG_1Vqnm2.webp\" width=\"1334\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Creating lines demo\", overlay = true)\n\n//@variable The `chart.point` for the start of the line. Contains `index` and `time` information.\nfirstPoint = chart.point.now(open)\n//@variable The `chart.point` for the end of the line. Contains `index` and `time` information.\nsecondPoint = chart.point.now(close)\n\n// Draw a basic line with a `width` of 5 connecting the `firstPoint` to the `secondPoint`.\n// This line uses the `index` field from each point for its x-coordinates.\nline.new(firstPoint, secondPoint, width = 5)\n\n// Color the background on the unconfirmed bar.\nbgcolor(barstate.isconfirmed ? na : color.new(color.orange, 70), title = \"Unconfirmed bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>If the <code dir=\"auto\">firstPoint</code> and <code dir=\"auto\">secondPoint</code> reference identical\ncoordinates, the script will <em>not</em> display a line since there is\nno distance between them to draw. However, the line ID will\nstill exist.</li>\n<li>The script will only display approximately the last 50 lines on\nthe chart, as it does not have a specified <code dir=\"auto\">max_lines_count</code> in\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call. Line drawings persist on the chart until deleted\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>\nor removed by the garbage collector.</li>\n<li>The script <em>redraws</em> the line on the open chart bar (i.e., the\nbar with an orange background highlight) until it closes. After\nthe bar closes, it will no longer update the drawing.</li>\n</ul>\n<p>Let\u2019s look at a more involved example. This script uses the previous\nbar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>\nprice and the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nprices to draw a fan with a user-specified number of lines projecting a\nrange of hypothetical price values for the following chart bar. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nwithin a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a> loop to\ncreate <code dir=\"auto\">linesPerBar</code> lines on each bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"598\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Creating-lines-2.DqR4SD_f_2jEAVG.webp\" width=\"1328\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Creating lines demo\", \"Simple projection fan\", true, max_lines_count = 500)\n\n//@variable The number of fan lines drawn on each chart bar.\nint linesPerBar = input.int(20, \"Line drawings per bar\", 2, 100)\n\n//@variable The distance between each y point on the current bar.\nfloat step = (high - low) / (linesPerBar - 1)\n\n//@variable The `chart.point` for the start of each line. Does not contain `time` information.\nfirstPoint = chart.point.from_index(bar_index - 1, hl2[1])\n//@variable The `chart.point` for the end of each line. Does not contain `time` information.\nsecondPoint = chart.point.from_index(bar_index + 1, float(na))\n\n//@variable The stepped y value on the current bar for `secondPoint.price` calculation, starting from the `low`.\nfloat barValue = low\n// Loop to draw the fan.\nfor i = 1 to linesPerBar\n    // Update the `price` of the `secondPoint` using the difference between the `barValue` and `firstPoint.price`.\n    secondPoint.price := 2.0 * barValue - firstPoint.price\n    //@variable Is `color.aqua` when the line's slope is positive, `color.fuchsia` otherwise.\n    color lineColor = secondPoint.price &gt; firstPoint.price ? color.aqua : color.fuchsia\n    // Draw a new `lineColor` line connecting the `firstPoint` and `secondPoint` coordinates.\n    // This line uses the `index` field from each point for its x-coordinates.\n    line.new(firstPoint, secondPoint, color = lineColor)\n    // Add the `step` to the `barValue`.\n    barValue += step\n\n// Color the background on the unconfirmed bar.\nbgcolor(barstate.isconfirmed ? na : color.new(color.orange, 70), title = \"Unconfirmed bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We\u2019ve included <code dir=\"auto\">max_lines_count = 500</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call, meaning the script preserves up to 500 lines on\nthe chart.</li>\n<li>Each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\ncall <em>copies</em> the information from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nreferenced by the <code dir=\"auto\">firstPoint</code> and <code dir=\"auto\">secondPoint</code> variables. As\nsuch, the script can change the <code dir=\"auto\">price</code> field of the\n<code dir=\"auto\">secondPoint</code> on each loop iteration without affecting the\ny-coordinates in other lines.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"modifying-lines\"><a href=\"#modifying-lines\">Modifying lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">line.*</code> namespace contains multiple <em>setter</em> functions that modify\nthe properties of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstances:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_first_point\">line.set_first_point()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_second_point\">line.set_second_point()</a>\nrespectively update the start and end points of the <code dir=\"auto\">id</code> line using\ninformation from the specified <code dir=\"auto\">point</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_x1\">line.set_x1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_x2\">line.set_x2()</a>\nset one of the x-coordinates of the <code dir=\"auto\">id</code> line to a new <code dir=\"auto\">x</code> value,\nwhich can represent a bar index or time value depending on the\nline\u2019s <code dir=\"auto\">xloc</code> property.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_y1\">line.set_y1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_y2\">line.set_y2()</a>\nset one of the y-coordinates of the <code dir=\"auto\">id</code> line to a new <code dir=\"auto\">y</code> value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_xy1\">line.set_xy1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_xy2\">line.set_xy2()</a>\nupdate one of the <code dir=\"auto\">id</code> line\u2019s points with new <code dir=\"auto\">x</code> and <code dir=\"auto\">y</code> values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_xloc\">line.set_xloc()</a>\nsets the <code dir=\"auto\">xloc</code> of the <code dir=\"auto\">id</code> line and updates both of its\nx-coordinates with new <code dir=\"auto\">x1</code> and <code dir=\"auto\">x2</code> values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_extend\">line.set_extend()</a>\nsets the <code dir=\"auto\">extend</code> property of the <code dir=\"auto\">id</code> line.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_color\">line.set_color()</a>\nupdates the <code dir=\"auto\">id</code> line\u2019s <code dir=\"auto\">color</code> value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_style\">line.set_style()</a>\nchanges the <code dir=\"auto\">style</code> of the <code dir=\"auto\">id</code> line.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_width\">line.set_width()</a>\nsets the <code dir=\"auto\">width</code> of the <code dir=\"auto\">id</code> line.</li>\n</ul>\n<p>All setter functions directly modify the <code dir=\"auto\">id</code> line passed into the call\nand do not return any value. Each setter function accepts \u201cseries\u201d\narguments, as a script can change a line\u2019s properties throughout its\nexecution.</p>\n<p>The following example draws lines connecting the opening price of a\n<code dir=\"auto\">timeframe</code> to its closing price. The script uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to declare the <code dir=\"auto\">periodLine</code> and the variables that reference\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nvalues (<code dir=\"auto\">openPoint</code> and <code dir=\"auto\">closePoint</code>) only on the <em>first</em> chart bar, and\nit assigns new values to these variables over its execution. After\ndetecting a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">change</a>\non the <code dir=\"auto\">timeframe</code>, it sets the <code dir=\"auto\">color</code> of the existing <code dir=\"auto\">periodLine</code>\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_color\">line.set_color()</a>,\ncreates new values for the <code dir=\"auto\">openPoint</code> and <code dir=\"auto\">closePoint</code> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a>,\nthen assigns a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">new\nline</a>\nusing those points to the <code dir=\"auto\">periodLine</code>.</p>\n<p>On other bars where the <code dir=\"auto\">periodLine</code> value is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, the\nscript assigns a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nto the <code dir=\"auto\">closePoint</code>, then uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_second_point\">line.set_second_point()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_color\">line.set_color()</a>\nas <a href=\"/pine-script-docs/v5/language/methods/\">methods</a> to update the\nline\u2019s properties:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"604\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Modifying-lines-1.9MbH8maN_1T4Dvi.webp\" width=\"1334\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Modifying lines demo\", overlay = true)\n\n//@variable The size of each period.\nstring timeframe = input.timeframe(\"D\", \"Timeframe\")\n\n//@variable A line connecting the period's opening and closing prices.\nvar line periodLine = na\n\n//@variable The first point of the line. Contains `time` and `index` information.\nvar chart.point openPoint = chart.point.now(open)\n//@variable The closing point of the line. Contains `time` and `index` information.\nvar chart.point closePoint = chart.point.now(close)\n\nif timeframe.change(timeframe)\n    //@variable The final color of the `periodLine`.\n    color finalColor = switch\n        closePoint.price &gt; openPoint.price =&gt; color.green\n        closePoint.price &lt; openPoint.price =&gt; color.red\n        =&gt;                                    color.gray\n\n    // Update the color of the current `periodLine` to the `finalColor`.\n    line.set_color(periodLine, finalColor)\n\n    // Assign new points to the `openPoint` and `closePoint`.\n    openPoint  := chart.point.now(open)\n    closePoint := chart.point.now(close)\n    // Assign a new line to the `periodLine`. Uses `time` fields from the `openPoint` and `closePoint` as x-coordinates.\n    periodLine := line.new(openPoint, closePoint, xloc.bar_time, style = line.style_arrow_right, width = 3)\n\nelse if not na(periodLine)\n    // Assign a new point to the `closePoint`.\n    closePoint := chart.point.now(close)\n\n    //@variable The color of the developing `periodLine`.\n    color developingColor = switch\n        closePoint.price &gt; openPoint.price =&gt; color.aqua\n        closePoint.price &lt; openPoint.price =&gt; color.fuchsia\n        =&gt;                                    color.gray\n\n    // Update the coordinates of the line's second point using the new `closePoint`.\n    // It uses the `time` field from the point for its new x-coordinate.\n    periodLine.set_second_point(closePoint)\n    // Update the color of the line using the `developingColor`.\n    periodLine.set_color(developingColor)</div>\n<p>Note that:</p>\n<ul>\n<li>Each line drawing in this example uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_line.style_arrow_right\">line.style_arrow_right</a>\nstyle. See the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#line-styles\">Line styles</a> section below for an overview of all available style\nsettings.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"line-styles\"><a href=\"#line-styles\">Line styles<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users can control the style of their scripts\u2019 line drawings by passing\none of the following variables as the <code dir=\"auto\">style</code> argument in their\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_style\">line.set_style()</a>\nfunction calls:</p>\n<table><thead><tr><th>Argument</th><th>Line</th></tr></thead><tbody><tr><td><code dir=\"auto\">line.style_solid</code></td><td><img alt=\"line_style_solid\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-solid.DhD1RUy8_12kPg2.webp\" width=\"744\"/></td></tr><tr><td><code dir=\"auto\">line.style_dotted</code></td><td><img alt=\"line_style_dotted\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-dotted.ChjUGoWk_Z25Ho6S.webp\" width=\"744\"/></td></tr><tr><td><code dir=\"auto\">line.style_dashed</code></td><td><img alt=\"line_style_dashed\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-dashed.RIt4NsM6_DFkrB.webp\" width=\"744\"/></td></tr><tr><td><code dir=\"auto\">line.style_arrow_left</code></td><td><img alt=\"line_style_arrow_left\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_left.CASIwsfy_Z1JIiS0.webp\" width=\"744\"/></td></tr><tr><td><code dir=\"auto\">line.style_arrow_right</code></td><td><img alt=\"line_style_arrow_right\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_right.Ch2Ohee9_C6Kmb.webp\" width=\"744\"/></td></tr><tr><td><code dir=\"auto\">line.style_arrow_both</code></td><td><img alt=\"line_style_arrow_both\" decoding=\"async\" height=\"652\" loading=\"lazy\" src=\"/pine-script-docs/_astro/LinesAndBoxes-LineStyles-arrow_both.CDMgsUYf_Z1hzmym.webp\" width=\"744\"/></td></tr></tbody></table>\n<p>Note that:</p>\n<ul>\n<li><em>Polylines</em> can also use any of these variables as their\n<code dir=\"auto\">line_style</code> value. See the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#creating-polylines\">Creating polylines</a> section of this page.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"reading-line-values\"><a href=\"#reading-line-values\">Reading line values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">line.*</code> namespace includes <em>getter</em> functions, which allow a script\nto retrieve values from a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nobject for further use:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_x1\">line.get_x1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_x2\">line.get_x2()</a>\nrespectively get the first and second x-coordinate from the <code dir=\"auto\">id</code>\nline. Whether the value returned represents a bar index or time\nvalue depends on the line\u2019s <code dir=\"auto\">xloc</code> property.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_y1\">line.get_y1()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_y2\">line.get_y2()</a>\nrespectively get the <code dir=\"auto\">id</code> line\u2019s first and second y-coordinate.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_price\">line.get_price()</a>\nretrieves the price (y-coordinate) from a line <code dir=\"auto\">id</code> at a specified\n<code dir=\"auto\">x</code> value, including at bar indices outside the line\u2019s start and\nend points. This function is only compatible with lines that use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\nas the <code dir=\"auto\">xloc</code> value.</li>\n</ul>\n<p>The script below draws a new line upon the onset of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rising\">rising</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.falling\">falling</a>\nprice pattern forming over <code dir=\"auto\">length</code> bars. It uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to declare the <code dir=\"auto\">directionLine</code> variable on the first chart bar.\nThe ID assigned to the <code dir=\"auto\">directionLine</code> persists over subsequent bars\nuntil the <code dir=\"auto\">newDirection</code> condition occurs, in which case the script\nassigns a new line to the variable.</p>\n<p>On every bar, the script calls the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_y2\">line.get_y2()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_y1\">line.get_y1()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_x2\">line.get_x2()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_x1\">line.get_x1()</a>\ngetters as <a href=\"/pine-script-docs/v5/language/methods/\">methods</a> to\nretrieve values from the current <code dir=\"auto\">directionLine</code> and calculate its\n<code dir=\"auto\">slope</code>, which it uses to determine the color of each drawing and plot.\nIt retrieves extended values of the <code dir=\"auto\">directionLine</code> from <em>beyond</em> its\nsecond point using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_price\">line.get_price()</a>\nand <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> them on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Reading-line-values-1.C9ypOdeZ_Gv53Q.webp\" width=\"1276\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reading line values demo\", overlay = true)\n\n//@variable The number of bars for rising and falling calculations.\nint length = input.int(2, \"Length\", 2)\n\n//@variable A line that's drawn whenever `hlc3` starts rising or falling over `length` bars.\nvar line directionLine = na\n\n//@variable Is `true` when `hlc3` is rising over `length` bars, `false` otherwise.\nbool rising = ta.rising(hlc3, length)\n//@variable Is `true` when `hlc3` is falling over `length` bars, `false` otherwise.\nbool falling = ta.falling(hlc3, length)\n//@variable Is `true` when a rising or falling pattern begins, `false` otherwise.\nbool newDirection = (rising and not rising[1]) or (falling and not falling[1])\n\n// Update the `directionLine` when `newDirection` is `true`. The line uses the default `xloc.bar_index`.\nif newDirection\n    directionLine := line.new(bar_index - length, hlc3[length], bar_index, hlc3, width = 3)\n\n//@variable The slope of the `directionLine`.\nfloat slope = (directionLine.get_y2() - directionLine.get_y1()) / (directionLine.get_x2() - directionLine.get_x1())\n//@variable The value extrapolated from the `directionLine` at the `bar_index`.\nfloat lineValue = line.get_price(directionLine, bar_index)\n\n//@variable Is `color.green` when the `slope` is positive, `color.red` otherwise.\ncolor slopeColor = slope &gt; 0 ? color.green : color.red\n\n// Update the color of the `directionLine`.\ndirectionLine.set_color(slopeColor)\n// Plot the `lineValue`.\nplot(lineValue, \"Extrapolated value\", slopeColor, 3, plot.style_circles)</div>\n<p>Note that:</p>\n<ul>\n<li>This example calls the second overload of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nfunction, which uses <code dir=\"auto\">x1</code>, <code dir=\"auto\">y1</code>, <code dir=\"auto\">x2</code>, and <code dir=\"auto\">y2</code> parameters to\ndefine the start and end points of the line. The <code dir=\"auto\">x1</code> value is\n<code dir=\"auto\">length</code> bars behind the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>,\nand the <code dir=\"auto\">y1</code> value is the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>\nvalue at that index. The <code dir=\"auto\">x2</code> and <code dir=\"auto\">y2</code> in the function call use\nthe current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>\nvalues.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_price\">line.get_price()</a>\nfunction call treats the <code dir=\"auto\">directionLine</code> as though it extends\ninfinitely, regardless of its <code dir=\"auto\">extend</code> property.</li>\n<li>The script only displays approximately the last 50 lines on the\nchart, but the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a>\nof extrapolated values spans throughout the chart\u2019s history.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"cloning-lines\"><a href=\"#cloning-lines\">Cloning lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can clone a line <code dir=\"auto\">id</code> and all its properties with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.copy\">line.copy()</a>\nfunction. Any changes to the copied line instance do not affect the\noriginal.</p>\n<p>For example, this script creates a horizontal line at the the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nprice once every <code dir=\"auto\">length</code> bars, which it assigns to a <code dir=\"auto\">mainLine</code>\nvariable. On all other bars, it creates a <code dir=\"auto\">copiedLine</code> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.copy\">line.copy()</a>\nand calls <code dir=\"auto\">line.set_*()</code> functions to\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#modifying-lines\">modify</a> its properties. As we see below, altering the <code dir=\"auto\">copiedLine</code>\ndoes not affect the <code dir=\"auto\">mainLine</code> in any way:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"584\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Cloning-lines-1.C-hcIuCO_ZfTxYF.webp\" width=\"1330\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Cloning lines demo\", overlay = true, max_lines_count = 500)\n\n//@variable The number of bars between each new mainLine assignment.\nint length = input.int(20, \"Length\", 2, 500)\n\n//@variable The first `chart.point` used by the `mainLine`. Contains `index` and `time` information.\nfirstPoint = chart.point.now(open)\n//@variable The second `chart.point` used by the `mainLine`. Does not contain `time` information.\nsecondPoint = chart.point.from_index(bar_index + length, open)\n\n//@variable A horizontal line drawn at the `open` price once every `length` bars.\nvar line mainLine = na\n\nif bar_index % length == 0\n    // Assign a new line to the `mainLine` that connects the `firstPoint` to the `secondPoint`.\n    // This line uses the `index` fields from both points as x-coordinates.\n    mainLine := line.new(firstPoint, secondPoint, color = color.purple, width = 2)\n\n//@variable A copy of the `mainLine`. Changes to this line do not affect the original.\nline copiedLine = line.copy(mainLine)\n\n// Update the color, style, and second point of the `copiedLine`.\nline.set_color(copiedLine, color.orange)\nline.set_style(copiedLine, line.style_dotted)\nline.set_second_point(copiedLine, chart.point.now(close))</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">index</code> field of the <code dir=\"auto\">secondPoint</code> is <code dir=\"auto\">length</code> bars beyond\nthe current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.\nSince the maximum x-coordinate allowed with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\nis <code dir=\"auto\">bar_index + 500</code>, we\u2019ve set the <code dir=\"auto\">maxval</code> of the <code dir=\"auto\">length</code>\ninput to 500.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"deleting-lines\"><a href=\"#deleting-lines\">Deleting lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To delete a line <code dir=\"auto\">id</code> drawn by a script, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>\nfunction. This function removes the line instance from the script and\nits drawing on the chart.</p>\n<p>Deleting line instances is often handy when one wants to only keep a\nspecific number of lines on the chart at any given time or conditionally\nremove drawings as a chart progresses.</p>\n<p>For example, this script draws a horizontal line with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.right\">extend.right</a>\nproperty whenever an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rsi\">RSI</a>\ncrosses its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.ema\">EMA</a>.</p>\n<p>The script stores all line IDs in a <code dir=\"auto\">lines</code> array that it\n<a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">uses as a queue</a> to only display the last <code dir=\"auto\">numberOfLines</code> on the chart. When\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\nof the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nexceeds the specified <code dir=\"auto\">numberOfLines</code>, the script removes the array\u2019s\noldest line ID using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nand deletes it with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Lines-Deleting-lines-1.BO7dBacB_Z1bhgfD.webp\" width=\"1280\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n//@variable The maximum number of lines allowed on the chart.\nconst int MAX_LINES_COUNT = 500\n\nindicator(\"Deleting lines demo\", \"RSI cross levels\", max_lines_count = MAX_LINES_COUNT)\n\n//@variable The length of the RSI.\nint rsiLength = input.int(14, \"RSI length\", 2)\n//@variable The length of the RSI's EMA.\nint emaLength = input.int(28, \"RSI average length\", 2)\n//@variable The maximum number of lines to keep on the chart.\nint numberOfLines = input.int(20, \"Lines on the chart\", 0, MAX_LINES_COUNT)\n\n//@variable An array containing the IDs of lines on the chart.\nvar array&lt;line&gt; lines = array.new&lt;line&gt;()\n\n//@variable An `rsiLength` RSI of `close`.\nfloat rsi = ta.rsi(close, rsiLength)\n//@variable A `maLength` EMA of the `rsi`.\nfloat rsiMA = ta.ema(rsi, emaLength)\n\nif ta.cross(rsi, rsiMA)\n    //@variable The color of the horizontal line.\n    color lineColor = rsi &gt; rsiMA ? color.green : color.red\n    // Draw a new horizontal line. Uses the default `xloc.bar_index`.\n    newLine = line.new(bar_index, rsiMA, bar_index + 1, rsiMA, extend = extend.right, color = lineColor, width = 2)\n    // Push the `newLine` into the `lines` array.\n    lines.push(newLine)\n    // Delete the oldest line when the size of the array exceeds the specified `numberOfLines`.\n    if array.size(lines) &gt; numberOfLines\n        line.delete(lines.shift())\n\n// Plot the `rsi` and `rsiMA`.\nplot(rsi, \"RSI\", color.new(color.blue, 40))\nplot(rsiMA, \"EMA of RSI\", color.new(color.gray, 30))</div>\n<p>Note that:</p>\n<ul>\n<li>We declared a <code dir=\"auto\">MAX_LINES_COUNT</code> variable with the \u201cconst int\u201d\n<em>qualified type</em>, which the script uses as the <code dir=\"auto\">max_lines_count</code>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction and the <code dir=\"auto\">maxval</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\nassigned to the <code dir=\"auto\">numberOfLines</code> variable.</li>\n<li>This example uses the second overload of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\nfunction, which specifies <code dir=\"auto\">x1</code>, <code dir=\"auto\">y1</code>, <code dir=\"auto\">x2</code>, and <code dir=\"auto\">y2</code> coordinates\nindependently.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"filling-the-space-between-lines\"><a href=\"#filling-the-space-between-lines\">Filling the space between lines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can <em>fill</em> the space between two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ndrawings by creating a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nobject that references them with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>\nfunction. Linefills automatically determine their fill boundaries using\nthe properties from the <code dir=\"auto\">line1</code> and <code dir=\"auto\">line2</code> IDs that they reference.</p>\n<p>For example, this script calculates a simple linear regression channel.\nOn the first chart bar, the script declares the <code dir=\"auto\">basisLine</code>,\n<code dir=\"auto\">upperLine</code>, and <code dir=\"auto\">lowerLine</code> variables to reference the channel\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nIDs, then it makes two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>\ncalls to create\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nobjects that fill the upper and lower portions of the channel. The first\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\nfills the space between the <code dir=\"auto\">basisLine</code> and the <code dir=\"auto\">upperLine</code>, and the\nsecond fills the space between the <code dir=\"auto\">basisLine</code> and <code dir=\"auto\">lowerLine</code>.</p>\n<p>The script updates the coordinates of the lines across subsequent bars.\nHowever, notice that the script never needs to update the linefills\ndeclared on the first bar. They automatically update their fill regions\nbased on the coordinates of their assigned lines:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Filling-the-space-between-lines-1.BXRTQC1Z_ZJxot8.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Filling the space between lines demo\", \"Simple linreg channel\", true)\n\n//@variable The number of bars in the linear regression calculation.\nint lengthInput = input.int(100)\n\n//@variable The basis line of the regression channel.\nvar line basisLine = line.new(na, na, na, na, extend = extend.right, color = chart.fg_color, width = 2)\n//@variable The channel's upper line.\nvar line upperLine = line.new(na, na, na, na, extend = extend.right, color = color.teal, width = 2)\n//@variable The channel's lower line.\nvar line lowerLine = line.new(na, na, na, na, extend = extend.right, color = color.maroon, width = 2)\n\n//@variable A linefill instance that fills the space between the `basisLine` and `upperLine`.\nvar linefill upperFill = linefill.new(basisLine, upperLine, color.new(color.teal, 80))\n//@variable A linefill instance that fills the space between the `basisLine` and `lowerLine`.\nvar linefill lowerFill = linefill.new(basisLine, lowerLine, color.new(color.maroon, 80))\n\n// Update the `basisLine` coordinates with current linear regression values.\nbasisLine.set_xy1(bar_index + 1 - lengthInput, ta.linreg(close, lengthInput, lengthInput - 1))\nbasisLine.set_xy2(bar_index, ta.linreg(close, lengthInput, 0))\n\n//@variable The channel's standard deviation.\nfloat stDev = 0.0\nfor i = 0 to lengthInput - 1\n    stDev += math.pow(close[i] - line.get_price(basisLine, bar_index - i), 2)\nstDev := math.sqrt(stDev / lengthInput) * 2.0\n\n// Update the `upperLine` and `lowerLine` using the values from the `basisLine` and the `stDev`.\nupperLine.set_xy1(basisLine.get_x1(), basisLine.get_y1() + stDev)\nupperLine.set_xy2(basisLine.get_x2(), basisLine.get_y2() + stDev)\nlowerLine.set_xy1(basisLine.get_x1(), basisLine.get_y1() - stDev)\nlowerLine.set_xy2(basisLine.get_x2(), basisLine.get_y2() - stDev)</div>\n<p>To learn more about the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>\ntype, see <a href=\"/pine-script-docs/v5/concepts/fills/#line-fills\">this</a>\nsection of the <a href=\"/pine-script-docs/v5/concepts/fills/\">Fills</a> page.</p>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"boxes\"><a href=\"#boxes\">Boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The built-ins in the <code dir=\"auto\">box.*</code> namespace create and manage\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nobjects:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nfunction creates a new box.</li>\n<li>The <code dir=\"auto\">box.set_*()</code> functions modify box properties.</li>\n<li>The <code dir=\"auto\">box.get_*()</code> functions retrieve values from a box instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.copy\">box.copy()</a>\nfunction clones a box instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.delete\">box.delete()</a>\nfunction deletes a box instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_box.all\">box.all</a>\nvariable references a read-only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining the IDs of all boxes displayed by the script. The\narray\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\ndepends on the <code dir=\"auto\">max_boxes_count</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement and the number of boxes the script has drawn.</li>\n</ul>\n<p>As with <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>,\nusers can call <code dir=\"auto\">box.set_*()</code>, <code dir=\"auto\">box.get_*()</code>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.copy\">box.copy()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.delete\">box.delete()</a>\nbuilt-ins as functions or <a href=\"/pine-script-docs/v5/language/methods/\">methods</a>.</p>\n<h3 class=\"md-heading\" id=\"creating-boxes\"><a href=\"#creating-boxes\">Creating boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nfunction creates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nobject to display on the chart. It has the following signatures:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">box.new(top_left, bottom_right, border_color, border_width, border_style, extend, xloc, bgcolor, text, text_size, text_color, text_halign, text_valign, text_wrap, text_font_family, force_overlay) \u2192 series box</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">box.new(left, top, right, bottom, border_color, border_width, border_style, extend, xloc, bgcolor, text, text_size, text_color, text_halign, text_valign, text_wrap, text_font_family, force_overlay) \u2192 series box</span></div></div></code></pre></figure></div>\n<p>This function\u2019s first overload includes the <code dir=\"auto\">top_left</code> and\n<code dir=\"auto\">bottom_right</code> parameters, which accept\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects representing the top-left and bottom-right corners of the box,\nrespectively. The function copies the information from these\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> to set the coordinates of the box\u2019s corners. Whether it\nuses the <code dir=\"auto\">index</code> or <code dir=\"auto\">time</code> fields of the <code dir=\"auto\">top_left</code> and <code dir=\"auto\">bottom_right</code>\npoints as x-coordinates depends on the function\u2019s <code dir=\"auto\">xloc</code> value.</p>\n<p>The second overload specifies <code dir=\"auto\">left</code>, <code dir=\"auto\">top</code>, <code dir=\"auto\">right</code>, and <code dir=\"auto\">bottom</code> edges\nof the box. The <code dir=\"auto\">left</code> and <code dir=\"auto\">right</code> parameters accept\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nvalues specifying the box\u2019s left and right x-coordinates, which can be\nbar index or time values depending on the <code dir=\"auto\">xloc</code> value in the function\ncall. The <code dir=\"auto\">top</code> and <code dir=\"auto\">bottom</code> parameters accept\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues representing the box\u2019s top and bottom y-coordinates.</p>\n<p>The function\u2019s additional parameters are identical in both overloads:</p>\n<p><code dir=\"auto\">border_color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the color of all four of the box\u2019s borders. The default\nis\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.blue\">color.blue</a>.</p>\n<p><code dir=\"auto\">border_width</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the width of the borders, in pixels. Its default value is\n1.</p>\n<p><code dir=\"auto\">border_style</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the style of the borders, which can be any of the options\nin the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#box-styles\">Box styles</a> section of this page.</p>\n<p><code dir=\"auto\">extend</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Determines whether the box\u2019s borders extend infinitely beyond the\nleft or right x-coordinates. It accepts one of the following values:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.left\">extend.left</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.right\">extend.right</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.both\">extend.both</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_extend.none\">extend.none</a>\n(default).</p>\n<p><code dir=\"auto\">xloc</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Determines whether the left and right edges of the box use bar index\nor time values as x-coordinates. The default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>.</p>\n<p class=\"spacer-wrapper\"><spacer/>In the first overload, an <code dir=\"auto\">xloc</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\nmeans that the function will use the <code dir=\"auto\">index</code> fields of the\n<code dir=\"auto\">top_left</code> and <code dir=\"auto\">bottom_right</code> chart points, and an <code dir=\"auto\">xloc</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>\nmeans that it will use their <code dir=\"auto\">time</code> fields.</p>\n<p class=\"spacer-wrapper\"><spacer/>In the second overload, using an <code dir=\"auto\">xloc</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\nmeans the function treats the <code dir=\"auto\">left</code> and <code dir=\"auto\">right</code> values as bar\nindices, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>\nmeans it will treat them as timestamps.</p>\n<p class=\"spacer-wrapper\"><spacer/>When the specified x-coordinates represent <em>bar index</em> values, it\u2019s\nimportant to note that the minimum x-coordinate allowed is\n<code dir=\"auto\">bar_index - 9999</code>. For larger offsets, one can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>.</p>\n<p><code dir=\"auto\">bgcolor</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the background color of the space inside the box. The\ndefault value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.blue\">color.blue</a>.</p>\n<p><code dir=\"auto\">text</code></p>\n<p class=\"spacer-wrapper\"><spacer/>The text to display inside the box. By default, its value is an\nempty string.</p>\n<p><code dir=\"auto\">text_size</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the size of the text within the box. It accepts one of the\nfollowing values:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.tiny\">size.tiny</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.small\">size.small</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.normal\">size.normal</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.large\">size.large</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.huge\">size.huge</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_size.auto\">size.auto</a>\n(default).</p>\n<p><code dir=\"auto\">text_color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Controls the color of the text. Its default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.black\">color.black</a>.</p>\n<p><code dir=\"auto\">text_halign</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the horizontal alignment of the text within the box\u2019s\nboundaries. It accepts one of the following:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_left\">text.align_left</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_right\">text.align_right</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_center\">text.align_center</a>\n(default).</p>\n<p><code dir=\"auto\">text_valign</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the vertical alignment of the text within the box\u2019s\nboundaries. It accepts one of the following:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_top\">text.align_top</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_bottom\">text.align_bottom</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.align_center\">text.align_center</a>\n(default).</p>\n<p><code dir=\"auto\">text_wrap</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Determines whether the box will wrap the text within it. If its\nvalue is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.wrap_auto\">text.wrap_auto</a>,\nthe box wraps the text to ensure it does not span past its vertical\nborders. It also clips the wrapped text when it extends past the\nbottom. If the value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.wrap_none\">text.wrap_none</a>,\nthe box displays the text on a single line that can extend beyond\nits borders. The default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_text.wrap_none\">text.wrap_none</a>.</p>\n<p><code dir=\"auto\">text_font_family</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Defines the font family of the box\u2019s text. Using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_font.family_default\">font.family_default</a>\ndisplays the box\u2019s text with the system\u2019s default font. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_font.family_monospace\">font.family_monospace</a>\ndisplays the text in a monospace format. The default value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_font.family_default\">font.family_default</a>.</p>\n<p><code dir=\"auto\">force_overlay</code></p>\n<p class=\"spacer-wrapper\"><spacer/>If <code dir=\"auto\">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir=\"auto\">false</code>.</p>\n<p>Let\u2019s write a simple script to display boxes on a chart. The example\nbelow draws a box projecting each bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues from the horizontal center of the current bar to the center of\nthe next available bar.</p>\n<p>On each bar, the script creates <code dir=\"auto\">topLeft</code> and <code dir=\"auto\">bottomRight</code> points via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.from_index\">chart.point_from_index()</a>,\nthen calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nto construct a new box and display it on the chart. It also highlights\nthe background on the unconfirmed chart bar using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nto indicate that it redraws that box until the bar\u2019s last update:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"608\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Boxes-Creating-boxes-1.BfHkiDpJ_2qyzFB.webp\" width=\"1334\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Creating boxes demo\", overlay = true)\n\n//@variable The `chart.point` for the top-left corner of the box. Contains `index` and `time` information.\ntopLeft = chart.point.now(high)\n//@variable The `chart.point` for the bottom-right corner of the box. Does not contain `time` information.\nbottomRight = chart.point.from_index(bar_index + 1, low)\n\n// Draw a box using the `topLeft` and `bottomRight` corner points. Uses the `index` fields as x-coordinates.\nbox.new(topLeft, bottomRight, color.purple, 2, bgcolor = color.new(color.gray, 70))\n\n// Color the background on the unconfirmed bar.\nbgcolor(barstate.isconfirmed ? na : color.new(color.orange, 70), title = \"Unconfirmed bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">bottomRight</code> point\u2019s <code dir=\"auto\">index</code> field is one bar greater than\nthe <code dir=\"auto\">index</code> in the <code dir=\"auto\">topLeft</code>. If the x-coordinates of the\ncorners were equal, the script would draw a vertical line at the\nhorizontal center of each bar, resembling the example in this\npage\u2019s\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#creating-lines\">Creating lines</a> section.</li>\n<li>Similar to <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, if the <code dir=\"auto\">topLeft</code> and <code dir=\"auto\">bottomRight</code> contained\nidentical coordinates, the box wouldn\u2019t display on the chart\nsince there would be no space between them to draw. However, its\nID would still exist.</li>\n<li>This script only displays approximately the last 50 boxes on the\nchart, as we have not specified a <code dir=\"auto\">max_boxes_count</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"modifying-boxes\"><a href=\"#modifying-boxes\">Modifying boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Multiple <em>setter</em> functions exist in the <code dir=\"auto\">box.*</code> namespace, allowing\nscripts to modify the properties of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nobjects:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_top_left_point\">box.set_top_left_point()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_bottom_right_point\">box.set_bottom_right_point()</a>\nrespectively update the top-left and bottom-right coordinates of the\n<code dir=\"auto\">id</code> box using information from the specified <code dir=\"auto\">point</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_left\">box.set_left()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_right\">box.set_right()</a>\nset the left or right x-coordinate of the <code dir=\"auto\">id</code> box to a new\n<code dir=\"auto\">left/right</code> value, which can be a bar index or time value depending\non the box\u2019s <code dir=\"auto\">xloc</code> property.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_top\">box.set_top()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_bottom\">box.set_bottom()</a>\nset the top or bottom y-coordinate of the <code dir=\"auto\">id</code> box to a new\n<code dir=\"auto\">top/bottom</code> value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_lefttop\">box.set_lefttop()</a>\nsets the <code dir=\"auto\">left</code> and <code dir=\"auto\">top</code> coordinates of the <code dir=\"auto\">id</code> box, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_rightbottom\">box.set_rightbottom()</a>\nsets its <code dir=\"auto\">right</code> and <code dir=\"auto\">bottom</code> coordinates.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_border_color\">box.set_border_color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_border_width\">box.set_border_width()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_border_style\">box.set_border_style()</a>\nrespectively update the <code dir=\"auto\">color</code>, <code dir=\"auto\">width</code>, and <code dir=\"auto\">style</code> of the <code dir=\"auto\">id</code>\nbox\u2019s border.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_extend\">box.set_extend()</a>\nsets the horizontal <code dir=\"auto\">extend</code> property of the <code dir=\"auto\">id</code> box.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_bgcolor\">box.set_bgcolor()</a>\nsets the color of the space inside the <code dir=\"auto\">id</code> box to a new <code dir=\"auto\">color</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text\">box.set_text()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_size\">box.set_text_size()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_color\">box.set_text_color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_halign\">box.set_text_halign()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_valign\">box.set_text_valign()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_wrap\">box.set_text_wrap()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_text_font_family\">box.set_text_font_family()</a>\nupdate the <code dir=\"auto\">id</code> box\u2019s text-related properties.</li>\n</ul>\n<p>As with setter functions in the <code dir=\"auto\">line.*</code> namespace, all box setters\nmodify the <code dir=\"auto\">id</code> box directly without returning a value, and each setter\nfunction accepts \u201cseries\u201d arguments.</p>\n<p>Note that, unlike <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, the <code dir=\"auto\">box.*</code> namespace does not contain a setter function to\nmodify a box\u2019s <code dir=\"auto\">xloc</code>. Users must\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#creating-boxes\">create</a> a new box with the desired <code dir=\"auto\">xloc</code> setting for such cases.</p>\n<p>This example uses boxes to visualize the ranges of upward and downward\nbars with the highest\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nover a user-defined <code dir=\"auto\">timeframe</code>. When the script detects a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">change</a>\nin the <code dir=\"auto\">timeframe</code>, it assigns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">new\nboxes</a>\nto its <code dir=\"auto\">upBox</code> and <code dir=\"auto\">downBox</code> variables, resets its <code dir=\"auto\">upVolume</code> and\n<code dir=\"auto\">downVolume</code> values, and highlights the chart background.</p>\n<p>When an upward or downward bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nexceeds the <code dir=\"auto\">upVolume</code> or <code dir=\"auto\">downVolume</code>, the script updates the\nvolume-tracking variables and calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_top_left_point\">box.set_top_left_point()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_bottom_right_point\">box.set_bottom_right_point()</a>\nto update the <code dir=\"auto\">upBox</code> or <code dir=\"auto\">downBox</code> coordinates. The setters use the\ninformation from the\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> created with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.from_time\">chart.point.from_time()</a>\nto project that bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues from the current time to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">closing\ntime</a>\nof the <code dir=\"auto\">timeframe</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"604\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Boxes-Modifying-boxes-1.Bj141v5c_297ln.webp\" width=\"1330\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Modifying boxes demo\", \"High volume boxes\", true, max_boxes_count = 100)\n\n//@variable The timeframe of the calculation.\nstring timeframe = input.timeframe(\"D\", \"Timeframe\")\n\n//@variable A box projecting the range of the upward bar with the highest `volume` over the `timeframe`.\nvar box upBox = na\n//@variable A box projecting the range of the downward bar with the lowest `volume` over the `timeframe`.\nvar box downBox = na\n//@variable The highest volume of upward bars over the `timeframe`.\nvar float upVolume = na\n//@variable The highest volume of downward bars over the `timeframe`.\nvar float downVolume = na\n\n// Color variables.\nvar color upBorder   = color.teal\nvar color upFill     = color.new(color.teal, 90)\nvar color downBorder = color.maroon\nvar color downFill   = color.new(color.maroon, 90)\n\n//@variable The closing time of the `timeframe`.\nint closeTime = time_close(timeframe)\n//@variable Is `true` when a new bar starts on the `timeframe`.\nbool changeTF = timeframe.change(timeframe)\n\n//@variable The `chart.point` for the top-left corner of the boxes. Contains `index` and `time` information.\ntopLeft = chart.point.now(high)\n//@variable The `chart.point` for the bottom-right corner of the boxes. Does not contain `index` information.\nbottomRight = chart.point.from_time(closeTime, low)\n\nif changeTF and not na(volume)\n    if close &gt; open\n        // Update `upVolume` and `downVolume` values.\n        upVolume   := volume\n        downVolume := 0.0\n        // Draw a new `upBox` using `time` and `price` info from the `topLeft` and `bottomRight` points.\n        upBox := box.new(topLeft, bottomRight, upBorder, 3, xloc = xloc.bar_time, bgcolor = upFill)\n        // Draw a new `downBox` with `na` coordinates.\n        downBox := box.new(na, na, na, na, downBorder, 3, xloc = xloc.bar_time, bgcolor = downFill)\n    else\n        // Update `upVolume` and `downVolume` values.\n        upVolume   := 0.0\n        downVolume := volume\n        // Draw a new `upBox` with `na` coordinates.\n        upBox := box.new(na, na, na, na, upBorder, 3, xloc = xloc.bar_time, bgcolor = upFill)\n        // Draw a new `downBox` using `time` and `price` info from the `topLeft` and `bottomRight` points.\n        downBox := box.new(topLeft, bottomRight, downBorder, 3, xloc = xloc.bar_time, bgcolor = downFill)\n// Update the ``upVolume`` and change the ``upBox`` coordinates when volume increases on an upward bar.\nelse if close &gt; open and volume &gt; upVolume\n    upVolume := volume\n    box.set_top_left_point(upBox, topLeft)\n    box.set_bottom_right_point(upBox, bottomRight)\n// Update the ``downVolume`` and change the ``downBox`` coordinates when volume increases on a downward bar.\nelse if close &lt;= open and volume &gt; downVolume\n    downVolume := volume\n    box.set_top_left_point(downBox, topLeft)\n    box.set_bottom_right_point(downBox, bottomRight)\n\n// Highlight the background when a new `timeframe` bar starts.\nbgcolor(changeTF ? color.new(color.orange, 70) : na, title = \"Timeframe change highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call contains <code dir=\"auto\">max_boxes_count = 100</code>, meaning the\nscript will preserve the last 100 boxes on the chart.</li>\n<li>We utilized <em>both overloads</em> of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nin this example. On the first bar of the <code dir=\"auto\">timeframe</code>, the script\ncalls the first overload for the <code dir=\"auto\">upBox</code> when the bar is rising,\nand it calls that overload for the <code dir=\"auto\">downBox</code> when the bar is\nfalling. It uses the second overload to assign a new box with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues to the other box variable on that bar.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"box-styles\"><a href=\"#box-styles\">Box styles<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users can include one of the following <code dir=\"auto\">line.style_*</code> variables in their\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_border_style\">box.set_border_style()</a>\nfunction calls to set the border styles of boxes drawn by their scripts:</p>\n<hr/>\n<table><thead><tr><th>Argument</th><th>Box</th></tr></thead><tbody><tr><td><code dir=\"auto\">line.style_solid</code></td><td><img alt=\"box_style_solid\" decoding=\"async\" height=\"88\" loading=\"lazy\" src=\"/pine-script-docs/_astro/box.style_solid.DpZnFQGZ_2oQNCW.webp\" width=\"125\"/></td></tr><tr><td><code dir=\"auto\">line.style_dotted</code></td><td><img alt=\"box_style_dotted\" decoding=\"async\" height=\"88\" loading=\"lazy\" src=\"/pine-script-docs/_astro/box.style_dotted.DQk4-fDM_Z23lye8.webp\" width=\"125\"/></td></tr><tr><td><code dir=\"auto\">line.style_dashed</code></td><td><img alt=\"box_style_dashed\" decoding=\"async\" height=\"88\" loading=\"lazy\" src=\"/pine-script-docs/_astro/box.style_dashed.BezJLOhC_Z1FMPte.webp\" width=\"125\"/></td></tr></tbody></table>\n<h3 class=\"md-heading\" id=\"reading-box-values\"><a href=\"#reading-box-values\">Reading box values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">box.*</code> namespace features <em>getter</em> functions that allow scripts to\nretrieve coordinate values from a box instance:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_left\">box.get_left()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_right\">box.get_right()</a>\nrespectively get the x-coordinates of the left and right edges of\nthe <code dir=\"auto\">id</code> box. Whether the value returned represents a bar index or\ntime value depends on the box\u2019s <code dir=\"auto\">xloc</code> property.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_top\">box.get_top()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_bottom\">box.get_bottom()</a>\nrespectively get the top and bottom y-coordinates of the <code dir=\"auto\">id</code> box.</li>\n</ul>\n<p>The example below draws boxes to visualize hypothetical price ranges\nover a period of <code dir=\"auto\">length</code> bars. At the start of each new period, it uses\nthe average candle range multiplied by the <code dir=\"auto\">scaleFactor</code> input to\ncalculate the corner points of a box centered at the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>\nprice with an <code dir=\"auto\">initialRange</code> height. After drawing the first box, it\ncreates <code dir=\"auto\">numberOfBoxes - 1</code> new boxes inside a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloop.</p>\n<p>Within each loop iteration, the script gets the <code dir=\"auto\">lastBoxDrawn</code> by\nretrieving the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.last\">last</a>\nelement from the read-only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_box.all\">box.all</a>\narray, then calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_top\">box.get_top()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_bottom\">box.get_bottom()</a>\nto get its y-coordinates. It uses these values to calculate the\ncoordinates for a new box that\u2019s <code dir=\"auto\">scaleFactor</code> times taller than the\nprevious:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"608\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Boxes-Reading-box-values-1.BjHiyYzc_1hj7GF.webp\" width=\"1332\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reading box values demo\", \"Nested boxes\", overlay = true, max_boxes_count = 500)\n\n//@variable The number of bars in the range calculation.\nint length = input.int(10, \"Length\", 2, 500)\n//@variable The number of nested boxes drawn on each period.\nint numberOfBoxes = input.int(5, \"Nested box count\", 1)\n//@variable The scale factor applied to each box.\nfloat scaleFactor = input.float(1.6, \"Scale factor\", 1)\n\n//@variable The initial box range.\nfloat initialRange = scaleFactor * ta.sma(high - low, length)\n\nif bar_index % length == 0\n    //@variable The top-left `chart.point` for the initial box. Does not contain `time` information.\n    topLeft = chart.point.from_index(bar_index, hl2 + initialRange / 2)\n    //@variable The bottom-right `chart.point` for the initial box. Does not contain `time` information.\n    bottomRight = chart.point.from_index(bar_index + length, hl2 - initialRange / 2)\n\n    // Calculate border and fill colors of the boxes.\n    borderColor = color.rgb(math.random(100, 255), math.random(0, 100), math.random(100, 255))\n    bgColor = color.new(borderColor, math.max(100 * (1 - 1/numberOfBoxes), 90))\n\n    // Draw a new box using the `topLeft` and `bottomRight` points. Uses their `index` fields as x-coordinates.\n    box.new(topLeft, bottomRight, borderColor, 2, bgcolor = bgColor)\n\n    if numberOfBoxes &gt; 1\n        // Loop to create additional boxes.\n        for i = 1 to numberOfBoxes - 1\n            //@variable The last box drawn by the script.\n            box lastBoxDrawn = box.all.last()\n\n            //@variable The top price of the last box.\n            float top = box.get_top(lastBoxDrawn)\n            //@variable The bottom price of the last box.\n            float bottom = box.get_bottom(lastBoxDrawn)\n\n            //@variable The scaled range of the new box.\n            float newRange = scaleFactor * (top - bottom) * 0.5\n\n            // Update the `price` fields of the `topLeft` and `bottomRight` points.\n            // This does not affect the coordinates of previous boxes.\n            topLeft.price     := hl2 + newRange\n            bottomRight.price := hl2 - newRange\n\n            // Draw a new box using the updated `topLeft` and `bottomRight` points.\n            box.new(topLeft, bottomRight, borderColor, 2, bgcolor = bgColor)</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call uses <code dir=\"auto\">max_boxes_count = 500</code>, meaning the script\ncan display up to 500 boxes on the chart.</li>\n<li>Each drawing has a <code dir=\"auto\">right</code> index <code dir=\"auto\">length</code> bars beyond the <code dir=\"auto\">left</code>\nindex. Since the x-coordinates of these drawings can be up to\n500 bars into the future, we\u2019ve set the <code dir=\"auto\">maxval</code> of the\n<code dir=\"auto\">length</code> input to 500.</li>\n<li>On each new period, the script uses randomized\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.rgb\">color.rgb()</a>\nvalues for the <code dir=\"auto\">border_color</code> and <code dir=\"auto\">bgcolor</code> of the boxes.</li>\n<li>Each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\ncall copies the coordinates from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects assigned to the <code dir=\"auto\">topLeft</code> and <code dir=\"auto\">bottomRight</code> variables,\nwhich is why the script can modify their <code dir=\"auto\">price</code> fields on each\nloop iteration without affecting the other boxes.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"cloning-boxes\"><a href=\"#cloning-boxes\">Cloning boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To clone a specific box <code dir=\"auto\">id</code>, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.copy\">box.copy()</a>.\nThis function copies the box and its properties. Any changes to the\ncopied box do not affect the original.</p>\n<p>For example, this script declares an <code dir=\"auto\">originalBox</code> variable on the first\nbar and assigns a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">new\nbox</a>\nto it once every <code dir=\"auto\">length</code> bars. On other bars, it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.copy\">box.copy()</a>\nto create a <code dir=\"auto\">copiedBox</code> and calls <code dir=\"auto\">box.set_*()</code> functions to\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#modifying-boxes\">modify</a> its properties. As shown on the chart below, these changes\ndo not modify the <code dir=\"auto\">originalBox</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"604\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Boxes-Cloning-boxes-1.C3LhZvV5_2sfgJn.webp\" width=\"1334\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Cloning boxes demo\", overlay = true, max_boxes_count = 500)\n\n//@variable The number of bars between each new mainLine assignment.\nint length = input.int(20, \"Length\", 2)\n\n//@variable The `chart.point` for the top-left of the `originalBox`. Contains `time` and `index` information.\ntopLeft = chart.point.now(high)\n//@variable The `chart.point` for the bottom-right of the `originalBox`. Does not contain `time` information.\nbottomRight = chart.point.from_index(bar_index + 1, low)\n\n//@variable A new box with `topLeft` and `bottomRight` corners on every `length` bars.\nvar box originalBox = na\n\n//@variable Is teal when the bar is rising, maroon when it's falling.\ncolor originalColor = close &gt; open ? color.teal : color.maroon\n\nif bar_index % length == 0\n    // Assign a new box using the `topLeft` and `bottomRight` info to the `originalBox`.\n    // This box uses the `index` fields from the points as x-coordinates.\n    originalBox := box.new(topLeft, bottomRight, originalColor, 2, bgcolor = color.new(originalColor, 60))\nelse\n    //@variable A clone of the `originalBox`.\n    box copiedBox = box.copy(originalBox)\n    // Modify the `copiedBox`. These changes do not affect the `originalBox`.\n    box.set_top(copiedBox, high)\n    box.set_bottom_right_point(copiedBox, bottomRight)\n    box.set_border_color(copiedBox, color.gray)\n    box.set_border_width(copiedBox, 1)\n    box.set_bgcolor(copiedBox, na)</div>\n<h3 class=\"md-heading\" id=\"deleting-boxes\"><a href=\"#deleting-boxes\">Deleting boxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To delete boxes drawn by a script, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.delete\">box.delete()</a>.\nAs with <code dir=\"auto\">*.delete()</code> functions in other drawing namespaces, this\nfunction is handy for conditionally removing boxes or maintaining a\nspecific number of boxes on the chart.</p>\n<p>This example displays boxes representing periodic cumulative volume\nvalues. The script\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#creating-boxes\">creates</a> a new box ID and stores it in a <code dir=\"auto\">boxes</code> array once every\n<code dir=\"auto\">length</code> bars. If the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array\u2019s\nsize</a>\nexceeds the specified <code dir=\"auto\">numberOfBoxes</code>, the script removes the oldest box\nfrom the array using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nand deletes it using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.delete\">box.delete()</a>.</p>\n<p>On other bars, it accumulates\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nover each period by\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#modifying-boxes\">modifying</a> the <code dir=\"auto\">top</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.last\">last</a>\nbox in the <code dir=\"auto\">boxes</code> array. The script then uses\n<a href=\"/pine-script-docs/v5/language/loops/#for-loops\">`for` loops</a> to find the\n<code dir=\"auto\">highestTop</code> of all the array\u2019s boxes and set the <code dir=\"auto\">bgcolor</code> of each box\nwith a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.from_gradient\">gradient\ncolor</a>\nbased on its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_top\">box.get_top()</a>\nvalue relative to the <code dir=\"auto\">highestTop</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"608\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Boxes-Deleting-boxes-1.CnAZt6YV_ZXP4os.webp\" width=\"1326\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n//@variable The maximum number of boxes to show on the chart.\nconst int MAX_BOXES_COUNT = 500\n\nindicator(\"Deleting boxes demo\", \"Cumulative volume boxes\", format = format.volume, max_boxes_count = MAX_BOXES_COUNT)\n\n//@variable The number of bars in each period.\nint length = input.int(20, \"Length\", 1)\n//@variable The maximum number of volume boxes in the calculation.\nint numberOfBoxes = input.int(10, \"Number of boxes\", 1, MAX_BOXES_COUNT)\n\n//@variable An array containing the ID of each box displayed by the script.\nvar boxes = array.new&lt;box&gt;()\n\nif bar_index % length == 0\n    // Push a new box into the `boxes` array. The box has the default `xloc.bar_index` property.\n    boxes.push(box.new(bar_index, 0, bar_index + 1, 0, #000000, 2, text_color = #000000))\n    // Shift the oldest box out of the array and delete it when the array's size exceeds the `numberOfBoxes`.\n    if boxes.size() &gt; numberOfBoxes\n        box.delete(boxes.shift())\n\n//@variable The last box drawn by the script as of the current chart bar.\nbox lastBox = boxes.last()\n// Add the current bar's volume to the top of the `lastBox` and update the `right` index.\nlastBox.set_top(lastBox.get_top() + volume)\nlastBox.set_right(bar_index + 1)\n// Display the top of the `lastBox` as volume-formatted text.\nlastBox.set_text(str.tostring(lastBox.get_top(), format.volume))\n\n//@variable The highest `top` of all boxes in the `boxes` array.\nfloat highestTop = 0.0\nfor id in boxes\n    highestTop := math.max(id.get_top(), highestTop)\n\n// Set the `bgcolor` of each `id` in `boxes` with a gradient based on the ratio of its `top` to the `highestTop`.\nfor id in boxes\n    id.set_bgcolor(color.from_gradient(id.get_top() / highestTop, 0, 1, color.purple, color.orange))</div>\n<p>Note that:</p>\n<ul>\n<li>At the top of the code, we\u2019ve declared a <code dir=\"auto\">MAX_BOXES_COUNT</code>\nvariable with the \u201cconst int\u201d <em>qualified type</em>. We use this\nvalue as the <code dir=\"auto\">max_boxes_count</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction and the maximum possible value of the <code dir=\"auto\">numberOfBoxes</code>\ninput.</li>\n<li>This script uses the second overload of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nfunction, which specifies the box\u2019s <code dir=\"auto\">left</code>, <code dir=\"auto\">top</code>, <code dir=\"auto\">right</code>, and\n<code dir=\"auto\">bottom</code> coordinates separately.</li>\n<li>We\u2019ve included\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_format.volume\">format.volume</a>\nas the <code dir=\"auto\">format</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ncall, which tells the script that the y-axis of the chart pane\nrepresents <em>volume</em> values. Each box also displays its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.get_top\">top</a>\nvalue as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_format.volume\">volume-formatted</a>\ntext.</li>\n</ul>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"polylines\"><a href=\"#polylines\">Polylines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script polylines are <strong>advanced</strong> drawings that sequentially\nconnect the coordinates from an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ninstances using straight or <em>curved</em> line segments.</p>\n<p>These powerful drawings can connect up to 10,000 points at any available\nlocation on the chart, allowing scripts to draw custom series, polygons,\nand other complex geometric formations that are otherwise difficult or\nimpossible to draw using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nobjects.</p>\n<p>The <code dir=\"auto\">polyline.*</code> namespace features the following built-ins for creating\nand managing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\nobjects:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\nfunction creates a new polyline instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.delete\">polyline.delete()</a>\nfunction deletes an existing polyline instance.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_polyline.all\">polyline.all</a>\nvariable references a read-only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining the IDs of all polylines displayed by the script. The\narray\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\ndepends on the <code dir=\"auto\">max_polylines_count</code> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement and the number of polylines drawn by the\nscript.</li>\n</ul>\n<p>Unlike <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>\nor <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>,\npolylines do not have functions for modification or reading their\nproperties. To redraw a polyline on the chart, one can <em>delete</em> the\nexisting instance and <em>create</em> a new polyline with the desired changes.</p>\n<h3 class=\"md-heading\" id=\"creating-polylines\"><a href=\"#creating-polylines\">Creating polylines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\nfunction creates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\ninstance to display on the chart. It has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">polyline.new(points, curved, closed, xloc, line_color, fill_color, line_style, line_width, force_overlay) \u2192 series polyline</span></div></div></code></pre></figure></div>\n<p>The following eight parameters affect the behavior of a polyline\ndrawing:</p>\n<p><code dir=\"auto\">points</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Accepts an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects that determine the coordinates of each point in the\npolyline. The drawing connects the coordinates from each element in\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nsequentially, starting from the <em>first</em>. Whether the polyline uses\nthe <code dir=\"auto\">index</code> or <code dir=\"auto\">time</code> field from each\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart point</a> for its x-coordinates depends on the <code dir=\"auto\">xloc</code> value in the\nfunction call.</p>\n<p><code dir=\"auto\">curved</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies whether the drawing uses curved line segments to connect\neach\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin the <code dir=\"auto\">points</code> array. The default value is <code dir=\"auto\">false</code>, meaning it uses\nstraight line segments.</p>\n<p><code dir=\"auto\">closed</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Controls whether the polyline will connect the last\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin the <code dir=\"auto\">points</code> array to the first, forming a <em>closed polyline</em>. The\ndefault value is <code dir=\"auto\">false</code>.</p>\n<p><code dir=\"auto\">xloc</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies which field from each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin the <code dir=\"auto\">points</code> array the polyline uses for its x-coordinates. When\nits value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>,\nthe function uses the <code dir=\"auto\">index</code> fields to create the polyline. When\nits value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>,\nthe function uses the <code dir=\"auto\">time</code> fields. The default value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>.</p>\n<p><code dir=\"auto\">line_color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the color of all line segments in the polyline drawing.\nThe default is <code dir=\"auto\">color.blue</code>.</p>\n<p><code dir=\"auto\">fill_color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Controls the color of the closed space filled by the polyline\ndrawing. Its default value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p><code dir=\"auto\">line_style</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the style of the polyline, which can be any of the\navailable options in the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#line-styles\">Line styles</a> section of this page. The default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_line.style_solid\">line.style_solid</a>.</p>\n<p><code dir=\"auto\">line_width</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Specifies the width of the polyline, in pixels. The default value is\n1.</p>\n<p><code dir=\"auto\">force_overlay</code></p>\n<p class=\"spacer-wrapper\"><spacer/>If <code dir=\"auto\">true</code>, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir=\"auto\">false</code>.</p>\n<p>This script demonstrates a simple example of drawing a polyline on the\nchart. It\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">pushes</a>\na new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nwith an alternating <code dir=\"auto\">price</code> value into a <code dir=\"auto\">points</code> array and colors the\nbackground with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nonce every <code dir=\"auto\">length</code> bars.</p>\n<p>On the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islastconfirmedhistory\">last confirmed historical\nbar</a>,\nthe script draws a new polyline on the chart, connecting the coordinates\nfrom each\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart point</a> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nstarting from the first:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"552\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-1.trunruUb_1O2zpI.webp\" width=\"1348\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Creating polylines demo\", \"Oscillating polyline\")\n\n//@variable The number of bars between each point in the drawing.\nint length = input.int(20, \"Length between points\", 2)\n\n//@variable An array of `chart.point` objects to sequentially connect with a polyline.\nvar points = array.new&lt;chart.point&gt;()\n\n//@variable The y-coordinate of each point in the `points`. Alternates between 1 and -1 on each `newPoint`.\nvar int yValue = 1\n\n//@variable Is `true` once every `length` bars, `false` otherwise.\nbool newPoint = bar_index % length == 0\n\nif newPoint\n    // Push a new `chart.point` into the `points`. The new point contains `time` and `index` info.\n    points.push(chart.point.now(yValue))\n    // Change the sign of the `yValue`.\n    yValue *= -1\n\n// Draw a new `polyline` on the last confirmed historical chart bar.\n// The polyline uses the `time` field from each `chart.point` in the `points` array as x-coordinates.\nif barstate.islastconfirmedhistory\n    polyline.new(points, xloc = xloc.bar_time, line_color = #9151A6, line_width = 3)\n\n// Highlight the chart background on every `newPoint` condition.\nbgcolor(newPoint ? color.new(color.gray, 70) : na, title = \"New point highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>This script uses only <em>one</em> polyline to connect each\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart point</a> from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nwith straight line segments, and this drawing spans throughout\nthe available chart data, starting from the first bar.</li>\n<li>While one can achieve a similar effect using\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>,\ndoing so would require a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstance on each occurrence of the <code dir=\"auto\">newPoint</code> condition, and\nsuch a drawing would be limited to a maximum of 500 line\nsegments. This single unclosed polyline drawing, on the other\nhand, can contain up to 9,999 line segments.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"curved-drawings\"><a href=\"#curved-drawings\">Curved drawings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Polylines can draw <em>curves</em> that are otherwise impossible to produce\nwith <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> or\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>. When\nenabling the <code dir=\"auto\">curved</code> parameter of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\nfunction, the resulting polyline interpolates <em>nonlinear</em> values between\nthe coordinates from each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof <code dir=\"auto\">points</code> to generate a curvy effect.</p>\n<p>For instance, the \u201cOscillating polyline\u201d script in our previous\nexample uses <em>straight</em> line segments to produce a drawing resembling a\ntriangle wave, meaning a waveform that zig-zags between its peaks and\nvalleys. If we set the <code dir=\"auto\">curved</code> parameter in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\ncall from that example to <code dir=\"auto\">true</code>, the resulting drawing would connect\nthe points using <em>curved</em> segments, producing a smooth, nonlinear shape\nsimilar to a sine wave:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"552\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Curved-drawings-1.BWGXS3tj_10tSGQ.webp\" width=\"1348\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Curved drawings demo\", \"Smooth oscillating polyline\")\n\n//@variable The number of bars between each point in the drawing.\nint length = input.int(20, \"Length between points\", 2)\n\n//@variable An array of `chart.point` objects to sequentially connect with a polyline.\nvar points = array.new&lt;chart.point&gt;()\n\n//@variable The y-coordinate of each point in the `points`. Alternates between 1 and -1 on each `newPoint`.\nvar int yValue = 1\n\n//@variable Is `true` once every `length` bars, `false` otherwise.\nbool newPoint = bar_index % length == 0\n\nif newPoint\n    // Push a new `chart.point` into the `points`. The new point contains `time` and `index` info.\n    points.push(chart.point.now(yValue))\n    // Change the sign of the `yValue`.\n    yValue *= -1\n\n// Draw a new curved `polyline` on the last confirmed historical chart bar.\n// The polyline uses the `time` field from each `chart.point` in the `points` array as x-coordinates.\nif barstate.islastconfirmedhistory\n    polyline.new(points, curved = true, xloc = xloc.bar_time, line_color = #9151A6, line_width = 3)\n\n// Highlight the chart background on every `newPoint` condition.\nbgcolor(newPoint ? color.new(color.gray, 70) : na, title = \"New point highlight\")</div>\n<p>Notice that in this example, the smooth curves have relatively\nconsistent behavior, and no portion of the drawing extends past its\ndefined coordinates, which is not always the case when drawing curved\npolylines. The data used to construct a polyline heavily impacts the\nsmooth, piecewise function it interpolates between its points. In some\ncases, the interpolated curve <em>can</em> reach beyond its actual coordinates.</p>\n<p>Let\u2019s add some variation to the\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> in our example\u2019s <code dir=\"auto\">points</code> array to demonstrate this\nbehavior. In the version below, the script multiplies the <code dir=\"auto\">yValue</code> by a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a>\nvalue in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a>\ncalls.</p>\n<p>To visualize the behavior, this script also creates a horizontal\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nat the <code dir=\"auto\">price</code> value from each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin the <code dir=\"auto\">points</code> array, and it displays another polyline connecting the\nsame points with straight line segments. As we see on the chart, both\npolylines pass through all coordinates from the <code dir=\"auto\">points</code> array. However,\nthe curvy polyline occasionally reaches <em>beyond</em> the vertical boundaries\nindicated by the horizontal\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, whereas\nthe polyline drawn using straight segments does not:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"552\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Curved-drawings-2.Bh30lTw9_2uiiOc.webp\" width=\"1348\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Curved drawings demo\", \"Random oscillating polylines\")\n\n//@variable The number of bars between each point in the drawing.\nint length = input.int(20, \"Length between points\", 2)\n\n//@variable An array of `chart.point` objects to sequentially connect with a polyline.\nvar points = array.new&lt;chart.point&gt;()\n\n//@variable The sign of each `price` in the `points`. Alternates between 1 and -1 on each `newPoint`.\nvar int yValue = 1\n\n//@variable Is `true` once every `length` bars.\nbool newPoint = bar_index % length == 0\n\nif newPoint\n    // Push a new `chart.point` with a randomized `price` into the `points`.\n    // The new point contains `time` and `index` info.\n    points.push(chart.point.now(yValue * math.random()))\n    // Change the sign of the `yValue`.\n    yValue *= -1\n\n    //@variable The newest `chart.point`.\n    lastPoint = points.last()\n    // Draw a horizontal line at the `lastPoint.price`. This line uses the default `xloc.bar_index`.\n    line.new(lastPoint.index - length, lastPoint.price, lastPoint.index + length, lastPoint.price, color = color.red)\n\n// Draw two `polyline` instances on the last confirmed chart bar.\n// Both polylines use the `time` field from each `chart.point` in the `points` array as x-coordinates.\nif barstate.islastconfirmedhistory\n    polyline.new(points, curved = false, xloc = xloc.bar_time, line_color = #EB8A3B, line_width = 2)\n    polyline.new(points, curved = true, xloc = xloc.bar_time, line_color = #9151A6, line_width = 3)\n\n// Highlight the chart background on every `newPoint` condition.\nbgcolor(newPoint ? color.new(color.gray, 70) : na, title = \"New point highlight\")</div>\n<h4 class=\"md-heading\" id=\"closed-shapes\"><a href=\"#closed-shapes\">Closed shapes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Since a single polyline can contain numerous straight or curved line\nsegments, and the <code dir=\"auto\">closed</code> parameter allows the drawing to connect the\ncoordinates from the first and last\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nin its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof <code dir=\"auto\">points</code>, we can use polylines to draw many different types of closed\npolygonal shapes.</p>\n<p>Let\u2019s draw some polygons in Pine. The following script periodically\ndraws randomized polygons centered at\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>\nprice values.</p>\n<p>On each occurrence of the <code dir=\"auto\">newPolygon</code> condition, it\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.clear\">clears</a>\nthe <code dir=\"auto\">points</code> array, calculates the <code dir=\"auto\">numberOfSides</code> and <code dir=\"auto\">rotationOffset</code>\nof the new polygon drawing based on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">math.random()</a>\nvalues, then uses a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">`for` loop</a> to push <code dir=\"auto\">numberOfSides</code> new\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> into the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nthat contain stepped coordinates from an elliptical path with <code dir=\"auto\">xScale</code>\nand <code dir=\"auto\">yScale</code> semi-axes. The script draws the polygon by connecting each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nfrom the <code dir=\"auto\">points</code> array using a <em>closed polyline</em> with straight line\nsegments:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"612\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Creating-polylines-Closed-shapes-1.DX7VAEme_ZOQPTt.webp\" width=\"1332\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Closed shapes demo\", \"N-sided polygons\", true)\n\n//@variable The size of the horizontal semi-axis.\nfloat xScale = input.float(3.0, \"X scale\", 1.0)\n//@variable The size of the vertical semi-axis.\nfloat yScale = input.float(1.0, \"Y scale\") * ta.atr(2)\n\n//@variable An array of `chart.point` objects containing vertex coordinates.\nvar points = array.new&lt;chart.point&gt;()\n\n//@variable The condition that triggers a new polygon drawing. Based on the horizontal axis to prevent overlaps.\nbool newPolygon = bar_index % int(math.round(2 * xScale)) == 0 and barstate.isconfirmed\n\nif newPolygon\n    // Clear the `points` array.\n    points.clear()\n\n    //@variable The number of sides and vertices in the new polygon.\n    int numberOfSides = int(math.random(3, 7))\n    //@variable A random rotation offset applied to the new polygon, in radians.\n    float rotationOffset = math.random(0.0, 2.0) * math.pi\n    //@variable The size of the angle between each vertex, in radians.\n    float step = 2 * math.pi / numberOfSides\n\n    //@variable The counter-clockwise rotation angle of each vertex.\n    float angle = rotationOffset\n\n    for i = 1 to numberOfSides\n        //@variable The approximate x-coordinate from an ellipse at the `angle`, rounded to the nearest integer.\n        int xValue = int(math.round(xScale * math.cos(angle))) + bar_index\n        //@variable The y-coordinate from an ellipse at the `angle`.\n        float yValue = yScale * math.sin(angle) + hl2\n\n        // Push a new `chart.point` containing the `xValue` and `yValue` into the `points` array.\n        // The new point does not contain `time` information.\n        points.push(chart.point.from_index(xValue, yValue))\n        // Add the `step` to the `angle`.\n        angle += step\n\n    // Draw a closed polyline connecting the `points`.\n    // The polyline uses the `index` field from each `chart.point` in the `points` array.\n    polyline.new(\n         points, closed = true, line_color = color.navy, fill_color = color.new(color.orange, 50), line_width = 3\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>This example shows the last ~50 polylines on the chart, as we\nhave not specified a <code dir=\"auto\">max_polylines_count</code> value in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call.</li>\n<li>The <code dir=\"auto\">yScale</code> calculation multiplies an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.float\">input.float()</a>\nby\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.atr\">ta.atr(2)</a>\nto adapt the vertical scale of the drawings to recent price\nranges.</li>\n<li>The resulting polygons have a maximum width of twice the\nhorizontal semi-axis (<code dir=\"auto\">2 * xScale</code>), rounded to the nearest\ninteger. The <code dir=\"auto\">newPolygon</code> condition uses this value to prevent\nthe polygon drawings from overlapping.</li>\n<li>The script rounds the <code dir=\"auto\">xValue</code> calculation to the nearest\ninteger because the <code dir=\"auto\">index</code> field of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nonly accepts an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nvalue, as the x-axis of the chart does not include fractional\nbar indices.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"deleting-polylines\"><a href=\"#deleting-polylines\">Deleting polylines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To delete a specific polyline <code dir=\"auto\">id</code>, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.delete\">polyline.delete()</a>.\nThis function removes the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\nobject from the script and its drawing on the chart.</p>\n<p>As with other drawing objects, we can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.delete\">polyline.delete()</a>\nto maintain a specific number of polyline drawings or conditionally\nremove drawings from a chart.</p>\n<p>For example, the script below periodically draws approximate arithmetic\nspirals and stores their polyline IDs in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nwhich it\n<a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">uses as a queue</a> to manage the number of drawings it displays.</p>\n<p>When the <code dir=\"auto\">newSpiral</code> condition occurs, the script creates a <code dir=\"auto\">points</code>\narray and adds\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> within a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">`for` loop</a>. On each loop iteration, it calls the <code dir=\"auto\">spiralPoint()</code>\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> to create a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ncontaining stepped values from an elliptical path that grows with\nrespect to the <code dir=\"auto\">angle</code>. The script then creates a randomly colored\n<em>curved polyline</em> connecting the coordinates from the <code dir=\"auto\">points</code> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">pushes</a>\nits ID into the <code dir=\"auto\">polylines</code> array.</p>\n<p>When the array\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\nexceeds the specified <code dir=\"auto\">numberOfSpirals</code>, the script removes the oldest\npolyline using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nand deletes the object using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.delete\">polyline.delete()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"610\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Deleting-polylines-1.CAlL6dPB_1NJJpi.webp\" width=\"1332\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n//@variable The maximum number of polylines allowed on the chart.\nconst int MAX_POLYLINES_COUNT = 100\n\nindicator(\"Deleting polylines example\", \"Spirals\", true, max_polylines_count = MAX_POLYLINES_COUNT)\n\n//@variable The number of spiral drawings on the chart.\nint numberOfSpirals = input.int(10, \"Spirals shown\", 1, MAX_POLYLINES_COUNT)\n//@variable The number of full spiral rotations to draw.\nint rotations = input.int(5, \"Rotations\", 1)\n//@variable The scale of the horizontal semi-axis.\nfloat xScale = input.float(1.0, \"X scale\")\n//@variable The scale of the vertical semi-axis.\nfloat yScale = input.float(0.2, \"Y scale\") * ta.atr(2)\n\n//@function Calculates an approximate point from an elliptically-scaled arithmetic spiral.\n//@returns  A `chart.point` with `index` and `price` information.\nspiralPoint(float angle, int xOffset, float yOffset) =&gt;\n    result = chart.point.from_index(\n         int(math.round(angle * xScale * math.cos(angle))) + xOffset,\n         angle * yScale * math.sin(angle) + yOffset\n     )\n\n//@variable An array of polylines.\nvar polylines = array.new&lt;polyline&gt;()\n\n//@variable The condition to create a new spiral.\nbool newSpiral = bar_index % int(math.round(4 * math.pi * rotations * xScale)) == 0\n\nif newSpiral\n    //@variable An array of `chart.point` objects for the `spiral` drawing.\n    points = array.new&lt;chart.point&gt;()\n    //@variable The counter-clockwise angle between calculated points, in radians.\n    float step = math.pi / 2\n    //@variable The rotation angle of each calculated point on the spiral, in radians.\n    float theta = 0.0\n    // Loop to create the spiral's points. Creates 4 points per full rotation.\n    for i = 0 to rotations * 4\n        //@variable A new point on the calculated spiral.\n        chart.point newPoint = spiralPoint(theta, bar_index, ohlc4)\n        // Add the `newPoint` to the `points` array.\n        points.push(newPoint)\n        // Add the `step` to the `theta` angle.\n        theta += step\n\n    //@variable A random color for the new `spiral` drawing.\n    color spiralColor = color.rgb(math.random(150, 255), math.random(0, 100), math.random(150, 255))\n    //@variable A new polyline connecting the spiral points. Uses the `index` field from each point as x-coordinates.\n    polyline spiral = polyline.new(points, true, line_color = spiralColor, line_width = 3)\n\n    // Push the new `spiral` into the `polylines` array.\n    polylines.push(spiral)\n    // Shift the first polyline out of the array and delete it when the array's size exceeds the `numberOfSpirals`.\n    if polylines.size() &gt; numberOfSpirals\n        polyline.delete(polylines.shift())\n\n// Highlight the background when `newSpiral` is `true`.\nbgcolor(newSpiral ? color.new(color.blue, 70) : na, title = \"New drawing highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We declared a <code dir=\"auto\">MAX_POLYLINES_COUNT</code> global variable with a\nconstant value of 100. The script uses this constant as the\n<code dir=\"auto\">max_polylines_count</code> value in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction and the <code dir=\"auto\">maxval</code> of the <code dir=\"auto\">numberOfSpirals</code> input.</li>\n<li>As with our \u201cN-sided polygons\u201d example in the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#closed-shapes\">previous section</a>, we round the calculation of x-coordinates to the\nnearest integer since the <code dir=\"auto\">index</code> field of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ncan only accept an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nvalue.</li>\n<li>Despite the smooth appearance of the drawings, each polyline\u2019s\n<code dir=\"auto\">points</code> array only contains <em>four</em>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects per spiral rotation. Since the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\ncall includes <code dir=\"auto\">curved = true</code>, each polyline uses <em>smooth\ncurves</em> to connect their <code dir=\"auto\">points</code>, producing a visual\napproximation of the spiral\u2019s actual curvature.</li>\n<li>The width of each spiral is approximately\n<code dir=\"auto\">4 * math.pi * rotations * xScale</code>, rounded to the nearest\ninteger. We use this value in the <code dir=\"auto\">newSpiral</code> condition to space\neach drawing and prevent overlaps.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"redrawing-polylines\"><a href=\"#redrawing-polylines\">Redrawing polylines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It may be desirable in some cases to change a polyline drawing\nthroughout a script\u2019s execution. While the <code dir=\"auto\">polyline.*</code> namespace does\nnot contain built-in setter functions, we can <em>redraw</em> polylines\nreferenced by variables or\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> by <em>deleting</em> the existing polylines and assigning <em>new\ninstances</em> with the desired changes.</p>\n<p>The following example uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.delete\">polyline.delete()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>\ncalls to update the value of a polyline variable.</p>\n<p>This script draws closed polylines that connect the open, high, low, and\nclose points of periods containing <code dir=\"auto\">length</code> bars. It creates a\n<code dir=\"auto\">currentDrawing</code> variable on the first bar and assigns a polyline ID to\nit on every chart bar. It uses the <code dir=\"auto\">openPoint</code>, <code dir=\"auto\">highPoint</code>, <code dir=\"auto\">lowPoint</code>,\nand <code dir=\"auto\">closePoint</code> variables to reference\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> that track the period\u2019s developing OHLC values. As new\nvalues emerge, the script assigns new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects to the variables, collects them in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from</a>,\nthen creates a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">new\npolyline</a>\nconnecting the coordinates from the array\u2019s points and assigns it to\nthe <code dir=\"auto\">currentDrawing</code>.</p>\n<p>When the <code dir=\"auto\">newPeriod</code> condition is <code dir=\"auto\">false</code> (i.e., the current period is\nnot complete), the script\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#deleting-polylines\">deletes</a> the polyline referenced by the <code dir=\"auto\">currentDrawing</code> before\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#creating-polylines\">creating a new one</a>, resulting in a dynamic drawing that changes over the\ndeveloping period:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"540\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Polylines-Redrawing-polylines-1.CzU1g71o_2i3aBU.webp\" width=\"1278\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Redrawing polylines demo\", \"OHLC polygons\", true, max_polylines_count = 100)\n\n//@variable The length of the period.\nint length = input.int(100, \"Length\", 1)\n\n//@variable A `chart.point` representing the start of each period.\nvar chart.point openPoint = na\n//@variable A `chart.point` representing the highest point of each period.\nvar chart.point highPoint = na\n//@variable A `chart.point` representing the lowest point of each period.\nvar chart.point lowPoint = na\n//@variable A `chart.point` representing the current bar's closing point.\nclosePoint = chart.point.now(close)\n\n//@variable The current period's polyline drawing.\nvar polyline currentDrawing = na\n\n//@variable Is `true` once every `length` bars.\nbool newPeriod = bar_index % length == 0\n\nif newPeriod\n    // Assign new chart points to the `openPoint`, `highPoint`, and `closePoint`.\n    openPoint := chart.point.now(open)\n    highPoint := chart.point.now(high)\n    lowPoint  := chart.point.now(low)\nelse\n    // Assign a new `chart.point` to the `highPoint` when the `high` is greater than its `price`.\n    if high &gt; highPoint.price\n        highPoint := chart.point.now(high)\n    // Assign a new `chart.point` to the `lowPoint` when the `low` is less than its `price`.\n    if low &lt; lowPoint.price\n        lowPoint := chart.point.now(low)\n\n//@variable Is teal when the `closePoint.price` is greater than the `openPoint.price`, maroon otherwise.\ncolor drawingColor = closePoint.price &gt; openPoint.price ? color.teal : color.maroon\n\n// Delete the polyline assigned to the `currentDrawing` if it's not a `newPeriod`.\nif not newPeriod\n    polyline.delete(currentDrawing)\n// Assign a new polyline to the `currentDrawing`.\n// Uses the `index` field from each `chart.point` in its array as x-coordinates.\ncurrentDrawing := polyline.new(\n     array.from(openPoint, highPoint, closePoint, lowPoint), closed = true,\n     line_color = drawingColor, fill_color = color.new(drawingColor, 60)\n )</div>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"realtime-behavior\"><a href=\"#realtime-behavior\">Realtime behavior<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">Lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>\nare subject to both <em>commit</em> and <em>rollback</em> actions, which affect the\nbehavior of a script when it executes on a realtime bar. See the page on\nPine Script\u2019s <a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>.</p>\n<p>This script demonstrates the effect of rollback when it executes on the\nrealtime, <em>unconfirmed</em> chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"474\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Realtime-behavior-1.CJQjybQE_1WvIDG.webp\" width=\"1328\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Realtime behavior demo\", overlay = true)\n\n//@variable Is orange when the `line` is subject to rollback and gray after the `line` is committed.\ncolor lineColor = barstate.isconfirmed ? color.gray : color.orange\n\nline.new(bar_index, hl2, bar_index + 1, hl2, color = lineColor, width = 4)</div>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\ncall in this example creates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nID on each iteration when values change on the unconfirmed bar. The\nscript automatically deletes the objects created on each change in that\nbar because of the <em>rollback</em> before each iteration. It only <em>commits</em>\nthe last line created before the bar closes, and that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\ninstance is the one that persists on the confirmed bar.</p>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/lines-and-boxes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"limitations\"><a href=\"#limitations\">Limitations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"total-number-of-objects\"><a href=\"#total-number-of-objects\">Total number of objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">Lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, and\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>\nconsume server resources, which is why there are limits on the total\nnumber of drawings per script. When a script creates more drawing\nobjects than the allowed limit, the Pine Script runtime automatically\ndeletes the oldest ones in a process referred to as <em>garbage\ncollection</em>.</p>\n<p>A single script can contain up to 500 lines, 500 boxes, and 100\npolylines. Users can control the garbage collection limits by specifying\nthe <code dir=\"auto\">max_lines_count</code>, <code dir=\"auto\">max_boxes_count</code>, and <code dir=\"auto\">max_polylines_count</code>\nvalues in their script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement.</p>\n<p>This script demonstrates how garbage collection works in Pine. It\ncreates a new line, box, and polyline on each chart bar. We haven\u2019t\nspecified values for the <code dir=\"auto\">max_lines_count</code>, <code dir=\"auto\">max_boxes_count</code>, or\n<code dir=\"auto\">max_polylines_count</code> parameters in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction call, so the script will maintain the most recent ~50 lines,\nboxes, and polylines on the chart, as this is the default setting for\neach parameter:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"534\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Lines-and-boxes-Limitations-Total-number-of-objects-1.BBu4sL-b_2tzxSR.webp\" width=\"1196\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Garbage collection demo\", overlay = true)\n\n//@variable A new `chart.point` at the current `bar_index` and `high`.\nfirstPoint = chart.point.now(high)\n//@variable A new `chart.point` one bar into the future at the current `low`.\nsecondPoint = chart.point.from_index(bar_index + 1, low)\n//@variable A new `chart.point` one bar into the future at the current `high`.\nthirdPoint = chart.point.from_index(bar_index + 1, high)\n\n// Draw a new `line` connecting the `firstPoint` to the `secondPoint`.\nline.new(firstPoint, secondPoint, color = color.red, width = 2)\n// Draw a new `box` with the `firstPoint` top-left corner and `secondPoint` bottom-right corner.\nbox.new(firstPoint, secondPoint, color.purple, 2, bgcolor = na)\n// Draw a new `polyline` connecting the `firstPoint`, `secondPoint`, and `thirdPoint` sequentially.\npolyline.new(array.from(firstPoint, secondPoint, thirdPoint), true, line_width = 2)</div>\n<p>Note that:</p>\n<ul>\n<li>We\u2019ve used TradingView\u2019s \u201cMeasure\u201d drawing tool to measure\nthe number of bars covered by the script\u2019s drawing objects.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"future-references-with-xlocbar_index\"><a href=\"#future-references-with-xlocbar_index\"><span>Future references with \u200b<code dir=\"auto\">xloc.bar_index</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Objects positioned using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>\ncan contain x-coordinates no further than 500 bars into the future.</p>\n<h3 class=\"md-heading\" id=\"other-contexts\"><a href=\"#other-contexts\">Other contexts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts cannot use <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>, or\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>\nin <code dir=\"auto\">request.*()</code> functions. Instances of these types can use the values\nfrom <code dir=\"auto\">request.*()</code> calls, but scripts can only create and draw them in\nthe chart\u2019s context.</p>\n<p>This limitation is also why drawing objects will not work when using the\n<code dir=\"auto\">timeframe</code> parameter in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ndeclaration statement.</p>\n<h3 class=\"md-heading\" id=\"historical-buffer-and-max_bars_back\"><a href=\"#historical-buffer-and-max_bars_back\"><span>Historical buffer and \u200b<code dir=\"auto\">max_bars_back</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">barstate.isrealtime</a>\nin combination with drawings may sometimes produce unexpected results.\nFor example, the intention of this script is to ignore all historical\nbars and draw horizontal lines spanning 300 bars back on <em>realtime</em>\nbars:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Historical buffer demo\", overlay = true)\n\n//@variable A `chart.point` at the `bar_index` from 300 bars ago and current `close`.\nfirstPoint = chart.point.from_index(bar_index[300], close)\n//@variable The current bar's `chart.point` containing the current `close`.\nsecondPoint = chart.point.now(close)\n\n// Draw a new line on realtime bars.\nif barstate.isrealtime\n    line.new(firstPoint, secondPoint)</div>\n<p>However, it will fail at runtime and raise an error. The script fails\nbecause it cannot determine the buffer size for historical values of the\nunderlying\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nseries. Although the code doesn\u2019t contain the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nvariable, the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nuses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nseries in its inner workings. Therefore, accessing the value of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nfrom 300 bars back requires the history buffer of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nseries to be at least 300 bars.</p>\n<p>Pine Script includes a mechanism that detects the required historical\nbuffer size automatically in most cases. It works by letting the script\naccess historical values any number of bars back for a limited duration.\nIn this script\u2019s case, using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">barstate.isrealtime</a>\nto control the drawing of lines prevents it from accessing the\nhistorical series, so it cannot infer the required historical buffer\nsize, and the script fails.</p>\n<p>The simple solution to this issue is to use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a>\nfunction to <em>explicitly define</em> the historical buffer of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nseries before evaluating the\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structure</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Historical buffer demo\", overlay = true)\n\n//@variable A `chart.point` at the `bar_index` from 300 bars ago and current `close.\nfirstPoint = chart.point.from_index(bar_index[300], close)\n//@variable The current bar's `chart.point` containing the current `close`.\nsecondPoint = chart.point.now(close)\n\n// Explicitly set the historical buffer of the `time` series to 300 bars.\nmax_bars_back(time, 300)\n\n// Draw a new line on realtime bars.\nif barstate.isrealtime\n    line.new(firstPoint, secondPoint)</div>\n<p>Such issues can be confusing, but they\u2019re quite rare. The Pine Script\nteam hopes to eliminate them over time.</p>", "segment_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "64d71130186e10234424ddba1598ad9113e79ad32081444b6549344a35940b1d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/non-standard-charts-data\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"non-standard-charts-data\"><a href=\"#non-standard-charts-data\">Non-standard charts data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>These functions allow scripts to fetch information from non-standard\nbars or chart types, regardless of the type of chart the script is\nrunning on. They are:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dheikinashi\">ticker.heikinashi()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Drenko\">ticker.renko()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dlinebreak\">ticker.linebreak()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dkagi\">ticker.kagi()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dpointfigure\">ticker.pointfigure()</a>.\nAll of them work in the same manner; they create a special ticker\nidentifier to be used as the first argument in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nfunction call.</p>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tickerheikinashi\"><a href=\"#tickerheikinashi\"><span>\u200b<code dir=\"auto\">ticker.heikinashi()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Heikin-Ashi</em> means <em>average bar</em> in Japanese. The open/high/low/close\nvalues of Heikin-Ashi candlesticks are synthetic; they are not actual\nmarket prices. They are calculated by averaging combinations of real\nOHLC values from the current and previous bar. The calculations used\nmake Heikin-Ashi bars less noisy than normal candlesticks. They can be\nuseful to make visual assessments, but are unsuited to backtesting or\nautomated trading, as orders execute on market prices \u2014 not\nHeikin-Ashi prices.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dheikinashi\">ticker.heikinashi()</a>\nfunction creates a special ticker identifier for requesting Heikin-Ashi\ndata with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nfunction.</p>\n<p>This script requests the close value of Heikin-Ashi bars and plots them\non top of the normal candlesticks:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"820\" loading=\"lazy\" src=\"/pine-script-docs/_astro/NonStandardCharts-TickerHeikinAshi-01.Cf57zbCt_1Ykjzf.webp\" width=\"1766\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"HA Close\", \"\", true)\nhaTicker = ticker.heikinashi(syminfo.tickerid)\nhaClose = request.security(haTicker, timeframe.period, close)\nplot(haClose, \"HA Close\", color.black, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The close values for Heikin-Ashi bars plotted as the black line are\nvery different from those of real candles using market prices. They\nact more like a moving average.</li>\n<li>The black line appears over the chart bars because we have selected\n\u201cVisual Order/Bring to Front\u201d from the script\u2019s \u201cMore\u201d menu.</li>\n</ul>\n<p>If you wanted to omit values for extended hours in the last example, an\nintermediary ticker without extended session information would need to\nbe created first:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"874\" loading=\"lazy\" src=\"/pine-script-docs/_astro/NonStandardCharts-TickerHeikinAshi-02.B9TEp43B_ZjVqEN.webp\" width=\"1768\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"HA Close\", \"\", true)\nregularSessionTicker = ticker.new(syminfo.prefix, syminfo.ticker, session.regular)\nhaTicker = ticker.heikinashi(regularSessionTicker)\nhaClose = request.security(haTicker, timeframe.period, close, gaps = barmerge.gaps_on)\nplot(haClose, \"HA Close\", color.black, 3, plot.style_linebr)</div>\n<p>Note that:</p>\n<ul>\n<li>We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>\nfunction first, to create a ticker without extended session\ninformation.</li>\n<li>We use that ticker instead of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtickerid\">syminfo.tickerid</a>\nin our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dheikinashi\">ticker.heikinashi()</a>\ncall.</li>\n<li>In our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\ncall, we set the <code dir=\"auto\">gaps</code> parameter\u2019s value to <code dir=\"auto\">barmerge.gaps_on</code>.\nThis instructs the function not to use previous values to fill slots\nwhere data is absent. This makes it possible for it to return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues outside of regular sessions.</li>\n<li>To be able to see this on the chart, we also need to use a special\n<code dir=\"auto\">plot.style_linebr</code> style, which breaks the plots on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues.</li>\n</ul>\n<p>This script plots Heikin-Ashi candles under the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"872\" loading=\"lazy\" src=\"/pine-script-docs/_astro/NonStandardCharts-TickerHeikinAshi-03.DDXVmouO_ZyQNBR.webp\" width=\"1766\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Heikin-Ashi candles\")\nCANDLE_GREEN = #26A69A\nCANDLE_RED   = #EF5350\n\nhaTicker = ticker.heikinashi(syminfo.tickerid)\n[haO, haH, haL, haC] = request.security(haTicker, timeframe.period, [open, high, low, close])\ncandleColor = haC &gt;= haO ? CANDLE_GREEN : CANDLE_RED\nplotcandle(haO, haH, haL, haC, color = candleColor)</div>\n<p>Note that:</p>\n<ul>\n<li>We use a\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#tuple-declarations\">tuple</a> with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch four values with the same call.</li>\n<li>We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\nto plot our candles. See the\n<a href=\"/pine-script-docs/v5/concepts/bar-plotting/\">Bar plotting</a> page\nfor more information.</li>\n</ul>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tickerrenko\"><a href=\"#tickerrenko\"><span>\u200b<code dir=\"auto\">ticker.renko()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Renko</em> bars only plot price movements, without taking time or volume\ninto consideration. They look like bricks stacked in adjacent\ncolumns<sup><a aria-describedby=\"footnote-label\" data-footnote-ref=\"\" href=\"#user-content-fn-1\" id=\"user-content-fnref-1\">1</a></sup>. A new brick is only drawn after the price passes the top or\nbottom by a predetermined amount. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Drenko\">ticker.renko()</a>\nfunction creates a ticker id which can be used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch Renko values, but there is no Pine Script\u00ae function to draw\nRenko bars on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nrenkoTicker = ticker.renko(syminfo.tickerid, \"ATR\", 10)\nrenkoLow = request.security(renkoTicker, timeframe.period, low)\nplot(renkoLow)</div>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tickerlinebreak\"><a href=\"#tickerlinebreak\"><span>\u200b<code dir=\"auto\">ticker.linebreak()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <em>Line Break</em> chart type displays a series of vertical boxes that are\nbased on price changes<sup><a aria-describedby=\"footnote-label\" data-footnote-ref=\"\" href=\"#user-content-fn-1\" id=\"user-content-fnref-1-2\">1</a></sup>. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dlinebreak\">ticker.linebreak()</a>\nfunction creates a ticker id which can be used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch \u201cLine Break\u201d values, but there is no Pine Script function to\ndraw such bars on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlineBreakTicker = ticker.linebreak(syminfo.tickerid, 3)\nlineBreakClose = request.security(lineBreakTicker, timeframe.period, close)\nplot(lineBreakClose)</div>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tickerkagi\"><a href=\"#tickerkagi\"><span>\u200b<code dir=\"auto\">ticker.kagi()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Kagi</em> charts are made of a continuous line that changes directions. The\ndirection changes when the price changes<sup><a aria-describedby=\"footnote-label\" data-footnote-ref=\"\" href=\"#user-content-fn-1\" id=\"user-content-fnref-1-3\">1</a></sup> beyond a predetermined\namount. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dkagi\">ticker.kagi()</a>\nfunction creates a ticker id which can be used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch \u201cKagi\u201d values, but there is no Pine Script function to draw\nsuch bars on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nkagiBreakTicker = ticker.linebreak(syminfo.tickerid, 3)\nkagiBreakClose = request.security(kagiBreakTicker, timeframe.period, close)\nplot(kagiBreakClose)</div>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tickerpointfigure\"><a href=\"#tickerpointfigure\"><span>\u200b<code dir=\"auto\">ticker.pointfigure()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Point and Figure</em> (PnF) charts only plot price movements<sup><a aria-describedby=\"footnote-label\" data-footnote-ref=\"\" href=\"#user-content-fn-1\" id=\"user-content-fnref-1-4\">1</a></sup>, without\ntaking time into consideration. A column of X\u2019s is plotted as the price\nrises, and O\u2019s are plotted when price drops. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dpointfigure\">ticker.pointfigure()</a>\nfunction creates a ticker id which can be used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto fetch \u201cPnF\u201d values, but there is no Pine Script function to draw\nsuch bars on the chart. Every column of X\u2019s or O\u2019s is represented with\nfour numbers. You may think of them as synthetic OHLC PnF values:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\npnfTicker = ticker.pointfigure(syminfo.tickerid, \"hl\", \"ATR\", 14, 3)\n[pnfO, pnfC] = request.security(pnfTicker, timeframe.period, [open, close], barmerge.gaps_on)\nplot(pnfO, \"PnF Open\", color.green, 4, plot.style_linebr)\nplot(pnfC, \"PnF Close\", color.red, 4, plot.style_linebr)</div>\n<section class=\"footnotes\" data-footnotes=\"\"><h2 class=\"md-heading\" id=\"footnote-label\"><a href=\"#footnote-label\">Footnotes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ol>\n<li id=\"user-content-fn-1\">\n<p>On TradingView, Renko, Line Break, Kagi and PnF chart types are\ngenerated from OHLC values from a lower timeframe. These chart types\nthus represent only an approximation of what they would be like if\nthey were generated from tick data. <a aria-label=\"Back to reference 1\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1\">\u21a9</a> <a aria-label=\"Back to reference 1-2\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-2\">\u21a9<sup>2</sup></a> <a aria-label=\"Back to reference 1-3\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-3\">\u21a9<sup>3</sup></a> <a aria-label=\"Back to reference 1-4\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-4\">\u21a9<sup>4</sup></a></p>\n</li>\n</ol>\n</section>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/non-standard-charts-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"footnote-label\"><a href=\"#footnote-label\">Footnotes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ol>\n<li id=\"user-content-fn-1\">\n<p>On TradingView, Renko, Line Break, Kagi and PnF chart types are\ngenerated from OHLC values from a lower timeframe. These chart types\nthus represent only an approximation of what they would be like if\nthey were generated from tick data. <a aria-label=\"Back to reference 1\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1\">\u21a9</a> <a aria-label=\"Back to reference 1-2\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-2\">\u21a9<sup>2</sup></a> <a aria-label=\"Back to reference 1-3\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-3\">\u21a9<sup>3</sup></a> <a aria-label=\"Back to reference 1-4\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1-4\">\u21a9<sup>4</sup></a></p>\n</li>\n</ol>", "segment_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "3b2785dbb82e2a7ad18d4f1a680afea5c569392d3d00853618c8ee78b9ca7465", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/other-timeframes-and-data\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"other-timeframes-and-data\"><a href=\"#other-timeframes-and-data\">Other timeframes and data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae allows users to request data from sources and contexts\nother than those their charts use. The functions we present on this page\ncan fetch data from a variety of alternative sources:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity\">request.security()</a> retrieves data from another symbol, timeframe, or other\ncontext.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity_lower_tf\">request.security_lower_tf()</a> retrieves <em>intrabar</em> data, i.e., data from a timeframe\nlower than the chart timeframe.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestcurrency_rate\">request.currency_rate()</a> requests a <em>daily rate</em> to convert a value expressed in\none currency to another.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestdividends-requestsplits-and-requestearnings\">request.dividends(), request.splits(), and request.earnings()</a> respectively retrieve information about an issuing\ncompany\u2019s dividends, splits, and earnings.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestquandl\">request.quandl()</a> retrieves information from <a href=\"https://data.nasdaq.com/\" rel=\"nofollow\">NASDAQ Data\nLink</a> (formerly Quandl).</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestfinancial\">request.financial()</a> retrieves financial data from\n<a href=\"https://www.factset.com/\" rel=\"nofollow\">FactSet</a>.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requesteconomic\">request.economic()</a> retrieves economic and industry data.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestseed\">request.seed()</a> retrieves data from a <em>user-maintained</em> GitHub\nrepository.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Throughout this page, and in other parts of our documentation that discuss <code dir=\"auto\">request.*()</code> functions, we often use the term <em>\u201ccontext\u201d</em> to describe the symbol, timeframe, and any modifications (price adjustments, session settings, non-standard chart types, etc.) that apply to a chart or the data retrieved by a script.</p></div></aside>\n<p>These are the signatures of the functions in the <code dir=\"auto\">request.*</code> namespace:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.security(symbol, timeframe, expression, gaps, lookahead, ignore_invalid_symbol, currency, calc_bars_count) \u2192 series &lt;type&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.security_lower_tf(symbol, timeframe, expression, ignore_invalid_symbol, currency, ignore_invalid_timeframe, calc_bars_count) \u2192 array&lt;type&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.currency_rate(from, to, ignore_invalid_currency) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.dividends(ticker, field, gaps, lookahead, ignore_invalid_symbol, currency) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.splits(ticker, field, gaps, lookahead, ignore_invalid_symbol) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.earnings(ticker, field, gaps, lookahead, ignore_invalid_symbol, currency) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.quandl(ticker, gaps, index, ignore_invalid_symbol) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.financial(symbol, financial_id, period, gaps, ignore_invalid_symbol, currency) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.economic(country_code, field, gaps, ignore_invalid_symbol) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.seed(source, symbol, expression, ignore_invalid_symbol, calc_bars_count) \u2192 series &lt;type&gt;</span></div></div></code></pre></figure></link></div>\n<p>The <code dir=\"auto\">request.*()</code> family of functions has numerous potential applications. Throughout this page, we discuss in detail these functions and some of their typical use cases.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Users can also allow compatible scripts to evaluate their scopes in other contexts without requiring <code dir=\"auto\">request.*()</code> functions by using the <code dir=\"auto\">timeframe</code> parameter of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration statement.</p></div></aside>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"common-characteristics\"><a href=\"#common-characteristics\">Common characteristics<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Many functions in the <code dir=\"auto\">request.*()</code> namespace share some common properties and parameters. Before we explore each function in depth, let\u2019s familiarize ourselves with these characteristics.</p>\n<h3 class=\"md-heading\" id=\"behavior\"><a href=\"#behavior\">Behavior<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>All <code dir=\"auto\">request.*()</code> functions have similar internal behavior, even though they do not all share the same required parameters. Every unique <code dir=\"auto\">request.*()</code> call in a script requests a dataset from a defined <em>context</em> (i.e., ticker ID and timeframe) and evaluates an <em>expression</em> across the retrieved data.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> functions allow programmers to specify the context of a request and the expression directly via the <code dir=\"auto\">symbol</code>, <code dir=\"auto\">timeframe</code>, and <code dir=\"auto\">expression</code> parameters, making them suitable for a wide range of data requests.</p>\n<p>For example, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call in this simple script requests daily \u201cAMEX:SPY\u201d data, and it calculates the slope of a 20-bar linear regression line using the retrieved <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a> prices. The first two arguments specify the context of the request, and the third specifies the expression to evaluate across the requested data:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"568\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Behavior-1.B41_C2G4_Z2uWgbr.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Behavior of `request.security()` demo\")\n\n//@variable The 20-bar linear regression slope of `hl2` prices from the \"AMEX:SPY\" symbol on the \"1D\" timeframe.\nfloat requestedSlope = request.security(\"AMEX:SPY\", \"1D\", ta.linreg(hl2, 20, 0) - ta.linreg(hl2, 20, 1))\n\n//@variable Is `color.teal` when the `requestedSlope` is positive, and `color.maroon` otherwise.\ncolor plotColor = requestedSlope &gt; 0 ? color.teal : color.maroon\n\n// Plot the `requestedSlope` with the `plotColor`.\nplot(requestedSlope, \"Requested slope\", plotColor, 1, plot.style_area)</div>\n<p>Other functions within the <code dir=\"auto\">request.*()</code> namespace <em>do not</em> allow programmers to directly define the full context of a request or the evaluated expression. Instead, these functions determine some of the necessary information <em>internally</em> because they perform only specific types of requests.</p>\n<p>For instance, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a> exclusively retrieves periodic financial data. Its required parameters (<code dir=\"auto\">symbol</code>, <code dir=\"auto\">financial_id</code>, and <code dir=\"auto\">period</code>) all define parts of a specific financial <em>ticker ID</em>. The function does not allow specification of the timeframe or expression, as it determines these details internally. The script below demonstrates a simple call to this function that retrieves the annual cost of goods data for the chart symbol\u2019s issuing company:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Behavior-2.E8W5-ysC_Z12hBhd.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Behavior of `request.financial()` demo\", format = format.volume)\n\n//@variable The annual cost of goods sold by the chart symbol's issuing company.\nfloat costOfGoods = request.financial(syminfo.tickerid, \"COST_OF_GOODS\", \"FY\")\n\n// Plot the `costOfGoods`.\nplot(costOfGoods, \"Cost of goods\", color.purple, 3, plot.style_stepline_diamond)</div>\n<p>Scripts can perform up to 40 unique requests using any combination of <code dir=\"auto\">request.*()</code> function calls. Only unique <code dir=\"auto\">request.*()</code> calls count toward this limit because they are the only calls that fetch <em>new data</em>. Redundant calls to the same <code dir=\"auto\">request.*()</code> function with identical arguments <em>do not</em> retrieve new data. Instead, they <em>reuse</em> the data from the first executed call. See <a href=\"/pine-script-docs/v5/writing/limitations/#number-of-calls\">this section</a> of the <a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for more information.</p>\n<h3 class=\"md-heading\" id=\"gaps\"><a href=\"#gaps\"><span>\u200b<code dir=\"auto\">gaps</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When using a <code dir=\"auto\">request.*()</code> function to retrieve data from another context, the data may not come in on each new bar as it would with the current chart. The <code dir=\"auto\">gaps</code> parameter of a <code dir=\"auto\">request.*()</code> function controls how the function responds to nonexistent values in the requested series.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>When using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">timeframe</a> parameter of the <code dir=\"auto\">indicator()</code> function to evaluate the entire script in a different timeframe, the <code dir=\"auto\">timeframe_gaps</code> parameter specifies how the script handles nonexistent values. This parameter is similar to the <code dir=\"auto\">gaps</code> parameter for <code dir=\"auto\">request.*()</code> functions.</p></div></aside>\n<p>Suppose we have a script executing on an 1-minute chart that requests hourly data for the chart\u2019s symbol using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>. The function call returns new values only on the 1-minute bars that cover the opening and closing times of the symbol\u2019s hourly bars. On other chart bars, we can decide whether the function returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values or the last available values via the <code dir=\"auto\">gaps</code> parameter.</p>\n<p>When the <code dir=\"auto\">gaps</code> parameter uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_on\">barmerge.gaps_on</a>, the function returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> results on all chart bars where new data is not yet confirmed from the requested context. Otherwise, when the parameter uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_off\">barmerge.gaps_off</a>, the function fills the gaps in the requested data with the last confirmed values on historical bars and the most recent developing values on realtime bars.</p>\n<p>The script below demonstrates the difference in behavior by <a href=\"/pine-script-docs/v5/concepts/plots/\">plotting</a> the results from two <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> calls that fetch the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> price of the current symbol from the hourly timeframe on a 1-minute chart. The first call uses <code dir=\"auto\">gaps = barmerge.gaps_off</code> and the second uses <code dir=\"auto\">gaps = barmerge.gaps_on</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"598\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Gaps-1.DX6PixJ0_ZcmWMl.webp\" width=\"1332\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`gaps` demo\", overlay = true)\n\n//@variable The `close` requested from the hourly timeframe without gaps.\nfloat dataWithoutGaps = request.security(syminfo.tickerid, \"60\", close, gaps = barmerge.gaps_off)\n//@variable The `close` requested from the hourly timeframe with gaps.\nfloat dataWithGaps = request.security(syminfo.tickerid, \"60\", close, gaps = barmerge.gaps_on)\n\n// Plot the requested data.\nplot(dataWithoutGaps, \"Data without gaps\", color.blue, 3, plot.style_linebr)\nplot(dataWithGaps, \"Data with gaps\", color.purple, 15, plot.style_linebr)\n\n// Highlight the background for realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.aqua, 70) : na, title = \"Realtime bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_off\">barmerge.gaps_off</a> is the default value for the <code dir=\"auto\">gaps</code> parameter in all applicable <code dir=\"auto\">request.*()</code> functions.</li>\n<li>The script plots the requested series as lines with breaks (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_plot.style_linebr\">plot.style_linebr</a>), which do not bridge over <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values as the default style (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_plot.style_line\">plot.style_line</a>) does.</li>\n<li>When using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_off\">barmerge.gaps_off</a>, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function returns the last confirmed <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> from the hourly timeframe on all historical bars. When running on <em>realtime bars</em> (the bars with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.aqua\">color.aqua</a> background in this example), it returns the symbol\u2019s current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> value, regardless of confirmation. For more information, see the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#historical-and-realtime-behavior\">Historical and realtime behavior</a> section of this page.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"ignore_invalid_symbol\"><a href=\"#ignore_invalid_symbol\"><span>\u200b<code dir=\"auto\">ignore_invalid_symbol</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">ignore_invalid_symbol</code> parameter of <code dir=\"auto\">request.*()</code> functions determines how a function handles invalid data requests, e.g.:</p>\n<ul>\n<li>Using a <code dir=\"auto\">request.*()</code> function with a nonexistent ticker ID as the <code dir=\"auto\">symbol/ticker</code> parameter.</li>\n<li>Using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a> to retrieve information that does not exist for the specified <code dir=\"auto\">symbol</code> or <code dir=\"auto\">period</code>.</li>\n<li>Using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a> to request a <code dir=\"auto\">field</code> that does not exist for a <code dir=\"auto\">country_code</code>.</li>\n</ul>\n<p>A <code dir=\"auto\">request.*()</code> function call produces a <em>runtime error</em> and halts the execution of the script when making an erroneous request if its <code dir=\"auto\">ignore_invalid_symbol</code> parameter is <code dir=\"auto\">false</code>. When this parameter\u2019s value is <code dir=\"auto\">true</code>, the function returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values in such a case instead of raising an error.</p>\n<p>This example uses <code dir=\"auto\">request.*()</code> calls within a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> to retrieve data for estimating an instrument\u2019s market capitalization (market cap). The user-defined <code dir=\"auto\">calcMarketCap()</code> function calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a> to retrieve the total shares outstanding for a symbol and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve a tuple containing the symbol\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> price and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">currency</a>. We\u2019ve included <code dir=\"auto\">ignore_invalid_symbol = true</code> in both of these <code dir=\"auto\">request.*()</code> calls to prevent runtime errors for invalid requests.</p>\n<p>The script displays a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">formatted string</a> representing the symbol\u2019s estimated market cap value and currency in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the chart and uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a> to visualize the <code dir=\"auto\">marketCap</code> history:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"596\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Ignore-invalid-symbol-1.DPSV2CB9_2wVvY7.webp\" width=\"1334\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`ignore_invalid_symbol` demo\", \"Market cap estimate\", format = format.volume)\n\n//@variable The symbol to request data from.\nstring symbol = input.symbol(\"TSX:SHOP\", \"Symbol\")\n\n//@function Estimates the market capitalization of the specified `tickerID` if the data exists.\ncalcMarketCap(simple string tickerID) =&gt;\n    //@variable The quarterly total shares outstanding for the `tickerID`. Returns `na` when the data isn't available.\n    float tso = request.financial(tickerID, \"TOTAL_SHARES_OUTSTANDING\", \"FQ\", ignore_invalid_symbol = true)\n    //@variable The `close` price and currency for the `tickerID`. Returns `[na, na]` when the `tickerID` is invalid.\n    [price, currency] = request.security(\n         tickerID, timeframe.period, [close, syminfo.currency], ignore_invalid_symbol = true\n     )\n    // Return a tuple containing the market cap estimate and the quote currency.\n    [tso * price, currency]\n\n//@variable A `table` object with a single cell that displays the `marketCap` and `quoteCurrency`.\nvar table infoTable = table.new(position.top_right, 1, 1)\n// Initialize the table's cell on the first bar.\nif barstate.isfirst\n    table.cell(infoTable, 0, 0, \"\", text_color = color.white, text_size = size.huge, bgcolor = color.teal)\n\n// Get the market cap estimate and quote currency for the `symbol`.\n[marketCap, quoteCurrency] = calcMarketCap(symbol)\n\nif barstate.islast\n    //@variable The formatted text displayed inside the `infoTable`.\n    string tableText = str.format(\"Market cap:\\n{0} {1}\", str.tostring(marketCap, format.volume), quoteCurrency)\n    // Update the `infoTable`.\n    table.cell_set_text(infoTable, 0, 0, tableText)\n\n// Plot the `marketCap` value.\nplot(marketCap, \"Market cap\", color.new(color.purple, 60), style = plot.style_area)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">calcMarketCap()</code> function only returns non-na values on valid instruments with total shares outstanding data, such as the one we selected for this example. It returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> on others that do not have financial data, including forex, crypto, and derivatives.</li>\n<li>Not all issuing companies publish quarterly financial reports. If the issuing company of the <code dir=\"auto\">symbol</code> does not report on a quarterly basis, change the \u201cFQ\u201d value in this script to the company\u2019s minimum reporting period. See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestfinancial\">request.financial()</a> section for more information.</li>\n<li>We included <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_format.volume\">format.volume</a> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a> calls to specify that the y-axis of the chart pane represents volume-formatted values and the \u201cstring\u201d representation of the <code dir=\"auto\">marketCap</code> value shows as volume-formatted text.</li>\n<li>This script creates a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> and initializes its cell on the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isfirst\">first chart bar</a>, then <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.cell_set_text\">updates the cell\u2019s text</a> on the last chart bar. To learn more about working with tables, see the <a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a> page.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"currency\"><a href=\"#currency\"><span>\u200b<code dir=\"auto\">currency</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">currency</code> parameter of a <code dir=\"auto\">request.*()</code> function allows users to specify the currency of the requested data. When this parameter\u2019s value differs from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a> of the symbol, the function converts the requested values to express them in the specified <code dir=\"auto\">currency</code>. This parameter accepts a built-in variable from the <code dir=\"auto\">currency.*</code> namespace, such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_currency.JPY\">currency.JPY</a>, or a \u201cstring\u201d representing a valid currency code (e.g., \u201cJPY\u201d). If a script allows <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#dynamic-requests\">dynamic requests</a>, this parameter allows a \u201cseries\u201d argument that can change across executions. Otherwise, it accepts a value with a \u201csimple\u201d or weaker <a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">qualifier</a>.</p>\n<p>The conversion rate between the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a> of the requested data and the specified <code dir=\"auto\">currency</code> depends on the <em>previous daily value</em> of the corresponding currency pair from the most popular exchange. If no exchange provides the rate directly, the function derives the rate using a <a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spread symbol</a>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Not all <code dir=\"auto\">request.*()</code> function calls return values expressed as a currency amount. Therefore, currency conversion is <em>not</em> always necessary. For example, some series the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a> function returns use units other than currency, such as the \u201cPIOTROSKI_F_SCORE\u201d and \u201cNUMBER_OF_EMPLOYEES\u201d metrics. It is up to programmers to determine when currency conversion is appropriate in their data requests.</p></div></aside>\n<h3 class=\"md-heading\" id=\"lookahead\"><a href=\"#lookahead\"><span>\u200b<code dir=\"auto\">lookahead</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">lookahead</code> parameter in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a> specifies the lookahead behavior of the function call. Its default value is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_off\">barmerge.lookahead_off</a>.</p>\n<p>When requesting data from a higher-timeframe (HTF) context, the <code dir=\"auto\">lookahead</code> value determines whether the <code dir=\"auto\">request.*()</code> function can return values from times <em>beyond</em> those of the historical bars it executes on. In other words, the <code dir=\"auto\">lookahead</code> paremeter determines whether the requested data may contain <em>lookahead bias</em> on historical bars.</p>\n<p>When requesting data from a lower-timeframe (LTF) context, the <code dir=\"auto\">lookahead</code> parameter determines whether the function requests values from the first or last <em>intrabar</em> (LTF bar) of each chart-timeframe bar.</p>\n<p><strong>Programmers should exercise extreme caution when using lookahead in their requests, namely when requesting data from higher timeframes.</strong>\nWhen using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a> as the <code dir=\"auto\">lookahead</code> value, ensure that it does not compromise the integrity of the script\u2019s logic by leaking <em>future data</em> into historical chart bars.</p>\n<p>The following scenarios are cases where enabling lookahead is acceptable in a <code dir=\"auto\">request.*()</code> call:</p>\n<ul>\n<li>The <code dir=\"auto\">expression</code> in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> references a series with a <em>historical offset</em> (e.g., <code dir=\"auto\">close[1]</code>), which prevents the function from requesting future values that it would <strong>not</strong> have access to on a realtime basis.</li>\n<li>The specified <code dir=\"auto\">timeframe</code> in the call is the same as the chart the script executes on, i.e., <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a>.</li>\n<li>The function call requests data from an intrabar timeframe, i.e., a timeframe smaller than the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a>. See <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lower-timeframes\">this section</a> for more information.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> to leak future data into the past is <strong>misleading</strong> and <strong>not allowed</strong> in script publications. While your script\u2019s results on historical bars may look great due to its seemingly \u201cmagical\u201d acquisition of prescience (which it will not be able to reproduce on realtime bars), you will mislead yourself and the users of your script. If you <a href=\"/pine-script-docs/v5/writing/publishing/\">publish your script</a> to share it with others, ensure you <strong>do not mislead users</strong> by accessing future information from a dataset on historical bars.</p></div></aside>\n<p>This example demonstrates how the <code dir=\"auto\">lookahead</code> parameter affects the behavior of higher-timeframe data requests and why enabling lookahead in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> without offsetting the <code dir=\"auto\">expression</code> is misleading. The script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> to get the HTF <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> price for the current chart\u2019s symbol in three different ways and <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the resulting series on the chart for comparison.</p>\n<p>The first call uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_off\">barmerge.lookahead_off</a> (default), and the others use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>. However, the third <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call also <em>offsets</em> its <code dir=\"auto\">expression</code> using the history-referencing operator <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a> to avoid leaking future data into the past.</p>\n<p>As we see on the chart, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a> of the series requested using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a> without an offset (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.fuchsia\">fuchsia</a> line) shows final HTF <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> prices <em>before</em> they are actually available on historical bars, whereas the other two calls do not:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Lookahead-1.DhbZxNLg_239Pup.webp\" width=\"1348\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`lookahead` demo\", overlay = true)\n\n//@variable The timeframe to request the data from.\nstring timeframe = input.timeframe(\"30\", \"Timeframe\")\n\n//@variable The requested `high` price from the current symbol on the `timeframe` without lookahead bias.\n//          On realtime bars, it returns the current `high` of the `timeframe`.\nfloat lookaheadOff = request.security(syminfo.tickerid, timeframe, high, lookahead = barmerge.lookahead_off)\n\n//@variable The requested `high` price from the current symbol on the `timeframe` with lookahead bias.\n//          Returns values that should NOT be accessible yet on historical bars.\nfloat lookaheadOn = request.security(syminfo.tickerid, timeframe, high, lookahead = barmerge.lookahead_on)\n\n//@variable The requested `high` price from the current symbol on the `timeframe` without lookahead bias or repainting.\n//          Behaves the same on historical and realtime bars.\nfloat lookaheadOnOffset = request.security(syminfo.tickerid, timeframe, high[1], lookahead = barmerge.lookahead_on)\n\n// Plot the values.\nplot(lookaheadOff, \"High, no lookahead bias\", color.new(color.blue, 40), 5)\nplot(lookaheadOn, \"High with lookahead bias\", color.fuchsia, 3)\nplot(lookaheadOnOffset, \"High, no lookahead bias or repaint\", color.aqua, 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 60) : na, title = \"Realtime bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The series requested using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_off\">barmerge.lookahead_off</a> has a new historical value at the <em>end</em> of each HTF period, and both series requested using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a> have new historical data at the <em>start</em> of each period.</li>\n<li>On realtime bars, the plot of the series without lookahead (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.blue\">blue</a>) and the series with lookahead and no historical offset (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.fuchsia\">fuchsia</a>) show the <em>same value</em> (i.e., the HTF period\u2019s unconfirmed <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> price), as no data exists beyond those points to leak into the past. Both of these plots <em>repaint</em> their results after restarting the script\u2019s executions, as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">realtime</a> bars become <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.ishistory\">historical</a> bars.</li>\n<li>The series that uses lookahead and a historical offset (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.aqua\">aqua</a>) <em>does not</em> repaint its values, as it always references the last <em>confirmed</em> value from the higher timeframe. See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">Avoiding repainting</a> section of this page for more information.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>In Pine Script v1 and v2, the <code dir=\"auto\">security()</code> function did not include a <code dir=\"auto\">lookahead</code> parameter, but it behaved as it does in later versions of Pine with <code dir=\"auto\">lookahead = barmerge.lookahead_on</code>, meaning that it systematically used data from the future HTF context on historical bars. Therefore, users should <em>exercise caution</em> with Pine v1 or v2 scripts that use HTF <code dir=\"auto\">security()</code> calls unless the function calls contain historical offsets.</p></div></aside>\n<h3 class=\"md-heading\" id=\"dynamic-requests\"><a href=\"#dynamic-requests\">Dynamic requests<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A script can define all its <code dir=\"auto\">request.*()</code> functions as <em>dynamic</em> by specifying <code dir=\"auto\">dynamic_requests = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a> declaration statement. By default, dynamic requests are off.</p>\n<p>In contrast to non-dynamic requests, dynamic requests can:</p>\n<ul>\n<li>Access data from different data feeds using a single <code dir=\"auto\">request.*()</code> instance with <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#series-arguments\">\u201cseries\u201d arguments</a>.</li>\n<li>Execute within the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#in-local-scopes\">local scopes</a> of <a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>, <a href=\"/pine-script-docs/v5/language/loops/\">loops</a>, and <a href=\"/pine-script-docs/v5/concepts/libraries/#library-functions\">exported functions</a>.</li>\n<li>Execute <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#nested-requests\">nested requests</a>.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"series-arguments\"><a href=\"#series-arguments\">\u201dseries\u201d arguments<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Scripts without dynamic requests enabled cannot use \u201cseries\u201d arguments for most <code dir=\"auto\">request.*()</code> function parameters, which means the argument values <em>cannot change</em>. The only exception is the <code dir=\"auto\">expression</code> parameter in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a>, which <em>always</em> allows \u201cseries\u201d values.</p>\n<p>In contrast, when a script allows dynamic requests, all <code dir=\"auto\">request.*()</code> function parameters that define parts of the ticker ID or timeframe of a request accept \u201cseries\u201d arguments that <em>can change</em> with each script execution. In other words, with dynamic requests, it\u2019s possible for a single <code dir=\"auto\">request.*()</code> instance to fetch data from <em>different contexts</em> in different executions. Some other optional parameters, such as <code dir=\"auto\">ignore_invalid_symbol</code>, can also accept \u201cseries\u201d arguments, allowing additional flexibility in <code dir=\"auto\">request.*()</code> call behaviors.</p>\n<p>The following script declares a <code dir=\"auto\">symbolSeries</code> variable that is assigned four different symbol strings in 20-bar cycles, with its value changing after every five bars. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call uses this variable as the <code dir=\"auto\">symbol</code> argument. The script plots the <code dir=\"auto\">requestedClose</code> values, which therefore represent a different symbol\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> prices for each five-bar period.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"566\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Dynamic-requests-Series-arguments-1.B-eSJN4x_2cWo6g.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"'series' arguments demo\", dynamic_requests = true)\n \n//@variable A \"series\" that cycles through four different symbol strings. Its value changes every five bars.  \nstring symbolSeries = switch int(bar_index / 5) % 4\n    1 =&gt; \"NASDAQ:MSFT\"\n    2 =&gt; \"NASDAQ:AMD\"\n    3 =&gt; \"NASDAQ:INTC\"\n    =&gt;   \"AMEX:SPY\"\n\n//@variable The requested `close` value from one of the four `symbolSeries` values on the chart's timeframe.\nfloat requestedClose = request.security(symbolSeries, timeframe.period, close)\n\n// Plot the `requestedClose`.\nplot(requestedClose, \"Requested close\", color.purple, 3)\n\n// Draw a label displaying the requested symbol each time the `symbolSeries` changes.\nif symbolSeries != symbolSeries[1]\n    label.new(bar_index, requestedClose, symbolSeries, textcolor = color.white)</div>\n<p>Note that:</p>\n<ul>\n<li>The script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> every time the <code dir=\"auto\">symbolSeries</code> changes, to signify which symbol\u2019s data the <code dir=\"auto\">requestedClose</code> currently represents.</li>\n<li>Removing <code dir=\"auto\">dynamic_requests = true</code> from this script\u2019s declaration statement causes a <em>compilation error</em>. Scripts without dynamic requests enabled cannot use \u201cseries string\u201d <code dir=\"auto\">symbol</code> arguments in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> calls.</li>\n</ul>\n<p>An important limitation is that when using dynamic <code dir=\"auto\">request.*()</code> calls with \u201cseries\u201d arguments or within <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#in-local-scopes\">local scopes</a>, scripts must request all required datasets while executing on <strong>historical bars</strong>. All <code dir=\"auto\">request.*()</code> calls on <em>realtime</em> bars can retrieve data from the datasets that the script previously accessed on historical bars, but they <strong>cannot</strong> request a new context or evaluate a new expression.</p>\n<p>To illustrate this limitation, let\u2019s revisit the above script. Notice that it requests <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> data for all four symbols on the chart\u2019s timeframe during its historical executions. The external datasets for those four contexts are the <strong>only</strong> ones that any <code dir=\"auto\">request.*()</code> call on realtime bars can access.</p>\n<p>Below, we changed the <code dir=\"auto\">timeframe</code> argument in the script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call to specify that it requests <code dir=\"auto\">symbolSeries</code> data from the chart\u2019s timeframe on historical bars and the \u201c240\u201d (240 minutes = 4H) timeframe on realtime bars. This version raises a runtime error on the first realtime tick, if it is run on any timeframe other than the 4H timeframe, because it <strong>cannot</strong> access the 4H data feeds without requesting them on historical bars first:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Invalid realtime request demo\", dynamic_requests = true)\n \n//@variable A \"series\" that cycles through four different symbol strings. Its value changes every five bars.  \nstring symbolSeries = switch int(bar_index / 5) % 4\n    1 =&gt; \"NASDAQ:MSFT\"\n    2 =&gt; \"NASDAQ:AMD\"\n    3 =&gt; \"NASDAQ:INTC\"\n    =&gt;   \"AMEX:SPY\"\n\n// Request the `close` of the `symbolSeries` from the chart's timeframe on historical bars and the \"240\" (4H) timeframe \n// on realtime bars. Causes a runtime error on the first realtime tick because the script did not previously access \n// data from the \"240\" timeframe on any historical bars. \nfloat requestedClose = request.security(symbolSeries, barstate.isrealtime ? \"240\" : timeframe.period, close)\n\n// Plot the `requestedClose`.\nplot(requestedClose, \"Requested close\", color.purple, 3)\n\n// Draw a label displaying the requested symbol each time the `symbolSeries` changes.\nif symbolSeries != symbolSeries[1]\n    label.new(bar_index, requestedClose, symbolSeries, textcolor = color.white)</div>\n<h4 class=\"md-heading\" id=\"in-local-scopes\"><a href=\"#in-local-scopes\">In local scopes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When scripts do not allow dynamic requests, all <code dir=\"auto\">request.*()</code> calls execute once on <em>every</em> bar or realtime tick, which prevents their use within most local scopes. The only exception is for <code dir=\"auto\">request.*()</code> calls in the scopes of <em>non-exported</em> <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and <a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>, because the Pine Script compiler extracts such calls into the <em>global scope</em> during translation.</p>\n<p>Scripts that allow dynamic requests <em>do not</em> restrict the execution of <code dir=\"auto\">request.*()</code> calls to the global scope. They can call <code dir=\"auto\">request.*()</code> functions directly within the scopes of <a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> and <a href=\"/pine-script-docs/v5/language/loops/\">loops</a>, meaning that each <code dir=\"auto\">request.*()</code> instance in the code can activate zero, one, or several times on each script execution.</p>\n<p>The following example uses a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> instance within a loop to request data from multiple forex data feeds. The script declares an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of <code dir=\"auto\">symbols</code> on the first chart bar, which it iterates through on all bars using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop. Each loop iteration calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> to retrieve the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a> value for one of the symbols and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">pushes</a> the result into the <code dir=\"auto\">requestedData</code> array. After the loop terminates, the script calculates the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">average</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.max\">maximum</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">minimum</a> values from the <code dir=\"auto\">requestedData</code> array and plots those values on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"596\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Dynamic-requests-In-local-scopes-1.Bgx3zpOB_Z21iFsc.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"In local scopes demo\", dynamic_requests = true, format = format.volume)\n\n//@variable An array of \"string\" values representing different symbols to request. \nvar array&lt;string&gt; symbols = array.from(\n     \"EURUSD\", \"USDJPY\", \"GBPUSD\", \"AUDUSD\", \"USDCAD\", \"USDCHF\", \"NZDUSD\", \"EURJPY\", \"GBPJPY\", \"EURGBP\"\n )\n\n//@variable An array containing the data retrieved for each requested symbol.  \narray&lt;float&gt; requestedData = array.new&lt;float&gt;()\n\n// Retrieve `volume` data for each symbol in the `symbols` array and push the results into the `requestedData` array. \nfor symbol in symbols\n    float data = request.security(\"OANDA:\" + symbol, timeframe.period, volume)\n    requestedData.push(data)\n\n// Calculate the average, maximum, and minimum tick volume in the `requestedData`.\nfloat avgVolume = requestedData.avg()\nfloat maxVolume = requestedData.max()\nfloat minVolume = requestedData.min()\n\n// Plot the `avgVolume`, `maxVolume`, and `minVolume`. \nplot(avgVolume, \"Average volume\", color.gray,   3)\nplot(maxVolume, \"Highest volume\", color.teal,   3)\nplot(minVolume, \"Lowest volume\",  color.maroon, 3)</div>\n<p>Notice that the <code dir=\"auto\">expression</code> argument in the above example (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>) is <em>loop-invariant</em>, i.e., it does not change on any loop iteration. When using <code dir=\"auto\">request.*()</code> calls within a loop, all parameters defining parts of the requested <em>context</em> can accept arguments that depend on variables from the loop\u2019s header or mutable variables that change within the loop\u2019s local scope. However, a <code dir=\"auto\">request.*()</code> call\u2019s evaluated expression <strong>cannot</strong> depend on the values of those variables.</p>\n<p>Here, we modified the above script to use the <em>second form</em> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement, which creates a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> containing the index and value of each element in the <code dir=\"auto\">symbols</code> array. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> instance in this version uses the index (<code dir=\"auto\">i</code>) in its <code dir=\"auto\">expression</code> argument, resulting in a <em>compilation error</em>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop-dependent expression demo\", dynamic_requests = true, format = format.volume)\n\n//@variable An array of \"string\" values representing different symbols to request. \nvar array&lt;string&gt; symbols = array.from(\n     \"EURUSD\", \"USDJPY\", \"GBPUSD\", \"AUDUSD\", \"USDCAD\", \"USDCHF\", \"NZDUSD\", \"EURJPY\", \"GBPJPY\", \"EURGBP\"\n )\n\n//@variable An array containing the data retrieved for each requested symbol.  \narray&lt;float&gt; requestedData = array.new&lt;float&gt;()\n\n// Retrieve `volume` data for each symbol in the `symbols` array, weighted using the element index.\n// Causes a compilation error because the `expression` in `request.security()` cannot depend on loop variables \n// or mutable variables that change within the loop's scope. \nfor [i, symbol] in symbols\n    float data = request.security(\"OANDA:\" + symbol, timeframe.period, volume * (10 - i))\n    requestedData.push(data)\n\n// Calculate the average, maximum, and minimum tick volume in the `requestedData`.\nfloat avgVolume = requestedData.avg()\nfloat maxVolume = requestedData.max()\nfloat minVolume = requestedData.min()\n\n// Plot the `avgVolume`, `maxVolume`, and `minVolume`. \nplot(avgVolume, \"Average volume\", color.gray,   3)\nplot(maxVolume, \"Highest volume\", color.teal,   3)\nplot(minVolume, \"Lowest volume\",  color.maroon, 3)</div>\n<h4 class=\"md-heading\" id=\"in-libraries\"><a href=\"#in-libraries\">In libraries<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/concepts/libraries/\">Libraries</a> with dynamic requests enabled can <em>export</em> <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and <a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a> that utilize <code dir=\"auto\">request.*()</code> calls within their local scopes, provided that the evaluated expressions <strong>do not</strong> depend on any exported function parameters.</p>\n<p>For example, this simple library exports an <code dir=\"auto\">htfPrices()</code> function that requests a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> of confirmed <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> prices using a specified <code dir=\"auto\">tickerID</code> and <code dir=\"auto\">timeframe</code>. If we publish this library, another script can <em>import</em> the function to request higher-timeframe prices without explicitly calling <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nlibrary(\"DynamicRequests\", dynamic_requests = true)\n\n//@function        Requests a tuple containing confirmed HTF OHLC data for a specified `tickerID` and `timeframe`.\n//@param tickerID  The ticker identifier to request data for. \n//@param timeframe The timeframe of the requested data.\n//@returns         A tuple containing the last confirmed `open`, `high`, `low`, and `close` from the requested context.\nexport htfPrices(string tickerID, string timeframe) =&gt;\n    if timeframe.in_seconds() &gt;= timeframe.in_seconds(timeframe)\n        runtime.error(\"The `timeframe` argument of `getHTFPrices()` must be higher than the chart's timeframe.\")\n    request.security(tickerID, timeframe, [open[1], high[1], low[1], close[1]], lookahead = barmerge.lookahead_on)</div>\n<p>Note that:</p>\n<ul>\n<li>The tuple that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call includes as the <code dir=\"auto\">expression</code> argument <em>does not</em> depend on the <code dir=\"auto\">htfPrices()</code> parameters.</li>\n<li>The <code dir=\"auto\">htfPrices()</code> function raises a custom <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime.error\">runtime error</a> when the <code dir=\"auto\">timeframe</code> argument is not higher than the chart\u2019s timeframe. See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#higher-timeframes\">higher timeframes</a> section for more information.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_on\">barmerge.lookahead_on</a> and offsets each item in the tuple by one bar. This is the only recommended method to <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">avoid repainting</a>.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"nested-requests\"><a href=\"#nested-requests\">Nested requests<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Scripts that include <code dir=\"auto\">dynamic_requests = true</code> can execute <em>nested requests</em>, i.e., <code dir=\"auto\">request.*()</code> calls that dynamically evaluate other <code dir=\"auto\">request.*()</code> calls that their <code dir=\"auto\">expression</code> arguments depend on.</p>\n<p>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> call uses an empty string or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a> for its <code dir=\"auto\">symbol</code> argument, or if it uses an empty string or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a> for the <code dir=\"auto\">timeframe</code> argument, the requested ticker ID or timeframe <em>depends</em> on the context where the call executes. This context is normally the ticker ID or timeframe of the chart that the script is running on. However, if such a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> function call is evaluated by another <code dir=\"auto\">request.*()</code> call, the nested request <em>inherits</em> that <code dir=\"auto\">request.*()</code> call\u2019s ticker ID or timeframe information.</p>\n<p>For example, the script below contains two <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> calls and uses <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> to display their results. The first call uses empty strings as its <code dir=\"auto\">symbol</code> and <code dir=\"auto\">timeframe</code> arguments, meaning that the requested context depends on where the call executes. It evaluates a concatenated string containing the call\u2019s requested ticker ID and timeframe, and the script assigns its result to the <code dir=\"auto\">info1</code> variable.</p>\n<p>The second call requests data for a specific <code dir=\"auto\">symbol</code> and <code dir=\"auto\">timeframe</code> using the <code dir=\"auto\">info1</code> variable as its <code dir=\"auto\">expression</code> argument. Since the <code dir=\"auto\">info1</code> variable depends on the first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call, the second call evaluates the first call <em>within</em> its own context. Therefore, the first call adopts the second call\u2019s ticker ID and timeframe while executing within that context, resulting in a different returned value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Dynamic-requests-Nested-requests-1.cfjIWGiA_Z1Jgykj.webp\" width=\"1230\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Nested requests demo\", dynamic_requests = true)\n\n//@variable A concatenated string containing the current `syminfo.tickerid` and `timeframe.period`.\nstring info1 = request.security(\"\", \"\", syminfo.tickerid + \"_\" + timeframe.period)\n//@variable A concatenated string representing the `info1` value calculated within the \"NASDAQ:AAPL, 240\" context.\n//          This call evaluates the call on line 5 within its context to determine its result because the script \n//          allows dynamic requests.\nstring info2 = request.security(\"NASDAQ:AAPL\", \"240\", info1)\n\n// Log the results from both calls in the Pine Logs pane on the last historical bar. \nif barstate.islastconfirmedhistory\n    log.info(\"First request: {0}\", info1)\n    log.info(\"Second request: {0}\", info2)</div>\n<p>This script allows the execution of the first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call within the context of the second call because we included <code dir=\"auto\">dynamic_requests = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration statement. Without dynamic requests enabled, the script evaluates each call <em>independently</em>, passing the first call\u2019s calculated value directly into the second call rather than executing the first call within the second context. Consequently, the second call\u2019s returned value is the <em>same</em> as the first call\u2019s value, as we see below:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Common-characteristics-Dynamic-requests-Nested-requests-2.D2duF-iw_1E8FIY.webp\" width=\"1230\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Nested requests demo\")\n\n//@variable A concatenated string containing the current `syminfo.tickerid` and `timeframe.period`.\nstring info1 = request.security(\"\", \"\", syminfo.tickerid + \"_\" + timeframe.period)\n//@variable The same value as `info1`. This call does not evalutate the call on line 5 because dynamic requests aren't \n//          allowed. Instead, it only uses the value of `info1`, meaning its result does not change. \nstring info2 = request.security(\"NASDAQ:AAPL\", \"240\", info1)\n\n// Log the results from both calls in the Pine Logs pane on the last historical bar. \nif barstate.islastconfirmedhistory\n    log.info(\"First request: {0}\", info1)\n    log.info(\"Second request: {0}\", info2)</div>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"data-feeds\"><a href=\"#data-feeds\">Data feeds<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView\u2019s data providers supply different data feeds that scripts\ncan access to retrieve information about an instrument, including:</p>\n<ul>\n<li>Intraday historical data (for timeframes &lt; 1D)</li>\n<li>End-of-day (EOD) historical data (for timeframes &gt;= 1D)</li>\n<li>Realtime data (which may be delayed, depending on your account type\nand extra data services)</li>\n<li>Extended hours data</li>\n</ul>\n<p>Not all of these data feed types exist for every instrument. For\nexample, the symbol \u201cBNC:BLX\u201d only has EOD data available.</p>\n<p>For some instruments with intraday and EOD historical feeds, volume data\nmay not be the same since some trades (block trades, OTC trades, etc.)\nmay only be available at the <em>end</em> of the trading day. Consequently, the\nEOD feed will include this volume data, but the intraday feed will not.\nDifferences between EOD and intraday volume feeds are almost nonexistent\nfor instruments such as cryptocurrencies, but they are commonplace in\nstocks.</p>\n<p>Slight price discrepancies may also occur between EOD and intraday\nfeeds. For example, the high value on one EOD bar may not match any\nintraday high values supplied by the data provider for that day.</p>\n<p>Another distinction between EOD and intraday data feeds is that EOD\nfeeds do not contain information from <em>extended hours</em>.</p>\n<p>When retrieving information on realtime bars with <code dir=\"auto\">request.*()</code>\nfunctions, it\u2019s important to note that historical and realtime data\nreported for an instrument often rely on <em>different</em> data feeds. A\nbroker/exchange may retroactively modify values reported on realtime\nbars, which the data will only reflect after refreshing the chart or\nrestarting the script.</p>\n<p>Another important consideration is that the chart\u2019s data feeds and\nfeeds requested from providers by the script are managed by\n<em>independent</em>, concurrent processes. Consequently, in some <em>rare</em> cases,\nit\u2019s possible for races to occur where requested results temporarily\nfall out of synch with the chart on a realtime bar, which a script\nretroactively adjusts after restarting its executions.</p>\n<p>These points may account for variations in the values retrieved by\n<code dir=\"auto\">request.*()</code> functions when requesting data from other contexts. They\nmay also result in discrepancies between data received on realtime bars\nand historical bars. There are no steadfast rules about the variations\none may encounter in their requested data feeds.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>As a rule, TradingView <em>does not</em> generate data; it relies on its data\nproviders for the information displayed on charts and accessed by\nscripts.</p></div></aside>\n<p>When using data feeds requested from other contexts, it\u2019s also crucial\nto consider the <em>time axis</em> differences between the chart the script\nexecutes on and the requested feeds since <code dir=\"auto\">request.*()</code> functions adapt\nthe returned series to the chart\u2019s time axis. For example, requesting\n\u201cBTCUSD\u201d data on the \u201cSPY\u201d chart with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwill only show new values when the \u201cSPY\u201d chart has new data as well.\nSince \u201cSPY\u201d is not a 24-hour symbol, the \u201cBTCUSD\u201d data returned will\ncontain gaps that are otherwise not present when viewing its chart\ndirectly.</p>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestsecurity\"><a href=\"#requestsecurity\"><span>\u200b<code dir=\"auto\">request.security()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction allows scripts to request data from other contexts than the\nchart the script executes on, such as:</p>\n<ul>\n<li>Other symbols, including <a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spread\nsymbols</a></li>\n<li>Other timeframes (see our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/timeframes/\">Timeframes</a> to learn\nabout timeframe specifications in Pine Script)</li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#custom-contexts\">Custom contexts</a>, including alternative sessions, price adjustments,\nchart types, etc. using <code dir=\"auto\">ticker.*()</code> functions</li>\n</ul>\n<p>This is the function\u2019s signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.security(symbol, timeframe, expression, gaps, lookahead, ignore_invalid_symbol, currency, calc_bars_count) \u2192 series &lt;type&gt;</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">symbol</code> value is the ticker identifier representing the symbol to\nfetch data from. This parameter accepts values in any of the following\nformats:</p>\n<ul>\n<li>A \u201cstring\u201d representing a symbol (e.g., \u201cIBM\u201d or \u201cEURUSD\u201d) or\nan <em>\u201cExchange:Symbol\u201d pair</em> (e.g., \u201cNYSE:IBM\u201d or\n\u201cOANDA:EURUSD\u201d). When the value does not contain an exchange\nprefix, the function selects the exchange automatically. We\nrecommend specifying the exchange prefix when possible for\nconsistent results. Users can also pass an empty string to this\nparameter, which prompts the function to use the current chart\u2019s\nsymbol.</li>\n<li>A \u201cstring\u201d representing a <a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spread\nsymbol</a>\n(e.g., \u201cAMD/INTC\u201d). Note that \u201cBar Replay\u201d mode does not work\nwith these symbols.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.ticker\">syminfo.ticker</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>\nbuilt-in variables, which return the symbol or the\n\u201cExchange:Symbol\u201d pair that the current chart references. We\nrecommend using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>\nto avoid ambiguity unless the exchange information does not matter\nin the data request. For more information on <code dir=\"auto\">syminfo.*</code> variables,\nsee\n<a href=\"/pine-script-docs/v5/concepts/chart-information/#symbol-information\">this</a> section of our\n<a href=\"/pine-script-docs/v5/concepts/chart-information/\">Chart information</a> page.</li>\n<li>A custom ticker identifier created using <code dir=\"auto\">ticker.*()</code> functions.\nTicker IDs constructed from these functions may contain additional\nsettings for requesting data using\n<a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard chart</a> calculations, alternative sessions, and other contexts.\nSee the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#custom-contexts\">Custom contexts</a> section for more information.</li>\n</ul>\n<p>The <code dir=\"auto\">timeframe</code> value specifies the timeframe of the requested data.\nThis parameter accepts \u201cstring\u201d values in our\n<a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">timeframe specification</a> format (e.g., a value of \u201c1D\u201d represents the daily\ntimeframe). To request data from the same timeframe as the chart the\nscript executes on, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a>\nvariable or an empty string.</p>\n<p>The <code dir=\"auto\">expression</code> parameter of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction determines the data it retrieves from the specified context.\nThis versatile parameter accepts \u201cseries\u201d values of\n<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#bool\">bool</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#string\">string</a>,\nand <a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart.point</a> types. It can also accept\n<a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuples</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>, and the outputs of function and\n<a href=\"/pine-script-docs/v5/language/methods/\">method</a> calls. For more\ndetails on the data one can retrieve, see the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestable-data\">Requestable data</a> section below.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>When using the value from an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a>\ncall in the <code dir=\"auto\">expression</code> argument and the input references a series from\nanother indicator, <code dir=\"auto\">request.*()</code> functions calculate that value\u2019s\nresults using the <strong>chart\u2019s symbol</strong>, regardless of the <code dir=\"auto\">symbol</code>\nargument supplied, since they cannot evaluate the scopes required by an\nexternal series. We therefore do not recommend attempting to request\nexternal source input data from other contexts.</p></div></aside>\n<h3 class=\"md-heading\" id=\"timeframes\"><a href=\"#timeframes\">Timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can request data from any available timeframe, regardless of\nthe chart the script executes on. The timeframe of the data retrieved\ndepends on the <code dir=\"auto\">timeframe</code> argument in the function call, which may\nrepresent a higher timeframe (e.g., using \u201c1D\u201d as the <code dir=\"auto\">timeframe</code>\nvalue while running the script on an intraday chart) or the chart\u2019s\ntimeframe (i.e., using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a>\nor an empty string as the <code dir=\"auto\">timeframe</code> argument).</p>\n<p>Scripts can also request <em>limited</em> data from lower timeframes with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\n(e.g., using \u201c1\u201d as the <code dir=\"auto\">timeframe</code> argument while running the script\non a 60-minute chart). However, we don\u2019t typically recommend using this\nfunction for LTF data requests. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction is more optimal for such cases.</p>\n<h4 class=\"md-heading\" id=\"higher-timeframes\"><a href=\"#higher-timeframes\">Higher timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Most use cases of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ninvolve requesting data from a timeframe higher than or the same as the\nchart timeframe. For example, this script retrieves the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>\nprice from a requested <code dir=\"auto\">higherTimeframe</code>. It\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the resulting series\non the chart alongside the current chart\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a> for\ncomparison:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Timeframes-Higher-timeframes-1.Cfl6KncV_1tTnEJ.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Higher timeframe security demo\", overlay = true)\n\n//@variable The higher timeframe to request data from.\nstring higherTimeframe = input.timeframe(\"240\", \"Higher timeframe\")\n\n//@variable The `hl2` value from the `higherTimeframe`. Combines lookahead with an offset to avoid repainting.\nfloat htfPrice = request.security(syminfo.tickerid, higherTimeframe, hl2[1], lookahead = barmerge.lookahead_on)\n\n// Plot the `hl2` from the chart timeframe and the `higherTimeframe`.\nplot(hl2, \"Current timeframe HL2\", color.teal, 2)\nplot(htfPrice, \"Higher timeframe HL2\", color.purple, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>We\u2019ve included an offset to the <code dir=\"auto\">expression</code> argument and used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nin\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto ensure the series returned behaves the same on historical and\nrealtime bars. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">Avoiding repainting</a> section for more information.</li>\n</ul>\n<p>Notice that in the above example, it is possible to select a\n<code dir=\"auto\">higherTimeframe</code> value that actually represents a <em>lower timeframe</em>\nthan the one the chart uses, as the code does not prevent it. When\ndesigning a script to work specifically with higher timeframes, we\nrecommend including conditions to prevent it from accessing lower\ntimeframes, especially if you intend to\n<a href=\"/pine-script-docs/v5/writing/publishing/\">publish</a> it.</p>\n<p>Below, we\u2019ve added an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure to our previous example that raises a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime.error\">runtime\nerror</a>\nwhen the <code dir=\"auto\">higherTimeframe</code> input represents a timeframe smaller than the\nchart timeframe, effectively preventing the script from requesting LTF\ndata:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Timeframes-Higher-timeframes-2.DLmdElJ0_Z1Wqvh6.webp\" width=\"804\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Higher timeframe security demo\", overlay = true)\n\n//@variable The higher timeframe to request data from.\nstring higherTimeframe = input.timeframe(\"240\", \"Higher timeframe\")\n\n// Raise a runtime error when the `higherTimeframe` is smaller than the chart's timeframe.\nif timeframe.in_seconds() &gt; timeframe.in_seconds(higherTimeframe)\n    runtime.error(\"The requested timeframe is smaller than the chart's timeframe. Select a higher timeframe.\")\n\n//@variable The `hl2` value from the `higherTimeframe`. Combines lookahead with an offset to avoid repainting.\nfloat htfPrice = request.security(syminfo.tickerid, higherTimeframe, hl2[1], lookahead = barmerge.lookahead_on)\n\n// Plot the `hl2` from the chart timeframe and the `higherTimeframe`.\nplot(hl2, \"Current timeframe HL2\", color.teal, 2)\nplot(htfPrice, \"Higher timeframe HL2\", color.purple, 3)</div>\n<h4 class=\"md-heading\" id=\"lower-timeframes\"><a href=\"#lower-timeframes\">Lower timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Although the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction is intended to operate on timeframes greater than or equal to\nthe chart timeframe, it <em>can</em> request data from lower timeframes as\nwell, with limitations. When calling this function to access a lower\ntimeframe, it will evaluate the <code dir=\"auto\">expression</code> from the LTF context.\nHowever, it can only return the results from a <em>single</em> intrabar (LTF\nbar) on each chart bar.</p>\n<p>The intrabar that the function returns data from on each historical\nchart bar depends on the <code dir=\"auto\">lookahead</code> value in the function call. When\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>,\nit will return the <em>first</em> available intrabar from the chart period.\nWhen using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_off\">barmerge.lookahead_off</a>,\nit will return the <em>last</em> intrabar from the chart period. On realtime\nbars, it returns the last available value of the <code dir=\"auto\">expression</code> from the\ntimeframe, regardless of the <code dir=\"auto\">lookahead</code> value, as the realtime intrabar\ninformation retrieved by the function is not yet sorted.</p>\n<p>This script retrieves\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\ndata from the valid timeframe closest to a fourth of the size of the\nchart timeframe. It makes two calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwith different <code dir=\"auto\">lookahead</code> values. The first call uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nto access the first intrabar value in each chart bar. The second uses\nthe default <code dir=\"auto\">lookahead</code> value\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_off\">barmerge.lookahead_off</a>),\nwhich requests the last intrabar value assigned to each chart bar. The\nscript <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the outputs of\nboth calls on the chart to compare the difference:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"552\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Timeframes-Lower-timeframes-1.CzbZyyC2_Z2o4fpJ.webp\" width=\"1258\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Lower timeframe security demo\", overlay = true)\n\n//@variable The valid timeframe closest to 1/4 the size of the chart timeframe.\nstring lowerTimeframe = timeframe.from_seconds(int(timeframe.in_seconds() / 4))\n\n//@variable The `close` value on the `lowerTimeframe`. Represents the first intrabar value on each chart bar.\nfloat firstLTFClose = request.security(syminfo.tickerid, lowerTimeframe, close, lookahead = barmerge.lookahead_on)\n//@variable The `close` value on the `lowerTimeframe`. Represents the last intrabar value on each chart bar.\nfloat lastLTFClose = request.security(syminfo.tickerid, lowerTimeframe, close)\n\n// Plot the values.\nplot(firstLTFClose, \"First intrabar close\", color.teal, 3)\nplot(lastLTFClose, \"Last intrabar close\", color.purple, 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 70) : na, title = \"Realtime background highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script determines the value of the <code dir=\"auto\">lowerTimeframe</code> by\ncalculating the number of seconds in the chart timeframe with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a>,\nthen dividing by four and converting the result to a\n<a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">valid timeframe string</a> via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a>.</li>\n<li>The plot of the series without lookahead\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.purple\">purple</a>)\naligns with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalue on the chart timeframe, as this is the last intrabar value\nin the chart bar.</li>\n<li>Both\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncalls return the <em>same</em> value (the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>)\non each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">realtime</a>\nbar, as shown on the bars with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_color.orange\">orange</a>\nbackground.</li>\n<li>Scripts can retrieve up to 200,000 intrabars from a lower-timeframe context. The number of chart bars with available intrabar data varies with the requested lower timeframe, the <code dir=\"auto\">calc_bars_count</code> value, and the user\u2019s plan. See <a href=\"/pine-script-docs/v5/writing/limitations/#intrabars\">this</a> section of the <a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>While scripts can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve the values from a <em>single</em> intrabar on each chart bar, which\nmight provide utility in some unique cases, we recommend using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction for intrabar analysis when possible, as it returns an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining data from <em>all</em> available intrabars within a chart bar. See\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity_lower_tf\">this section</a> to learn more.</p></div></aside>\n<h3 class=\"md-heading\" id=\"requestable-data\"><a href=\"#requestable-data\">Requestable data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction is quite versatile, as it can retrieve values of any\nfundamental type (<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a>, <a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>, <a href=\"/pine-script-docs/v5/language/type-system/#bool\">bool</a>, <a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>, or <a href=\"/pine-script-docs/v5/language/type-system/#string\">string</a>). It can also request the IDs of data structures and\nbuilt-in or\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> that reference fundamental types. The data this function\nrequests depends on its <code dir=\"auto\">expression</code> parameter, which accepts any of the\nfollowing arguments:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#built-in-variables-and-functions\">Built-in variables and function calls</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#calculated-variables\">Variables calculated by the script</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">Tuples</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#user-defined-functions\">Calls to user-defined functions</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#chart-points\">Chart points</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#collections\">Collections</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#user-defined-types\">User-defined types</a></li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction duplicates the scopes and operations required by the\n<code dir=\"auto\">expression</code> to calculate its requested values in another context, which\nelevates runtime memory consumption. Additionally, the extra scopes\nproduced by each call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncount toward the script\u2019s <em>compilation limits</em>. See the\n<a href=\"/pine-script-docs/v5/writing/limitations/#scope-count\">Scope count</a> section of the\n<a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for\nmore information.</p></div></aside>\n<h4 class=\"md-heading\" id=\"built-in-variables-and-functions\"><a href=\"#built-in-variables-and-functions\">Built-in variables and functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>A frequent use case of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nis requesting the output of a built-in variable or\nfunction/<a href=\"/pine-script-docs/v5/language/methods/\">method</a> call from\nanother symbol or timeframe.</p>\n<p>For example, suppose we want to calculate the 20-bar\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">SMA</a>\nof a symbol\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>\nprice from the daily timeframe while on an intraday chart. We can\naccomplish this with a single line of code:</p>\n<div class=\"pine-colorizer not-content\">float ma = request.security(syminfo.tickerid, \"1D\", ta.sma(ohlc4, 20))</div>\n<p>The above line calculates the value of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(ohlc4,\n20)</a>\non the current symbol from the daily timeframe.</p>\n<p>It\u2019s important to note that newcomers to Pine may sometimes confuse the\nabove line of code as being equivalent to the following:</p>\n<div class=\"pine-colorizer not-content\">float ma = ta.sma(request.security(syminfo.tickerid, \"1D\", ohlc4), 20)</div>\n<p>However, this line will return an entirely <em>different</em> result. Rather\nthan requesting a 20-bar SMA from the daily timeframe, it requests the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>\nprice from the daily timeframe and calclates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\nof the results over 20 <strong>chart bars</strong>.</p>\n<p>In essence, when the intention is to request the results of an\nexpression from other contexts, pass the expression <em>directly</em> to the\n<code dir=\"auto\">expression</code> parameter in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall, as demonstrated in the initial example.</p>\n<p>Let\u2019s expand on this concept. The script below calculates a\nmulti-timeframe (MTF) ribbon of moving averages, where each moving\naverage in the ribbon calculates over the same number of bars on its\nrespective timeframe. Each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(close,\nlength)</a>\nas its <code dir=\"auto\">expression</code> argument to return a <code dir=\"auto\">length</code>-bar SMA from the\nspecified timeframe:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-Built-in-variables-and-functions-1.CPvZdzBd_Z1LKRRo.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting built-ins demo\", \"MTF Ribbon\", true)\n\n//@variable The length of each moving average.\nint length = input.int(20, \"Length\", 1)\n\n//@variable The number of seconds in the chart timeframe.\nint chartSeconds = timeframe.in_seconds()\n\n// Calculate the higher timeframes closest to 2, 3, and 4 times the size of the chart timeframe.\nstring htf1 = timeframe.from_seconds(chartSeconds * 2)\nstring htf2 = timeframe.from_seconds(chartSeconds * 3)\nstring htf3 = timeframe.from_seconds(chartSeconds * 4)\n\n// Calculate the `length`-bar moving averages from each timeframe.\nfloat chartAvg = ta.sma(ohlc4, length)\nfloat htfAvg1  = request.security(syminfo.tickerid, htf1, ta.sma(ohlc4, length))\nfloat htfAvg2  = request.security(syminfo.tickerid, htf2, ta.sma(ohlc4, length))\nfloat htfAvg3  = request.security(syminfo.tickerid, htf3, ta.sma(ohlc4, length))\n\n// Plot the results.\nplot(chartAvg, \"Chart timeframe SMA\", color.red, 3)\nplot(htfAvg1, \"Double timeframe SMA\", color.orange, 3)\nplot(htfAvg2, \"Triple timeframe SMA\", color.green, 3)\nplot(htfAvg3, \"Quadruple timeframe SMA\", color.blue, 3)\n\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.aqua, 70) : na, title = \"Realtime highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script calculates the ribbon\u2019s higher timeframes by\nmultiplying the chart\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a>\nvalue by 2, 3, and 4, then converting each result into a\n<a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">valid timeframe string</a> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a>.</li>\n<li>Instead of calling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\nwithin each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall, one could use the <code dir=\"auto\">chartAvg</code> variable as the <code dir=\"auto\">expression</code>\nin each call to achieve the same result. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#calculated-variables\">next section</a> for more information.</li>\n<li>On realtime bars, this script also tracks <em>unconfirmed</em> SMA\nvalues from each higher timeframe. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#historical-and-realtime-behavior\">Historical and realtime behavior</a> section to learn more.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"calculated-variables\"><a href=\"#calculated-variables\">Calculated variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <code dir=\"auto\">expression</code> parameter of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\naccepts variables declared in the global scope, allowing scripts to\nevaluate their variables\u2019 calculations from other contexts without\nredundantly listing the operations in each function call.</p>\n<p>For example, one can declare the following variable:</p>\n<div class=\"pine-colorizer not-content\">priceReturn = (close - close[1]) / close[1]</div>\n<p>and execute the variable\u2019s calculation from another context with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>:</p>\n<div class=\"pine-colorizer not-content\">requestedReturn = request.security(symbol, timeframe.period, priceReturn)</div>\n<p>The function call in the line above will return the result of the\n<code dir=\"auto\">priceReturn</code> calculation on another <code dir=\"auto\">symbol</code>\u2019s data as a series\nadapted to the current chart, which the script can display directly on\nthe chart or utilize in additional operations.</p>\n<p>The following example compares the price returns of the current chart\u2019s\nsymbol and another specified <code dir=\"auto\">symbol</code>. The script declares the\n<code dir=\"auto\">priceReturn</code> variable from the chart\u2019s context, then uses that\nvariable in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto evaluate its calculation on another <code dir=\"auto\">symbol</code>. It then calculates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.correlation\">correlation</a>\nbetween the <code dir=\"auto\">priceReturn</code> and <code dir=\"auto\">requestedReturn</code> and\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the result on the\nchart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-Calculated-variables-1.DpMsOLKI_Z6c3MD.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting calculated variables demo\", \"Price return correlation\")\n\n//@variable The symbol to compare to the chart symbol.\nstring symbol = input.symbol(\"SPY\", \"Symbol to compare\")\n//@variable The number of bars in the calculation window.\nint length = input.int(60, \"Length\", 1)\n\n//@variable The close-to-close price return.\nfloat priceReturn = (close - close[1]) / close[1]\n//@variable The close-to-close price return calculated on another `symbol`.\nfloat requestedReturn = request.security(symbol, timeframe.period, priceReturn)\n\n//@variable The correlation between the `priceReturn` and `requestedReturn` over `length` bars.\nfloat correlation = ta.correlation(priceReturn, requestedReturn, length)\n//@variable The color of the correlation plot.\ncolor plotColor = color.from_gradient(correlation, -1, 1, color.purple, color.orange)\n\n// Plot the correlation value.\nplot(correlation, \"Correlation\", plotColor, style = plot.style_area)</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall executes the same calculation used in the <code dir=\"auto\">priceReturn</code>\ndeclaration, except it uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues fetched from the input <code dir=\"auto\">symbol</code>.</li>\n<li>The script colors the plot with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.from_gradient\">gradient</a>\nbased on the <code dir=\"auto\">correlation</code> value. To learn more about color\ngradients in Pine, see\n<a href=\"/pine-script-docs/v5/concepts/colors/#colorfrom_gradient\">this</a> section of our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/colors/\">colors</a>.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"tuples\"><a href=\"#tuples\">Tuples<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/type-system/#tuples\">Tuples</a> in Pine\nScript are comma-separated sets of expressions enclosed in brackets\nthat can hold multiple values of any available type. We use tuples when\ncreating functions or other local blocks that return more than one\nvalue.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can accept a tuple as its <code dir=\"auto\">expression</code> argument, allowing\nscripts to request multiple series of different types using a single\nfunction call. The expressions within requested tuples can be of any\ntype outlined throughout the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestable-data\">Requestable data</a> section of this page, excluding other tuples.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The combined size of all tuples returned by <code dir=\"auto\">request.*()</code> calls in a\nscript cannot exceed 127 elements. See\n<a href=\"/pine-script-docs/v5/writing/limitations/#tuple-element-limit\">this</a> section of the\n<a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for\nmore information.</p></div></aside>\n<p>Tuples are particularly handy when a script needs to retrieve more than\none value from a specific context.</p>\n<p>For example, this script calculates the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.percentrank\">percent\nrank</a>\nof the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice over <code dir=\"auto\">length</code> bars and assigns the expression to the <code dir=\"auto\">rank</code>\nvariable. It then calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto request a tuple containing the <code dir=\"auto\">rank</code>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.crossover\">ta.crossover(rank,\n50)</a>,\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.crossunder\">ta.crossunder(rank,\n50)</a>\nvalues from the specified <code dir=\"auto\">timeframe</code>. The script\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the <code dir=\"auto\">requestedRank</code>\nand uses the <code dir=\"auto\">crossOver</code> and <code dir=\"auto\">crossUnder</code> \u201cbool\u201d values within\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nto conditionally highlight the chart pane\u2019s background:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-Tuples-1.DfMFJD2A_22M4RL.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting tuples demo\", \"Percent rank cross\")\n\n//@variable The timeframe of the request.\nstring timeframe = input.timeframe(\"240\", \"Timeframe\")\n//@variable The number of bars in the calculation.\nint length = input.int(20, \"Length\")\n\n//@variable The previous bar's percent rank of the `close` price over `length` bars.\nfloat rank = ta.percentrank(close, length)[1]\n\n// Request the `rank` value from another `timeframe`, and two \"bool\" values indicating the `rank` from the `timeframe`\n// crossed over or under 50.\n[requestedRank, crossOver, crossUnder] = request.security(\n     syminfo.tickerid, timeframe, [rank, ta.crossover(rank, 50), ta.crossunder(rank, 50)],\n     lookahead = barmerge.lookahead_on\n )\n\n// Plot the `requestedRank` and create a horizontal line at 50.\nplot(requestedRank, \"Percent Rank\", linewidth = 3)\nhline(50, \"Cross line\", linewidth = 2)\n// Highlight the background of all bars where the `timeframe`'s `crossOver` or `crossUnder` value is `true`.\nbgcolor(crossOver ? color.new(color.green, 50) : crossUnder ? color.new(color.red, 50) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>We\u2019ve offset the <code dir=\"auto\">rank</code> variable\u2019s expression by one bar using\nthe history-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nand included\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall to ensure the values on realtime bars do not repaint after\nbecoming historical bars. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">Avoiding repainting</a> section for more information.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall returns a tuple, so we use a <em>tuple declaration</em> to declare\nthe <code dir=\"auto\">requestedRank</code>, <code dir=\"auto\">crossOver</code>, and <code dir=\"auto\">crossUnder</code> variables. To\nlearn more about using tuples, see\n<a href=\"/pine-script-docs/v5/language/type-system/#tuples\">this section</a> of our User Manual\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a>\npage.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"user-defined-functions\"><a href=\"#user-defined-functions\">User-defined functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/user-defined-functions/\">User-defined functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nare custom functions written by users. They allow users to define\nsequences of operations associated with an identifier that scripts can\nconveniently call throughout their executions (e.g., <code dir=\"auto\">myUDF()</code>).</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can request the results of\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nwhose scopes consist of any types outlined throughout this page\u2019s\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestable-data\">Requestable data</a> section.</p>\n<p>For example, this script contains a user-defined <code dir=\"auto\">weightedBB()</code> function\nthat calculates Bollinger Bands with the basis average weighted by a\nspecified <code dir=\"auto\">weight</code> series. The function returns a\n<a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> of custom\nband values. The script calls the <code dir=\"auto\">weightedBB()</code> as the <code dir=\"auto\">expression</code>\nargument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve a\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">tuple</a> of band values calculated on the specified <code dir=\"auto\">timeframe</code> and\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the results on the\nchart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"578\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-User-defined-functions-1.DTi5QOZX_ZMtoWB.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting user-defined functions demo\", \"Weighted Bollinger Bands\", true)\n\n//@variable The timeframe of the request.\nstring timeframe = input.timeframe(\"480\", \"Timeframe\")\n\n//@function     Calculates Bollinger Bands with a custom weighted basis.\n//@param source The series of values to process.\n//@param length The number of bars in the calculation.\n//@param mult   The standard deviation multiplier.\n//@param weight The series of weights corresponding to each `source` value.\n//@returns      A tuple containing the basis, upper band, and lower band respectively.\nweightedBB(float source, int length, float mult = 2.0, float weight = 1.0) =&gt;\n    //@variable The basis of the bands.\n    float ma = math.sum(source * weight, length) / math.sum(weight, length)\n    //@variable The standard deviation from the `ma`.\n    float dev = 0.0\n    // Loop to accumulate squared error.\n    for i = 0 to length - 1\n        difference = source[i] - ma\n        dev += difference * difference\n    // Divide `dev` by the `length`, take the square root, and multiply by the `mult`.\n    dev := math.sqrt(dev / length) * mult\n    // Return the bands.\n    [ma, ma + dev, ma - dev]\n\n// Request weighted bands calculated on the chart symbol's prices over 20 bars from the\n// last confirmed bar on the `timeframe`.\n[basis, highBand, lowBand] = request.security(\n     syminfo.tickerid, timeframe, weightedBB(close[1], 20, 2.0, (high - low)[1]), lookahead = barmerge.lookahead_on\n )\n\n// Plot the values.\nbasisPlot = plot(basis, \"Basis\", color.orange, 2)\nupperPlot = plot(highBand, \"Upper\", color.teal, 2)\nlowerPlot = plot(lowBand, \"Lower\", color.maroon, 2)\nfill(upperPlot, lowerPlot, color.new(color.gray, 90), \"Background\")</div>\n<p>Note that:</p>\n<ul>\n<li>We offset the <code dir=\"auto\">source</code> and <code dir=\"auto\">weight</code> arguments in the\n<code dir=\"auto\">weightedBB()</code> call used as the <code dir=\"auto\">expression</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nand used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nto ensure the requested results reflect the last confirmed\nvalues from the <code dir=\"auto\">timeframe</code> on realtime bars. See\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">this section</a> to learn more.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"chart-points\"><a href=\"#chart-points\">Chart points<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">Chart points</a> are reference types that represent coordinates on the chart.\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">Lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nand <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>\nuse\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects to set their display locations.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can use the ID of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ninstance in its <code dir=\"auto\">expression</code> argument, allowing scripts to retrieve\nchart coordinates from other contexts.</p>\n<p>The example below requests a tuple of historical\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> from a higher timeframe and uses them to draw\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> on the\nchart. The script declares the <code dir=\"auto\">topLeft</code> and <code dir=\"auto\">bottomRight</code> variables\nthat reference\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nIDs from the last confirmed bar. It then uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto request a\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">tuple</a> containing the IDs of\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> representing the <code dir=\"auto\">topLeft</code> and <code dir=\"auto\">bottomRight</code> from a\n<code dir=\"auto\">higherTimeframe</code>.</p>\n<p>When a new bar starts on the <code dir=\"auto\">higherTimeframe</code>, the script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">new\nbox</a>\nusing the <code dir=\"auto\">time</code> and <code dir=\"auto\">price</code> coordinates from the <code dir=\"auto\">requestedTopLeft</code> and\n<code dir=\"auto\">requestedBottomRight</code> chart points:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-Chart-points-1.C5dKnJ3R_Z1YxlJR.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting chart points demo\", \"HTF Boxes\", true, max_boxes_count = 500)\n\n//@variable The timeframe to request data from.\nstring higherTimeframe = input.timeframe(\"1D\", \"Timeframe\")\n\n// Raise a runtime error if the `higherTimeframe` is smaller than the chart's timeframe.\nif timeframe.in_seconds(higherTimeframe) &lt; timeframe.in_seconds(timeframe.period)\n    runtime.error(\"The selected timeframe is too small. Choose a higher timeframe.\")\n\n//@variable A `chart.point` containing top-left coordinates from the last confirmed bar.\ntopLeft = chart.point.now(high)[1]\n//@variable A `chart.point` containing bottom-right coordinates from the last confirmed bar.\nbottomRight = chart.point.from_time(time_close, low)[1]\n\n// Request the last confirmed `topLeft` and `bottomRight` chart points from the `higherTimeframe`.\n[requestedTopLeft, requestedBottomRight] = request.security(\n     syminfo.tickerid, higherTimeframe, [topLeft, bottomRight], lookahead = barmerge.lookahead_on\n )\n\n// Draw a new box when a new `higherTimeframe` bar starts.\n// The box uses the `time` fields from the `requestedTopLeft` and `requestedBottomRight` as x-coordinates.\nif timeframe.change(higherTimeframe)\n    box.new(\n         requestedTopLeft, requestedBottomRight, color.purple, 3, \n         xloc = xloc.bar_time, bgcolor = color.new(color.purple, 90)\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>Since this example is designed specifically for higher\ntimeframes, we\u2019ve included a custom <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime.error\">runtime\nerror</a>\nthat the script raises when the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a>\nof the <code dir=\"auto\">higherTimeframe</code> is smaller than that of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">chart\u2019s\ntimeframe</a>.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"collections\"><a href=\"#collections\">Collections<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Pine Script <em>collections</em> (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>,\nand <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) are data structures\nthat contain an arbitrary number of elements with specified types. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can retrieve the IDs of\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> whose elements consist of:</p>\n<ul>\n<li>Fundamental types</li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">Chart points</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">User-defined types</a> that satisfy the criteria listed in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#user-defined-types\">section below</a></li>\n</ul>\n<p>This example calculates the ratio of a confirmed bar\u2019s high-low range\nto the range between the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">highest</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.lowest\">lowest</a>\nvalues over 10 bars from a specified <code dir=\"auto\">symbol</code> and <code dir=\"auto\">timeframe</code>. It uses\n<a href=\"/pine-script-docs/v5/language/maps/\">maps</a> to hold the values used\nin the calculations.</p>\n<p>The script creates a <code dir=\"auto\">data</code> map with \u201cstring\u201d keys and \u201cfloat\u201d\nvalues to hold\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">highest</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.lowest\">lowest</a>\nprice values on each bar, which it uses as the <code dir=\"auto\">expression</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto calculate an <code dir=\"auto\">otherData</code> map representing the <code dir=\"auto\">data</code> from the\nspecified context. It uses the values associated with the \u201cHigh\u201d,\n\u201cLow\u201d, \u201cHighest\u201d, and \u201cLowest\u201d keys of the <code dir=\"auto\">otherData</code> map to\ncalculate the <code dir=\"auto\">ratio</code> that it <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> in the chart pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-Collections-1.C6G31C3k_2bffgq.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting collections demo\", \"Bar range ratio\")\n\n//@variable The ticker ID to request data from.\nstring symbol = input.symbol(\"\", \"Symbol\")\n//@variable The timeframe of the request.\nstring timeframe = input.timeframe(\"30\", \"Timeframe\")\n\n//@variable A map with \"string\" keys and \"float\" values.\nvar map&lt;string, float&gt; data = map.new&lt;string, float&gt;()\n\n// Put key-value pairs into the `data` map.\nmap.put(data, \"High\", high)\nmap.put(data, \"Low\", low)\nmap.put(data, \"Highest\", ta.highest(10))\nmap.put(data, \"Lowest\", ta.lowest(10))\n\n//@variable A new `map` whose data is calculated from the last confirmed bar of the requested context.\nmap&lt;string, float&gt; otherData = request.security(symbol, timeframe, data[1], lookahead = barmerge.lookahead_on)\n\n//@variable The ratio of the context's bar range to the max range over 10 bars. Returns `na` if no data is available.\nfloat ratio = na\nif not na(otherData)\n    ratio := (otherData.get(\"High\") - otherData.get(\"Low\")) / (otherData.get(\"Highest\") - otherData.get(\"Lowest\"))\n\n//@variable A gradient color for the plot of the `ratio`.\ncolor ratioColor = color.from_gradient(ratio, 0, 1, color.purple, color.orange)\n\n// Plot the `ratio`.\nplot(ratio, \"Range Ratio\", ratioColor, 3, plot.style_area)</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall in this script can return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nif no data is available from the specified context. Since one\ncannot call <a href=\"/pine-script-docs/v5/language/methods/\">methods</a> on a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nvariable when its value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nwe\u2019ve added an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure to only calculate a new <code dir=\"auto\">ratio</code> value when <code dir=\"auto\">otherData</code>\nreferences a valid\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nID.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"user-defined-types\"><a href=\"#user-defined-types\">User-defined types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">User-defined types (UDTs)</a> are <em>composite types</em> containing an arbitrary number of\n<em>fields</em>, which can be of any available type, including other\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can retrieve the IDs of\n<a href=\"/pine-script-docs/v5/language/objects/\">objects</a> produced by\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>\nfrom other contexts if their fields consist of:</p>\n<ul>\n<li>Fundamental types</li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">Chart points</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#collections\">Collections</a> that satisfy the criteria listed in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#collections\">section above</a></li>\n<li>Other <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a> whose fields consist of any of these types</li>\n</ul>\n<p>The following example requests an\n<a href=\"/pine-script-docs/v5/language/objects/\">object</a> ID using a\nspecified <code dir=\"auto\">symbol</code> and displays its field values on a chart pane.</p>\n<p>The script contains a <code dir=\"auto\">TickerInfo</code> UDT with \u201cstring\u201d fields for\n<code dir=\"auto\">syminfo.*</code> values, an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nfield to store recent \u201cfloat\u201d price data, and an \u201cint\u201d field to hold\nthe requested ticker\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nvalue. It assigns a new <code dir=\"auto\">TickerInfo</code> ID to an <code dir=\"auto\">info</code> variable on every\nbar and uses the variable as the <code dir=\"auto\">expression</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve the ID of an <a href=\"/pine-script-docs/v5/language/objects/\">object</a> representing the calculated <code dir=\"auto\">info</code> from the specified\n<code dir=\"auto\">symbol</code>.</p>\n<p>The script displays the <code dir=\"auto\">requestedInfo</code> object\u2019s <code dir=\"auto\">description</code>,\n<code dir=\"auto\">tickerType</code>, <code dir=\"auto\">currency</code>, and <code dir=\"auto\">barIndex</code> values in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nand uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\nto display the values from its <code dir=\"auto\">prices</code> array:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-Requestable-data-User-defined-types-1.D90DRv4r_1OUO19.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting user-defined types demo\", \"Ticker info\")\n\n//@variable The symbol to request information from.\nstring symbol = input.symbol(\"NASDAQ:AAPL\", \"Symbol\")\n\n//@type               A custom type containing information about a ticker.\n//@field description  The symbol's description.\n//@field tickerType   The type of ticker.\n//@field currency     The symbol's currency.\n//@field prices       An array of the symbol's current prices.\n//@field barIndex     The ticker's `bar_index`.\ntype TickerInfo\n    string       description\n    string       tickerType\n    string       currency\n    array&lt;float&gt; prices\n    int          barIndex\n\n//@variable A `TickerInfo` object containing current data.\ninfo = TickerInfo.new(\n     syminfo.description, syminfo.type, syminfo.currency, array.from(open, high, low, close), bar_index\n )\n//@variable The `info` requested from the specified `symbol`.\nTickerInfo requestedInfo = request.security(symbol, timeframe.period, info)\n// Assign a new `TickerInfo` instance to `requestedInfo` if one wasn't retrieved.\nif na(requestedInfo)\n    requestedInfo := TickerInfo.new(prices = array.new&lt;float&gt;(4))\n\n//@variable A label displaying information from the `requestedInfo` object.\nvar infoLabel = label.new(\n     na, na, \"\", color = color.purple, style = label.style_label_left, textcolor = color.white, size = size.large\n )\n//@variable The text to display inside the `infoLabel`.\nstring infoText = na(requestedInfo) ? \"\" : str.format(\n     \"{0}\\nType: {1}\\nCurrency: {2}\\nBar Index: {3}\",\n     requestedInfo.description, requestedInfo.tickerType, requestedInfo.currency, requestedInfo.barIndex\n )\n\n// Set the `point` and `text` of the `infoLabel`.\nlabel.set_point(infoLabel, chart.point.now(array.last(requestedInfo.prices)))\nlabel.set_text(infoLabel, infoText)\n// Plot candles using the values from the `prices` array of the `requestedInfo`.\nplotcandle(\n     requestedInfo.prices.get(0), requestedInfo.prices.get(1), requestedInfo.prices.get(2), requestedInfo.prices.get(3),\n     \"Requested Prices\"\n )</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">syminfo.*</code> variables used in this script all return\n\u201csimple string\u201d qualified types. However,\n<a href=\"/pine-script-docs/v5/language/objects/\">objects</a> in Pine\nare <em>always</em> qualified as \u201cseries\u201d. Consequently, all values\nassigned to the <code dir=\"auto\">info</code> object\u2019s fields automatically adopt the\n\u201cseries\u201d\n<a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">qualifier</a>.</li>\n<li>It is possible for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall to return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\ndue to differences between the data requested from the <code dir=\"auto\">symbol</code>\nand the main chart. This script assigns a new <code dir=\"auto\">TickerInfo</code>\nobject to the <code dir=\"auto\">requestedInfo</code> in that case to prevent runtime\nerrors.</li>\n</ul>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestsecurity_lower_tf\"><a href=\"#requestsecurity_lower_tf\"><span>\u200b<code dir=\"auto\">request.security_lower_tf()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction is an alternative to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ndesigned for reliably requesting information from lower-timeframe (LTF)\ncontexts.</p>\n<p>While\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncan retrieve data from a <em>single</em> intrabar (LTF bar) in each chart bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nretrieves data from <em>all</em> available intrabars in each chart bar, which\nthe script can access and use in additional calculations. Each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncall can retrieve up to 100,000 intrabars from a lower timeframe. See\n<a href=\"/pine-script-docs/v5/writing/limitations/#request-calls\">this</a>\nsection of our <a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for more information.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Working with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ninvolves frequent usage of <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> since it always returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nresults. We therefore recommend you familiarize yourself with\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> to make the most of\nthis function in your scripts.</p></div></aside>\n<p>Below is the function\u2019s signature, which is similar to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.security_lower_tf(symbol, timeframe, expression, ignore_invalid_symbol, currency, ignore_invalid_timeframe, calc_bars_count) \u2192 array&lt;type&gt;</span></div></div></code></pre></figure></div>\n<p>This function <strong>only</strong> requests data from timeframes less than or equal\nto the chart\u2019s timeframe. If the <code dir=\"auto\">timeframe</code> of the request represents\na higher timeframe than the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">chart\u2019s\ntimeframe</a>,\nthe function will either raise a runtime error or return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues depending on the <code dir=\"auto\">ignore_invalid_timeframe</code> argument in the call.\nThe default value for this parameter is <code dir=\"auto\">false</code>, meaning it raises\nan error and halt the script\u2019s executions when attempting to request HTF\ndata.</p>\n<h3 class=\"md-heading\" id=\"requesting-intrabar-data\"><a href=\"#requesting-intrabar-data\">Requesting intrabar data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Intrabar data can provide a script with additional information that may\nnot be obvious or accessible from solely analyzing data sampled on the\nchart\u2019s timerframe. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction can retrieve many data types from an intrabar context.</p>\n<p>Before you venture further in this section, we recommend exploring the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestable-data\">Requestable data</a> portion of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity\">request.security()</a> section above, which provides foundational information about\nthe types of data one can request. The <code dir=\"auto\">expression</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\naccepts most of the same arguments discussed in that section, excluding\ndirect references to\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> and mutable variables declared in the script\u2019s main scope.\nAlthough it accepts many of the same types of arguments, this function\nreturns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nresults, which comes with some differences in interpretation and\nhandling, as explained below.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>As with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nduplicates the scopes and operations required to calculate the\n<code dir=\"auto\">expression</code> from another context. The scopes from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nincrease runtime memory consumption and count toward the script\u2019s\ncompilation limits. See the\n<a href=\"/pine-script-docs/v5/writing/limitations/#scope-count\">Scope count</a> section of the\n<a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page to\nlearn more.</p></div></aside>\n<h3 class=\"md-heading\" id=\"intrabar-data-arrays\"><a href=\"#intrabar-data-arrays\">Intrabar data arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Lower timeframes contain more data points than higher timeframes, as new\nvalues come in at a <em>higher frequency</em>. For example, when comparing a\n1-minute chart to an hourly chart, the 1-minute chart will have up to 60\ntimes the number of bars per hour, depending on the available data.</p>\n<p>To address the fact that multiple intrabars exist within a chart bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nalways returns its results as <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>. The elements in the returned\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> represent the\n<code dir=\"auto\">expression</code> values retrieved from the lower timeframe sorted in\nascending order based on each intrabar\u2019s timestamp.</p>\n<p>The <a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> assigned to the returned\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> corresponds to the\nvalue types passed in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncall. For example, using an \u201cint\u201d as the <code dir=\"auto\">expression</code> will produce an\n<code dir=\"auto\">array&lt;int&gt;</code> instance, a \u201cbool\u201d as the <code dir=\"auto\">expression</code> will produce an\n<code dir=\"auto\">array&lt;bool&gt;</code> instance, etc.</p>\n<p>The following script uses intrabar information to decompose the chart\u2019s\nclose-to-close price changes into positive and negative parts. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nto fetch a \u201cfloat\u201d\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.change\">ta.change(close)</a>\nvalues from the <code dir=\"auto\">lowerTimeframe</code> on each chart bar, then accesses all\nthe array\u2019s elements using a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop to accumulate <code dir=\"auto\">positiveChange</code> and <code dir=\"auto\">negativeChange</code> sums. The\nscript adds the accumulated values to calculate the <code dir=\"auto\">netChange</code>, then\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the results on the\nchart alongside the <code dir=\"auto\">priceChange</code> for comparison:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"574\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-lower-tf-Intrabar-data-arrays-1.BFy5KmoZ_CQoK9.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Intrabar arrays demo\", \"Intrabar price changes\")\n\n//@variable The lower timeframe of the requested data.\nstring lowerTimeframe = input.timeframe(\"1\", \"Timeframe\")\n\n//@variable The close-to-close price change.\nfloat priceChange = ta.change(close)\n\n//@variable An array of `close` values from available intrabars on the `lowerTimeframe`.\narray&lt;float&gt; intrabarChanges = request.security_lower_tf(syminfo.tickerid, lowerTimeframe, priceChange)\n\n//@variable The total positive intrabar `close` movement on the chart bar.\nfloat positiveChange = 0.0\n//@variable The total negative intrabar `close` movement on the chart bar.\nfloat negativeChange = 0.0\n\n// Loop to calculate totals, starting from the chart bar's first available intrabar.\nfor change in intrabarChanges\n    // Add the `change` to `positiveChange` if its sign is 1, and add to `negativeChange` if its sign is -1.\n    switch math.sign(change)\n        1  =&gt; positiveChange += change\n        -1 =&gt; negativeChange += change\n\n//@variable The sum of `positiveChange` and `negativeChange`. Equals the `priceChange` on bars with available intrabars.\nfloat netChange = positiveChange + negativeChange\n\n// Plot the `positiveChange`, `negativeChange`, and `netChange`.\nplot(positiveChange, \"Positive intrabar change\", color.teal, style = plot.style_area)\nplot(negativeChange, \"Negative intrabar change\", color.maroon, style = plot.style_area)\nplot(netChange, \"Net intrabar change\", color.yellow, 5)\n// Plot the `priceChange` to compare.\nplot(priceChange, \"Chart price change\", color.orange, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> based on\nintrabar data may not appear on all available chart bars, as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncan only access up to the most recent 100,000 intrabars\navailable from the requested context. When executing this\nfunction on a chart bar that doesn\u2019t have accessible intrabar\ndata, it will return an <em>empty array</em>.</li>\n<li>The number of intrabars per chart bar may vary depending on the\ndata available from the context and the chart the script\nexecutes on. For example, a provider\u2019s 1-minute data feed may\nnot include data for every minute within the 60-minute timeframe\ndue to a lack of trading activity over some 1-minute intervals.\nTo check the number of intrabars retrieved for a chart bar, one\ncan use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a>\non the resulting\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.</li>\n<li>If the <code dir=\"auto\">lowerTimeframe</code> value is greater than the chart\u2019s\ntimeframe, the script will raise a <em>runtime error</em>, as we have\nnot supplied an <code dir=\"auto\">ignore_invalid_timeframe</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncall.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"tuples-of-intrabar-data\"><a href=\"#tuples-of-intrabar-data\">Tuples of intrabar data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When passing a tuple or a function call that returns a tuple as the\n<code dir=\"auto\">expression</code> argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>,\nthe result is a tuple of <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> with\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type templates</a> corresponding to the types within the argument. For example,\nusing a <code dir=\"auto\">[float, string, color]</code> tuple as the <code dir=\"auto\">expression</code> will result\nin <code dir=\"auto\">[array&lt;float&gt;, array&lt;string&gt;, array&lt;color&gt;]</code> data returned by the\nfunction. Using a tuple <code dir=\"auto\">expression</code> allows a script to fetch several\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> of intrabar data\nwith a single\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction call.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The combined size of all tuples returned by <code dir=\"auto\">request.*()</code> calls in a\nscript is limited to 127 elements. See\n<a href=\"/pine-script-docs/v5/writing/limitations/#tuple-element-limit\">this</a> section of the\n<a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for\nmore information.</p></div></aside>\n<p>The following example requests OHLC data from a lower timeframe and\nvisualizes the current bar\u2019s intrabars on the chart using\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">lines and boxes</a>. The\nscript calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nwith the <code dir=\"auto\">[open, high, low, close]</code> tuple as its <code dir=\"auto\">expression</code> to\nretrieve a tuple of <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>\nrepresenting OHLC information from a calculated <code dir=\"auto\">lowerTimeframe</code>. It\nthen uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nto set line coordinates with the retrieved data and current bar indices\nto display the results next to the current chart bar, providing a\n\u201cmagnified view\u201d of the price movement within the latest candle. It\nalso draws a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\naround the <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> to indicate the chart region occupied by intrabar drawings:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-lower-tf-Tuples-of-intrabar-data-1.C8-f9Sez_Z96QYf.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Tuples of intrabar data demo\", \"Candle magnifier\", max_lines_count = 500)\n\n//@variable The maximum number of intrabars to display.\nint maxIntrabars = input.int(20, \"Max intrabars\", 1, 250)\n//@variable The width of the drawn candle bodies.\nint candleWidth = input.int(20, \"Candle width\", 2)\n\n//@variable The largest valid timeframe closest to `maxIntrabars` times smaller than the chart timeframe.\nstring lowerTimeframe = timeframe.from_seconds(math.ceil(timeframe.in_seconds() / maxIntrabars))\n\n//@variable An array of lines to represent intrabar wicks.\nvar array&lt;line&gt; wicks  = array.new&lt;line&gt;()\n//@variable An array of lines to represent intrabar bodies.\nvar array&lt;line&gt; bodies = array.new&lt;line&gt;()\n//@variable A box that surrounds the displayed intrabars.\nvar box magnifierBox = box.new(na, na, na, na, bgcolor = na)\n\n// Fill the `wicks` and `bodies` arrays with blank lines on the first bar.\nif barstate.isfirst\n    for i = 1 to maxIntrabars\n        array.push(wicks, line.new(na, na, na, na, color = color.gray))\n        array.push(bodies, line.new(na, na, na, na, width = candleWidth))\n\n//@variable A tuple of \"float\" arrays containing `open`, `high`, `low`, and `close` prices from the `lowerTimeframe`.\n[oData, hData, lData, cData] = request.security_lower_tf(syminfo.tickerid, lowerTimeframe, [open, high, low, close])\n//@variable The number of intrabars retrieved from the `lowerTimeframe` on the chart bar.\nint numIntrabars = array.size(oData)\n\nif numIntrabars &gt; 0\n    // Define the start and end bar index values for intrabar display.\n    int startIndex = bar_index + 2\n    int endIndex = startIndex + numIntrabars\n    // Loop to update lines.\n    for i = 0 to maxIntrabars - 1\n        line wickLine = array.get(wicks, i)\n        line bodyLine = array.get(bodies, i)\n        if i &lt; numIntrabars\n            //@variable The `bar_index` of the drawing.\n            int candleIndex = startIndex + i\n            // Update the properties of the `wickLine` and `bodyLine`.\n            line.set_xy1(wickLine, startIndex + i, array.get(hData, i))\n            line.set_xy2(wickLine, startIndex + i, array.get(lData, i))\n            line.set_xy1(bodyLine, startIndex + i, array.get(oData, i))\n            line.set_xy2(bodyLine, startIndex + i, array.get(cData, i))\n            line.set_color(bodyLine, bodyLine.get_y2() &gt; bodyLine.get_y1() ? color.teal : color.maroon)\n            continue\n        // Set the coordinates of the `wickLine` and `bodyLine` to `na` if no intrabar data is available at the index.\n        line.set_xy1(wickLine, na, na)\n        line.set_xy2(wickLine, na, na)\n        line.set_xy1(bodyLine, na, na)\n        line.set_xy2(bodyLine, na, na)\n    // Set the coordinates of the `magnifierBox`.\n    box.set_lefttop(magnifierBox, startIndex - 1, array.max(hData))\n    box.set_rightbottom(magnifierBox, endIndex, array.min(lData))</div>\n<p>Note that:</p>\n<ul>\n<li>The script draws each candle using two\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>:\none to represent wicks and the other to represent the body.\nSince the script can display up to 500 lines on the chart,\nwe\u2019ve limited the <code dir=\"auto\">maxIntrabars</code> input to 250.</li>\n<li>The <code dir=\"auto\">lowerTimeframe</code> value is the result of calculating the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.ceil\">math.ceil()</a>\nof the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a>\ndivided by the <code dir=\"auto\">maxIntrabars</code> and converting to a\n<a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">valid timeframe string</a> with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a>.</li>\n<li>The script sets the top of the box drawing using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.max\">array.max()</a>\nof the requested <code dir=\"auto\">hData</code> array, and it sets the box\u2019s bottom\nusing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">array.min()</a>\nof the requested <code dir=\"auto\">lData</code> array. As we see on the chart, these\nvalues correspond to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nof the chart bar.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"requesting-collections\"><a href=\"#requesting-collections\">Requesting collections<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In some cases, a script may need to request the IDs of\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> from an intrabar context. However, unlike\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\none cannot pass\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> or calls to functions that return them as the <code dir=\"auto\">expression</code>\nargument in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncall, as <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> cannot\ndirectly reference other\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>.</p>\n<p>Despite these limitations, it is possible to request\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> from lower timeframes, if needed, with the help of <em>wrapper</em>\ntypes.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The use case described below is <strong>advanced</strong> and <strong>not</strong> recommended for\nbeginners. Before exploring this approach, we recommend understanding\nhow\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> and\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> work in Pine Script. When possible, we recommend using\n<em>simpler</em> methods to manage LTF requests, and only using this approach\nwhen <em>nothing else</em> will suffice.</p></div></aside>\n<p>To make\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> requestable with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>,\nwe must create a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\nwith a field to reference a collection ID. This step is necessary since\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> cannot reference\nother <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> directly but <em>can</em> reference UDTs with collection fields:</p>\n<div class=\"pine-colorizer not-content\">//@type A \"wrapper\" type to hold an `array&lt;float&gt;` instance.\ntype Wrapper\n    array&lt;float&gt; collection</div>\n<p>With our <code dir=\"auto\">Wrapper</code> UDT defined, we can now pass the IDs of\n<a href=\"/pine-script-docs/v5/language/objects/\">objects</a> of the UDT to the\n<code dir=\"auto\">expression</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>.</p>\n<p>A straightforward approach is to call the built-in <code dir=\"auto\">*.new()</code> function as\nthe <code dir=\"auto\">expression</code>. For example, this line of code calls <code dir=\"auto\">Wrapper.new()</code>\nwith\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from(close)</a>\nas its <code dir=\"auto\">collection</code> within\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>:</p>\n<div class=\"pine-colorizer not-content\">//@variable An array of `Wrapper` IDs requested from the 1-minute timeframe.\narray&lt;Wrapper&gt; wrappers = request.security_lower_tf(syminfo.tickerid, \"1\", Wrapper.new(array.from(close)))</div>\n<p>Alternatively, we can create a\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\nthat returns an <a href=\"/pine-script-docs/v5/language/objects/\">object</a> of\nthe <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a> and call that function within\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>.\nFor instance, this code calls a custom <code dir=\"auto\">newWrapper()</code> function that\nreturns a <code dir=\"auto\">Wrapper</code> ID as the <code dir=\"auto\">expression</code> argument:</p>\n<div class=\"pine-colorizer not-content\">//@function Creates a new `Wrapper` instance to wrap the specified `collection`.\nnewWrapper(array&lt;float&gt; collection) =&gt;\n    Wrapper.new(collection)\n\n//@variable An array of `Wrapper` IDs requested from the 1-minute timeframe.\narray&lt;Wrapper&gt; wrappers = request.security_lower_tf(syminfo.tickerid, \"1\", newWrapper(array.from(close)))</div>\n<p>The result with either of the above is an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining <code dir=\"auto\">Wrapper</code> IDs from all available intrabars in the chart bar,\nwhich the script can use to reference <code dir=\"auto\">Wrapper</code> instances from specific\nintrabars and use their <code dir=\"auto\">collection</code> fields in additional operations.</p>\n<p>The script below utilizes this approach to collect\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> of intrabar data\nfrom a <code dir=\"auto\">lowerTimeframe</code> and uses them to display data from a specific\nintrabar. Its custom <code dir=\"auto\">Prices</code> type contains a single <code dir=\"auto\">data</code> field to\nreference <code dir=\"auto\">array&lt;float&gt;</code> instances that hold price data, and the\nuser-defined <code dir=\"auto\">newPrices()</code> function returns the ID of a <code dir=\"auto\">Prices</code> object.</p>\n<p>The script calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nwith a <code dir=\"auto\">newPrices()</code> call as its <code dir=\"auto\">expression</code> argument to retrieve an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof <code dir=\"auto\">Prices</code> IDs from each intrabar in the chart bar, then uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a>\nto get the ID from a specified available intrabar, if it exists. Lastly,\nit uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a>\non the <code dir=\"auto\">data</code> array assigned to that instance and calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\nto display its values on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-security-lower-tf-Requesting-collections-1.D61W65Jj_gcc0V.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting LTF collections demo\", \"Intrabar viewer\", true)\n\n//@variable The timeframe of the LTF data request.\nstring lowerTimeframe = input.timeframe(\"1\", \"Timeframe\")\n//@variable The index of the intrabar to show on each chart bar. 0 is the first available intrabar.\nint intrabarIndex = input.int(0, \"Intrabar to show\", 0)\n\n//@variable A custom type to hold an array of price `data`.\ntype Prices\n    array&lt;float&gt; data\n\n//@function Returns a new `Prices` instance containing current `open`, `high`, `low`, and `close` prices.\nnewPrices() =&gt;\n    Prices.new(array.from(open, high, low, close))\n\n//@variable An array of `Prices` requested from the `lowerTimeframe`.\narray&lt;Prices&gt; requestedPrices = request.security_lower_tf(syminfo.tickerid, lowerTimeframe, newPrices())\n\n//@variable The `Prices` ID from the `requestedPrices` array at the `intrabarIndex`, or `na` if not available.\nPrices intrabarPrices = array.size(requestedPrices) &gt; intrabarIndex ? array.get(requestedPrices, intrabarIndex) : na\n//@variable The `data` array from the `intrabarPrices`, or an array of `na` values if `intrabarPrices` is `na`.\narray&lt;float&gt; intrabarData = na(intrabarPrices) ? array.new&lt;float&gt;(4, na) : intrabarPrices.data\n\n// Plot the `intrabarData` values as candles.\nplotcandle(intrabarData.get(0), intrabarData.get(1), intrabarData.get(2), intrabarData.get(3))</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">intrabarPrices</code> variable only references a <code dir=\"auto\">Prices</code> ID if\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a>\nof the <code dir=\"auto\">requestedPrices</code> array is greater than the\n<code dir=\"auto\">intrabarIndex</code>, as attempting to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a>\nto get an element that doesn\u2019t exist will result in an\n<a href=\"/pine-script-docs/v5/language/arrays/#index-xx-is-out-of-bounds-array-size-is-yy\">out of bounds error</a>.</li>\n<li>The <code dir=\"auto\">intrabarData</code> variable only references the <code dir=\"auto\">data</code> field\nfrom <code dir=\"auto\">intrabarPrices</code> if a valid <code dir=\"auto\">Prices</code> ID exists since a\nscript cannot reference fields of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalue.</li>\n<li>The process used in this example is <em>not</em> necessary to achieve\nthe intended result. We could instead avoid using\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a> and pass an <code dir=\"auto\">[open, high, low, close]</code> tuple to the\n<code dir=\"auto\">expression</code> parameter to retrieve a tuple of\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> for further\noperations, as explained in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples-of-intrabar-data\">previous section</a>.</li>\n</ul>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"custom-contexts\"><a href=\"#custom-contexts\">Custom contexts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script includes multiple <code dir=\"auto\">ticker.*()</code> functions that allow scripts\nto construct <em>custom</em> ticker IDs that specify additional settings for\ndata requests when used as a <code dir=\"auto\">symbol</code> argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.new\">ticker.new()</a>\nconstructs a custom ticker ID from a specified <code dir=\"auto\">prefix</code> and <code dir=\"auto\">ticker</code>\nwith additional <code dir=\"auto\">session</code> and <code dir=\"auto\">adjustment</code> settings.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.modify\">ticker.modify()</a>\nconstructs a modified form of a specified <code dir=\"auto\">tickerid</code> with additional\n<code dir=\"auto\">session</code> and <code dir=\"auto\">adjustment</code> settings.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.heikinashi\">ticker.heikinashi()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.renko\">ticker.renko()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.pointfigure\">ticker.pointfigure()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.kagi\">ticker.kagi()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.linebreak\">ticker.linebreak()</a>\nconstruct a modified form a <code dir=\"auto\">symbol</code> with\n<a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard chart</a> settings.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.inherit\">ticker.inherit()</a>\nconstructs a new ticker ID for a <code dir=\"auto\">symbol</code> with additional parameters\ninherited from the <code dir=\"auto\">from_tickerid</code> specified in the function call,\nallowing scripts to request the <code dir=\"auto\">symbol</code> data with the same\nmodifiers as the <code dir=\"auto\">from_tickerid</code>, including session, dividend\nadjustment, currency conversion, non-standard chart type,\nback-adjustment, settlement-as-close, etc.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.standard\">ticker.standard()</a>\nconstructs a standard ticker ID representing the <code dir=\"auto\">symbol</code> <em>without</em>\nadditional modifiers.</li>\n</ul>\n<p>Let\u2019s explore some practical examples of applying <code dir=\"auto\">ticker.*()</code>\nfunctions to request data from custom contexts.</p>\n<p>Suppose we want to include dividend adjustment in a stock symbol\u2019s\nprices without enabling the \u201cAdjust data for dividends\u201d option in the\n\u201cSymbol\u201d section of the chart\u2019s settings. We can achieve this in a\nscript by constructing a custom ticker ID for the instrument using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.new\">ticker.new()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.modify\">ticker.modify()</a>\nwith an <code dir=\"auto\">adjustment</code> value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_adjustment.dividends\">adjustment.dividends</a>.</p>\n<p>This script creates an <code dir=\"auto\">adjustedTickerID</code> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.modify\">ticker.modify()</a>,\nuses that ticker ID as the <code dir=\"auto\">symbol</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve a\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">tuple</a> of adjusted price values, then plots the result as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">candles</a>\non the chart. It also highlights the background when the requested\nprices differ from the prices without dividend adjustment.</p>\n<p>As we see on the \u201cNYSE:XOM\u201d chart below, enabling dividend adjustment\nresults in different historical values before the date of the latest\ndividend:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"574\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Custom-contexts-1.BPiSCB0G_ZpUr3u.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Custom contexts demo 1\", \"Adjusted prices\", true)\n\n//@variable A custom ticker ID representing the chart's symbol with the dividend adjustment modifier.\nstring adjustedTickerID = ticker.modify(syminfo.tickerid, adjustment = adjustment.dividends)\n\n// Request the adjusted prices for the chart's symbol.\n[o, h, l, c] = request.security(adjustedTickerID, timeframe.period, [open, high, low, close])\n\n//@variable The color of the candles on the chart.\ncolor candleColor = c &gt; o ? color.teal : color.maroon\n\n// Plot the adjusted prices.\nplotcandle(o, h, l, c, \"Adjusted Prices\", candleColor)\n// Highlight the background when `c` is different from `close`.\nbgcolor(c != close ? color.new(color.orange, 80) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>If a modifier included in a constructed ticker ID does not apply\nto the symbol, the script will <em>ignore</em> that modifier when\nrequesting data. For instance, this script will display the same\nvalues as the main chart on forex symbols such as \u201cEURUSD\u201d.</li>\n</ul>\n<p>While the example above demonstrates a simple way to modify the chart\u2019s\nsymbol, a more frequent use case for <code dir=\"auto\">ticker.*()</code> functions is applying\ncustom modifiers to another symbol while requesting data. If a ticker ID\nreferenced in a script already has the modifiers one would like to apply\n(e.g., adjustment settings, session type, etc.), they can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.inherit\">ticker.inherit()</a>\nto quickly and efficiently add those modifiers to another symbol.</p>\n<p>In the example below, we\u2019ve edited the previous script to request data\nfor a <code dir=\"auto\">symbolInput</code> using modifiers inherited from the\n<code dir=\"auto\">adjustedTickerID</code>. This script calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.inherit\">ticker.inherit()</a>\nto construct an <code dir=\"auto\">inheritedTickerID</code> and uses that ticker ID in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall. It also requests data for the <code dir=\"auto\">symbolInput</code> without additional\nmodifiers and plots\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">candles</a>\nfor both ticker IDs in a separate chart pane to compare the difference.</p>\n<p>As shown on the chart, the data requested using the <code dir=\"auto\">inheritedTickerID</code>\nincludes dividend adjustment, whereas the data requested using the\n<code dir=\"auto\">symbolInput</code> directly does not:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"574\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Custom-contexts-2.DR5Qn5x1_Z1F3irE.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Custom contexts demo 2\", \"Inherited adjustment\")\n\n//@variable The symbol to request data from.\nstring symbolInput = input.symbol(\"NYSE:PFE\", \"Symbol\")\n\n//@variable A custom ticker ID representing the chart's symbol with the dividend adjustment modifier.\nstring adjustedTickerID = ticker.modify(syminfo.tickerid, adjustment = adjustment.dividends)\n//@variable A custom ticker ID representing the `symbolInput` with modifiers inherited from the `adjustedTickerID`.\nstring inheritedTickerID = ticker.inherit(adjustedTickerID, symbolInput)\n\n// Request prices using the `symbolInput`.\n[o1, h1, l1, c1] = request.security(symbolInput, timeframe.period, [open, high, low, close])\n// Request prices using the `inheritedTickerID`.\n[o2, h2, l2, c2] = request.security(inheritedTickerID, timeframe.period, [open, high, low, close])\n\n//@variable The color of the candles that use the `inheritedTickerID` prices.\ncolor candleColor = c2 &gt; o2 ? color.teal : color.maroon\n\n// Plot the `symbol` prices.\nplotcandle(o1, h1, l1, c1, \"Symbol\", color.gray, color.gray, bordercolor = color.gray)\n// Plot the `inheritedTickerID` prices.\nplotcandle(o2, h2, l2, c2, \"Symbol With Modifiers\", candleColor)\n// Highlight the background when `c1` is different from `c2`.\nbgcolor(c1 != c2 ? color.new(color.orange, 80) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>Since the <code dir=\"auto\">adjustedTickerID</code> represents a modified form of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>,\nif we modify the chart\u2019s context in other ways, such as\nchanging the chart type or enabling extended trading hours in\nthe chart\u2019s settings, those modifiers will also apply to the\n<code dir=\"auto\">adjustedTickerID</code> and <code dir=\"auto\">inheritedTickerID</code>. However, they will\n<em>not</em> apply to the <code dir=\"auto\">symbolInput</code> since it represents a\n<em>standard</em> ticker ID.</li>\n</ul>\n<p>Another frequent use case for requesting custom contexts is retrieving\ndata that uses\n<a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard chart</a> calculations. For example, suppose we want to use\n<a href=\"https://www.tradingview.com/support/solutions/43000502284-renko-charts/\">Renko</a>\nprice values to calculate trade signals in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nscript. If we simply change the chart type to \u201cRenko\u201d to get the\nprices, the <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategy</a>\nwill also simulate its trades based on those synthetic prices, producing\n<a href=\"https://www.tradingview.com/support/solutions/43000481029/\">misleading\nresults</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"656\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Custom-contexts-3.Fi6i41m5_Z15B7Id.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Custom contexts demo 3\", \"Renko strategy\", true, default_qty_type = strategy.percent_of_equity,\n     default_qty_value = 2, initial_capital = 50000, slippage = 2,\n     commission_type = strategy.commission.cash_per_contract, commission_value = 1, margin_long = 100,\n     margin_short = 100\n )\n\n//@variable When `true`, the strategy places a long market order.\nbool longEntry = ta.crossover(close, open)\n//@variable When `true`, the strategy places a short market order.\nbool shortEntry = ta.crossunder(close, open)\n\nif longEntry\n    strategy.entry(\"Long Entry\", strategy.long)\nif shortEntry\n    strategy.entry(\"Short Entry\", strategy.short)</div>\n<p>To ensure our strategy shows results based on <em>actual</em> prices, we can\ncreate a Renko ticker ID using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.renko\">ticker.renko()</a>\nwhile keeping the chart on a <em>standard type</em>, allowing the script to\nrequest and use\n<a href=\"https://www.tradingview.com/support/solutions/43000502284-renko-charts/\">Renko</a>\nprices to calculate its signals without calculating the strategy results\non them:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"634\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Custom-contexts-4.DB0_6eO1_Z2gBlFY.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Custom contexts demo 3\", \"Renko strategy\", true, default_qty_type = strategy.percent_of_equity,\n     default_qty_value = 2, initial_capital = 50000, slippage = 1,\n     commission_type = strategy.commission.cash_per_contract, commission_value = 1, margin_long = 100,\n     margin_short = 100\n )\n\n//@variable A Renko ticker ID.\nstring renkoTickerID = ticker.renko(syminfo.tickerid, \"ATR\", 14)\n// Request the `open` and `close` prices using the `renkoTickerID`.\n[renkoOpen, renkoClose] = request.security(renkoTickerID, timeframe.period, [open, close])\n\n//@variable When `true`, the strategy places a long market order.\nbool longEntry = ta.crossover(renkoClose, renkoOpen)\n//@variable When `true`, the strategy places a short market order.\nbool shortEntry = ta.crossunder(renkoClose, renkoOpen)\n\nif longEntry\n    strategy.entry(\"Long Entry\", strategy.long)\nif shortEntry\n    strategy.entry(\"Short Entry\", strategy.short)\n\nplot(renkoOpen)\nplot(renkoClose)</div>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"historical-and-realtime-behavior\"><a href=\"#historical-and-realtime-behavior\">Historical and realtime behavior<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Functions in the <code dir=\"auto\">request.*()</code> namespace can behave differently on\nhistorical and realtime bars. This behavior is closely related to\nPine\u2019s <a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>.</p>\n<p>Consider how a script behaves within the main context. Throughout the\nchart\u2019s history, the script calculates its required values once and\n<em>commits</em> them to that bar so their states are accessible on subsequent executions.\nOn an unconfirmed bar, however, the script recalculates its\nvalues on <em>each update</em> to the bar\u2019s data to align with realtime\nchanges. Before recalculating the values on that bar, it reverts\ncalculated values to their last committed states, otherwise known as\n<em>rollback</em>, and it only commits values to that bar once the bar closes.</p>\n<p>Now consider the behavior of data requests from other contexts with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.\nAs when evaluating historical bars in the main context,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nonly returns new historical values when it confirms a bar in its\nspecified context. When executing on realtime bars, it returns\nrecalculated values on each chart bar, similar to how a script\nrecalculates values in the main context on the open chart bar.</p>\n<p>However, the function only <em>confirms</em> the requested values when a bar\nfrom its context closes. When the script restarts, what\nwere previously <em>realtime</em> bars become <em>historical</em> bars.\nTherefore,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nonly returns the values it confirmed on those bars. In essence, this\nbehavior means that requested data may <em>repaint</em> when its values\nfluctuate on realtime bars without confirmation from the context.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>It\u2019s often helpful to distinguish historical bars from realtime bars\nwhen working with <code dir=\"auto\">request.*()</code> functions. Scripts can determine whether\nbars have historical or realtime states via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.ishistory\">barstate.ishistory</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">barstate.isrealtime</a>\nvariables.</p></div></aside>\n<p>In most circumstances where a script requests data from a broader\ncontext, one will typically require confirmed, stable values that <em>do\nnot</em> fluctuate on realtime bars. The\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">section below</a> explains how to achieve such a result and avoid repainting\ndata requests.</p>\n<h3 class=\"md-heading\" id=\"avoiding-repainting\"><a href=\"#avoiding-repainting\">Avoiding Repainting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"higher-timeframe-data\"><a href=\"#higher-timeframe-data\">Higher-timeframe data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When requesting values from a higher timeframe, they are subject to\nrepainting since realtime bars can contain <em>unconfirmed</em> information\nfrom developing HTF bars, and the script may adjust the times that new\nvalues come in on historical bars. To avoid repainting HTF data, one\nmust ensure that the function only returns confirmed values with\nconsistent timing on all bars, regardless of bar state.</p>\n<p>The most reliable approach to achieve non-repainting results is to use\nan <code dir=\"auto\">expression</code> argument that only references past bars (e.g.,\n<code dir=\"auto\">close[1]</code>) while using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nas the <code dir=\"auto\">lookahead</code> value.</p>\n<p>Using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nwith non-offset HTF data requests is discouraged since it prompts\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto \u201clook ahead\u201d to the final values of an HTF bar, retrieving\nconfirmed values <em>before</em> they\u2019re actually available in the script\u2019s\nhistory. However, if the values used in the <code dir=\"auto\">expression</code> are offset by\nat least one bar, the \u201cfuture\u201d data the function retrieves is no\nlonger from the future. Instead, the data represents confirmed values\nfrom established, <em>available</em> HTF bars. In other words, applying an\noffset to the <code dir=\"auto\">expression</code> effectively prevents the requested data from\nrepainting when the script restarts its executions and eliminates\nlookahead bias in the historical series.</p>\n<p>The following example demonstrates a repainting HTF data request. The\nscript uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwithout offset modifications or additional arguments to retrieve the\nresults of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.wma\">ta.wma()</a>\ncall from a higher timeframe. It also highlights the background to\nindicate which bars were in a realtime state during its calculations.</p>\n<p>As shown on the chart below, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a>\nof the requested WMA only changes on historical bars when HTF bars\nclose, whereas it fluctuates on all realtime bars since the data\nincludes unconfirmed values from the higher timeframe:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Historical-and-realtime-behavior-Avoiding-repainting-Higher-timeframe-data-1.BaZM3HDu_2k78Ln.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Avoiding HTF repainting demo\", overlay = true)\n\n//@variable The multiplier applied to the chart's timeframe.\nint tfMultiplier = input.int(10, \"Timeframe multiplier\", 1)\n//@variable The number of bars in the moving average.\nint length = input.int(5, \"WMA smoothing length\")\n\n//@variable The valid timeframe string closest to `tfMultiplier` times larger than the chart timeframe.\nstring timeframe = timeframe.from_seconds(timeframe.in_seconds() * tfMultiplier)\n\n//@variable The weighted MA of `close` prices over `length` bars on the `timeframe`.\n//          This request repaints because it includes unconfirmed HTF data on realtime bars and it may offset the\n//          times of its historical results.\nfloat requestedWMA = request.security(syminfo.tickerid, timeframe, ta.wma(close, length))\n\n// Plot the requested series.\nplot(requestedWMA, \"HTF WMA\", color.purple, 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 70) : na, title = \"Realtime bar highlight\")</div>\n<p>To avoid repainting in this script, we can add\n<code dir=\"auto\">lookahead = barmerge.lookahead_on</code> to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall and offset the call history of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.wma\">ta.wma()</a>\nby one bar with the history-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>,\nensuring the request always retrieves the last confirmed HTF bar\u2019s WMA\nat the start of each new <code dir=\"auto\">timeframe</code>. Unlike the previous script, this\nversion has consistent behavior on historical and realtime bar states,\nas we see below:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Historical-and-realtime-behavior-Avoiding-repainting-Higher-timeframe-data-2.DgoLhl8Y_1sHSHG.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Avoiding HTF repainting demo\", overlay = true)\n\n//@variable The multiplier applied to the chart's timeframe.\nint tfMultiplier = input.int(10, \"Timeframe multiplier\", 1)\n//@variable The number of bars in the moving average.\nint length = input.int(5, \"WMA smoothing length\")\n\n//@variable The valid timeframe string closest to `tfMultiplier` times larger than the chart timeframe.\nstring timeframe = timeframe.from_seconds(timeframe.in_seconds() * tfMultiplier)\n\n//@variable The weighted MA of `close` prices over `length` bars on the `timeframe`.\n//          This request does not repaint, as it always references the last confirmed WMA value on all bars.\nfloat requestedWMA = request.security(\n     syminfo.tickerid, timeframe, ta.wma(close, length)[1], lookahead = barmerge.lookahead_on\n )\n\n// Plot the requested value.\nplot(requestedWMA, \"HTF WMA\", color.purple, 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 70) : na, title = \"Realtime bar highlight\")</div>\n<h4 class=\"md-heading\" id=\"lower-timeframe-data\"><a href=\"#lower-timeframe-data\">Lower-timeframe data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunctions can retrieve data from lower-timeframe contexts. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction can only retrieve data from a <em>single</em> intrabar in each chart\nbar, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nretrieves data from <em>all</em> available intrabars.</p>\n<p>When using these functions to retrieve intrabar data, it\u2019s important to\nnote that such requests are <strong>not</strong> immune to repainting behavior.\nHistorical and realtime series often rely on <em>separate</em> data feeds. Data\nproviders may retroactively modify realtime data, and it\u2019s possible for\nraces to occur in realtime data feeds, as explained in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#data-feeds\">Data feeds</a> section of this page. Either case may result in intrabar\ndata retrieved on realtime bars repainting after the script restarts its\nexecutions.</p>\n<p>Additionally, a particular case that <em>will</em> cause repainting LTF\nrequests is using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwith\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nto retrieve data from the first intrabar in each chart bar. While it\nwill generally work as expected on historical bars, it will track only\nthe most recent intrabar on realtime bars, as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ndoes not retain all intrabar information, and the intrabars the function retrieves on realtime bars are unsorted until restarting the\nscript:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Historical-and-realtime-behavior-Avoiding-repainting-Lower-timeframe-data-1.CBTFrSjr_3y4ey.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Avoiding LTF repainting demo\", overlay = true)\n\n//@variable The lower timeframe of the requested data.\nstring lowerTimeframe = input.timeframe(\"1\", \"Timeframe\")\n\n//@variable The first intrabar `close` requested from the `lowerTimeframe` on each bar.\n//          Only works as intended on historical bars.\nfloat requestedClose = request.security(syminfo.tickerid, lowerTimeframe, close, lookahead = barmerge.lookahead_on)\n\n// Plot the `requestedClose`.\nplot(requestedClose, \"First intrabar close\", linewidth = 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 60) : na, title = \"Realtime bar Highlight\")</div>\n<p>One can mitigate this behavior and track the values from the first\nintrabar, or any available intrabar in the chart bar, by using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nsince it maintains an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof intrabar values ordered by the times they come in. Here, we call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.first\">array.first()</a>\non a requested\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof intrabar data to retrieve the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice from the first available intrabar in each chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Historical-and-realtime-behavior-Avoiding-repainting-Lower-timeframe-data-2.6WrbL0Kk_wVrfM.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Avoiding LTF repainting demo\", overlay = true)\n\n//@variable The lower timeframe of the requested data.\nstring lowerTimeframe = input.timeframe(\"1\", \"Timeframe\")\n\n//@variable An array of intrabar `close` values requested from the `lowerTimeframe` on each bar.\narray&lt;float&gt; requestedCloses = request.security_lower_tf(syminfo.tickerid, lowerTimeframe, close)\n\n//@variable The first intrabar `close` on each bar with available data.\nfloat firstClose = requestedCloses.size() &gt; 0 ? requestedCloses.first() : na\n\n// Plot the `firstClose`.\nplot(firstClose, \"First intrabar close\", linewidth = 3)\n// Highlight the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 60) : na, title = \"Realtime bar Highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>While\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nis more optimized for handling historical and realtime\nintrabars, it\u2019s still possible in some cases for minor\nrepainting to occur due to data differences from the provider,\nas outlined above.</li>\n<li>This code may not show intrabar data on all available chart\nbars, depending on how many intrabars each chart bar contains,\nas <code dir=\"auto\">request.*()</code> functions can retrieve up to 100,000 intrabars\nfrom an LTF context. See\n<a href=\"/pine-script-docs/v5/writing/limitations/#request-calls\">this</a> section of the\n<a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a>\npage for more information.</li>\n</ul>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestcurrency_rate\"><a href=\"#requestcurrency_rate\"><span>\u200b<code dir=\"auto\">request.currency_rate()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When a script needs to convert values expressed in one currency to\nanother, one can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a>.\nThis function requests a <em>daily rate</em> for currency conversion\ncalculations based on currency pair or <a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spread</a> data from the most popular exchanges, providing a simpler alternative\nto fetching specific pairs or\n<a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spreads</a>\nwith\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.</p>\n<p>While one can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve daily currency rates, its use case is more involved than\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a>,\nas one needs to supply a valid <em>ticker ID</em> for a currency pair or spread\nto request the rate. Additionally, a historical offset and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nare necessary to prevent the results from repainting, as explained in\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">this section</a>.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a>\nfunction, on the other hand, only requires <em>currency codes</em>. No ticker\nID is needed when requesting rates with this function, and it ensures\nnon-repainting results without requiring additional specification.</p>\n<p>The function\u2019s signature is as follows:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.currency_rate(from, to, ignore_invalid_currency) \u2192 series float</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">from</code> parameter specifies the currency to convert, and the <code dir=\"auto\">to</code>\nparameter specifies the target currency. Both parameters accept\n\u201cstring\u201d values representing valid currency codes (e.g.,\n\u201cUSD\u201d) or any built-in <code dir=\"auto\">currency.*</code> variable (e.g.,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_currency.USD\">currency.USD</a>).</p>\n<p>When the function cannot calculate a valid conversion rate between the specified\n<code dir=\"auto\">from</code> and <code dir=\"auto\">to</code> currencies, programmers can decide whether\nit raises a runtime error or returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> via\nthe <code dir=\"auto\">ignore_invalid_currency</code> parameter. The default value is <code dir=\"auto\">false</code>,\nmeaning the function raises a runtime error and halts the script\u2019s\nexecutions.</p>\n<p>The following example demonstrates a simple use case for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a>.\nSuppose we want to convert values expressed in Turkish lira\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_currency.TRY\">currency.TRY</a>)\nto South Korean won\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_currency.KRW\">currency.KRW</a>)\nusing a daily conversion rate. If we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto retrieve the rate, we must supply a valid ticker ID and request the\nlast confirmed\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nfrom the previous day.</p>\n<p>In this case, no valid symbol exists that would allow us to\nretrieve a conversion rate directly with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.\nTherefore, we first need a ticker ID for a\n<a href=\"https://www.tradingview.com/support/solutions/43000502298/\">spread</a>\nthat converts TRY to an intermediate currency, such as USD, then\nconverts the intermediate currency to KRW. We can then use that ticker\nID within\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwith <code dir=\"auto\">close[1]</code> as the <code dir=\"auto\">expression</code> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nas the <code dir=\"auto\">lookahead</code> value to request a non-repainting daily rate.</p>\n<p>Alternatively, we can achieve the same result more simply by calling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a>.\nThis function does all the heavy lifting for us, only requiring <code dir=\"auto\">from</code>\nand <code dir=\"auto\">to</code> currency arguments to perform its calculation.</p>\n<p>As we see below, both approaches return the same daily rate:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-currency-rate-1.C1rKgV4h_1dBAP1.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting currency rates demo\")\n\n//@variable The currency to convert.\nsimple string fromCurrency = currency.TRY\n//@variable The resulting currency.\nsimple string toCurrency = currency.KRW\n\n//@variable The spread symbol to request. Required in `request.security()` because no direct symbol exists.\nsimple string spreadSymbol = str.format(\"{0}{2} * {2}{1}\", fromCurrency, toCurrency, currency.USD)\n\n//@variable The non-repainting conversion rate from `request.security()` using the `spreadSymbol`.\nfloat securityRequestedRate = request.security(spreadSymbol, \"1D\", close[1], lookahead = barmerge.lookahead_on)\n//@variable The non-repainting conversion rate from `request.currency_rate()`.\nfloat nonSecurityRequestedRate = request.currency_rate(fromCurrency, toCurrency)\n\n// Plot the requested rates. We can multiply TRY values by these rates to convert them to KRW.\nplot(securityRequestedRate, \"`request.security()` value\", color.purple, 5)\nplot(nonSecurityRequestedRate, \"`request.currency_rate()` value\", color.yellow, 2)</div>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestdividends-requestsplits-and-requestearnings\"><a href=\"#requestdividends-requestsplits-and-requestearnings\"><span>\u200b<code dir=\"auto\">request.dividends()</code>\u200b, \u200b<code dir=\"auto\">request.splits()</code>\u200b, and \u200b<code dir=\"auto\">request.earnings()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Analyzing a stock\u2019s earnings data and corporate actions provides\nhelpful insights into its underlying financial strength. Pine Script\nprovides the ability to retrieve essential information about applicable\nstocks via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a>.</p>\n<p>These are the functions\u2019 signatures:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.dividends(ticker, field, gaps, lookahead, ignore_invalid_symbol, currency) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.splits(ticker, field, gaps, lookahead, ignore_invalid_symbol) \u2192 series float</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.earnings(ticker, field, gaps, lookahead, ignore_invalid_symbol, currency) \u2192 series float</span></div></div></code></pre></figure></div>\n<p>Each function has the same parameters in its signature, with the\nexception of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>,\nwhich doesn\u2019t have a <code dir=\"auto\">currency</code> parameter.</p>\n<p>Note that unlike the <code dir=\"auto\">symbol</code> parameter in other <code dir=\"auto\">request.*()</code>\nfunctions, the <code dir=\"auto\">ticker</code> parameter in these functions only accepts an\n<em>\u201cExchange:Symbol\u201d pair</em>, such as \u201cNASDAQ:AAPL\u201d. The built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.ticker\">syminfo.ticker</a>\nvariable does not work with these functions since it does not contain\nexchange information. Instead, one must use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>\nfor such cases.</p>\n<p>The <code dir=\"auto\">field</code> parameter determines the data the function will retrieve.\nEach of these functions accepts different built-in variables as the\n<code dir=\"auto\">field</code> argument since each requests different information about a\nstock:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a>\nfunction retrieves current dividend information for a stock, i.e.,\nthe amount per share the issuing company paid out to investors who\npurchased shares before the ex-dividend date. Passing the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dividends.gross\">dividends.gross</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dividends.net\">dividends.net</a>\nvariables to the <code dir=\"auto\">field</code> parameter specifies whether the returned\nvalue represents dividends before or after factoring in expenses the\ncompany deducts from its payouts.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>\nfunction retrieves current split and reverse split information for a\nstock. A split occurs when a company increases its outstanding\nshares to promote liquidity. A reverse split occurs when a company\nconsolidates its shares and offers them at a higher price to attract\nspecific investors or maintain their listing on a market that has a\nminimum per-share price. Companies express their split information\nas <em>ratios</em>. For example, a 5:1 split means the company issued\nadditional shares to its shareholders so that they have five times\nthe number of shares they had before the split, and the raw price of\neach share becomes one-fifth of the previous price. Passing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_splits.numerator\">splits.numerator</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_splits.denominator\">splits.denominator</a>\nto the <code dir=\"auto\">field</code> parameter of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>\ndetermines whether it returns the numerator or denominator of the\nsplit ratio.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a>\nfunction retrieves the earnings per share (EPS) information for a\nstock <code dir=\"auto\">ticker</code>\u2019s issuing company. The EPS value is the ratio of a\ncompany\u2019s net income to the number of outstanding stock shares,\nwhich investors consider an indicator of the company\u2019s\nprofitability. Passing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_earnings.actual\">earnings.actual</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_earnings.estimate\">earnings.estimate</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_earnings.standardized\">earnings.standardized</a>\nas the <code dir=\"auto\">field</code> argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a>\nrespectively determines whether the function requests the actual,\nestimated, or standardized EPS value.</li>\n</ul>\n<p>For a detailed explanation of the <code dir=\"auto\">gaps</code>, <code dir=\"auto\">lookahead</code>, and\n<code dir=\"auto\">ignore_invalid_symbol</code> parameters of these functions, see the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#common-characteristics\">Common characteristics</a> section at the top of this page.</p>\n<p>It\u2019s important to note that the values returned by these functions\nreflect the data available as it comes in. This behavior differs from\nfinancial data originating from a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\ncall in that the underlying data from such calls becomes available\naccording to a company\u2019s fiscal reporting period.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Scripts can also retrieve information about upcoming earnings and\ndividends for an instrument via the <code dir=\"auto\">earnings.future_*</code> and\n<code dir=\"auto\">dividends.future_*</code> built-in variables.</p></div></aside>\n<p>Here, we\u2019ve included an example that displays a handy\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\ncontaining the most recent dividend, split, and EPS data. The script\ncalls the <code dir=\"auto\">request.*()</code> functions discussed in this section to retrieve\nthe data, then converts the values to \u201cstrings\u201d with <code dir=\"auto\">str.*()</code>\nfunctions and displays the results in the <code dir=\"auto\">infoTable</code> with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.cell\">table.cell()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"560\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-dividends-request-splits-and-request-earnings-1.DVVI7Tee_yVHYk.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Dividends, splits, and earnings demo\", overlay = true)\n\n//@variable The size of the table's text.\nstring tableSize = input.string(\n     size.large, \"Table size\", [size.auto, size.tiny, size.small, size.normal, size.large, size.huge]\n )\n\n//@variable The color of the table's text and frame.\nvar color tableColor = chart.fg_color\n//@variable A `table` displaying the latest dividend, split, and EPS information.\nvar table infoTable = table.new(position.top_right, 3, 4, frame_color = tableColor, frame_width = 1)\n\n// Add header cells on the first bar.\nif barstate.isfirst\n    table.cell(infoTable, 0, 0, \"Field\", text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 1, 0, \"Value\", text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 2, 0, \"Date\", text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 0, 1, \"Dividend\", text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 0, 2, \"Split\", text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 0, 3, \"EPS\", text_color = tableColor, text_size = tableSize)\n\n//@variable The amount of the last reported dividend as of the current bar.\nfloat latestDividend = request.dividends(syminfo.tickerid, dividends.gross, barmerge.gaps_on)\n//@variable The numerator of that last reported split ratio as of the current bar.\nfloat latestSplitNum = request.splits(syminfo.tickerid, splits.numerator, barmerge.gaps_on)\n//@variable The denominator of the last reported split ratio as of the current bar.\nfloat latestSplitDen = request.splits(syminfo.tickerid, splits.denominator, barmerge.gaps_on)\n//@variable The last reported earnings per share as of the current bar.\nfloat latestEPS = request.earnings(syminfo.tickerid, earnings.actual, barmerge.gaps_on)\n\n// Update the \"Value\" and \"Date\" columns when new values come in.\nif not na(latestDividend)\n    table.cell(\n         infoTable, 1, 1, str.tostring(math.round(latestDividend, 3)), text_color = tableColor, text_size = tableSize\n     )\n    table.cell(infoTable, 2, 1, str.format_time(time, \"yyyy-MM-dd\"), text_color = tableColor, text_size = tableSize)\nif not na(latestSplitNum)\n    table.cell(\n         infoTable, 1, 2, str.format(\"{0}-for-{1}\", latestSplitNum, latestSplitDen), text_color = tableColor,\n         text_size = tableSize\n     )\n    table.cell(infoTable, 2, 2, str.format_time(time, \"yyyy-MM-dd\"), text_color = tableColor, text_size = tableSize)\nif not na(latestEPS)\n    table.cell(infoTable, 1, 3, str.tostring(latestEPS), text_color = tableColor, text_size = tableSize)\n    table.cell(infoTable, 2, 3, str.format_time(time, \"yyyy-MM-dd\"), text_color = tableColor, text_size = tableSize)</div>\n<p>Note that:</p>\n<ul>\n<li>We\u2019ve included\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_on\">barmerge.gaps_on</a>\nin the <code dir=\"auto\">request.*()</code> calls, so they only return values when new\ndata is available. Otherwise, they return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</li>\n<li>The script assigns a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nID to the <code dir=\"auto\">infoTable</code> variable on the first chart bar. On\nsubsequent bars, it updates necessary cells with new information\nwhenever data is available.</li>\n<li>If no information is available from any of the <code dir=\"auto\">request.*()</code>\ncalls throughout the chart\u2019s history (e.g., if the <code dir=\"auto\">ticker</code> has\nno dividend information), the script does not initialize the\ncorresponding cells since it\u2019s unnecessary.</li>\n</ul>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestquandl\"><a href=\"#requestquandl\"><span>\u200b<code dir=\"auto\">request.quandl()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView forms partnerships with many fintech companies to provide\nusers access to extensive information on financial instruments, economic\ndata, and more. One of our many partners is <a href=\"https://data.nasdaq.com/\" rel=\"nofollow\">Nasdaq Data\nLink</a> (formerly Quandl), which provides\nmultiple <em>external</em> data feeds that scripts can access via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.quandl\">request.quandl()</a>\nfunction.</p>\n<p>Here is the function\u2019s signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.quandl(ticker, gaps, index, ignore_invalid_symbol) \u2192 series float</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">ticker</code> parameter accepts a \u201cstring\u201d value representing the ID\nof the database published on Nasdaq Data Link and its time series code,\nseparated by the \u201d/\u201d delimiter. For example, the code \u201cFRED/DFF\u201d\nrepresents the \u201cEffective Federal Funds Rate\u201d time series from the\n\u201cFederal Reserve Economic Data\u201d database.</p>\n<p>The <code dir=\"auto\">index</code> parameter accepts an \u201cint\u201d value representing the <em>column\nindex</em> of the requested data, where 0 is the first available column.\nConsult the database\u2019s documentaion on Nasdaq Data Link\u2019s website to\nsee available columns.</p>\n<p>For details on the <code dir=\"auto\">gaps</code> and <code dir=\"auto\">ignore_invalid_symbol</code> parameters, see\nthe\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#common-characteristics\">Common characteristics</a> section of this page.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.quandl\">request.quandl()</a>\nfunction can only request <strong>free</strong> data from Nasdaq Data Link. No data\nthat requires a paid subscription to their services is accessible with\nthis function. Nasdaq Data Link may change the data it provides over\ntime, and they may not update available datasets regularly. Therefore,\nit\u2019s up to programmers to research the supported data available for\nrequest and review the documentation provided for each dataset. You can\nsearch for free data\n<a href=\"https://data.nasdaq.com/search?filters=%5B%22Free%22%5D\" rel=\"nofollow\">here</a>.</p></div></aside>\n<p>This script requests Bitcoin hash rate (\u201cHRATE\u201d) information from the\n\u201cBitcoin Data Insights\u201d (\u201cBCHAIN\u201d) database and\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the retrieved time\nseries data on the chart. It uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.from_gradient\">color.from_gradient()</a>\nto color the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_plot.style_area\">area</a>\nplot based on the distance from the current hash rate to its <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.max\">all-time\nhigh</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-quandl-1.WXplEe1P_1WvLGp.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Quandl demo\", \"BTC hash rate\")\n\n//@variable The estimated hash rate for the Bitcoin network.\nfloat hashRate = request.quandl(\"BCHAIN/HRATE\", barmerge.gaps_off, 0)\n//@variable The percentage threshold from the all-time highest `hashRate`.\nfloat dropThreshold = input.int(40, \"Drop threshold\", 0, 100)\n\n//@variable The all-time highest `hashRate`.\nfloat maxHashRate = ta.max(hashRate)\n//@variable The value `dropThreshold` percent below the `maxHashRate`.\nfloat minHashRate = maxHashRate * (100 - dropThreshold) / 100\n//@variable The color of the plot based on the `minHashRate` and `maxHashRate`.\ncolor plotColor = color.from_gradient(hashRate, minHashRate, maxHashRate, color.orange, color.blue)\n\n// Plot the `hashRate`.\nplot(hashRate, \"Hash Rate Estimate\", plotColor, style = plot.style_area)</div>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestfinancial\"><a href=\"#requestfinancial\"><span>\u200b<code dir=\"auto\">request.financial()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Financial metrics provide investors with insights about a company\u2019s\neconomic and financial health that are not tangible from solely\nanalyzing its stock prices. TradingView offers a wide variety of\nfinancial metrics from <a href=\"https://www.factset.com/\" rel=\"nofollow\">FactSet</a> that traders\ncan access via the \u201cFinancials\u201d tab in the \u201cIndicators\u201d menu of the\nchart. Scripts can access available metrics for an instrument directly\nvia the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\nfunction.</p>\n<p>This is the function\u2019s signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.financial(symbol, financial_id, period, gaps, ignore_invalid_symbol, currency) \u2192 series float</span></div></div></code></pre></figure></div>\n<p>As with the first parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a>,\nthe <code dir=\"auto\">symbol</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\nrequires an <em>\u201cExchange:Symbol\u201d pair</em>. To request financial information\nfor the chart\u2019s ticker ID, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>,\nas\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.ticker\">syminfo.ticker</a>\nwill not work.</p>\n<p>The <code dir=\"auto\">financial_id</code> parameter accepts a \u201cstring\u201d value representing\nthe ID of the requested financial metric. TradingView has numerous\nfinancial metrics to choose from. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#financial-ids\">Financial IDs</a> section below for an overview of all accessible metrics and\ntheir \u201cstring\u201d identifiers.</p>\n<p>The <code dir=\"auto\">period</code> parameter specifies the fiscal period for which new\nrequested data comes in. It accepts one of the following \u201cstring\u201d arguments:\n<strong>\u201cFQ\u201d (quarterly), \u201cFH\u201d (semiannual), \u201cFY\u201d (annual), or \u201cTTM\u201d\n(trailing twelve months)</strong>. Not all fiscal periods are available for all\nmetrics or instruments. To confirm which periods are available for\nspecific metrics, see the second column of the tables in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#financial-ids\">Financial IDs</a> section.</p>\n<p>See this page\u2019s\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#common-characteristics\">Common characteristics</a> section for a detailed explanation of this function\u2019s\n<code dir=\"auto\">gaps</code>, <code dir=\"auto\">ignore_invalid_symbol</code>, and <code dir=\"auto\">currency</code> parameters.</p>\n<p>It\u2019s important to note that the data retrieved from this function comes\nin at a <em>fixed frequency</em>, independent of the precise date on which the\ndata is made available within a fiscal period. For a company\u2019s\ndividends, splits, and earnings per share (EPS) information, one can\nrequest data reported on exact dates via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a>.</p>\n<p>This script uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\nto retrieve information about the income and expenses of a stock\u2019s\nissuing company and visualize the profitability of its typical business\noperations. It requests the \u201cOPER_INCOME\u201d, \u201cTOTAL_REVENUE\u201d, and\n\u201cTOTAL_OPER_EXPENSE\u201d\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#financial-ids\">financial IDs</a> for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>\nover the latest <code dir=\"auto\">fiscalPeriod</code>, then\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the results on the\nchart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"560\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-financial-1.B9cESm-h_ZhOVcV.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting financial data demo\", format = format.volume)\n\n//@variable The size of the fiscal reporting period. Some options may not be available, depending on the instrument.\nstring fiscalPeriod = input.string(\"FQ\", \"Period\", [\"FQ\", \"FH\", \"FY\", \"TTM\"])\n\n//@variable The operating income after expenses reported for the stock's issuing company.\nfloat operatingIncome = request.financial(syminfo.tickerid, \"OPER_INCOME\", fiscalPeriod)\n//@variable The total revenue reported for the stock's issuing company.\nfloat totalRevenue = request.financial(syminfo.tickerid, \"TOTAL_REVENUE\", fiscalPeriod)\n//@variable The total operating expenses reported for the stock's issuing company.\nfloat totalExpenses = request.financial(syminfo.tickerid, \"TOTAL_OPER_EXPENSE\", fiscalPeriod)\n\n//@variable Is aqua when the `totalRevenue` exceeds the `totalExpenses`, fuchsia otherwise.\ncolor incomeColor = operatingIncome &gt; 0 ? color.new(color.aqua, 50) : color.new(color.fuchsia, 50)\n\n// Display the requested data.\nplot(operatingIncome, \"Operating income\", incomeColor, 1, plot.style_area)\nplot(totalRevenue, \"Total revenue\", color.green, 3)\nplot(totalExpenses, \"Total operating expenses\", color.red, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>Not all <code dir=\"auto\">fiscalPeriod</code> options are available for every ticker\nID. For example, companies in the US typically publish\n<em>quarterly</em> reports, whereas many European companies publish\n<em>semiannual</em> reports. See <a href=\"https://www.tradingview.com/support/solutions/43000540147\">this\npage</a>\nin our Help Center for more information.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"calculating-financial-metrics\"><a href=\"#calculating-financial-metrics\">Calculating financial metrics<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\nfunction can provide scripts with numerous useful financial metrics that\ndon\u2019t require additional calculations. However, some commonly used\nfinancial estimates require combining an instrument\u2019s current market\nprice with requested financial data. Such is the case for:</p>\n<ul>\n<li>Market Capitalization (market price * total shares outstanding)</li>\n<li>Earnings Yield (12-month EPS / market price)</li>\n<li>Price-to-Book Ratio (market price / BVPS)</li>\n<li>Price-to-Earnings Ratio (market price / EPS)</li>\n<li>Price-to-Sales Ratio (market cap / 12-month total revenue)</li>\n</ul>\n<p>The following script contains\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> that calculate the above financial metrics for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>.\nWe\u2019ve created these functions so users can easily copy them into their\nscripts. This example uses them within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\ncall to construct a <code dir=\"auto\">tooltipText</code>, which it displays in tooltips on the\nchart using <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>. Hovering over any bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nwill expose the tooltip containing the metrics calculated on that bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"592\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-financial-Calculating-financial-metrics-1.BXp-EVdL_Z2nJnG7.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Calculating financial metrics demo\", overlay = true, max_labels_count = 500)\n\n//@function Calculates the market capitalization (market cap) for the chart's symbol.\nmarketCap() =&gt;\n    //@variable The most recent number of outstanding shares reported for the symbol.\n    float totalSharesOutstanding = request.financial(syminfo.tickerid, \"TOTAL_SHARES_OUTSTANDING\", \"FQ\")\n    // Return the market cap value.\n    totalSharesOutstanding * close\n\n//@function Calculates the Earnings Yield for the chart's symbol.\nearningsYield() =&gt;\n    //@variable The most recent 12-month earnings per share reported for the symbol.\n    float eps = request.financial(syminfo.tickerid, \"EARNINGS_PER_SHARE\", \"TTM\")\n    //Return the Earnings Yield percentage.\n    100.0 * eps / close\n\n//@function Calculates the Price-to-Book (P/B) ratio for the chart's symbol.\npriceBookRatio() =&gt;\n    //@variable The most recent Book Value Per Share (BVPS) reported for the symbol.\n    float bookValuePerShare = request.financial(syminfo.tickerid, \"BOOK_VALUE_PER_SHARE\", \"FQ\")\n    // Return the P/B ratio.\n    close / bookValuePerShare\n\n//@function Calculates the Price-to-Earnings (P/E) ratio for the chart's symbol.\npriceEarningsRatio() =&gt;\n    //@variable The most recent 12-month earnings per share reported for the symbol.\n    float eps = request.financial(syminfo.tickerid, \"EARNINGS_PER_SHARE\", \"TTM\")\n    // Return the P/E ratio.\n    close / eps\n\n//@function Calculates the Price-to-Sales (P/S) ratio for the chart's symbol.\npriceSalesRatio() =&gt;\n    //@variable The most recent number of outstanding shares reported for the symbol.\n    float totalSharesOutstanding = request.financial(syminfo.tickerid, \"TOTAL_SHARES_OUTSTANDING\", \"FQ\")\n    //@variable The most recent 12-month total revenue reported for the symbol.\n    float totalRevenue = request.financial(syminfo.tickerid, \"TOTAL_REVENUE\", \"TTM\")\n    // Return the P/S ratio.\n    totalSharesOutstanding * close / totalRevenue\n\n//@variable The text to display in label tooltips.\nstring tooltipText = str.format(\n     \"Market Cap: {0} {1}\\nEarnings Yield: {2}%\\nP/B Ratio: {3}\\nP/E Ratio: {4}\\nP/S Ratio: {5}\",\n     str.tostring(marketCap(), format.volume), syminfo.currency, earningsYield(), priceBookRatio(),\n     priceEarningsRatio(), priceSalesRatio()\n )\n\n//@variable Displays a blank label with a tooltip containing the `tooltipText`.\nlabel info = label.new(chart.point.now(high), tooltip = tooltipText)</div>\n<p>Note that:</p>\n<ul>\n<li>Since not all companies publish quarterly financial reports, one\nmay need to change the \u201cFQ\u201d in these functions to match the\nminimum reporting period for a specific company, as the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\ncalls will return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nwhen \u201cFQ\u201d data isn\u2019t available.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"financial-ids\"><a href=\"#financial-ids\">Financial IDs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Below is an overview of all financial metrics one can request via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>,\nalong with the periods in which reports may be available. We\u2019ve divided\nthis information into four tables corresponding to the categories\ndisplayed in the \u201cFinancials\u201d section of the \u201cIndicators\u201d menu:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#income-statements\">Income statements</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#balance-sheet\">Balance sheet</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#cash-flow\">Cash flow</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#statistics\">Statistics</a></li>\n</ul>\n<p>Each table has the following three columns:</p>\n<ul>\n<li>The first column contains descriptions of each metric with links to\nHelp Center pages for additional information.</li>\n<li>The second column lists the possible <code dir=\"auto\">period</code> arguments allowed for\nthe metric. Note that all available values may not be compatible\nwith specific ticker IDs, e.g., while \u201cFQ\u201d may be a possible\nargument, it will not work if the issuing company does not publish\nquarterly data.</li>\n<li>The third column lists the \u201cstring\u201d IDs for the <code dir=\"auto\">financial_id</code>\nargument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The tables in these sections are quite lengthy, as there are many\n<code dir=\"auto\">financial_id</code> arguments available. Use the <strong>\u201cClick to show/hide\u201d</strong>\noption above each table to toggle its visibility.</p></div></aside>\n<h4 class=\"md-heading\" id=\"income-statements\"><a href=\"#income-statements\">Income statements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>This table lists the available metrics that provide information about a\ncompany\u2019s income, costs, profits and losses.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th>Financial</th><th><code dir=\"auto\">period</code></th><th><code dir=\"auto\">financial_id</code></th></tr></thead><tbody><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563497\">After tax other income/expense</a></td><td>FQ, FH, FY, TTM</td><td>AFTER_TAX_OTHER_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670320\">Average basic shares outstanding</a></td><td>FQ, FH, FY</td><td>BASIC_SHARES_OUTSTANDING</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563520\">Basic earnings per share (Basic EPS)</a></td><td>FQ, FH, FY, TTM</td><td>EARNINGS_PER_SHARE_BASIC</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553618\">Cost of goods sold</a></td><td>FQ, FH, FY, TTM</td><td>COST_OF_GOODS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563477\">Deprecation and amortization</a></td><td>FQ, FH, FY, TTM</td><td>DEP_AMORT_EXP_INCOME_S</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553616\">Diluted earnings per share (Diluted EPS)</a></td><td>FQ, FH, FY, TTM</td><td>EARNINGS_PER_SHARE_DILUTED</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563516\">Diluted net income available to common stockholders</a></td><td>FQ, FH, FY, TTM</td><td>DILUTED_NET_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670322\">Diluted shares outstanding</a></td><td>FQ, FH, FY</td><td>DILUTED_SHARES_OUTSTANDING</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563504\">Dilution adjustment</a></td><td>FQ, FH, FY, TTM</td><td>DILUTION_ADJUSTMENT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563502\">Discontinued operations</a></td><td>FQ, FH, FY, TTM</td><td>DISCONTINUED_OPERATIONS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670329\">EBIT</a></td><td>FQ, FH, FY, TTM</td><td>EBIT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553610\">EBITDA</a></td><td>FQ, FH, FY, TTM</td><td>EBITDA</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563487\">Equity in earnings</a></td><td>FQ, FH, FY, TTM</td><td>EQUITY_IN_EARNINGS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553611\">Gross profit</a></td><td>FQ, FH, FY, TTM</td><td>GROSS_PROFIT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563468\">Interest capitalized</a></td><td>FQ, FH, FY, TTM</td><td>INTEREST_CAPITALIZED</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563467\">Interest expense on debt</a></td><td>FQ, FH, FY, TTM</td><td>INTEREST_EXPENSE_ON_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563466\">Interest expense, net of interest capitalized</a></td><td>FQ, FH, FY, TTM</td><td>NON_OPER_INTEREST_EXP</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563479\">Miscellaneous non-operating expense</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553617\">Net income</a></td><td>FQ, FH, FY, TTM</td><td>NET_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563500\">Net income before discontinued operations</a></td><td>FQ, FH, FY, TTM</td><td>NET_INCOME_BEF_DISC_OPER</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563495\">Non-controlling/minority interest</a></td><td>FQ, FH, FY, TTM</td><td>MINORITY_INTEREST_EXP</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563471\">Non-operating income, excl. interest expenses</a></td><td>FQ, FH, FY, TTM</td><td>NON_OPER_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563465\">Non-operating income, total</a></td><td>FQ, FH, FY, TTM</td><td>TOTAL_NON_OPER_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563473\">Non-operating interest income</a></td><td>FQ, FH, FY, TTM</td><td>NON_OPER_INTEREST_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563463\">Operating expenses (excl. COGS)</a></td><td>FQ, FH, FY, TTM</td><td>OPERATING_EXPENSES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563464\">Operating income</a></td><td>FQ, FH, FY, TTM</td><td>OPER_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563478\">Other cost of goods sold</a></td><td>FQ, FH, FY, TTM</td><td>COST_OF_GOODS_EXCL_DEP_AMORT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563483\">Other operating expenses, total</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_OPER_EXPENSE_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563506\">Preferred dividends</a></td><td>FQ, FH, FY, TTM</td><td>PREFERRED_DIVIDENDS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563474\">Pretax equity in earnings</a></td><td>FQ, FH, FY, TTM</td><td>PRETAX_EQUITY_IN_EARNINGS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563462\">Pretax income</a></td><td>FQ, FH, FY, TTM</td><td>PRETAX_INCOME</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553612\">Research &amp; development</a></td><td>FQ, FH, FY, TTM</td><td>RESEARCH_AND_DEV</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553614\">Selling/general/admin expenses, other</a></td><td>FQ, FH, FY, TTM</td><td>SELL_GEN_ADMIN_EXP_OTHER</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553613\">Selling/general/admin expenses, total</a></td><td>FQ, FH, FY, TTM</td><td>SELL_GEN_ADMIN_EXP_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563492\">Taxes</a></td><td>FQ, FH, FY, TTM</td><td>INCOME_TAX</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553615\">Total operating expenses</a></td><td>FQ, FH, FY, TTM</td><td>TOTAL_OPER_EXPENSE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553619\">Total revenue</a></td><td>FQ, FH, FY, TTM</td><td>TOTAL_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563476\">Unusual income/expense</a></td><td>FQ, FH, FY, TTM</td><td>UNUSUAL_EXPENSE_INC</td></tr></tbody></table></details>\n<h4 class=\"md-heading\" id=\"balance-sheet\"><a href=\"#balance-sheet\">Balance sheet<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>This table lists the metrics that provide information about a company\u2019s\ncapital structure.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th>Financial</th><th><code dir=\"auto\">period</code></th><th><code dir=\"auto\">financial_id</code></th></tr></thead><tbody><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563619\">Accounts payable</a></td><td>FQ, FH, FY</td><td>ACCOUNTS_PAYABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563740\">Accounts receivable - trade, net</a></td><td>FQ, FH, FY</td><td>ACCOUNTS_RECEIVABLES_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563628\">Accrued payroll</a></td><td>FQ, FH, FY</td><td>ACCRUED_PAYROLL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563673\">Accumulated depreciation, total</a></td><td>FQ, FH, FY</td><td>ACCUM_DEPREC_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563874\">Additional paid-in capital/Capital surplus</a></td><td>FQ, FH, FY</td><td>ADDITIONAL_PAID_IN_CAPITAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670330\">Book value per share</a></td><td>FQ, FH, FY</td><td>BOOK_VALUE_PER_SHARE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563522\">Capital and operating lease obligations</a></td><td>FQ, FH, FY</td><td>CAPITAL_OPERATING_LEASE_OBLIGATIONS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563527\">Capitalized lease obligations</a></td><td>FQ, FH, FY</td><td>CAPITAL_LEASE_OBLIGATIONS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563709\">Cash &amp; equivalents</a></td><td>FQ, FH, FY</td><td>CASH_N_EQUIVALENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563702\">Cash and short term investments</a></td><td>FQ, FH, FY</td><td>CASH_N_SHORT_TERM_INVEST</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563866\">Common equity, total</a></td><td>FQ, FH, FY</td><td>COMMON_EQUITY_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563873\">Common stock par/Carrying value</a></td><td>FQ, FH, FY</td><td>COMMON_STOCK_PAR</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563557\">Current portion of LT debt and capital leases</a></td><td>FQ, FH, FY</td><td>CURRENT_PORT_DEBT_CAPITAL_LEASES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563631\">Deferred income, current</a></td><td>FQ, FH, FY</td><td>DEFERRED_INCOME_CURRENT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563540\">Deferred income, non-current</a></td><td>FQ, FH, FY</td><td>DEFERRED_INCOME_NON_CURRENT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563683\">Deferred tax assets</a></td><td>FQ, FH, FY</td><td>DEFERRED_TAX_ASSESTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563536\">Deferred tax liabilities</a></td><td>FQ, FH, FY</td><td>DEFERRED_TAX_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563624\">Dividends payable</a></td><td>FY</td><td>DIVIDENDS_PAYABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563688\">Goodwill, net</a></td><td>FQ, FH, FY</td><td>GOODWILL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563667\">Gross property/plant/equipment</a></td><td>FQ, FH, FY</td><td>PPE_TOTAL_GROSS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563621\">Income tax payable</a></td><td>FQ, FH, FY</td><td>INCOME_TAX_PAYABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563749\">Inventories - finished goods</a></td><td>FQ, FH, FY</td><td>INVENTORY_FINISHED_GOODS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563748\">Inventories - progress payments &amp; other</a></td><td>FQ, FH, FY</td><td>INVENTORY_PROGRESS_PAYMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563753\">Inventories - raw materials</a></td><td>FQ, FH, FY</td><td>INVENTORY_RAW_MATERIALS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563746\">Inventories - work in progress</a></td><td>FQ, FH, FY</td><td>INVENTORY_WORK_IN_PROGRESS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563645\">Investments in unconsolidated subsidiaries</a></td><td>FQ, FH, FY</td><td>INVESTMENTS_IN_UNCONCSOLIDATE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553621\">Long term debt</a></td><td>FQ, FH, FY</td><td>LONG_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563521\">Long term debt excl. lease liabilities</a></td><td>FQ, FH, FY</td><td>LONG_TERM_DEBT_EXCL_CAPITAL_LEASE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563639\">Long term investments</a></td><td>FQ, FH, FY</td><td>LONG_TERM_INVESTMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563884\">Minority interest</a></td><td>FQ, FH, FY</td><td>MINORITY_INTEREST</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000665310\">Net debt</a></td><td>FQ, FH, FY</td><td>NET_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563686\">Net intangible assets</a></td><td>FQ, FH, FY</td><td>INTANGIBLES_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563657\">Net property/plant/equipment</a></td><td>FQ, FH, FY</td><td>PPE_TOTAL_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563641\">Note receivable - long term</a></td><td>FQ, FH, FY</td><td>LONG_TERM_NOTE_RECEIVABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563600\">Notes payable</a></td><td>FY</td><td>NOTES_PAYABLE_SHORT_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563532\">Operating lease liabilities</a></td><td>FQ, FH, FY</td><td>OPERATING_LEASE_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563877\">Other common equity</a></td><td>FQ, FH, FY</td><td>OTHER_COMMON_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563761\">Other current assets, total</a></td><td>FQ, FH, FY</td><td>OTHER_CURRENT_ASSETS_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563635\">Other current liabilities</a></td><td>FQ, FH, FY</td><td>OTHER_CURRENT_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563689\">Other intangibles, net</a></td><td>FQ, FH, FY</td><td>OTHER_INTANGIBLES_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563649\">Other investments</a></td><td>FQ, FH, FY</td><td>OTHER_INVESTMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563693\">Other long term assets, total</a></td><td>FQ, FH, FY</td><td>LONG_TERM_OTHER_ASSETS_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563545\">Other non-current liabilities, total</a></td><td>FQ, FH, FY</td><td>OTHER_LIABILITIES_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563741\">Other receivables</a></td><td>FQ, FH, FY</td><td>OTHER_RECEIVABLES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563614\">Other short term debt</a></td><td>FY</td><td>OTHER_SHORT_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563871\">Paid in capital</a></td><td>FQ, FH, FY</td><td>PAID_IN_CAPITAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563879\">Preferred stock, carrying value</a></td><td>FQ, FH, FY</td><td>PREFERRED_STOCK_CARRYING_VALUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563757\">Prepaid expenses</a></td><td>FQ, FH, FY</td><td>PREPAID_EXPENSES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563535\">Provision for risks &amp; charge</a></td><td>FQ, FH, FY</td><td>PROVISION_F_RISKS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563867\">Retained earnings</a></td><td>FQ, FH, FY</td><td>RETAINED_EARNINGS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000557442\">Shareholders\u2019 equity</a></td><td>FQ, FH, FY</td><td>SHRHLDRS_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563554\">Short term debt</a></td><td>FQ, FH, FY</td><td>SHORT_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563563\">Short term debt excl. current portion of LT debt</a></td><td>FQ, FH, FY</td><td>SHORT_TERM_DEBT_EXCL_CURRENT_PORT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563716\">Short term investments</a></td><td>FQ, FH, FY</td><td>SHORT_TERM_INVEST</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597072\">Tangible book value per share</a></td><td>FQ, FH, FY</td><td>BOOK_TANGIBLE_PER_SHARE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553623\">Total assets</a></td><td>FQ, FH, FY</td><td>TOTAL_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000557441\">Total current assets</a></td><td>FQ, FH, FY</td><td>TOTAL_CURRENT_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000557437\">Total current liabilities</a></td><td>FQ, FH, FY</td><td>TOTAL_CURRENT_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553622\">Total debt</a></td><td>FQ, FH, FY</td><td>TOTAL_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553625\">Total equity</a></td><td>FQ, FH, FY</td><td>TOTAL_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563745\">Total inventory</a></td><td>FQ, FH, FY</td><td>TOTAL_INVENTORY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553624\">Total liabilities</a></td><td>FQ, FH, FY</td><td>TOTAL_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553626\">Total liabilities &amp; shareholders\u2019 equities</a></td><td>FQ, FH, FY</td><td>TOTAL_LIABILITIES_SHRHLDRS_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000557440\">Total non-current assets</a></td><td>FQ, FH, FY</td><td>TOTAL_NON_CURRENT_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000557436\">Total non-current liabilities</a></td><td>FQ, FH, FY</td><td>TOTAL_NON_CURRENT_LIABILITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563738\">Total receivables, net</a></td><td>FQ, FH, FY</td><td>TOTAL_RECEIVABLES_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563875\">Treasury stock - common</a></td><td>FQ, FH, FY</td><td>TREASURY_STOCK_COMMON</td></tr></tbody></table></details>\n<h4 class=\"md-heading\" id=\"cash-flow\"><a href=\"#cash-flow\">Cash flow<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>This table lists the available metrics that provide information about\nhow cash flows through a company.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th>Financial</th><th><code dir=\"auto\">period</code></th><th><code dir=\"auto\">financial_id</code></th></tr></thead><tbody><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564143\">Amortization</a></td><td>FQ, FH, FY, TTM</td><td>AMORTIZATION</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564166\">Capital expenditures</a></td><td>FQ, FH, FY, TTM</td><td>CAPITAL_EXPENDITURES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564167\">Capital expenditures - fixed assets</a></td><td>FQ, FH, FY, TTM</td><td>CAPITAL_EXPENDITURES_FIXED_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564168\">Capital expenditures - other assets</a></td><td>FQ, FH, FY, TTM</td><td>CAPITAL_EXPENDITURES_OTHER_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553629\">Cash from financing activities</a></td><td>FQ, FH, FY, TTM</td><td>CASH_F_FINANCING_ACTIVITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553628\">Cash from investing activities</a></td><td>FQ, FH, FY, TTM</td><td>CASH_F_INVESTING_ACTIVITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553627\">Cash from operating activities</a></td><td>FQ, FH, FY, TTM</td><td>CASH_F_OPERATING_ACTIVITIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564150\">Change in accounts payable</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_ACCOUNTS_PAYABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564148\">Change in accounts receivable</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_ACCOUNTS_RECEIVABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564151\">Change in accrued expenses</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_ACCRUED_EXPENSES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564153\">Change in inventories</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_INVENTORIES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564154\">Change in other assets/liabilities</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_OTHER_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564149\">Change in taxes payable</a></td><td>FQ, FH, FY, TTM</td><td>CHANGE_IN_TAXES_PAYABLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564147\">Changes in working capital</a></td><td>FQ, FH, FY, TTM</td><td>CHANGES_IN_WORKING_CAPITAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564185\">Common dividends paid</a></td><td>FQ, FH, FY, TTM</td><td>COMMON_DIVIDENDS_CASH_FLOW</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564144\">Deferred taxes (cash flow)</a></td><td>FQ, FH, FY, TTM</td><td>CASH_FLOW_DEFERRED_TAXES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563892\">Depreciation &amp; amortization (cash flow)</a></td><td>FQ, FH, FY, TTM</td><td>CASH_FLOW_DEPRECATION_N_AMORTIZATION</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564142\">Depreciation/depletion</a></td><td>FQ, FH, FY, TTM</td><td>DEPRECIATION_DEPLETION</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564181\">Financing activities - other sources</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_FINANCING_CASH_FLOW_SOURCES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564182\">Financing activities - other uses</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_FINANCING_CASH_FLOW_USES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000553630\">Free cash flow</a></td><td>FQ, FH, FY, TTM</td><td>FREE_CASH_FLOW</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563886\">Funds from operations</a></td><td>FQ, FH, FY, TTM</td><td>FUNDS_F_OPERATIONS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564164\">Investing activities - other sources</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_INVESTING_CASH_FLOW_SOURCES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564165\">Investing activities - other uses</a></td><td>FQ, FH, FY</td><td>OTHER_INVESTING_CASH_FLOW_USES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564176\">Issuance of long term debt</a></td><td>FQ, FH, FY, TTM</td><td>SUPPLYING_OF_LONG_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564172\">Issuance/retirement of debt, net</a></td><td>FQ, FH, FY, TTM</td><td>ISSUANCE_OF_DEBT_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564175\">Issuance/retirement of long term debt</a></td><td>FQ, FH, FY, TTM</td><td>ISSUANCE_OF_LONG_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564178\">Issuance/retirement of other debt</a></td><td>FQ, FH, FY, TTM</td><td>ISSUANCE_OF_OTHER_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564173\">Issuance/retirement of short term debt</a></td><td>FQ, FH, FY, TTM</td><td>ISSUANCE_OF_SHORT_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564169\">Issuance/retirement of stock, net</a></td><td>FQ, FH, FY, TTM</td><td>ISSUANCE_OF_STOCK_NET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000563888\">Net income (cash flow)</a></td><td>FQ, FH, FY, TTM</td><td>NET_INCOME_STARTING_LINE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564146\">Non-cash items</a></td><td>FQ, FH, FY, TTM</td><td>NON_CASH_ITEMS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564179\">Other financing cash flow items, total</a></td><td>FQ, FH, FY, TTM</td><td>OTHER_FINANCING_CASH_FLOW_ITEMS_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564163\">Other investing cash flow items, total</a></td><td>FQ, FH, FY</td><td>OTHER_INVESTING_CASH_FLOW_ITEMS_TOTAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564186\">Preferred dividends paid</a></td><td>FQ, FH, FY</td><td>PREFERRED_DIVIDENDS_CASH_FLOW</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564162\">Purchase of investments</a></td><td>FQ, FH, FY, TTM</td><td>PURCHASE_OF_INVESTMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564159\">Purchase/acquisition of business</a></td><td>FQ, FH, FY, TTM</td><td>PURCHASE_OF_BUSINESS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564156\">Purchase/sale of business, net</a></td><td>FQ, FH, FY</td><td>PURCHASE_SALE_BUSINESS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564160\">Purchase/sale of investments, net</a></td><td>FQ, FH, FY, TTM</td><td>PURCHASE_SALE_INVESTMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564177\">Reduction of long term debt</a></td><td>FQ, FH, FY, TTM</td><td>REDUCTION_OF_LONG_TERM_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564171\">Repurchase of common &amp; preferred stock</a></td><td>FQ, FH, FY, TTM</td><td>PURCHASE_OF_STOCK</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564170\">Sale of common &amp; preferred stock</a></td><td>FQ, FH, FY, TTM</td><td>SALE_OF_STOCK</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564158\">Sale of fixed assets &amp; businesses</a></td><td>FQ, FH, FY, TTM</td><td>SALES_OF_BUSINESS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564161\">Sale/maturity of investments</a></td><td>FQ, FH, FY</td><td>SALES_OF_INVESTMENTS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000564183\">Total cash dividends paid</a></td><td>FQ, FH, FY, TTM</td><td>TOTAL_CASH_DIVIDENDS_PAID</td></tr></tbody></table></details>\n<h4 class=\"md-heading\" id=\"statistics\"><a href=\"#statistics\">Statistics<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>This table contains a variety of statistical metrics, including commonly\nused financial ratios.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th>Financial</th><th><code dir=\"auto\">period</code></th><th><code dir=\"auto\">financial_id</code></th></tr></thead><tbody><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597073\">Accruals</a></td><td>FQ, FH, FY</td><td>ACCRUALS_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597092\">Altman Z-score</a></td><td>FQ, FH, FY</td><td>ALTMAN_Z_SCORE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597022\">Asset turnover</a></td><td>FQ, FH, FY</td><td>ASSET_TURNOVER</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597835\">Beneish M-score</a></td><td>FQ, FH, FY</td><td>BENEISH_M_SCORE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597088\">Buyback yield %</a></td><td>FQ, FH, FY</td><td>BUYBACK_YIELD</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597026\">COGS to revenue ratio</a></td><td>FQ, FH, FY</td><td>COGS_TO_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597089\">Cash conversion cycle</a></td><td>FQ, FY</td><td>CASH_CONVERSION_CYCLE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597023\">Cash to debt ratio</a></td><td>FQ, FH, FY</td><td>CASH_TO_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597051\">Current ratio</a></td><td>FQ, FH, FY</td><td>CURRENT_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597028\">Days inventory</a></td><td>FQ, FY</td><td>DAYS_INVENT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597029\">Days payable</a></td><td>FQ, FY</td><td>DAYS_PAY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597030\">Days sales outstanding</a></td><td>FQ, FY</td><td>DAY_SALES_OUT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597032\">Debt to EBITDA ratio</a></td><td>FQ, FH, FY</td><td>DEBT_TO_EBITDA</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597031\">Debt to assets ratio</a></td><td>FQ, FH, FY</td><td>DEBT_TO_ASSET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597078\">Debt to equity ratio</a></td><td>FQ, FH, FY</td><td>DEBT_TO_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597033\">Debt to revenue ratio</a></td><td>FQ, FH, FY</td><td>DEBT_TO_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597738\">Dividend payout ratio %</a></td><td>FQ, FH, FY, TTM</td><td>DIVIDEND_PAYOUT_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597817\">Dividend yield %</a></td><td>FQ, FH, FY</td><td>DIVIDENDS_YIELD</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670334\">Dividends per share - common stock primary issue</a></td><td>FQ, FH, FY, TTM</td><td>DPS_COMMON_STOCK_PRIM_ISSUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597075\">EBITDA margin %</a></td><td>FQ, FH, FY, TTM</td><td>EBITDA_MARGIN</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597069\">EPS basic one year growth</a></td><td>FQ, FH, FY, TTM</td><td>EARNINGS_PER_SHARE_BASIC_ONE_YEAR_GROWTH</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597071\">EPS diluted one year growth</a></td><td>FQ, FH, FY</td><td>EARNINGS_PER_SHARE_DILUTED_ONE_YEAR_GROWTH</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597066\">EPS estimates</a></td><td>FQ, FH, FY</td><td>EARNINGS_ESTIMATE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597034\">Effective interest rate on debt %</a></td><td>FQ, FH, FY</td><td>EFFECTIVE_INTEREST_RATE_ON_DEBT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597077\">Enterprise value</a></td><td>FQ, FH, FY</td><td>ENTERPRISE_VALUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597063\">Enterprise value to EBIT ratio</a></td><td>FQ, FH, FY</td><td>EV_EBIT</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597064\">Enterprise value to EBITDA ratio</a></td><td>FQ, FH, FY</td><td>ENTERPRISE_VALUE_EBITDA</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597065\">Enterprise value to revenue ratio</a></td><td>FQ, FH, FY</td><td>EV_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597035\">Equity to assets ratio</a></td><td>FQ, FH, FY</td><td>EQUITY_TO_ASSET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670341\">Float shares outstanding</a></td><td>FY</td><td>FLOAT_SHARES_OUTSTANDING</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597813\">Free cash flow margin %</a></td><td>FQ, FH, FY</td><td>FREE_CASH_FLOW_MARGIN</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597847\">Fulmer H factor</a></td><td>FQ, FY</td><td>FULMER_H_FACTOR</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597036\">Goodwill to assets ratio</a></td><td>FQ, FH, FY</td><td>GOODWILL_TO_ASSET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597084\">Graham\u2019s number</a></td><td>FQ, FY</td><td>GRAHAM_NUMBERS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597811\">Gross margin %</a></td><td>FQ, FH, FY, TTM</td><td>GROSS_MARGIN</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597087\">Gross profit to assets ratio</a></td><td>FQ, FY</td><td>GROSS_PROFIT_TO_ASSET</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597037\">Interest coverage</a></td><td>FQ, FH, FY</td><td>INTERST_COVER</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597047\">Inventory to revenue ratio</a></td><td>FQ, FH, FY</td><td>INVENT_TO_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597046\">Inventory turnover</a></td><td>FQ, FH, FY</td><td>INVENT_TURNOVER</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597844\">KZ index</a></td><td>FY</td><td>KZ_INDEX</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597048\">Long term debt to total assets ratio</a></td><td>FQ, FH, FY</td><td>LONG_TERM_DEBT_TO_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597085\">Net current asset value per share</a></td><td>FQ, FY</td><td>NCAVPS_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597082\">Net income per employee</a></td><td>FY</td><td>NET_INCOME_PER_EMPLOYEE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597074\">Net margin %</a></td><td>FQ, FH, FY, TTM</td><td>NET_MARGIN</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597080\">Number of employees</a></td><td>FY</td><td>NUMBER_OF_EMPLOYEES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000684072\">Operating earnings yield %</a></td><td>FQ, FH, FY</td><td>OPERATING_EARNINGS_YIELD</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597076\">Operating margin %</a></td><td>FQ, FH, FY</td><td>OPERATING_MARGIN</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597090\">PEG ratio</a></td><td>FQ, FY</td><td>PEG_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597734\">Piotroski F-score</a></td><td>FQ, FH, FY</td><td>PIOTROSKI_F_SCORE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597831\">Price earnings ratio forward</a></td><td>FQ, FY</td><td>PRICE_EARNINGS_FORWARD</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597832\">Price sales ratio forward</a></td><td>FQ, FY</td><td>PRICE_SALES_FORWARD</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597086\">Quality ratio</a></td><td>FQ, FH, FY</td><td>QUALITY_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597050\">Quick ratio</a></td><td>FQ, FH, FY</td><td>QUICK_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597739\">Research &amp; development to revenue ratio</a></td><td>FQ, FH, FY</td><td>RESEARCH_AND_DEVELOP_TO_REVENUE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597054\">Return on assets %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000656797\">Return on common equity %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_COMMON_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597021\">Return on equity %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597055\">Return on equity adjusted to book value %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_EQUITY_ADJUST_TO_BOOK</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597056\">Return on invested capital %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_INVESTED_CAPITAL</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597052\">Return on tangible assets %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_TANG_ASSETS</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597053\">Return on tangible equity %</a></td><td>FQ, FH, FY</td><td>RETURN_ON_TANG_EQUITY</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597067\">Revenue estimates</a></td><td>FQ, FH, FY</td><td>SALES_ESTIMATES</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597068\">Revenue one year growth</a></td><td>FQ, FH, FY, TTM</td><td>REVENUE_ONE_YEAR_GROWTH</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597081\">Revenue per employee</a></td><td>FY</td><td>REVENUE_PER_EMPLOYEE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597057\">Shares buyback ratio %</a></td><td>FQ, FH, FY</td><td>SHARE_BUYBACK_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597058\">Sloan ratio %</a></td><td>FQ, FH, FY</td><td>SLOAN_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597848\">Springate score</a></td><td>FQ, FY</td><td>SPRINGATE_SCORE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597736\">Sustainable growth rate</a></td><td>FQ, FY</td><td>SUSTAINABLE_GROWTH_RATE</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597079\">Tangible common equity ratio</a></td><td>FQ, FH, FY</td><td>TANGIBLE_COMMON_EQUITY_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597834\">Tobin\u2019s Q (approximate)</a></td><td>FQ, FH, FY</td><td>TOBIN_Q_RATIO</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000670331\">Total common shares outstanding</a></td><td>FQ, FH, FY</td><td>TOTAL_SHARES_OUTSTANDING</td></tr><tr><td><a href=\"https://www.tradingview.com/support/solutions/43000597850\">Zmijewski score</a></td><td>FQ, FY</td><td>ZMIJEWSKI_SCORE</td></tr></tbody></table></details>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requesteconomic\"><a href=\"#requesteconomic\"><span>\u200b<code dir=\"auto\">request.economic()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a>\nfunction provides scripts with the ability to retrieve economic data for\na specified country or region, including information about the state of\nthe economy (GDP, inflation rate, etc.) or of a particular industry\n(steel production, ICU beds, etc.).</p>\n<p>Below is the signature for this function:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.economic(country_code, field, gaps, ignore_invalid_symbol) \u2192 series float</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">country_code</code> parameter accepts a \u201cstring\u201d value representing\nthe identifier of the country or region to request economic data for\n(e.g., \u201cUS\u201d, \u201cEU\u201d, etc.). See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#countryregion-codes\">Country/region codes</a> section for a complete list of codes this function supports.\nNote that the economic metrics available depend on the country or region\nspecified in the function call.</p>\n<p>The <code dir=\"auto\">field</code> parameter accepts a \u201cstring\u201d specifying the metric that the function requests.\nThe\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#field-codes\">Field codes</a> section covers all accessible metrics and the\ncountries/regions they\u2019re available for.</p>\n<p>For a detailed explanation on the last two parameters of this function,\nsee the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#common-characteristics\">Common characteristics</a> section at the top of this page.</p>\n<p>This simple example requests the growth rate of the Gross Domestic\nProduct (\u201cGDPQQ\u201d) for the United States (\u201cUS\u201d) using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a>,\nthen <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> its value on the\nchart with a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.from_gradient\">gradient\ncolor</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-economic-1.B5XiS4A4_2mUcAV.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requesting economic data demo\")\n\n//@variable The GDP growth rate for the US economy.\nfloat gdpqq = request.economic(\"US\", \"GDPQQ\")\n\n//@variable The all-time maximum growth rate.\nfloat maxRate = ta.max(gdpqq)\n//@variable The all-time minimum growth rate.\nfloat minRate = ta.min(gdpqq)\n\n//@variable The color of the `gdpqq` plot.\ncolor rateColor = switch\n    gdpqq &gt;= 0 =&gt; color.from_gradient(gdpqq, 0, maxRate, color.purple, color.blue)\n    =&gt;            color.from_gradient(gdpqq, minRate, 0, color.red, color.purple)\n\n// Plot the results.\nplot(gdpqq, \"US GDP Growth Rate\", rateColor, style = plot.style_area)</div>\n<p>Note that:</p>\n<ul>\n<li>This example does not include a <code dir=\"auto\">gaps</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a>\ncall, so the function uses the default\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.gaps_off\">barmerge.gaps_off</a>.\nIn other words, it returns the last retrieved value when new\ndata isn\u2019t yet available.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The tables in the sections below are rather large, as there are numerous\n<code dir=\"auto\">country_code</code> and <code dir=\"auto\">field</code> arguments available. Use the <strong>\u201cClick to\nshow/hide\u201d</strong> option above each table to toggle its visibility.</p></div></aside>\n<h3 class=\"md-heading\" id=\"countryregion-codes\"><a href=\"#countryregion-codes\">Country/region codes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The table in this section lists all country/region codes available for\nuse with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a>.\nThe first column of the table contains the \u201cstring\u201d values that\nrepresent the country or region code, and the second column contains the\ncorresponding country/region names.</p>\n<p>It\u2019s important to note that the value used as the <code dir=\"auto\">country_code</code>\nargument determines which\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#field-codes\">field codes</a> are accessible to the function.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th><code dir=\"auto\">country_code</code></th><th>Country/region name</th></tr></thead><tbody><tr><td>AF</td><td>Afghanistan</td></tr><tr><td>AL</td><td>Albania</td></tr><tr><td>DZ</td><td>Algeria</td></tr><tr><td>AD</td><td>Andorra</td></tr><tr><td>AO</td><td>Angola</td></tr><tr><td>AG</td><td>Antigua and Barbuda</td></tr><tr><td>AR</td><td>Argentina</td></tr><tr><td>AM</td><td>Armenia</td></tr><tr><td>AW</td><td>Aruba</td></tr><tr><td>AU</td><td>Australia</td></tr><tr><td>AT</td><td>Austria</td></tr><tr><td>AZ</td><td>Azerbaijan</td></tr><tr><td>BS</td><td>Bahamas</td></tr><tr><td>BH</td><td>Bahrain</td></tr><tr><td>BD</td><td>Bangladesh</td></tr><tr><td>BB</td><td>Barbados</td></tr><tr><td>BY</td><td>Belarus</td></tr><tr><td>BE</td><td>Belgium</td></tr><tr><td>BZ</td><td>Belize</td></tr><tr><td>BJ</td><td>Benin</td></tr><tr><td>BM</td><td>Bermuda</td></tr><tr><td>BT</td><td>Bhutan</td></tr><tr><td>BO</td><td>Bolivia</td></tr><tr><td>BA</td><td>Bosnia and Herzegovina</td></tr><tr><td>BW</td><td>Botswana</td></tr><tr><td>BR</td><td>Brazil</td></tr><tr><td>BN</td><td>Brunei</td></tr><tr><td>BG</td><td>Bulgaria</td></tr><tr><td>BF</td><td>Burkina Faso</td></tr><tr><td>BI</td><td>Burundi</td></tr><tr><td>KH</td><td>Cambodia</td></tr><tr><td>CM</td><td>Cameroon</td></tr><tr><td>CA</td><td>Canada</td></tr><tr><td>CV</td><td>Cape Verde</td></tr><tr><td>KY</td><td>Cayman Islands</td></tr><tr><td>CF</td><td>Central African Republic</td></tr><tr><td>TD</td><td>Chad</td></tr><tr><td>CL</td><td>Chile</td></tr><tr><td>CN</td><td>China</td></tr><tr><td>CO</td><td>Colombia</td></tr><tr><td>KM</td><td>Comoros</td></tr><tr><td>CG</td><td>Congo</td></tr><tr><td>CR</td><td>Costa Rica</td></tr><tr><td>HR</td><td>Croatia</td></tr><tr><td>CU</td><td>Cuba</td></tr><tr><td>CY</td><td>Cyprus</td></tr><tr><td>CZ</td><td>Czech Republic</td></tr><tr><td>DK</td><td>Denmark</td></tr><tr><td>DJ</td><td>Djibouti</td></tr><tr><td>DM</td><td>Dominica</td></tr><tr><td>DO</td><td>Dominican Republic</td></tr><tr><td>TL</td><td>East Timor</td></tr><tr><td>EC</td><td>Ecuador</td></tr><tr><td>EG</td><td>Egypt</td></tr><tr><td>SV</td><td>El Salvador</td></tr><tr><td>GQ</td><td>Equatorial Guinea</td></tr><tr><td>ER</td><td>Eritrea</td></tr><tr><td>EE</td><td>Estonia</td></tr><tr><td>ET</td><td>Ethiopia</td></tr><tr><td>EU</td><td>Euro area</td></tr><tr><td>FO</td><td>Faroe Islands</td></tr><tr><td>FJ</td><td>Fiji</td></tr><tr><td>FI</td><td>Finland</td></tr><tr><td>FR</td><td>France</td></tr><tr><td>GA</td><td>Gabon</td></tr><tr><td>GM</td><td>Gambia</td></tr><tr><td>GE</td><td>Georgia</td></tr><tr><td>DE</td><td>Germany</td></tr><tr><td>GH</td><td>Ghana</td></tr><tr><td>GR</td><td>Greece</td></tr><tr><td>GL</td><td>Greenland</td></tr><tr><td>GD</td><td>Grenada</td></tr><tr><td>GT</td><td>Guatemala</td></tr><tr><td>GN</td><td>Guinea</td></tr><tr><td>GW</td><td>Guinea Bissau</td></tr><tr><td>GY</td><td>Guyana</td></tr><tr><td>HT</td><td>Haiti</td></tr><tr><td>HN</td><td>Honduras</td></tr><tr><td>HK</td><td>Hong Kong</td></tr><tr><td>HU</td><td>Hungary</td></tr><tr><td>IS</td><td>Iceland</td></tr><tr><td>IN</td><td>India</td></tr><tr><td>ID</td><td>Indonesia</td></tr><tr><td>IR</td><td>Iran</td></tr><tr><td>IQ</td><td>Iraq</td></tr><tr><td>IE</td><td>Ireland</td></tr><tr><td>IM</td><td>Isle of Man</td></tr><tr><td>IL</td><td>Israel</td></tr><tr><td>IT</td><td>Italy</td></tr><tr><td>CI</td><td>Ivory Coast</td></tr><tr><td>JM</td><td>Jamaica</td></tr><tr><td>JP</td><td>Japan</td></tr><tr><td>JO</td><td>Jordan</td></tr><tr><td>KZ</td><td>Kazakhstan</td></tr><tr><td>KE</td><td>Kenya</td></tr><tr><td>KI</td><td>Kiribati</td></tr><tr><td>XK</td><td>Kosovo</td></tr><tr><td>KW</td><td>Kuwait</td></tr><tr><td>KG</td><td>Kyrgyzstan</td></tr><tr><td>LA</td><td>Laos</td></tr><tr><td>LV</td><td>Latvia</td></tr><tr><td>LB</td><td>Lebanon</td></tr><tr><td>LS</td><td>Lesotho</td></tr><tr><td>LR</td><td>Liberia</td></tr><tr><td>LY</td><td>Libya</td></tr><tr><td>LI</td><td>Liechtenstein</td></tr><tr><td>LT</td><td>Lithuania</td></tr><tr><td>LU</td><td>Luxembourg</td></tr><tr><td>MO</td><td>Macau</td></tr><tr><td>MK</td><td>Macedonia</td></tr><tr><td>MG</td><td>Madagascar</td></tr><tr><td>MW</td><td>Malawi</td></tr><tr><td>MY</td><td>Malaysia</td></tr><tr><td>MV</td><td>Maldives</td></tr><tr><td>ML</td><td>Mali</td></tr><tr><td>MT</td><td>Malta</td></tr><tr><td>MR</td><td>Mauritania</td></tr><tr><td>MU</td><td>Mauritius</td></tr><tr><td>MX</td><td>Mexico</td></tr><tr><td>MD</td><td>Moldova</td></tr><tr><td>MC</td><td>Monaco</td></tr><tr><td>MN</td><td>Mongolia</td></tr><tr><td>ME</td><td>Montenegro</td></tr><tr><td>MA</td><td>Morocco</td></tr><tr><td>MZ</td><td>Mozambique</td></tr><tr><td>MM</td><td>Myanmar</td></tr><tr><td>NA</td><td>Namibia</td></tr><tr><td>NP</td><td>Nepal</td></tr><tr><td>NL</td><td>Netherlands</td></tr><tr><td>NC</td><td>New Caledonia</td></tr><tr><td>NZ</td><td>New Zealand</td></tr><tr><td>NI</td><td>Nicaragua</td></tr><tr><td>NE</td><td>Niger</td></tr><tr><td>NG</td><td>Nigeria</td></tr><tr><td>KP</td><td>North Korea</td></tr><tr><td>NO</td><td>Norway</td></tr><tr><td>OM</td><td>Oman</td></tr><tr><td>PK</td><td>Pakistan</td></tr><tr><td>PS</td><td>Palestine</td></tr><tr><td>PA</td><td>Panama</td></tr><tr><td>PG</td><td>Papua New Guinea</td></tr><tr><td>PY</td><td>Paraguay</td></tr><tr><td>PE</td><td>Peru</td></tr><tr><td>PH</td><td>Philippines</td></tr><tr><td>PL</td><td>Poland</td></tr><tr><td>PT</td><td>Portugal</td></tr><tr><td>PR</td><td>Puerto Rico</td></tr><tr><td>QA</td><td>Qatar</td></tr><tr><td>CD</td><td>Republic of the Congo</td></tr><tr><td>RO</td><td>Romania</td></tr><tr><td>RU</td><td>Russia</td></tr><tr><td>RW</td><td>Rwanda</td></tr><tr><td>WS</td><td>Samoa</td></tr><tr><td>SM</td><td>San Marino</td></tr><tr><td>ST</td><td>Sao Tome and Principe</td></tr><tr><td>SA</td><td>Saudi Arabia</td></tr><tr><td>SN</td><td>Senegal</td></tr><tr><td>RS</td><td>Serbia</td></tr><tr><td>SC</td><td>Seychelles</td></tr><tr><td>SL</td><td>Sierra Leone</td></tr><tr><td>SG</td><td>Singapore</td></tr><tr><td>SK</td><td>Slovakia</td></tr><tr><td>SI</td><td>Slovenia</td></tr><tr><td>SB</td><td>Solomon Islands</td></tr><tr><td>SO</td><td>Somalia</td></tr><tr><td>ZA</td><td>South Africa</td></tr><tr><td>KR</td><td>South Korea</td></tr><tr><td>SS</td><td>South Sudan</td></tr><tr><td>ES</td><td>Spain</td></tr><tr><td>LK</td><td>Sri Lanka</td></tr><tr><td>LC</td><td>St Lucia</td></tr><tr><td>VC</td><td>St Vincent and the Grenadines</td></tr><tr><td>SD</td><td>Sudan</td></tr><tr><td>SR</td><td>Suriname</td></tr><tr><td>SZ</td><td>Swaziland</td></tr><tr><td>SE</td><td>Sweden</td></tr><tr><td>CH</td><td>Switzerland</td></tr><tr><td>SY</td><td>Syria</td></tr><tr><td>TW</td><td>Taiwan</td></tr><tr><td>TJ</td><td>Tajikistan</td></tr><tr><td>TZ</td><td>Tanzania</td></tr><tr><td>TH</td><td>Thailand</td></tr><tr><td>TG</td><td>Togo</td></tr><tr><td>TO</td><td>Tonga</td></tr><tr><td>TT</td><td>Trinidad and Tobago</td></tr><tr><td>TN</td><td>Tunisia</td></tr><tr><td>TR</td><td>Turkey</td></tr><tr><td>TM</td><td>Turkmenistan</td></tr><tr><td>UG</td><td>Uganda</td></tr><tr><td>UA</td><td>Ukraine</td></tr><tr><td>AE</td><td>United Arab Emirates</td></tr><tr><td>GB</td><td>United Kingdom</td></tr><tr><td>US</td><td>United States</td></tr><tr><td>UY</td><td>Uruguay</td></tr><tr><td>UZ</td><td>Uzbekistan</td></tr><tr><td>VU</td><td>Vanuatu</td></tr><tr><td>VE</td><td>Venezuela</td></tr><tr><td>VN</td><td>Vietnam</td></tr><tr><td>YE</td><td>Yemen</td></tr><tr><td>ZM</td><td>Zambia</td></tr><tr><td>ZW</td><td>Zimbabwe</td></tr></tbody></table></details>\n<h3 class=\"md-heading\" id=\"field-codes\"><a href=\"#field-codes\">Field codes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The table in this section lists the field codes available for use with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a>.\nThe first column contains the \u201cstring\u201d values used as the <code dir=\"auto\">field</code>\nargument, and the second column contains names of each metric and links\nto our Help Center with additional information, including the\ncountries/regions they\u2019re available for.</p>\n<details open=\"\"><summary><a>Click to show/hide</a></summary>\n<table><thead><tr><th><code dir=\"auto\">field</code></th><th>Metric</th></tr></thead><tbody><tr><td>AA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650926\">Asylum Applications</a></td></tr><tr><td>ACR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650920\">API Crude Runs</a></td></tr><tr><td>AE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650927\">Auto Exports</a></td></tr><tr><td>AHE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650928\">Average Hourly Earnings</a></td></tr><tr><td>AHO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650924\">API Heating Oil</a></td></tr><tr><td>AWH</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650929\">Average Weekly Hours</a></td></tr><tr><td>BBS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650932\">Banks Balance Sheet</a></td></tr><tr><td>BCLI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650935\">Business Climate Indicator</a></td></tr><tr><td>BCOI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650936\">Business Confidence Index</a></td></tr><tr><td>BI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650937\">Business Inventories</a></td></tr><tr><td>BLR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650933\">Bank Lending Rate</a></td></tr><tr><td>BOI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651133\">NFIB Business Optimism Index</a></td></tr><tr><td>BOT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650930\">Balance Of Trade</a></td></tr><tr><td>BP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650934\">Building Permits</a></td></tr><tr><td>BR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650931\">Bankruptcies</a></td></tr><tr><td>CA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650988\">Current Account</a></td></tr><tr><td>CAG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650987\">Current Account To GDP</a></td></tr><tr><td>CAP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650945\">Car Production</a></td></tr><tr><td>CAR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650946\">Car Registrations</a></td></tr><tr><td>CBBS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650952\">Central Bank Balance Sheet</a></td></tr><tr><td>CCC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650959\">Claimant Count Change</a></td></tr><tr><td>CCI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650966\">Consumer Confidence Index</a></td></tr><tr><td>CCOS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650989\">Cushing Crude Oil Stocks</a></td></tr><tr><td>CCP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650974\">Core Consumer Prices</a></td></tr><tr><td>CCPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650973\">Core CPI</a></td></tr><tr><td>CCPT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650967\">Consumer Confidence Price Trends</a></td></tr><tr><td>CCR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650968\">Consumer Credit</a></td></tr><tr><td>CCS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650982\">Credit Card Spending</a></td></tr><tr><td>CEP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650951\">Cement Production</a></td></tr><tr><td>CF</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650944\">Capital Flows</a></td></tr><tr><td>CFNAI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650957\">Chicago Fed National Activity Index</a></td></tr><tr><td>CI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650918\">API Crude Imports</a></td></tr><tr><td>CIND</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650960\">Coincident Index</a></td></tr><tr><td>CIR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650975\">Core Inflation Rate, YoY</a></td></tr><tr><td>CJC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650971\">Continuing Jobless Claims</a></td></tr><tr><td>CN</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650921\">API Cushing Number</a></td></tr><tr><td>COI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650983\">Crude Oil Imports</a></td></tr><tr><td>COIR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679670\">Crude Oil Imports from Russia</a></td></tr><tr><td>CONSTS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650965\">Construction Spending</a></td></tr><tr><td>COP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650984\">Crude Oil Production</a></td></tr><tr><td>COR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650985\">Crude Oil Rigs</a></td></tr><tr><td>CORD</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650963\">Construction Orders, YoY</a></td></tr><tr><td>CORPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650980\">Corruption Index</a></td></tr><tr><td>CORR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650981\">Corruption Rank</a></td></tr><tr><td>COSC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650986\">Crude Oil Stocks Change</a></td></tr><tr><td>COUT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650964\">Construction Output, YoY</a></td></tr><tr><td>CP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650972\">Copper Production</a></td></tr><tr><td>CPCEPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650976\">Core PCE Price Index</a></td></tr><tr><td>CPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650969\">Consumer Price Index</a></td></tr><tr><td>CPIHU</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650939\">CPI Housing Utilities</a></td></tr><tr><td>CPIM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650940\">CPI Median</a></td></tr><tr><td>CPIT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650941\">CPI Transportation</a></td></tr><tr><td>CPITM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650942\">CPI Trimmed Mean</a></td></tr><tr><td>CPMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650958\">Chicago PMI</a></td></tr><tr><td>CPPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650977\">Core Producer Price Index</a></td></tr><tr><td>CPR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650978\">Corporate Profits</a></td></tr><tr><td>CRLPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679669\">Cereals Price Index</a></td></tr><tr><td>CRR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650950\">Cash Reserve Ratio</a></td></tr><tr><td>CS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650970\">Consumer Spending</a></td></tr><tr><td>CSC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650919\">API Crude Oil Stock Change</a></td></tr><tr><td>CSHPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650947\">Case Shiller Home Price Index</a></td></tr><tr><td>CSHPIMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650948\">Case Shiller Home Price Index, MoM</a></td></tr><tr><td>CSHPIYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650949\">Case Shiller Home Price Index, YoY</a></td></tr><tr><td>CSS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650954\">Chain Store Sales</a></td></tr><tr><td>CTR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650979\">Corporate Tax Rate</a></td></tr><tr><td>CU</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650943\">Capacity Utilization</a></td></tr><tr><td>DFMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650990\">Dallas Fed Manufacturing Index</a></td></tr><tr><td>DFP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650996\">Distillate Fuel Production</a></td></tr><tr><td>DFS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650997\">Distillate Stocks</a></td></tr><tr><td>DFSI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650991\">Dallas Fed Services Index</a></td></tr><tr><td>DFSRI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650992\">Dallas Fed Services Revenues Index</a></td></tr><tr><td>DG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650993\">Deposit Growth</a></td></tr><tr><td>DGO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651000\">Durable Goods Orders</a></td></tr><tr><td>DGOED</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650998\">Durable Goods Orders Excluding Defense</a></td></tr><tr><td>DGOET</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650999\">Durable Goods Orders Excluding Transportation</a></td></tr><tr><td>DIR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650994\">Deposit Interest Rate</a></td></tr><tr><td>DPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650995\">Disposable Personal Income</a></td></tr><tr><td>DRPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679668\">Dairy Price Index</a></td></tr><tr><td>DS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650922\">API Distillate Stocks</a></td></tr><tr><td>DT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650938\">CBI Distributive Trades</a></td></tr><tr><td>EC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650917\">ADP Employment Change</a></td></tr><tr><td>ED</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651012\">External Debt</a></td></tr><tr><td>EDBR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651001\">Ease Of Doing Business Ranking</a></td></tr><tr><td>EHS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651009\">Existing Home Sales</a></td></tr><tr><td>ELP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651004\">Electricity Production</a></td></tr><tr><td>EMC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651006\">Employment Change</a></td></tr><tr><td>EMCI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651007\">Employment Cost Index</a></td></tr><tr><td>EMP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651005\">Employed Persons</a></td></tr><tr><td>EMR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651008\">Employment Rate</a></td></tr><tr><td>EOI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651002\">Economic Optimism Index</a></td></tr><tr><td>EP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651011\">Export Prices</a></td></tr><tr><td>ESI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651213\">ZEW Economic Sentiment Index</a></td></tr><tr><td>EWS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651003\">Economy Watchers Survey</a></td></tr><tr><td>EXP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651010\">Exports</a></td></tr><tr><td>EXPYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679671\">Exports, YoY</a></td></tr><tr><td>FAI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651016\">Fixed Asset Investment</a></td></tr><tr><td>FBI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651018\">Foreign Bond Investment</a></td></tr><tr><td>FDI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651019\">Foreign Direct Investment</a></td></tr><tr><td>FE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651015\">Fiscal Expenditure</a></td></tr><tr><td>FER</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651020\">Foreign Exchange Reserves</a></td></tr><tr><td>FI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651017\">Food Inflation, YoY</a></td></tr><tr><td>FO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651014\">Factory Orders</a></td></tr><tr><td>FOET</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651013\">Factory Orders Excluding Transportation</a></td></tr><tr><td>FPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679667\">Food Price Index</a></td></tr><tr><td>FSI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651021\">Foreign Stock Investment</a></td></tr><tr><td>FTE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651022\">Full Time Employment</a></td></tr><tr><td>FYGDPG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679672\">Full Year GDP Growth</a></td></tr><tr><td>GASP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651040\">Gasoline Prices</a></td></tr><tr><td>GBP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651050\">Government Budget</a></td></tr><tr><td>GBV</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651049\">Government Budget Value</a></td></tr><tr><td>GCI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650961\">Competitiveness Index</a></td></tr><tr><td>GCR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650962\">Competitiveness Rank</a></td></tr><tr><td>GD</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651052\">Government Debt</a></td></tr><tr><td>GDG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651051\">Government Debt To GDP</a></td></tr><tr><td>GDP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651038\">Gross Domestic Product</a></td></tr><tr><td>GDPA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651025\">GDP From Agriculture</a></td></tr><tr><td>GDPC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651026\">GDP From Construction</a></td></tr><tr><td>GDPCP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651023\">GDP Constant Prices</a></td></tr><tr><td>GDPD</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651024\">GDP Deflator</a></td></tr><tr><td>GDPGA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651033\">GDP Growth Annualized</a></td></tr><tr><td>GDPMAN</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651027\">GDP From Manufacturing</a></td></tr><tr><td>GDPMIN</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651028\">GDP From Mining</a></td></tr><tr><td>GDPPA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651029\">GDP From Public Administration</a></td></tr><tr><td>GDPPC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651035\">GDP Per Capita</a></td></tr><tr><td>GDPPCP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651036\">GDP Per Capita, PPP</a></td></tr><tr><td>GDPQQ</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651034\">GDP Growth Rate</a></td></tr><tr><td>GDPS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651030\">GDP From Services</a></td></tr><tr><td>GDPSA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651037\">GDP Sales</a></td></tr><tr><td>GDPT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651031\">GDP From Transport</a></td></tr><tr><td>GDPU</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651032\">GDP From Utilities</a></td></tr><tr><td>GDPYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651039\">GDP, YoY</a></td></tr><tr><td>GDTPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651043\">Global Dairy Trade Price Index</a></td></tr><tr><td>GFCF</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651060\">Gross Fixed Capital Formation</a></td></tr><tr><td>GNP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651061\">Gross National Product</a></td></tr><tr><td>GP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651044\">Gold Production</a></td></tr><tr><td>GPA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651053\">Government Payrolls</a></td></tr><tr><td>GPRO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651041\">Gasoline Production</a></td></tr><tr><td>GR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651054\">Government Revenues</a></td></tr><tr><td>GRES</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651045\">Gold Reserves</a></td></tr><tr><td>GS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650923\">API Gasoline Stocks</a></td></tr><tr><td>GSC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651057\">Grain Stocks Corn</a></td></tr><tr><td>GSCH</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651042\">Gasoline Stocks Change</a></td></tr><tr><td>GSG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651055\">Government Spending To GDP</a></td></tr><tr><td>GSP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651056\">Government Spending</a></td></tr><tr><td>GSS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651058\">Grain Stocks Soy</a></td></tr><tr><td>GSW</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651059\">Grain Stocks Wheat</a></td></tr><tr><td>GTB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651046\">Goods Trade Balance</a></td></tr><tr><td>HB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651067\">Hospital Beds</a></td></tr><tr><td>HDG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651068\">Households Debt To GDP</a></td></tr><tr><td>HDI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651069\">Households Debt To Income</a></td></tr><tr><td>HICP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651062\">Harmonised Index of Consumer Prices</a></td></tr><tr><td>HIRMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679673\">Harmonised Inflation Rate, MoM</a></td></tr><tr><td>HIRYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679674\">Harmonised Inflation Rate, YoY</a></td></tr><tr><td>HMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651132\">NAHB Housing Market Index</a></td></tr><tr><td>HOR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651065\">Home Ownership Rate</a></td></tr><tr><td>HOS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651063\">Heating Oil Stocks</a></td></tr><tr><td>HOSP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651066\">Hospitals</a></td></tr><tr><td>HPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651071\">House Price Index</a></td></tr><tr><td>HPIMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679678\">House Price Index, MoM</a></td></tr><tr><td>HPIYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679679\">House Price Index, YoY</a></td></tr><tr><td>HS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651064\">Home Loans</a></td></tr><tr><td>HSP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651070\">Household Spending</a></td></tr><tr><td>HST</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651072\">Housing Starts</a></td></tr><tr><td>IC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650956\">Changes In Inventories</a></td></tr><tr><td>ICUB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651073\">ICU Beds</a></td></tr><tr><td>IE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651081\">Inflation Expectations</a></td></tr><tr><td>IFOCC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651074\">IFO Assessment Of The Business Situation</a></td></tr><tr><td>IFOE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651075\">IFO Business Developments Expectations</a></td></tr><tr><td>IJC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651084\">Initial Jobless Claims</a></td></tr><tr><td>IMP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651076\">Imports</a></td></tr><tr><td>IMPYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679681\">Imports, YoY</a></td></tr><tr><td>INBR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651085\">Interbank Rate</a></td></tr><tr><td>INTR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651086\">Interest Rate</a></td></tr><tr><td>IPA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651088\">IP Addresses</a></td></tr><tr><td>IPMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651078\">Industrial Production, MoM</a></td></tr><tr><td>IPRI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651077\">Import Prices</a></td></tr><tr><td>IPYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651079\">Industrial Production, YoY</a></td></tr><tr><td>IRMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651082\">Inflation Rate, MoM</a></td></tr><tr><td>IRYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651083\">Inflation Rate, YoY</a></td></tr><tr><td>IS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651080\">Industrial Sentiment</a></td></tr><tr><td>ISP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651087\">Internet Speed</a></td></tr><tr><td>JA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651091\">Job Advertisements</a></td></tr><tr><td>JAR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651090\">Jobs To Applications Ratio</a></td></tr><tr><td>JC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650955\">Challenger Job Cuts</a></td></tr><tr><td>JC4W</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651089\">Jobless Claims, 4-Week Average</a></td></tr><tr><td>JO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651092\">Job Offers</a></td></tr><tr><td>JV</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651093\">Job Vacancies</a></td></tr><tr><td>KFMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651094\">Kansas Fed Manufacturing Index</a></td></tr><tr><td>LB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651104\">Loans To Banks</a></td></tr><tr><td>LC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651101\">Labor Costs</a></td></tr><tr><td>LEI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651102\">Leading Economic Index</a></td></tr><tr><td>LFPR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651100\">Labor Force Participation Rate</a></td></tr><tr><td>LG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651106\">Loan Growth, YoY</a></td></tr><tr><td>LIVRR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651103\">Liquidity Injections Via Reverse Repo</a></td></tr><tr><td>LMIC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651096\">LMI Logistics Managers Index Current</a></td></tr><tr><td>LMICI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651095\">LMI Inventory Costs</a></td></tr><tr><td>LMIF</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651097\">LMI Logistics Managers Index Future</a></td></tr><tr><td>LMITP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651098\">LMI Transportation Prices</a></td></tr><tr><td>LMIWP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651099\">LMI Warehouse Prices</a></td></tr><tr><td>LPS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651105\">Loans To Private Sector</a></td></tr><tr><td>LR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650953\">Central Bank Lending Rate</a></td></tr><tr><td>LTUR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651107\">Long Term Unemployment Rate</a></td></tr><tr><td>LWF</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679691\">Living Wage Family</a></td></tr><tr><td>LWI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679702\">Living Wage Individual</a></td></tr><tr><td>M0</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651125\">Money Supply M0</a></td></tr><tr><td>M1</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651126\">Money Supply M1</a></td></tr><tr><td>M2</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651127\">Money Supply M2</a></td></tr><tr><td>M3</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651128\">Money Supply M3</a></td></tr><tr><td>MA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651130\">Mortgage Approvals</a></td></tr><tr><td>MAPL</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651129\">Mortgage Applications</a></td></tr><tr><td>MCE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651119\">Michigan Consumer Expectations</a></td></tr><tr><td>MCEC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651120\">Michigan Current Economic Conditions</a></td></tr><tr><td>MD</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651117\">Medical Doctors</a></td></tr><tr><td>ME</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651122\">Military Expenditure</a></td></tr><tr><td>MGDPYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679714\">Monthly GDP, YoY</a></td></tr><tr><td>MIE1Y</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651121\">Michigan Inflation Expectations</a></td></tr><tr><td>MIE5Y</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651118\">Michigan 5 Year Inflation Expectations</a></td></tr><tr><td>MIP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651124\">Mining Production, YoY</a></td></tr><tr><td>MMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651108\">MBA Mortgage Market Index</a></td></tr><tr><td>MO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651111\">Machinery Orders</a></td></tr><tr><td>MP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651113\">Manufacturing Payrolls</a></td></tr><tr><td>MPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679666\">Meat Price Index</a></td></tr><tr><td>MPRMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651114\">Manufacturing Production, MoM</a></td></tr><tr><td>MPRYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651115\">Manufacturing Production, YoY</a></td></tr><tr><td>MR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651131\">Mortgage Rate</a></td></tr><tr><td>MRI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651109\">MBA Mortgage Refinance Index</a></td></tr><tr><td>MS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651116\">Manufacturing Sales</a></td></tr><tr><td>MTO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651112\">Machine Tool Orders</a></td></tr><tr><td>MW</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651123\">Minimum Wages</a></td></tr><tr><td>NDCGOEA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651148\">Orders For Non-defense Capital Goods Excluding Aircraft</a></td></tr><tr><td>NEGTB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651047\">Goods Trade Deficit With Non-EU Countries</a></td></tr><tr><td>NFP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651141\">Nonfarm Payrolls</a></td></tr><tr><td>NGI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679719\">Natural Gas Imports</a></td></tr><tr><td>NGIR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679721\">Natural Gas Imports from Russia</a></td></tr><tr><td>NGSC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651136\">Natural Gas Stocks Change</a></td></tr><tr><td>NHPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651135\">Nationwide House Price Index</a></td></tr><tr><td>NHS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651137\">New Home Sales</a></td></tr><tr><td>NHSMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651138\">New Home Sales, MoM</a></td></tr><tr><td>NMPMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651143\">Non-Manufacturing PMI</a></td></tr><tr><td>NO</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651139\">New Orders</a></td></tr><tr><td>NODXMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651144\">Non-Oil Domestic Exports, MoM</a></td></tr><tr><td>NODXYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651145\">Non-Oil Domestic Exports, YoY</a></td></tr><tr><td>NOE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651142\">Non-Oil Exports</a></td></tr><tr><td>NPP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651140\">Nonfarm Payrolls Private</a></td></tr><tr><td>NURS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651146\">Nurses</a></td></tr><tr><td>NYESMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651134\">NY Empire State Manufacturing Index</a></td></tr><tr><td>OE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651147\">Oil Exports</a></td></tr><tr><td>OPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679665\">Oils Price Index</a></td></tr><tr><td>PCEPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651149\">PCE Price Index</a></td></tr><tr><td>PDG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651160\">Private Debt To GDP</a></td></tr><tr><td>PFMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651158\">Philadelphia Fed Manufacturing Index</a></td></tr><tr><td>PHSIMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651152\">Pending Home Sales Index, MoM</a></td></tr><tr><td>PHSIYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651153\">Pending Home Sales Index, YoY</a></td></tr><tr><td>PI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651155\">Personal Income</a></td></tr><tr><td>PIN</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651161\">Private Investment</a></td></tr><tr><td>PIND</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651110\">MBA Purchase Index</a></td></tr><tr><td>PITR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651154\">Personal Income Tax Rate</a></td></tr><tr><td>POP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651159\">Population</a></td></tr><tr><td>PPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651165\">Producer Price Index</a></td></tr><tr><td>PPII</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651164\">Producer Price Index Input</a></td></tr><tr><td>PPIMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679724\">Producer Price Inflation, MoM</a></td></tr><tr><td>PPIYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651163\">Producer Prices Index, YoY</a></td></tr><tr><td>PRI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000650925\">API Product Imports</a></td></tr><tr><td>PROD</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651166\">Productivity</a></td></tr><tr><td>PS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651156\">Personal Savings</a></td></tr><tr><td>PSC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651162\">Private Sector Credit</a></td></tr><tr><td>PSP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651157\">Personal Spending</a></td></tr><tr><td>PTE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651151\">Part Time Employment</a></td></tr><tr><td>PUAC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651150\">Pandemic Unemployment Assistance Claims</a></td></tr><tr><td>RAM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651177\">Retirement Age Men</a></td></tr><tr><td>RAW</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651178\">Retirement Age Women</a></td></tr><tr><td>RCR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651168\">Refinery Crude Runs</a></td></tr><tr><td>REM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651169\">Remittances</a></td></tr><tr><td>RFMI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651181\">Richmond Fed Manufacturing Index</a></td></tr><tr><td>RFMSI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651182\">Richmond Fed Manufacturing Shipments Index</a></td></tr><tr><td>RFSI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651183\">Richmond Fed Services Index</a></td></tr><tr><td>RI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651167\">Redbook Index</a></td></tr><tr><td>RIEA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651171\">Retail Inventories Excluding Autos</a></td></tr><tr><td>RPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651172\">Retail Price Index</a></td></tr><tr><td>RR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651170\">Repo Rate</a></td></tr><tr><td>RRR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651180\">Reverse Repo Rate</a></td></tr><tr><td>RSEA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651173\">Retail Sales Excluding Autos</a></td></tr><tr><td>RSEF</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651174\">Retail Sales Excluding Fuel</a></td></tr><tr><td>RSMM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651175\">Retail Sales, MoM</a></td></tr><tr><td>RSYY</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651176\">Retail Sales, YoY</a></td></tr><tr><td>RTI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651179\">Reuters Tankan Index</a></td></tr><tr><td>SBSI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651187\">Small Business Sentiment Index</a></td></tr><tr><td>SFHP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651186\">Single Family Home Prices</a></td></tr><tr><td>SP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651191\">Steel Production</a></td></tr><tr><td>SPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679563\">Sugar Price Index</a></td></tr><tr><td>SS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651185\">Services Sentiment</a></td></tr><tr><td>SSR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651190\">Social Security Rate</a></td></tr><tr><td>SSRC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651188\">Social Security Rate For Companies</a></td></tr><tr><td>SSRE</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651189\">Social Security Rate For Employees</a></td></tr><tr><td>STR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651184\">Sales Tax Rate</a></td></tr><tr><td>TA</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651199\">Tourist Arrivals</a></td></tr><tr><td>TAXR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651192\">Tax Revenue</a></td></tr><tr><td>TCB</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651200\">Treasury Cash Balance</a></td></tr><tr><td>TCPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651196\">Tokyo CPI</a></td></tr><tr><td>TI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651194\">Terrorism Index</a></td></tr><tr><td>TII</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651195\">Tertiary Industry Index</a></td></tr><tr><td>TOT</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651193\">Terms Of Trade</a></td></tr><tr><td>TR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651198\">Tourism Revenues</a></td></tr><tr><td>TVS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651197\">Total Vehicle Sales</a></td></tr><tr><td>UC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651202\">Unemployment Change</a></td></tr><tr><td>UP</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651201\">Unemployed Persons</a></td></tr><tr><td>UR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651203\">Unemployment Rate</a></td></tr><tr><td>WAG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651205\">Wages</a></td></tr><tr><td>WES</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651207\">Weapons Sales</a></td></tr><tr><td>WG</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651206\">Wage Growth, YoY</a></td></tr><tr><td>WHS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679725\">Wages High Skilled</a></td></tr><tr><td>WI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651208\">Wholesale Inventories</a></td></tr><tr><td>WLS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000679727\">Wages Low Skilled</a></td></tr><tr><td>WM</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651204\">Wages In Manufacturing</a></td></tr><tr><td>WPI</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651209\">Wholesale Price Index</a></td></tr><tr><td>WS</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651210\">Wholesale Sales</a></td></tr><tr><td>YUR</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651211\">Youth Unemployment Rate</a></td></tr><tr><td>ZCC</td><td><a href=\"https://www.tradingview.com/support/solutions/43000651212\">ZEW Current Conditions</a></td></tr></tbody></table></details>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/other-timeframes-and-data", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"requestseed\"><a href=\"#requestseed\"><span>\u200b<code dir=\"auto\">request.seed()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView aggregates a vast amount of data from its many providers, including price and volume information on tradable instruments, financials, economic data, and more, which users can retrieve in Pine Script using the functions discussed in the sections above, as well as multiple built-in variables.</p>\n<p>To further expand the horizons of possible data one can analyze on TradingView, we have <a href=\"https://github.com/tradingview-pine-seeds/docs\" rel=\"nofollow\">Pine Seeds</a>, which allows users to supply custom <em>user-maintained</em> EOD data feeds via GitHub for use on TradingView charts and within Pine Script code.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The creation of <em>new</em> Pine Seeds repositories is currently <strong>unavailable</strong>. However, the data feeds from <em>existing</em> repositories are still accessible from charts and Pine scripts. The documentation <a href=\"https://github.com/tradingview-pine-seeds/docs/blob/main/README.md\" rel=\"nofollow\">here</a> provides in-depth information about Pine Seeds functionality and instructions for requesting the return of full Pine Seeds support.</p></div></aside>\n<p>To retrieve data from a Pine Seeds data feed within a script, use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a> function. Below is the function\u2019s signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">request.seed(source, symbol, expression, ignore_invalid_symbol, calc_bars_count) \u2192 series &lt;type&gt;</span></div></div></code></pre></figure></div>\n<p>The <code dir=\"auto\">source</code> parameter specifies the unique name of the user-maintained GitHub repository that contains the data feed.</p>\n<p>The <code dir=\"auto\">symbol</code> parameter represents the file name from the \u201cdata/\u201d directory of the <code dir=\"auto\">source</code> repository, excluding the \u201c.csv\u201d file extension. See <a href=\"https://github.com/tradingview-pine-seeds/docs/blob/main/data.md\" rel=\"nofollow\">this page</a> for information about the structure of the data stored in repositories.</p>\n<p>The <code dir=\"auto\">expression</code> parameter is the series to evaluate using data extracted from the requested context. It is similar to the equivalent in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>. Data feeds stored in user-maintained repos contain <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a> information, meaning the <code dir=\"auto\">expression</code> argument can use the corresponding built-in variables, including variables derived from them (e.g., <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>, etc.) to request their values from the context of the custom data.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>As with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a> duplicates the scopes necessary to evaluate its <code dir=\"auto\">expression</code> in another context, which contributes toward compilation limits and script memory demands. See the <a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page\u2019s section on <a href=\"/pine-script-docs/v5/writing/limitations/#scope-count\">scope count</a> limits for more information.</p></div></aside>\n<p>The script below visualizes sample data from the <a href=\"https://github.com/tradingview-pine-seeds/seed_crypto_santiment\" rel=\"nofollow\">seed_crypto_santiment</a> demo repository. It uses two calls to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a> to retrieve the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> values from the repository\u2019s <a href=\"https://github.com/tradingview-pine-seeds/seed_crypto_santiment/blob/master/data/BTC_SENTIMENT_POSITIVE_TOTAL.csv\" rel=\"nofollow\">BTC_SENTIMENT_POSITIVE_TOTAL</a> and <a href=\"https://github.com/tradingview-pine-seeds/seed_crypto_santiment/blob/master/data/BTC_SENTIMENT_NEGATIVE_TOTAL.csv\" rel=\"nofollow\">BTC_SENTIMENT_NEGATIVE_TOTAL</a> data feeds and <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the results on the chart as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_plot.style_stepline\">step lines</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Other-timeframes-and-data-Request-seed-1.8Jb0VyN__ZS6XAH.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pine Seeds demo\", format=format.volume)\n\n//@variable The total positive sentiment for BTC extracted from the \"seed_crypto_santiment\" repository.\nfloat positiveTotal = request.seed(\"seed_crypto_santiment\", \"BTC_SENTIMENT_POSITIVE_TOTAL\", close)\n//@variable The total negative sentiment for BTC extracted from the \"seed_crypto_santiment\" repository.\nfloat negativeTotal = request.seed(\"seed_crypto_santiment\", \"BTC_SENTIMENT_NEGATIVE_TOTAL\", close)\n\n// Plot the data.\nplot(positiveTotal, \"Positive sentiment\", color.teal, 2, plot.style_stepline)\nplot(negativeTotal, \"Negative sentiment\", color.maroon, 2, plot.style_stepline)</div>\n<p>Note that:</p>\n<ul>\n<li>This example requests data from the repository highlighted in the <a href=\"https://github.com/tradingview-pine-seeds/docs/blob/main/README.md\" rel=\"nofollow\">Pine Seeds documentation</a>. It exists solely for example purposes, and its data <em>does not</em> update on a regular basis.</li>\n<li>Unlike most other <code dir=\"auto\">request.*()</code> functions, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a> does not have a <code dir=\"auto\">gaps</code> parameter. It always returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values when no new data exists.</li>\n<li>Pine Seeds data is searchable from the chart\u2019s symbol search bar. To load a data feed on the chart, enter the <em>\u201cRepo:File\u201d pair</em>, similar to searching for an \u201cExchange:Symbol\u201d pair.</li>\n</ul>", "segment_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b:14", "segment_order": 14, "segment_type": "guide_section", "source_artifact_id": "cd0782d14b6de76926091cb7aa7db0f77dafc276c7de26a699c26b3e757eeb5b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"plots\"><a href=\"#plots\">Plots<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nfunction is the most frequently used function used to display\ninformation calculated using Pine scripts. It is versatile and can plot\ndifferent styles of lines, histograms, areas, columns (like volume\ncolumns), fills, circles or crosses.</p>\n<p>The use of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nto create fills is explained in the page on\n<a href=\"/pine-script-docs/v5/concepts/fills/\">Fills</a>.</p>\n<p>This script showcases a few different uses of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nin an overlay script:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Introduction-01.Ctk4DlIO_24M1qs.webp\" width=\"1770\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`plot()`\", \"\", true)\nplot(high, \"Blue `high` line\")\nplot(math.avg(close, open), \"Crosses in body center\", close &gt; open ? color.lime : color.purple, 6, plot.style_cross)\nplot(math.min(open, close), \"Navy step line on body low point\", color.navy, 3, plot.style_stepline)\nplot(low, \"Gray dot on `low`\", color.gray, 3, plot.style_circles)\n\ncolor VIOLET = #AA00FF\ncolor GOLD   = #CCCC00\nma = ta.alma(hl2, 40, 0.85, 6)\nvar almaColor = color.silver\nalmaColor := ma &gt; ma[2] ? GOLD : ma &lt; ma[2]  ? VIOLET : almaColor\nplot(ma, \"Two-color ALMA\", almaColor, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>The first\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall plots a 1-pixel blue line across the bar highs.</li>\n<li>The second plots crosses at the mid-point of bodies. The crosses are\ncolored lime when the bar is up and purple when it is down. The\nargument used for <code dir=\"auto\">linewidth</code> is <code dir=\"auto\">6</code> but it is not a pixel value;\njust a relative size.</li>\n<li>The third call plots a 3-pixel wide step line following the low\npoint of bodies.</li>\n<li>The fourth call plot a gray circle at the bars\u2019\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>.</li>\n<li>The last plot requires some preparation. We first define our\nbull/bear colors, calculate an <a href=\"https://www.tradingview.com/support/solutions/43000594683\">Arnaud Legoux Moving\nAverage</a>,\nthen make our color calculations. We initialize our color variable\non bar zero only, using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>.\nWe initialize it to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dsilver\">color.silver</a>,\nso on the dataset\u2019s first bars, until one of our conditions causes\nthe color to change, the line will be silver. The conditions that\nchange the color of the line require it to be higher/lower than its\nvalue two bars ago. This makes for less noisy color transitions than\nif we merely looked for a higher/lower value than the previous one.</li>\n</ul>\n<p>This script shows other uses of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nin a pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"798\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Introduction-02.CEeiodqC_Z1WHdqJ.webp\" width=\"1762\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Volume change\", format = format.volume)\n\ncolor GREEN         = #008000\ncolor GREEN_LIGHT   = color.new(GREEN, 50)\ncolor GREEN_LIGHTER = color.new(GREEN, 85)\ncolor PINK          = #FF0080\ncolor PINK_LIGHT    = color.new(PINK, 50)\ncolor PINK_LIGHTER  = color.new(PINK, 90)\n\nbool  barUp = ta.rising(close, 1)\nbool  barDn = ta.falling(close, 1)\nfloat volumeChange = ta.change(volume)\n\nvolumeColor = barUp ? GREEN_LIGHTER : barDn ? PINK_LIGHTER : color.gray\nplot(volume, \"Volume columns\", volumeColor, style = plot.style_columns)\n\nvolumeChangeColor = barUp ? volumeChange &gt; 0 ? GREEN : GREEN_LIGHT : volumeChange &gt; 0 ? PINK : PINK_LIGHT\nplot(volumeChange, \"Volume change columns\", volumeChangeColor, 12, plot.style_histogram)\n\nplot(0, \"Zero line\", color.gray)</div>\n<p>Note that:</p>\n<ul>\n<li>We are plotting normal\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nvalues as wide columns above the zero line (see the\n<code dir=\"auto\">style = plot.style_columns</code> in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall).</li>\n<li>Before plotting the columns we calculate our <code dir=\"auto\">volumeColor</code> by using\nthe values of the <code dir=\"auto\">barUp</code> and <code dir=\"auto\">barDn</code> boolean variables. They become\nrespectively <code dir=\"auto\">true</code> when the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nis higher/lower than the previous one. Note that the \u201cVolume\u201d\nbuilt-in does not use the same condition; it identifies an up bar\nwith <code dir=\"auto\">close &gt; open</code>. We use the <code dir=\"auto\">GREEN_LIGHTER</code> and <code dir=\"auto\">PINK_LIGHTER</code>\ncolors for the volume columns.</li>\n<li>Because the first plot plots columns, we do not use the <code dir=\"auto\">linewidth</code>\nparameter, as it has no effect on columns.</li>\n<li>Our script\u2019s second plot is the <strong>change</strong> in volume, which we have\ncalculated earlier using <code dir=\"auto\">ta.change(volume)</code>. This value is plotted\nas a histogram, for which the <code dir=\"auto\">linewidth</code> parameter controls the\nwidth of the column. We make this width <code dir=\"auto\">12</code> so that histogram\nelements are thinner than the columns of the first plot.\nPositive/negative <code dir=\"auto\">volumeChange</code> values plot above/below the zero\nline; no manipulation is required to achieve this effect.</li>\n<li>Before plotting the histogram of <code dir=\"auto\">volumeChange</code> values, we calculate\nits color value, which can be one of four different colors. We use\nthe bright <code dir=\"auto\">GREEN</code> or <code dir=\"auto\">PINK</code> colors when the bar is up/down AND the\nvolume has increased since the last bar (<code dir=\"auto\">volumeChange &gt; 0</code>).\nBecause <code dir=\"auto\">volumeChange</code> is positive in this case, the histogram\u2019s\nelement will be plotted above the zero line. We use the bright\n<code dir=\"auto\">GREEN_LIGHT</code> or <code dir=\"auto\">PINK_LIGHT</code> colors when the bar is up/down AND the\nvolume has NOT increased since the last bar. Because <code dir=\"auto\">volumeChange</code>\nis negative in this case, the histogram\u2019s element will be plotted\nbelow the zero line.</li>\n<li>Finally, we plot a zero line. We could just as well have used\n<code dir=\"auto\">hline(0)</code> there.</li>\n<li>We use <code dir=\"auto\">format = format.volume</code> in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ncall so that large values displayed for this script are abbreviated\nlike those of the built-in \u201cVolume\u201d indicator.</li>\n</ul>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls must always be placed in a line\u2019s first position, which entails\nthey are always in the script\u2019s global scope. They can\u2019t be placed in\nuser-defined functions or structures like\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>,\netc. Calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\n<strong>can</strong>, however, be designed to plot conditionally in two ways, which\nwe cover in the\n<a href=\"/pine-script-docs/v5/concepts/plots/#plotting-conditionally\">Plotting conditionally</a> section of this page.</p>\n<p>A script can only plot in its own visual space, whether it is in a pane\nor on the chart as an overlay. Scripts running in a pane can only\n<a href=\"/pine-script-docs/v5/concepts/bar-coloring/\">color bars</a> in the\nchart area.</p>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-parameters\"><a href=\"#plot-parameters\"><span>\u200b<code dir=\"auto\">plot()</code>\u200b parameters</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nfunction has the following signature:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plot(series, title, color, linewidth, style, trackprice, histbase, offset, join, editable, show_last, display, force_overlay) \u2192 plot</span></div></div></code></pre></figure></link></div>\n<p>The parameters of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nare:</p>\n<p><code dir=\"auto\">series</code></p>\n<p class=\"spacer-wrapper\"><spacer/>It is the only mandatory parameter. Its argument must be of \u201cseries\nint/float\u201d type. Note that because the auto-casting rules in Pine\nScript\u00ae convert in the int \ud83e\udc06 float \ud83e\udc06 bool direction, a \u201cbool\u201d type\nvariable cannot be used as is; it must be converted to an \u201cint\u201d or\na \u201cfloat\u201d for use as an argument. For example, if <code dir=\"auto\">newDay</code> is of\n\u201cbool\u201d type, then <code dir=\"auto\">newDay ? 1 : 0</code> can be used to plot 1 when the\nvariable is <code dir=\"auto\">true</code>, and zero when it is <code dir=\"auto\">false</code>.</p>\n<p><code dir=\"auto\">title</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Requires a \u201cconst string\u201d argument, so it must be known at compile\ntime. The string appears:</p>\n<ul>\n<li>In the script\u2019s scale when the \u201cChart\nsettings/Scales/Indicator Name Label\u201d field is checked.</li>\n<li>In the Data Window.</li>\n<li>In the \u201cSettings/Style\u201d tab.</li>\n<li>In the dropdown of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsource\">input.source()</a>\nfields.</li>\n<li>In the \u201cCondition\u201d field of the \u201cCreate Alert\u201d dialog box,\nwhen the script is selected.</li>\n<li>As the column header when exporting chart data to a CSV file.</li>\n</ul>\n<p><code dir=\"auto\">color</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Accepts \u201cseries color\u201d, so can be calculated on the fly, bar by\nbar. Plotting with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nas the color, or any color with a transparency of 100, is one way to\nhide plots when they are not needed.</p>\n<p><code dir=\"auto\">linewidth</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Is the plotted element\u2019s size, but it does not apply to all styles.\nWhen a line is plotted, the unit is pixels. It has no impact when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_columns\">plot.style_columns</a>\nis used.</p>\n<p><code dir=\"auto\">style</code></p>\n<p class=\"spacer-wrapper\"><spacer/>The available arguments are:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_line\">plot.style_line</a>\n(the default): It plots a continous line using the <code dir=\"auto\">linewidth</code>\nargument in pixels for its width.\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues will not plot as a line, but they will be bridged when a\nvalue that is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\ncomes in.\nNon-<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues are only bridged if they are visible on the chart.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_linebr\">plot.style_linebr</a>:\nAllows the plotting of discontinuous lines by not plotting on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues, and not joining gaps, i.e., bridging over\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_stepline\">plot.style_stepline</a>:\nPlots using a staircase effect. Transitions between changes in\nvalues are done using a vertical line drawn in middle of bars,\nas opposed to a point-to-point diagonal joining the midpoints of\nbars. Can also be used to achieve an effect similar to that of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_linebr\">plot.style_linebr</a>,\nbut only if care is taken to plot no color on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_area\">plot.style_area</a>:\nplots a line of <code dir=\"auto\">linewidth</code> width, filling the area between the\nline and the <code dir=\"auto\">histbase</code>. The <code dir=\"auto\">color</code> argument is used for both\nthe line and the fill. You can make the line a different color\nby using another\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall. Positive values are plotted above the <code dir=\"auto\">histbase</code>, negative\nvalues below it.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_area\">plot.style_areabr</a>:\nThis is similar to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_area\">plot.style_area</a>\nbut it doesn\u2019t bridge over\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues. Another difference is how the indicator\u2019s scale is\ncalculated. Only the plotted values serve in the calculation of\nthe <em>y</em> range of the script\u2019s visual space. If only high values\nsituated far away from the <code dir=\"auto\">histbase</code> are plotted, for example,\nthose values will be used to calculate the <em>y</em> scale of the\nscript\u2019s visual space. Positive values are plotted above the\n<code dir=\"auto\">histbase</code>, negative values below it.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_columns\">plot.style_columns</a>:\nPlots columns similar to those of the \u201cVolume\u201d built-in\nindicator. The <code dir=\"auto\">linewidth</code> value does <strong>not</strong> affect the width\nof the columns. Positive values are plotted above the\n<code dir=\"auto\">histbase</code>, negative values below it. Always includes the value\nof <code dir=\"auto\">histbase</code> in the <em>y</em> scale of the script\u2019s visual space.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_histogram\">plot.style_histogram</a>:\nPlots columns similar to those of the \u201cVolume\u201d built-in\nindicator, except that the <code dir=\"auto\">linewidth</code> value is used to\ndetermine the width of the histogram\u2019s bars in pixels. Note\nthat since <code dir=\"auto\">linewidth</code> requires an \u201cinput int\u201d value, the\nwidth of the histogram\u2019s bars cannot vary bar to bar. Positive\nvalues are plotted above the <code dir=\"auto\">histbase</code>, negative values below\nit. Always includes the value of <code dir=\"auto\">histbase</code> in the <em>y</em> scale of\nthe script\u2019s visual space.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_circles\">plot.style_circles</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_cross\">plot.style_cross</a>:\nThese plot a shape that is not joined across bars unless\n<code dir=\"auto\">join = true</code> is also used. For these styles, the <code dir=\"auto\">linewidth</code>\nargument becomes a relative sizing measure \u2014 its units are not\npixels.</li>\n</ul>\n<p><code dir=\"auto\">trackprice</code></p>\n<p class=\"spacer-wrapper\"><spacer/>The default value of this is <code dir=\"auto\">false</code>. When it is <code dir=\"auto\">true</code>, a dotted\nline made up of small squares will be plotted the full width of the\nscript\u2019s visual space. It is often used in conjuction with\n<code dir=\"auto\">show_last = 1, offset = -99999</code> to hide the actual plot and only\nleave the residual dotted line.</p>\n<p><code dir=\"auto\">histbase</code></p>\n<p class=\"spacer-wrapper\"><spacer/>It is the reference point used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_area\">plot.style_area</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_columns\">plot.style_columns</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_histogram\">plot.style_histogram</a>.\nIt determines the level separating positive and negative values of\nthe <code dir=\"auto\">series</code> argument. It cannot be calculated dynamically, as an\n\u201cinput int/float\u201d is required.</p>\n<p><code dir=\"auto\">offset</code></p>\n<p class=\"spacer-wrapper\"><spacer/>This allows shifting the plot in the past/future using a\nnegative/positive offset in bars. The value cannot change during the\nscript\u2019s execution.</p>\n<p><code dir=\"auto\">join</code></p>\n<p class=\"spacer-wrapper\"><spacer/>This only affect styles\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_circles\">plot.style_circles</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_cross\">plot.style_cross</a>.\nWhen <code dir=\"auto\">true</code>, the shapes are joined by a one-pixel line.</p>\n<p><code dir=\"auto\">editable</code></p>\n<p class=\"spacer-wrapper\"><spacer/>This boolean parameter controls whether or not the plot\u2019s\nproperties can be edited in the \u201cSettings/Style\u201d tab. Its default\nvalue is <code dir=\"auto\">true</code>.</p>\n<p><code dir=\"auto\">show_last</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Allows control over how many of the last bars the plotted values are\nvisible. An \u201cinput int\u201d argument is required, so it cannot be\ncalculated dynamically.</p>\n<p><code dir=\"auto\">display</code></p>\n<p class=\"spacer-wrapper\"><spacer/>The default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dall\">display.all</a>.\nWhen it is set to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dnone\">display.none</a>,\nplotted values will not affect the scale of the script\u2019s visual\nspace. The plot will be invisible and will not appear in indicator\nvalues or the Data Window. It can be useful in plots destined for\nuse as external inputs for other scripts, or for plots used with the\n<code dir=\"auto\">{{plot(\"[plot_title]\")}}</code> placeholder in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\ncalls, e.g.:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nr = ta.rsi(close, 14)\nxUp = ta.crossover(r, 50)\nplot(r, \"RSI\", display = display.none)\nalertcondition(xUp, \"xUp alert\", message = 'RSI is bullish at: {{plot(\"RSI\")}}')</div>\n<p><code dir=\"auto\">force_overlay</code></p>\n<p class=\"spacer-wrapper\"><spacer/>If <code dir=\"auto\">true</code>, the plotted results will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is <code dir=\"auto\">false</code>.</p>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotting-conditionally\"><a href=\"#plotting-conditionally\">Plotting conditionally<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls cannot be used in conditional structures such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>, but\nthey can be controlled by varying their plotted values, or their color.\nWhen no plot is required, you can either plot\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues, or plot values using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> color\nor any color with 100 transparency (which also makes it invisible).</p>\n<h3 class=\"md-heading\" id=\"value-control\"><a href=\"#value-control\">Value control<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One way to control the display of plots is to plot\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues when no plot is needed. Sometimes, values returned by functions\nsuch as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nwill return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues, when <code dir=\"auto\">gaps = barmerge.gaps_on</code> is used, for example. In both\nthese cases it is sometimes useful to plot discontinuous lines. This\nscript shows a few ways to do it:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"796\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-PlottingConditionally-01.DCGRnCbX_1NjoOk.webp\" width=\"1786\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Discontinuous plots\", \"\", true)\nbool plotValues = bar_index % 3 == 0\nplot(plotValues ? high : na, color = color.fuchsia, linewidth = 6, style = plot.style_linebr)\nplot(plotValues ? high : na)\nplot(plotValues ? math.max(open, close) : na, color = color.navy, linewidth = 6, style = plot.style_cross)\nplot(plotValues ? math.min(open, close) : na, color = color.navy, linewidth = 6, style = plot.style_circles)\nplot(plotValues ? low : na, color = plotValues ? color.green : na, linewidth = 6, style = plot.style_stepline)</div>\n<p>Note that:</p>\n<ul>\n<li>We define the condition determining when we plot using\n<code dir=\"auto\">bar_index % 3 == 0</code>, which becomes <code dir=\"auto\">true</code> when the remainder of the\ndivision of the bar index by 3 is zero. This will happen every three\nbars.</li>\n<li>In the first plot, we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_linebr\">plot.style_linebr</a>,\nwhich plots the fuchsia line on highs. It is centered on the bar\u2019s\nhorizontal midpoint.</li>\n<li>The second plot shows the result of plotting the same values, but\nwithout using special care to break the line. What\u2019s happening here\nis that the thin blue line of the plain\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall is automatically bridged over\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues (or <em>gaps</em>), so the plot does not interrupt.</li>\n<li>We then plot navy blue crosses and circles on the body tops and\nbottoms. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_circles\">plot.style_circles</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_cross\">plot.style_cross</a>\nstyle are a simple way to plot discontinuous values, e.g., for stop\nor take profit levels, or support &amp; resistance levels.</li>\n<li>The last plot in green on the bar lows is done using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_stepline\">plot.style_stepline</a>.\nNote how its segments are wider than the fuchsia line segments\nplotted with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_linebr\">plot.style_linebr</a>.\nAlso note how on the last bar, it only plots halfway until the next\nbar comes in.</li>\n<li>The plotting order of each plot is controlled by their order of\nappearance in the script. See</li>\n</ul>\n<p>This script shows how you can restrict plotting to bars after a\nuser-defined date. We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dtime\">input.time()</a>\nfunction to create an input widget allowing script users to select a\ndate and time, using Jan 1st 2021 as its default value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nstartInput = input.time(timestamp(\"2021-01-01\"))\nplot(time &gt; startInput ? close : na)</div>\n<h3 class=\"md-heading\" id=\"color-control\"><a href=\"#color-control\">Color control<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"/pine-script-docs/v5/concepts/colors/#conditional-coloring\">Conditional coloring</a> section of the page on colors discusses color control for\nplots. We\u2019ll look here at a few examples.</p>\n<p>The value of the <code dir=\"auto\">color</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncan be a constant, such as one of the built-in\n<a href=\"/pine-script-docs/v5/concepts/colors/#constant-colors\">constant colors</a> or a\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color literal</a>. In Pine Script, the qualified type of such colors is\ncalled <strong>\u201cconst color\u201d</strong> (see the\n<a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a> page). They\nare known at compile time:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nplot(close, color = color.gray)</div>\n<p>The color of a plot can also be determined using information that is\nonly known when the script begins execution on the first historical bar\nof a chart (bar zero, i.e., <code dir=\"auto\">bar_index == 0</code> or\n<code dir=\"auto\">barstate.isfirst == true</code>), as will be the case when the information\nneeded to determine a color depends on the chart the script is running\non. Here, we calculate a plot color using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtype\">syminfo.type</a>\nbuilt-in variable, which returns the type of the chart\u2019s symbol. The\nqualified type of <code dir=\"auto\">plotColor</code> in this case will be <strong>\u201csimple color\u201d</strong>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nplotColor = switch syminfo.type\n    \"stock\"     =&gt; color.purple\n    \"futures\"   =&gt; color.red\n    \"index\"     =&gt; color.gray\n    \"forex\"     =&gt; color.fuchsia\n    \"crypto\"    =&gt; color.lime\n    \"fund\"      =&gt; color.orange\n    \"dr\"        =&gt; color.aqua\n    \"cfd\"       =&gt; color.blue\nplot(close, color = plotColor)\nprintTable(txt) =&gt; var table t = table.new(position.middle_right, 1, 1), table.cell(t, 0, 0, txt, bgcolor = color.yellow)\nprintTable(syminfo.type)</div>\n<p>Plot colors can also be chosen through a script\u2019s inputs. In this case,\nthe <code dir=\"auto\">lineColorInput</code> variable is of the <strong>\u201cinput color\u201d</strong> type:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\ncolor lineColorInput  = input(#1848CC, \"Line color\")\nplot(close, color = lineColorInput)</div>\n<p>Finally, plot colors can also be <em>dynamic</em> values, i.e., calculated\nvalues that can change on each bar. These values are of the <strong>\u201cseries\ncolor\u201d</strong> type:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nplotColor = close &gt;= open ? color.lime : color.red\nplot(close, color = plotColor)</div>\n<p>When plotting pivot levels, one common requirement is to avoid plotting\nlevel transitions. Using <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">lines</a> is one alternative, but you can also use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nlike this:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"790\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-PlottingConditionally-02.Dgz5RTVC_Z2npVgz.webp\" width=\"1780\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pivot plots\", \"\", true)\npivotHigh = fixnan(ta.pivothigh(3,3))\nplot(pivotHigh, \"High pivot\", ta.change(pivotHigh) ? na : color.olive, 3)\nplotchar(ta.change(pivotHigh), \"ta.change(pivotHigh)\", \"\u2022\", location.top, size = size.small)</div>\n<p>Note that:</p>\n<ul>\n<li>We use <code dir=\"auto\">pivotHigh = fixnan(ta.pivothigh(3,3))</code> to hold our pivot\nvalues. Because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">ta.pivothigh()</a>\nonly returns a value when a new pivot is found, we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fixnan\">fixnan()</a>\nto fill the gaps with the last pivot value returned. The gaps here\nrefer to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">ta.pivothigh()</a>\nreturns when no new pivot is found.</li>\n<li>Our pivots are detected three bars after they occur because we use\nthe argument <code dir=\"auto\">3</code> for both the <code dir=\"auto\">leftbars</code> and <code dir=\"auto\">rightbars</code> parameters\nin our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">ta.pivothigh()</a>\ncall.</li>\n<li>The last plot is plotting a continuous value, but it is setting the\nplot\u2019s color to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nwhen the pivot\u2019s value changes, so the plot isn\u2019t visible then.\nBecause of this, a visible plot will only appear on the bar\nfollowing the one where we plotted using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\ncolor.</li>\n<li>The blue dot indicates when a new high pivot is detected and no plot\nis drawn between the preceding bar and that one. Note how the pivot\non the bar indicated by the arrow has just been detected in the\nrealtime bar, three bars later, and how no plot is drawn. The plot\nwill only appear on the next bar, making the plot visible <strong>four\nbars</strong> after the actual pivot.</li>\n</ul>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"levels\"><a href=\"#levels\">Levels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script has an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfunction to plot horizontal lines (see the page on\n<a href=\"/pine-script-docs/v5/concepts/levels/\">Levels</a>).\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nis useful because it has some line styles unavailable with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\nbut it also has some limitations, namely that it does not accept\n\u201cseries color\u201d, and that its <code dir=\"auto\">price</code> parameter requires an \u201cinput\nint/float\u201d, so cannot vary during the script\u2019s execution.</p>\n<p>You can plot levels with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nin a few different ways. This shows a\n<a href=\"https://www.tradingview.com/support/solutions/43000502001\">CCI</a>\nindicator with levels plotted using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"760\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Levels-01.jio4KIpw_Z2s6Io2.webp\" width=\"1774\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"CCI levels with `plot()`\")\nplot(ta.cci(close, 20))\nplot(0,  \"Zero\", color.gray, 1, plot.style_circles)\nplot(bar_index % 2 == 0 ?  100 : na,  \"100\", color.lime, 1, plot.style_linebr)\nplot(bar_index % 2 == 0 ? -100 : na, \"-100\", color.fuchsia, 1, plot.style_linebr)\nplot( 200,  \"200\", color.green, 2, trackprice = true, show_last = 1, offset = -99999)\nplot(-200, \"-200\", color.red,   2, trackprice = true, show_last = 1, offset = -99999)\nplot( 300,  \"300\", color.new(color.green, 50), 1)\nplot(-300, \"-300\", color.new(color.red, 50),   1)</div>\n<p>Note that:</p>\n<ul>\n<li>The zero level is plotted using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_circles\">plot.style_circles</a>.</li>\n<li>The 100 levels are plotted using a conditional value that only plots\nevery second bar. In order to prevent the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues from being bridged, we use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot%7Bdot%7Dstyle_linebr\">plot.style_linebr</a>\nline style.</li>\n<li>The 200 levels are plotted using <code dir=\"auto\">trackprice = true</code> to plot a\ndistinct pattern of small squares that extends the full width of the\nscript\u2019s visual space. The <code dir=\"auto\">show_last = 1</code> in there displays only\nthe last plotted value, which would appear as a one-bar straight\nline if the next trick wasn\u2019t also used: the <code dir=\"auto\">offset = -99999</code>\npushes that one-bar segment far away in the past so that it is never\nvisible.</li>\n<li>The 300 levels are plotted using a continuous line, but a lighter\ntransparency is used to make them less prominent.</li>\n</ul>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"offsets\"><a href=\"#offsets\">Offsets<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">offset</code> parameter specifies the shift used when the line is plotted\n(negative values shift in the past, positive values shift into the\nfuture). For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nplot(close, color = color.red, offset = -5)\nplot(close, color = color.lime, offset = 5)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"624\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Offsets-01.CBzf5b6H_1aubfP.webp\" width=\"1762\"/></p>\n<p>As can be seen in the screenshot, the <em>red</em> series has been shifted to\nthe left (since the argument\u2019s value is negative), while the <em>green</em>\nseries has been shifted to the right (its value is positive).</p>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-count-limit\"><a href=\"#plot-count-limit\">Plot count limit<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Each script is limited to a maximum plot count of 64. All <code dir=\"auto\">plot*()</code>\ncalls and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#func_alertcondition\">alertcondition()</a>\ncalls count in the plot count of a script. Some types of calls count for\nmore than one in the total plot count.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls count for one in the total plot count if they use a \u201cconst\ncolor\u201d argument for the <code dir=\"auto\">color</code> parameter, which means it is known at\ncompile time, e.g.:</p>\n<div class=\"pine-colorizer not-content\">plot(close, color = color.green)</div>\n<p>When they use another qualified type, such as any one of these, they\nwill count for two in the total plot count:</p>\n<div class=\"pine-colorizer not-content\">plot(close, color = syminfo.mintick &gt; 0.0001 ? color.green : color.red) //\ud83e\udc06 \"simple color\"\nplot(close, color = input.color(color.purple)) //\ud83e\udc06 \"input color\"\nplot(close, color = close &gt; open ? color.green : color.red) //\ud83e\udc06 \"series color\"\nplot(close, color = color.new(color.silver, close &gt; open ? 40 : 0)) //\ud83e\udc06 \"series color\"</div>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/plots", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"scale\"><a href=\"#scale\">Scale<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Not all values can be plotted everywhere. Your script\u2019s visual space is\nalways bound by upper and lower limits that are dynamically adjusted\nwith the values plotted. An\n<a href=\"https://www.tradingview.com/support/solutions/43000502338\">RSI</a>\nindicator will plot values between 0 and 100, which is why it is usually\ndisplayed in a distinct <em>pane</em> \u2014 or area \u2014 above or below the chart.\nIf RSI values were plotted as an overlay on the chart, the effect would\nbe to distort the symbol\u2019s normal price scale, unless it just hapenned\nto be close to RSI\u2019s 0 to 100 range. This shows an RSI signal line and\na centerline at the 50 level, with the script running in a separate\npane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"404\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Scale-01.CE6dQl_T_1UEEw.webp\" width=\"1765\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"RSI\")\nmyRSI = ta.rsi(close, 20)\nbullColor = color.from_gradient(myRSI, 50, 80, color.new(color.lime, 70), color.new(color.lime, 0))\nbearColor = color.from_gradient(myRSI, 20, 50, color.new(color.red,   0), color.new(color.red, 70))\nmyRSIColor = myRSI &gt; 50 ? bullColor : bearColor\nplot(myRSI, \"RSI\", myRSIColor, 3)\nhline(50)</div>\n<p>Note that the <em>y</em> axis of our script\u2019s visual space is automatically\nsized using the range of values plotted, i.e., the values of RSI. See\nthe page on <a href=\"/pine-script-docs/v5/concepts/colors/\">Colors</a> for more\ninformation on the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>\nfunction used in the script.</p>\n<p>If we try to plot the symbol\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues in the same space by adding the following line to our script:</p>\n<div class=\"pine-colorizer not-content\">plot(close)</div>\n<p>This is what happens:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"364\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Scale-02.D8wP6yEJ_Z1txJ3M.webp\" width=\"1764\"/></p>\n<p>The chart is on the BTCUSD symbol, whose\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices are around 40000 during this period. Plotting values in the 40000\nrange makes our RSI plots in the 0 to 100 range indiscernible. The same\ndistorted plots would occur if we placed the\n<a href=\"https://www.tradingview.com/support/solutions/43000502338\">RSI</a>\nindicator on the chart as an overlay.</p>\n<h3 class=\"md-heading\" id=\"merging-two-indicators\"><a href=\"#merging-two-indicators\">Merging two indicators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If you are planning to merge two signals in one script, first consider\nthe scale of each. It is impossible, for example, to correctly plot an\n<a href=\"https://www.tradingview.com/support/solutions/43000502338\">RSI</a> and a\n<a href=\"https://www.tradingview.com/support/solutions/43000502344\">MACD</a> in the\nsame script\u2019s visual space because RSI has a fixed range (0 to 100)\nwhile MACD doesn\u2019t, as it plots moving averages calculated on price._</p>\n<p>If both your indicators used fixed ranges, you can shift the values of\none of them so they do not overlap. We could, for example, plot both\n<a href=\"https://www.tradingview.com/support/solutions/43000502338\">RSI</a> (0 to\n100) and the <a href=\"https://www.tradingview.com/support/solutions/43000592290\">True Strength Indicator\n(TSI)</a> (-100\nto +100) by displacing one of them. Our strategy here will be to\ncompress and shift the\n<a href=\"https://www.tradingview.com/support/solutions/43000592290\">TSI</a> values\nso they plot over\n<a href=\"https://www.tradingview.com/support/solutions/43000502338\">RSI</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"512\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plots-Scale-03.D9mEXIxt_ZtI6jd.webp\" width=\"1752\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"RSI and TSI\")\nmyRSI = ta.rsi(close, 20)\nbullColor = color.from_gradient(myRSI, 50, 80, color.new(color.lime, 70), color.new(color.lime, 0))\nbearColor = color.from_gradient(myRSI, 20, 50, color.new(color.red,   0), color.new(color.red, 70))\nmyRSIColor = myRSI &gt; 50 ? bullColor : bearColor\nplot(myRSI, \"RSI\", myRSIColor, 3)\nhline(100)\nhline(50)\nhline(0)\n\n// 1. Compress TSI's range from -100/100 to -50/50.\n// 2. Shift it higher by 150, so its -50 min value becomes 100.\nmyTSI = 150 + (100 * ta.tsi(close, 13, 25) / 2)\nplot(myTSI, \"TSI\", color.blue, 2)\nplot(ta.ema(myTSI, 13), \"TSI EMA\", #FF006E)\nhline(200)\nhline(150)</div>\n<p>Note that:</p>\n<ul>\n<li>\n<p>We have added levels using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline</a>\nto situate both signals.</p>\n</li>\n<li>\n<p>In order for both signal lines to oscillate on the same range of\n100, we divide the\n<a href=\"https://www.tradingview.com/support/solutions/43000592290\">TSI</a>\nvalue by 2 because it has a 200 range (-100 to +100). We then shift\nthis value up by 150 so it oscillates between 100 and 200, making\n150 its centerline.</p>\n</li>\n<li>\n<p>The manipulations we make here are typical of the compromises\nrequired to bring two indicators with different scales in the same\nvisual space, even when their values, contrary to\n<a href=\"https://www.tradingview.com/support/solutions/43000502344\">MACD</a>,\nare bounded in a fixed range.</p>\n</li>\n</ul>", "segment_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "ae4826a97b1911d81fb69a368f91ce723bd0244f12549b5cafc3ec15bfb08250", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/repainting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/repainting\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"repainting\"><a href=\"#repainting\">Repainting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/repainting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We define repainting as: <strong>script behavior causing historical vs\nrealtime calculations or plots to behave differently</strong>.</p>\n<p>Repainting behavior is widespread and many factors can cause it.\nFollowing our definition, our estimate is that more than 95% of\nindicators in existence exhibit some form of repainting behavior.\nCommony used indicators such as MACD and RSI, for example, show\nconfirmed values on historical bars, but will fluctuate on a realtime,\nunconfirmed chart bar until it closes. Therefore, they behave\n<em>differently</em> in historical and realtime states.</p>\n<p><strong>Not all repainting behavior is inherently useless or misleading</strong>, nor\ndoes such behavior prevent knowledgeable traders from using indicators\nwith such behavior. For example, who would think of discrediting a\nvolume profile indicator solely because it updates its values on\nrealtime bars?</p>\n<p>One may encounter any of the following forms of repainting in the\nscripts they use, depending on what a script\u2019s calculations entail:</p>\n<ul>\n<li><strong>Widespread but often acceptable</strong>: A script may use values that\nupdate with realtime price changes on the unconfirmed bar. For\nexample, if one uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvariable in calculations performed on an open chart bar, its values\nwill reflect the most recent price in the bar. However, the script\nwill only commit a new data point to its historical series once the\nbar closes. Another common case is using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto fetch higher-timeframe data on realtime bars, as explained in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#historical-and-realtime-behavior\">Historical and realtime behavior</a> section of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page. As with the unconfirmed chart bar in the chart\u2019s\ntimeframe,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncan track unconfirmed values from a higher-timeframe context on\nrealtime bars, which can lead to repainting after the script\nrestarts its execution. There is often nothing wrong with using such\nscripts, provided you understand how they work. When electing to use\nsuch scripts to issue alerts or trade orders, however, it\u2019s\nimportant to understand the difference between their realtime and\nhistorical behavior and decide for yourself whether it provides\nutility for your needs.</li>\n<li><strong>Potentially misleading</strong>: Scripts that plot values into the past,\ncalculate results on realtime bars that one cannot replicate on\nhistorical bars, or relocate past events are potentially misleading.\nFor example, Ichimoku, most scripts based on pivots, most strategies\nusing <code dir=\"auto\">calc_on_every_tick = true</code>, scripts using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nwhen it behaves differently on realtime bars, many scripts using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>,\nmany scripts using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>,\nand some scripts that use <code dir=\"auto\">barstate.*</code> variables can exhibit\nmisleading repainting behavior.</li>\n<li><strong>Unacceptable</strong>: Scripts that leak future information into the\npast, strategies that execute on\n<a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard charts</a>, and scripts using realtime intrabars to generate alerts\nor orders, are examples that can produce heavily misleading\nrepainting behavior.</li>\n<li><strong>Unavoidable</strong>: Revisions of the data feed from a provider and\nvariations in the starting bar of the chart\u2019s history can cause\nrepainting behavior that may be unavoidable in a script.</li>\n</ul>\n<p>The first two types of repainting can be perfectly acceptable if:</p>\n<ol>\n<li>You are aware of the behavior.</li>\n<li>You can live with it, or</li>\n<li>You can circumvent it.</li>\n</ol>\n<p>It should now be clear that not <strong>all</strong> repainting behavior is wrong and\nrequires avoiding at all costs. In many situations, some forms of\nrepainting may be exactly what a script needs. What\u2019s important is to\nknow when repainting behavior is <strong>not</strong> acceptable for one\u2019s needs. To\navoid repainting that\u2019s not acceptable, it\u2019s important to understand\nhow a tool works or how you should design the tools you build. If you\n<a href=\"/pine-script-docs/v5/writing/publishing/\">publish</a> scripts, ensure\nyou mention any potentially misleading behavior along with the other\nlimitations of your script in the publication\u2019s description.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>We will not discuss the perils of using strategies on non-standard\ncharts, as this problem is not related to repainting. See the\n<a href=\"https://www.tradingview.com/script/q9laJNG9-Backtesting-on-Non-Standard-Charts-Caution-PineCoders-FAQ/\">Backtesting on Non-Standard Charts:\nCaution!</a>\nscript for a discussion of the subject.</p></div></aside>\n<h3 class=\"md-heading\" id=\"for-script-users\"><a href=\"#for-script-users\">For script users<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One can decide to use repainting indicators if they understand the\nbehavior, and whether that behavior meets their analysis requirements.\nDon\u2019t be one of those newcomers who slap \u201crepaint\u201d sentences on\npublished scripts in an attempt to discredit them, as doing so reveals a\nlack of foundational knowledge on the subject.</p>\n<p>Simply asking whether a script repaints is relatively meaningless, given\nthat there are forms of repainting behavior that are perfectly\nacceptable in a script. Therefore, such a question will not beget a\nmeaningful answer. One should instead ask <em>specific</em> questions about a\nscript\u2019s potential repainting behavior, such as:</p>\n<ul>\n<li>Does the script calculate/display in the same way on historical and\nrealtime bars?</li>\n<li>Do alerts from the script wait for the end of a realtime bar before\ntriggering?</li>\n<li>Do signal markers shown by the script wait for the end of a realtime\nbar before showing?</li>\n<li>Does the script plot/draw values into the past?</li>\n<li>Does the strategy use <code dir=\"auto\">calc_on_every_tick = true</code>?</li>\n<li>Do the script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncalls leak future information into the past on historical bars?</li>\n</ul>\n<p>What\u2019s important is that you understand how the tools you use work, and\nwhether their behavior is compatible with your objectives, repainting or\nnot. As you will learn if you read this page, repainting is a complex\nmatter. It has many faces and many causes. Even if you don\u2019t program in\nPine Script\u00ae, this page will help you understand the array of causes\nthat can lead to repainting, and hopefully enable more meaningful\ndiscussions with script authors.</p>\n<h3 class=\"md-heading\" id=\"for-pine-script-programmers\"><a href=\"#for-pine-script-programmers\">For Pine Script programmers<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>As discussed above, not all forms of repainting behavior must be avoided\nat all costs, nor is all potential repainting behavior necessarily\navoidable. We hope this page helps you better understand the dynamics at\nplay so that you can design your trading tools with these behaviors in\nmind. This page\u2019s content should help make you aware of common coding\nmistakes that produce misleading repainting results.</p>\n<p>Whatever your design decisions are, if you\n<a href=\"/pine-script-docs/v5/writing/publishing/\">publish</a> your script,\nexplain the script to traders so they can understand how it behaves.</p>\n<p>This page covers three broad categories of repainting causes:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/repainting/#historical-vs-realtime-calculations\">Historical vs realtime calculations</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/repainting/#plotting-in-the-past\">Plotting in the past</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/repainting/#dataset-variations\">Dataset variations</a></li>\n</ul>", "segment_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/repainting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"historical-vs-realtime-calculations\"><a href=\"#historical-vs-realtime-calculations\">Historical vs realtime calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"fluid-data-values\"><a href=\"#fluid-data-values\">Fluid data values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Historical data does not include records of intermediary price movements\non bars; only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues (OHLC).</p>\n<p>On realtime bars (bars running when the instrument\u2019s market is open),\nhowever, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues are not fixed; they can change values many times before the\nrealtime bar closes and its HLC values are fixed. They are <em>fluid</em>. This\nleads to a script sometimes working differently on historical data and\nin real time, where only the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nprice will not change during the bar.</p>\n<p>Any script using values like\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nin realtime is subject to producing calculations that may not be\nrepeatable on historical bars \u2014 thus repaint.</p>\n<p>Let\u2019s look at this simple script. It detects crosses of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalue (in the realtime bar, this corresponds to the current price of the\ninstrument) over and under an\n<a href=\"https://www.tradingview.com/support/solutions/43000592270\">EMA</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"726\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Repainting-01.B4bnEQz8_PQ677.webp\" width=\"1748\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting\", \"\", true)\nma = ta.ema(close, 5)\nxUp = ta.crossover(close, ma)\nxDn = ta.crossunder(close, ma)\nplot(ma, \"MA\", color.black, 2)\nbgcolor(xUp ? color.new(color.lime, 80) : xDn ? color.new(color.fuchsia, 80) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>The script uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nto color the background green when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\ncrosses over the EMA, and red on crosses under the EMA.</li>\n<li>The screen snapshot shows the script in realtime on a 30sec\nchart. A cross over the EMA has been detected, thus the\nbackground of the realtime bar is green.</li>\n<li>The problem here is that nothing guarantees this condition will\nhold true until the end of the realtime bar. The arrow points to\nthe timer showing that 21 seconds remain in the realtime bar,\nand anything could happen until then.</li>\n<li>We are witnessing a repainting script.</li>\n</ul>\n<p>To prevent this repainting, we must rewrite our script so that it does\nnot use values that fluctuate during the realtime bar. This will require\nusing values from a bar that has elapsed (typically the preceding bar),\nor the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nprice, which does not vary in realtime.</p>\n<p>We can achieve this in many ways. This method adds a\n<code dir=\"auto\">and barstate.isconfirmed</code> condition to our cross detections, which\nrequires the script to be executing on the bar\u2019s last iteration, when\nit closes and prices are confirmed. It is a simple way to avoid\nrepainting:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting\", \"\", true)\nma = ta.ema(close, 5)\nxUp = ta.crossover(close, ma) and barstate.isconfirmed\nxDn = ta.crossunder(close, ma) and barstate.isconfirmed\nplot(ma, \"MA\", color.black, 2)\nbgcolor(xUp ? color.new(color.lime, 80) : xDn ? color.new(color.fuchsia, 80) : na)</div>\n<p>This uses the crosses detected on the previous bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting\", \"\", true)\nma = ta.ema(close, 5)\nxUp = ta.crossover(close, ma)[1]\nxDn = ta.crossunder(close, ma)[1]\nplot(ma, \"MA\", color.black, 2)\nbgcolor(xUp ? color.new(color.lime, 80) : xDn ? color.new(color.fuchsia, 80) : na)</div>\n<p>This uses only confirmed\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nand EMA values for its calculations:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting\", \"\", true)\nma = ta.ema(close[1], 5)\nxUp = ta.crossover(close[1], ma)\nxDn = ta.crossunder(close[1], ma)\nplot(ma, \"MA\", color.black, 2)\nbgcolor(xUp ? color.new(color.lime, 80) : xDn ? color.new(color.fuchsia, 80) : na)</div>\n<p>This detects crosses between the realtime bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nand the value of the EMA from the previous bars. Notice that the EMA is\ncalculated using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\nso it repaints. We must ensure we use a confirmed value to detect\ncrosses, thus <code dir=\"auto\">ma[1]</code> in the cross detection logic:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting\", \"\", true)\nma = ta.ema(close, 5)\nxUp = ta.crossover(open, ma[1])\nxDn = ta.crossunder(open, ma[1])\nplot(ma, \"MA\", color.black, 2)\nbgcolor(xUp ? color.new(color.lime, 80) : xDn ? color.new(color.fuchsia, 80) : na)</div>\n<p><strong>All these methods have one thing in common: while they prevent\nrepainting, they will also trigger signals later than repainting\nscripts. This is an inevitable compromise if one wants to avoid\nrepainting. You can\u2019t have your cake and eat it too.</strong></p>\n<h3 class=\"md-heading\" id=\"repainting-requestsecurity-calls\"><a href=\"#repainting-requestsecurity-calls\"><span>Repainting \u200b<code dir=\"auto\">request.security()</code>\u200b calls</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfunction behaves differently on historical and realtime bars. On\nhistorical bars, it only returns <em>confirmed</em> values from its requested\ncontext, wheras it can return <em>unconfirmed</em> values on realtime bars.\nWhen the script restarts its execution, the bars that had a realtime\nstate become historical bars, and will therefore only contain the values\nit confirmed on those bars. If the values returned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nfluctuate on realtime bars without confirmation from the context, the\nscript will repaint them when it restarts its execution. See the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#historical-and-realtime-behavior\">Historical and realtime behavior</a> section of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page for a detailed explanation.</p>\n<p>One can ensure higher-timeframe data requests only return confirmed\nvalues on all bars, regardless of bar state, by offsetting the\n<code dir=\"auto\">expression</code> argument by at least one bar with the history-referencing\noperator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nand using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>\nfor the <code dir=\"auto\">lookahead</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall, as explained\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#higher-timeframe-data\">here</a>.</p>\n<p>The script below demonstrates the difference between repainting and\nnon-repainting HTF data requests. It contains two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncalls. The first function call requests\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\ndata from the <code dir=\"auto\">higherTimeframe</code> without additional specification, and\nthe second call requests the same series with an offset and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barmerge.lookahead_on\">barmerge.lookahead_on</a>.</p>\n<p>As we see on all\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">realtime</a>\nbars (the ones with an orange background), the <code dir=\"auto\">repaintingClose</code>\ncontains values that fluctuate without confirmation from the\n<code dir=\"auto\">higherTimeframe</code>, meaning it will <em>repaint</em> when the script restarts\nits execution. The <code dir=\"auto\">nonRepaintingClose</code>, on the other hand, behaves the\nsame on realtime and historical bars, i.e., it only changes its value\nwhen new, confirmed data is available:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Repainting-Repainting-request-security-calls-1.DKoD6okt_2uKSkR.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repainting vs non-repainting `request.security()` demo\", overlay = true)\n\n//@variable The timeframe to request data from.\nstring higherTimeframe = input.timeframe(\"30\", \"Timeframe\")\n\nif timeframe.in_seconds() &gt; timeframe.in_seconds(higherTimeframe)\n    runtime.error(\"The 'Timeframe' input is smaller than the chart's timeframe. Choose a higher timeframe.\")\n\n//@variable The current `close` requested from the `higherTimeframe`. Fluctuates without confirmation on realtime bars.\nfloat repaintingClose = request.security(syminfo.tickerid, higherTimeframe, close)\n//@variable The last confirmed `close` requested from the `higherTimeframe`. \n// Behaves the same on historical and realtime bars.\nfloat nonRepaintingClose = request.security(\n     syminfo.tickerid, higherTimeframe, close[1], lookahead = barmerge.lookahead_on\n )\n\n// Plot the values.\nplot(repaintingClose, \"Repainting close\", color.new(color.purple, 50), 8)\nplot(nonRepaintingClose, \"Non-repainting close\", color.teal, 3)\n// Plot a shape when a new `higherTimeframe` starts.\nplotshape(timeframe.change(higherTimeframe), \"Timeframe change marker\", shape.square, location.top, size = size.small)\n// Color the background on realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 60) : na, title = \"Realtime bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We used the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nfunction to mark the chart when there\u2019s a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">change</a>\non the <code dir=\"auto\">higherTimeframe</code>.</li>\n<li>This script produces a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime.error\">runtime\nerror</a>\nif the <code dir=\"auto\">higherTimeframe</code> is lower than the chart\u2019s timeframe.</li>\n<li>On historical bars, the <code dir=\"auto\">repaintingClose</code> has a new value at the\n<em>end</em> of each timeframe, and the <code dir=\"auto\">nonRepaintingClose</code> has a new\nvalue at the <em>start</em> of each timeframe.</li>\n</ul>\n<p>For the sake of easy reusability, below is a simple a\n<code dir=\"auto\">noRepaintSecurity()</code> function that one can apply in their scripts to\nrequest non-repainting higher-timeframe values:</p>\n<div class=\"pine-colorizer not-content\">//@function Requests non-repainting `expression` values from the context of the `symbol` and `timeframe`.\nnoRepaintSecurity(symbol, timeframe, expression) =&gt;\n    request.security(symbol, timeframe, expression[1], lookahead = barmerge.lookahead_on)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">[1]</code> offset to the series and the use of\n<code dir=\"auto\">lookahead = barmerge.lookahead_on</code> are interdependent. One\n<strong>cannot</strong> be removed without compromising the integrity of the\nfunction.</li>\n<li>Unlike a plain\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall, this wrapper function cannot accept tuple <code dir=\"auto\">expression</code>\narguments. For multi-element use cases, one can pass a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> whose fields contain the desired elements to\nrequest.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"using-requestsecurity-at-lower-timeframes\"><a href=\"#using-requestsecurity-at-lower-timeframes\"><span>Using \u200b<code dir=\"auto\">request.security()</code>\u200b at lower timeframes</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Some scripts use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nto request data from a timeframe <strong>lower</strong> than the chart\u2019s timeframe.\nThis can be useful when functions specifically designed to handle\nintrabars at lower timeframes are sent down the timeframe. When this\ntype of user-defined function requires the detection of the intrabars\u2019\nfirst bar, as most do, the technique will only work on historical bars.\nThis is due to the fact that realtime intrabars are not yet sorted. The\nimpact of this is that such scripts cannot reproduce in real time their\nbehavior on historical bars. Any logic generating alerts, for example,\nwill be flawed, and constant refreshing will be required to recalculate\nelapsed realtime bars as historical bars.</p>\n<p>When used at lower timeframes than the chart\u2019s without specialized\nfunctions able to distinguish between intrabars,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nwill only return the value of the <strong>last</strong> intrabar in the dilation of\nthe chart\u2019s bar, which is usually not useful, and will also not\nreproduce in real time, so lead to repainting.</p>\n<p>For all these reasons, unless you understand the subtleties of using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nat lower timeframes than the chart\u2019s, it is best to avoid using the\nfunction at those timeframes. Higher-quality scripts will have logic to\ndetect such anomalies and prevent the display of results which would be\ninvalid when a lower timeframe is used.</p>\n<p>For more reliable lower-timeframe data requests, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>,\nas explained in\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lower-timeframe-data\">this</a> section of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page.</p>\n<h3 class=\"md-heading\" id=\"future-leak-with-requestsecurity\"><a href=\"#future-leak-with-requestsecurity\"><span>Future leak with \u200b<code dir=\"auto\">request.security()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nis used with <code dir=\"auto\">lookahead = barmerge.lookahead_on</code> to fetch prices without\noffsetting the series by <code dir=\"auto\">[1]</code>, it will return data from the future on\nhistorical bars, which is dangerously misleading.</p>\n<p>While historical bars will magically display future prices before they\nshould be known, no lookahead is possible in realtime because the future\nthere is unknown, as it should, so no future bars exist.</p>\n<p>This is an example:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"850\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Repainting-FutureLeakWithRequestSecurity-01.B8DsNHGV_Kgu8T.webp\" width=\"1762\"/></p>\n<div class=\"pine-colorizer not-content\">// FUTURE LEAK! DO NOT USE!\n//@version=5\nindicator(\"Future leak\", \"\", true)\nfutureHigh = request.security(syminfo.tickerid, \"1D\", high, lookahead = barmerge.lookahead_on)\nplot(futureHigh)</div>\n<p>Note how the higher timeframe line is showing the timeframe\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nvalue before it occurs. The solution to avoid this effect is to use the\nfunction as demonstrated in\n<a href=\"/pine-script-docs/v5/concepts/repainting/#repainting-requestsecurity-calls\">this section</a>.</p>\n<p>Using lookahead to produce misleading results is not allowed in script\npublications, as explained in the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lookahead\">lookahead</a> section of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page. Script publications that use this misleading technique\n<strong>will be moderated</strong>.</p>\n<h3 class=\"md-heading\" id=\"varip\"><a href=\"#varip\"><span>\u200b<code dir=\"auto\">varip</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\ndeclaration mode for variables (see our section on\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#varip\">varip</a>\nfor more information) save information across realtime updates, which\ncannot be reproduced on historical bars where only OHLC information is\navailable. Such scripts may be useful in realtime, including to generate\nalerts, but their logic cannot be backtested, nor can their plots on\nhistorical bars reflect calculations that will be done in realtime.</p>\n<h3 class=\"md-heading\" id=\"bar-state-built-ins\"><a href=\"#bar-state-built-ins\">Bar state built-ins<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts using <a href=\"/pine-script-docs/v5/concepts/bar-states/\">bar states</a>\nmay or may not repaint. As we have seen in the previous section, using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>\nis actually one way to <strong>avoid</strong> repainting that <strong>will</strong> reproduce on\nhistorical bars, which are always \u201cconfirmed\u201d. Uses of other bar\nstates such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>,\nhowever, will lead to repainting. The reason is that on historical bars,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nis <code dir=\"auto\">true</code> on the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\nyet in realtime, it is <code dir=\"auto\">true</code> on the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#open\">open</a>.\nUsing the other bar state variables will usually cause some type of\nbehavioral discrepancy between historical and realtime bars.</p>\n<h3 class=\"md-heading\" id=\"timenow\"><a href=\"#timenow\"><span>\u200b<code dir=\"auto\">timenow</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>\nbuilt-in returns the current time. Scripts using this variable cannot\nshow consistent historical and realtime behavior, so they necessarily\nrepaint.</p>\n<h3 class=\"md-heading\" id=\"strategies\"><a href=\"#strategies\">Strategies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Strategies using <code dir=\"auto\">calc_on_every_tick = true</code> execute on each realtime\nupdate, while strategies run on the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nof historical bars. They will most probably not generate the same order\nexecutions, and so repaint. Note that when this happens, it also\ninvalidates backtesting results, as they are not representative of the\nstrategy\u2019s behavior in realtime.</p>", "segment_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/repainting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotting-in-the-past\"><a href=\"#plotting-in-the-past\">Plotting in the past<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts detecting pivots after 5 bars have elapsed will often go back in\nthe past to plot pivot levels or values on the actual pivot, 5 bars in\nthe past. This will often cause unsuspecting traders looking at plots on\nhistorical bars to infer that when the pivot happens in realtime, the\nsame plots will apppear on the pivot when it occurs, as opposed to when\nit is detected.</p>\n<p>Let\u2019s look at a script showing the price of high pivots by placing the\nprice in the past, 5 bars after the pivot was detected:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting in the past\", \"\", true)\npHi = ta.pivothigh(5, 5)\nif not na(pHi)\n    label.new(bar_index[5], na, str.tostring(pHi, format.mintick) + \"\\n\ud83e\udc07\", yloc = yloc.abovebar, style = label.style_none, textcolor = color.black, size = size.normal)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"736\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Repainting-PlottingInThePast-01.CdfEKXRh_VvvoS.webp\" width=\"1766\"/></p>\n<p>Note that:</p>\n<ul>\n<li>This script repaints because an elapsed realtime bar showing no\nprice may get a price placed on it if it is identified as a pivot, 5\nbars after the actual pivot occurs.</li>\n<li>The display looks great, but it can be misleading.</li>\n</ul>\n<p>The best solution to this problem when developing script for others is\nto plot <strong>without</strong> an offset by default, but give the option for script\nusers to turn on plotting in the past through inputs, so they are\nnecessarily aware of what the script is doing, e.g.:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting in the past\", \"\", true)\nplotInThePast = input(false, \"Plot in the past\")\npHi = ta.pivothigh(5, 5)\nif not na(pHi)\n    label.new(bar_index[plotInThePast ? 5 : 0], na, str.tostring(pHi, format.mintick) + \"\\n\ud83e\udc07\", yloc = yloc.abovebar, style = label.style_none, textcolor = color.black, size = size.normal)</div>", "segment_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/repainting", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"dataset-variations\"><a href=\"#dataset-variations\">Dataset variations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"starting-points\"><a href=\"#starting-points\">Starting points<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts begin executing on the chart\u2019s first historical bar, and then\nexecute on each bar sequentially, as is explained in this manual\u2019s page\non Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a>. If\nthe first bar changes, then the script will often not calculate the same\nway it did when the dataset began at a different point in time.</p>\n<p>The following factors have an impact on the quantity of bars you see on\nyour charts, and their <em>starting point</em>:</p>\n<ul>\n<li>The type of account you hold</li>\n<li>The historical data available from the data supplier</li>\n<li>The alignment requirements of the dataset, which determine its\n<em>starting point</em></li>\n</ul>\n<p>These are the account-specific bar limits:</p>\n<ul>\n<li>40000 historical bars for the Ultimate plan.</li>\n<li>25000 historical bars for the Expert plan.</li>\n<li>20000 historical bars for the Premium plan.</li>\n<li>10000 historical bars for Essential and Plus plans.</li>\n<li>5000 historical bars for other plans.</li>\n</ul>\n<p>Starting points are determined using the following rules, which depend\non the chart\u2019s timeframe:</p>\n<ul>\n<li><strong>Tick-based timeframes</strong>: return the exact number of bars based on the plan.</li>\n<li><strong>Second-based timeframes</strong>: aligns to the beginning of a day.</li>\n<li><strong>1 - 14 minutes</strong>: aligns to the beginning of a week.</li>\n<li><strong>15 - 29 minutes</strong>: aligns to the beginning of a month.</li>\n<li><strong>30 - 1439 minutes</strong>: aligns to the beginning of a year.</li>\n<li><strong>1440 minutes and higher</strong>: aligns to the first available\nhistorical data point.</li>\n</ul>\n<p>As time goes by, these factors cause your chart\u2019s history to start at\ndifferent points in time. This often has an impact on your scripts\ncalculations, because changes in calculation results in early bars can\nripple through all the other bars in the dataset. Using functions like\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dvaluewhen\">ta.valuewhen()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dbarssince\">ta.barssince()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>,\nfor example, will yield results that vary with early history.</p>\n<h3 class=\"md-heading\" id=\"revision-of-historical-data\"><a href=\"#revision-of-historical-data\">Revision of historical data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Historical and realtime bars are built using two different data feeds\nsupplied by exchanges/brokers: historical data, and realtime data. When\nrealtime bars elapse, exchanges/brokers sometimes make what are usually\nsmall adjustments to bar prices, which are then written to their\nhistorical data. When the chart is refreshed or the script is\nre-executed on those elapsed realtime bars, they will then be built and\ncalculated using the historical data, which will contain those usually\nsmall price revisions, if any have been made.</p>\n<p>Historical data may also be revised for other reasons, e.g., for stock\nsplits.</p>", "segment_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "41d0f135b647f453f52c44ed31cafcee7d98be934d63516dc579687d748c0ec0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/sessions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/sessions\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"sessions\"><a href=\"#sessions\">Sessions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/sessions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Session information is usable in three different ways in Pine Script\u00ae:</p>\n<ol>\n<li><strong>Session strings</strong> containing from-to start times and day\ninformation that can be used in functions such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a>\nto detect when bars are in a particular time period, with the option\nof limiting valid sessions to specific days. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.session()</a>\nfunction provides a way to allow script users to define session\nvalues through a script\u2019s \u201cInputs\u201d tab (see the\n<a href=\"/pine-script-docs/v5/concepts/inputs/#session-input\">Session input</a> section for more information).</li>\n<li><strong>Session states</strong> built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dismarket\">session.ismarket</a>\ncan identify which session a bar belongs to.</li>\n<li>When fetching data with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nyou can also choose to return data from <em>regular</em> sessions only or\n<em>extended</em> sessions. In this case, the definition of <strong>regular and\nextended sessions</strong> is that of the exchange. It is part of the\ninstrument\u2019s properties \u2014 not user-defined, as in point #1. This\nnotion of <em>regular</em> and <em>extended</em> sessions is the same one used in\nthe chart\u2019s interface, in the \u201cChart Settings/Symbol/Session\u201d\nfield, for example.</li>\n</ol>\n<p>The following sections cover both methods of using session information\nin Pine Script.</p>\n<p>Note that:</p>\n<ul>\n<li>Not all user accounts on TradingView have access to extended session\ninformation.</li>\n<li>There is no special \u201csession\u201d type in Pine Script. Instead,\nsession strings are of \u201cstring\u201d type but must conform to the\nsession string syntax.</li>\n</ul>", "segment_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/sessions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"session-strings\"><a href=\"#session-strings\">Session strings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"session-string-specifications\"><a href=\"#session-string-specifications\">Session string specifications<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Session strings used with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a>\nmust have a specific format. Their syntax is:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;time_period&gt;:&lt;days&gt;</span></div></div></code></pre></figure></link></div>\n<p>Where:</p>\n<p>- &lt;time_period&gt; uses times in \u201chhmm\u201d format, with \u201chh\u201d in 24-hour format, so <code dir=\"auto\">1700</code> for 5PM.</p>\n<p>The time periods are in the \u201chhmm-hhmm\u201d format, and a comma can\nseparate multiple time periods to specify combinations of discrete\nperiods.</p>\n<p>For example, - &lt;days&gt; is a set of digits from 1 to 7 that specifies on which days the session is valid.</p>\n<p>1 is Sunday, 7 is Saturday.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span><strong>The default days are</strong>: <code dir=\"auto\">1234567</code>, which is different in Pine Script\nv5 than in earlier versions where <code dir=\"auto\">23456</code> (weekdays) is used. For v5\ncode to reproduce the behavior from previous versions, it should\nexplicitly mention weekdays, as in <code dir=\"auto\">\"0930-1700:23456\"</code>.</p></div></aside>\n<p>These are examples of session strings:</p>\n<p><code dir=\"auto\">\"24x7\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>A 7-day, 24-hour session beginning at midnight.</p>\n<p><code dir=\"auto\">\"0000-0000:1234567\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Equivalent to the previous example.</p>\n<p><code dir=\"auto\">\"0000-0000\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>Equivalent to the previous two examples because the default days are\n<code dir=\"auto\">1234567</code>.</p>\n<p><code dir=\"auto\">\"0000-0000:23456\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>The same as the previous example, but only Monday to Friday.</p>\n<p><code dir=\"auto\">\"2000-1630:1234567\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>An overnight session that begins at 20:00 and ends at 16:30 the next\nday. It is valid on all days of the week.</p>\n<p><code dir=\"auto\">\"0930-1700:146\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>A session that begins at 9:30 and ends at 17:00 on Sundays (1),\nWednesdays (4), and Fridays (6).</p>\n<p><code dir=\"auto\">\"1700-1700:23456\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>An <em>overnight session</em>. The Monday session starts Sunday at 17:00\nand ends Monday at 17:00. It is valid Monday through Friday.</p>\n<p><code dir=\"auto\">\"1000-1001:26\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>A weird session that lasts only one minute on Mondays (2) and\nFridays (6).</p>\n<p><code dir=\"auto\">\"0900-1600,1700-2000\"</code></p>\n<p class=\"spacer-wrapper\"><spacer/>A session that begins at 9:00, breaks from 16:00 to 17:00, and\ncontinues until 20:00. Applies to every day of the week.</p>\n<h3 class=\"md-heading\" id=\"using-session-strings\"><a href=\"#using-session-strings\">Using session strings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Session properties defined with session strings are independent of the\nexchange-defined sessions determining when an instrument can be traded.\nProgrammers have complete liberty in creating whatever session\ndefinitions suit their purpose, which is usually to detect when bars\nbelong to specific time periods. This is accomplished in Pine Script by\nusing one of the following two signatures of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nfunction:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">time(timeframe, session, timezone) \u2192 series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">time(timeframe, session) \u2192 series int</span></div></div></code></pre></figure></div>\n<p>Here, we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nwith a <code dir=\"auto\">session</code> argument to display the market\u2019s opening\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues on an intraday chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"626\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Sessions-UsingSessionStrings-01.CCTz2lcx_1mB945.webp\" width=\"1748\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Opening high/low\", overlay = true)\n\nsessionInput = input.session(\"0930-0935\")\n\nsessionBegins(sess) =&gt;\n    t = time(\"\", sess)\n    timeframe.isintraday and (not barstate.isfirst) and na(t[1]) and not na(t)\n\nvar float hi = na\nvar float lo = na\nif sessionBegins(sessionInput)\n    hi := high\n    lo := low\n\nplot(lo, \"lo\", color.fuchsia, 2, plot.style_circles)\nplot(hi, \"hi\", color.lime,    2, plot.style_circles)</div>\n<p>Note that:</p>\n<ul>\n<li>We use a session input to allow users to specify the time they want\nto detect. We are only looking for the session\u2019s beginning time on\nbars, so we use a five-minute gap between the beginning and end time\nof our <code dir=\"auto\">\"0930-0935\"</code> default value.</li>\n<li>We create a <code dir=\"auto\">sessionBegins()</code> function to detect the beginning of a\nsession. Its <code dir=\"auto\">time(\"\", sess)</code> call uses an empty string for the\nfunction\u2019s <code dir=\"auto\">timeframe</code> parameter, which means it uses the chart\u2019s\ntimeframe, whatever that is. The function returns <code dir=\"auto\">true</code> when:\n<ul>\n<li>The chart uses an intraday timeframe (seconds or minutes).</li>\n<li>The script isn\u2019t on the chart\u2019s first bar, which we ensure with\n<code dir=\"auto\">(not barstate.isfirst)</code>. This check prevents the code from always\ndetecting a session beginning on the first bar because\n<code dir=\"auto\">na(t[1]) and not na(t)</code> is always <code dir=\"auto\">true</code> there.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\ncall has returned <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\non the previous bar because it wasn\u2019t in the session\u2019s time\nperiod, and it has returned a value that is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\non the current bar, which means the bar is <strong>in</strong> the session\u2019s\ntime period.</li>\n</ul>\n</li>\n</ul>", "segment_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/sessions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"session-states\"><a href=\"#session-states\">Session states<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Three built-in variables allow you to distinguish the type of session\nthe current bar belongs to. They are only helpful on intraday\ntimeframes:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dismarket\">session.ismarket</a>\nreturns <code dir=\"auto\">true</code> when the bar belongs to regular trading hours.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dispremarket\">session.ispremarket</a>\nreturns <code dir=\"auto\">true</code> when the bar belongs to the extended session\npreceding regular trading hours.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dispostmarket\">session.ispostmarket</a>\nreturns <code dir=\"auto\">true</code> when the bar belongs to the extended session\nfollowing regular trading hours.</li>\n</ul>", "segment_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/sessions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"using-sessions-with-requestsecurity\"><a href=\"#using-sessions-with-requestsecurity\"><span>Using sessions with \u200b<code dir=\"auto\">request.security()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When your TradingView account provides access to extended sessions, you\ncan choose to see their bars with the \u201cSettings/Symbol/Session\u201d field.\nThere are two types of sessions:</p>\n<ul>\n<li><strong>regular</strong> (which does not include pre- and post-market data), and</li>\n<li><strong>extended</strong> (which includes pre- and post-market data).</li>\n</ul>\n<p>Scripts using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nfunction to access data can return extended session data or not. This is\nan example where only regular session data is fetched:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"630\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Sessions-RegularAndExtendedSessions-01.F4CwBAHR_1pM3j5.webp\" width=\"1750\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 1: Regular Session Data\")\nregularSessionData = request.security(\"NASDAQ:AAPL\", timeframe.period, close, barmerge.gaps_on)\nplot(regularSessionData, style = plot.style_linebr)</div>\n<p>If you want the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\ncall to return extended session data, you must first use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>\nfunction to build the first argument of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\ncall:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"626\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Sessions-RegularAndExtendedSessions-02.D3WOi9Aa_2jwV7m.webp\" width=\"1750\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 2: Extended Session Data\")\nt = ticker.new(\"NASDAQ\", \"AAPL\", session.extended)\nextendedSessionData = request.security(t, timeframe.period, close, barmerge.gaps_on)\nplot(extendedSessionData, style = plot.style_linebr)</div>\n<p>Note that the previous chart\u2019s gaps in the script\u2019s plot are now\nfilled. Also, keep in mind that our example scripts do not produce the\nbackground coloring on the chart; it is due to the chart\u2019s settings\nshowing extended hours.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>\nfunction has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">ticker.new(prefix, ticker, session, adjustment) \u2192 simple string</span></div></div></code></pre></figure></div>\n<p>Where:</p>\n<ul>\n<li><code dir=\"auto\">prefix</code> is the exchange prefix, e.g., <code dir=\"auto\">\"NASDAQ\"</code></li>\n<li><code dir=\"auto\">ticker</code> is a symbol name, e.g., <code dir=\"auto\">\"AAPL\"</code></li>\n<li><code dir=\"auto\">session</code> can be <code dir=\"auto\">session.extended</code> or <code dir=\"auto\">session.regular</code>. Note that\nthis is <strong>not</strong> a session string.</li>\n<li><code dir=\"auto\">adjustment</code> adjusts prices using different criteria:\n<code dir=\"auto\">adjustment.none</code>, <code dir=\"auto\">adjustment.splits</code>, <code dir=\"auto\">adjustment.dividends</code>.</li>\n</ul>\n<p>Our first example could be rewritten as:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 1: Regular Session Data\")\nt = ticker.new(\"NASDAQ\", \"AAPL\", session.regular)\nregularSessionData = request.security(t, timeframe.period, close, barmerge.gaps_on)\nplot(regularSessionData, style = plot.style_linebr)</div>\n<p>If you want to use the same session specifications used for the chart\u2019s\nmain symbol, omit the third argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>;\nit is optional. If you want your code to declare your intention\nexplicitly, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dsession\">syminfo.session</a>\nbuilt-in variable. It holds the session type of the chart\u2019s main\nsymbol:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example 1: Regular Session Data\")\nt = ticker.new(\"NASDAQ\", \"AAPL\", syminfo.session)\nregularSessionData = request.security(t, timeframe.period, close, barmerge.gaps_on)\nplot(regularSessionData, style = plot.style_linebr)</div>", "segment_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "0b12b39476be9cdb350a99891d48674df2a3fe58cfbcd7107c29fd3d693a9cde", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/strategies\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"strategies\"><a href=\"#strategies\">Strategies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae Strategies are specialized scripts that simulate trades across historical and realtime bars, allowing users to backtest and forward test their trading systems. Strategy scripts have many of the same capabilities as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator</a> scripts, and they provide the ability to place, modify, and cancel hypothetical orders and analyze performance results.</p>\n<p>When a script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function as its declaration statement, it gains access to the <code dir=\"auto\">strategy.*</code> namespace, which features numerous functions and variables for simulating orders and retrieving essential strategy information. It also displays relevant information and simulated performance results in the dedicated <a href=\"/pine-script-docs/v5/concepts/strategies/#strategy-tester\">Strategy Tester</a> tab.</p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"a-simple-strategy-example\"><a href=\"#a-simple-strategy-example\">A simple strategy example<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The following script is a simple strategy that simulates entering a long or short position when two moving averages cross. When the <code dir=\"auto\">fastMA</code> crosses above the <code dir=\"auto\">slowMA</code>, it places a \u201cbuy\u201d market order to enter a long position. When the <code dir=\"auto\">fastMA</code> crosses below the <code dir=\"auto\">slowMA</code>, it places a \u201csell\u201d market order to enter a short position:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Simple strategy demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@variable The length of the `fastMA` and half the length of the `slowMA`.\nint lengthInput = input.int(14, \"Base length\", 2)\n\n// Calculate two moving averages with different lengths.\nfloat fastMA = ta.sma(close, lengthInput)\nfloat slowMA = ta.sma(close, lengthInput * 2)\n\n// Place an order to enter a long position when `fastMA` crosses over `slowMA`.\nif ta.crossover(fastMA, slowMA)\n    strategy.entry(\"buy\", strategy.long)\n\n// Place an order to enter a short position when `fastMA` crosses under `slowMA`.\nif ta.crossunder(fastMA, slowMA)\n    strategy.entry(\"sell\", strategy.short)\n\n// Plot the moving averages.\nplot(fastMA, \"Fast MA\", color.aqua)\nplot(slowMA, \"Slow MA\", color.orange)</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function call declares that the script is a strategy named \u201cSimple strategy demo\u201d that displays visuals on the main chart pane.</li>\n<li>The <code dir=\"auto\">margin_long</code> and <code dir=\"auto\">margin_short</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> call specify that the strategy must have 100% of a long or short trade\u2019s amount available to allow the trade. See <a href=\"/pine-script-docs/v5/concepts/strategies/#margin\">this section</a> for more information.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> function is the command that the script uses to create entry orders and reverse positions. The \u201cbuy\u201d entry order closes any short position and opens a new long position. The \u201csell\u201d entry order closes any long position and opens a new short position.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"applying-a-strategy-to-a-chart\"><a href=\"#applying-a-strategy-to-a-chart\">Applying a strategy to a chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To test a strategy, add it to the chart. Select a built-in or published strategy from the \u201cIndicators, Metrics &amp; Strategies\u201d menu, or write a custom strategy in the Pine Editor and click the \u201cAdd to chart\u201d option in the top-right corner:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"356\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Applying-a-strategy-to-a-chart-1.N4wBY_BO_Z2vpEWq.webp\" width=\"1052\"/></p>\n<p>The script plots trade markers on the main chart pane and displays simulated performance results inside the <a href=\"/pine-script-docs/v5/concepts/strategies/#strategy-tester\">Strategy Tester</a> tab:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"764\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Applying-a-strategy-to-a-chart-2.DYfs3WKI_Z1EwIMy.webp\" width=\"1336\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span></p><p>The performance results from a strategy applied to <em>non-standard charts</em> (<a href=\"https://www.tradingview.com/support/solutions/43000619436\">Heikin Ashi</a>, <a href=\"https://www.tradingview.com/support/solutions/43000502284\">Renko</a>, <a href=\"https://www.tradingview.com/support/solutions/43000502273\">Line Break</a>, <a href=\"https://www.tradingview.com/support/solutions/43000502272\">Kagi</a>, <a href=\"https://www.tradingview.com/support/solutions/43000502276\">Point &amp; Figure</a>, and <a href=\"https://www.tradingview.com/support/solutions/43000474007\">Range</a>) <strong>do not</strong> reflect actual market conditions by default. The strategy uses the chart\u2019s <strong>synthetic</strong> prices in its simulation, which do not typically represent real-world market prices, leading to unrealistic strategy results.</p><p>Therefore, we strongly recommend using <strong>standard</strong> chart types when testing strategies. Alternatively, on Heikin Ashi charts, users can simulate order fills using actual prices by enabling the <em>\u201cFill orders on standard OHLC\u201d</em> option in the strategy\u2019s <a href=\"https://www.tradingview.com/support/solutions/43000628599\">properties</a> or including <code dir=\"auto\">fill_orders_on_standard_ohlc = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement.</p><p></p></div></aside>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"strategy-tester\"><a href=\"#strategy-tester\">Strategy Tester<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <em>Strategy Tester</em> visualizes the hypothetical performance of a strategy script and displays its properties. To use it, add a script declared with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function to the chart, then open the \u201cStrategy Tester\u201d tab. If two or more strategies are on the chart, specify which one to analyze by selecting its name in the top-left corner.</p>\n<p>After the selected script executes across the chart\u2019s data, the Strategy Tester populates the following four tabs with relevant strategy information:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/concepts/strategies/#overview\">Overview</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/strategies/#performance-summary\">Performance Summary</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/strategies/#list-of-trades\">List of Trades</a></li>\n<li><a href=\"/pine-script-docs/v5/concepts/strategies/#properties\">Properties</a></li>\n</ul>\n<h3 class=\"md-heading\" id=\"overview\"><a href=\"#overview\">Overview<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/support/solutions/43000681733\">Overview</a> tab provides a quick look into a strategy\u2019s performance over a sequence of simulated trades. This tab displays essential performance metrics and a chart with three helpful plots:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/support/solutions/43000681735\">Equity</a> baseline plot visualizes the strategy\u2019s simulated equity across closed trades.</li>\n<li>The <a href=\"https://www.tradingview.com/support/solutions/43000681734\">Drawdown</a> column plot shows how far the strategy\u2019s equity fell below its peak across trades.</li>\n<li>The <a href=\"https://www.tradingview.com/support/solutions/43000681736\">Buy &amp; hold equity</a> plot shows the equity growth of a strategy that enters a single long position and holds that position throughout the testing range.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"760\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-tester-Overview-1.DOd5fCK__1TlKcc.webp\" width=\"1336\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The chart has two separate vertical scales. The \u201cEquity\u201d and \u201cBuy &amp; hold equity\u201d plots use the scale on the left, and the \u201cDrawdown\u201d plot uses the scale on the right. Users can toggle the plots and choose between absolute or percentage scales using the options at the bottom.</li>\n<li>When a user clicks on a point in this chart, the main chart scrolls to the corresponding bar where the trade closed and displays a tooltip containing the closing time.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"performance-summary\"><a href=\"#performance-summary\">Performance Summary<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/support/solutions/43000681683\">Performance Summary</a> tab presents an in-depth summary of a strategy\u2019s key performance metrics, organized into separate columns. The \u201cAll\u201d column shows performance information for all simulated trades, and the \u201cLong\u201d and \u201cShort\u201d columns show relevant metrics separately for long and short trades. This view provides more detailed insights into a strategy\u2019s overall and directional trading performance:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"768\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-tester-Performance-summary-1.BWnlmBT7_Z38011.webp\" width=\"1336\"/></p>\n<h3 class=\"md-heading\" id=\"list-of-trades\"><a href=\"#list-of-trades\">List of Trades<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/support/solutions/43000681737\">List of Trades</a> tab chronologically lists a strategy\u2019s simulated trades. Each item in the list displays vital information about a trade, including the dates and times of entry and exit orders, the names of the orders, the order prices, and the number of contracts/shares/lots/units. In addition, each item shows the trade\u2019s profit or loss and the strategy\u2019s cumulative profit, run-up, and drawdown:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"764\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-tester-List-of-trades-1.Chdio170_1pKv1G.webp\" width=\"1336\"/></p>\n<p>Note that:</p>\n<ul>\n<li>Hovering the mouse over a list item\u2019s entry or exit information reveals a \u201cScroll to bar\u201d button. Clicking that button navigates the main chart to the bar where the entry or exit occurred.</li>\n<li>The list shows each trade in <em>descending</em> order by default, with the latest trade at the top. Users can reverse this order by clicking the \u201cTrade #\u201d button above the list.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"properties\"><a href=\"#properties\">Properties<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The \u201cProperties\u201d tab provides detailed information about a strategy\u2019s configuration and the dataset that it executes across, organized into four collapsible sections:</p>\n<ul>\n<li>The \u201cDate Range\u201d section shows the range of dates that had simulated trades, and the overall available backtesting range.</li>\n<li>The \u201cSymbol Info\u201d section displays the chart\u2019s symbol, timeframe, type, point value, currency, and tick size. It also includes the chart\u2019s specified precision setting.</li>\n<li>The \u201cStrategy Inputs\u201d section lists the names and values of all the inputs available in the strategy\u2019s \u201cSettings/Inputs\u201d tab. This section only appears if the script includes <code dir=\"auto\">input*()</code> calls or specifies a nonzero <code dir=\"auto\">calc_bars_count</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement.</li>\n<li>The \u201cStrategy Properties\u201d section provides an overview of the strategy\u2019s <a href=\"https://www.tradingview.com/support/solutions/43000628599-strategy-properties/\">properties</a>, including the initial capital, account currency, order size, margin, pyramiding, commission, slippage, and other settings.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"340\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-tester-Properties-1.DEisjv-X_Z5vT3G.webp\" width=\"1336\"/></p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"broker-emulator\"><a href=\"#broker-emulator\">Broker emulator<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView uses a <em>broker emulator</em> to simulate trades while running a strategy script. Unlike in real-world trading, the emulator fills a strategy\u2019s orders exclusively using available <em>chart data</em> by default. Consequently, it executes orders on historical bars <em>after a bar closes</em>. Similarly, the earliest point that it can fill orders on realtime bars is after a new price tick. For more information about this behavior, see the <a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a> page.</p>\n<p>Because the broker emulator only uses price data from the chart by default, it makes <em>assumptions</em> about intrabar price movement when filling orders. The emulator analyzes the opening, high, low, and closing prices of chart bars to infer intrabar activity using the following logic:</p>\n<ul>\n<li>If the opening price of a bar is closer to the high than the low, the emulator assumes that the market price moved in this order: <strong>open \u2192 high \u2192 low \u2192 close</strong>.</li>\n<li>If the opening price of a bar is closer to the low than the high, the emulator assumes that the market price moved in this order: <strong>open \u2192 low \u2192 high \u2192 close</strong>.</li>\n<li>The emulator assumes <em>no gaps</em> exist between intrabars inside each chart bar, meaning it considers <em>any</em> value within a bar\u2019s high-low range as a valid price for order execution.</li>\n<li>When filling <em>price-based orders</em> (all orders except <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a>), the emulator assumes intrabars <strong>do not</strong> exist within the gap between the previous bar\u2019s close and the current bar\u2019s open. If the market price crosses an order\u2019s price during the gap between two bars, the emulator fills the order at the current bar\u2019s <em>open</em> and not at the specified price.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"528\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Broker-emulator-1.TOD5mNOt_1q8drI.webp\" width=\"1306\"/></p>\n<h3 class=\"md-heading\" id=\"bar-magnifier\"><a href=\"#bar-magnifier\">Bar magnifier<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users with Premium and higher-tier <a href=\"https://www.tradingview.com/pricing/\">plans</a> can override the broker emulator\u2019s default assumptions about intrabar prices by enabling the <a href=\"https://www.tradingview.com/support/solutions/43000669285\">Bar Magnifier</a> backtesting mode. In this mode, the emulator uses data from <em>lower timeframes</em> to obtain more granular information about price action within bars, allowing more precise order fills in the strategy\u2019s simulation.</p>\n<p>To enable the <a href=\"https://www.tradingview.com/support/solutions/43000669285\">Bar Magnifier</a> mode, include <code dir=\"auto\">use_bar_magnifier = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, or select the \u201cUsing bar magnifier\u201d option in the \u201cFill orders\u201d section of the strategy\u2019s \u201cSettings/Properties\u201d tab.</p>\n<p>The following example script illustrates how the Bar Magnifier can enhance order-fill behavior. When the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value crosses the defined <code dir=\"auto\">orderTime</code>, it creates \u201cBuy\u201d and \u201cExit\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit orders</a> at the calculated <code dir=\"auto\">entryPrice</code> and <code dir=\"auto\">exitPrice</code>. For visual reference, the script colors the background orange when it places the orders, and it draws two horizontal <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> at the order prices:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"690\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Broker-emulator-Bar-magnifier-1.coZBXeS5_Z73KL6.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Bar Magnifier Demo\", overlay = true, use_bar_magnifier = false)\n\n//@variable The UNIX timestamp to place the order at.\nint orderTime = timestamp(\"UTC\", 2023, 3, 22, 18)\n\n//@variable Is `color.orange` when `time` crosses the `orderTime`, false otherwise.\ncolor orderColor = na\n\n// Entry and exit prices.\nfloat entryPrice = hl2 - (high - low)\nfloat exitPrice  = entryPrice + (high - low) * 0.25\n\n// Entry and exit lines.\nvar line entryLine = na\nvar line exitLine  = na\n\nif ta.cross(time, orderTime)\n    // Draw new entry and exit lines.\n    entryLine := line.new(bar_index, entryPrice, bar_index + 1, entryPrice, color = color.green, width = 2)\n    exitLine  := line.new(bar_index, exitPrice, bar_index + 1, exitPrice, color = color.red, width = 2)\n\n    // Update order highlight color.\n    orderColor := color.new(color.orange, 80)\n\n    // Place limit orders at the `entryPrice` and `exitPrice`.\n    strategy.entry(\"Buy\", strategy.long, limit = entryPrice)\n    strategy.exit(\"Exit\", \"Buy\", limit = exitPrice)\n\n// Update lines while the position is open.\nelse if strategy.position_size &gt; 0.0\n    entryLine.set_x2(bar_index + 1)\n    exitLine.set_x2(bar_index + 1)\n\nbgcolor(orderColor)</div>\n<p>Because the script does not include a <code dir=\"auto\">use_bar_magnifier</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function, the broker emulator uses the default <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">assumptions</a> when filling the orders: that the bar\u2019s price moved from open to high, high to low, and then low to close. Therefore, after filling the \u201cBuy\u201d order at the price indicated by the green line, the broker emulator inferred that the market price did not go back up to touch the red line and trigger the \u201cExit\u201d order. In other words, the strategy <em>could not</em> enter and exit the position on the same bar according to the broker emulator\u2019s assumptions.</p>\n<p>After we enable the <a href=\"https://www.tradingview.com/support/solutions/43000669285\">Bar Magnifier</a> mode, the broker emulator can access <em>10-minute</em> data on the 60-minute chart instead of relying on its assumptions about hourly bars. On this timeframe, the market price <em>did</em> move back up to the \u201cExit\u201d order\u2019s price after reaching the \u201cBuy\u201d order\u2019s price in the same hour. Therefore, with the Bar Magnifier enabled in this scenario, both orders execute on the same hourly bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"688\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Broker-emulator-Bar-magnifier-2.BNRDP6RA_1rU9cu.webp\" width=\"1342\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Scripts can request a maximum of 200,000 bars from a lower timeframe. Due to this limitation, some symbols with lengthier history might <em>not</em> have intrabar coverage for their initial chart bars. Enabling the Bar Magnifier mode <strong>does not</strong> affect the trades on chart bars that do not have available intrabar data.</p></div></aside>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"orders-and-trades\"><a href=\"#orders-and-trades\">Orders and trades<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script strategies use orders to make trades and manage positions, similar to real-world trading. In this context, an <em>order</em> is an instruction that a strategy sends to the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> to perform a market action, and a <em>trade</em> is the resulting transaction after the emulator fills an order.</p>\n<p>Let\u2019s take a closer look at how strategy orders work and how they become trades. Every 20 bars, the following script creates a long <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> and draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>. It calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> on each bar from the global scope to generate a market order to close any open position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"678\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-1.CX7qCrxg_Z2raUd5.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Order execution demo\", \"My strategy\", true, margin_long = 100, margin_short = 100)\n\n//@function Displays the specified `txt` in a label at the `high` of the current bar. \ndebugLabel(string txt) =&gt; \n    label.new(\n         bar_index, high, text = txt, color=color.lime, style = label.style_label_lower_right, \n         textcolor = color.black, size = size.large\n     )\n\n//@variable Is `true` on every 20th bar, `false` otherwise.\nbool longCondition = bar_index % 20 == 0\n\n// Draw a label and place a long market order when `longCondition` occurs.\nif longCondition\n    debugLabel(\"Long entry order created\")\n    strategy.entry(\"My Long Entry Id\", strategy.long)\n\n// Place a closing market order whenever there is an open position.\nstrategy.close_all()</div>\n<p>Note that:</p>\n<ul>\n<li>Although the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> on every bar, the function only creates a new exit order when the strategy has an <em>open position</em>. If there is no open position, the function call has no effect.</li>\n</ul>\n<p>The blue arrows on the above chart show where the strategy entered a long position, and the purple arrows mark the bars where the strategy closed the position. Notice that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> drawings appear one bar <em>before</em> the entry markers, and the entry markers appear one bar <em>before</em> the closing markers. This sequence illustrates order creation and execution in action.</p>\n<p>By default, the earliest point the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills an order is on the next available price tick, because creating and filling an order on the same tick is unrealistic. Since strategies recalculate after each bar closes by default, the next available tick where the emulator fills a generated order is at the <em>open</em> of the <em>following bar</em>. For example, when the <code dir=\"auto\">longCondition</code> occurs on bar 20, the script places an entry order to fill on the next tick, which is at the open of bar 21. When the strategy recalculates its values after bar 21 closes, it places an order to close the current position on the next tick, which is at the open of bar 22.</p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"order-types\"><a href=\"#order-types\">Order types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script strategies can simulate different order types to suit specific trading system needs. The main notable order types include <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop</a>, and <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop-limit</a>.</p>\n<h3 class=\"md-heading\" id=\"market-orders\"><a href=\"#market-orders\">Market orders<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A <em>market order</em> is the simplest type of order, which most <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement commands</a> generate by default. A market order is an instruction to buy or sell a security as soon as possible, irrespective of the price. As such, the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> always executes a market order on the next available tick.</p>\n<p>The example below alternates between placing a long and short market order once every <code dir=\"auto\">lengthInput</code> bars. When the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a> is divisible by <code dir=\"auto\">2 * lengthInput</code>, the strategy generates a long market order. Otherwise, it places a short market order when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a> is divisible by the <code dir=\"auto\">lengthInput</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-types-1.XLQDthDF_Z1YB5yU.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Market order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@variable Number of bars between long and short entries.\nint lengthInput = input.int(10, \"Cycle length\", 1)\n\n//@function Displays the specified `txt` in a label on the current bar.\ndebugLabel(string txt, color lblColor) =&gt; label.new(\n     bar_index, high, text = txt, color = lblColor, textcolor = color.white, \n     style = label.style_label_lower_right, size = size.large\n )\n\n//@variable Is `true` every `2 * lengthInput` bars, `false` otherwise.\nlongCondition = bar_index % (2 * lengthInput) == 0\n//@variable Is `true` every `lengthInput` bars, `false` otherwise.\nshortCondition = bar_index % lengthInput == 0\n\n// Generate a long market order with a `color.green` label on `longCondition`.\nif longCondition\n    debugLabel(\"Long market order created\", color.green)\n    strategy.entry(\"My Long Entry Id\", strategy.long)\n// Otherwise, generate a short market order with a `color.red` label on `shortCondition`.\nelse if shortCondition\n    debugLabel(\"Short market order created\", color.red)\n    strategy.entry(\"My Short Entry Id\", strategy.short)</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> indicate the bars where the script generates the market orders. The broker emulator fills each order at the open of the following bar.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command can automatically <em>reverse</em> an open position in the opposite direction. See <a href=\"/pine-script-docs/v5/concepts/strategies/#reversing-positions\">this section</a> below for more information.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"limit-orders\"><a href=\"#limit-orders\">Limit orders<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A <em>limit order</em> is an instruction to buy or sell a security at a specific price or better (lower than specified for long orders, and higher than specified for short orders), irrespective of the time. To simulate a limit order in a strategy script, pass a <em>price</em> value to the <code dir=\"auto\">limit</code> parameter of an applicable <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement command</a>.</p>\n<p>When the market price reaches a limit order\u2019s value, or crosses it in the favorable direction, the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills the order at that value or a better price. When a strategy generates a limit order at a <em>worse</em> value than the current market price (higher for long orders and lower for short orders), the emulator fills the order without waiting for the market price to reach that value.</p>\n<p>For example, the following script generates a long limit order 800 ticks below the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> of the bar 100 bars before the last chart bar using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command. It draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> to signify the bar where the strategy created the order and a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> to visualize the order\u2019s price:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-types-2.Ma_eheTS_1mD31p.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Limit order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@function Displays text passed to `txt` and a horizontal line at `price` when called.\ndebugLabel(float price, string txt) =&gt;\n    label.new(\n         bar_index, price, text = txt, color = color.teal, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    line.new(\n         bar_index, price, bar_index + 1, price, color = color.teal, extend = extend.right, \n         style = line.style_dashed\n     )\n\n// Generate a long limit order with a label and line 100 bars before the `last_bar_index`.\nif last_bar_index - bar_index == 100\n    limitPrice = close - syminfo.mintick * 800\n    debugLabel(limitPrice, \"Long Limit order created\")\n    strategy.entry(\"Long\", strategy.long, limit = limitPrice)</div>\n<p>Notice that in the chart above, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> and the start of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> occurred several bars before the \u201cLong\u201d entry marker. The <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> could not fill the order while the market price remained <em>above</em> the <code dir=\"auto\">limitPrice</code> because such a price is a <em>worse</em> value for the long trade. After the price fell and reached the <code dir=\"auto\">limitPrice</code>, the emulator filled the order mid-bar at that value.</p>\n<p>If we set the <code dir=\"auto\">limitPrice</code> to a value <em>above</em> the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> rather than <em>below</em>, the broker emulator fills the order at the open of the following bar because the closing price is already a more <em>favorable</em> value for the long trade. Here, we set the <code dir=\"auto\">limitPrice</code> in the script to 800 ticks above the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> to demonstrate this effect:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-types-3.D5qNWPW8_Ad7IE.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Limit order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@function Displays text passed to `txt` and a horizontal line at `price` when called.\ndebugLabel(float price, string txt) =&gt;\n    label.new(\n         bar_index, price, text = txt, color = color.teal, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    line.new(\n         bar_index, price, bar_index + 1, price, color = color.teal, extend = extend.right, \n         style = line.style_dashed\n     )\n\n// Generate a long limit order with a label and line 100 bars before the `last_bar_index`.\nif last_bar_index - bar_index == 100\n    limitPrice = close + syminfo.mintick * 800\n    debugLabel(limitPrice, \"Long Limit order created\")\n    strategy.entry(\"Long\", strategy.long, limit = limitPrice)</div>\n<h3 class=\"md-heading\" id=\"stop-and-stop-limit-orders\"><a href=\"#stop-and-stop-limit-orders\">Stop and stop-limit orders<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A <em>stop order</em> is an instruction to activate a new <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market</a> or <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit</a> order when the market price reaches a specific price or a worse value (higher than specified for long orders and lower than specified for short orders). To simulate a stop order, pass a price value to the <code dir=\"auto\">stop</code> parameter of an applicable <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement command</a>.</p>\n<p>When a strategy generates a stop order at a <em>better</em> value than the current market price, it activates the subsequent order without waiting for the market price to reach that value.</p>\n<p>The following example calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place a stop order 800 ticks above the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> 100 bars before the last historical chart bar. It also draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> on the bar where it created the order and a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> to display the stop price. As we see in the chart below, the strategy entered a long position immediately after the price crossed the stop level:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-types-4.BpjXSFRL_ZCMq1X.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Stop order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@function Displays text passed to `txt` when called and shows the `price` level on the chart.\ndebugLabel(price, txt) =&gt;\n    label.new(\n         bar_index, high, text = txt, color = color.teal, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    line.new(bar_index, high, bar_index, price, style = line.style_dotted, color = color.teal)\n    line.new(\n         bar_index, price, bar_index + 1, price, color = color.teal, extend = extend.right, \n         style = line.style_dashed\n     )\n\n// Generate a long stop order with a label and lines 100 bars before the last bar.\nif last_bar_index - bar_index == 100\n    stopPrice = close + syminfo.mintick * 800\n    debugLabel(stopPrice, \"Long Stop order created\")\n    strategy.entry(\"Long\", strategy.long, stop = stopPrice)</div>\n<p>Note that:</p>\n<ul>\n<li>A basic stop order is essentially the opposite of a <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit order</a> in terms of its execution based on the market price. If we use a limit order instead of a stop order in this scenario, the order executes immediately on the next bar. See the <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">previous section</a> for an example.</li>\n</ul>\n<p>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> call includes a <code dir=\"auto\">stop</code> <em>and</em> <code dir=\"auto\">limit</code> argument, it creates a <em>stop-limit order</em>. Unlike a basic stop order, which triggers a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> when the current price is at the <code dir=\"auto\">stop</code> level or a worse value, a stop-limit order creates a subsequent <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit order</a> to fill at the specified <code dir=\"auto\">limit</code> price.</p>\n<p>Below, we modified the previous script to simulate and visualize a stop-limit order. This script version includes the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> as the <code dir=\"auto\">limit</code> price in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command. It also includes additional drawings to show where the strategy activated the subsequent limit order and to visualize the limit price.</p>\n<p>In this example chart, notice how the market price reached the limit level on the next bar after the stop-limit order was created, but the strategy did not enter a position because the limit order was not yet active. After price later reached the stop level, the strategy placed the limit order, and then the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> filled it after the market price dropped back down to the limit level:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-types-5.CduO1Nxw_2mnPeh.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Stop-Limit order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@function Displays text passed to `txt` when called and shows the `price` level on the chart.\ndebugLabel(price, txt, lblColor, lineWidth = 1) =&gt;\n    label.new(\n         bar_index, high, text = txt, color = lblColor, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    line.new(bar_index, close, bar_index, price, style = line.style_dotted, color = lblColor, width = lineWidth)\n    line.new(\n         bar_index, price, bar_index + 1, price, color = lblColor, extend = extend.right, \n         style = line.style_dashed, width = lineWidth\n     )\n\nvar float stopPrice  = na\nvar float limitPrice = na\n\n// Generate a long stop-limit order with a label and lines 100 bars before the last bar.\nif last_bar_index - bar_index == 100\n    stopPrice  := close + syminfo.mintick * 800\n    limitPrice := low\n    debugLabel(limitPrice, \"\", color.gray)\n    debugLabel(stopPrice, \"Long Stop-Limit order created\", color.teal)\n    strategy.entry(\"Long\", strategy.long, stop = stopPrice, limit = limitPrice)\n\n// Draw a line and label when the strategy activates the limit order.\nif high &gt;= stopPrice\n    debugLabel(limitPrice, \"Limit order activated\", color.green, 2)\n    stopPrice := na</div>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"order-placement-and-cancellation\"><a href=\"#order-placement-and-cancellation\">Order placement and cancellation<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">strategy.*</code> namespace features the following five functions that simulate the placement of orders, known as <em>order placement commands</em>: <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyentry\">strategy.entry()</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyorder\">strategy.order()</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyexit\">strategy.exit()</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyclose-and-strategyclose_all\">strategy.close()</a>, and <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyclose-and-strategyclose_all\">strategy.close_all()</a>.</p>\n<p>Additionally, the namespace includes the following two functions that cancel pending orders, known as <em>order cancellation commands</em>: <a href=\"/pine-script-docs/v5/concepts/strategies/#strategycancel-and-strategycancel_all\">strategy.cancel()</a> and <a href=\"/pine-script-docs/v5/concepts/strategies/#strategycancel-and-strategycancel_all\">strategy.cancel_all()</a>.</p>\n<p>The segments below explain these commands, their unique characteristics, and how to use them.</p>\n<h3 class=\"md-heading\" id=\"strategyentry\"><a href=\"#strategyentry\"><span>\u200b<code dir=\"auto\">strategy.entry()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command generates <em>entry orders</em>. Its unique features help simplify opening and managing positions. This order placement command generates <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a> by default. It can also create <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop</a>, and <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop-limit</a> orders with the <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> parameters, as explained in the <a href=\"/pine-script-docs/v5/concepts/strategies/#order-types\">Order types</a> section above.</p>\n<h4 class=\"md-heading\" id=\"reversing-positions\"><a href=\"#reversing-positions\">Reversing positions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>One of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command\u2019s unique features is its ability to <em>reverse</em> an open position automatically. By default, when an order from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> executes while there is an open position in the opposite direction, the command automatically <em>adds</em> the position\u2019s size to the new order\u2019s size. The added quantity allows the order to close the current position and open a new position for the specified number of contracts/lots/shares/units in the new direction.</p>\n<p>For instance, if a strategy has an open position of 15 shares in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.long\">strategy.long</a> direction and calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place a new <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.short\">strategy.short</a> direction, the size of the resulting transaction is the specified entry size <strong>plus</strong> 15 shares.</p>\n<p>The example below demonstrates this behavior in action. When the <code dir=\"auto\">buyCondition</code> occurs once every 100 bars, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> with <code dir=\"auto\">qty = 15</code> to open a long position of 15 shares. Otherwise, when the <code dir=\"auto\">sellCondition</code> occurs on every 50th bar, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> with <code dir=\"auto\">qty = 5</code> to enter a new short position of five shares. The script also highlights the chart\u2019s background on the bars where the <code dir=\"auto\">buyCondition</code> and <code dir=\"auto\">sellCondition</code> occurs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"548\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-entry-Reversing-positions-1.Cs1E9UJf_Z2uYkzU.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Reversing positions demo\", overlay = true)\n\n//@variable Is `true` on every 100th bar, `false` otherwise.\nbool buyCondition = bar_index % 100 == 0\n//@variable Is `true` on every 50th bar, `false` otherwise.\nbool sellCondition = bar_index % 50 == 0\n \nif buyCondition\n    // Place a \"buy\" market order to close the short position and enter a long position of 15 shares.\n    strategy.entry(\"buy\", strategy.long, qty = 15)\nelse if sellCondition\n    // Place a \"sell\" market order to close the long position and enter a short position of 5 shares.\n    strategy.entry(\"sell\", strategy.short, qty = 5)\n\n// Highlight the background when the `buyCondition` or `sellCondition` occurs.\nbgcolor(buyCondition  ? color.new(color.blue, 90) : sellCondition ? color.new(color.red, 90) : na)</div>\n<p>The trade markers on the chart show the <em>transaction size</em>, not the size of the resulting position. The markers above show that the transaction size was <em>20 shares</em> on each order fill rather than 15 for long orders and five for short orders. Since <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> reverses a position in the opposite direction by default, each call <em>adds</em> the open position\u2019s size (e.g., 15 for long entries) to the new order\u2019s size (e.g., 5 for short entries), resulting in a quantity of 20 shares on each entry after the first. Although each of these <em>transactions</em> is 20 shares in size, the resulting positions are 5 shares for each short entry and 15 for each long entry.</p>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.risk.allow_entry_in\">strategy.risk.allow_entry_in()</a> function <em>overrides</em> the allowed direction for the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command. When a script specifies a trade direction with this <a href=\"/pine-script-docs/v5/concepts/strategies/#risk-management\">risk management</a> command, orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> in the opposite direction <em>close</em> the open position without allowing a reversal.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"pyramiding\"><a href=\"#pyramiding\">Pyramiding<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Another unique characteristic of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command is its connection to a strategy\u2019s <em>pyramiding</em> property. Pyramiding specifies the maximum number of <em>successive entries</em> a strategy allows in the same direction. Users can set this property by including a <code dir=\"auto\">pyramiding</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement or by adjusting the \u201cPyramiding\u201d input in the script\u2019s \u201cSettings/Properties\u201d tab. The default value is 1, meaning the strategy can open new positions but cannot add to them using orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls.</p>\n<p>The following example uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> when the <code dir=\"auto\">entryCondition</code> occurs on every 25th bar. The direction of the orders changes once every 100 bars, meaning every 100-bar cycle includes <em>four</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls with the same direction. For visual reference of the conditions, the script highlights the chart\u2019s background based on the current direction each time the <code dir=\"auto\">entryCondition</code> occurs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"546\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-entry-Pyramiding-1.C1FbnbUX_ZfqMKR.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Pyramiding demo\", overlay = true)\n\n//@variable Represents the direction of the entry orders. A value of 1 means long, and -1 means short.\nvar int direction = 1\n//@variable Is `true` once every 25 bars, `false` otherwise.\nbool entryCondition = bar_index % 25 == 0\n\n// Change the `direction` on every 100th bar.\nif bar_index % 100 == 0\n    direction *= -1\n\n// Place a market order based on the current `direction` when the `entryCondition` occurs.\nif entryCondition\n    strategy.entry(\"Entry\", direction == 1 ? strategy.long : strategy.short)\n\n//@variable When the `entryCondition` occurs, is a blue color if the `direction` is 1 and a red color otherwise.\ncolor bgColor = entryCondition ? (direction == 1 ? color.new(color.blue, 80) : color.new(color.red, 80)) : na\n// Highlight the chart's background using the `bgColor`. \nbgcolor(bgColor, title = \"Background highlight\")</div>\n<p>Notice that although the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> with the same direction four times within each 100-bar cycle, the strategy <em>does not</em> execute an order after every call. It cannot open more than one trade per position with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> because it uses the default pyramiding value of 1.</p>\n<p>Below, we modified the script by including <code dir=\"auto\">pyramiding = 4</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement to allow up to four successive trades in the same direction. Now, an order fill occurs after every <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"548\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-entry-Pyramiding-2.CgMebGaG_1nl0aE.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Pyramiding demo\", overlay = true, pyramiding = 4)\n\n//@variable Represents the direction of the entry orders. A value of 1 means long, and -1 means short.\nvar int direction = 1\n//@variable Is `true` once every 25 bars, `false` otherwise.\nbool entryCondition = bar_index % 25 == 0\n\n// Change the `direction` on every 100th bar.\nif bar_index % 100 == 0\n    direction *= -1\n\n// Place a market order based on the current `direction` when the `entryCondition` occurs.\nif entryCondition\n    strategy.entry(\"Entry\", direction == 1 ? strategy.long : strategy.short)\n\n//@variable When the `entryCondition` occurs, is a blue color if the `direction` is 1 and a red color otherwise.\ncolor bgColor = entryCondition ? (direction == 1 ? color.new(color.blue, 80) : color.new(color.red, 80)) : na\n// Highlight the chart's background using the `bgColor`. \nbgcolor(bgColor, title = \"Background highlight\")</div>\n<h3 class=\"md-heading\" id=\"strategyorder\"><a href=\"#strategyorder\"><span>\u200b<code dir=\"auto\">strategy.order()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> command generates a <em>basic order</em>. Unlike other order placement commands, which can behave differently based on a strategy\u2019s properties and open trades, this command <em>ignores</em> most properties, such as <a href=\"/pine-script-docs/v5/concepts/strategies/#pyramiding\">pyramiding</a>, and simply creates orders with the specified parameters. This command generates <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a> by default. It can also create <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop</a>, and <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop-limit</a> orders with the <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> parameters. Orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> can open new positions and modify or close existing ones. When a strategy executes an order from this command, the resulting market position is the <em>net sum</em> of the open position and the filled order quantity.</p>\n<p>The following script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls to enter and exit positions. The strategy places a long <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> for 15 units once every 100 bars. On every 25th bar that is not a multiple of 100, it places a short market order for five units. The script highlights the background to signify where the strategy places a \u201cbuy\u201d or \u201csell\u201d order:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-3.DSecmQ5U_Zz9mM4.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"`strategy.order()` demo\", overlay = true)\n\n//@variable Is `true` on every 100th bar, `false` otherwise.\nbool buyCondition = bar_index % 100 == 0\n//@variable Is `true` on every 25th bar, `false` otherwise.\nbool sellCondition = bar_index % 25 == 0\n\nif buyCondition\n    // Place a \"buy\" market order to trade 15 units in the long direction. \n    strategy.order(\"buy\", strategy.long, qty = 15)\nelse if sellCondition\n    // Place a \"sell\" market order to trade 5 units in the short direction.\n    strategy.order(\"sell\", strategy.short, qty = 5)\n\n// Highlight the background when the `buyCondition` or `sellCondition` occurs.\nbgcolor(buyCondition ? color.new(color.blue, 90) : sellCondition ? color.new(color.red, 90) : na)</div>\n<p>This particular strategy never simulates a <em>short position</em>. Unlike the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> <em>does not</em> automatically <a href=\"/pine-script-docs/v5/concepts/strategies/#reversing-positions\">reverse</a> open positions. After filling a \u201cbuy\u201d order, the strategy has an open long position of 15 units. The three subsequent \u201csell\u201d orders <em>reduce</em> the position by five units each, and 15 - 5 * 3 = 0. In other words, the strategy opens a long position on every 100th bar and gradually reduces the size to 0 using three successive short orders. If we used <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> instead of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> command in this example, the strategy would alternate between entering long and short positions of 15 and five units, respectively.</p>\n<h3 class=\"md-heading\" id=\"strategyexit\"><a href=\"#strategyexit\"><span>\u200b<code dir=\"auto\">strategy.exit()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command generates <em>exit orders</em>. It features several unique behaviors that link to open trades, helping to simplify closing market positions and creating multi-level exits with <em>take-profit</em>, <em>stop-loss</em>, and <em>trailing stop</em> orders.</p>\n<p>Unlike other order placement commands, which can generate a <em>single order</em> per call, each call to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> can produce <em>more than one</em> type of exit order, depending on its arguments. Additionally, a single call to this command can generate exit orders for <em>multiple entries</em>, depending on the specified <code dir=\"auto\">from_entry</code> value and the strategy\u2019s open trades.</p>\n<h4 class=\"md-heading\" id=\"take-profit-and-stop-loss\"><a href=\"#take-profit-and-stop-loss\">Take-profit and stop-loss<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The most basic use of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command is the placement of <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit orders</a> to trigger exits after earning enough money (take-profit), <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop orders</a> to trigger exits after losing too much money (stop-loss), or both (bracket).</p>\n<p>Four parameters determine the prices of the command\u2019s take-profit and stop-loss orders:</p>\n<ul>\n<li>The <code dir=\"auto\">profit</code> and <code dir=\"auto\">loss</code> parameters accept <em>relative</em> values representing the number of <em>ticks</em> the market price must move away from the entry price to trigger an exit.</li>\n<li>The <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> parameters accept <em>absolute</em> values representing the specific <em>prices</em> that trigger an exit when the market price reaches them.</li>\n</ul>\n<p>The absolute parameters of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command <em>supersede</em> the relative ones. If a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call contains <code dir=\"auto\">profit</code> and <code dir=\"auto\">limit</code> arguments, it creates a take-profit order at the <code dir=\"auto\">limit</code> price and ignores the <code dir=\"auto\">profit</code> value. Likewise, if the call includes <code dir=\"auto\">loss</code> and <code dir=\"auto\">stop</code> arguments, the command ignores the <code dir=\"auto\">loss</code> value and places a stop-loss order at the <code dir=\"auto\">stop</code> price.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command\u2019s <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> parameters <strong>do not</strong> behave the same as the <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> parameters of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> commands. Calling <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> with <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> arguments creates a single <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop-limit order</a>. In contrast, calling <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> with both arguments creates <strong>two exit orders</strong>: a take-profit order at the <code dir=\"auto\">limit</code> price and a stop-loss order at the <code dir=\"auto\">stop</code> price.</p></div></aside>\n<p>The following example creates exit bracket (take-profit and stop-loss) orders with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command. When the <code dir=\"auto\">buyCondition</code> occurs, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place a \u201cbuy\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a>. It also calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> with <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> arguments to create a take-profit order at the <code dir=\"auto\">limitPrice</code> and a stop-loss order at the <code dir=\"auto\">stopPrice</code>. The script plots the <code dir=\"auto\">limitPrice</code> and <code dir=\"auto\">stopPrice</code> values on the chart to visualize the exit order prices:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"514\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-exit-Take-profit-and-stop-loss-1.B0PJXuvg_17dSOG.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Take-profit and stop-loss demo\", overlay = true)\n\n//@variable Is `true` on every 100th bar.\nbool buyCondition = bar_index % 100 == 0\n\n//@variable The current take-profit order price. \nvar float takeProfit = na\n//@variable The current stop-loss order price.\nvar float stopLoss = na\n\nif buyCondition\n    // Update the `takeProfit` and `stopLoss` values.\n    if strategy.opentrades == 0\n        takeProfit := close * 1.01\n        stopLoss   := close * 0.99\n    // Place a long market order. \n    strategy.entry(\"buy\", strategy.long)\n    // Place a take-profit order at the `takeProfit` price and a stop-loss order at the `stopLoss` price.\n    strategy.exit(\"exit\", \"buy\", limit = takeProfit, stop = stopLoss)\n\n// Set `takeProfit` and `stopLoss` to `na` when the position closes.\nif ta.change(strategy.closedtrades) &gt; 0\n    takeProfit := na\n    stopLoss   := na\n\n// Plot the `takeProfit` and `stopLoss` values.\nplot(takeProfit, \"TP\", color.green, style = plot.style_circles)\nplot(stopLoss, \"SL\", color.red, style = plot.style_circles)</div>\n<p>Note that:</p>\n<ul>\n<li>We did not specify a <code dir=\"auto\">qty</code> or <code dir=\"auto\">qty_percent</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call, meaning it creates orders to exit 100% of the \u201cbuy\u201d order\u2019s size.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command\u2019s exit orders <em>do not</em> necessarily execute at the specified prices. Strategies can fill <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit orders</a> at <em>better</em> prices and <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop orders</a> at <em>worse</em> prices, depending on the range of values available to the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a>.</li>\n</ul>\n<p>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call includes a <code dir=\"auto\">from_entry</code> argument, the resulting exit orders only apply to existing entry orders that have a matching ID. If the specified <code dir=\"auto\">from_entry</code> value does not match the ID of any entry in the current position, the command <em>does not</em> create any exit orders.</p>\n<p>Below, we changed the <code dir=\"auto\">from_entry</code> argument of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call in our previous script to \u201cbuy2\u201d, which means it creates exit orders only for open trades with the \u201cbuy2\u201d entry ID. This version does not place <em>any</em> exit orders because it does not create any entry orders with the \u201cbuy2\u201d ID:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Invalid `from_entry` ID demo\", overlay = true)\n\n//@variable Is `true` on every 100th bar.\nbool buyCondition = bar_index % 100 == 0\n\n//@variable The current take-profit order price. \nvar float takeProfit = na\n//@variable The current stop-loss order price.\nvar float stopLoss = na\n\nif buyCondition\n    // Update the `takeProfit` and `stopLoss` values before entering the trade.\n    if strategy.opentrades == 0\n        takeProfit := close * 1.01\n        stopLoss   := close * 0.99\n    // Place a long market order. \n    strategy.entry(\"buy\", strategy.long)\n    // Attempt to place an exit bracket for \"buy2\" entries.\n    // This call has no effect because the strategy does not create entry orders with the \"buy2\" ID.\n    strategy.exit(\"exit\", \"buy2\", limit = takeProfit, stop = stopLoss)\n\n// Set `takeProfit` and `stopLoss` to `na` when the position closes.\nif ta.change(strategy.closedtrades) &gt; 0\n    takeProfit := na\n    stopLoss   := na\n\n// Plot the `takeProfit` and `stopLoss` values.\nplot(takeProfit, \"TP\", color.green, style = plot.style_circles)\nplot(stopLoss, \"SL\", color.red, style = plot.style_circles)</div>\n<p>Note that:</p>\n<ul>\n<li>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call <em>does not</em> include a <code dir=\"auto\">from_entry</code> argument, it creates exit orders for <em>all</em> the position\u2019s open trades, regardless of their entry IDs. See the <a href=\"/pine-script-docs/v5/concepts/strategies/#exits-for-multiple-entries\">Exits for multiple entries</a> section below to learn more.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"partial-and-multi-level-exits\"><a href=\"#partial-and-multi-level-exits\">Partial and multi-level exits<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Strategies can use more than one call to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> to create successive <em>partial</em> exit orders for the same entry ID, helping to simplify the formation of multi-level exit strategies. To use multiple <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> calls to exit from an open trade, include a <code dir=\"auto\">qty</code> or <code dir=\"auto\">qty_percent</code> argument in each call to specify how much of the traded quantity to close. If the sum of the exit order sizes exceeds the open position, the strategy automatically <em>reduces</em> their sizes to match the position.</p>\n<p>Note that:</p>\n<ul>\n<li>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call includes <em>both</em> <code dir=\"auto\">qty</code> and <code dir=\"auto\">qty_percent</code> arguments, the command uses the <code dir=\"auto\">qty</code> value to size the order and ignores the <code dir=\"auto\">qty_percent</code> value.</li>\n</ul>\n<p>This example demonstrates a simple strategy that creates two partial exit order brackets for an entry ID. When the <code dir=\"auto\">buyCondition</code> occurs, the script places a \u201cbuy\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> for two shares with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>, and it creates \u201cexit1\u201d and \u201cexit2\u201d brackets using two calls to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>. The first call uses a <code dir=\"auto\">qty</code> of 1, and the second uses a <code dir=\"auto\">qty</code> of 3:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-5.WJU0XPdU_11c8yK.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Multi-level exit demo\", \"test\", overlay = true)\n\n//@variable Is `true` on every 100th bar.\nbool buyCondition = bar_index % 100 == 0\n\n//@variable The take-profit price for \"exit1\" orders.\nvar float takeProfit1 = na\n//@variable The take-profit price for \"exit2\" orders.\nvar float takeProfit2 = na\n//@variable The stop-loss price for \"exit1\" orders.\nvar float stopLoss1 = na\n//@variable The stop-loss price for \"exit2\" orders.\nvar float stopLoss2 = na\n\nif buyCondition\n    // Update the `takeProfit*` and `stopLoss*` values before entering the trade.\n    if strategy.opentrades == 0\n        takeProfit1 := close * 1.01\n        takeProfit2 := close * 1.02\n        stopLoss1   := close * 0.99\n        stopLoss2   := close * 0.98\n    // Place a long market order with a `qty` of 2.\n    strategy.entry(\"buy\", strategy.long, qty = 2)\n    // Place an \"exit1\" bracket with a `qty` of 1 at the `takeProfit1` and `stopLoss1` prices.\n    strategy.exit(\"exit1\", \"buy\", limit = takeProfit1, stop = stopLoss1, qty = 1)\n    // Place an \"exit2\" bracket with a `qty` of 3 at the `takeProfit1` and `stopLoss1` prices.\n    // The size of the resulting orders decreases to match the open position. \n    strategy.exit(\"exit2\", \"buy\", limit = takeProfit2, stop = stopLoss2, qty = 3)\n\n// Set `takeProfit1` and `stopLoss1` to `na` when the price touches either value. \nif high &gt;= takeProfit1 or low &lt;= stopLoss1\n    takeProfit1 := na\n    stopLoss1   := na\n// Set `takeProfit2` and `stopLoss2` to `na` when the price touches either value. \nif high &gt;= takeProfit2 or low &lt;= stopLoss2\n    takeProfit2 := na\n    stopLoss2   := na\n\n// Plot the `takeProfit*` and `stopLoss*` values.\nplot(takeProfit1, \"TP1\", color.green, style = plot.style_circles)\nplot(takeProfit2, \"TP2\", color.green, style = plot.style_circles)\nplot(stopLoss1, \"SL1\", color.red, style = plot.style_circles)\nplot(stopLoss2, \"SL2\", color.red, style = plot.style_circles)</div>\n<p>As we can see from the trade markers on the chart above, the strategy first executes the \u201cexit1\u201d take-profit or stop-loss order to reduce the open position by one share, leaving one remaining share in the position. However, we specified a size of <em>three shares</em> for the \u201cexit2\u201d order bracket, which exceeds the remaining position. Rather than using this specified quantity, the strategy automatically <em>reduces</em> the \u201cexit2\u201d orders to one share, allowing it to close the position successfully.</p>\n<p>Note that:</p>\n<ul>\n<li>This strategy only fills <strong>one</strong> exit order from the \u201cexit1\u201d bracket, <strong>not both</strong>. When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call generates more than one exit order type for an entry ID, the strategy fills the only the <em>first</em> triggered one and automatically cancels the others.</li>\n<li>The strategy reduced the \u201cexit2\u201d orders because all orders from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> calls automatically belong to the same <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.reduce\">strategy.oca.reduce</a> group by default. Learn more about <a href=\"/pine-script-docs/v5/concepts/strategies/#oca-groups\">OCA groups</a> below.</li>\n</ul>\n<p>When creating multiple exit orders with <em>different</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> calls, it\u2019s crucial to note that the orders from each call <em>reserve</em> a portion of the open position. The orders from one <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call <em>cannot</em> exit the portion of a position that a previous call already reserved.</p>\n<p>For example, this script generates a \u201cbuy\u201d entry order for 20 shares with a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> call and \u201climit\u201d and \u201cstop\u201d exit orders with two separate calls to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> 100 bars before the last chart bar. We specified a quantity of 19 shares for the \u201climit\u201d order and 20 for the \u201cstop\u201d order:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Reserved exit demo\", \"test\", overlay = true)\n\n//@variable The price of the \"limit\" exit order.\nvar float limitPrice = na\n//@variable The price of the \"stop\" exit order.\nvar float stopPrice = na\n//@variable Is `true` 100 bars before the last chart bar. \nbool longCondition = last_bar_index - bar_index == 100\n\nif longCondition\n    // Update the `limitPrice` and `stopPrice`. \n    limitPrice := close * 1.01\n    stopPrice  := close * 0.99\n    // Place a long market order for 20 shares.\n    strategy.entry(\"buy\", strategy.long, 20)\n    // Create a take-profit order for 19 shares at the `limitPrice`.\n    strategy.exit(\"limit\", limit = limitPrice, qty = 19)\n    // Create a stop-loss order at the `stopPrice`. Although this call specifies a `qty` of 20, the previous \n    // `strategy.exit()` call reserved 19, meaning this call creates an exit order for only 1 share. \n    strategy.exit(\"stop\", stop = stopPrice, qty = 20)\n\n//@variable Is `true` when the strategy has an open position, `false` otherwise.\nbool showPlot = strategy.opentrades == 1\n\n// Plot the `limitPrice` and `stopPrice` when `showPlot` is `true`.\nplot(showPlot ? limitPrice : na, \"Limit (take-profit) price\", color.green, 2, plot.style_linebr)\nplot(showPlot ? stopPrice : na, \"Stop (stop-loss) price\", color.red, 2, plot.style_linebr)</div>\n<p>Users unfamiliar with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command\u2019s unique behaviors might expect this strategy to close the entire market position if it fills the \u201cstop\u201d order before the \u201climit\u201d order. However, the trade markers in the chart below show that the \u201cstop\u201d order only reduces the position by <strong>one share</strong>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call for the \u201climit\u201d order executes first in the code, reserving 19 shares of the open position for closure with that order. This reservation leaves only one share available for the \u201cstop\u201d order to close, regardless of when the strategy fills it:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-5a.CVJyBloz_1r0nNp.webp\" width=\"1342\"/></p>\n<h4 class=\"md-heading\" id=\"trailing-stops\"><a href=\"#trailing-stops\">Trailing stops<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>One of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command\u2019s key features is its ability to create <em>trailing stops</em>, i.e., stop-loss orders that trail behind the market price by a specified amount whenever it moves to a better value in the favorable direction (upward for long positions and downward for short positions).</p>\n<p>This type of exit order has two components: an <em>activation level</em> and a <em>trail offset</em>. The activation level is the value the market price must cross to activate the trailing stop calculation, and the trail offset is the distance the activated stop follows behind the price as it reaches successively better values.</p>\n<p>Three <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> parameters determine the activation level and trail offset of a trailing stop order:</p>\n<ul>\n<li>The <code dir=\"auto\">trail_price</code> parameter accepts an <em>absolute price value</em> for the trailing stop\u2019s activation level.</li>\n<li>The <code dir=\"auto\">trail_points</code> parameter is an alternative way to specify the activation level. Its value represents the <em>tick distance</em> from the entry price required to activate the trailing stop.</li>\n<li>The <code dir=\"auto\">trail_offset</code> parameter accepts a value representing the order\u2019s trail offset as a specified number of ticks.</li>\n</ul>\n<p>To create and activate a trailing stop order, a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call must include a <code dir=\"auto\">trail_offset</code> argument and either a <code dir=\"auto\">trail_price</code> or <code dir=\"auto\">trail_points</code> argument. If the call contains both <code dir=\"auto\">trail_price</code> and <code dir=\"auto\">trail_points</code> arguments, the command uses the <code dir=\"auto\">trail_price</code> for the activation level and ignores the <code dir=\"auto\">trail_points</code> value.</p>\n<p>The example below demonstrates how a trailing stop order works. The strategy places a \u201cLong\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command 100 bars before the last chart bar, and it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> with <code dir=\"auto\">trail_price</code> and <code dir=\"auto\">trail_offset</code> arguments on the following bar to create a trailing stop. The script uses <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>, and a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a> to visualize the trailing stop\u2019s behavior.</p>\n<p>The green <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> on the chart shows the level the market price must reach to activate the trailing stop order. After the price crosses this level, the script uses a blue <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a> to display the trailing stop\u2019s price. Each time the market price reaches a new high after activating the trailing stop, the stop\u2019s price <em>increases</em> to maintain a distance of <code dir=\"auto\">trailOffsetInput</code> ticks from the best value. The exit order <em>does not</em> change its price level when the market price decreases or does not reach a new high. Eventually, the market price crosses below the trailing stop, triggering an exit:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-5b.BprhxxcZ_1ujAyE.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Trailing stop order demo\", overlay = true, margin_long = 100, margin_short = 100)\n\n//@variable The distance from the entry price required to activate the trailing stop.\nint activationOffsetInput = input.int(1000, \"Activation level offset (in ticks)\", 0)\n//@variable The distance the stop follows behind the highest `high` after activation.\nint trailOffsetInput = input.int(2000, \"Trailing stop offset (in ticks)\", 0)\n\n//@variable Draws a label and an optional line at the specified `price`.\ndebugDrawings(float price, string txt, color drawingColor, bool drawLine = false) =&gt;\n    // Draw a label showing the `txt` at the `price` on the current bar.\n    label.new(\n         bar_index, price, text = txt, color = drawingColor, textcolor = color.white,\n         style = label.style_label_lower_right, size = size.large\n     )\n    // Draw a horizontal line at the `price` starting from the current bar when `drawLine` is `true`.\n    line.new(\n         bar_index, price, bar_index + 1, price, color = drawingColor, extend = extend.right,\n         style = line.style_dashed\n     )\n\n//@variable The level required to activate the trailing stop.\nvar float activationLevel = na\n//@variable The price of the trailing stop.\nvar float trailingStop = na\n//@variable The value that the trailing stop would have if it was currently active. \nfloat theoreticalStopPrice = high - trailOffsetInput * syminfo.mintick\n\n// Place a long market order 100 bars before the last historical bar.\nif last_bar_index - bar_index == 100\n    strategy.entry(\"Long\", strategy.long)\n\n// Create and visualize the exit order on the next bar.\nif last_bar_index - bar_index == 99\n    // Update the `activationLevel`.\n    activationLevel := open + syminfo.mintick * activationOffsetInput\n    // Create the trailing stop order that activates at the `activationLevel` and trails behind the `high` by \n    // `trailOffsetInput` ticks. \n    strategy.exit(\n         \"Trailing Stop\", from_entry = \"Long\", trail_price = activationLevel, \n         trail_offset = trailOffsetInput\n     )\n    // Create drawings to signify the activation level.\n    debugDrawings(activationLevel, \"Trailing Stop Activation Level\", color.green, true)\n\n// Visualize the trailing stop's levels while the position is open.\nif strategy.opentrades == 1\n    // Create drawings when the `high` is above the `activationLevel` for the first time to show when the \n    // stop activates. \n    if na(trailingStop) and high &gt; activationLevel\n        debugDrawings(activationLevel, \"Activation level crossed\", color.green)\n        trailingStop := theoreticalStopPrice\n        debugDrawings(trailingStop, \"Trailing Stop Activated\", color.blue)\n    // Otherwise, update the `trailingStop` value when the `theoreticalStopPrice` reaches a new high.\n    else if theoreticalStopPrice &gt; trailingStop\n        trailingStop := theoreticalStopPrice\n\n// Plot the `trailingStop` value to visualize the trailing price movement. \nplot(trailingStop, \"Trailing Stop\")</div>\n<h4 class=\"md-heading\" id=\"exits-for-multiple-entries\"><a href=\"#exits-for-multiple-entries\">Exits for multiple entries<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>A single call to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> command can generate exit orders for <em>more than one</em> entry in an open position, depending on the call\u2019s <code dir=\"auto\">from_entry</code> value.</p>\n<p>If an open position consists of two or more entries with the same ID, a single call to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> with that ID as the <code dir=\"auto\">from_entry</code> argument places exit orders for each corresponding entry created before or on the bar where the call occurs.</p>\n<p>For example, this script periodically calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> on two consecutive bars to enter and add to a long position. Both calls use \u201cbuy\u201d as the <code dir=\"auto\">id</code> argument. After creating the second entry, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> once with \u201cbuy\u201d as its <code dir=\"auto\">from_entry</code> argument to generate separate exit orders for each entry with that ID. When the market price reaches the <code dir=\"auto\">takeProfit</code> or <code dir=\"auto\">stopLoss</code> value, the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills <em>two</em> exit orders and closes the position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"500\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-exit-Exits-for-multiple-entries-1.C_bGhVv6_nC4KI.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exits for entries with the same ID demo\", overlay = true, pyramiding = 2)\n\n//@variable Take-profit price for exit commands.\nvar float takeProfit = na\n//@variable Stop-loss price for exit commands.\nvar float stopLoss   = na\n\n//@variable Is `true` on two consecutive bars in 100-bar cycles. \nbool buyCondition = math.min(bar_index % 100, math.max(bar_index - 1, 0) % 100) == 0\n\nif buyCondition\n    // Place a \"buy\" market order to enter a trade. \n    strategy.entry(\"buy\", strategy.long)\n    // Calculate exits on the second order.\n    if strategy.opentrades == 1\n        // Update the `takeProfit` and `stopLoss`.\n        takeProfit := close * 1.01\n        stopLoss   := close * 0.99\n        // Place exit orders for both \"buy\" entries.\n        strategy.exit(\"exit\", \"buy\", limit = takeProfit, stop = stopLoss)\n\n// Set `takeProfit` and `stopLoss` to `na` when both trades close.\nif ta.change(strategy.closedtrades) == 2\n    takeProfit := na\n    stopLoss   := na\n\n// Plot the `takeProfit` and `stopLoss` values.\nplot(takeProfit, \"TP\", color.green, style = plot.style_circles)\nplot(stopLoss, \"SL\", color.red, style = plot.style_circles)</div>\n<p>A single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call can also generate exit orders for <em>all</em> entries in an open position, irrespective of entry ID, when it does not include a <code dir=\"auto\">from_entry</code> argument.</p>\n<p>Here, we changed the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> instance in the above script to create an entry order with a distinct ID on each call, and we removed the <code dir=\"auto\">from_entry</code> argument from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call. Since this version does not specify which entries the exit orders apply to, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call creates orders for <em>every</em> entry in the position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"500\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-exit-Exits-for-multiple-entries-2.DSQJLM3u_ZFSCp8.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exits for entries with different IDs demo\", overlay = true, pyramiding = 2)\n\n//@variable Take-profit price for exit commands.\nvar float takeProfit = na\n//@variable Stop-loss price for exit commands.\nvar float stopLoss   = na\n\n//@variable Is `true` on two consecutive bars in 100-bar cycles. \nbool buyCondition = math.min(bar_index % 100, math.max(bar_index - 1, 0) % 100) == 0\n\nif buyCondition\n    // Place a long market order with a unique ID. \n    strategy.entry(\"buy\" + str.tostring(strategy.opentrades + strategy.closedtrades), strategy.long)\n    // Calculate exits on the second order.\n    if strategy.opentrades == 1\n        // Update the `takeProfit` and `stopLoss`.\n        takeProfit := close * 1.01\n        stopLoss   := close * 0.99\n        // Place exit orders for ALL entries in the position, irrespective of ID.\n        strategy.exit(\"exit\", limit = takeProfit, stop = stopLoss)\n\n// Set `takeProfit` and `stopLoss` to `na` when both trades close.\nif ta.change(strategy.closedtrades) == 2\n    takeProfit := na\n    stopLoss   := na\n\n// Plot the `takeProfit` and `stopLoss` values.\nplot(takeProfit, \"TP\", color.green, style = plot.style_circles)\nplot(stopLoss, \"SL\", color.red, style = plot.style_circles)</div>\n<p>It\u2019s crucial to note that a call to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> without a <code dir=\"auto\">from_entry</code> argument <em>persists</em> and creates exit orders for all open trades in a position, regardless of <em>when</em> the entries occur. This behavior can affect strategies that manage positions with multiple entries or exits. When a strategy has an open position and calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> on any bar without specifying a <code dir=\"auto\">from_entry</code> ID, it generates exit orders for each entry created <em>before</em> or on that bar, and it continues to generate exit orders for subsequent entries <em>after</em> that bar until the position closes.</p>\n<p>Let\u2019s explore this behavior and how it works. The script below creates a long entry order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> on each bar within a user-specified time range, and it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> without a <code dir=\"auto\">from_entry</code> argument on <em>one bar</em> within that range to generate exit orders for <em>every</em> entry in the open position. The exit command uses a <code dir=\"auto\">loss</code> value of 0, which means an exit order fills each time the market price is not above an entry order\u2019s price.</p>\n<p>The script prompts users to select three points before it starts its calculations. The first point specifies when order creation begins, the second determines when the single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call occurs, and the third specifies when order creation stops:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"530\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-exit-Exits-for-multiple-entries-3.BViNenRl_RP72m.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exit persist demo\", overlay = true, margin_long = 100, margin_short = 100, pyramiding = 100)\n\n//@variable The time when order creation starts. \nint entryStartTime = input.time(0, \"Start time for entries\", confirm = true)\n//@variable The time when the `strategy.exit()` call occurs.\nint exitCallTime = input.time(0, \"Exit call time\", confirm = true)\n//@variable The time when order creation stops.\nint entryEndTime = input.time(0, \"End time for entries\", confirm = true)\n\n// Raise a runtime error if incorrect timestamps are chosen.\nif exitCallTime &lt;= entryStartTime or entryEndTime &lt;= exitCallTime or entryEndTime &lt;= entryStartTime\n    runtime.error(\"The input timestamps must follow this condition: entryStartTime &lt; exitCallTime &lt; entryEndTime.\")\n\n// Create variables to track entry and exit conditions. \nbool entriesStart = time == entryStartTime\nbool callExit     = time == exitCallTime\nbool entriesEnd   = time == entryEndTime\nbool callEntry    = time &gt;= entryStartTime and time &lt; entryEndTime\n\n// Place a long entry order when `callEntry` is `true`.\nif callEntry\n    strategy.entry(\"Entry\", strategy.long)\n\n// Call `strategy.exit()` when `callExit` is `true`, which occurs only once.\n// This single call persists and creates exit orders for EVERY entry in the position because it does not \n// specify a `from_entry` ID.\nif callExit\n    strategy.exit(\"Exit\", loss = 0)\n\n// Draw labels to signify when entries start, when the `strategy.exit()` call occurs, and when order placement stops.\nswitch \n    entriesStart =&gt; label.new(\n         bar_index, high, \"Start placing entry orders.\", color = color.green, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    callExit =&gt; label.new(\n         bar_index, high, \"Call `strategy.exit()` once.\", color = color.blue, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    entriesEnd =&gt; label.new(\n         bar_index, high, \"Stop placing orders.\", color = color.red, textcolor = color.white, \n         style = label.style_label_lower_left, size = size.large\n     )\n\n// Create a line and label to visualize the lowest entry price, i.e., the price required to close the position.\nvar line lowestLine = line.new(\n     entryStartTime + 1000, na, entryEndTime, na, xloc.bar_time, extend.right, color.orange, width = 2\n )\nvar lowestLabel = label.new(\n     entryStartTime + 1000, na, \"Lowest entry price\", color = color.orange, \n     style = label.style_label_upper_right, xloc = xloc.bar_time\n )\n\n// Update the price values of the `lowestLine` and `lowestLabel` after each new entry.\nif callEntry[1]\n    var float lowestPrice = strategy.opentrades.entry_price(0)\n    float entryPrice = strategy.opentrades.entry_price(strategy.opentrades - 1)\n    if not na(entryPrice)\n        lowestPrice := math.min(lowestPrice, entryPrice)\n        lowestLine.set_y1(lowestPrice)\n        lowestLine.set_y2(lowestPrice)\n        lowestLabel.set_y(lowestPrice)\n\n// Highlight the background when `entriesStart`, `callExit`, and `entriesEnd` occurs.\nbgcolor(entriesStart ? color.new(color.green, 80) : na, title = \"Entries start highlight\")\nbgcolor(callExit ? color.new(color.blue, 80) : na, title = \"Exit call highlight\")\nbgcolor(entriesEnd ? color.new(color.red, 80) : na, title = \"Entries end highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We included <code dir=\"auto\">pyramiding = 100</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, which allows the position to have up to 100 open entries from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>.</li>\n<li>The script uses <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a> to signify when order placement starts and stops and when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call occurs.</li>\n<li>The script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> and a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> at the lowest <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_price\">entry price</a> to show the value the market price must reach to close the position.</li>\n</ul>\n<p>We can observe the unique <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> behavior in this example by comparing the code itself with the script\u2019s chart outputs. The script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> <em>one time</em>, only on the bar with the blue <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>. However, this single call placed exit orders for every entry <strong>before</strong> or on that bar and continued placing exit orders for all entries <strong>after</strong> that bar. This behavior occurs because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> has no way to determine when to stop placing orders if it does not link to entries with a specific ID. In this case, the command only ceases to create new exit orders after the position fully closes.</p>\n<p>The above script would exhibit different behavior if we included a\u00a0<code dir=\"auto\">from_entry</code>\u00a0argument in the\u00a0<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>\u00a0call. When a call to this command specifies a\u00a0<code dir=\"auto\">from_entry</code>\u00a0ID, it only applies to entries with that ID which the strategy created <em>before</em> or <em>on</em> the bar of the call. The command does not place exit orders for subsequent entries created <em>after</em> that bar in that case, even ones with the same ID.</p>\n<p>Here, we added <code dir=\"auto\">from_entry = \"Entry\"</code> to our script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call, meaning it only produces exit orders for entries with the \u201cEntry\u201d ID. Only 17 exits occur this time, each corresponding to an entry order created before or on the bar with the blue <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>. The call does not affect any entries that the strategy creates <em>after</em> that bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"530\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Order-placement-and-cancellation-Strategy-exit-Exits-for-multiple-entries-4.CErI4zyu_1GDcP4.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exit persist demo\", overlay = true, margin_long = 100, margin_short = 100, pyramiding = 100)\n\n//@variable The time when order creation starts. \nint entryStartTime = input.time(0, \"Start time for entries\", confirm = true)\n//@variable The time when the `strategy.exit()` call occurs.\nint exitCallTime = input.time(0, \"Exit call time\", confirm = true)\n//@variable The time when order creation stops.\nint entryEndTime = input.time(0, \"End time for entries\", confirm = true)\n\n// Raise a runtime error if incorrect timestamps are chosen.\nif exitCallTime &lt;= entryStartTime or entryEndTime &lt;= exitCallTime or entryEndTime &lt;= entryStartTime\n    runtime.error(\"The input timestamps must follow this condition: entryStartTime &lt; exitCallTime &lt; entryEndTime.\")\n\n// Create variables to track entry and exit conditions. \nbool entriesStart = time == entryStartTime\nbool callExit     = time == exitCallTime\nbool entriesEnd   = time == entryEndTime\nbool callEntry    = time &gt;= entryStartTime and time &lt; entryEndTime\n\n// Place a long entry order when `callEntry` is `true`.\nif callEntry\n    strategy.entry(\"Entry\", strategy.long)\n\n// Call `strategy.exit()` when `callExit` is `true`, which occurs only once.\n// This single call only places exit orders for all entries with the \"Entry\" ID created before or on the bar where \n// `callExit` occurs. It DOES NOT affect any subsequent entries created after that bar.\nif callExit\n    strategy.exit(\"Exit\", from_entry = \"Entry\", loss = 0)\n\n// Draw labels to signify when entries start, when the `strategy.exit()` call occurs, and when order placement stops.\nswitch \n    entriesStart =&gt; label.new(\n         bar_index, high, \"Start placing entry orders.\", color = color.green, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    callExit =&gt; label.new(\n         bar_index, high, \"Call `strategy.exit()` once.\", color = color.blue, textcolor = color.white, \n         style = label.style_label_lower_right, size = size.large\n     )\n    entriesEnd =&gt; label.new(\n         bar_index, high, \"Stop placing orders.\", color = color.red, textcolor = color.white, \n         style = label.style_label_lower_left, size = size.large\n     )\n\n// Create a line and label to visualize the lowest entry price, i.e., the price required to close the position.\nvar line lowestLine = line.new(\n     entryStartTime + 1000, na, entryEndTime, na, xloc.bar_time, extend.right, color.orange, width = 2\n )\nvar lowestLabel = label.new(\n     entryStartTime + 1000, na, \"Lowest entry price\", color = color.orange, \n     style = label.style_label_upper_right, xloc = xloc.bar_time\n )\n\n// Update the price values of the `lowestLine` and `lowestLabel` after each new entry.\nif callEntry[1]\n    var float lowestPrice = strategy.opentrades.entry_price(0)\n    float entryPrice = strategy.opentrades.entry_price(strategy.opentrades - 1)\n    if not na(entryPrice)\n        lowestPrice := math.min(lowestPrice, entryPrice)\n        lowestLine.set_y1(lowestPrice)\n        lowestLine.set_y2(lowestPrice)\n        lowestLabel.set_y(lowestPrice)\n\n// Highlight the background when `entriesStart`, `callExit`, and `entriesEnd` occurs.\nbgcolor(entriesStart ? color.new(color.green, 80) : na, title = \"Entries start highlight\")\nbgcolor(callExit ? color.new(color.blue, 80) : na, title = \"Exit call highlight\")\nbgcolor(entriesEnd ? color.new(color.red, 80) : na, title = \"Entries end highlight\")</div>\n<h3 class=\"md-heading\" id=\"strategyclose-and-strategyclose_all\"><a href=\"#strategyclose-and-strategyclose_all\"><span>\u200b<code dir=\"auto\">strategy.close()</code>\u200b and \u200b<code dir=\"auto\">strategy.close_all()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> commands generate orders to exit from an open position. Unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>, which creates <em>price-based</em> exit orders (e.g., <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a>), these commands generate <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a> that the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills on the next available tick, irrespective of the price.</p>\n<p>The example below demonstrates a simple strategy that places a \u201cbuy\u201d entry order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> once every 50 bars and a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> to close the long position with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> 25 bars afterward:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-6.C8naMrYK_ZahHab.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Close demo\", \"test\", overlay = true)\n\n//@variable Is `true` on every 50th bar.\nbuyCond = bar_index % 50 == 0\n//@variable Is `true` on every 25th bar except for those that are divisible by 50.\nsellCond = bar_index % 25 == 0 and not buyCond\n\nif buyCond\n    strategy.entry(\"buy\", strategy.long)\nif sellCond\n    strategy.close(\"buy\")\n\nbgcolor(buyCond  ? color.new(color.blue, 90) : na)\nbgcolor(sellCond ? color.new(color.red, 90) : na)</div>\n<p>Notice that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> call in this script uses \u201cbuy\u201d as its required <code dir=\"auto\">id</code> argument. Unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>, this command\u2019s <code dir=\"auto\">id</code> parameter specifies the <em>entry ID</em> of an open trade. It <strong>does not</strong> represent the ID of the resulting exit order. If a market position consists of multiple open trades with the same entry ID, a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> call with that ID as its <code dir=\"auto\">id</code> argument generates a single <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> to exit from all of them.</p>\n<p>The following script creates a \u201cbuy\u201d order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> once every 25 bars, and it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> with \u201cbuy\u201d as its <code dir=\"auto\">id</code> argument to close all open trades with that entry ID once every 100 bars. The market order from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> closes the entire position in this case because every open trade has the same \u201cbuy\u201d entry ID:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-7.BnXt0DwI_2ljg1Q.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Multiple close demo\", \"test\", overlay = true, pyramiding = 3)\n\n//@variable Is `true` on every 100th bar.\nsellCond = bar_index % 100 == 0\n//@variable Is `true` on every 25th bar except for those that are divisible by 100.\nbuyCond = bar_index % 25 == 0 and not sellCond\n\nif buyCond\n    strategy.entry(\"buy\", strategy.long)\nif sellCond\n    strategy.close(\"buy\")\n\nbgcolor(buyCond  ? color.new(color.blue, 90) : na)\nbgcolor(sellCond ? color.new(color.red, 90) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>We included <code dir=\"auto\">pyramiding = 3</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, allowing the script to generate up to three entries per position with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls.</li>\n</ul>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> command generates a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> to exit from the open position that <em>does not</em> link to any specific entry ID. This command is helpful when a strategy needs to exit as soon as possible from a position consisting of multiple open trades with different entry IDs.</p>\n<p>The script below places \u201cA\u201d, \u201cB\u201d, and \u201cC\u201d entry orders sequentially based on the number of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades\">open trades</a>, and then it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> to create a single order that closes the entire position on the next bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-8.CRIv7OvG_1rGwwH.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Close multiple ID demo\", \"test\", overlay = true, pyramiding = 3)\n\nswitch strategy.opentrades\n    0 =&gt; strategy.entry(\"A\", strategy.long)\n    1 =&gt; strategy.entry(\"B\", strategy.long)\n    2 =&gt; strategy.entry(\"C\", strategy.long)\n    3 =&gt; strategy.close_all()</div>\n<h3 class=\"md-heading\" id=\"strategycancel-and-strategycancel_all\"><a href=\"#strategycancel-and-strategycancel_all\"><span>\u200b<code dir=\"auto\">strategy.cancel()</code>\u200b and \u200b<code dir=\"auto\">strategy.cancel_all()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel_all\">strategy.cancel_all()</a> commands allow strategies to cancel <em>unfilled</em> orders before the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> processes them. These order cancellation commands are most helpful when working with <em>price-based orders</em>, including all orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> calls and the orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls that use <code dir=\"auto\">limit</code> or <code dir=\"auto\">stop</code> arguments.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a> command has a required <code dir=\"auto\">id</code> parameter, which specifies the ID of the entry or exit orders to cancel. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel_all\">strategy.cancel_all()</a> command does not have such a parameter because it cancels <em>all</em> unfilled orders, regardless of ID.</p>\n<p>The following strategy places a \u201cbuy\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit order</a> 500 ticks below the closing price 100 bars before the last chart bar with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>, and it cancels the order on the next bar with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a>. The script highlights the chart\u2019s background to signify when it places and cancels the \u201cbuy\u201d order, and it draws a horizontal <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> at the order\u2019s price. As we see below, our example chart shows no entry marker when the market price crosses the horizontal line because the strategy already cancels the order (when the chart\u2019s background is orange) before it reaches that level:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-9.4WRZcmod_TgLp6.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Cancel demo\", \"test\", overlay = true)\n\n//@variable Draws a horizontal line at the `limit` price of the \"buy\" order.\nvar line limitLine = na\n\n//@variable Is `color.green` when the strategy places the \"buy\" order, `color.orange` when it cancels the order.\ncolor bgColor = na\n\nif last_bar_index - bar_index == 100\n    float limitPrice = close - syminfo.mintick * 500\n    strategy.entry(\"buy\", strategy.long, limit = limitPrice)\n    limitLine := line.new(bar_index, limitPrice, bar_index + 1, limitPrice, extend = extend.right)\n    bgColor := color.new(color.green, 50)\n\nif last_bar_index - bar_index == 99\n    strategy.cancel(\"buy\")\n    bgColor := color.new(color.orange, 50)\n\nbgcolor(bgColor)</div>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a> command affects <em>all</em> unfilled orders with a specified ID. It does nothing if the specified <code dir=\"auto\">id</code> represents the ID of an order that does not exist. When there is more than one unfilled order with the specified ID, the command cancels <em>all</em> of them at once.</p>\n<p>Below, we\u2019ve modified the previous script to place a \u201cbuy\u201d limit order on three consecutive bars, starting 100 bars before the last chart bar. After placing all three orders, the strategy cancels them using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a> with \u201cbuy\u201d as the <code dir=\"auto\">id</code> argument, resulting in nothing happening when the market price reaches any of the order prices (horizontal <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-10.BdK1xjss_Z1VR5ov.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Multiple cancel demo\", \"test\", overlay = true, pyramiding = 3)\n\n//@variable Draws a horizontal line at the `limit` price of the \"buy\" order.\nvar line limitLine = na\n\n//@variable Is `color.green` when the strategy places the \"buy\" order, `color.orange` when it cancels the order.\ncolor bgColor = na\n\nif last_bar_index - bar_index &lt;= 100 and last_bar_index - bar_index &gt;= 98\n    float limitPrice = close - syminfo.mintick * 500\n    strategy.entry(\"buy\", strategy.long, limit = limitPrice)\n    limitLine := line.new(bar_index, limitPrice, bar_index + 1, limitPrice, extend = extend.right)\n    bgColor := color.new(color.green, 50)\n\nif last_bar_index - bar_index == 97\n    strategy.cancel(\"buy\")\n    bgColor := color.new(color.orange, 50)\n\nbgcolor(bgColor)</div>\n<p>Note that:</p>\n<ul>\n<li>We included <code dir=\"auto\">pyramiding = 3</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, allowing three successive entries from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> per position. The script would also achieve the same result without this setting if it called <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> instead because <a href=\"/pine-script-docs/v5/concepts/strategies/#pyramiding\">pyramiding</a> <em>does not</em> affect orders from that command.</li>\n</ul>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel\">strategy.cancel()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel_all\">strategy.cancel_all()</a> commands can cancel orders of any type, including <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a>. However, it is important to note that either command can cancel a market order only if its call occurs on the <em>same</em> script execution as the order placement command. If the call happens after that point, it has <em>no effect</em> because the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills market orders on the <em>next available tick</em>.</p>\n<p>This example places a \u201cbuy\u201d market order 100 bars before the last chart bar with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>, then it attempts to cancel the order on the next bar with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel_all\">strategy.cancel_all()</a>. The cancellation command <em>does not</em> affect the \u201cbuy\u201d order because the broker emulator fills the order on the next bar\u2019s <em>opening tick</em>, which occurs <em>before</em> the script evaluates the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.cancel_all\">strategy.cancel_all()</a> call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"544\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Orders-and-entries-Order-placement-commands-11.C3U1GI3M_DIxpi.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Cancel market demo\", \"test\", overlay = true)\n\n//@variable Is `color.green` when the strategy places the \"buy\" order, `color.orange` when it tries to cancel the order.\ncolor bgColor = na\n\nif last_bar_index - bar_index == 100\n    strategy.entry(\"buy\", strategy.long)\n    bgColor := color.new(color.green, 50)\n\nif last_bar_index - bar_index == 99\n    strategy.cancel_all()\n    bgColor := color.new(color.orange, 50)\n\nbgcolor(bgColor)</div>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"position-sizing\"><a href=\"#position-sizing\">Position sizing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script strategies feature two ways to control the sizes of the orders that open and manage positions:</p>\n<ul>\n<li>Set a default <em>fixed</em> quantity type and value for the orders. Programmers can specify defaults for these properties by including <code dir=\"auto\">default_qty_type</code> and <code dir=\"auto\">default_qty_value</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement. Script users can adjust these values with the \u201cOrder size\u201d inputs in the \u201cSettings/Properties\u201d tab.</li>\n<li>Include a <em>non-na</em> <code dir=\"auto\">qty</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> call. When a call to either of these commands specifies a non-na <code dir=\"auto\">qty</code> value, that call ignores the strategy\u2019s default quantity type and value and places an order for <code dir=\"auto\">qty</code> contracts/shares/lots/units instead.</li>\n</ul>\n<p>The following example uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls with different <code dir=\"auto\">qty</code> values for long and short trades. When the current bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> equals the <code dir=\"auto\">lowest</code> value, the script places a \u201cBuy\u201d order to enter a long position of <code dir=\"auto\">longAmount</code> units. Otherwise, when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> equals the <code dir=\"auto\">highest</code> value, it places a \u201cSell\u201d order to enter a short position of <code dir=\"auto\">shortAmount</code> units:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"740\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Position-sizing-1.CpMYvl8Y_ZCp8n6.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Buy low, sell high\", overlay = true, default_qty_type = strategy.cash, default_qty_value = 5000)\n\nint   length      = input.int(20, \"Length\", 1)\nfloat longAmount  = input.float(4.0, \"Long Amount\", 0.0)\nfloat shortAmount = input.float(2.0, \"Short Amount\", 0.0)\n\nfloat highest = ta.highest(length)\nfloat lowest  = ta.lowest(length)\n\nswitch\n    low == lowest   =&gt; strategy.entry(\"Buy\", strategy.long, longAmount)\n    high == highest =&gt; strategy.entry(\"Sell\", strategy.short, shortAmount)</div>\n<p>Notice that although we\u2019ve included <code dir=\"auto\">default_qty_type</code> and <code dir=\"auto\">default_qty_value</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, the strategy <em>does not</em> use this default setting to size its orders because the specified <code dir=\"auto\">qty</code> in the entry commands takes precedence. If we want to use the default size, we must <em>remove</em> the <code dir=\"auto\">qty</code> arguments from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls or set their values to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>Here, we edited the previous script by including <a href=\"/pine-script-docs/v5/language/operators/#-ternary-operator\">ternary</a> expressions for the <code dir=\"auto\">qty</code> arguments in both <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls that replace input values of 0 with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>. If the specified <code dir=\"auto\">longAmount</code> or <code dir=\"auto\">shortAmount</code> is 0, which is what we set as the new default, the corresponding entry orders use the strategy\u2019s default order size instead, as we see below:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"740\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Position-sizing-2.BNMrWxCG_Z1eMhKJ.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Buy low, sell high\", overlay = true, default_qty_type = strategy.cash, default_qty_value = 5000)\n\nint   length      = input.int(20, \"Length\", 1)\nfloat longAmount  = input.float(0.0, \"Long Amount\", 0.0)\nfloat shortAmount = input.float(0.0, \"Short Amount\", 0.0)\n\nfloat highest = ta.highest(length)\nfloat lowest  = ta.lowest(length)\n\nswitch\n    low == lowest   =&gt; strategy.entry(\"Buy\", strategy.long, longAmount == 0.0 ? na : longAmount)\n    high == highest =&gt; strategy.entry(\"Sell\", strategy.short, shortAmount == 0.0 ? na : shortAmount)</div>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"closing-a-market-position\"><a href=\"#closing-a-market-position\">Closing a market position<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>By default, strategies close a market position using the <em>First In, First Out (FIFO)</em> method, which means that any exit order closes or reduces the position starting with the <em>first</em> open trade, even if the exit command specifies the entry ID of a <em>different</em> open trade. To override this default behavior, include <code dir=\"auto\">close_entries_rule = \"ANY\"</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement.</p>\n<p>The following example places \u201cBuy1\u201d and \u201cBuy2\u201d entry orders sequentially, starting 100 bars before the latest chart bar. When the position size is 0, it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place the \u201cBuy1\u201d order for five units. After the strategy\u2019s position size matches the size of that order, it uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place the \u201cBuy2\u201d order for ten units. The strategy then creates \u201cbracket\u201d exit orders <a href=\"/pine-script-docs/v5/concepts/strategies/#exits-for-multiple-entries\">for both entries</a> using a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call without a <code dir=\"auto\">from_entry</code> argument. For visual reference, the script plots the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a> value in a separate pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"686\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Closing-a-market-position-1.CG44yAVx_1GNd4G.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exit Demo\", pyramiding = 2)\n\nfloat positionSize = strategy.position_size\n\nif positionSize == 0 and last_bar_index - bar_index &lt;= 100\n    strategy.entry(\"Buy1\", strategy.long, 5)\nelse if positionSize == 5\n    strategy.entry(\"Buy2\", strategy.long, 10)\nelse if positionSize == 15\n    strategy.exit(\"bracket\", loss = 10, profit = 10)\n\nplot(positionSize == 0 ? na : positionSize, \"Position Size\", color.lime, 4, plot.style_histogram)</div>\n<p>Note that:</p>\n<ul>\n<li>We included <code dir=\"auto\">pyramiding = 2</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, allowing two successive entries from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> per position.</li>\n</ul>\n<p>Each time the market price triggers an exit order, the above script exits from the open position, starting with the <em>oldest</em> open trade. This FIFO behavior applies even if we explicitly specify an exit from \u201cBuy2\u201d before \u201cBuy1\u201d in the code.</p>\n<p>The script version below calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> with \u201cBuy2\u201d as its <code dir=\"auto\">id</code> argument, and it includes \u201cBuy1\u201d as the <code dir=\"auto\">from_entry</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call. The <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> executes on the next available tick, meaning the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills it <em>before</em> the <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">take-profit</a> and <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a> orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Exit Demo\", pyramiding = 2)\n\nfloat positionSize = strategy.position_size\n\nif positionSize == 0 and last_bar_index - bar_index &lt;= 100\n    strategy.entry(\"Buy1\", strategy.long, 5)\nelse if positionSize == 5\n    strategy.entry(\"Buy2\", strategy.long, 10)\nelse if positionSize == 15\n    strategy.close(\"Buy2\")\n    strategy.exit(\"bracket\", \"Buy1\", loss = 10, profit = 10)\n\nplot(positionSize == 0 ? na : positionSize, \"Position Size\", color.lime, 4, plot.style_histogram)</div>\n<p>The market order from the script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> call is for 10 units because it links to the open trade with the \u201cBuy2\u201d entry ID. A user might expect this strategy to close that trade completely when the order executes. However, the \u201cList of Trades\u201d tab shows that five units of the order go toward closing the \u201cBuy1\u201d trade <em>first</em> because it is the oldest, and the remaining five units close <em>half</em> of the \u201cBuy2\u201d trade. After that, the \u201cbracket\u201d orders from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call close the rest of the position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"518\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Closing-a-market-position-2.tTsJ7OdZ_Z2rHJes.webp\" width=\"1342\"/></p>\n<p>Note that:</p>\n<ul>\n<li>If we included <code dir=\"auto\">close_entries_rule = \"ANY\"</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, the market order from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> would close the open trade with the \u201cBuy2\u201d entry ID <em>first</em>, and then the \u201cbracket\u201d orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> would close the trade with the \u201cBuy1\u201d entry ID.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"oca-groups\"><a href=\"#oca-groups\">OCA groups<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>One-Cancels-All (OCA)</em> groups allow a strategy to fully or partially <em>cancel</em> specific orders when the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> executes another order from the same group. To assign an order to an OCA group, include an <code dir=\"auto\">oca_name</code> argument in the call to the <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement command</a>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> commands also allow programmers to specify an <em>OCA type</em>, which defines whether a strategy <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyocacancel\">cancels</a>, <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyocareduce\">reduces</a>, or <a href=\"/pine-script-docs/v5/concepts/strategies/#strategyocanone\">does not modify</a> the order after executing other orders.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>All order placement commands that issue orders for the same OCA group must specify the same group name <strong>and</strong> OCA type. If two commands have the same <code dir=\"auto\">oca_name</code> but <em>different</em> <code dir=\"auto\">oca_type</code> values, the strategy considers them to be from <strong>two distinct groups</strong>. In other words, an OCA group <strong>cannot</strong> mix the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.cancel\">strategy.oca.cancel</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.reduce\">strategy.oca.reduce</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.none\">strategy.oca.none</a> OCA types.</p></div></aside>\n<h3 class=\"md-heading\" id=\"strategyocacancel\"><a href=\"#strategyocacancel\"><span>\u200b<code dir=\"auto\">strategy.oca.cancel</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When an order placement command uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.cancel\">strategy.oca.cancel</a> as its <code dir=\"auto\">oca_type</code> argument, the strategy completely <em>cancels</em> the resulting order if another order from the same OCA group executes first.</p>\n<p>To demonstrate how this OCA type impacts a strategy\u2019s orders, consider the following script, which places orders when the <code dir=\"auto\">ma1</code> value crosses the <code dir=\"auto\">ma2</code> value. If the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a> is 0 when the cross occurs, the strategy places two <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop orders</a> with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls. The first is a long order at the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, and the second is a short order at the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>. If the strategy already has an open position during the cross, it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> to close the position with a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"OCA Cancel Demo\", overlay=true)\n\nfloat ma1 = ta.sma(close, 5)\nfloat ma2 = ta.sma(close, 9)\n\nif ta.cross(ma1, ma2)\n    if strategy.position_size == 0\n        strategy.order(\"Long\",  strategy.long, stop = high)\n        strategy.order(\"Short\", strategy.short, stop = low)\n    else\n        strategy.close_all()\n\nplot(ma1, \"Fast MA\", color.aqua)\nplot(ma2, \"Slow MA\", color.orange)</div>\n<p>Depending on the price action, the strategy might fill <em>both</em> stop orders before creating the closing market order. In that case, the strategy exits the position without evaluating <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> because both orders have the same size. We see this behavior in the chart below, where the strategy alternated between executing \u201cLong\u201d and \u201cShort\u201d orders a few times without executing an order from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"550\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-OCA-groups-Strategy-oca-cancel-1.B4pkrsRw_1KFx5x.webp\" width=\"1816\"/></p>\n<p>To eliminate scenarios where the strategy fills the \u201cLong\u201d and \u201cShort\u201d orders before evaluating the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> call, we can instruct it to <em>cancel</em> one of the orders after it executes the other. Below, we included \u201cEntry\u201d as the <code dir=\"auto\">oca_name</code> argument and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.cancel\">strategy.oca.cancel</a> as the <code dir=\"auto\">oca_type</code> argument in both <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls. Now, after the strategy executes either the \u201cLong\u201d or \u201cShort\u201d order, it cancels the other order and waits for <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> to close the position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"550\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-OCA-groups-Strategy-oca-cancel-2.Pw0HBDfm_ZLEEMG.webp\" width=\"1816\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"OCA Cancel Demo\", overlay=true)\n\nfloat ma1 = ta.sma(close, 5)\nfloat ma2 = ta.sma(close, 9)\n\nif ta.cross(ma1, ma2)\n    if strategy.position_size == 0\n        strategy.order(\"Long\",  strategy.long, stop = high, oca_name = \"Entry\", oca_type = strategy.oca.cancel)\n        strategy.order(\"Short\", strategy.short, stop = low, oca_name = \"Entry\", oca_type = strategy.oca.cancel)\n    else\n        strategy.close_all()\n\nplot(ma1, \"Fast MA\", color.aqua)\nplot(ma2, \"Slow MA\", color.orange)</div>\n<h3 class=\"md-heading\" id=\"strategyocareduce\"><a href=\"#strategyocareduce\"><span>\u200b<code dir=\"auto\">strategy.oca.reduce</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When an order placement command uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.reduce\">strategy.oca.reduce</a> as its OCA type, the strategy <em>does not</em> cancel the resulting order entirely if another order with the same OCA name executes first. Instead, it <em>reduces</em> the order\u2019s size by the filled number of contracts/shares/lots/units, which is particularly useful for custom exit strategies.</p>\n<p>The following example demonstrates a <em>long-only</em> strategy that generates a single stop-loss order and two take-profit orders for each new entry. When a faster moving average crosses over a slower one, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> with <code dir=\"auto\">qty = 6</code> to create an entry order, and then it uses three <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls to create a <a href=\"/pine-script-docs/v5/concepts/strategies/#stop-and-stop-limit-orders\">stop order</a> at the <code dir=\"auto\">stop</code> price and two <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit orders</a> at the <code dir=\"auto\">limit1</code> and <code dir=\"auto\">limit2</code> prices. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> call for the \u201cStop\u201d order uses <code dir=\"auto\">qty = 6</code>, and the two calls for the \u201cLimit 1\u201d and \u201cLimit 2\u201d orders both use <code dir=\"auto\">qty = 3</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Multiple TP Demo\", overlay = true)\n\nvar float stop   = na\nvar float limit1 = na\nvar float limit2 = na\n\nbool longCondition = ta.crossover(ta.sma(close, 5), ta.sma(close, 9))\nif longCondition and strategy.position_size == 0\n    stop   := close * 0.99\n    limit1 := close * 1.01\n    limit2 := close * 1.02\n    strategy.entry(\"Long\",  strategy.long, 6)\n    strategy.order(\"Stop\",  strategy.short, stop = stop, qty = 6)\n    strategy.order(\"Limit 1\", strategy.short, limit = limit1, qty = 3)\n    strategy.order(\"Limit 2\", strategy.short, limit = limit2, qty = 3)\n\nbool showPlot = strategy.position_size != 0\nplot(showPlot ? stop   : na, \"Stop\",    color.red,   style = plot.style_linebr)\nplot(showPlot ? limit1 : na, \"Limit 1\", color.green, style = plot.style_linebr)\nplot(showPlot ? limit2 : na, \"Limit 2\", color.green, style = plot.style_linebr)</div>\n<p>After adding this strategy to the chart, we see it does not work as initially intended. The problem with this script is that the orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> <strong>do not</strong> belong to an OCA group by default (unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>, whose orders automatically belong to a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.reduce\">strategy.oca.reduce</a> OCA group). Since the strategy does not assign the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls to any OCA group, it does not reduce any unfilled stop or limit orders after executing an order. Consequently, if the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills the stop order and at least one of the limit orders, the traded quantity <strong>exceeds</strong> the open long position, resulting in an open <em>short</em> position:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"830\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-OCA-groups-Strategy-oca-reduce-1.B8XPX6-M_ZmN4JH.webp\" width=\"1818\"/></p>\n<p>For our long-only strategy to work as we intended, we must instruct it to <em>reduce</em> the sizes of the unfilled stop/limit orders after one of them executes to prevent selling a larger quantity than the open long position.</p>\n<p>Below, we specified \u201cBracket\u201d as the <code dir=\"auto\">oca_name</code> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.reduce\">strategy.oca.reduce</a> as the <code dir=\"auto\">oca_type</code> in all the script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> calls. These changes tell the strategy to reduce the sizes of the orders in the \u201cBracket\u201d group each time the broker emulator fills one of them. This version of the strategy never simulates a short position because the total size of its filled stop and limit orders never <em>exceeds</em> the long position\u2019s size:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-OCA-groups-Strategy-oca-reduce-2.C2FZumhg_1kQ60w.webp\" width=\"1818\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Multiple TP Demo\", overlay = true)\n\nvar float stop   = na\nvar float limit1 = na\nvar float limit2 = na\n\nbool longCondition = ta.crossover(ta.sma(close, 5), ta.sma(close, 9))\nif longCondition and strategy.position_size == 0\n    stop   := close * 0.99\n    limit1 := close * 1.01\n    limit2 := close * 1.02\n    strategy.entry(\"Long\",  strategy.long, 6)\n    strategy.order(\"Stop\",  strategy.short, stop = stop, qty = 6, oca_name = \"Bracket\", oca_type = strategy.oca.reduce)\n    strategy.order(\"Limit 1\", strategy.short, limit = limit1, qty = 3, oca_name = \"Bracket\", oca_type = strategy.oca.reduce)\n    strategy.order(\"Limit 2\", strategy.short, limit = limit2, qty = 6, oca_name = \"Bracket\", oca_type = strategy.oca.reduce)\n\nbool showPlot = strategy.position_size != 0\nplot(showPlot ? stop   : na, \"Stop\",    color.red,   style = plot.style_linebr)\nplot(showPlot ? limit1 : na, \"Limit 1\", color.green, style = plot.style_linebr)\nplot(showPlot ? limit2 : na, \"Limit 2\", color.green, style = plot.style_linebr)</div>\n<p>Note that:</p>\n<ul>\n<li>We also changed the <code dir=\"auto\">qty</code> value of the \u201cLimit 2\u201d order to 6 instead of 3 because the strategy reduces its amount by three units when it executes the \u201cLimit 1\u201d order. Keeping the <code dir=\"auto\">qty</code> value of 3 would cause the second limit order\u2019s size to drop to 0 after the strategy fills the first limit order, meaning it would never execute.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"strategyocanone\"><a href=\"#strategyocanone\"><span>\u200b<code dir=\"auto\">strategy.oca.none</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When an order placement command uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.oca.none\">strategy.oca.none</a> as its <code dir=\"auto\">oca_type</code> value, all orders from that command execute <em>independently</em> of any OCA group. This value is the default <code dir=\"auto\">oca_type</code> for the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> commands.</p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"currency\"><a href=\"#currency\">Currency<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script strategies can use different currencies in their calculations than the instruments they simulate trades on. Programmers can specify a strategy\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.account_currency\">account currency</a> by including a <code dir=\"auto\">currency.*</code> variable as the <code dir=\"auto\">currency</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement. The default value is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_currency.NONE\">currency.NONE</a>, meaning the strategy uses the same currency as the current chart (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a>). Script users can change the account currency using the \u201cBase currency\u201d input in the script\u2019s \u201cSettings/Properties\u201d tab.</p>\n<p>When a strategy script uses an account currency that differs from the chart\u2019s currency, it uses the <em>previous daily value</em> of a corresponding currency pair from the most popular exchange to determine the conversion rate. If no exchange provides the rate directly, it derives the rate using a <a href=\"https://www.tradingview.com/support/solutions/43000502298-spread-charts/\">spread symbol</a>. The strategy multiplies all monetary values, including simulated profits/losses, by the determined cross rate to express them in the account currency. To retrieve the rate that a strategy uses to convert monetary values, call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a> with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a> as the <code dir=\"auto\">from</code> argument and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.account_currency\">strategy.account_currency</a> as the <code dir=\"auto\">to</code> argument.</p>\n<p>Note that:</p>\n<ul>\n<li>Programmers can directly convert values expressed in a strategy\u2019s account currency to the chart\u2019s currency and vice versa via the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.convert_to_symbol\">strategy.convert_to_symbol()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.convert_to_account\">strategy.convert_to_account()</a> functions.</li>\n</ul>\n<p>The following example demonstrates how currency conversion affects a strategy\u2019s monetary values and how a strategy\u2019s cross-rate calculations match those that <code dir=\"auto\">request.*()</code> functions use.</p>\n<p>On each of the latest 500 bars, the strategy places an entry order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>, and it places a <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">take-profit</a> and <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a> order one tick away from the entry price with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a>. The size of each entry order is <code dir=\"auto\">1.0 / syminfo.mintick</code>, rounded to the nearest tick, which means that the profit/loss of each closed trade is equal to <em>one point</em> in the chart\u2019s <em>quote currency</em>. We specified <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_currency.EUR\">currency.EUR</a> as the account currency in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, meaning the strategy multiplies all monetary values by a cross rate to express them in Euros.</p>\n<p>The script calculates the absolute change in the ratio of the strategy\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit\">net profit</a> to the symbol\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.pointvalue\">point value</a> to determine the value of <em>one unit</em> of the chart\u2019s currency in Euros. It plots this value alongside the result from a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a> call that uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.account_currency\">strategy.account_currency</a> as the <code dir=\"auto\">from</code> and <code dir=\"auto\">to</code> arguments. As we see below, both plots align, confirming that strategies and <code dir=\"auto\">request.*()</code> functions use the <em>same</em> daily cross-rate calculations:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"718\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Currency-1.BIrX-27H_1pt4ls.webp\" width=\"1820\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Currency Test\", currency = currency.EUR)\n\nif last_bar_index - bar_index &lt; 500\n    // Place an entry order with a size that results in a P/L of `syminfo.pointvalue` units of chart currency per tick. \n    strategy.entry(\"LE\", strategy.long, math.round_to_mintick(1.0 / syminfo.mintick))\n    // Place exit orders one tick above and below the \"LE\" entry price, \n    // meaning each trade closes with one point of profit or loss in the chart's currency.\n    strategy.exit(\"LX\", \"LE\", profit = 1, loss = 1)\n\n// Plot the absolute change in `strategy.netprofit / syminfo.pointvalue`, which represents 1 chart unit of profit/loss. \nplot(\n     math.abs(ta.change(strategy.netprofit / syminfo.pointvalue)), \"1 chart unit of profit/loss in EUR\", \n     color = color.fuchsia, linewidth = 4\n )\n// Plot the requested currency rate.\nplot(request.currency_rate(syminfo.currency, strategy.account_currency), \"Requested conversion rate\", color.lime)</div>\n<p>Note that:</p>\n<ul>\n<li>When a strategy executes on a chart with a timeframe higher than \u201c1D\u201d, it uses the data from <em>one day before</em> each <em>historical</em> bar\u2019s closing time for its cross-rate calculations. For example, on a \u201c1W\u201d chart, the strategy bases its cross rate on the previous Thursday\u2019s closing values. However, it still uses the latest confirmed daily rate on <em>realtime</em> bars.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"altering-calculation-behavior\"><a href=\"#altering-calculation-behavior\">Altering calculation behavior<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Strategy scripts execute across all available historical chart bars and continue to execute on realtime bars as new data comes in. However, by default, strategies only recalculate their values after a bar <em>closes</em>, even on realtime bars, and the earliest point that the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills the orders a strategy places on the close one bar is at the <em>open</em> of the following bar.</p>\n<p>Users can change these behaviors with the <code dir=\"auto\">calc_on_every_tick</code>, <code dir=\"auto\">calc_on_order_fills</code>, and <code dir=\"auto\">process_orders_on_close</code> parameters of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement or the corresponding inputs in the \u201cRecalculate\u201d and \u201cFill orders\u201d sections of the script\u2019s \u201cSettings/Properties\u201d tab. The sections below explain how these settings affect a strategy\u2019s calculations.</p>\n<h3 class=\"md-heading\" id=\"calc_on_every_tick\"><a href=\"#calc_on_every_tick\"><span>\u200b<code dir=\"auto\">calc_on_every_tick</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">calc_on_every_tick</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function determines the frequency of a strategy\u2019s calculations on <em>realtime bars</em>. When this parameter\u2019s value is <code dir=\"auto\">true</code>, the script recalculates on each <em>new tick</em> in the realtime data feed. Its default value is <code dir=\"auto\">false</code>, meaning the script only executes on a realtime bar after it closes. Users can also toggle this recalculation behavior with the \u201cOn every tick\u201d input in the script\u2019s \u201cSettings/Properties\u201d tab.</p>\n<p>Enabling this setting can be useful in forward testing because it allows a strategy to use realtime price updates in its calculations. However, it <em>does not</em> affect the calculations on historical bars because historical data feeds <em>do not</em> contain complete tick data: the broker emulator considers each historical bar to have only four ticks (open, high, low, and close). Therefore, users should exercise caution and understand the limitations of this setting. If enabling calculation on every tick causes a strategy to behave <em>differently</em> on historical and realtime bars, the strategy will <strong><a href=\"/pine-script-docs/v5/concepts/repainting/\">repaint</a></strong> after the user reloads it.</p>\n<p>The following example demonstrates how recalculation on every tick can cause strategy repainting. The script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> calls to place a long entry order each time the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> reaches its <code dir=\"auto\">highest</code> value and a short entry order each time the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> reaches its <code dir=\"auto\">lowest</code> value. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement includes <code dir=\"auto\">calc_on_every_tick = true</code>, meaning that on realtime bars, it can recalculate and place orders on new price updates <em>before</em> a bar closes:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Donchian Channel Break\", overlay = true, calc_on_every_tick = true, pyramiding = 20)\n\nint length = input.int(15, \"Length\")\n\nfloat highest = ta.highest(close, length)\nfloat lowest  = ta.lowest(close, length)\n\nif close == highest\n    strategy.entry(\"Buy\", strategy.long)\nif close == lowest\n    strategy.entry(\"Sell\", strategy.short)\n\n// Highlight the background of realtime bars.\nbgcolor(barstate.isrealtime ? color.new(color.orange, 80) : na)\n\nplot(highest, \"Highest\", color = color.lime)\nplot(lowest, \"Lowest\", color = color.red)</div>\n<p>Note that:</p>\n<ul>\n<li>The script uses a <a href=\"/pine-script-docs/v5/concepts/strategies/#pyramiding\">pyramiding</a> value of 20, allowing it to simulate up to 20 entries per position with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> command.</li>\n<li>The script highlights the chart\u2019s background orange when <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">barstate.isrealtime</a> is <code dir=\"auto\">true</code> to indicate realtime bars.</li>\n</ul>\n<p>After applying the script to our chart and letting it run on several realtime bars, we see the following output:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"842\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Altering-calculation-behavior-Calc-on-every-tick-1.BX0Fex4v_2vXWeQ.webp\" width=\"1820\"/></p>\n<p>The script placed a \u201cBuy\u201d order on <em>each tick</em> where the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> was at the <code dir=\"auto\">highest</code> value, which happened <em>more than once</em> on each realtime bar. Additionally, the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> filled each <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> at the current realtime price rather than strictly at the open of the following chart bar.</p>\n<p>After we reload the chart, we see that the strategy <em>changed</em> its behavior and <em>repainted</em> its results on those bars. This time, the strategy placed only <em>one</em> \u201cBuy\u201d order for each <em>closed bar</em> where the condition was valid, and the broker emulator filled each order at the open of the following bar. It did not generate multiple entries per bar because what were previously realtime bars became <em>historical</em> bars, which <strong>do not</strong> hold complete tick data:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"842\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Altering-calculation-behavior-Calc-on-every-tick-2.CEEZdx06_1CeGHx.webp\" width=\"1820\"/></p>\n<h3 class=\"md-heading\" id=\"calc_on_order_fills\"><a href=\"#calc_on_order_fills\"><span>\u200b<code dir=\"auto\">calc_on_order_fills</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">calc_on_order_fills</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function enables a strategy to recalculate immediately after an <em>order fills</em>, allowing it to use more granular information and place additional orders without waiting for a bar to close. Its default value is <code dir=\"auto\">false</code>, meaning the strategy does not allow recalculation immediately after every order fill. Users can also toggle this behavior with the \u201cAfter order is filled\u201d input in the script\u2019s \u201cSettings/Properties\u201d tab.</p>\n<p>Enabling this setting can provide a strategy script with additional data that would otherwise not be available until after a bar closes, such as the current average price of a simulated position on an open bar.</p>\n<p>The example below shows a simple strategy that creates a \u201cBuy\u201d order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> whenever the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a> is 0. The script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_avg_price\">strategy.position_avg_price</a> to calculate price levels for the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> call\u2019s stop-loss and take-profit orders that close the position.</p>\n<p>We\u2019ve included <code dir=\"auto\">calc_on_order_fills = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, meaning that the strategy recalculates each time the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills a \u201cBuy\u201d or \u201cExit\u201d order. Each time an \u201cExit\u201d order fills, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a> reverts to 0, triggering a new \u201cBuy\u201d order. The broker emulator fills the \u201cBuy\u201d order on the next tick at one of the bar\u2019s OHLC values, and then the strategy uses the recalculated <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_avg_price\">strategy.position_avg_price</a> value to determine new \u201cExit\u201d order prices:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"842\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Altering-calculation-behavior-Calc-on-order-fills-1.TfUCX8p2_7gwAM.webp\" width=\"1820\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Intrabar exit\", overlay = true, calc_on_order_fills = true)\n\nfloat stopSize   = input.float(5.0, \"SL %\", minval = 0.0) / 100.0\nfloat profitSize = input.float(5.0, \"TP %\", minval = 0.0) / 100.0\n\nif strategy.position_size == 0.0\n    strategy.entry(\"Buy\", strategy.long)\n\nfloat stopLoss   = strategy.position_avg_price * (1.0 - stopSize)\nfloat takeProfit = strategy.position_avg_price * (1.0 + profitSize)\n\nstrategy.exit(\"Exit\", stop = stopLoss, limit = takeProfit)</div>\n<p>Note that:</p>\n<ul>\n<li>Without enabling recalculation on order fills, this strategy would not place new orders <em>before</em> a bar closes. After an exit, the strategy would wait for the bar to close before placing a new \u201cBuy\u201d order, which the broker emulator would fill on the <em>next tick</em> after that, i.e., the open of the following bar.</li>\n</ul>\n<p>It\u2019s important to note that enabling <code dir=\"auto\">calc_on_order_fills</code> can produce unrealistic strategy results in some cases because the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> may assume order-fill prices that are <em>not</em> obtainable in real-world trading. Therefore, users should exercise caution and carefully examine their strategy logic when allowing recalculation on order fills.</p>\n<p>For example, the following script places a \u201cBuy\u201d order after each new order fill and bar close over the most recent 25 historical bars. The strategy simulates <em>four</em> entries per bar because the broker emulator considers each historical bar to have <em>four ticks</em> (open, high, low, and close). This behavior is unrealistic because it is not typically possible to fill an order at a bar\u2019s <em>exact</em> high or low price:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"506\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Altering-calculation-behavior-Calc-on-order-fills-2.vGEDeBsL_1sBc2Q.webp\" width=\"1818\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"buy on every fill\", overlay = true, calc_on_order_fills = true, pyramiding = 100)\n\nif last_bar_index - bar_index &lt;= 25\n    strategy.entry(\"Buy\", strategy.long)</div>\n<h3 class=\"md-heading\" id=\"process_orders_on_close\"><a href=\"#process_orders_on_close\"><span>\u200b<code dir=\"auto\">process_orders_on_close</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>By default, strategies simulate orders at the close of each bar, meaning that the earliest opportunity to fill the orders and execute strategy calculations and alerts is on the opening of the following bar. Programmers can change this behavior to process orders on the <em>closing tick</em> of each bar by setting <code dir=\"auto\">process_orders_on_close</code> to <code dir=\"auto\">true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement. Users can set this behavior by changing the \u201cFill Orders/On Bar Close\u201d setting in the \u201cSettings/Properties\u201d tab.</p>\n<p>This behavior is most useful when backtesting manual strategies in which traders exit from a position before a bar closes, or in scenarios where algorithmic traders in non-24x7 markets set up after-hours trading capability so that alerts sent after close still have hope of filling before the following day.</p>\n<p>Note that:</p>\n<ul>\n<li>Using strategies with <code dir=\"auto\">process_orders_on_close</code> enabled to send alerts to a third-party service might cause unintended results. Alerts on the close of a bar still occur after the market closes, and real-world orders based on such alerts might not fill until after the market opens again.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a> commands feature an <code dir=\"auto\">immediately</code> parameter that, if <code dir=\"auto\">true</code>, allows the resulting market order to fill on the same tick where the strategy created it. This parameter provides an alternative way for programmers to selectively apply <code dir=\"auto\">process_orders_on_close</code> behavior to closing market orders without affecting the behavior of other order placement commands.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:14", "segment_order": 14, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"simulating-trading-costs\"><a href=\"#simulating-trading-costs\">Simulating trading costs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Strategy performance reports are more relevant and meaningful when they include potential real-world trading costs. Without modeling the potential costs associated with their trades, traders may overestimate a strategy\u2019s historical profitability, potentially leading to suboptimal decisions in live trading. Pine Script strategies include inputs and parameters for simulating trading costs in performance results.</p>\n<h3 class=\"md-heading\" id=\"commission\"><a href=\"#commission\">Commission<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Commission is the fee a broker/exchange charges when executing trades. Commission can be a flat fee per trade or contract/share/lot/unit, or a percentage of the total transaction value. Users can set the commission properties of their strategies by including <code dir=\"auto\">commission_type</code> and <code dir=\"auto\">commission_value</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function, or by setting the \u201cCommission\u201d inputs in the \u201cProperties\u201d tab of the strategy settings.</p>\n<p>The following script is a simple strategy that simulates a \u201cLong\u201d position of 2% of equity when <code dir=\"auto\">close</code> equals the <code dir=\"auto\">highest</code> value over the <code dir=\"auto\">length</code>, and closes the trade when it equals the <code dir=\"auto\">lowest</code> value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"726\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Simulating-trading-costs-Commission-1.XUDZaoNR_2iKnnJ.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Commission Demo\", overlay=true, default_qty_value = 2, default_qty_type = strategy.percent_of_equity)\n\nlength = input.int(10, \"Length\")\n\nfloat highest = ta.highest(close, length)\nfloat lowest  = ta.lowest(close, length)\n\nswitch close\n    highest =&gt; strategy.entry(\"Long\", strategy.long)\n    lowest  =&gt; strategy.close(\"Long\")\n\nplot(highest, color = color.new(color.lime, 50))\nplot(lowest, color = color.new(color.red, 50))</div>\n<p>The results in the <a href=\"/pine-script-docs/v5/concepts/strategies/#strategy-tester\">Strategy Tester</a> show that the strategy had a positive equity growth of 17.61% over the testing range. However, the backtest results do not account for fees the broker/exchange may charge. Let\u2019s see what happens to these results when we include a small commission on every trade in the strategy simulation. In this example, we\u2019ve included <code dir=\"auto\">commission_type = strategy.commission.percent</code> and <code dir=\"auto\">commission_value = 1</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration, meaning it will simulate a commission of 1% on all executed orders:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"726\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Simulating-trading-costs-Commission-2.DAdgHUnC_4hzO7.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Commission Demo\", overlay=true, default_qty_value = 2, default_qty_type = strategy.percent_of_equity,\n     commission_type = strategy.commission.percent, commission_value = 1\n )\n\nlength = input.int(10, \"Length\")\n\nfloat highest = ta.highest(close, length)\nfloat lowest  = ta.lowest(close, length)\n\nswitch close\n    highest =&gt; strategy.entry(\"Long\", strategy.long)\n    lowest  =&gt; strategy.close(\"Long\")\n\nplot(highest, color = color.new(color.lime, 50))\nplot(lowest, color = color.new(color.red, 50))</div>\n<p>As we can see in the example above, after applying a 1% commission to the backtest, the strategy simulated a significantly reduced net profit of only 1.42% and a more volatile equity curve with an elevated max drawdown. These results highlight the impact that commission can have on a strategy\u2019s hypothetical performance.</p>\n<h3 class=\"md-heading\" id=\"slippage-and-unfilled-limits\"><a href=\"#slippage-and-unfilled-limits\">Slippage and unfilled limits<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In real-life trading, a broker/exchange may fill orders at slightly different prices than a trader intended, due to volatility, liquidity, order size, and other market factors, which can profoundly impact a strategy\u2019s performance. The disparity between expected prices and the actual prices at which the broker/exchange executes trades is what we refer to as <em>slippage</em>. Slippage is dynamic and unpredictable, making it impossible to simulate precisely. However, factoring in a small amount of slippage on each trade during a backtest or forward test might help the results better align with reality. Users can model slippage in their strategy results, sized as a fixed number of <em>ticks</em>, by including a <code dir=\"auto\">slippage</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement or by setting the \u201cSlippage\u201d input in the \u201cSettings/Properties\u201d tab.</p>\n<p>The following example demonstrates how simulating slippage affects the fill prices of <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a> in a strategy test. The script below places a \u201cBuy\u201d market order of 2% equity when the market price is above a rising EMA and closes the position when the price dips below the EMA while it\u2019s falling. We\u2019ve included <code dir=\"auto\">slippage = 20</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function, which declares that the price of each simulated order will slip 20 ticks in the direction of the trade.</p>\n<p>The script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_bar_index\">strategy.opentrades.entry_bar_index()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_bar_index\">strategy.closedtrades.exit_bar_index()</a> to get the <code dir=\"auto\">entryIndex</code> and <code dir=\"auto\">exitIndex</code>, which it uses to obtain the <code dir=\"auto\">fillPrice</code> of the order. When the bar index is at the <code dir=\"auto\">entryIndex</code>, the <code dir=\"auto\">fillPrice</code> is the first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_price\">strategy.opentrades.entry_price()</a> value. At the <code dir=\"auto\">exitIndex</code>, <code dir=\"auto\">fillPrice</code> is the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_price\">strategy.closedtrades.exit_price()</a> value from the last closed trade. The script plots the expected fill price along with the simulated fill price after slippage to visually compare the difference:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Simulating-trading-costs-Slippage-and-unfilled-limits-1.viLUaTPh_Z17uYCF.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Slippage Demo\", overlay = true, slippage = 20,\n     default_qty_value = 2, default_qty_type = strategy.percent_of_equity\n )\n\nint length = input.int(5, \"Length\")\n\n//@variable Exponential moving average with an input `length`.\nfloat ma = ta.ema(close, length)\n\n//@variable Is `true` when `ma` has increased and `close` is above it, `false` otherwise.\nbool longCondition = close &gt; ma and ma &gt; ma[1]\n//@variable Is `true` when `ma` has decreased and `close` is below it, `false` otherwise.\nbool shortCondition = close &lt; ma and ma &lt; ma[1]\n\n// Enter a long market position on `longCondition` and close the position on `shortCondition`. \nif longCondition    \n    strategy.entry(\"Buy\", strategy.long)\nif shortCondition\n    strategy.close(\"Buy\")\n\n//@variable The `bar_index` of the position's entry order fill.\nint entryIndex = strategy.opentrades.entry_bar_index(0)\n//@variable The `bar_index` of the position's close order fill.\nint exitIndex  = strategy.closedtrades.exit_bar_index(strategy.closedtrades - 1)\n\n//@variable The fill price simulated by the strategy.\nfloat fillPrice = switch bar_index\n    entryIndex =&gt; strategy.opentrades.entry_price(0)\n    exitIndex  =&gt; strategy.closedtrades.exit_price(strategy.closedtrades - 1)\n\n//@variable The expected fill price of the open market position.\nfloat expectedPrice = fillPrice ? open : na\n\ncolor expectedColor = na\ncolor filledColor   = na\n\nif bar_index == entryIndex\n    expectedColor := color.green\n    filledColor   := color.blue\nelse if bar_index == exitIndex\n    expectedColor := color.red\n    filledColor   := color.fuchsia\n\nplot(ma, color = color.new(color.orange, 50))\n\nplotchar(fillPrice ? open : na, \"Expected fill price\", \"\u2014\", location.absolute, expectedColor)\nplotchar(fillPrice, \"Fill price after slippage\", \"\u2014\", location.absolute, filledColor)</div>\n<p>Note that:</p>\n<ul>\n<li>Since the strategy applies constant slippage to all order fills, some orders can fill <em>outside</em> the candle range in the simulation. Exercise caution with this setting, as adding excessive simulated slippage can produce unrealistically worse testing results.</li>\n</ul>\n<p>Some traders might assume that they can avoid the adverse effects of slippage by using <a href=\"/pine-script-docs/v5/concepts/strategies/#limit-orders\">limit orders</a>, as unlike <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market orders</a>, they cannot execute at a worse price than the specified value. However, even if the market price reaches an order\u2019s price, there\u2019s a chance that a limit order might not fill, depending on the state of the real-life market, because limit orders can only fill if a security has sufficient liquidity and price action around their values. To account for the possibility of <em>unfilled</em> orders in a backtest, users can specify the <code dir=\"auto\">backtest_fill_limits_assumption</code> value in the declaration statement or use the \u201cVerify price for limit orders\u201d input in the \u201cSettings/Properties\u201d tab. This setting instructs the strategy to fill limit orders only after the market price moves a defined number of ticks past the order prices.</p>\n<p>The following example places a limit order of 2% equity at a bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlcc4\">hlcc4</a> price when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> is the <code dir=\"auto\">highest</code> value over the past <code dir=\"auto\">length</code> bars and there are no pending entries. The strategy closes the market position and cancels all orders after the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> is the <code dir=\"auto\">lowest</code> value. Each time the strategy triggers an order, it draws a horizontal line at the <code dir=\"auto\">limitPrice</code>, which it updates on each bar until closing the position or canceling the order:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Simulating-trading-costs-Slippage-and-unfilled-limits-2.izbF-BkC_2p4GEQ.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Verify price for limits example\", overlay = true,\n     default_qty_type = strategy.percent_of_equity, default_qty_value = 2\n )\n\nint length = input.int(25, title = \"Length\")\n\n//@variable Draws a line at the limit price of the most recent entry order.\nvar line limitLine = na\n\n// Highest high and lowest low\nhighest = ta.highest(length)\nlowest  = ta.lowest(length)\n\n// Place an entry order and draw a new line when the the `high` equals the `highest` value and `limitLine` is `na`.\nif high == highest and na(limitLine)\n    float limitPrice = hlcc4\n    strategy.entry(\"Long\", strategy.long, limit = limitPrice)\n    limitLine := line.new(bar_index, limitPrice, bar_index + 1, limitPrice)\n\n// Close the open market position, cancel orders, and set `limitLine` to `na` when the `low` equals the `lowest` value.\nif low == lowest\n    strategy.cancel_all()\n    limitLine := na\n    strategy.close_all()\n\n// Update the `x2` value of `limitLine` if it isn't `na`.\nif not na(limitLine)\n    limitLine.set_x2(bar_index + 1) \n\nplot(highest, \"Highest High\", color = color.new(color.green, 50))\nplot(lowest, \"Lowest Low\", color = color.new(color.red, 50))</div>\n<p>By default, the script assumes that all limit orders are guaranteed to fill when the market price reaches their values, which is often not the case in real-life trading. Let\u2019s add price verification to our limit orders to account for potentially unfilled ones. In this example, we\u2019ve included <code dir=\"auto\">backtest_fill_limits_assumption = 3</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> function call. As we can see, using limit verification omits some simulated order fills and changes the times of others, because the entry orders can now only fill after the price exceeds the limit price by <em>three ticks</em>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"680\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Simulating-trading-costs-Slippage-and-unfilled-limits-3.DDaLk5Eu_fLnmo.webp\" width=\"1342\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Limit verification can change the <em>times</em> of some order fills. However, strategies still execute verified limit orders at the same <em>prices</em>. This \u201ctime-warping\u201d effect is a compromise that preserves the prices of limit orders, but it can cause a strategy to fill the orders at times that wouldn\u2019t necessarily be possible in the real world. Therefore, users should exercise caution with this setting and understand its limitations when analyzing strategy results.</p></div></aside>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:15", "segment_order": 15, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"risk-management\"><a href=\"#risk-management\">Risk management<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Designing a strategy that performs well, especially in a broad class of markets, is a challenging task. Most strategies are designed for specific market patterns/conditions and can produce uncontrolled losses when applied to other data. Therefore, a strategy\u2019s risk management behavior can be critical to its performance. Programmers can set risk management criteria in their strategy scripts using the <code dir=\"auto\">strategy.risk.*()</code> commands.</p>\n<p>Strategies can incorporate any number of risk management criteria in any combination. All risk management commands execute <em>on every tick and order execution event</em>, regardless of any changes to the strategy\u2019s calculation behavior. There is no way to deactivate any of these commands on specific script executions. Irrespective of a risk management command\u2019s location, it <em>always</em> applies to the strategy unless the programmer removes the call from the code.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dallow_entry_in\">strategy.risk.allow_entry_in()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command overrides the market direction allowed for all <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a> commands in the script. When a user specifies the trade direction with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dallow_entry_in\">strategy.risk.allow_entry_in()</a> function (e.g., <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_strategy.direction.long\">long</a>) the strategy enters trades only in that direction. If a script calls an entry command in the opposite direction while there\u2019s an open market position, the strategy simulates a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> to <em>close</em> the position.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dmax_cons_loss_days\">strategy.risk.max_cons_loss_days()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command cancels all pending orders, closes any open market position, and stops all additional trade actions after the strategy simulates a defined number of trading days with consecutive losses.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dmax_drawdown\">strategy.risk.max_drawdown()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command cancels all pending orders, closes any open market position, and stops all additional trade actions after the strategy\u2019s drawdown reaches the amount specified in the function call.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dmax_intraday_filled_orders\">strategy.risk.max_intraday_filled_orders()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command specifies the maximum number of filled orders per trading day (or per chart bar if the timeframe is higher than daily). If the strategy creates more orders than  the maximum, the command cancels all pending orders, closes any open market position, and halts trading activity until the end of the current session.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dmax_intraday_loss\">strategy.risk.max_intraday_loss()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command controls the maximum loss the strategy tolerates per trading day (or per chart bar if the timeframe is higher than daily). When the strategy\u2019s losses reach this threshold, it cancels all pending orders, closes the open market position, and stops all trading activity until the end of the current session.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Drisk%7Bdot%7Dmax_position_size\">strategy.risk.max_position_size()</a></p>\n<p class=\"spacer-wrapper\"><spacer/>This command specifies the maximum possible position size when using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a> commands. If the quantity of an entry command results in a market position that exceeds this threshold, the strategy reduces the order quantity so that the resulting position does not exceed the limit.</p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:16", "segment_order": 16, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"margin\"><a href=\"#margin\">Margin<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Margin</em> is the minimum percentage of a market position that a trader must hold in their account as collateral to receive and sustain a loan from their broker to achieve their desired <em>leverage</em>. The <code dir=\"auto\">margin_long</code> and <code dir=\"auto\">margin_short</code> parameters of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement and the \u201cMargin for long/short positions\u201d inputs in the \u201cProperties\u201d tab of the script settings specify margin percentages for long and short positions. For example, if a trader sets the margin for long positions to 25%, they must have enough funds to cover 25% of an open long position. This margin percentage also means the trader can potentially spend up to 400% of their equity on their trades.</p>\n<p>If a strategy\u2019s simulated funds cannot cover the losses from a margin trade, the broker emulator triggers a <em>margin call</em>, which forcibly liquidates all or part of the open position. The exact number of contracts/shares/lots/units that the emulator liquidates is <em>four times</em> the amount required to cover the loss, which helps prevent constant margin calls on subsequent bars. The emulator determines liquidated quantity using the following algorithm:</p>\n<ol>\n<li>Calculate the amount of capital spent on the position: <code dir=\"auto\">Money Spent = Quantity * Entry Price</code></li>\n<li>Calculate the Market Value of Security (MVS): <code dir=\"auto\">MVS = Position Size * Current Price</code></li>\n<li>Calculate the Open Profit as the difference between <code dir=\"auto\">MVS</code> and <code dir=\"auto\">Money Spent</code>. If the position is short, multiply this value by -1.</li>\n<li>Calculate the strategy\u2019s equity value: <code dir=\"auto\">Equity = Initial Capital + Net Profit + Open Profit</code></li>\n<li>Calculate the margin ratio: <code dir=\"auto\">Margin Ratio = Margin Percent / 100</code></li>\n<li>Calculate the margin value, which is the cash required to cover the hypothetical account\u2019s portion of the position: <code dir=\"auto\">Margin = MVS * Margin Ratio</code></li>\n<li>Calculate the strategy\u2019s available funds: <code dir=\"auto\">Available Funds = Equity - Margin</code></li>\n<li>Calculate the total amount of money lost: <code dir=\"auto\">Loss = Available Funds / Margin Ratio</code></li>\n<li>Calculate the number of contracts/shares/lots/units the account must liquidate to cover the loss, truncated to the same decimal precision as the minimum position size for the current symbol: <code dir=\"auto\">Cover Amount = TRUNCATE(Loss / Current Price).</code></li>\n<li>Multiply the quantity required to cover the loss by four to determine the margin call size: <code dir=\"auto\">Margin Call Size = Cover Amount * 4</code></li>\n</ol>\n<p>To examine this calculation in detail, let\u2019s add the built-in Supertrend Strategy to the NASDAQ:TSLA\n chart on the \u201c1D\u201d timeframe and set the \u201cOrder size\u201d to 300% of equity and the \u201cMargin for long positions\u201d to 25% in the \u201cProperties\u201d tab of the strategy settings:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1200\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Margin-1.D7HQz6iZ_Z2vIF4D.webp\" width=\"2356\"/></p>\n<p>The first entry happened at the bar\u2019s opening price on 16 Sep 2010. The strategy bought 682,438 shares (Position Size) at 4.43 USD (Entry Price). Then, on 23 Sep 2010, when the price dipped to 3.9 (Current Price), the emulator forcibly liquidated 111,052 shares with a margin call. The calculations below show how the broker emulator determined this amount for the margin call event:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Money spent: 682438 * 4.43 = 3023200.34</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">MVS: 682438 * 3.9 = 2661508.2</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Open Profit: \u2212361692.14</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Equity: 1000000 + 0 \u2212 361692.14 = 638307.86</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Margin Ratio: 25 / 100 = 0.25</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Margin: 2661508.2 * 0.25 = 665377.05</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Available Funds: 638307.86 - 665377.05 = -27069.19</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Money Lost: -27069.19 / 0.25 = -108276.76</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Cover Amount: TRUNCATE(-108276.76 / 3.9) = TRUNCATE(-27763.27) = -27763</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">Margin Call Size: -27763 * 4 = - 111052</span></div></div></code></pre></figure></link></div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.margin_liquidation_price\">strategy.margin_liquidation_price</a> variable\u2019s value represents the price level that will cause a margin call if the market price reaches it. For more information about how margin works and the formula for calculating a position\u2019s margin call price, see <a href=\"https://www.tradingview.com/support/solutions/43000717375-how-do-i-simulate-trading-with-leverage/\">this page</a> in our Help Center.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:17", "segment_order": 17, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"using-strategy-information-in-scripts\"><a href=\"#using-strategy-information-in-scripts\">Using strategy information in scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Numerous built-ins within the <code dir=\"auto\">strategy.*</code> namespace and its <em>sub-namespaces</em> provide convenient solutions for programmers to use a strategy\u2019s trade and performance information, including data shown in the <a href=\"/pine-script-docs/v5/concepts/strategies/#strategy-tester\">Strategy Tester</a>, directly within their code\u2019s logic and calculations.</p>\n<p>Several <code dir=\"auto\">strategy.*</code> variables hold fundamental information about a strategy, including its starting capital, equity, profits and losses, run-up and drawdown, and open position:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.account_currency\">strategy.account_currency</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.initial_capital\">strategy.initial_capital</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.equity\">strategy.equity</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit\">strategy.netprofit</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit_percent\">strategy.netprofit_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossprofit\">strategy.grossprofit</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossprofit_percent\">strategy.grossprofit_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossloss\">strategy.grossloss</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossloss_percent\">strategy.grossloss_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.openprofit\">strategy.openprofit</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.openprofit_percent\">strategy.openprofit_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_runup\">strategy.max_runup</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_runup_percent\">strategy.max_runup_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_drawdown\">strategy.max_drawdown</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_drawdown_percent\">strategy.max_drawdown_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_avg_price\">strategy.position_avg_price</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_entry_name\">strategy.position_entry_name</a></li>\n</ul>\n<p>Additionally, the namespace features multiple variables that hold general trade information, such as the number of open and closed trades, the number of winning and losing trades, average trade profits, and maximum trade sizes:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades\">strategy.opentrades</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.closedtrades\">strategy.closedtrades</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.wintrades\">strategy.wintrades</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.losstrades\">strategy.losstrades</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.eventrades\">strategy.eventrades</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_trade\">strategy.avg_trade</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_trade_percent\">strategy.avg_trade_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_winning_trade\">strategy.avg_winning_trade</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_winning_trade_percent\">strategy.avg_winning_trade_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_losing_trade\">strategy.avg_losing_trade</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_losing_trade_percent\">strategy.avg_losing_trade_percent</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_contracts_held_all\">strategy.max_contracts_held_all</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_contracts_held_long\">strategy.max_contracts_held_long</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_contracts_held_short\">strategy.max_contracts_held_short</a></li>\n</ul>\n<p>Programmers can use these variables to display relevant strategy information on their charts, create customized trading logic based on strategy data, calculate custom performance metrics, and more.</p>\n<p>The following example demonstrates a few simple use cases for these <code dir=\"auto\">strategy.*</code> variables. The script uses them in its order placement and display calculations. When the calculated <code dir=\"auto\">rank</code> crosses above 10 and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades\">strategy.opentrades</a> value is 0, the script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> to place a \u201cBuy\u201d <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a>. On the following bar, where that order fills, it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> to create a <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a> order at a user-specified percentage below the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_avg_price\">strategy.position_avg_price</a>. If the <code dir=\"auto\">rank</code> crosses above 80 during the open trade, the script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close\">strategy.close()</a> to exit the position on the next bar.</p>\n<p>The script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the main chart pane displaying formatted strings containing the strategy\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit\">net profit</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit_percent\">net profit percentage</a>, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.account_currency\">account currency</a>, the number of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.wintrades\">winning trades</a> and the win percentage, the ratio of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_winning_trade\">average profit</a> to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_losing_trade\">average loss</a>, and the profit factor (the ratio of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossprofit\">gross profit</a> to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossloss\">gross loss</a>). It also plots the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.equity\">total equity</a> in a separate pane and highlights the pane\u2019s background based on the strategy\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.openprofit\">open profit</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Using-strategy-information-in-scripts-1.BielLwmZ_iHnPr.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Using strategy information demo\", default_qty_type = strategy.percent_of_equity, default_qty_value = 5, \n     margin_long = 100, margin_short = 100\n )\n\n//@variable The number of bars in the `rank` calculation.\nint lengthInput = input.int(50, \"Length\", 1)\n//@variable The stop-loss percentage.\nfloat slPercentInput = input.float(4.0, \"SL %\", 0.0, 100.0) / 100.0\n\n//@variable The percent rank of `close` prices over `lengthInput` bars.\nfloat rank = ta.percentrank(close, lengthInput)\n// Entry and exit signals.  \nbool entrySignal = ta.crossover(rank, 10) and strategy.opentrades == 0\nbool exitSignal  = ta.crossover(rank, 80) and strategy.opentrades == 1\n\n// Place orders based on the `entrySignal` and `exitSignal` occurrences. \nswitch\n    entrySignal    =&gt; strategy.entry(\"Buy\", strategy.long)\n    entrySignal[1] =&gt; strategy.exit(\"SL\", \"Buy\", stop = strategy.position_avg_price * (1.0 - slPercentInput))\n    exitSignal     =&gt; strategy.close(\"Buy\")\n\nif barstate.islastconfirmedhistory or barstate.isrealtime\n    //@variable A table displaying strategy information on the main chart pane. \n    var table dashboard = table.new(\n         position.top_right, 2, 10, border_color = chart.fg_color, border_width = 1, force_overlay = true\n     )\n    //@variable The strategy's currency.\n    string currency = strategy.account_currency\n    // Display the net profit as a currency amount and percentage.\n    dashboard.cell(0, 1, \"Net P/L\")\n    dashboard.cell(\n         1, 1, str.format(\"{0, number, 0.00} {1} ({2}%)\", strategy.netprofit, currency, strategy.netprofit_percent), \n         text_color = chart.fg_color, bgcolor = strategy.netprofit &gt; 0 ? color.lime : color.red\n     )\n    // Display the number of winning trades as an absolute value and percentage of all completed trades. \n    dashboard.cell(0, 2, \"Winning trades\")\n    dashboard.cell(\n         1, 2, str.format(\"{0} ({1, number, #.##%})\", strategy.wintrades, strategy.wintrades / strategy.closedtrades), \n         text_color = chart.fg_color, bgcolor = strategy.wintrades &gt; strategy.losstrades ? color.lime : color.red\n     )\n    // Display the ratio of average trade profit to average trade loss. \n    dashboard.cell(0, 3, \"Avg. win / Avg. loss\")\n    dashboard.cell(\n         1, 3, str.format(\"{0, number, #.###}\", strategy.avg_winning_trade / strategy.avg_losing_trade), \n         text_color = chart.fg_color, \n         bgcolor = strategy.avg_winning_trade &gt; strategy.avg_losing_trade ? color.lime : color.red\n     )\n    // Display the profit factor, i.e., the ratio of gross profit to gross loss. \n    dashboard.cell(0, 4, \"Profit factor\")\n    dashboard.cell(\n         1, 4, str.format(\"{0, number, #.###}\", strategy.grossprofit / strategy.grossloss), text_color = chart.fg_color, \n         bgcolor = strategy.grossprofit &gt; strategy.grossloss ? color.lime : color.red\n     )\n\n// Plot the current equity in a separate pane and highlight the pane's background while there is an open position.\nplot(strategy.equity, \"Total equity\", strategy.equity &gt; strategy.initial_capital ? color.teal : color.maroon, 3)\nbgcolor(\n     strategy.openprofit &gt; 0 ? color.new(color.teal, 80) : strategy.openprofit &lt; 0 ? color.new(color.maroon, 80) : na, \n     title = \"Open position highlight\"\n )</div>\n<p>Note that:</p>\n<ul>\n<li>This script creates a <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a> order one bar after the entry order because it uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_avg_price\">strategy.position_avg_price</a> to determine the price level. This variable has a non-na value only when the strategy has an <em>open position</em>.</li>\n<li>The script only draws the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the last historical bar and all realtime bars because the historical states of <a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a> are <strong>never visible</strong>. See the <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#reducing-drawing-updates\">Reducing drawing updates</a> section of the <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/\">Profiling and optimization</a> page for more information.</li>\n<li>We included <code dir=\"auto\">force_overlay = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.new\">table.new()</a> call to display the table on the main chart pane.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"individual-trade-information\"><a href=\"#individual-trade-information\">Individual trade information<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">strategy.*</code> namespace features two sub-namespaces that provide access to <em>individual trade</em> information: <code dir=\"auto\">strategy.opentrades.*</code> and <code dir=\"auto\">strategy.closedtrades.*</code>. The <code dir=\"auto\">strategy.opentrades.*</code> built-ins return data for <em>incomplete</em> (open) trades, and the <code dir=\"auto\">strategy.closedtrades.*</code> built-ins return data for <em>completed</em> (closed) trades. With these built-ins, programmers can use granular trade data in their scripts, allowing for more detailed strategy analysis and advanced calculations.</p>\n<p>Both sub-namespaces contain several similar functions that return information about a trade\u2019s orders, simulated costs, and profit/loss, including:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_id\">strategy.opentrades.entry_id()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_id\">strategy.closedtrades.entry_id()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_price\">strategy.opentrades.entry_price()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_price\">strategy.closedtrades.entry_price()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_bar_index\">strategy.opentrades.entry_bar_index()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_bar_index\">strategy.closedtrades.entry_bar_index()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_time\">strategy.opentrades.entry_time()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_time\">strategy.closedtrades.entry_time()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.entry_comment\">strategy.opentrades.entry_comment()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_comment\">strategy.closedtrades.entry_comment()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.size\">strategy.opentrades.size()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.size\">strategy.closedtrades.size()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.profit\">strategy.opentrades.profit()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.profit\">strategy.closedtrades.profit()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.profit_percent\">strategy.opentrades.profit_percent()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.profit_percent\">strategy.closedtrades.profit_percent()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.commission\">strategy.opentrades.commission()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.commission\">strategy.closedtrades.commission()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_runup\">strategy.opentrades.max_runup()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_runup\">strategy.closedtrades.max_runup()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_runup_percent\">strategy.opentrades.max_runup_percent()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_runup_percent\">strategy.closedtrades.max_runup_percent()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_drawdown\">strategy.opentrades.max_drawdown()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_drawdown\">strategy.closedtrades.max_drawdown()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_drawdown_percent\">strategy.opentrades.max_drawdown_percent()</a> / <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_drawdown_percent\">strategy.closedtrades.max_drawdown_percent()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_id\">strategy.closedtrades.exit_id()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_price\">strategy.closedtrades.exit_price()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_time\">strategy.closedtrades.exit_time()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_bar_index\">strategy.closedtrades.exit_bar_index()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_comment\">strategy.closedtrades.exit_comment()</a></li>\n</ul>\n<p>Note that:</p>\n<ul>\n<li>Most built-ins within these namespaces are <em>functions</em>. However, the <code dir=\"auto\">strategy.opentrades.*</code> namespace also features a unique <em>variable</em>: <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades.capital_held\">strategy.opentrades.capital_held</a>. Its value represents the amount of capital reserved by <em>all</em> open trades.</li>\n<li>Only the <code dir=\"auto\">strategy.closedtrades.*</code> namespace has <code dir=\"auto\">.exit_*()</code> functions that return information about <em>exit orders</em>.</li>\n</ul>\n<p>All <code dir=\"auto\">strategy.opentrades.*()</code> and <code dir=\"auto\">strategy.closedtrades.*()</code> functions have a <code dir=\"auto\">trade_num</code> parameter, which accepts an \u201cint\u201d value representing the index of the open or closed trade. The index of the first open/closed trade is 0, and the last trade\u2019s index is <em>one less</em> than the value of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades\">strategy.opentrades</a>/<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.closedtrades\">strategy.closedtrades</a> variable.</p>\n<p>The following example places up to five long entry orders per position, each with a unique ID, and it calculates metrics for specific closed trades.</p>\n<p>The strategy places a new entry order when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> crosses above its <code dir=\"auto\">median</code> without reaching the <code dir=\"auto\">highest</code> value, but only if the number of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades\">open trades</a> is less than five. It exits each position using <a href=\"/pine-script-docs/v5/concepts/strategies/#take-profit-and-stop-loss\">stop-loss</a> orders from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> or a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.close_all\">strategy.close_all()</a>. Each successive entry order\u2019s ID depends on the number of open trades. The first entry ID in each position is \u201cBuy0\u201d, and the last possible entry ID is \u201cBuy4\u201d.</p>\n<p>The script calls <code dir=\"auto\">strategy.closedtrades.*()</code> functions within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop to access closed trade <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_id\">entry IDs</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.profit\">profits</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.entry_bar_index\">entry bar indices</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.exit_bar_index\">exit bar indices</a>. It uses this information to calculate the total number of closed trades with the specified entry ID, the number of winning trades, the average number of bars per trade, and the total profit from all the trades. The script then organizes this information in a formatted string and displays it in a single-cell <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"500\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Using-strategy-information-in-scripts-Individual-trade-information-1.Clxqg8tA_Z1Uq1KB.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\n     \"Individual trade information demo\", pyramiding = 5, default_qty_type = strategy.percent_of_equity, \n     default_qty_value = 1, margin_long = 100, margin_short = 100\n )\n\n//@variable The number of bars in the `highest` and `lowest` calculation. \nint lengthInput = input.int(50, \"Length\", 1)\nstring idInput = input.string(\"Buy0\", \"Entry ID to analyze\", [\"Buy0\", \"Buy1\", \"Buy2\", \"Buy3\", \"Buy4\"])\n\n// Calculate the highest, lowest, and median `close` values over `lengthInput` bars.\nfloat highest = ta.highest(close, lengthInput)\nfloat lowest  = ta.lowest(close, lengthInput)\nfloat median  = 0.5 * (highest + lowest)\n\n// Define entry and stop-loss orders when the `close` crosses above the `median` without touching the `highest` value.\nif ta.crossover(close, median) and close != highest and strategy.opentrades &lt; 5\n    strategy.entry(\"Buy\" + str.tostring(strategy.opentrades), strategy.long) \n    if strategy.opentrades == 0\n        strategy.exit(\"SL\", stop = lowest)\n// Close the entire position when the `close` reaches the `lowest` value.\nif close == lowest\n    strategy.close_all()\n\n// The total number of closed trades with the `idInput` entry, the number of wins, the average number of bars, \n// and the total profit.\nint   trades  = 0\nint   wins    = 0\nfloat avgBars = 0\nfloat totalPL = 0.0\n\nif barstate.islastconfirmedhistory or barstate.isrealtime\n    //@variable A single-cell table displaying information about closed trades with the `idInput` entry ID. \n    var table infoTable = table.new(position.middle_center, 1, 1, color.purple)\n    // Iterate over closed trade indices.\n    for tradeNum = 0 to strategy.closedtrades - 1\n        // Skip the rest of the current iteration if the `tradeNum` closed trade didn't open with an `idInput` entry.\n        if strategy.closedtrades.entry_id(tradeNum) != idInput\n            continue\n        // Accumulate `trades`, `wins`, `avgBars`, and `totalPL` values.\n        float profit = strategy.closedtrades.profit(tradeNum)\n        trades  += 1\n        wins    += profit &gt; 0 ? 1 : 0\n        avgBars += strategy.closedtrades.exit_bar_index(tradeNum) - strategy.closedtrades.entry_bar_index(tradeNum) + 1\n        totalPL += profit\n    avgBars /= trades\n\n    //@variable A formatted string containing the calculated closed trade information. \n    string displayText = str.format(\n         \"ID: {0}\\n\\nTotal trades: {1}\\nWin trades: {2}\\nAvg. bars: {3}\\nTotal P/L: {4} {5}\",\n         idInput, trades, wins, avgBars, totalPL, strategy.account_currency\n     )\n    // Populate the table's cell with `displayText`. \n    infoTable.cell(0, 0, displayText, text_color = color.white, text_halign = text.align_left, text_size = size.large)\n\n// Plot the highest, median, and lowest values on the main chart pane. \nplot(highest, \"Highest close\", force_overlay = true)\nplot(median, \"Median close\", force_overlay = true)\nplot(lowest, \"Lowest close\", force_overlay = true)</div>\n<p>Note that:</p>\n<ul>\n<li>This strategy can open up to five long trades per position because we included <code dir=\"auto\">pyramiding = 5</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement. See the <a href=\"/pine-script-docs/v5/concepts/strategies/#pyramiding\">pyramiding</a> section for more information.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> instance in this script persists and generates exit orders for every entry in the open position because we did not specify a <code dir=\"auto\">from_entry</code> ID. See the <a href=\"/pine-script-docs/v5/concepts/strategies/#exits-for-multiple-entries\">Exits for multiple entries</a> section to learn more about this behavior.</li>\n</ul>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:18", "segment_order": 18, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"strategy-alerts\"><a href=\"#strategy-alerts\">Strategy alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script indicators (not strategies) have two different mechanisms to set up custom alert conditions: the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function, which tracks one specific condition per function call, and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function, which tracks all its calls simultaneously, but provides greater flexibility in the number of calls, alert messages, etc.</p>\n<p>Pine Script strategies cannot create alert triggers using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function, but they can create triggers with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function. Additionally, each <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement command</a> comes with its own built-in alert functionality that does not require any additional code to implement. As such, any strategy that uses an order placement command can issue alerts upon order execution. The precise mechanics of such built-in strategy alerts are described in the <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">Order Fill events</a> section of the <a href=\"/pine-script-docs/v5/concepts/alerts/\">Alerts</a> page.</p>\n<p>When a strategy uses both the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function and functions that create orders in the same script, the \u201cCreate Alert\u201d dialog box provides a choice between the conditions to use as a trigger: <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> events, order fill events, or both.</p>\n<p>For many trading strategies, the delay between a triggered alert and a live trade can be a critical performance factor. By default, strategy scripts can only execute <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function calls on the close of realtime bars, as if they used <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_alert%7Bdot%7Dfreq_once_per_bar_close\">alert.freq_once_per_bar_close</a>, regardless of the <code dir=\"auto\">freq</code> argument in the call. Users can change the alert frequency by including  <code dir=\"auto\">calc_on_every_tick = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> call or selecting the \u201cRecalculate/On every tick\u201d option in the \u201cSettings/Properties\u201d tab before creating the alert. However, depending on the script, this setting can adversely impact the strategy\u2019s behavior. See the <a href=\"/pine-script-docs/v5/concepts/strategies/#calc_on_every_tick\">`calc_on_every_tick`</a> section for more information.</p>\n<p>Order fill alert triggers do not suffer the same limitations as the triggers from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> calls, which makes them more suitable for sending alerts to third parties for automation. Alerts from order fill events execute <em>immediately</em>, unaffected by a script\u2019s <code dir=\"auto\">calc_on_every_tick</code> setting. Users can set the default message for order fill alerts via the <code dir=\"auto\">//@strategy_alert_message</code> compiler annotation. The text provided with this annotation populates the \u201cMessage\u201d field in the \u201cCreate Alert\u201d dialog box.</p>\n<p>The following script shows a simple example of a default order fill alert message. Above the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement, the script includes <code dir=\"auto\">@strategy_alert_message</code> with <a href=\"https://www.tradingview.com/support/solutions/43000531021-how-to-use-a-variable-value-in-alert/\"><em>placeholders</em></a> for the trade action, current position size, ticker name, and fill price values in the message text:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n//@strategy_alert_message {{strategy.order.action}} {{strategy.position_size}} {{ticker}} @ {{strategy.order.price}}\nstrategy(\"Alert Message Demo\", overlay = true)\nfloat fastMa = ta.sma(close, 5)\nfloat slowMa = ta.sma(close, 10)\n\nif ta.crossover(fastMa, slowMa)\n    strategy.entry(\"buy\", strategy.long)\n\nif ta.crossunder(fastMa, slowMa)\n    strategy.entry(\"sell\", strategy.short)\n\nplot(fastMa, \"Fast MA\", color.aqua)\nplot(slowMa, \"Slow MA\", color.orange)</div>\n<p>This script populates the \u201cCreate Alert\u201d dialog box with its default message when the user selects its name from the \u201cCondition\u201d dropdown tab:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"578\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-alerts-1.BxOEoyCe_ZM3QoM.webp\" width=\"902\"/></p>\n<p>When the alert fires, the strategy populates the placeholders in the alert message with their corresponding values. For example:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"360\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Strategies-Strategy-alerts-2.RsPPvOvM_1vSwtv.webp\" width=\"634\"/></p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:19", "segment_order": 19, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/strategies", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"notes-on-testing-strategies\"><a href=\"#notes-on-testing-strategies\">Notes on testing strategies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Testing and tuning strategies in historical and live market conditions can provide insight into a strategy\u2019s characteristics, potential weaknesses, and <em>possibly</em> its future potential. However, traders should always be aware of the biases and limitations of simulated strategy results, especially when using the results to support live trading decisions. This section outlines some caveats associated with strategy validation and tuning and possible solutions to mitigate their effects.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Although testing strategies on existing data might give traders helpful information about a strategy\u2019s qualities, it\u2019s important to note that neither the past nor the present guarantees the future. Financial markets can change rapidly and unpredictably, which can cause a strategy to sustain uncontrollable losses. Additionally, simulated results may not fully account for other real-world factors that can impact trading performance. Therefore, we recommend that traders thoroughly understand the limitations and risks of backtests and forward tests and consider them \u201cparts of the whole\u201d in their validation processes rather than basing decisions solely on the results.</p></div></aside>\n<h3 class=\"md-heading\" id=\"backtesting-and-forward-testing\"><a href=\"#backtesting-and-forward-testing\">Backtesting and forward testing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><em>Backtesting</em> is a technique to evaluate the historical performance of a trading strategy or model by simulating and analyzing its past results on historical market data. This technique assumes that a strategy\u2019s results on past data can provide insight into its strengths and weaknesses. When backtesting, many traders adjust the parameters of a strategy in an attempt to optimize its results. Analysis and optimization of historical results can help traders to gain a deeper understanding of a strategy. However, traders should always understand the risks and limitations when basing their decisions on optimized backtest results.</p>\n<p>It is prudent to also use realtime analysis as a tool for evaluating a trading system on a forward-looking basis. <em>Forward testing</em> aims to gauge the performance of a strategy in live market conditions, where factors such as trading costs, slippage, and liquidity can meaningfully affect its performance. While forward testing has the distinct advantage of not being affected by certain types of biases (e.g., lookahead bias or \u201cfuture data leakage\u201d), it does carry the disadvantage of being limited in the quantity of data to test. Therefore, although it can provide helpful insights into a strategy\u2019s performance in current market conditions, forward testing is not typically used on its own.</p>\n<h3 class=\"md-heading\" id=\"lookahead-bias\"><a href=\"#lookahead-bias\">Lookahead bias<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One typical issue in backtesting strategies that request alternate timeframe data, use repainting variables such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>, or alter calculation behavior for intrabar order fills, is the leakage of future data into the past during evaluation, which is known as <em>lookahead bias</em>. Not only is this bias a common cause of unrealistic strategy results, since the future is never actually knowable beforehand, but it is also one of the typical causes of strategy repainting.</p>\n<p>Traders can often confirm whether a strategy has lookahead bias by forward testing it on realtime data, where no known data exists beyond the latest bar. Since there is no future data to leak into the past on realtime bars, the strategy will behave differently on historical and realtime bars if its results have lookahead bias.</p>\n<p>To eliminate lookahead bias in a strategy:</p>\n<ul>\n<li>Do not use repainting variables that leak future values into the past in the order placement or cancellation logic.</li>\n<li>Do not include <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge%7Bdot%7Dlookahead_on\">barmerge.lookahead_on</a> in <code dir=\"auto\">request.*()</code> calls without offsetting the data series, as described in <a href=\"/pine-script-docs/v5/concepts/repainting/#future-leak-with-requestsecurity\">this</a> section of the <a href=\"/pine-script-docs/v5/concepts/repainting/\">Repainting</a> page.</li>\n<li>Use realistic strategy calculation behavior.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"selection-bias\"><a href=\"#selection-bias\">Selection bias<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Selection bias occurs when a trader analyzes only results on specific instruments or timeframes while ignoring others. This bias can distort the perspective of the strategy\u2019s robustness, which can impact trading decisions and performance optimizations. Traders can reduce the effects of selection bias by evaluating their strategies on multiple, ideally diverse, symbols and timeframes, and ensuring not to ignore poor performance results or \u201ccherry-pick\u201d testing ranges.</p>\n<h3 class=\"md-heading\" id=\"overfitting\"><a href=\"#overfitting\">Overfitting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A common problem when optimizing a strategy based on backtest results is overfitting (\u201ccurve fitting\u201d), which means tailoring the strategy for specific data. An overfitted strategy often fails to generalize well on new, unseen data. One widely-used approach to help reduce the potential for overfitting and promote better generalization is to split an instrument\u2019s data into two or more parts to test the strategy outside the sample used for optimization, otherwise known as \u201cin-sample\u201d (IS) and \u201cout-of-sample\u201d (OOS) backtesting.</p>\n<p>In this approach, traders optimize strategy parameters on the IS data, and they test the optimized configuration on the OOS data without additional fine-tuning. Although this and other, more robust approaches might provide a glimpse into how a strategy might fare after optimization, traders should still exercise caution. No trading strategy can guarantee future performance, regardless of the data used for optimization and testing, because the future is inherently unknowable.</p>", "segment_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033:20", "segment_order": 20, "segment_type": "guide_section", "source_artifact_id": "fd1cbee51f6dc32e8634487547f67c7c0f137c17c6182f990d94675bb63e4033", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/tables", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"tables\"><a href=\"#tables\">Tables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/tables", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Tables are objects that can be used to position information in specific\nand fixed locations in a script\u2019s visual space. Contrary to all other\nplots or objects drawn in Pine Script\u00ae, tables are not anchored to\nspecific bars; they <em>float</em> in a script\u2019s space, whether in overlay or\npane mode, in studies or strategies, independently of the chart bars\nbeing viewed or the zoom factor used.</p>\n<p>Tables contain cells arranged in columns and rows, much like a\nspreadsheet. They are created and populated in two distincts steps:</p>\n<ol>\n<li>A table\u2019s structure and key attributes are defined using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>,\nwhich returns a table ID that acts like a pointer to the table, just\nlike label, line, or array IDs do. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>\ncall will create the table object but does not display it.</li>\n<li>Once created, and for it to display, the table must be populated\nusing one\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\ncall for each cell. Table cells can contain text, or not. This\nsecond step is when the width and height of cells are defined.</li>\n</ol>\n<p>Most attributes of a previously created table can be changed using\n<code dir=\"auto\">table.set_*()</code> setter functions. Attributes of previously populated\ncells can be modified using <code dir=\"auto\">table.cell_set_*()</code> functions.</p>\n<p>A table is positioned in an indicator\u2019s space by anchoring it to one of\nnine references: the four corners or midpoints, including the center.\nTables are positioned by expanding the table from its anchor, so a table\nanchored to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dmiddle_right\">position.middle_right</a>\nreference will be drawn by expanding up, down and left from that anchor.</p>\n<p>Two modes are available to determine the width/height of table cells:</p>\n<ul>\n<li>A default automatic mode calculates the width/height of cells in a\ncolumn/row using the widest/highest text in them.</li>\n<li>An explicit mode allows programmers to define the width/height of\ncells using a percentage of the indicator\u2019s available x/y space.</li>\n</ul>\n<p>Displayed table contents always represent the last state of the table,\nas it was drawn on the script\u2019s last execution, on the dataset\u2019s last\nbar. Contrary to values displayed in the Data Window or in indicator\nvalues, variable contents displayed in tables will thus not change as a\nscript user moves his cursor over specific chart bars. For this reason,\nit is strongly recommended to always restrict execution of all\n<code dir=\"auto\">table.*()</code> calls to either the first or last bars of the dataset.\nAccordingly:</p>\n<ul>\n<li>Use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to declare tables.</li>\n<li>Enclose all other calls inside an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nblock.</li>\n</ul>\n<p><strong>Multiple tables can be used in one script, as long as they are each\nanchored to a different position. Each table object is identified by its\nown ID. Limits on the quantity of cells in all tables are determined by\nthe total number of cells used in one script.</strong></p>", "segment_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/tables", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"creating-tables\"><a href=\"#creating-tables\">Creating tables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When creating a table using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>,\nthree parameters are mandatory: the table\u2019s position and its number of\ncolumns and rows. Five other parameters are optional: the table\u2019s\nbackground color, the color and width of the table\u2019s outer frame, and\nthe color and width of the borders around all cells, excluding the outer\nframe. All table attributes except its number of columns and rows can be\nmodified using setter functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_position\">table.set_position()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_bgcolor\">table.set_bgcolor()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_frame_color\">table.set_frame_color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_frame_width\">table.set_frame_width()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_border_color\">table.set_border_color()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dset_border_width\">table.set_border_width()</a>.</p>\n<p>Tables can be deleted using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Ddelete\">table.delete()</a>,\nand their content can be selectively removed using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dclear\">table.clear()</a>.</p>\n<p>When populating cells using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>,\nyou must supply an argument for four mandatory parameters: the table id\nthe cell belongs to, its column and row index using indices that start\nat zero, and the text string the cell contains, which can be null. Seven\nother parameters are optional: the width and height of the cell, the\ntext\u2019s attributes (color, horizontal and vertical alignment, size), and\nthe cell\u2019s background color. All cell attributes can be modified using\nsetter functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text\">table.cell_set_text()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_width\">table.cell_set_width()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_height\">table.cell_set_height()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text_color\">table.cell_set_text_color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text_halign\">table.cell_set_text_halign()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text_valign\">table.cell_set_text_valign()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text_size\">table.cell_set_text_size()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_bgcolor\">table.cell_set_bgcolor()</a>.</p>\n<p>Keep in mind that each successive call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\nredefines <strong>all</strong> the cell\u2019s properties, deleting any properties set by\nprevious\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\ncalls on the same cell.</p>\n<h3 class=\"md-heading\" id=\"placing-a-single-value-in-a-fixed-position\"><a href=\"#placing-a-single-value-in-a-fixed-position\">Placing a single value in a fixed position<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Let\u2019s create our first table, which will place the value of ATR in the\nupper-right corner of the chart. We first create a one-cell table, then\npopulate that cell:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"ATR\", \"\", true)\n// We use `var` to only initialize the table on the first bar.\nvar table atrDisplay = table.new(position.top_right, 1, 1)\n// We call `ta.atr()` outside the `if` block so it executes on each bar.\nmyAtr = ta.atr(14)\nif barstate.islast\n    // We only populate the table on the last bar.\n    table.cell(atrDisplay, 0, 0, str.tostring(myAtr))</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"366\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Tables-ATR-1.aAFiA0fe_Z1KtXS4.webp\" width=\"1480\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword when creating the table with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>.</li>\n<li>We populate the cell inside an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nblock using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>.</li>\n<li>When populating the cell, we do not specify the <code dir=\"auto\">width</code> or <code dir=\"auto\">height</code>.\nThe width and height of our cell will thus adjust automatically to\nthe text it contains.</li>\n<li>We call <code dir=\"auto\">ta.atr(14)</code> prior to entry in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nblock so that it evaluates on each bar. Had we used\n<code dir=\"auto\">str.tostring(ta.atr(14))</code> inside the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nblock, the function would not have evaluated correctly because it\nwould be called on the dataset\u2019s last bar without having calculated\nthe necessary values from the previous bars.</li>\n</ul>\n<p>Let\u2019s improve the usability and aesthethics of our script:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"ATR\", \"\", true)\natrPeriodInput = input.int(14,  \"ATR period\", minval = 1, tooltip = \"Using a period of 1 yields True Range.\")\n\nvar table atrDisplay = table.new(position.top_right, 1, 1, bgcolor = color.gray, frame_width = 2, frame_color = color.black)\nmyAtr = ta.atr(atrPeriodInput)\nif barstate.islast\n    table.cell(atrDisplay, 0, 0, str.tostring(myAtr, format.mintick), text_color = color.white)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"368\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Tables-ATR-2.DwFmCnwy_Z1htA0D.webp\" width=\"1480\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>\nto define a background color, a frame color and its width.</li>\n<li>When populating the cell with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>,\nwe set the text to display in white.</li>\n<li>We pass\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_format%7Bdot%7Dmintick\">format.mintick</a>\nas a second argument to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>\nfunction to restrict the precision of ATR to the chart\u2019s tick\nprecision.</li>\n<li>We now use an input to allow the script user to specify the period\nof ATR. The input also includes a tooltip, which the user can see\nwhen he hovers over the \u201ci\u201d icon in the script\u2019s\n\u201cSettings/Inputs\u201d tab.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"coloring-the-charts-background\"><a href=\"#coloring-the-charts-background\">Coloring the chart\u2019s background<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This example uses a one-cell table to color the chart\u2019s background on\nthe bull/bear state of RSI:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Chart background\", \"\", true)\nbullColorInput = input.color(color.new(color.green, 95), \"Bull\", inline = \"1\")\nbearColorInput = input.color(color.new(color.red, 95), \"Bear\", inline = \"1\")\n// \u2014\u2014\u2014\u2014\u2014 Function colors chart bg on RSI bull/bear state.\ncolorChartBg(bullColor, bearColor) =&gt;\n    var table bgTable = table.new(position.middle_center, 1, 1)\n    float r = ta.rsi(close, 20)\n    color bgColor = r &gt; 50 ? bullColor : r &lt; 50 ? bearColor : na\n    if barstate.islast\n        table.cell(bgTable, 0, 0, width = 100, height = 100, bgcolor = bgColor)\n\ncolorChartBg(bullColorInput, bearColorInput)</div>\n<p>Note that:</p>\n<ul>\n<li>We provide users with inputs allowing them to specify the bull/bear\ncolors to use for the background, and send those input colors as\narguments to our <code dir=\"auto\">colorChartBg()</code> function.</li>\n<li>We create a new table only once, using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to declare the table.</li>\n<li>We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\non the last bar only, to specify the cell\u2019s properties. We make the\ncell the width and height of the indicator\u2019s space, so it covers\nthe whole chart.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"creating-a-display-panel\"><a href=\"#creating-a-display-panel\">Creating a display panel<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Tables are ideal to create sophisticated display panels. Not only do\nthey make it possible for display panels to always be visible in a\nconstant position, they provide more flexible formatting because each\ncell\u2019s properties are controlled separately: background, text color,\nsize and alignment, etc.</p>\n<p>Here, we create a basic display panel showing a user-selected quantity\nof MAs values. We display their period in the first column, then their\nvalue with a green/red/gray background that varies with price\u2019s\nposition with regards to each MA. When price is above/below the MA, the\ncell\u2019s background is colored with the bull/bear color. When the MA\nfalls between the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\nthe cell\u2019s background is of the neutral color:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1108\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Tables-DisplayPanel-1.BUQMSYyF_1oOTmO.webp\" width=\"1770\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Price vs MA\", \"\", true)\n\nvar string GP1 = \"Moving averages\"\nint     masQtyInput    = input.int(20, \"Quantity\", minval = 1, maxval = 40, group = GP1, tooltip = \"1-40\")\nint     masStartInput  = input.int(20, \"Periods begin at\", minval = 2, maxval = 200, group = GP1, tooltip = \"2-200\")\nint     masStepInput   = input.int(20, \"Periods increase by\", minval = 1, maxval = 100, group = GP1, tooltip = \"1-100\")\n\nvar string GP2 = \"Display\"\nstring  tableYposInput = input.string(\"top\", \"Panel position\", inline = \"11\", options = [\"top\", \"middle\", \"bottom\"], group = GP2)\nstring  tableXposInput = input.string(\"right\", \"\", inline = \"11\", options = [\"left\", \"center\", \"right\"], group = GP2)\ncolor   bullColorInput = input.color(color.new(color.green, 30), \"Bull\", inline = \"12\", group = GP2)\ncolor   bearColorInput = input.color(color.new(color.red, 30), \"Bear\", inline = \"12\", group = GP2)\ncolor   neutColorInput = input.color(color.new(color.gray, 30), \"Neutral\", inline = \"12\", group = GP2)\n\nvar table panel = table.new(tableYposInput + \"_\" + tableXposInput, 2, masQtyInput + 1)\nif barstate.islast\n    // Table header.\n    table.cell(panel, 0, 0, \"MA\", bgcolor = neutColorInput)\n    table.cell(panel, 1, 0, \"Value\", bgcolor = neutColorInput)\n\nint period = masStartInput\nfor i = 1 to masQtyInput\n    // \u2014\u2014\u2014\u2014\u2014 Call MAs on each bar.\n    float ma = ta.sma(close, period)\n    // \u2014\u2014\u2014\u2014\u2014 Only execute table code on last bar.\n    if barstate.islast\n        // Period in left column.\n        table.cell(panel, 0, i, str.tostring(period), bgcolor = neutColorInput)\n        // If MA is between the open and close, use neutral color. If close is lower/higher than MA, use bull/bear color.\n        bgColor = close &gt; ma ? open &lt; ma ? neutColorInput : bullColorInput : open &gt; ma ? neutColorInput : bearColorInput\n        // MA value in right column.\n        table.cell(panel, 1, i, str.tostring(ma, format.mintick), text_color = color.black, bgcolor = bgColor)\n    period += masStepInput</div>\n<p>Note that:</p>\n<ul>\n<li>Users can select the table\u2019s position from the inputs, as well as\nthe bull/bear/neutral colors to be used for the background of the\nright column\u2019s cells.</li>\n<li>The table\u2019s quantity of rows is determined using the number of MAs\nthe user chooses to display. We add one row for the column headers.</li>\n<li>Even though we populate the table cells on the last bar only, we\nneed to execute the calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>\non every bar so they produce the correct results. The compiler\nwarning that appears when you compile the code can be safely\nignored.</li>\n<li>We separate our inputs in two sections using <code dir=\"auto\">group</code>, and join the\nrelevant ones on the same line using <code dir=\"auto\">inline</code>. We supply tooltips to\ndocument the limits of certain fields using <code dir=\"auto\">tooltip</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"displaying-a-heatmap\"><a href=\"#displaying-a-heatmap\">Displaying a heatmap<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Our next project is a heatmap, which will indicate the bull/bear\nrelationship of the current price relative to its past values. To do so,\nwe will use a table positioned at the bottom of the chart. We will\ndisplay colors only, so our table will contain no text; we will simply\ncolor the background of its cells to produce our heatmap. The heatmap\nuses a user-selectable lookback period. It loops across that period to\ndetermine if price is above/below each bar in that past, and displays a\nprogressively lighter intensity of the bull/bear color as we go further\nin the past:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"576\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Tables-Heatmap-1.BRQU14P0_ZbbqpM.webp\" width=\"1794\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Price vs Past\", \"\", true)\n\nvar int MAX_LOOKBACK = 300\n\nint     lookBackInput  = input.int(150, minval = 1, maxval = MAX_LOOKBACK, step = 10)\ncolor   bullColorInput = input.color(#00FF00ff, \"Bull\", inline = \"11\")\ncolor   bearColorInput = input.color(#FF0080ff, \"Bear\", inline = \"11\")\n\n// \u2014\u2014\u2014\u2014\u2014 Function draws a heatmap showing the position of the current `_src` relative to its past `_lookBack` values.\ndrawHeatmap(src, lookBack) =&gt;\n    // float src     : evaluated price series.\n    // int   lookBack: number of past bars evaluated.\n    // Dependency: MAX_LOOKBACK\n\n    // Force historical buffer to a sufficient size.\n    max_bars_back(src, MAX_LOOKBACK)\n    // Only run table code on last bar.\n    if barstate.islast\n        var heatmap = table.new(position.bottom_center, lookBack, 1)\n        for i = 1 to lookBackInput\n            float transp = 100. * i / lookBack\n            if src &gt; src[i]\n                table.cell(heatmap, lookBack - i, 0, bgcolor = color.new(bullColorInput, transp))\n            else\n                table.cell(heatmap, lookBack - i, 0, bgcolor = color.new(bearColorInput, transp))\n\ndrawHeatmap(high, lookBackInput)</div>\n<p>Note that:</p>\n<ul>\n<li>We define a maximum lookback period as a <code dir=\"auto\">MAX_LOOKBACK</code> constant.\nThis is an important value and we use it for two purposes: to\nspecify the number of columns we will create in our one-row table,\nand to specify the lookback period required for the <code dir=\"auto\">_src</code> argument\nin our function, so that we force Pine Script to create a\nhistorical buffer size that will allow us to refer to the required\nquantity of past values of <code dir=\"auto\">_src</code> in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloop.</li>\n<li>We offer users the possibility of configuring the bull/bear colors\nin the inputs and we use <code dir=\"auto\">inline</code> to place the color selections on\nthe same line.</li>\n<li>Inside our function, we enclose our table-creation code in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nconstruct so that it only runs on the last bar of the chart.</li>\n<li>The initialization of the table is done inside the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstatement. Because of that, and the fact that it uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword, initialization only occurs the first time the script\nexecutes on a last bar. Note that this behavior is different from\nthe usual\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\ndeclarations in the script\u2019s global scope, where initialization\noccurs on the first bar of the dataset, at\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nzero.</li>\n<li>We do not specify an argument to the <code dir=\"auto\">text</code> parameter in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\ncalls, so an empty string is used.</li>\n<li>We calculate our transparency in such a way that the intensity of\nthe colors decreases as we go further in history.</li>\n<li>We use dynamic color generation to create different transparencies\nof our base colors as needed.</li>\n<li>Contrary to other objects displayed in Pine scripts, this heatmap\u2019s\ncells are not linked to chart bars. The configured lookback period\ndetermines how many table cells the heatmap contains, and the\nheatmap will not change as the chart is panned horizontally, or\nscaled.</li>\n<li>The maximum number of cells that can be displayed in the scritp\u2019s\nvisual space will depend on your viewing device\u2019s resolution and\nthe portion of the display used by your chart. Higher resolution\nscreens and wider windows will allow more table cells to be\ndisplayed.</li>\n</ul>", "segment_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/tables", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tips\"><a href=\"#tips\">Tips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ul>\n<li>When creating tables in strategy scripts, keep in mind that unless\nthe strategy uses <code dir=\"auto\">calc_on_every_tick = true</code>, table code enclosed\nin <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nblocks will not execute on each realtime update, so the table will\nnot display as you expect.</li>\n<li>Keep in mind that successive calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\noverwrite the cell\u2019s properties specified by previous\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\ncalls. Use the setter functions to modify a cell\u2019s properties.</li>\n<li>Remember to control the execution of your table code wisely by\nrestricting it to the necessary bars only. This saves server\nresources and your charts will display faster, so everybody wins.</li>\n</ul>", "segment_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "9770de95f51ac2bd9091fa6d7ce8bd6ec5a893103388271d4f7459cb8122891b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"text-and-shapes\"><a href=\"#text-and-shapes\">Text and shapes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You may display text or shapes using five different ways with Pine\nScript\u00ae:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a></li>\n<li>Labels created with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a></li>\n<li>Tables created with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a>\n(see <a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a>)</li>\n</ul>\n<p>Which one to use depends on your needs:</p>\n<ul>\n<li>Tables can display text in various relative positions on charts that\nwill not move as users scroll of zoom the chart horizontally. Their\ncontent is not tethered to bars. In contrast, text displayed with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nis always tethered to a specific bar, so it will move with the\nbar\u2019s position on the chart. See the page on\n<a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a> for more\ninformation on them.</li>\n<li>Three function include are able to display pre-defined shapes:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\nand Labels created with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\ncannot display text, only up or down arrows.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncan display non-dynamic text on any bar or all bars of the chart.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\ncan only display one character while\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncan display strings, including line breaks.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\ncan display a maximum of 500 labels on the chart. Its text <strong>can</strong>\ncontain dynamic text, or \u201cseries strings\u201d. Line breaks are also\nsupported in label text.</li>\n<li>While\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncan display text at a fixed offset in the past or the future, which\ncannot change during the script\u2019s execution, each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\ncall can use a \u201cseries\u201d offset that can be calculated on the fly.</li>\n</ul>\n<p>These are a few things to keep in mind concerning Pine Script strings:</p>\n<ul>\n<li>Since the <code dir=\"auto\">text</code> parameter in both\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nrequire a \u201cconst string\u201d argument, it cannot contain values such\nas prices that can only be known on the bar (\u201cseries string\u201d).</li>\n<li>To include \u201cseries\u201d values in text displayed using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>,\nthey will first need to be converted to strings using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>.</li>\n<li>The concatenation operator for strings in Pine is <code dir=\"auto\">+</code>. It is used to\njoin string components into one string, e.g.,\n<code dir=\"auto\">msg = \"Chart symbol: \" + syminfo.tickerid</code> (where\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtickerid\">syminfo.tickerid</a>\nis a built-in variable that returns the chart\u2019s exchange and symbol\ninformation in string format).</li>\n<li>Characters displayed by all these functions can be Unicode\ncharacters, which may include Unicode symbols. See this <a href=\"https://www.tradingview.com/script/0rFQOCKf-Exploring-Unicode/\">Exploring\nUnicode</a>\nscript to get an idea of what can be done with Unicode characters.</li>\n<li>The color or size of text can sometimes be controlled using function\nparameters, but no inline formatting (bold, italics, monospace,\netc.) is possible.</li>\n<li>Text from Pine scripts always displays on the chart in the Trebuchet\nMS font, which is used in many TradingView texts, including this\none.</li>\n</ul>\n<p>This script displays text using the four methods available in Pine\nScript:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Four displays of text\", overlay = true)\nplotchar(ta.rising(close, 5), \"`plotchar()`\", \"\ud83e\udc05\", location.belowbar, color.lime, size = size.small)\nplotshape(ta.falling(close, 5), \"`plotchar()`\", location = location.abovebar, color = na, text = \"\u2022`plotshape()\u2022`\\n\ud83e\udc07\", textcolor = color.fuchsia, size = size.huge)\n\nif bar_index % 25 == 0\n    label.new(bar_index, na, \"\u2022LABEL\u2022\\nHigh = \" + str.tostring(high, format.mintick) + \"\\n\ud83e\udc07\", yloc = yloc.abovebar, style = label.style_none, textcolor = color.black, size = size.normal)\n\nprintTable(txt) =&gt; var table t = table.new(position.middle_right, 1, 1), table.cell(t, 0, 0, txt, bgcolor = color.yellow)\nprintTable(\"\u2022TABLE\u2022\\n\" + str.tostring(bar_index + 1) + \" bars\\nin the dataset\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"566\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Introduction-01.Caf7GxqL_Z22HKK1.webp\" width=\"1348\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The method used to display each text string is shown with the text,\nexcept for the lime up arrows displayed using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\nas it can only display one character.</li>\n<li>Label and table calls can be inserted in conditional structures to\ncontrol when their are executed, whereas\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncannot. Their conditional plotting must be controlled using their\nfirst argument, which is a \u201cseries bool\u201d whose <code dir=\"auto\">true</code> or <code dir=\"auto\">false</code>\nvalue determines when the text is displayed.</li>\n<li>Numeric values displayed in the table and labels is first converted\nto a string using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>.</li>\n<li>We use the <code dir=\"auto\">+</code> operator to concatenate string components.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nis designed to display a shape with accompanying text. Its <code dir=\"auto\">size</code>\nparameter controls the size of the shape, not of the text. We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nfor its <code dir=\"auto\">color</code> argument so that the shape is not visible.</li>\n<li>Contrary to other texts, the table text will not move as you scroll\nor scale the chart.</li>\n<li>Some text strings contain the \ud83e\udc07 Unicode arrow (U+1F807).</li>\n<li>Some text strings contain the <code dir=\"auto\">\\n</code> sequence that represents a new\nline.</li>\n</ul>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotchar\"><a href=\"#plotchar\"><span>\u200b<code dir=\"auto\">plotchar()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This function is useful to display a single character on bars. It has\nthe following syntax:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plotchar(series, title, char, location, color, offset, text, textcolor, editable, size, show_last, display, force_overlay) \u2192 void</span></div></div></code></pre></figure></link></div>\n<p>See the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">Reference Manual entry for\nplotchar()</a>\nfor details on its parameters.</p>\n<p>As explained in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#without-affecting-the-scale\">Without affecting the scale</a> section of our page on\n<a href=\"/pine-script-docs/v5/writing/debugging/\">Debugging</a>, the function\ncan be used to display and inspect values in the Data Window or in the\nindicator values displayed to the right of the script\u2019s name on the\nchart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nplotchar(bar_index, \"Bar index\", \"\", location.top)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"532\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotchar-01.Bocx9V6g_Z13RLu0.webp\" width=\"1842\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The cursor is on the chart\u2019s last bar.</li>\n<li>The value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\non <strong>that</strong> bar is displayed in indicator values (1) and in the Data\nWindow (2).</li>\n<li>We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location%7Bdot%7Dtop\">location.top</a>\nbecause the default\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location%7Bdot%7Dabovebar\">location.abovebar</a>\nwill put the price into play in the script\u2019s scale, which will\noften interfere with other plots.</li>\n</ul>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nalso works well to identify specific points on the chart or to validate\nthat conditions are <code dir=\"auto\">true</code> when we expect them to be. This example\ndisplays an up arrow under bars where\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nhave all been rising for two bars:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nbool longSignal = ta.rising(close, 2) and ta.rising(high, 2) and (na(volume) or ta.rising(volume, 2))\nplotchar(longSignal, \"Long\", \"\u25b2\", location.belowbar, color = na(volume) ? color.gray : color.blue, size = size.tiny)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"480\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotchar-02.CP9gwRwQ_cuUlM.webp\" width=\"1770\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We use <code dir=\"auto\">(na(volume) or ta.rising(volume, 2))</code> so our script will\nwork on symbols without\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\ndata. If we did not make provisions for when there is no\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\ndata, which is what <code dir=\"auto\">na(volume)</code> does by being <code dir=\"auto\">true</code> when there is\nno volume, the <code dir=\"auto\">longSignal</code> variable\u2019s value would never be <code dir=\"auto\">true</code>\nbecause <code dir=\"auto\">ta.rising(volume, 2)</code> yields <code dir=\"auto\">false</code> in those cases.</li>\n<li>We display the arrow in gray when there is no volume, to remind us\nthat all three base conditions are not being met.</li>\n<li>Because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nis now displaying a character on the chart, we use\n<code dir=\"auto\">size = size.tiny</code> to control its size.</li>\n<li>We have adapted the <code dir=\"auto\">location</code> argument to display the character\nunder bars.</li>\n</ul>\n<p>If you don\u2019t mind plotting only circles, you could also use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nto achieve a similar effect:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlongSignal = ta.rising(close, 2) and ta.rising(high, 2) and (na(volume) or ta.rising(volume, 2))\nplot(longSignal ? low - ta.tr : na, \"Long\", color.blue, 2, plot.style_circles)</div>\n<p>This method has the inconvenience that, since there is no relative\npositioning mechanism with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\none must shift the circles down using something like\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ta%7Bdot%7Dtr\">ta.tr</a>\n(the bar\u2019s \u201cTrue Range\u201d):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"534\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotchar-03.lnUtjJIt_5GDoG.webp\" width=\"1408\"/></p>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotshape\"><a href=\"#plotshape\"><span>\u200b<code dir=\"auto\">plotshape()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This function is useful to display pre-defined shapes and/or text on\nbars. It has the following syntax:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plotshape(series, title, style, location, color, offset, text, textcolor, editable, size, show_last, display, force_overlay) \u2192 void</span></div></div></code></pre></figure></div>\n<p>See the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">Reference Manual entry for\nplotshape()</a>\nfor details on its parameters.</p>\n<p>Let\u2019s use the function to achieve more or less the same result as with\nour second example of the previous section:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlongSignal = ta.rising(close, 2) and ta.rising(high, 2) and (na(volume) or ta.rising(volume, 2))\nplotshape(longSignal, \"Long\", shape.arrowup, location.belowbar)</div>\n<p>Note that here, rather than using an arrow character, we are using the\n<code dir=\"auto\">shape.arrowup</code> argument for the <code dir=\"auto\">style</code> parameter.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"484\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotshape-01.JOPpSRCa_1wGGd4.webp\" width=\"1416\"/></p>\n<p>It is possible to use different\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncalls to superimpose text on bars. You will need to use <code dir=\"auto\">\\n</code> followed by\na special non-printing character that doesn\u2019t get stripped out to\npreserve the newline\u2019s functionality. Here we\u2019re using a Unicode\nZero-width space (U+200E). While you don\u2019t see it in the following\ncode\u2019s strings, it is there and can be copy/pasted. The special Unicode\ncharacter needs to be the <strong>last</strong> one in the string for text going up,\nand the <strong>first</strong> one when you are plotting under the bar and text is\ngoing down:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Lift text\", \"\", true)\nplotshape(true, \"\", shape.arrowup,   location.abovebar, color.green,  text = \"A\")\nplotshape(true, \"\", shape.arrowup,   location.abovebar, color.lime,   text = \"B\\n\u200b\")\nplotshape(true, \"\", shape.arrowdown, location.belowbar, color.red,    text = \"C\")\nplotshape(true, \"\", shape.arrowdown, location.belowbar, color.maroon, text = \"\u200b\\nD\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"618\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotshape-02.CuvXGcSI_3Ad17.webp\" width=\"1410\"/></p>\n<p>The available shapes you can use with the <code dir=\"auto\">style</code> parameter are:</p>\n<table><thead><tr><th>Argument</th><th>Shape</th><th>With Text</th><th>Argument</th><th>Shape</th><th>With Text</th></tr></thead><tbody><tr><td><code dir=\"auto\">shape.xcross</code></td><td><img alt=\"Plotshape_xcross\" decoding=\"async\" height=\"23\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_xcross.CqpTSatD_12B5cN.webp\" width=\"23\"/></td><td><img alt=\"Xcross_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Xcross_with_text.CsITFsrT_1pTrdp.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.arrowup</code></td><td><img alt=\"Plotshape_arrowup\" decoding=\"async\" height=\"26\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_arrowup.CW1yrDMp_Z1rr90M.webp\" width=\"27\"/></td><td><img alt=\"Arrowup_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrowup_with_text.DZDHU0_8_1FaupX.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">shape.cross</code></td><td><img alt=\"Plotshape_cross\" decoding=\"async\" height=\"23\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_cross.CKH3VPKx_Z2n6Nlr.webp\" width=\"23\"/></td><td><img alt=\"Cross_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Cross_with_text.CtReU8CU_ZIyc6H.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.arrowdown</code></td><td><img alt=\"Plotshape_arrowdown\" decoding=\"async\" height=\"26\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_arrowdown.B-q2lOyW_Z1DPN2R.webp\" width=\"27\"/></td><td><img alt=\"Arrowdown_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrowdown_with_text.DjuzMvwv_liley.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">shape.circle</code></td><td><img alt=\"Plotshape_circle\" decoding=\"async\" height=\"23\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_circle.C1i8wH61_Z1r7VpY.webp\" width=\"23\"/></td><td><img alt=\"Circle_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Circle_with_text.WA6whkZO_Z2ss0o7.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.square</code></td><td><img alt=\"Plotshape_square\" decoding=\"async\" height=\"26\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_square.C0HqeKpT_Z2vP0aj.webp\" width=\"26\"/></td><td><img alt=\"Square_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Square_with_text.Cs7f7vtU_ZQ5w6n.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">shape.triangleup</code></td><td><img alt=\"Plotshape_triangleup\" decoding=\"async\" height=\"23\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_triangleup.DSdn-Z9j_Z1evkl7.webp\" width=\"23\"/></td><td><img alt=\"Triangleup_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Triangleup_with_text.QVon6H1r_Z1B8FDq.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.diamond</code></td><td><img alt=\"Plotshape_diamond\" decoding=\"async\" height=\"27\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_diamond.CPu2rKgV_MWJwF.webp\" width=\"27\"/></td><td><img alt=\"Diamond_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Diamond_with_text.CGBBjhsU_1Mzs8I.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">shape.triangledown</code></td><td><img alt=\"Plotshape_triangledown\" decoding=\"async\" height=\"22\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_triangledown.D3CZ8Iw5_1K890M.webp\" width=\"23\"/></td><td><img alt=\"Triangledown_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Triangledown_with_text.BNalFnw6_Z26gke6.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.labelup</code></td><td><img alt=\"Plotshape_labelup\" decoding=\"async\" height=\"34\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_labelup.BEl-5lc0_Z2kYQOT.webp\" width=\"18\"/></td><td><img alt=\"Labelup_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Labelup_with_text.BZCbEuFR_Z1DJ1iU.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">shape.flag</code></td><td><img alt=\"Plotshape_flag\" decoding=\"async\" height=\"23\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_flag.Cj1OxWfL_1Hh1UW.webp\" width=\"23\"/></td><td><img alt=\"Flag_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Flag_with_text.PGNhrE2y_29i1uf.webp\" width=\"64\"/></td><td><code dir=\"auto\">shape.labeldown</code></td><td><img alt=\"Plotshape_labeldown\" decoding=\"async\" height=\"34\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Plotshape_labeldown.CoBObOmO_Z2sHwUh.webp\" width=\"18\"/></td><td><img alt=\"Labeldown_with_text\" decoding=\"async\" height=\"64\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Labeldown_with_text.lJXVqT03_Z2nweNY.webp\" width=\"64\"/></td></tr></tbody></table>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plotarrow\"><a href=\"#plotarrow\"><span>\u200b<code dir=\"auto\">plotarrow()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow</a>\nfunction displays up or down arrows of variable length, based on the\nrelative value of the series used in the function\u2019s first argument. It\nhas the following syntax:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">plotarrow(series, title, colorup, colordown, offset, minheight, maxheight, editable, show_last, display, force_overlay) \u2192 void</span></div></div></code></pre></figure></div>\n<p>See the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">Reference Manual entry for\nplotarrow()</a>\nfor details on its parameters.</p>\n<p>The <code dir=\"auto\">series</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\nis not a \u201cseries bool\u201d as in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>;\nit is a \u201cseries int/float\u201d and there\u2019s more to it than a simple\n<code dir=\"auto\">true</code> or <code dir=\"auto\">false</code> value determining when the arrows are plotted. This is\nthe logic governing how the argument supplied to <code dir=\"auto\">series</code> affects the\nbehavior of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>:</p>\n<ul>\n<li><code dir=\"auto\">series &gt; 0</code>: An up arrow is displayed, the length of which will be\nproportional to the relative value of the series on that bar in\nrelation to other series values.</li>\n<li><code dir=\"auto\">series &lt; 0</code>: A down arrow is displayed, proportionally-sized using\nthe same rules.</li>\n<li><code dir=\"auto\">series == 0 or na(series)</code>: No arrow is displayed.</li>\n</ul>\n<p>The maximum and minimum possible sizes for the arrows (in pixels) can be\ncontrolled using the <code dir=\"auto\">minheight</code> and <code dir=\"auto\">maxheight</code> parameters.</p>\n<p>Here is a simple script illustrating how\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\nworks:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nbody = close - open\nplotarrow(body, colorup = color.teal, colordown = color.orange)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"592\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotarrow-01.KkXXJXUI_Z1LV4X8.webp\" width=\"1405\"/></p>\n<p>Note how the heigth of arrows is proportional to the relative size of\nthe bar bodies.</p>\n<p>You can use any series to plot the arrows. Here we use the value of the\n\u201cChaikin Oscillator\u201d to control the location and size of the arrows:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Chaikin Oscillator Arrows\", overlay = true)\nfastLengthInput = input.int(3,  minval = 1)\nslowLengthInput = input.int(10, minval = 1)\nosc = ta.ema(ta.accdist, fastLengthInput) - ta.ema(ta.accdist, slowLengthInput)\nplotarrow(osc)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"684\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-Plotarrow-02.ChRmPIiy_Zb0OYl.webp\" width=\"1412\"/></p>\n<p>Note that we display the actual \u201cChaikin Oscillator\u201d in a pane below\nthe chart, so you can see what values are used to determine the position\nand size of the arrows.</p>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/text-and-shapes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"labels\"><a href=\"#labels\">Labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Labels are only available in v4 and higher versions of Pine Script.\nThey work very differently than\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>.</p>\n<p>Labels are objects, like\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">lines and boxes</a>, or\n<a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a>. Like them, they are\nreferred to using an ID, which acts like a pointer. Label IDs are of\n\u201clabel\u201d type. As with other objects, labels IDs are \u201ctime series\u201d\nand all the functions used to manage them accept \u201cseries\u201d arguments,\nwhich makes them very flexible.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>On TradingView charts, a complete set of <em>Drawing Tools</em> allows users to\ncreate and modify drawings using mouse actions. While they may sometimes\nlook similar to drawing objects created with Pine Script code, they are\nunrelated entities. Drawing objects created using Pine code cannot be\nmodified with mouse actions, and hand-drawn drawings from the chart user\ninterface are not visible from Pine scripts.</p></div></aside>\n<p>Labels are advantageous because:</p>\n<ul>\n<li>They allow \u201cseries\u201d values to be converted to text and placed on\ncharts. This means they are ideal to display values that cannot be\nknown before time, such as price values, support and resistance\nlevels, of any other values that your script calculates.</li>\n<li>Their positioning options are more flexible that those of the\n<code dir=\"auto\">plot*()</code> functions.</li>\n<li>They offer more display modes.</li>\n<li>Contrary to <code dir=\"auto\">plot*()</code> functions, label-handling functions can be\ninserted in conditional or loop structures, making it easier to\ncontrol their behavior.</li>\n<li>You can add tooltips to labels.</li>\n</ul>\n<p>One drawback to using labels versus\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nis that you can only draw a limited quantity of them on the chart. The\ndefault is ~50, but you can use the <code dir=\"auto\">max_labels_count</code> parameter in\nyour\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement to specify up to 500. Labels, like\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">lines and boxes</a>, are\nmanaged using a garbage collection mechanism which deletes the oldest\nones on the chart, such that only the most recently drawn labels are\nvisible.</p>\n<p>Your toolbox of built-ins to manage labels are all in the <code dir=\"auto\">label</code>\nnamespace. They include:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nto create labels.</li>\n<li><code dir=\"auto\">label.set_*()</code> functions to modify the properties of an existing\nlabel.</li>\n<li><code dir=\"auto\">label.get_*()</code> functions to read the properties of an existing\nlabel.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Ddelete\">label.delete()</a>\nto delete labels</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_label%7Bdot%7Dall\">label.all</a>\narray which always contains the IDs of all the visible labels on the\nchart. The array\u2019s size will depend on the maximum label count for\nyour script and how many of those you have drawn.\n<code dir=\"auto\">aray.size(label.all)</code> will return the array\u2019s size.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"creating-and-modifying-labels\"><a href=\"#creating-and-modifying-labels\">Creating and modifying labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nfunction creates a new label. It has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">label.new(x, y, text, xloc, yloc, color, style, textcolor, size, textalign, tooltip, force_overylay) \u2192 series label</span></div></div></code></pre></figure></div>\n<p>The <em>setter</em> functions allowing you to change a label\u2019s properties are:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_x\">label.set_x()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_y\">label.set_y()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xy\">label.set_xy()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_text\">label.set_text()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xloc\">label.set_xloc()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_yloc\">label.set_yloc()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_color\">label.set_color()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_style\">label.set_style()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_textcolor\">label.set_textcolor()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_size\">label.set_size()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_set_textalign\">label.set_textalign()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_tooltip\">label.set_tooltip()</a></li>\n</ul>\n<p>They all have a similar signature. The one for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_color\">label.set_color()</a>\nis:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">label.set_color(id, color) \u2192 void</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<ul>\n<li><code dir=\"auto\">id</code> is the ID of the label whose property is to be modified.</li>\n<li>The next parameter is the property of the label to modify. It\ndepends on the setter function used.\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xy\">label.set_xy()</a>\nchanges two properties, so it has two such parameters.</li>\n</ul>\n<p>This is how you can create labels in their simplest form:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlabel.new(bar_index, high)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"530\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-CreatingLabels-01.BHaO-o78_Y8WYV.webp\" width=\"1764\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The label is created with the parameters <code dir=\"auto\">x = bar_index</code> (the index\nof the current bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>)\nand <code dir=\"auto\">y = high</code> (the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nvalue).</li>\n<li>We do not supply an argument for the function\u2019s <code dir=\"auto\">text</code> parameter.\nIts default value being an empty string, no text is displayed.</li>\n<li>No logic controls our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\ncall, so labels are created on every bar.</li>\n<li>Only the last 54 labels are displayed because our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ncall does not use the <code dir=\"auto\">max_labels_count</code> parameter to specify a\nvalue other than the ~50 default.</li>\n<li>Labels persist on bars until your script deletes them using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Ddelete\">label.delete()</a>,\nor garbage collection removes them.</li>\n</ul>\n<p>In the next example we display a label on the bar with the highest\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nvalue in the last 50 bars:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n\n// Find the highest `high` in last 50 bars and its offset. Change it's sign so it is positive.\nLOOKBACK = 50\nhi = ta.highest(LOOKBACK)\nhighestBarOffset = - ta.highestbars(LOOKBACK)\n\n// Create label on bar zero only.\nvar lbl = label.new(na, na, \"\", color = color.orange, style = label.style_label_lower_left)\n// When a new high is found, move the label there and update its text and tooltip.\nif ta.change(hi)\n    // Build label and tooltip strings.\n    labelText = \"High: \" + str.tostring(hi, format.mintick)\n    tooltipText = \"Offest in bars: \" + str.tostring(highestBarOffset) + \"\\nLow: \" + str.tostring(low[highestBarOffset], format.mintick)\n    // Update the label's position, text and tooltip.\n    label.set_xy(lbl, bar_index[highestBarOffset], hi)\n    label.set_text(lbl, labelText)\n    label.set_tooltip(lbl, tooltipText)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"644\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-CreatingLabels-02.CaxmDfMG_1vmoqQ.webp\" width=\"1766\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We create the label on the first bar only by using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to declare the <code dir=\"auto\">lbl</code> variable that contains the label\u2019s ID.\nThe <code dir=\"auto\">x</code>, <code dir=\"auto\">y</code> and <code dir=\"auto\">text</code> arguments in that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\ncall are irrelevant, as the label will be updated on further bars.\nWe do, however, take care to use the <code dir=\"auto\">color</code> and <code dir=\"auto\">style</code> we want for\nthe labels, so they don\u2019t need updating later.</li>\n<li>On every bar, we detect if a new high was found by testing for\nchanges in the value of <code dir=\"auto\">hi</code></li>\n<li>When a change in the high value occurs, we update our label with new\ninformation. To do this, we use three <code dir=\"auto\">label.set*()</code> calls to change\nthe label\u2019s relevant information. We refer to our label using the\n<code dir=\"auto\">lbl</code> variable, which contains our label\u2019s ID. The script is thus\nmaintaining the same label throughout all bars, but moving it and\nupdating its information when a new high is detected.</li>\n</ul>\n<p>Here we create a label on each bar, but we set its properties\nconditionally, depending on the bar\u2019s polarity:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlbl = label.new(bar_index, na)\nif close &gt;= open\n    label.set_text( lbl, \"green\")\n    label.set_color(lbl, color.green)\n    label.set_yloc( lbl, yloc.belowbar)\n    label.set_style(lbl, label.style_label_up)\nelse\n    label.set_text( lbl, \"red\")\n    label.set_color(lbl, color.red)\n    label.set_yloc( lbl, yloc.abovebar)\n    label.set_style(lbl, label.style_label_down)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"642\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-CreatingLabels-03.ClglPmUL_Z1Jm6jL.webp\" width=\"1766\"/></p>\n<h3 class=\"md-heading\" id=\"positioning-labels\"><a href=\"#positioning-labels\">Positioning labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Labels are positioned on the chart according to <em>x</em> (bars) and <em>y</em>\n(price) coordinates. Five parameters affect this behavior: <code dir=\"auto\">x</code>, <code dir=\"auto\">y</code>,\n<code dir=\"auto\">xloc</code>, <code dir=\"auto\">yloc</code> and <code dir=\"auto\">style</code>:</p>\n<p><code dir=\"auto\">x</code></p>\n<p>Is either a bar index or a time value. When a bar index is used, the\nvalue can be offset in the past or in the future (maximum of 500\nbars in the future). Past or future offsets can also be calculated\nwhen using time values. The <code dir=\"auto\">x</code> value of an existing label can be\nmodified using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_x\">label.set_x()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xy\">label.set_xy()</a>.</p>\n<p><code dir=\"auto\">xloc</code></p>\n<p>Is either\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_index\">xloc.bar_index</a>\n(the default) or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>.\nIt determines which type of argument must be used with <code dir=\"auto\">x</code>. With\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_index\">xloc.bar_index</a>,\n<code dir=\"auto\">x</code> must be an absolute bar index. With\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>,\n<code dir=\"auto\">x</code> must be a UNIX time in milliseconds corresponding to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nvalue of a bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>.\nThe <code dir=\"auto\">xloc</code> value of an existing label can be modified using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xloc\">label.set_xloc()</a>.</p>\n<p><code dir=\"auto\">y</code></p>\n<p>Is the price level where the label is positioned. It is only taken\ninto account with the default <code dir=\"auto\">yloc</code> value of <code dir=\"auto\">yloc.price</code>. If\n<code dir=\"auto\">yloc</code> is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dabovebar\">yloc.abovebar</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dbelowbar\">yloc.belowbar</a>\nthen the <code dir=\"auto\">y</code> argument is ignored. The <code dir=\"auto\">y</code> value of an existing label\ncan be modified using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_y\">label.set_y()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xy\">label.set_xy()</a>.</p>\n<p><code dir=\"auto\">yloc</code></p>\n<p>Can be\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dprice\">yloc.price</a>\n(the default),\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dabovebar\">yloc.abovebar</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dbelowbar\">yloc.belowbar</a>.\nThe argument used for <code dir=\"auto\">y</code> is only taken into account with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dprice\">yloc.price</a>.\nThe <code dir=\"auto\">yloc</code> value of an existing label can be modified using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_yloc\">label.set_yloc()</a>.</p>\n<p><code dir=\"auto\">style</code></p>\n<p>The argument used has an impact on the visual appearance of the\nlabel and on its position relative to the reference point determined\nby either the <code dir=\"auto\">y</code> value or the top/bottom of the bar when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dabovebar\">yloc.abovebar</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_yloc%7Bdot%7Dbelowbar\">yloc.belowbar</a>\nare used. The <code dir=\"auto\">style</code> of an existing label can be modified using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_style\">label.set_style()</a>.</p>\n<p>These are the available <code dir=\"auto\">style</code> arguments:</p>\n<table><thead><tr><th>Argument</th><th>Label</th><th>Label with text</th><th>Argument</th><th>Label</th><th>Label with text</th></tr></thead><tbody><tr><td><code dir=\"auto\">label.style_xcross</code></td><td><img alt=\"label_style_xcross\" decoding=\"async\" height=\"43\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_xcross.C9JSUQRE_v14T2.webp\" width=\"45\"/></td><td><img alt=\"label_style_xcross_t\" decoding=\"async\" height=\"58\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_xcross_t.DPHiuTMd_ZArsHs.webp\" width=\"39\"/></td><td><code dir=\"auto\">label.style_label_up</code></td><td><img alt=\"label_style_label_up\" decoding=\"async\" height=\"32\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_labelup.BwgLLtO1_Z1l1um8.webp\" width=\"26\"/></td><td><img alt=\"label_style_label_up_t\" decoding=\"async\" height=\"39\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_labelup_t.BGJ7MtwJ_xL0VI.webp\" width=\"55\"/></td></tr><tr><td><code dir=\"auto\">label.style_cross</code></td><td><img alt=\"label_style_cross\" decoding=\"async\" height=\"33\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_cross.rv8J58or_Uz067.webp\" width=\"38\"/></td><td><img alt=\"label_style_cross_t\" decoding=\"async\" height=\"57\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_cross_t.CMucKs6T_ZSh4W0.webp\" width=\"41\"/></td><td><code dir=\"auto\">label.style_label_down</code></td><td><img alt=\"label_style_label_down\" decoding=\"async\" height=\"31\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_labeldown.BFAq-8ZE_ZIvq7L.webp\" width=\"26\"/></td><td><img alt=\"label_style_label_down_t\" decoding=\"async\" height=\"40\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_labeldown_t.L-NIjl15_k2Tfr.webp\" width=\"49\"/></td></tr><tr><td><code dir=\"auto\">label.style_flag</code></td><td><img alt=\"label_style_flag\" decoding=\"async\" height=\"41\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_flag.B5SqpJOR_ZNiesK.webp\" width=\"43\"/></td><td><img alt=\"label_style_flag_t\" decoding=\"async\" height=\"60\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_flag_t.Yd9se8TY_ZcPibj.webp\" width=\"40\"/></td><td><code dir=\"auto\">label.style_label_left</code></td><td><img alt=\"label_style_label_left\" decoding=\"async\" height=\"35\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelleft.CoJwMI_X_ZHLCfA.webp\" width=\"34\"/></td><td><img alt=\"label_style_label_left_t\" decoding=\"async\" height=\"57\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelleft_t.CMNu0DBH_Z1Mtkbi.webp\" width=\"70\"/></td></tr><tr><td><code dir=\"auto\">label.style_circle</code></td><td><img alt=\"label_style_circle\" decoding=\"async\" height=\"40\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_circle.B1NdiRhT_15VqGC.webp\" width=\"40\"/></td><td><img alt=\"label_style_circle_t\" decoding=\"async\" height=\"61\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_circle_t.DfdC3pj7_ZP9V9R.webp\" width=\"38\"/></td><td><code dir=\"auto\">label.style_label_right</code></td><td><img alt=\"label_style_label_right\" decoding=\"async\" height=\"36\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelright.DgXGrRa9_ipC7A.webp\" width=\"33\"/></td><td><img alt=\"label_style_label_right_t\" decoding=\"async\" height=\"55\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelright_t.D44pTqgu_2umAQq.webp\" width=\"65\"/></td></tr><tr><td><code dir=\"auto\">label.style_square</code></td><td><img alt=\"label_style_square\" decoding=\"async\" height=\"34\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_square.CUNIiJ9b_ZlvPE0.webp\" width=\"36\"/></td><td><img alt=\"label_style_square_t\" decoding=\"async\" height=\"61\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_square_t.-OUB179q_Z1BAnvM.webp\" width=\"36\"/></td><td><code dir=\"auto\">label.style_label_lower_left</code></td><td><img alt=\"label_style_label_lower_left\" decoding=\"async\" height=\"37\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labellowerleft.D2hZptp3_ZUxi8P.webp\" width=\"33\"/></td><td><img alt=\"label_style_label_lower_left_t\" decoding=\"async\" height=\"54\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labellowerleft_t.Kwxk7klP_Z18eq2A.webp\" width=\"67\"/></td></tr><tr><td><code dir=\"auto\">label.style_diamond</code></td><td><img alt=\"label_style_diamond\" decoding=\"async\" height=\"38\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_diamond.COncn0Zi_1lDxHq.webp\" width=\"36\"/></td><td><img alt=\"label_style_diamond_t\" decoding=\"async\" height=\"60\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_diamond_t.e7SsTV_d_VN69k.webp\" width=\"40\"/></td><td><code dir=\"auto\">label.style_label_lower_right</code></td><td><img alt=\"label_style_label_lower_right\" decoding=\"async\" height=\"40\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labellowerright.GvDkEi7V_Z2o0oHI.webp\" width=\"35\"/></td><td><img alt=\"label_style_label_lower_right_t\" decoding=\"async\" height=\"56\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labellowerright_t.CT8ecmHn_2dYi27.webp\" width=\"68\"/></td></tr><tr><td><code dir=\"auto\">label.style_triangleup</code></td><td><img alt=\"label_style_triangleup\" decoding=\"async\" height=\"39\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_triangleup.DHU9hA18_19xNp4.webp\" width=\"36\"/></td><td><img alt=\"label_style_triangleup_t\" decoding=\"async\" height=\"54\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_triangleup_t.C6XS8y_c_12VNsS.webp\" width=\"42\"/></td><td><code dir=\"auto\">label.style_label_upper_left</code></td><td><img alt=\"label_style_label_upper_left\" decoding=\"async\" height=\"37\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelupperleft.DzaMZ6Lm_Z2jdeMW.webp\" width=\"30\"/></td><td><img alt=\"label_style_label_upper_left_t\" decoding=\"async\" height=\"50\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelupperleft_t.jBf41_qj_1z9Nuv.webp\" width=\"64\"/></td></tr><tr><td><code dir=\"auto\">label.style_triangledown</code></td><td><img alt=\"label_style_triangledown\" decoding=\"async\" height=\"34\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_triangledown.CVD8jP47_AOqWU.webp\" width=\"40\"/></td><td><img alt=\"label_style_triangledown_t\" decoding=\"async\" height=\"61\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_triangledown_t.Ds2S1BfO_hU5ru.webp\" width=\"42\"/></td><td><code dir=\"auto\">label.style_label_upper_right</code></td><td><img alt=\"label_style_label_upper_right\" decoding=\"async\" height=\"37\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelupperright.Cs_tEjae_1q9D6Y.webp\" width=\"28\"/></td><td><img alt=\"label_style_label_upper_right_t\" decoding=\"async\" height=\"50\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelupperright_t.gHx7FqVU_2jKzoK.webp\" width=\"63\"/></td></tr><tr><td><code dir=\"auto\">label.style_arrowup</code></td><td><img alt=\"label_style_arrowup\" decoding=\"async\" height=\"36\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_arrowup.Bnnvniie_Zvzaa5.webp\" width=\"35\"/></td><td><img alt=\"label_style_arrowup_t\" decoding=\"async\" height=\"54\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_arrowup_t.CSukCsAU_Z2kIGh6.webp\" width=\"40\"/></td><td><code dir=\"auto\">label.style_label_center</code></td><td><img alt=\"label_style_label_center\" decoding=\"async\" height=\"38\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelcenter.BDNM-3_M_Z1yvaCH.webp\" width=\"34\"/></td><td><img alt=\"label_style_label_center_t\" decoding=\"async\" height=\"51\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-LabelStyles-labelcenter_t.DGjIAaki_VY0Yv.webp\" width=\"65\"/></td></tr><tr><td><code dir=\"auto\">label.style_arrowdown</code></td><td><img alt=\"label_style_arrowdown\" decoding=\"async\" height=\"35\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_arrowdown.DHUuQ7Xu_Z8bfOV.webp\" width=\"35\"/></td><td><img alt=\"label_style_arrowdown_t\" decoding=\"async\" height=\"56\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_arrowdown_t.BsY5apvs_iNdTw.webp\" width=\"37\"/></td><td><code dir=\"auto\">label.style_none</code></td><td></td><td><img alt=\"label_style_none_t\" decoding=\"async\" height=\"15\" loading=\"lazy\" src=\"/pine-script-docs/_astro/label.style_none_t.iibFInW6_1QhWd.webp\" width=\"32\"/></td></tr></tbody></table>\n<p>When using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>,\nthe <code dir=\"auto\">x</code> value must be a UNIX timestamp in milliseconds. See the page on\n<a href=\"/pine-script-docs/v5/concepts/time/\">Time</a> for more information.\nThe start time of the current bar can be obtained from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nbuilt-in variable. The bar time of previous bars is <code dir=\"auto\">time[1]</code>, <code dir=\"auto\">time[2]</code>\nand so on. Time can also be set to an absolute value with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp</a>\nfunction. You may add or subtract periods of time to achieve relative\ntime offset.</p>\n<p>Let\u2019s position a label one day ago from the date on the last bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\ndaysAgoInput = input.int(1, tooltip = \"Use negative values to offset in the future\")\nif barstate.islast\n    MS_IN_ONE_DAY = 24 * 60 * 60 * 1000\n    oneDayAgo = time - (daysAgoInput * MS_IN_ONE_DAY)\n    label.new(oneDayAgo, high, xloc = xloc.bar_time, style = label.style_label_right)</div>\n<p>Note that because of varying time gaps and missing bars when markets are\nclosed, the positioning of the label may not always be exact. Time\noffsets of the sort tend to be more reliable on 24x7 markets.</p>\n<p>You can also offset using a bar index for the <code dir=\"auto\">x</code> value, e.g.:</p>\n<div class=\"pine-colorizer not-content\">label.new(bar_index + 10, high)\nlabel.new(bar_index - 10, high[10])\nlabel.new(bar_index[10], high[10])</div>\n<h3 class=\"md-heading\" id=\"reading-label-properties\"><a href=\"#reading-label-properties\">Reading label properties<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The following <em>getter</em> functions are available for labels:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dget_x\">label.get_x()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dget_y\">label.get_y()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dget_text\">label.get_text()</a></li>\n</ul>\n<p>They all have a similar signature. The one for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dget_text\">label.get_text()</a>\nis:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">label.get_text(id) \u2192 series string</span></div></div></code></pre></figure></div>\n<p>where <code dir=\"auto\">id</code> is the label whose text is to be retrieved.</p>\n<h3 class=\"md-heading\" id=\"cloning-labels\"><a href=\"#cloning-labels\">Cloning labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dcopy\">label.copy()</a>\nfunction is used to clone labels. Its syntax is:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">label.copy(id) \u2192 void</span></div></div></code></pre></figure></div>\n<h3 class=\"md-heading\" id=\"deleting-labels\"><a href=\"#deleting-labels\">Deleting labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Ddelete\">label.delete()</a>\nfunction is used to delete labels. Its syntax is:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">label.delete(id) \u2192 void</span></div></div></code></pre></figure></div>\n<p>To keep only a user-defined quantity of labels on the chart, one could\nuse code like this:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nMAX_LABELS = 500\nindicator(\"\", max_labels_count = MAX_LABELS)\nqtyLabelsInput = input.int(5, \"Labels to keep\", minval = 0, maxval = MAX_LABELS)\nmyRSI = ta.rsi(close, 20)\nif myRSI &gt; ta.highest(myRSI, 20)[1]\n    label.new(bar_index, myRSI, str.tostring(myRSI, \"#.00\"), style = label.style_none)\n    if array.size(label.all) &gt; qtyLabelsInput\n        label.delete(array.get(label.all, 0))\nplot(myRSI)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"644\" loading=\"lazy\" src=\"/pine-script-docs/_astro/TextAndShapes-DeletingLabels-01.CQiqGcEC_ZRD1mW.webp\" width=\"1764\"/></p>\n<p>Note that:</p>\n<ul>\n<li>We define a <code dir=\"auto\">MAX_LABELS</code> constant to hold the maximum quantity of\nlabels a script can accommodate. We use that value to set the\n<code dir=\"auto\">max_labels_count</code> parameter\u2019s value in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ncall, and also as the <code dir=\"auto\">maxval</code> value in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dint\">input.int()</a>\ncall to cap the user value.</li>\n<li>We create a new label when our RSI breaches its highest value of the\nlast 20 bars. Note the offset of <code dir=\"auto\">[1]</code> we use in\n<code dir=\"auto\">if myRSI &gt; ta.highest(myRSI, 20)[1]</code>. This is necessary. Without\nit, the value returned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dhighest\">ta.highest()</a>\nwould always include the current value of <code dir=\"auto\">myRSI</code>, so <code dir=\"auto\">myRSI</code> would\nnever be higher than the function\u2019s return value.</li>\n<li>After that, we delete the oldest label in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_label%7Bdot%7Dall\">label.all</a>\narray that is automatically maintained by the Pine Script runtime\nand contains the ID of all the visible labels drawn by our script.\nWe use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dget\">array.get()</a>\nfunction to retrieve the array element at index zero (the oldest\nvisible label ID). We then use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Ddelete\">label.delete()</a>\nto delete the label linked with that ID.</li>\n</ul>\n<p>Note that if one wants to position a label on the last bar only, it is\nunnecessary and inefficent to create and delete the label as the script\nexecutes on all bars, so that only the last label remains:</p>\n<div class=\"pine-colorizer not-content\">// INEFFICENT!\n//@version=5\nindicator(\"\", \"\", true)\nlbl = label.new(bar_index, high, str.tostring(high, format.mintick))\nlabel.delete(lbl[1])</div>\n<p>This is the efficient way to realize the same task:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nif barstate.islast\n    // Create the label once, the first time the block executes on the last bar.\n    var lbl = label.new(na, na)\n    // On all iterations of the script on the last bar, update the label's information.\n    label.set_xy(lbl, bar_index, high)\n    label.set_text(lbl, str.tostring(high, format.mintick))</div>\n<h3 class=\"md-heading\" id=\"realtime-behavior\"><a href=\"#realtime-behavior\">Realtime behavior<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Labels are subject to both <em>commit</em> and <em>rollback</em> actions, which affect\nthe behavior of a script when it executes in the realtime bar. See the\npage on Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>.</p>\n<p>This script demonstrates the effect of rollback when running in the\nrealtime bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nlabel.new(bar_index, high)</div>\n<p>On realtime bars,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\ncreates a new label on every script update, but because of the rollback\nprocess, the label created on the previous update on the same bar is\ndeleted. Only the last label created before the realtime bar\u2019s close\nwill be committed, and thus persist.</p>", "segment_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "d9e1f0e5a80a0dd5bc20f12608ecbf988cf42b6c3a53aaa8ee9307cc8bb095aa", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/time\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"time\"><a href=\"#time\">Time<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script\u00ae, the following key aspects apply when working with date and time values:</p>\n<ul>\n<li><strong>UNIX timestamp</strong>: The native format for time values in Pine, representing the absolute number of <em>milliseconds</em> elapsed since midnight <a href=\"https://en.wikipedia.org/wiki/Coordinated_Universal_Time\" rel=\"nofollow\">UTC</a> on 1970-01-01. Several built-ins return UNIX timestamps directly, which users can <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">format</a> into readable dates and times. See the <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> section below for more information.</li>\n<li><strong>Exchange time zone</strong>: The <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a> of the instrument\u2019s exchange. All <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-variables\">calendar-based variables</a> hold values expressed in the exchange time zone, and all built-in function overloads that have a <code dir=\"auto\">timezone</code> parameter use this time zone by default.</li>\n<li><strong>Chart time zone</strong>: The time zone the chart and <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> message prefixes use to express time values. Users can set the chart time zone using the \u201cTimezone\u201d input in the \u201cSymbol\u201d tab of the chart\u2019s settings. This setting only changes the <em>display</em> of dates and times on the chart and the times that prefix logged messages. It does <strong>not</strong> affect the behavior of Pine scripts because they cannot access a chart\u2019s time zone information.</li>\n<li><strong><code dir=\"auto\">timezone</code> parameter</strong>: A \u201cstring\u201d parameter of time-related functions that specifies the time zone used in their calculations. For <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-functions\">calendar-based functions</a>, such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a>, the <code dir=\"auto\">timezone</code> parameter determines the time zone of the returned value. For functions that return UNIX timestamps, such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>, the specified <code dir=\"auto\">timezone</code> defines the time zone of other applicable parameters, e.g., <code dir=\"auto\">session</code>. See the <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">Time zone strings</a> section to learn more.</li>\n</ul>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"unix-timestamps\"><a href=\"#unix-timestamps\">UNIX timestamps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"https://en.wikipedia.org/wiki/Unix_time\" rel=\"nofollow\">UNIX time</a> is a standardized date and time representation that measures the number of <em>non-leap seconds</em> elapsed since January 1, 1970 at 00:00:00 <a href=\"https://en.wikipedia.org/wiki/Coordinated_Universal_Time\" rel=\"nofollow\">UTC</a> (the <em>UNIX Epoch</em>), typically expressed in seconds or smaller time units. A UNIX time value in Pine Script is an \u201cint\u201d <em>timestamp</em> representing the number of <em>milliseconds</em> from the UNIX Epoch to a specific point in time.</p>\n<p>Because a UNIX timestamp represents the number of consistent time units elapsed from a fixed historical point (epoch), its value is <strong>time zone-agnostic</strong>. A UNIX timestamp in Pine always corresponds to the same distinct point in time, accurate to the millisecond, regardless of a user\u2019s location.</p>\n<p>For example, the UNIX timestamp <code dir=\"auto\">1723472500000</code> always represents the time 1,723,472,500,000 milliseconds (1,723,472,500 seconds) after the UNIX Epoch. This timestamp\u2019s meaning does <strong>not</strong> change relative to any <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>.</p>\n<p>To <em>format</em> an \u201cint\u201d UNIX timestamp into a readable date/time \u201cstring\u201d expressed in a specific time zone, use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function. The function does not <em>modify</em> UNIX timestamps. It simply <em>represents</em> timestamps in a desired human-readable format.</p>\n<p>For instance, the function can represent the UNIX timestamp <code dir=\"auto\">1723472500000</code> as a \u201cstring\u201d in several ways, depending on its <code dir=\"auto\">format</code> and <code dir=\"auto\">timezone</code> arguments, without changing the <em>absolute</em> point in time that it refers to. The simple script below calculates three valid representations of this timestamp and displays them in the <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"316\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Unix-timestamps-1.CTbXturQ_ZA7lsx.webp\" width=\"1040\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"UNIX timestamps demo\")\n\n//@variable A UNIX time value representing the specific point 1,723,472,500,000 ms after the UNIX Epoch. \nint unixTimestamp = 1723472500000\n\n// These are a few different ways to express the `unixTimestamp` in a relative, human-readable format.\n// Despite their format and time zone differences, all the calculated strings represent the SAME distinct point: \nstring isoExchange  = str.format_time(unixTimestamp)\nstring utcDateTime  = str.format_time(unixTimestamp, \"MM/dd/yyyy HH:mm:ss.S\", \"UTC+0\")\nstring utc4TimeDate = str.format_time(unixTimestamp, \"hh:mm:ss a, MMMM dd, yyyy z\", \"UTC+4\")\n\n// Log the `unixTimestamp` and the custom \"string\" representations on the first bar.\nif barstate.isfirst\n    log.info(\n         \"\\nUNIX time (ms): {0, number, #}\\n\n         ISO 8601 representation (Exchange time zone): {1}\\n\n         Custom date and time representation (UTC+0 time zone): {2}\\n\n         Custom time and date representation (UTC+4 time zone): {3}\",\n         unixTimestamp, isoExchange, utcDateTime, utc4TimeDate\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>The value enclosed within square brackets in the logged message is an <em>automatic</em> prefix representing the historical time of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a> call in <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow\">ISO 8601</a> format, expressed in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">chart time zone</a>.</li>\n</ul>\n<p>See the <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">Formatting dates and times</a> section to learn more about representing UNIX timestamps with formatted strings.</p>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"time-zones\"><a href=\"#time-zones\">Time zones<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A <a href=\"https://en.wikipedia.org/wiki/Time_zone\" rel=\"nofollow\">time zone</a> is a geographic region with an assigned <em>local time</em>. The specific time within a time zone is consistent throughout the region. Time zone boundaries typically relate to a location\u2019s longitude. However, in practice, they tend to align with administrative boundaries rather than strictly following longitudinal lines.</p>\n<p>The local time within a time zone depends on its defined <em>offset</em> from <a href=\"https://en.wikipedia.org/wiki/Coordinated_Universal_Time\" rel=\"nofollow\">Coordinated Universal Time (UTC)</a>, which can range from UTC-12:00 (12 hours <em>behind</em> UTC) to UTC+14:00 (14 hours <em>ahead</em> of UTC). Some regions maintain a consistent offset from UTC, and others have an offset that changes over time due to <a href=\"https://en.wikipedia.org/wiki/Daylight_saving_time\" rel=\"nofollow\">daylight saving time (DST)</a> and other factors.</p>\n<p>Two primary time zones apply to data feeds and TradingView charts: the <em>exchange time zone</em> and the <em>chart time zone</em>.</p>\n<p>The exchange time zone represents the time zone of the current symbol\u2019s <em>exchange</em>, which Pine scripts can access with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> variable. <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-variables\">Calendar-based variables</a>, such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_month\">month</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofweek\">dayofweek</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hour\">hour</a>, always hold values expressed in the exchange time zone, and all time function overloads that have a <code dir=\"auto\">timezone</code> parameter use this time zone by default.</p>\n<p>The chart time zone is a <em>visual preference</em> that defines how the chart and the time prefixes of <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> represent time values. To set the chart time zone, use the \u201cTimezone\u201d input in the \u201cSymbol\u201d tab of the chart\u2019s settings or click on the current time shown below the chart. The specified time zone does <strong>not</strong> affect time calculations in Pine scripts because they cannot access this chart information. Although scripts cannot access a chart\u2019s time zone, programmers can provide <a href=\"/pine-script-docs/v5/concepts/inputs/\">inputs</a> that users can adjust to match the time zone.</p>\n<p>For example, the script below uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> to represent the <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> of the last historical bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">opening time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">closing time</a> as date-time strings, expressed in the function\u2019s default time zone, the exchange time zone, UTC-0, and a user-specified time zone. It displays all four representations for comparison within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> in the bottom-right corner of the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"506\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-zones-1.BAv9QYBX_jNyY.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Time zone comparison demo\", overlay = true) \n\n//@variable The time zone of the time values in the last table row. \n//          The \"string\" can contain either UTC offset notation or an IANA time zone identifier. \nstring timezoneInput = input.string(\"UTC+4:00\", \"Time zone\")\n\n//@variable A `table` showing strings representing bar times in three preset time zones and a custom time zone. \nvar table displayTable = table.new(\n     position.bottom_right, columns = 3, rows = 5, border_color = chart.fg_color, border_width = 2\n )\n\n//@function Initializes three `displayTable` cells on the `row` that show the `title`, `text1`, and `text2` strings. \ntableRow(int row, string title, string text1, string text2, color titleColor = #9b27b066, color infoColor = na) =&gt;\n    displayTable.cell(0, row, title, bgcolor = titleColor, text_color = chart.fg_color)\n    displayTable.cell(1, row, text1, bgcolor = infoColor,  text_color = chart.fg_color)\n    displayTable.cell(2, row, text2, bgcolor = infoColor,  text_color = chart.fg_color)\n\nif barstate.islastconfirmedhistory\n    // Draw an empty label to signify the bar that the displayed time strings represent.\n    label.new(bar_index, high, color = #9b27b066, size = size.huge)\n\n    //@variable The formatting string for all `str.format_time()` calls. Sets the format of the date-time strings. \n    var string formatString = \"yyyy-MM-dd  HH:mm:ss\"\n    // Initialize a header row at the top of the `displayTable`.\n    tableRow(0, \"\", \"OPEN time\", \"CLOSE time\", na, #9b27b066)\n    // Initialize a row showing the bar's times in the default time zone (no specified `timezone` arguments).\n    tableRow(1, \"Default\", str.format_time(time, formatString), str.format_time(time_close, formatString))\n    // Initialize a row showing the bar's times in the exchange time zone (`syminfo.timezone`).\n    tableRow(2, \"Exchange: \" + syminfo.timezone, \n         str.format_time(time, formatString, syminfo.timezone),\n         str.format_time(time_close, formatString, syminfo.timezone)\n     )  \n    // Initialize a row showing the bar's times in the UTC-0 time zone (using \"UTC\" as the `timezone` arguments).\n    tableRow(3, \"UTC-0\", str.format_time(time, formatString, \"UTC\"), str.format_time(time_close, formatString, \"UTC\"))\n    \n    // Initialize a row showing the bar's times in the custom time zone (`timezoneInput`).\n    tableRow(\n         4, \"Custom: \" + timezoneInput, \n         str.format_time(time, formatString, timezoneInput), \n         str.format_time(time_close, formatString, timezoneInput)\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> on the chart signifies which bar\u2019s times the displayed strings represent.</li>\n<li>The \u201cDefault\u201d and \u201cExchange\u201d rows in the table show identical results because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> is the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function\u2019s default <code dir=\"auto\">timezone</code> argument.</li>\n<li>The exchange time zone on our example chart appears as <code dir=\"auto\">\"America/New_York\"</code>, the <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow\">IANA identifier</a> for the NASDAQ exchange\u2019s time zone. It represents UTC-4 <em>or</em> UTC-5, depending on the time of year. See the <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">next section</a> to learn more about time zone strings.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"time-zone-strings\"><a href=\"#time-zone-strings\">Time zone strings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>All built-in functions with a <code dir=\"auto\">timezone</code> parameter accept a \u201cstring\u201d argument specifying the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a> they use in their calculations. These functions can accept time zone strings in either of the following formats:</p>\n<ul>\n<li><strong>UTC</strong> (or <em>GMT</em>) offset notation, e.g., <code dir=\"auto\">\"UTC-5\"</code>, <code dir=\"auto\">\"UTC+05:30\"</code>, <code dir=\"auto\">\"GMT+0100\"</code></li>\n<li><strong>IANA database</strong> notation, e.g., <code dir=\"auto\">\"America/New_York\"</code>, <code dir=\"auto\">\"Asia/Calcutta\"</code>, <code dir=\"auto\">\"Europe/Paris\"</code></li>\n</ul>\n<p>The <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow\">IANA time zone database</a> reference page lists possible time zone identifiers and their respective UTC offsets. The listed identifiers are valid as <code dir=\"auto\">timezone</code> arguments.</p>\n<p>Note that various time zone strings expressed in UTC or IANA notation can represent the <em>same</em> offset from Coordinated Universal Time. For instance, these strings all represent a local time three hours ahead of UTC:</p>\n<ul>\n<li><code dir=\"auto\">\"UTC+3\"</code></li>\n<li><code dir=\"auto\">\"GMT+03:00\"</code></li>\n<li><code dir=\"auto\">\"Asia/Kuwait\"</code></li>\n<li><code dir=\"auto\">\"Europe/Moscow\"</code></li>\n<li><code dir=\"auto\">\"Africa/Nairobi\"</code></li>\n</ul>\n<p>For the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function and the functions that calculate calendar-based values from a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a>, including <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a>, the \u201cstring\u201d passed to the <code dir=\"auto\">timezone</code> parameter changes the returned value\u2019s calculation to express the result in the specified time zone. See the <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">Formatting dates and times</a> and <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-functions\">Calendar-based functions</a> sections for more information.</p>\n<p>The example below shows how time zone strings affect the returned values of calendar-based functions. This script uses three <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a> function calls to calculate \u201cint\u201d values representing the opening hour of each bar in the exchange time zone, UTC-0, and a user-specified UTC offset. It plots all three calculated hours in a separate pane for comparison:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-1.CWMAwPYS_ZN7mN7.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Time zone strings in calendar functions demo\")\n\n//@variable An \"int\" representing the user-specified hourly offset from UTC. \nint utcOffsetInput = input.int(defval = 4, title =\"Timezone offset UTC (+/-)\", minval = -12, maxval = 14)\n\n//@variable A valid time zone string based on the `utcOffsetInput`, in UTC offset notation (e.g., \"UTC-4\").\nstring customOffset = \"UTC\" + (utcOffsetInput &gt; 0 ? \"+\" : \"\") + str.tostring(utcOffsetInput)\n\n//@variable The bar's opening hour in the exchange time zone (default). Equivalent to the `hour` variable.\nint exchangeHour = hour(time)\n//@variable The bar's opening hour in the \"UTC-0\" time zone. \nint utcHour = hour(time, \"UTC-0\")\n//@variable The bar's opening hour in the `customOffset` time zone.\nint customOffsetHour = hour(time, customOffset)\n\n// Plot the `exchangeHour`, `utcHour`, and `customOffsetHour` for comparison.\nplot(exchangeHour,     \"Exchange hour\",      #E100FF5B,    8)\nplot(utcHour,          \"UTC-0 hour\",         color.blue,   3)\nplot(customOffsetHour, \"Custom offset hour\", color.orange, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">exchangeHour</code> value is four <em>or</em> five hours behind the <code dir=\"auto\">utcHour</code> because the NASDAQ exchange is in the \u201cAmerica/New_York\u201d time zone. This time zone has a UTC offset that <em>changes</em> during the year due to daylight saving time (DST). The script\u2019s default <code dir=\"auto\">customOffsetHour</code> is consistently four hours ahead of the <code dir=\"auto\">utcHour</code> because its time zone is UTC+4.</li>\n<li>The call to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a> function without a specified <code dir=\"auto\">timezone</code> argument returns the same value that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hour\">hour</a> <em>variable</em> holds because both represent the bar\u2019s opening hour in the exchange time zone (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a>).</li>\n</ul>\n<p>For functions that return <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> directly, such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a>, the <code dir=\"auto\">timezone</code> parameter defines the time zone of the function\u2019s calendar-based <em>parameters</em>, including <code dir=\"auto\">session</code>, <code dir=\"auto\">year</code>, <code dir=\"auto\">month</code>, <code dir=\"auto\">day</code>, <code dir=\"auto\">hour</code>, <code dir=\"auto\">minute</code>, and <code dir=\"auto\">second</code>. The parameter does <em>not</em> determine the time zone of the returned value, as UNIX timestamps are <em>time zone-agnostic</em>. See the <a href=\"/pine-script-docs/v5/concepts/time/#testing-for-sessions\">Testing for sessions</a> and <a href=\"/pine-script-docs/v5/concepts/time/#timestamp\">`timestamp()`</a> sections to learn more.</p>\n<p>The following script calls the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function to calculate the UNIX timestamp of a specific date and time, and it draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> at the timestamp\u2019s corresponding bar location. The user-selected <code dir=\"auto\">timezone</code> argument (<code dir=\"auto\">timezoneInput</code>) determines the time zone of the call\u2019s calendar-based arguments. Consequently, the calculated timestamp varies with the <code dir=\"auto\">timezoneInput</code> value because identical local times in various time zones correspond to <em>different</em> amounts of time elapsed since the <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX Epoch</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"500\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-2.Bgcl5BRA_Z1UUd3e.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Time zone strings in UNIX timestamp functions demo\", overlay = true)\n\n//@variable The `timezone` argument of the `timestamp()` call, which sets the time zone of all date and time parameters.\nstring timezoneInput = input.string(\"Etc/UTC\", \"Time zone\")\n\n//@variable The UNIX timestamp corresponding to a specific calendar date and time.\n//          The specified `year`, `month`, `day`, `hour`, `minute`, and `second` represent calendar values in the \n//          `timezoneInput` time zone. \n//          Different `timezone` arguments produce different UNIX timestamps because an identical date in another \n//          time zone does NOT represent the same absolute point in time.\nint unixTimestamp = timestamp(\n     timezone = timezoneInput, year = 2024, month = 10, day = 31, hour = 0, minute = 0, second = 0\n )\n\n//@variable The `close` value when the bar's opening time crosses the `unixTimestamp`.\nfloat labelPrice = ta.valuewhen(ta.cross(time, unixTimestamp), close, 0)\n\n// On the last historical bar, draw a label showing the `unixTimestamp` value at the corresponding bar location.\nif barstate.islastconfirmedhistory\n    label.new(\n         unixTimestamp, nz(labelPrice, close), \"UNIX timestamp: \" + str.tostring(unixTimestamp), \n         xloc.bar_time, yloc.price, chart.fg_color, label.style_label_down, chart.bg_color, size.large\n     )</div>\n<p>Note that:</p>\n<ul>\n<li><code dir=\"auto\">\"Etc/UTC\"</code> is the <em>IANA identifier</em> for the UTC+0 time zone.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> call uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc.bar_time\">xloc.bar_time</a> as its <code dir=\"auto\">xloc</code> argument, which is required to anchor the drawing to an absolute time value. Without this argument, the function treats the <code dir=\"auto\">unixTimestamp</code> as a relative bar index, leading to an incorrect location.</li>\n<li>The label\u2019s <code dir=\"auto\">y</code> value is the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> of the bar where the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">opening time</a> crosses the <code dir=\"auto\">unixTimestamp</code>. If the timestamp represents a future time, the label uses the last historical bar\u2019s price.</li>\n</ul>\n<p>Although time zone strings can use either UTC or IANA notation, we recommend using <em>IANA notation</em> for <code dir=\"auto\">timezone</code> arguments in most cases, especially if a script\u2019s time calculations must align with the observed time offset in a specific country or subdivision. When a time function call uses an <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow\">IANA time zone identifier</a> for its <code dir=\"auto\">timezone</code> argument, its calculations adjust automatically for historical and future changes to the specified region\u2019s observed time, such as daylight saving time (DST) and updates to time zone boundaries, instead of using a fixed offset from UTC.</p>\n<p>The following script demonstrates how UTC and IANA time zone strings can affect time calculations differently. It uses two calls to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a> function to calculate the hour from the current bar\u2019s opening timestamp using <code dir=\"auto\">\"UTC-4\"</code> and <code dir=\"auto\">\"America/New_York\"</code> as <code dir=\"auto\">timezone</code> arguments. The script plots the results of both calls for comparison and colors the main pane\u2019s background when the returned values do not match. Although these two <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a> calls may seem similar because UTC-4 is an observed UTC offset in New York, they <em>do not</em> always return the same results, as shown below:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"602\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-zones-Time-zone-strings-3.dJwwxe9V_1a20aC.webp\" width=\"1422\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"UTC vs IANA time zone strings demo\")\n\n//@variable The hour of the current `time` in the \"UTC-4\" time zone. \n//          This variable's value represents the hour in New York only during DST. It is one hour ahead otherwise.\nint hourUTC = hour(time, \"UTC-4\")\n//@variable The hour of the current `time` in the \"America/New_York\" time zone. \n//          This form adjusts to UTC offset changes automatically, so the value always represents the hour in New York. \nint hourIANA = hour(time, \"America/New_York\")\n\n//@variable Is translucent blue when `hourUTC` does not equal `hourIANA`, `na` otherwise.\ncolor bgColor = hourUTC != hourIANA ? color.rgb(33, 149, 243, 80) : na\n\n// Plot the values of `hourUTC` and `hourIANA` for comparison.\nplot(hourUTC,  \"UTC-4\",            color.blue,   linewidth = 6)\nplot(hourIANA, \"America/New_York\", color.orange, linewidth = 3)\n// Highlight the main chart pane with the `bgColor`.\nbgcolor(bgColor, title = \"Unequal result highlight\", force_overlay = true)</div>\n<p>The plots in the chart above diverge periodically because New York observes daylight saving time, meaning its UTC offset <em>changes</em> at specific points in a year. During DST, New York\u2019s local time follows UTC-4. Otherwise, it follows UTC-5. Because the script\u2019s first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a> call uses <code dir=\"auto\">\"UTC-4\"</code> as its <code dir=\"auto\">timezone</code> argument, it returns the correct hour in New York <em>only</em> during DST. In contrast, the call that uses the <code dir=\"auto\">\"America/New_York\"</code> time zone string adjusts its UTC offset automatically to return the correct hour in New York at <em>any</em> time of the year.</p>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"time-variables\"><a href=\"#time-variables\">Time variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script has several built-in variables that provide scripts access to different forms of time information:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> variables hold <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> representing the current bar\u2019s opening and closing times, respectively.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> variable holds a UNIX timestamp representing the starting time of the last UTC calendar day in a session.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> variable holds a UNIX timestamp representing the current time when the script executes.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_month\">month</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_weekofyear\">weekofyear</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofweek\">dayofweek</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hour\">hour</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_minute\">minute</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_second\">second</a> variables reference calendar values based on the current bar\u2019s opening time, expressed in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">exchange time zone</a>.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> variable holds a UNIX timestamp representing the last available bar\u2019s opening time.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> variables hold UNIX timestamps representing the opening times of the leftmost and rightmost visible chart bars.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> variable holds a \u201cstring\u201d value representing the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a> of the current symbol\u2019s exchange in <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">IANA database notation</a>. All time-related function overloads with a <code dir=\"auto\">timezone</code> parameter use this variable as the default argument.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"time-and-time_close-variables\"><a href=\"#time-and-time_close-variables\"><span>\u200b<code dir=\"auto\">time</code>\u200b and \u200b<code dir=\"auto\">time_close</code>\u200b variables</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> variable holds the <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> of the current bar\u2019s <em>opening time</em>, and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> variable holds the UNIX timestamp of the bar\u2019s <em>closing time</em>.</p>\n<p>These timestamps are unique, time zone-agnostic \u201cint\u201d values, which programmers can use to anchor <a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing objects</a> to specific bar times, calculate and inspect bar time differences, construct readable date/time strings with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function, and more.</p>\n<p>The script below displays bar opening and closing times in different ways. On each bar, it <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formats</a> the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> timestamps into strings containing the hour, minute, and second in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">exchange time zone</a>, and it draws <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> displaying the formatted strings at the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> prices. Additionally, the script displays strings containing the unformatted UNIX timestamps of the last chart bar within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> in the bottom-right corner:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"576\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Time-and-time-close-1.SQRlfJYt_Z2oHBgb.webp\" width=\"1280\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`time` and `time_close` demo\", overlay = true, max_labels_count = 500)\n\n//@variable A \"string\" representing the hour, minute, and second of the bar's opening time in the exchange time zone. \nstring openTimeString = str.format_time(time, \"HH:mm:ss\")\n//@variable A \"string\" representing the hour, minute, and second of the bar's closing time in the exchange time zone.\nstring closeTimeString = str.format_time(time_close, \"HH:mm:ss\")\n\n//@variable Is `label.style_label_down` when the `open` is higher than `close`, `label.style_label_up` otherwise.\nstring openLabelStyle  = open &gt; close ? label.style_label_down : label.style_label_up\n//@variable Is `label.style_label_down` when the `close` is higher than `open`, `label.style_label_up` otherwise.\nstring closeLabelStyle = close &gt; open ? label.style_label_down : label.style_label_up\n\n// Draw labels anchored to the bar's `time` to display the `openTimeString` and `closeTimeString`.\nlabel.new(time, open,  openTimeString,  xloc.bar_time, yloc.price, color.orange, openLabelStyle,  color.white)\nlabel.new(time, close, closeTimeString, xloc.bar_time, yloc.price, color.blue,   closeLabelStyle, color.white)\n \nif barstate.islast\n    //@variable A `table` displaying the last bar's *unformatted* UNIX timestamps. \n    var table t = table.new(position.bottom_right, 2, 2, bgcolor = #ffe70d)\n    // Populate the `t` table with \"string\" representations of the the \"int\" `time` and `time_close` values. \n    t.cell(0, 0, \"`time`\")\n    t.cell(1, 0, str.tostring(time))\n    t.cell(0, 1, \"`time_close`\")\n    t.cell(1, 1, str.tostring(time_close))</div>\n<p>Note that:</p>\n<ul>\n<li>This script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> calls include <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc.bar_time\">xloc.bar_time</a> as the <code dir=\"auto\">xloc</code> argument and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> as the <code dir=\"auto\">x</code> argument to anchor the drawings to bar opening times.</li>\n<li>The formatted strings express time in the exchange time zone because we did not specify <code dir=\"auto\">timezone</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> calls. NYSE, our chart symbol\u2019s exchange, is in the \u201cAmerica/New_York\u201d time zone (UTC-4/-5).</li>\n<li>Although our example chart uses an <em>hourly</em> timeframe, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> and the <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> at the end of the chart show that the last bar closes only <em>30 minutes</em> (1,800,000 milliseconds) after opening. This behavior occurs because the chart aligns bars with <a href=\"/pine-script-docs/v5/concepts/sessions/\">session</a> opening and closing times. A session\u2019s final bar closes when the session ends, and a new bar opens when a new session starts. A typical session on our 60-minute chart with regular trading hours (RTH) spans from 09:30 to 16:00 (6.5 hours). The chart divides this interval into as many 60-minute bars as possible, starting from the session\u2019s opening time, which leaves only 30 minutes for the final bar to cover.</li>\n</ul>\n<p>It\u2019s crucial to note that unlike the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> variable, which has consistent behavior across chart types, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> behaves differently on <em>time-based</em> and <em>non-time-based</em> charts.</p>\n<p>Time-based charts have bars that typically open and close at regular, <em>predictable</em> times within a session. Thanks to this predictability, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> can accurately represent the <em>expected</em> closing time of an open bar on a time-based chart, as shown on the last bar in the example above.</p>\n<p>In contrast, the bars on <a href=\"https://www.tradingview.com/support/solutions/43000709225/\">tick charts</a> and <em>price-based</em> charts (all <a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard charts</a> excluding <a href=\"https://www.tradingview.com/support/solutions/43000619436/\">Heikin Ashi</a>) cover <em>irregular</em> time intervals. Tick charts construct bars based on successive ticks in the data feed, and price-based charts construct bars based on significant price movements. The time it takes for new ticks or price changes to occur is <em>unpredictable</em>. As such, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> value is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> on the <em>realtime bars</em> of these charts.</p>\n<p>The following script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> variables with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> to create strings containing bar opening and closing <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> and <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> date-time representations, which it displays in <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> at each bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> prices.</p>\n<p>When applied to a <a href=\"https://www.tradingview.com/support/solutions/43000502284/\">Renko</a> chart, which forms new bars based on <em>price movements</em>, the labels show correct results on all historical bars. However, the last bar has a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> value of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> because the future closing time is unpredictable. Consequently, the bar\u2019s closing time label shows a timestamp of <code dir=\"auto\">\"NaN\"</code> and an <em>incorrect</em> date and time:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"610\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Time-and-time-close-2.DgbsHPgj_1bCOHq.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`time_close` on non-time-based chart demo\", overlay = true)\n\n//@variable A formatted \"string\" containing the date and time that `time_close` represents in the exchange time zone.\nstring formattedCloseTime = str.format_time(time_close, format = \"'Date and time:' yyyy-MM-dd HH:mm:ss\")\n//@variable A formatted \"string\" containing the date and time that `time` represents in the exchange time zone.\nstring formattedOpenTime = str.format_time(time, format = \"'Date and time:' yyyy-MM-dd HH:mm:ss\")\n\n//@variable A \"string\" containing the `time_close` UNIX timestamp and the `formattedCloseTime`.\nstring closeTimeText = str.format(\"Close timestamp: {0,number,#}\\n{1}\", time_close, formattedCloseTime)\n//@variable A \"string\" containing the `time` UNIX timestamp and the `formattedOpenTime`.\nstring openTimeText = str.format(\"Open timestamp: {0,number,#}\\n{1}\", time, formattedOpenTime)\n\n// Define label colors for historical and realtime bars. \ncolor closeLabelColor = barstate.islast ? color.purple : color.aqua\ncolor openLabelColor  = barstate.islast ? color.green  : color.orange\n\n// Draw a label at the `high` to display the `closeTimeText` and a label at the `low` to display the `openTimeText`, \n// both anchored to the bar's `time`. \nlabel.new(\n      time, high, closeTimeText, xloc.bar_time, color = closeLabelColor, textcolor = color.white, \n      size = size.large, textalign = text.align_left\n )\nlabel.new(\n      time, low, openTimeText, xloc.bar_time, color = openLabelColor, style = label.style_label_up, \n      size = size.large, textcolor = color.white, textalign = text.align_left\n )\n\n// Highlight the background yellow on the latest bar. \nbgcolor(barstate.islast ? #f3de22cb : na, title = \"Latest bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script draws up to 50 <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> because we did not specify a <code dir=\"auto\">max_labels_count</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration statement.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function replaces <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values with 0 in its calculations, which is why it returns an incorrect date-time \u201cstring\u201d on the last bar. A timestamp of 0 corresponds to the <em>UNIX Epoch</em> (00:00:00 UTC on January 1, 1970). However, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> call does not specify a <code dir=\"auto\">timezone</code> argument, so it expresses the epoch\u2019s date and time in the <em>exchange time zone</em>, which was five hours behind UTC at that point in time.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> function, which returns the closing timestamp of a bar on a specified timeframe within a given session, also returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> on the realtime bars of tick-based and price-based charts.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"time_tradingday\"><a href=\"#time_tradingday\"><span>\u200b<code dir=\"auto\">time_tradingday</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> variable holds a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> representing the starting time (00:00 UTC) of the last trading day in the current bar\u2019s final session. It is helpful primarily for date and time calculations on <em>time-based</em> charts for symbols with overnight sessions that start and end on <em>different</em> calendar days.</p>\n<p>On \u201c1D\u201d and lower timeframes, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> timestamp corresponds to the beginning of the day when the current session <em>ends</em>, even for bars that open and close on the previous day. For example, the \u201cMonday\u201d session for \u201cEURUSD\u201d starts on Sunday at 17:00 and ends on Monday at 17:00 in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">exchange time zone</a>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> values of <em>all</em> intraday bars within the session represent Monday at 00:00 UTC.</p>\n<p>On timeframes higher than \u201c1D\u201d, which can cover <em>multiple</em> sessions, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> holds the timestamp representing the beginning of the last calendar day of the bar\u2019s <em>final</em> trading session. For example, on a \u201cEURUSD, 1W\u201d chart, the timestamp represents the start of the last trading day in the week, which is typically Friday at 00:00 UTC.</p>\n<p>The script below demonstrates how the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> variables differ on Forex symbols. On each bar, it draws <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> to display strings containing the variables\u2019 <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> and <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted dates and times</a>. It also uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> function to calculate the UTC calendar day from both timestamps, highlighting the background when the calculated days do not match.</p>\n<p>When applied to the \u201cFXCM:EURUSD\u201d chart with the \u201c3h\u201d (\u201c180\u201d) timeframe, the script highlights the background of the <em>first bar</em> in each session, as each session opens on the <em>previous</em> calendar day. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> call that uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> calculates the opening day on the session\u2019s first bar, whereas the call that uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> calculates the day when the session <em>ends</em>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"612\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Time-tradingday-1.oi6pPbd1_Z2d200U.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`time_tradingday` demo\", overlay = true)\n\n//@variable A concatenated \"string\" containing the `time_tradingday` timestamp and a formatted representation in UTC.\nstring tradingDayText = \"`time_tradingday`: \" + str.tostring(time_tradingday) + \"\\n\"\n     + \"Date and time: \" + str.format_time(time_tradingday, \"dd MMM yyyy, HH:mm (z)\", \"UTC+0\")\n//@variable A concatenated \"string\" containing the `time` timestamp and a formatted representation in UTC.\nstring barOpenText = \"`time`: \" + str.tostring(time) + \"\\n\"\n     + \"Date and time: \" + str.format_time(time, \"dd MMM yyyy, HH:mm (z)\", \"UTC+0\")\n\n//@variable Is `true` on every even bar, `false` otherwise. This condition determines the appearance of the labels. \nbool isEven = bar_index % 2 == 0\n\n// The `yloc` and `style` properties of the labels. They alternate on every other bar for visibility. \nlabelYloc  = isEven ? yloc.abovebar : yloc.belowbar\nlabelStyle = isEven ? label.style_label_down : label.style_label_up\n// Draw alternating labels anchored to the bar's `time` to display the `tradingDayText` and `barOpenText`.\nif isEven\n    label.new(time, 0, tradingDayText + \"\\n\\n\\n\", xloc.bar_time, labelYloc, color.teal, labelStyle, color.white)\n    label.new(time, 0, barOpenText, xloc.bar_time, labelYloc, color.maroon, labelStyle, color.white)\nelse\n    label.new(time, 0, \"\\n\\n\\n\" + barOpenText, xloc.bar_time, labelYloc, color.maroon, labelStyle, color.white)\n    label.new(time, 0, tradingDayText, xloc.bar_time, labelYloc, color.teal, labelStyle, color.white)\n\n//@variable The day of the month, in UTC, that the `time_tradingday` timestamp corresponds to. \nint tradingDayOfMonth = dayofmonth(time_tradingday, \"UTC+0\")\n//@variable The day of the month, in UTC, that the `time` timestamp corresponds to. \nint openingDayOfMonth = dayofmonth(time, \"UTC+0\")\n\n// Highlight the background when the `tradingDayOfMonth` does not equal the `openingDayOfMonth`. \nbgcolor(tradingDayOfMonth != openingDayOfMonth ? color.rgb(174, 89, 243, 85) : na, title = \"Different day highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> calls use <code dir=\"auto\">\"UTC+0\"</code> as the <code dir=\"auto\">timezone</code> argument, meaning the results represent calendar time values with no offset from UTC. In the screenshot, the first bar opens at 21:00 UTC, 17:00 in the exchange time zone (\u201cAmerica/New_York\u201d).</li>\n<li>The formatted strings show <code dir=\"auto\">\"GMT\"</code> as the acronym of the time zone, which is equivalent to <code dir=\"auto\">\"UTC+0\"</code> in this context.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_tradingday\">time_tradingday</a> value is the same for <em>all</em> three-hour bars within each session, even for the initial bar that opens on the previous UTC calendar day. The assigned timestamp changes only when a new session starts.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"timenow\"><a href=\"#timenow\"><span>\u200b<code dir=\"auto\">timenow</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> variable holds a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> representing the script\u2019s <em>current time</em>. Unlike the values of other variables that hold UNIX timestamps, the values in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> series correspond to times when the script <em>executes</em>, not the times of specific bars or trading days.</p>\n<p>A Pine script executes only <em>once</em> per historical bar, and all historical executions occur when the script first <em>loads</em> on the chart. As such, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> value is relatively consistent on historical bars, with only occasional millisecond changes across the series. In contrast, on realtime bars, a script executes once for <em>each new update</em> in the data feed, which can happen several times per bar. With each new execution, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> value updates on the latest bar to represent the current time.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> only updates after script executions, its value does <strong>not</strong> always correspond to the <em>continuous</em> time displayed below the chart. When no new updates are available in the realtime data feed, a script on the chart remains <em>idle</em>, in which case the variable\u2019s timestamp does not change.</p></div></aside>\n<p>This variable is most useful on realtime bars, where programmers can apply it to track the times of the latest script executions, count the time elapsed within open bars, control drawings based on bar updates, and more.</p>\n<p>The script below inspects the value of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> on the latest chart bars and uses it to analyze realtime bar updates. When the script first reaches the last chart bar, it declares three variables with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a> keyword to hold the latest <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> value, the total time elapsed between the bar\u2019s updates, and the total number of updates. It uses these values to calculate the average number of milliseconds between updates, which it displays in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> along with the current execution\u2019s timestamp, a <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> time and date in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">exchange time zone</a>, and the current number of bar updates:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"678\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Timenow-1.OYWKIkvY_Z1MUwEq.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`timenow` demo\", overlay = true, max_labels_count = 500)\n\nif barstate.islast\n    //@variable Holds the UNIX timestamp of the latest script execution for timing updates in the data feed. \n    varip int lastUpdateTimestamp = timenow\n    //@variable The total number of milliseconds elapsed across the bar's data updates.\n    varip int totalUpdateTime = 0\n    //@variable The number of updates that have occurred on the current bar.\n    varip int numUpdates = 0\n\n    // Add the time elapsed from the `lastUpdateTimestamp` to `totalUpdateTime`, increase the `numUpdates` counter, and \n    // update the `lastUpdateTimestamp` when the `timenow` value changes.\n    if timenow != lastUpdateTimestamp\n        totalUpdateTime     += timenow - lastUpdateTimestamp\n        numUpdates          += 1\n        lastUpdateTimestamp := timenow\n    \n    //@variable The average number of milliseconds elapsed between the bar's updates.\n    float avgUpdateTime = nz(totalUpdateTime / numUpdates)\n    \n    //@variable Contains the `timenow` value, a custom representation, and the `numUpdates` and `avgUpdateTime` values.\n    string displayText = \"`timenow`: \" + str.tostring(timenow)\n                         + \"\\nTime and date (exchange): \" + str.format_time(timenow, \"HH:mm:ss MM/dd/yy\")\n                         + \"\\nNumber of updates: \" + str.tostring(numUpdates)\n                         + \"\\nAvg. time between updates: \" + str.tostring(avgUpdateTime, \"#.###\") + \" ms\"\n\n    //@variable The color of the label. Is blue when the bar is open, and gray after it closes. \n    color labelColor = barstate.isconfirmed ? color.gray : color.blue \n    //@variable The label's y-coordinate. Alternates between `high` and `low` on every other bar. \n    float labelPrice = bar_index % 2 == 0 ? high : low\n    //@variable The label's style. Alternates between \"lower-right\" and \"upper-right\" styles.\n    labelStyle = bar_index % 2 == 0 ? label.style_label_lower_right : label.style_label_upper_right  \n    // Draw a `labelColor` label anchored to the bar's `time` to show the `displayText`.\n    label.new(\n         time, labelPrice, displayText, xloc.bar_time, color = labelColor, style = labelStyle, \n         textcolor = color.white, size = size.large\n     ) \n\n    // Reset the `totalUpdateTime` and `numUpdates` counters when the bar is confirmed (closes). \n    if barstate.isconfirmed\n        totalUpdateTime := 0\n        numUpdates      := 0</div>\n<p>Note that:</p>\n<ul>\n<li>When a bar is unconfirmed (open), the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> is blue to signify that additional updates can occur. After the bar is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isconfirmed\">confirmed</a> (closed), the label turns gray.</li>\n<li>Although we\u2019ve set the chart <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a> to match the exchange time zone, the formatted time in the open bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> and the time shown below the chart <em>do not</em> always align. The script records a new timestamp <em>only</em> when a new execution occurs, whereas the time below the chart updates <em>continuously</em>.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a> keyword specifies that a variable does not revert to the last committed value in its series when new updates occur. This behavior allows the script to use variables to track changes in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> on an open bar.</li>\n<li>Updates to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> on open realtime bars do not affect the recorded timestamps on confirmed bars as the script executes. However, the historical series changes (<em>repaints</em>) after reloading the chart because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> references the script\u2019s <em>current time</em>, not the times of specific bars.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"calendar-based-variables\"><a href=\"#calendar-based-variables\">Calendar-based variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_month\">month</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_weekofyear\">weekofyear</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofweek\">dayofweek</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hour\">hour</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_minute\">minute</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_second\">second</a> variables hold <em>calendar-based</em> \u201cint\u201d values calculated from the current bar\u2019s <em>opening time</em>, expressed in the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">exchange time zone</a>. These variables reference the same values that <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-functions\">calendar-based functions</a> return when they use the default <code dir=\"auto\">timezone</code> argument and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> as the <code dir=\"auto\">time</code> argument. For instance, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a> variable holds the same value that a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_year\">year(time)</a> call returns.</p>\n<p>Programmers can use these calendar-based variables for several purposes, such as:</p>\n<ul>\n<li>Identifying a bar\u2019s opening date and time.</li>\n<li>Passing the variables to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function to calculate <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a>.</li>\n<li>Testing when date/time values or ranges occur in a data feed.</li>\n</ul>\n<p>One of the most common use cases for these variables is checking for date or time ranges to control when a script displays visuals or executes calculations. This simple example inspects the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a> variable to determine when to plot a visible value. If the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a> is 2022 or higher, the script plots the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>. Otherwise, it plots <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"550\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Calendar-based-variables-1.kYa8Z75h_KDMyu.webp\" width=\"1376\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`year` demo\", overlay = true)\n\n// Plot the `close` price on bars that open in the `year` 2022 onward. Otherwise, plot `na` to display nothing.\nplot(year &gt;= 2022 ? close : na, \"`close` price (year 2022 and later)\", linewidth = 3)</div>\n<p>When using these variables in conditions that isolate specific dates or times rather than ranges, it\u2019s crucial to consider that certain conditions might not detect some occurrences of the values due to a chart\u2019s timeframe, the opening times of chart bars, or the symbol\u2019s active session.</p>\n<p>For instance, suppose we want to detect when the first calendar day of each month occurs on the chart. Intuitively, one might consider simply checking when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a> value equals 1. However, this condition only identifies when a bar <em>opens</em> on a month\u2019s first day. The bars on some charts can open and close in <em>different</em> months. Additionally, a chart bar might not contain the first day of a month if the market is <em>closed</em> on that day. Therefore, we must create extra conditions that work in these scenarios to identify the first day in <em>any</em> month on the chart.</p>\n<p>The script below uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_month\">month</a> variables, and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a> function, to create three conditions that detect the first day of the month in different ways. The first condition detects if the bar opens on the first day, the second checks if the bar opens in one month and closes in another, and the third checks if the chart skips the date entirely. The script draws <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> showing bar opening dates and highlights the background with different colors to visualize when each condition occurs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"636\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Calendar-based-variables-2.xQSXmhyL_Zw0zRE.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Detecting the first day of the month demo\", overlay = true, max_labels_count = 500)\n\n//@variable Is `true` only if the current bar opens on the first day of the month in exchange time, `false` otherwise. \nbool opensOnFirst = dayofmonth == 1\n//@variable Is `true` if the bar opens in one month and closes in another, meaning its time span includes the first day.\nbool containsFirst = month != month(time_close) \n//@variable Is `true` only if the bar opens in a new month and the current or previous bar does not cover the first day.\nbool skipsFirst = month != month[1] and not (opensOnFirst or containsFirst[1])\n\n//@variable The name of the current bar's opening weekday.\nstring weekdayName = switch dayofweek\n    dayofweek.sunday    =&gt; \"Sunday\"\n    dayofweek.monday    =&gt; \"Monday\"\n    dayofweek.tuesday   =&gt; \"Tuesday\"\n    dayofweek.wednesday =&gt; \"Wednesday\"\n    dayofweek.thursday  =&gt; \"Thursday\"\n    dayofweek.friday    =&gt; \"Friday\"\n    dayofweek.saturday  =&gt; \"Saturday\"\n\n//@variable A custom \"string\" representing the bar's opening date, including the weekday name. \nstring openDateText = weekdayName + str.format_time(time, \", MMM d, yyyy\")\n\n// Draw a green label when the bar opens on the first day of the month. \nif opensOnFirst\n    string labelText = \"Bar opened on\\n\" + openDateText\n    label.new(time, open, labelText, xloc.bar_time, color = color.green, textcolor = color.white, size = size.large)\n// Draw a blue label when the bar opens and closes in different months. \nif containsFirst\n    string labelText = \"Bar includes the first day,\\nbut opened on\\n\" + openDateText\n    label.new(time, open, labelText, xloc.bar_time, color = color.blue, textcolor = color.white, size = size.large)\n// Draw a red label when the chart skips the first day of the month. \nif skipsFirst\n    string labelText = \"Chart doesn't include the first day.\\nBar opened on\\n\" + openDateText\n    label.new(time, open, labelText, xloc.bar_time, color = color.red, textcolor = color.white, size = size.large)\n\n// Highlight the background when the conditions occur.\nbgcolor(opensOnFirst ? color.new(color.green, 70) : na, title = \"`opensOnFirst` condition highlight\")\nbgcolor(containsFirst ? color.new(color.blue, 70) : na, title = \"`containsFirst` condition highlight\")\nbgcolor(skipsFirst ? color.new(color.red, 70) : na, title = \"`skipsFirst` condition highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script calls the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a> function with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> as the <code dir=\"auto\">time</code> argument to calculate each bar\u2019s <em>closing</em> month for the <code dir=\"auto\">containsFirst</code> condition.</li>\n<li>The <code dir=\"auto\">dayofweek.*</code> namespace contains variables that hold each possible <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofweek\">dayofweek</a> value, e.g., <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_dayofweek.sunday\">dayofweek.sunday</a> has a constant value of 1 and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_dayofweek.saturday\">dayofweek.saturday</a> has a constant value of 7. The script compares <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofweek\">dayofweek</a> to these variables in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a> structure to determine the weekday name shown inside each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>.</li>\n<li>To detect the <em>first opening time</em> in a monthly timeframe, not strictly the first day in a calendar month, use <code dir=\"auto\">ta.change(time(\"1M\")) &gt; 0</code> or <code dir=\"auto\">timeframe.change(\"1M\")</code> instead of conditions based on these variables. See the <a href=\"/pine-script-docs/v5/concepts/time/#testing-for-changes-in-higher-timeframes\">Testing for changes in higher timeframes</a> section to learn more.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"last_bar_time\"><a href=\"#last_bar_time\"><span>\u200b<code dir=\"auto\">last_bar_time</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> variable holds a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> representing the <em>last</em> available bar\u2019s opening time. It is similar to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_index\">last_bar_index</a>, which references the latest bar index. On historical bars, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> consistently references the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value of the last bar available when the script first <em>loads</em> on the chart. The only time the variable\u2019s value updates across script executions is when a new realtime bar opens.</p>\n<p>The following script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> variable to get the opening timestamp of the last chart bar during its execution on the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isfirst\">first bar</a>. It displays the UNIX timestamp and a <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> date and time in a single-cell <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> created only on that bar. When the script executes on the last available bar, it draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> showing the bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value and its formatted representation for visual comparison.</p>\n<p>As the chart below shows, both drawings display <em>identical</em> times, verifying that <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> correctly references the last bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value on previous historical bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"540\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Last-bar-time-1.COWu3Po-_Z26jRdL.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`last_bar_time` demo\", overlay = true)\n\nif barstate.isfirst\n    //@variable A single-cell `table`, created only on the *first* bar, showing the *last* available bar's opening time.\n    table displayTable = table.new(position.bottom_right, 1, 1, color.aqua)\n    //@variable A \"string\" containing the `last_bar_time` UNIX timestamp and a custom date and time representation. \n    string lastBarTimeText = \"`last_bar_time`: \"              + str.tostring(last_bar_time) \n                             + \"\\nDate and time (exchange): \" + str.format_time(last_bar_time, \"dd/MM/yy HH:mm:ss\")\n    // Initialize the `displayTable` cell with the `lastBarTimeText`.\n    displayTable.cell(\n         0, 0, lastBarTimeText, \n         text_color = color.white, text_size = size.large, text_halign = text.align_left\n     )\n\n//@variable Is `true` only on the first occurrence of `barstate.islast`, `false` otherwise.\n//          This condition occurs on the bar whose `time` the `last_bar_time` variable refers to on historical bars.\nbool isInitialLastBar = barstate.islast and not barstate.islast[1]\n\nif isInitialLastBar\n    //@variable A \"string\" containing the last available bar's `time` value and a custom date and time representation.\n    //          Matches the `lastBarTimeText` from the first bar because `last_bar_time` equals this bar's `time`.\n    string openTimeText = \"`time`: \"                       + str.tostring(time)\n                          + \"\\nDate and time (exchange): \" + str.format_time(time, \"dd/MM/yy HH:mm:ss\") \n    // Draw a label anchored to the bar's `time` to display the `openTimeText`. \n    label.new(\n         time, high, openTimeText, xloc.bar_time,\n         color = color.purple, textcolor = color.white, size = size.large, textalign = text.align_left\n     )\n\n// Highlight the background when `isInitialLastBar` is `true` for visual reference. \nbgcolor(barstate.islast ? color.rgb(155, 39, 176, 80) : na, title = \"Initial last bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script creates the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> only on the <em>first</em> bar with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">barstate.islast</a> state because that bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value is what <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> equals on all historical bars. On subsequent bars, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> value <em>updates</em> to represent the latest realtime bar\u2019s opening time.</li>\n<li>Updates to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> on realtime bars do not affect the values on historical bars as the script executes. However, the variable\u2019s series <em>repaints</em> when the script restarts because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> always references the latest available bar\u2019s opening time.</li>\n<li>This script expresses dates using the <code dir=\"auto\">\"dd/MM/yy\"</code> format, meaning the two-digit day appears before the two-digit month, and the month appears before the two-digit representation of the year. See <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">this section</a> below for more information.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"visible-bar-times\"><a href=\"#visible-bar-times\">Visible bar times<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> variables reference the opening <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> of the chart\u2019s leftmost (first) and rightmost (last) <em>visible bars</em> on every script execution. When a script uses these variables, it responds dynamically to visible chart changes, such as users scrolling across bars or zooming in/out. Each time the visible window changes, the script <em>re-executes</em> automatically to update the variables\u2019 values on all available bars.</p>\n<p>The example below demonstrates how the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> variables work across script executions. The script draws <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> anchored to the visible bars\u2019 times to display the UNIX timestamps. In addition, it draws two single-cell <a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a> showing corresponding dates and times in the standard <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow\">ISO 8601</a> format. The script creates these drawings only when it executes on the first bar. As the script continues to execute on subsequent bars, it identifies each bar whose <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value equals either visible bars\u2019 timestamp and colors it on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"642\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Visible-bar-times-1.Cm54dJVW_rV6wP.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Visible bar times demo\", overlay = true)\n\n// Create strings on the first chart bar that contain the first and last visible bars' UNIX timestamps.\nvar string leftTimestampText  = str.format(\"UNIX timestamp: {0,number,#}\", chart.left_visible_bar_time)\nvar string rightTimestampText = str.format(\"UNIX timestamp: {0,number,#}\", chart.right_visible_bar_time)\n// Create strings on the first bar that contain the exchange date and time of the visible bars in ISO 8601 format.\nvar string leftDateTimeText  = \"Date and time: \" + str.format_time(chart.left_visible_bar_time)\nvar string rightDateTimeText = \"Date and time: \" + str.format_time(chart.right_visible_bar_time)\n\n//@variable A `label` object anchored to the first visible bar's time. Shows the `leftTimestampText`.\nvar label leftTimeLabel = label.new(\n     chart.left_visible_bar_time, 0, leftTimestampText, xloc.bar_time, yloc.abovebar, color.purple, \n     label.style_label_lower_left, color.white, size.large\n )\n//@variable A `label` object anchored to the last visible bar's time. Shows the `rightTimestampText`.\nvar label rightTimeLabel = label.new(\n     chart.right_visible_bar_time, 0, rightTimestampText, xloc.bar_time, yloc.abovebar, color.teal, \n     label.style_label_lower_right, color.white, size.large\n )\n\n//@variable A single-cell `table` object showing the `leftDateTimeText`.\nvar table leftTimeTable = table.new(position.middle_left, 1, 1, color.purple)\n//@variable A single-cell `table` object showing the `rightDateTimeText`.\nvar table rightTimeTable = table.new(position.middle_right, 1, 1, color.teal)\n// On the first bar, initialize the `leftTimeTable` and `rightTimeTable` with the corresponding date-time text.\nif barstate.isfirst\n    leftTimeTable.cell(0, 0, leftDateTimeText, text_color = color.white, text_size = size.large)\n    rightTimeTable.cell(0, 0, rightDateTimeText, text_color = color.white, text_size = size.large)\n\n//@variable Is purple at the left visible bar's opening time, teal at the right bar's opening time, `na` otherwise. \ncolor barColor = switch time\n    chart.left_visible_bar_time  =&gt; color.purple\n    chart.right_visible_bar_time =&gt; color.teal\n\n// Color the leftmost and rightmost visible bars using the `barColor`.\nbarcolor(barColor, title = \"Leftmost and rightmost visible bar color\")</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> values are consistent across all executions, which allows the script to identify the visible bars\u2019 timestamps on the <em>first</em> bar and check when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> value equals them. The script restarts on any chart window changes, updating the variables\u2019 series to reference the new timestamps on every bar.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function uses ISO 8601 format by default when the call does not include a <code dir=\"auto\">format</code> argument because it is the <em>international standard</em> for expressing dates and times. See the <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">Formatting dates and times</a> section to learn more about time string formats.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"syminfotimezone\"><a href=\"#syminfotimezone\"><span>\u200b<code dir=\"auto\">syminfo.timezone</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> variable holds a <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> representing the current symbol\u2019s <em>exchange</em> time zone. The \u201cstring\u201d value expresses the time zone as an <em>IANA identifier</em> (e.g., <code dir=\"auto\">\"America/New_York\"</code>). The overloads of <a href=\"/pine-script-docs/v5/concepts/time/#time-functions\">time functions</a> that include a <code dir=\"auto\">timezone</code> parameter use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> as the default argument.</p>\n<p>Because this variable is the default <code dir=\"auto\">timezone</code> argument for all applicable time function overloads, it is unnecessary to use as an explicit argument, except for stylistic purposes. However, programmers can use the variable in other ways, such as:</p>\n<ul>\n<li>Displaying the \u201cstring\u201d in <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> or <a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawings</a> to inspect the exchange time zone\u2019s IANA identifier.</li>\n<li>Comparing the value to other time zone strings to create time zone-based conditional logic.</li>\n<li>Requesting the exchange time zones of other symbols with <code dir=\"auto\">request.*()</code> function calls.</li>\n</ul>\n<p>The following script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> variable to retrieve the <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> of its latest execution. It <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formats</a> the timestamp into date-time strings expressed in the main symbol\u2019s exchange time zone and a requested symbol\u2019s exchange time zone, which it displays along with the IANA identifiers in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the last chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"580\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-variables-Syminfo-timezone-1.BAiDPB0L_Z1tzhco.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`syminfo.timezone` demo\", overlay = true, dynamic_requests = true)\n\n//@variable The symbol to request exchange time zone information for. \nstring symbolInput = input.symbol(\"NSE:BANKNIFTY\", \"Requested symbol\")\n\n//@variable A `table` object displaying the exchange time zone and the time of the script's execution.\nvar table t = table.new(position.bottom_right, 2, 3, color.yellow, border_color = color.black, border_width = 1)\n\n//@variable The IANA identifier of the exchange time zone requested for the `symbolInput` symbol.\nvar string requestedTimezone = na\n\nif barstate.islastconfirmedhistory\n    // Retrieve the time zone of the user-specified symbol's exchange.\n    requestedTimezone := request.security(symbolInput, \"\", syminfo.timezone, calc_bars_count = 2)\n    // Initialize the `t` table's header cells.\n    t.cell(0, 0, \"Exchange prefix and time zone string\", text_size = size.large)\n    t.cell(1, 0, \"Last execution date and time\", text_size = size.large)\n    t.cell(0, 1, syminfo.prefix(syminfo.tickerid) + \" (\" + syminfo.timezone + \")\", text_size = size.large)\n    t.cell(0, 2, syminfo.prefix(symbolInput) + \" (\" + requestedTimezone + \")\", text_size = size.large)\n\nif barstate.islast\n    //@variable The formatting string for all `str.format_time()` calls. \n    var string formatString = \"HH:mm:ss 'on' MMM dd, YYYY\"\n    // Initialize table cells to display the formatted text.\n    t.cell(1, 1, str.format_time(timenow, formatString), text_size = size.large)\n    t.cell(1, 2, str.format_time(timenow, formatString, requestedTimezone), text_size = size.large)</div>\n<p>Note that:</p>\n<ul>\n<li>Pine scripts execute on realtime bars only when new updates occur in the data feed, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> updates only on script executions. As such, when no realtime updates are available, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> timestamp does not change. See <a href=\"/pine-script-docs/v5/concepts/time/#timenow\">this section</a> above for more information.</li>\n<li>The default <code dir=\"auto\">symbolInput</code> value is <code dir=\"auto\">\"NSE:BANKNIFTY\"</code>. NSE is in the \u201cAsia/Kolkata\u201d <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>, which is 9.5 hours ahead of the main symbol\u2019s exchange time zone (\u201cAmerica/New_York\u201d) at the time of the screenshot. Although the <em>local</em> time representations differ, both refer to the same <em>absolute</em> time that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a> timestamp represents.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration statement includes <code dir=\"auto\">dynamic_requests = true</code>, which allows the script to call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> dynamically inside the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> structure\u2019s <em>local scope</em>. See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#dynamic-requests\">Dynamic requests</a> section of the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page to learn more.</li>\n</ul>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"time-functions\"><a href=\"#time-functions\">Time functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script features several built-in functions that scripts can use to retrieve, calculate, and express time values:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> functions allow scripts to retrieve <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> for the opening and closing times of bars within a session on a specified timeframe, without requiring <code dir=\"auto\">request.*()</code> function calls.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_year\">year()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_weekofyear\">weekofyear()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_minute\">minute()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_second\">second()</a> functions calculate calendar-based values, expressed in a specified <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>, from a UNIX timestamp.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function calculates a UNIX timestamp from a specified calendar date and time.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function formats a UNIX timestamp into a human-readable date/time \u201cstring\u201d, expressed in a specified time zone. The <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">Formatting dates and times</a> section below provides detailed information about formatting timestamps with this function.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a> function returns a UNIX timestamp corresponding to the user-specified date and time, and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.session\">input.session()</a> function returns a valid <a href=\"/pine-script-docs/v5/concepts/sessions/#session-strings\">session string</a> corresponding to the user-specified start and end times. See the <a href=\"/pine-script-docs/v5/concepts/inputs/#time-input\">Time input</a> and <a href=\"/pine-script-docs/v5/concepts/inputs/#session-input\">Session input</a> sections of the <a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a> page to learn more about these functions.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"time-and-time_close-functions\"><a href=\"#time-and-time_close-functions\"><span>\u200b<code dir=\"auto\">time()</code>\u200b and \u200b<code dir=\"auto\">time_close()</code>\u200b functions</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> functions return <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> representing the opening and closing times of bars on a specified timeframe. Both functions can <em>filter</em> their returned values based on a given <a href=\"/pine-script-docs/v5/concepts/sessions/\">session</a> in a specific <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>. They each have the following signatures:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">functionName(timeframe, bars_back) \u2192 series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">functionName(timeframe, session, bars_back) \u2192 series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">functionName(timeframe, session, timezone, bars_back) \u2192 series int</span></div></div></code></pre></figure></link></div>\n<p>Where:</p>\n<ul>\n<li><code dir=\"auto\">functionName</code> is the function\u2019s identifier.</li>\n<li>The <code dir=\"auto\">timeframe</code> parameter accepts a <a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">timeframe string</a>. The function uses the script\u2019s main timeframe if the argument is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a> or an empty \u201cstring\u201d.</li>\n<li>The <code dir=\"auto\">session</code> parameter accepts a <a href=\"/pine-script-docs/v5/concepts/sessions/#session-strings\">session string</a> defining the session\u2019s start and end times (e.g., <code dir=\"auto\">\"0930-1600\"</code>) and the days for which it applies (e.g., <code dir=\"auto\">\":23456\"</code> means Monday - Friday). If the value does not specify the days, the session applies to <em>all</em> weekdays automatically. The function returns UNIX timestamps only for the bars <em>within</em> the session. It returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> if a bar\u2019s time is <em>outside</em> the session. If the <code dir=\"auto\">session</code> argument is an empty \u201cstring\u201d or not specified, The function uses the symbol\u2019s session information.</li>\n<li>The <code dir=\"auto\">timezone</code> parameter accepts a valid <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> that defines the time zone of the specified <code dir=\"auto\">session</code>. It does <strong>not</strong> change the meaning of returned UNIX timestamps, as they are <em>time zone-agnostic</em>. If the <code dir=\"auto\">timezone</code> argument is not specified, the function uses the exchange time zone (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a>).</li>\n<li>The <code dir=\"auto\">bars_back</code> parameter accepts an \u201cint\u201d value specifying which bar\u2019s time the returned timestamp represents. If the value is positive, the function returns the timestamp from that number of bars back relative to the current bar. If the value is negative and greater than or equal to -500, the function returns the <em>expected</em> timestamp of a future bar. The default value is 0.</li>\n</ul>\n<p>Similar to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> variables, these functions behave differently on <em>time-based</em> and <em>non-time-based</em> charts.</p>\n<p>Time-based charts have bars that open and close at <em>predictable</em> times, whereas the bars on <a href=\"https://www.tradingview.com/support/solutions/43000709225/\">tick charts</a> and all <a href=\"/pine-script-docs/v5/concepts/non-standard-charts-data/\">non-standard charts</a>, excluding <a href=\"https://www.tradingview.com/support/solutions/43000619436/\">Heikin Ashi</a>, open and close at irregular, <em>unpredictable</em> times. Consequently, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> cannot calculate the expected closing times of realtime bars on non-time-based charts, so it returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> on those bars. Similarly, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> function with a negative <code dir=\"auto\">bars_back</code> value cannot accurately calculate the expected opening time of a future realtime bar on these charts. See the <em>second example</em> in <a href=\"/pine-script-docs/v5/concepts/time/#time-and-time_close-variables\">this section</a> above. That example script exhibits the same behavior on a price-based chart if it uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close(\"\")</a> call instead of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> variable.</p>\n<p>Typical use cases for the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> functions include:</p>\n<ul>\n<li>Testing for bars that open or close in <a href=\"/pine-script-docs/v5/concepts/time/#testing-for-sessions\">specific sessions</a> defined by the <code dir=\"auto\">session</code> and <code dir=\"auto\">timezone</code> parameters.</li>\n<li><a href=\"/pine-script-docs/v5/concepts/time/#testing-for-changes-in-higher-timeframes\">Testing for changes</a> or measuring time differences on specified higher timeframes.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"testing-for-sessions\"><a href=\"#testing-for-sessions\">Testing for sessions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> functions\u2019 <code dir=\"auto\">session</code> and <code dir=\"auto\">timezone</code> parameters define the <a href=\"/pine-script-docs/v5/concepts/sessions/\">sessions</a> for which they can return <em>non-na</em> values. If a call to either function references a bar that opens/closes within the defined session in a given <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>, it returns a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> for that bar. Otherwise, it returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>. Programmers can pass the returned values to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_na\">na()</a> function to identify which bars open or close within specified intervals, which is helpful for session-based calculations and logic.</p>\n<p>This simple script identifies when a bar on the chart\u2019s timeframe opens at or after 11:00 and before 13:00 in the exchange time zone on any trading day. It calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a> as the <code dir=\"auto\">timeframe</code> argument and the <code dir=\"auto\">\"1100-1300\"</code> <a href=\"/pine-script-docs/v5/concepts/sessions/#session-strings\">session string</a> as the <code dir=\"auto\">session</code> argument, and then verifies whether the returned value is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_na\">na()</a> function. When the value is <strong>not</strong> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, the script highlights the chart\u2019s background to indicate that the bar opened in the session:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"534\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-sessions-1.CJeOvGxZ_Z1sBkKc.webp\" width=\"1458\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Testing for session bars demo\", overlay = true)\n\n//@variable Checks if the bar opens between 11:00 and 13:00. Is `true` if the `time()` function does not return `na`. \nbool inSession = not na(time(timeframe.period, \"1100-1300\"))\n\n// Highlight the background of the bars that are in the session \"11:00-13:00\". \nbgcolor(inSession ? color.rgb(155, 39, 176, 80) : na)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">session</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> call represents an interval in the <em>exchange</em> time zone because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> is the default <code dir=\"auto\">timezone</code> argument.</li>\n<li>The session string expresses the start and end times in the <code dir=\"auto\">\"HHmm-HHmm\"</code> format, where <code dir=\"auto\">\"HH\"</code> is the two-digit <em>hour</em> and <code dir=\"auto\">\"mm\"</code> is the two-digit <em>minute</em>. Session strings can also specify the <em>weekdays</em> a session applies to. However, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> call\u2019s <code dir=\"auto\">session</code> argument (<code dir=\"auto\">\"1100-1300\"</code>) does not include this information, which is why it considers the session valid for <em>every</em> day. See the <a href=\"/pine-script-docs/v5/concepts/sessions/\">Sessions</a> page to learn more.</li>\n</ul>\n<p>When using session strings in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> calls, it\u2019s crucial to understand that such strings define start and end times in a <em>specific</em> <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>. The local hour and minute in one region may not correspond to the same point in UNIX time as that same hour and minute in another region. Therefore, calls to these functions with different <code dir=\"auto\">timezone</code> arguments can return non-na timestamps at <em>different</em> times, as the specified <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> changes the meaning of the local times represented in the <code dir=\"auto\">session</code> argument.</p>\n<p>This example demonstrates how the <code dir=\"auto\">timezone</code> parameter affects the <code dir=\"auto\">session</code> parameter in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> function call. The script calculates an <code dir=\"auto\">opensInSession</code> condition that uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> call with arguments based on <a href=\"/pine-script-docs/v5/concepts/inputs/\">inputs</a>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.session\">session input</a> for the <code dir=\"auto\">session</code> argument includes four preset options: <code dir=\"auto\">\"0000-0400\"</code>, <code dir=\"auto\">\"0930-1400\"</code>, <code dir=\"auto\">\"1300-1700\"</code>, and <code dir=\"auto\">\"1700-2100\"</code>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.string\">string input</a> that defines the <code dir=\"auto\">timezone</code> argument includes four IANA time zone options representing different offsets from UTC: <code dir=\"auto\">\"America/Vancouver\"</code> (UTC-7/-8), <code dir=\"auto\">\"America/New_York\"</code> (UTC-4/-5), <code dir=\"auto\">\"Asia/Dubai\"</code> (UTC+4), and <code dir=\"auto\">\"Austrailia/Sydney\"</code> (UTC+10/+11).</p>\n<p>For any chosen <code dir=\"auto\">sessionInput</code> value, changing the <code dir=\"auto\">timezoneInput</code> value changes the specified session\u2019s time zone. The script highlights <em>different bars</em> with each time zone choice because, unlike <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a>, the <em>absolute</em> times that local hour and minute values correspond to <em>varies</em> across time zones:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-sessions-2.DKRpvO46_Z1pg5HR.webp\" width=\"1566\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Testing session time zones demo\", overlay = true)\n\n//@variable The timeframe of the analyzed bars. \nstring timeframeInput = input.timeframe(\"60\", \"Timeframe\")\n//@variable The session to check. Features four interval options. \nstring sessionInput = input.session(\"1300-1700\", \"Session\", [\"0000-0400\", \"0930-1400\", \"1300-1700\", \"1700-2100\"])\n//@variable An IANA identifier representing the time zone of the `sessionInput`. Fetures four preset options. \nstring timezoneInput = input.string(\"America/New_York\", \"Time zone\", \n     [\"America/Vancouver\", \"America/New_York\", \"Asia/Dubai\", \"Australia/Sydney\"]\n )\n\n//@variable Is `true` if a `timeframeInput` bar opens within the `sessionInput` session in the `timezoneInput` time zone.\n//          The condition detects the session on different bars, depending on the chosesn time zone, because identical \n//          local times in different time zones refer to different absolute points in UNIX time.  \nbool opensInSession = not na(time(timeframeInput, sessionInput, timezoneInput))\n\n// Highlight the background when `opensInSession` is `true`. \nbgcolor(opensInSession ? color.rgb(33, 149, 243, 80) : na, title = \"Open in session highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>This script uses <em>IANA notation</em> for all <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone strings</a> because it is the recommended format. Using an IANA identifier allows the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> call to automatically adjust the session\u2019s UTC offset based on a region\u2019s local time policies, such as daylight saving time.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"testing-for-changes-in-higher-timeframes\"><a href=\"#testing-for-changes-in-higher-timeframes\">Testing for changes in higher timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <code dir=\"auto\">timeframe</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> functions specifies the timeframe of the bars in the calculation, allowing scripts to retrieve opening/closing <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> from <em>higher timeframes</em> than the current chart\u2019s timeframe without requiring <code dir=\"auto\">request.*()</code> function calls.</p>\n<p>Programmers can use the opening/closing timestamps from higher-timeframe (HTF) bars to detect timeframe changes. One common approach is to call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> with a consistent <code dir=\"auto\">timeframe</code> argument across all executions on a time-based chart and measure the one-bar change in the returned value with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.change\">ta.change()</a> function. The result is a <em>nonzero</em> value only when an HTF bar opens. One can also check whether the data has a time gap at that point by comparing the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> value to the previous bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> value. A gap is present when the opening timestamp on the current bar is greater than the closing timestamp on the previous bar.</p>\n<p>The script below calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time(\u201c1M\u201d)</a> to get the opening UNIX timestamp of the current bar on the \u201c1M\u201d timeframe. It detects when bars on that timeframe open by checking when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.change\">ta.change()</a> of the timestamp returns a value greater than 0. On each occurrence of the condition, the script detects whether the HTF bar opened after a gap by checking if the opening time is greater than the previous bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close(\u201c1M\u201d)</a> value.</p>\n<p>The script draws <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> containing <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> \u201c1M\u201d opening times to indicate the chart bars that mark the start of monthly bars. If a monthly bar opens without a gap from the previous closing time, the script draws a blue label. If a monthly bar starts after a gap, it draws a red label. Additionally, if the \u201c1M\u201d opening time does not match the opening time of the chart bar, the script displays that bar\u2019s formatted time in the label for comparison:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"640\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Time-and-time-close-Testing-for-changes-in-higher-timeframes-1.EwKXV91R_16xSC0.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Detecting changes in higher timeframes demo\", overlay = true)\n\n//@variable The opening UNIX timestamp of the current bar on the \"1M\" timeframe.\nint currMonthlyOpenTime = time(\"1M\")\n//@variable The closing timestamp on the \"1M\" timeframe as of the previous chart bar. \nint prevMonthlyCloseTime = time_close(\"1M\")[1]\n\n//@variable Is `true` when the opening time on the \"1M\" timeframe changes, indicating a new monthly bar. \nbool isNewTf = ta.change(currMonthlyOpenTime) &gt; 0\n\nif isNewTf\n    // Initialize variables for the `text` and `color` properties of the label drawing.\n    string lblText  = \"New '1M' opening time:\\n\" + str.format_time(currMonthlyOpenTime)\n    color  lblColor = color.blue\n\n    //@variable Is `true` when the `currMonthlyOpenTime` exceeds the `prevMonthlyCloseTime`, indicating a time gap.\n    bool hasGap = currMonthlyOpenTime &gt; prevMonthlyCloseTime\n    \n    // Modify the `lblText` and `lblColor` based on the `hasGap` value.\n    if hasGap\n        lblText := \"Gap from previous '1M' close.\\n\\n\" + lblText\n        lblColor := color.red\n    // Include the formatted `time` value if the `currMonthlyOpenTime` is before the first available chart bar's `time`.\n    if time &gt; currMonthlyOpenTime\n        lblText += \"\\nFirst chart bar has a later time:\\n\" + str.format_time(time)\n    \n    // Draw a `lblColor` label anchored to the `time` to display the `lblText`. \n    label.new(\n         time, high, lblText, xloc.bar_time, color = lblColor, style = label.style_label_lower_right, \n         textcolor = color.white, size = size.large\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>Using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.change\">ta.change()</a> on a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> call\u2019s result is not the <em>only</em> way to detect changes in a higher timeframe. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">timeframe.change()</a> function is an equivalent, more convenient option for scripts that do not need to <em>use</em> the UNIX timestamps from HTF bars in other calculations, as it returns a \u201cbool\u201d value directly without extra code.</li>\n<li>The detected monthly opening times do not always correspond to the first calendar day of the month. Instead, they correspond to the first time assigned to a \u201c1M\u201d bar, which can be <em>after</em> the first calendar day. For symbols with overnight sessions, such as \u201cUSDJPY\u201d in our example chart, a \u201c1M\u201d bar can also open <em>before</em> the first calendar day.</li>\n<li>Sometimes, the opening time assigned to an HTF bar might <em>not</em> equal the opening time of any chart bar, which is why other conditions such as <code dir=\"auto\">time == time(\"1M\")</code> cannot detect new monthly bars consistently. For example, on our \u201cUSDJPY\u201d chart, the \u201c1M\u201d opening time <code dir=\"auto\">2023-12-31T17:00:00-0500</code> does not match an opening time on the \u201c1D\u201d timeframe. The first available \u201c1D\u201d bar after that point opened at <code dir=\"auto\">2024-01-01T17:00:00-0500</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"calendar-based-functions\"><a href=\"#calendar-based-functions\">Calendar-based functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_year\">year()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_weekofyear\">weekofyear()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hour\">hour()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_minute\">minute()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_second\">second()</a> functions calculate <em>calendar-based</em> \u201cint\u201d values from a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a>. Unlike the <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-variables\">calendar-based variables</a>, which always hold exchange calendar values based on the current bar\u2019s opening timestamp, these functions can return calendar values for any valid timestamp and express them in a chosen <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>.</p>\n<p>Each of these calendar-based functions has the following two signatures:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">functionName(time) \u2192 series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">functionName(time, timezone) \u2192 series int</span></div></div></code></pre></figure></div>\n<p>Where:</p>\n<ul>\n<li><code dir=\"auto\">functionName</code> is the function\u2019s identifier.</li>\n<li>The <code dir=\"auto\">time</code> parameter accepts an \u201cint\u201d UNIX timestamp for which the function calculates a corresponding calendar value.</li>\n<li>The <code dir=\"auto\">timezone</code> parameter accepts a <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> specifying the returned value\u2019s time zone. If the <code dir=\"auto\">timezone</code> argument is not specified, the function uses the exchange time zone (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a>).</li>\n</ul>\n<p>In contrast to the functions that return UNIX timestamps, a calendar-based function returns different \u201cint\u201d results for various time zones, as calendar values represent parts of a <em>local time</em> in a <em>specific region</em>.</p>\n<p>For instance, the simple script below uses two calls to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> to calculate each bar\u2019s opening day in the exchange time zone and the \u201cAustralia/Sydney\u201d time zone. It plots the results of the two calls in a separate pane for comparison:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"736\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-1.7yz46qU5_56taF.webp\" width=\"1792\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`dayofmonth()` demo\", overlay = false)\n\n//@variable An \"int\" representing the current bar's opening calendar day in the exchange time zone. \n//          Equivalent to the `dayofmonth` variable. \nint openingDay = dayofmonth(time)\n\n//@variable An \"int\" representing the current bar's opening calendar day in the \"Australia/Sydney\" time zone.\nint openingDaySydney = dayofmonth(time, \"Australia/Sydney\")\n\n// Plot the calendar day values.\nplot(openingDay,       \"Day of Month (Exchange)\", linewidth = 6, color = color.blue)\nplot(openingDaySydney, \"Day of Month (Sydney)\",   linewidth = 3, color = color.orange)</div>\n<p>Note that:</p>\n<ul>\n<li>The first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> call calculates the bar\u2019s opening day in the exchange time zone because it does not include a <code dir=\"auto\">timezone</code> argument. This call returns the same value that the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a> variable references.</li>\n<li>Our example symbol\u2019s exchange time zone is \u201cAmerica/New_York\u201d, which follows UTC-5 during standard time and UTC-4 during daylight saving time (DST). The \u201cAustralia/Sydney\u201d time zone follows UTC+10 during standard time and UTC+11 during DST. However, Sydney observes DST at <em>different</em> times of the year than New York. As such, its time zone is 14, 15, or 16 hours ahead of the exchange time zone, depending on the time of year. The plots on our \u201c1D\u201d chart diverge when the difference is at least 15 hours because the bars open at 09:30 in exchange time, and 15 hours ahead is 00:30 on the <em>next</em> calendar day.</li>\n</ul>\n<p>It\u2019s important to understand that although the <code dir=\"auto\">time</code> argument in a calendar-based function call represents a single, absolute point in time, each function returns only <em>part</em> of the date and time information available from the timestamp. Consequently, a calendar-based function\u2019s returned value does <strong>not</strong> directly correspond to a <em>unique</em> time point, and conditions based on individual calendar values can apply to <em>multiple</em> bars.</p>\n<p>For example, this script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function to calculate a UNIX timestamp from a date \u201cstring\u201d, and it calculates the calendar day from that timestamp, in the exchange time zone, with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> function. The script compares each bar\u2019s opening day to the calculated day and highlights the background when the two are equal:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"494\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-2.CLs3hZaQ_Z1mTUCj.webp\" width=\"1468\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`dayofmonth()` demo\", overlay = false)\n\n//@variable The UNIX timestamp corresponding to August 29, 2024 at 00:00:00 UTC.\nconst int fixedTimestamp = timestamp(\"29 Aug 2024\")\n//@variable The day of the month calculated from the `fixedTimestamp`, expressed in the exchange time zone. \n//          If the exchange time zone has a negative UTC offset, this variable's value is 28 instead of 29.\nint dayFromTimestamp = dayofmonth(fixedTimestamp)\n\n//@variable An \"int\" representing the current bar's opening calendar day in the exchange time zone. \n//          Equivalent to the `dayofmonth` variable. \nint openingDay = dayofmonth(time)\n\n// Plot the `openingDay`.\nplot(openingDay, \"Opening day of month\", linewidth = 3)\n// Highlight the background when the `openingDay` equals the `dayFromTimestamp`.\nbgcolor(openingDay == dayFromTimestamp ? color.orange : na, title = \"Day detected highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call treats its argument as a <em>UTC</em> calendar date because its <code dir=\"auto\">dateString</code> argument does not specify time zone information. However, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> call calculates the day in the <em>exchange time zone</em>. Our example symbol\u2019s exchange time zone is \u201cAmerica/New_York\u201d (UTC-4/-5). Therefore, the returned value on this chart is 28 instead of 29.</li>\n<li>The script highlights <em>any</em> bar on our chart that opens on the 28th day of <em>any</em> month instead of only a specific bar because the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofmonth\">dayofmonth()</a> function\u2019s returned value does <strong>not</strong> represent a specific point in time on its own.</li>\n<li>This script highlights the bars that <em>open</em> on the day of the month calculated from the timestamp. However, some months on our chart have no trading activity on that day. For example, the script does not highlight when the July 28, 2024 occurs on our chart because NASDAQ is closed on Sundays.</li>\n</ul>\n<p>Similar to <a href=\"/pine-script-docs/v5/concepts/time/#calendar-based-variables\">calendar-based variables</a>, these functions are also helpful when testing for dates/times and detecting calendar changes on the chart. The example below uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_year\">year()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_month\">month()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_weekofyear\">weekofyear()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a> functions on the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> timestamp to create conditions that test if the current bar is the first bar that closes in a new year, quarter, month, week, and day. The script uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotted shapes</a>, <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">background colors</a> to visualize the conditions on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"640\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Calendar-based-functions-3.BgN06lg1_1QVzL3.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Calendar changes demo\", overlay = true, max_labels_count = 500)\n\n// Calculate the year, month, week of year, and day of week corresponding to the `time_close` UNIX timestamp.\n// All values are expressed in the exchange time zone. \nint closeYear       = year(time_close)\nint closeMonth      = month(time_close)\nint closeWeekOfYear = weekofyear(time_close)\nint closeDayOfWeek  = dayofweek(time_close)\n\n//@variable Is `true` when the change in `closeYear` exceeds 0, marking the first bar that closes in a new year.  \nbool closeInNewYear = ta.change(closeYear) &gt; 0\n//@variable Is `true` when the difference in `closeMonth` is not 0, marking the first bar that closes in a new month. \nbool closeInNewMonth = closeMonth - closeMonth[1] != 0\n//@variable Is `true` when `closeMonth - 1` becomes divisible by 3, marking the first bar that closes in a new quarter. \nbool closeInNewQuarter = (closeMonth[1] - 1) % 3 != 0 and (closeMonth - 1) % 3 == 0\n//@variable Is `true` when the change in `closeWeekOfYear` is not 0, marking the first bar that closes in a new week.\nbool closeInNewWeek = ta.change(closeWeekOfYear) != 0\n//@variable Is `true` when the `closeDayOfWeek` changes, marking the first bar that closes in the new day.\nbool closeInNewDay = closeDayOfWeek != closeDayOfWeek[1]\n\n//@variable Switches between `true` and `false` after every `closeInNewDay` occurrence for background color calculation.\nvar bool alternateDay = true\nif closeInNewDay\n    alternateDay := not alternateDay\n\n// Draw a label above the bar to display the `closeWeekOfYear` when `closeInNewWeek` is `true`. \nif closeInNewWeek\n    label.new(\n         time, 0, \"W\" + str.tostring(closeWeekOfYear), xloc.bar_time, yloc.abovebar, color.purple, \n         textcolor = color.white, size = size.normal\n     )\n// Plot label shapes at the bottom and top of the chart for the `closeInNewYear` and `closeInNewMonth` conditions. \nplotshape(\n     closeInNewYear, \"Close in new year\", shape.labelup, location.bottom, color.teal, text = \"New year\", \n     textcolor = color.white, size = size.huge\n )\nplotshape(\n     closeInNewMonth, \"Close in new month\", shape.labeldown, location.top, text = \"New month\", \n     textcolor = color.white, size = size.large\n )\n// Plot a triangle below the chart bar when `closeInNewQuarter` occurs. \nplotshape(\n     closeInNewQuarter, \"Close in new quarter\", shape.triangleup, location.belowbar, color.maroon, \n     text = \"New quarter\", textcolor = color.maroon, size = size.large\n )\n// Highlight the background in alternating colors based on occurrences of `closeInNewDay`.\nbgcolor(alternateDay ? color.new(color.aqua, 80) : color.new(color.fuchsia, 80), title = \"Closing day change\")</div>\n<p>Note that:</p>\n<ul>\n<li>This script\u2019s conditions check for the first bar that closes after each calendar unit changes its value. The bar where each condition is <code dir=\"auto\">true</code> varies with the data available on the chart. For example, the <code dir=\"auto\">closeInNewMonth</code> condition can be <code dir=\"auto\">true</code> <em>after</em> the first calendar day of the month if a chart bar did not close on that day.</li>\n<li>To detect when new bars start on a specific <em>timeframe</em> rather than strictly calendar changes, check when the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.change\">ta.change()</a> of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a> call\u2019s returned value is nonzero, or use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">timeframe.change()</a> function. See <a href=\"/pine-script-docs/v5/concepts/time/#testing-for-changes-in-higher-timeframes\">this section</a> above for more information.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"timestamp\"><a href=\"#timestamp\"><span>\u200b<code dir=\"auto\">timestamp()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function calculates a <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> from a specified calendar date and time. It has the following three signatures:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">timestamp(year, month, day, hour, minute, second) \u2192 simple/series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">timestamp(timezone, year, month, day, hour, minute, second) \u2192 simple/series int</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">timestamp(dateString) \u2192 const int</span></div></div></code></pre></figure></div>\n<p>The first two signatures listed include <code dir=\"auto\">year</code>, <code dir=\"auto\">month</code>, <code dir=\"auto\">day</code>, <code dir=\"auto\">hour</code>, <code dir=\"auto\">minute</code>, and <code dir=\"auto\">second</code> parameters that accept \u201cint\u201d values defining the calendar date and time. A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call with either signature must include <code dir=\"auto\">year</code>, <code dir=\"auto\">month</code>, and <code dir=\"auto\">day</code> arguments. The other parameters are optional, each with a default value of 0. Both signatures can return either <em>\u201csimple\u201d</em> or <em>\u201cseries\u201d</em> values, depending on the <a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">qualified types</a> of the specified arguments.</p>\n<p>The primary difference between the first two signatures is the <code dir=\"auto\">timezone</code> parameter, which accepts a <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> that determines the <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a> of the <em>date and time</em> specified by the other parameters. If a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call with \u201cint\u201d calendar arguments does not include a <code dir=\"auto\">timezone</code> argument, it uses the exchange time zone (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a>) by default.</p>\n<p>The third signature listed has only <em>one</em> parameter, <code dir=\"auto\">dateString</code>, which accepts a \u201cstring\u201d representing a valid calendar date (e.g., <code dir=\"auto\">\"20 Aug 2024\"</code>). The value can also include the time of day and time zone (e.g., <code dir=\"auto\">\"20 Aug 2024 00:00:00 UTC+0\"</code>). If the <code dir=\"auto\">dateString</code> argument does not specify the time of day, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call considers the time 00:00 (midnight).</p>\n<p>Unlike the other two signatures, the default time zone for the third signature is <strong>GMT+0</strong>. It does <strong>not</strong> use the exchange time zone by default because it interprets time zone information from the <code dir=\"auto\">dateString</code> directly. Additionally, the third signature is the only one that returns a <em>\u201cconst int\u201d</em> value. As shown in the <a href=\"/pine-script-docs/v5/concepts/inputs/#time-input\">Time input</a> section of the <a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a> page, programmers can use this overload\u2019s returned value as the <code dir=\"auto\">defval</code> argument in an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a> function call.</p>\n<p>When using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> function, it\u2019s crucial to understand how time zone information affects its calculations. The <em>absolute</em> point in time represented by a specific calendar date <em>depends</em> on its time zone, as an identical date and time in various time zones can refer to <strong>different</strong> amounts of time elapsed since the <em>UNIX Epoch</em>. Therefore, changing the time zone of the calendar date and time in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call <em>can change</em> its returned <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a>.</p>\n<p>The following script compares the results of four different <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> calls that evaluate the date 2021-01-01 in different time zones. The first <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call does not specify time zone information in its <code dir=\"auto\">dateString</code> argument, so it treats the value as a <em>UTC</em> calendar date. The fourth call also evaluates the calendar date in UTC because it includes <code dir=\"auto\">\"UTC0\"</code> as the <code dir=\"auto\">timezone</code> argument. The second <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call uses the first signature listed above, meaning it uses the exchange time zone, and the third call uses the second signature with <code dir=\"auto\">\"America/New_York\"</code> as the <code dir=\"auto\">timezone</code> argument.</p>\n<p>The script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> with rows displaying each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> call, its assigned variable, the calculated UNIX timestamp, and a <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> representation of the time. As we see on the \u201cNASDAQ:MSFT\u201d chart below, the first and fourth table rows show <em>different</em> timestamps than the first and third, leading to different formatted strings in the last column:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"472\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Time-functions-Timestamp-1.CFLoCdL8_A5DD7.webp\" width=\"1378\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`timestamp()` demo\", overlay = false)\n\n//@variable A `table` that displays the different `timestamp()` calls, their returned timestamps, and formatted results.\nvar table displayTable = table.new(\n     position.middle_center, 4, 5, color.white, border_color = color.black, border_width = 2\n )\n\n//@function Initializes a `displayTable` cell showing the `displayText` with an optional `specialFormat`.\nprintCell(int colID, int rowID, string displayText, string specialFormat = \"\") =&gt; \n    displayTable.cell(colID, rowID, displayText, text_size = size.large)\n    switch specialFormat \n        \"header\"  =&gt; displayTable.cell_set_bgcolor(colID, rowID, color.rgb(76, 175, 79, 70))\n        \"code\"    =&gt; \n            displayTable.cell_set_text_font_family(colID, rowID, font.family_monospace)\n            displayTable.cell_set_text_size(colID, rowID, size.normal)\n            displayTable.cell_set_text_halign(colID, rowID, text.align_left)\n\nif barstate.islastconfirmedhistory\n    //@variable The UNIX timestamp corresponding to January 1, 2021 in the UTC+0 time zone. \n    int dateTimestamp1 = timestamp(\"2021-01-01\")\n    //@variable The UNIX timestamp corresponding to January 1, 2021 in the exchange time zone. \n    int dateTimestamp2 = timestamp(2021, 1, 1, 0, 0)\n    //@variable The UNIX timestamp corresponding to January 1, 2021 in the \"America/New_York\" time zone. \n    int dateTimestamp3 = timestamp(\"America/New_York\", 2021, 1, 1, 0, 0)\n    //@variable The UNIX timestamp corresponding to January 1, 2021 in the \"UTC0\" (UTC+0) time zone. \n    int dateTimestamp4 = timestamp(\"UTC0\", 2021, 1, 1, 0, 0)\n\n    // Initialize the top header cells in the `displayTable`. \n    printCell(0, 0, \"Variable\",            \"header\")\n    printCell(1, 0, \"Function call\",       \"header\")\n    printCell(2, 0, \"Timestamp returned\",  \"header\")\n    printCell(3, 0, \"Formatted date/time\", \"header\")\n    // Initialize a table row for `dateTimestamp1` results. \n    printCell(0, 1, \"`dateTimestamp1`\", \"header\")\n    printCell(1, 1, \"`timestamp(\\\"2021-01-01\\\")`\", \"code\")\n    printCell(2, 1, str.tostring(dateTimestamp1))\n    printCell(3, 1, str.format_time(dateTimestamp1, \"yyyy.MM.dd  HH:mm (Z)\"))\n    // Initialize a table row for `dateTimestamp2` results. \n    printCell(0, 2, \"`dateTimestamp2`\", \"header\")\n    printCell(1, 2, \"`timestamp(2021, 1, 1, 0, 0)`\", \"code\")\n    printCell(2, 2, str.tostring(dateTimestamp2))\n    printCell(3, 2, str.format_time(dateTimestamp2, \"yyyy.MM.dd  HH:mm (Z)\"))\n    // Initialize a table row for `dateTimestamp3` results. \n    printCell(0, 3, \"`dateTimestamp3`\", \"header\")\n    printCell(1, 3, \"`timestamp(\\\"America/New_York\\\", 2021, 1, 1, 0, 0)`\", \"code\")\n    printCell(2, 3, str.tostring(dateTimestamp3))\n    printCell(3, 3, str.format_time(dateTimestamp3, \"yyyy.MM.dd  HH:mm (Z)\"))\n    // Initialize a table row for `dateTimestamp4` results. \n    printCell(0, 4, \"`dateTimestamp4`\", \"header\")\n    printCell(1, 4, \"`timestamp(\\\"UTC0\\\", 2021, 1, 1, 0, 0)`\", \"code\")\n    printCell(2, 4, str.tostring(dateTimestamp4))\n    printCell(3, 4, str.format_time(dateTimestamp4, \"yyyy.MM.dd  HH:mm (Z)\"))</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> date-time strings express results in the exchange time zone because the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> as the default <code dir=\"auto\">timezone</code> argument. The formatted values on our example chart show the offset string <code dir=\"auto\">\"-0500\"</code> because NASDAQ\u2019s time zone (\u201cAmerica/New_York\u201d) follows UTC-5 during <em>standard time</em>.</li>\n<li>The formatted strings on the first and fourth rows show the date and time five hours <em>before</em> January 1, 2021, because the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> calls evaluated the date in <em>UTC</em> and the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> calls used a time zone five hours <em>behind</em> UTC.</li>\n<li>On our chart, the second and third rows have matching timestamps because both corresponding <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timestamp\">timestamp()</a> calls evaluated the date in the \u201cAmerica/New_York\u201d time zone. The two rows would show different results if we applied the script to a symbol with a different exchange time zone.</li>\n</ul>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"formatting-dates-and-times\"><a href=\"#formatting-dates-and-times\">Formatting dates and times<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Programmers can format <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a> into human-readable dates and times, expressed in specific <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zones</a>, using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function. The function has the following signature:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">str.format_time(time, format, timezone) \u2192 series string</span></div></div></code></pre></figure></div>\n<p>Where:</p>\n<ul>\n<li>The <code dir=\"auto\">time</code> parameter specifies the \u201cint\u201d UNIX timestamp to express as a readable time.</li>\n<li>The <code dir=\"auto\">format</code> parameter accepts a \u201cstring\u201d consisting of <em>formatting tokens</em> that determine the returned information. If the function call does not include a <code dir=\"auto\">format</code> argument, it uses the <a href=\"https://en.wikipedia.org/wiki/ISO_8601\" rel=\"nofollow\">ISO 8601</a> standard format: <code dir=\"auto\">\"yyyy-MM-dd'T'HH:mm:ssZ\"</code>. See the table below for a list of valid tokens and the information they represent.</li>\n<li>The <code dir=\"auto\">timezone</code> parameter determines the time zone of the formatted result. It accepts a <a href=\"/pine-script-docs/v5/concepts/time/#time-zone-strings\">time zone string</a> in UTC or IANA notation. If the call does not specify a <code dir=\"auto\">timezone</code>, it uses the exchange time zone (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a>).</li>\n</ul>\n<p>The general-purpose <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a> function can also format UNIX timestamps into readable dates and times. However, the function <strong>cannot</strong> express time information in <em>different</em> time zones. It always expresses dates and times in <strong>UTC+0</strong>. In turn, using this function to format timestamps often results in <em>erroneous</em> practices, such as mathematically modifying a timestamp to try and represent the time in another time zone. However, a UNIX timestamp is a unique, <strong>time zone-agnostic</strong> representation of a specific point in time. As such, modifying a UNIX timestamp changes the <em>absolute time</em> it represents rather than expressing the same time in a different time zone.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function does not have this limitation, as it can calculate dates and times in <em>any</em> time zone correctly without changing the meaning of a UNIX timestamp. In addition, unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>, it is optimized specifically for processing time values. Therefore, we recommend that programmers use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> instead of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a> to format UNIX timestamps into readable dates and times.</p>\n<p>A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> call\u2019s <code dir=\"auto\">format</code> argument determines the time information its returned value contains. The function treats characters and sequences in the argument as <em>formatting tokens</em>, which act as <em>placeholders</em> for values in the returned date/time \u201cstring\u201d. The following table outlines valid formatting tokens and explains what each represents:</p>\n<table><thead><tr><th style=\"text-align:center\">Token</th><th style=\"text-align:center\">Represents</th><th style=\"text-align:left\">Remarks and examples</th></tr></thead><tbody><tr><td style=\"text-align:center\"><code dir=\"auto\">\"y\"</code></td><td style=\"text-align:center\">Year</td><td style=\"text-align:left\">Use <code dir=\"auto\">\"yy\"</code> to include the last two digits of the year (e.g., <code dir=\"auto\">\"00\"</code>), or <code dir=\"auto\">\"yyyy\"</code> to include the complete year number (e.g., <code dir=\"auto\">\"2000\"</code>).</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"M\"</code></td><td style=\"text-align:center\">Month</td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"M\"</code> for the month, not to be confused with <em>lowercase</em> <code dir=\"auto\">\"m\"</code> for the minute. <br>Use <code dir=\"auto\">\"MM\"</code> to include the two-digit month number with a leading zero for single-digit values (e.g., <code dir=\"auto\">\"01\"</code>), <code dir=\"auto\">\"MMM\"</code> to include the three-letter abbreviation of month (e.g., <code dir=\"auto\">\"Jan\"</code>), or <code dir=\"auto\">\"MMMM\"</code> for the full month name (e.g., <code dir=\"auto\">\"January\"</code>).</br></td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"d\"</code></td><td style=\"text-align:center\">Day of the <strong>month</strong></td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"d\"</code>. <br/>Includes the numeric day of the month (<code dir=\"auto\">\"1\"</code> to <code dir=\"auto\">\"31\"</code>). <br/> Use <code dir=\"auto\">\"dd\"</code> for the two-digit day number with a leading zero for single-digit values. <br/>It is <em>not</em> a placeholder for the day number of the <em>week</em> (1-7). Use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_dayofweek\">dayofweek()</a> to calculate that value.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"D\"</code></td><td style=\"text-align:center\">Day of the <strong>year</strong></td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"D\"</code>. <br/> Includes the numeric day of the year (<code dir=\"auto\">\"1\"</code> to <code dir=\"auto\">\"366\"</code>). <br/> Use <code dir=\"auto\">\"DD\"</code> or <code dir=\"auto\">\"DDD\"</code> for the two-digit or three-digit day number with leading zeros.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"w\"</code></td><td style=\"text-align:center\">Week of the <strong>year</strong></td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"w\"</code>. <br/>Includes the week number of the year (<code dir=\"auto\">\"1\"</code> to <code dir=\"auto\">\"53\"</code>). <br/>Use <code dir=\"auto\">\"ww\"</code> for the two-digit week number with a leading zero for single-digit values.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"W\"</code></td><td style=\"text-align:center\">Week of the <strong>month</strong></td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"W\"</code>. <br/>Includes the week number of the month (<code dir=\"auto\">\"1\"</code> to <code dir=\"auto\">\"5\"</code>).</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"a\"</code></td><td style=\"text-align:center\">AM/PM postfix</td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"a\"</code>. <br/>Includes <code dir=\"auto\">\"AM\"</code> if the time of day is before noon, <code dir=\"auto\">\"PM\"</code> otherwise.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"h\"</code></td><td style=\"text-align:center\">Hour in the <strong>12-hour</strong> format</td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"h\"</code>. <br/>The included hour number from this token ranges from <code dir=\"auto\">\"0\"</code> to <code dir=\"auto\">\"11\"</code>. <br/>Use <code dir=\"auto\">\"hh\"</code> for the two-digit hour with a leading zero for single-digit values.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"H\"</code></td><td style=\"text-align:center\">Hour in the <strong>24-hour</strong> format</td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"H\"</code>. <br/>The included hour number from this token ranges from <code dir=\"auto\">\"0\"</code> to <code dir=\"auto\">\"23\"</code>. <br/>Use <code dir=\"auto\">\"HH\"</code> for the two-digit hour with a leading zero for single-digit values.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"m\"</code></td><td style=\"text-align:center\">Minute</td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"m\"</code> for the minute, not to be confused with <em>uppercase</em> <code dir=\"auto\">\"M\"</code> for the month. <br/>Use <code dir=\"auto\">\"mm\"</code> for the two-digit minute with a leading zero for single-digit values.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"s\"</code></td><td style=\"text-align:center\">Second</td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"s\"</code> for the second, not to be confused with <em>uppercase</em> <code dir=\"auto\">\"S\"</code> for fractions of a second. <br/>Use <code dir=\"auto\">\"ss\"</code> for the two-digit second with a leading zero for single-digit values.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"S\"</code></td><td style=\"text-align:center\">Fractions of a second</td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"S\"</code>. <br/> Includes the number of milliseconds in the fractional second (<code dir=\"auto\">\"0\"</code> to <code dir=\"auto\">\"999\"</code>). <br/> Use <code dir=\"auto\">\"SS\"</code> or <code dir=\"auto\">\"SSS\"</code> for the two-digit or three-digit millisecond number with leading zeros.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"Z\"</code></td><td style=\"text-align:center\">Time zone (<strong>UTC offset</strong>)</td><td style=\"text-align:left\">Uppercase <code dir=\"auto\">\"Z\"</code>. <br/> Includes the hour and minute UTC offset value in <code dir=\"auto\">\"HHmm\"</code> format, preceded by its sign (e.g., <code dir=\"auto\">\"-0400\"</code>).</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"z\"</code></td><td style=\"text-align:center\">Time zone (<strong>acronym or name</strong>)</td><td style=\"text-align:left\">Lowercase <code dir=\"auto\">\"z\"</code>. <br/> A single <code dir=\"auto\">\"z\"</code> includes the abbreviation of the time zone (e.g., <code dir=\"auto\">\"EDT\"</code>). <br/> Use <code dir=\"auto\">\"zzzz\"</code> for the time zone\u2019s name (e.g., <code dir=\"auto\">\"Eastern Daylight Time\"</code>). <br/>It is not a placeholder for the <em>IANA identifier</em>. Use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.timezone\">syminfo.timezone</a> to retrieve the exchange time zone\u2019s IANA representation.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\":\"</code>, <code dir=\"auto\">\"/\"</code>, <code dir=\"auto\">\"-\"</code>, <code dir=\"auto\">\".\"</code>, <code dir=\"auto\">\",\"</code>, <code dir=\"auto\">\"(\"</code>, <code dir=\"auto\">\")\"</code>, <code dir=\"auto\">\" \"</code></td><td style=\"text-align:center\">Separators</td><td style=\"text-align:left\">These characters are separators for formatting tokens. <br/>They appear as they are in the formatted text. (e.g., <code dir=\"auto\">\"01/01/24\"</code>, <code dir=\"auto\">\"12:30:00\"</code>, <code dir=\"auto\">\"Jan 1, 2024\"</code>). <br/> Some other characters can also act as separators. However, the ones listed are the most common.</td></tr><tr><td style=\"text-align:center\"><code dir=\"auto\">\"'\"</code></td><td style=\"text-align:center\">Escape character</td><td style=\"text-align:left\">Characters enclosed within <em>two single quotes</em> appear as they are in the result, even if they otherwise act as formatting tokens. For example, <code dir=\"auto\">\" 'Day' \"</code> appears as-is in the resulting \u201cstring\u201d instead of listing the day of the year, AM/PM postfix, and year.</td></tr></tbody></table>\n<p>The following example demonstrates how various formatting tokens affect the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function\u2019s result. The script calls the function with different <code dir=\"auto\">format</code> arguments to create date/time strings from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time_close\">time_close</a> timestamps. It displays each <code dir=\"auto\">format</code> value and the corresponding formatted result in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the last bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"528\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Formatting-dates-and-times-1.BsC0g9qz_29jz4f.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Formatting dates and times demo\", overlay = false)\n\n//@variable A `table` that displays different date/time `format` strings and their results.\nvar table displayTable = table.new(\n     position.middle_center, 2, 15, bgcolor = color.white, \n     frame_color = color.black, frame_width = 1, border_width = 1\n )\n\n//@function Initializes a `displayTable` row showing a `formatString` and its formatted result for a specified \n//          `timeValue` and `timezoneValue`.\ndisplayText(rowID, formatString, timeValue = time, timezoneValue = syminfo.timezone) =&gt;\n    //@variable Is light blue if the `rowID` is even, white otherwise. Used to set alternating table row colors.\n    color rowColor = rowID % 2 == 0 ? color.rgb(33, 149, 243, 75) : color.white\n    // Display the `formatString` in the row's first cell.\n    displayTable.cell(\n         0, rowID, formatString,\n         text_color = color.black, text_halign = text.align_left, bgcolor = rowColor\n     )\n    // Show the result of formatting the `timeValue` based on the `formatString` and `timezoneValue` in the second cell.\n    displayTable.cell(\n         1, rowID, str.format_time(timeValue, formatString, timezoneValue), \n         text_color = color.black, text_halign = text.align_right, bgcolor = rowColor\n     )\n\nif barstate.islast\n    // Initialize the table's header cells.\n    displayTable.cell(0, 0, \"FORMAT STRINGS\")\n    displayTable.cell(1, 0, \"FORMATTED DATE/TIME OUTPUT\")\n    // Initialize a row to show the default date-time \"string\" format and its result for `time`. \n    displayTable.cell(\n         0, 1, \"(Default `str.format_time()` format)\", \n         text_color = color.black, text_halign = text.align_left, bgcolor = color.yellow)\n    displayTable.cell(\n         1, 1, str.format_time(time), \n         text_color = color.black, text_halign = text.align_right, bgcolor = color.yellow)\n\n    // Initialize rows to show different formatting strings and their results for `time`, `time_close`, and `timenow`.\n    displayText(2, \"dd/MM/yy\")\n    displayText(3, \"MMMM dd, yyyy\")\n    displayText(4, \"hh:mm:ss.SS a\", timenow)\n    displayText(5, \"HH:mm 'UTC'Z\")\n    displayText(6, \"H:mm a (zzzz)\")\n    displayText(7, \"my day / 'my day' ('escaped')\")\n    displayText(8, \"'Month' M, 'Week' w, 'Day' DDD\")\n    displayText(9, \"'Bar expected closing time': ha\", time_close)\n    displayText(10, \"'Current date/time': MMM-d-y HH:mm:ss z\", timenow)\n    displayText(11, \"'New Time zone': zzzz\", timezoneValue = \"Australia/Sydney\")\n    displayText(12, \"'Time zone change': MMM-d-y HH:mm:ss z\", timenow, \"Australia/Sydney\")</div>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/time", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"expressing-time-differences\"><a href=\"#expressing-time-differences\">Expressing time differences<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Every <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamp</a> represents a specific point in time as the absolute <em>time difference</em> from a fixed historical point (epoch). The specific epoch all UNIX timestamps reference is <em>midnight UTC on January 1, 1970</em>. Programmers can <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">format</a> UNIX timestamps into readable date-time strings with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function because it uses the time difference from the UNIX Epoch in its date and time calculations.</p>\n<p>In contrast, the difference between two nonzero UNIX timestamps represents the number of milliseconds elapsed from one absolute point to another. The difference does not directly refer to a specific point in UNIX time if neither timestamp in the operation has a value of 0 (corresponding to the UNIX Epoch).</p>\n<p>Programmers may want to express the millisecond difference between two UNIX timestamps in <em>other time units</em>, such as seconds, days, etc. Some might assume they can use the difference as the <code dir=\"auto\">time</code> argument in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> call to achieve this result. However, the function always treats its <code dir=\"auto\">time</code> argument as the time elapsed from the <em>UNIX Epoch</em> to derive a <em>calendar date/time</em> representation in a specific <a href=\"/pine-script-docs/v5/concepts/time/#time-zones\">time zone</a>. It <strong>does not</strong> express time differences directly. Therefore, attempting to format timestamp <em>differences</em> rather than timestamps with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> leads to unintended results.</p>\n<p>For example, the following script calculates the millisecond difference between the current execution time (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>) and the \u201c1M\u201d bar\u2019s closing time (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close(\u201c1M\u201d)</a>) for a monthly countdown timer display. It attempts to express the time difference in another format using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a>. It displays the function call\u2019s result in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>, along with the original millisecond difference (<code dir=\"auto\">timeLeft</code>) and <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> date-time representations of the timestamps.</p>\n<p>As we see below, the table shows correct results for the formatted timestamps and the <code dir=\"auto\">timeLeft</code> value. However, the formatted time difference appears as <code dir=\"auto\">\"1970-01-12T16:47:10-0500\"</code>. Although the <code dir=\"auto\">timeLeft</code> value is supposed to represent a difference between timestamps rather than a specific point in time, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a> function still treats the value as a <strong>UNIX timestamp</strong>. Consequently, it creates a \u201cstring\u201d expressing the value as a <em>date and time</em> in the UTC-5 time zone:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Relative-time-differences-1.Bn5sSvwp_ZWpy0r.webp\" width=\"1666\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Incorrectly formatting time difference demo\", overlay = true)\n\n//@variable A table that displays monthly close countdown information.\nvar table displayTable = table.new(position.top_right, 1, 4, color.rgb(0, 188, 212, 60))\n\nif barstate.islast\n    //@variable A UNIX timestamp representing the current time as of the script's latest execution. \n    int currentTime = timenow\n    //@variable A UNIX timestamp representing the expected closing time of the current \"1M\" bar. \n    int monthCloseTime = time_close(\"1M\")\n\n    //@variable The number of milliseconds between the `currentTime` and the `monthCloseTime`. \n    //          This value is NOT intended as a UNIX timestamp.\n    int timeLeft = monthCloseTime - currentTime\n    //@variable A \"string\" representing the `timeLeft` as a date and time in the exchange time zone, in ISO 8601 format.\n    //          This format is INCORRECT for the `timeLeft` value because it's supposed to represent the time between \n    //          two nonzero UNIX timestamps, NOT a specific point in time.\n    string incorrectTimeFormat = str.format_time(timeLeft)\n\n    // Initialize `displayTable` cells to initialize the `currentTime` and `monthCloseTime`.\n    displayTable.cell(\n         0, 0, \"Current time: \" + str.format_time(currentTime, \"HH:mm:ss.S dd/MM/yy (z)\"), \n         text_size = size.large, text_halign = text.align_right\n     )\n    displayTable.cell(\n         0, 1, \"`1M` Bar closing time: \" + str.format_time(monthCloseTime, \"HH:mm:ss.SS dd/MM/yy (z)\"), \n         text_size = size.large, text_halign = text.align_right\n     )\n    // Initialize a cell to display the `timeLeft` millisecond difference.\n    displayTable.cell(\n         0, 2, \"`timeLeft` value: \" + str.tostring(timeLeft), \n         text_size = size.large, bgcolor = color.yellow\n     )\n    // Initialize a cell to display the `incorrectTimeFormat` representation.\n    displayTable.cell(\n         0, 3, \"Time left (incorrect format): \" + incorrectTimeFormat, \n         text_size = size.large, bgcolor = color.maroon, text_color = color.white\n     )</div>\n<p>To express the difference between timestamps in other time units correctly, programmers must write code that <em>calculates</em> the number of units elapsed instead of erroneously formatting the difference as a specific date or time.</p>\n<p>The calculations required to express time differences depend on the chosen time units. The sections below explain how to express millisecond differences in <a href=\"/pine-script-docs/v5/concepts/time/#weekly-and-smaller-units\">weekly and smaller units</a>, and <a href=\"/pine-script-docs/v5/concepts/time/#monthly-and-larger-units\">monthly and larger units</a>.</p>\n<h3 class=\"md-heading\" id=\"weekly-and-smaller-units\"><a href=\"#weekly-and-smaller-units\">Weekly and smaller units<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Weeks and smaller time units (days, hours, minutes, seconds, and milliseconds) cover <em>consistent</em> blocks of time. These units have the following relationship:</p>\n<ul>\n<li>One week equals seven days.</li>\n<li>One day equals 24 hours.</li>\n<li>One hour equals 60 minutes.</li>\n<li>One minute equals 60 seconds.</li>\n<li>One second equals 1000 milliseconds.</li>\n</ul>\n<p>Using this relationship, programmers can define the span of these units by the number of <em>milliseconds</em> they contain. For example, since every hour has 60 minutes, every minute has 60 seconds, and every second has 1000 milliseconds, the number of milliseconds per hour is <code dir=\"auto\">60 * 60 * 1000</code>, which equals <code dir=\"auto\">3600000</code>.</p>\n<p>Programmers can use <em>modular arithmetic</em> based on the milliseconds in each unit to calculate the total number of weeks, days, and smaller spans covered by the difference between two <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a>. The process is as follows, starting from the <em>largest</em> time unit in the calculation:</p>\n<ol>\n<li>Calculate the number of milliseconds in the time unit.</li>\n<li>Divide the remaining millisecond difference by the calculated value and round down to the nearest whole number. The result represents the number of <em>complete</em> time units within the interval.</li>\n<li>Use the <em>remainder</em> from the division as the new remaining millisecond difference.</li>\n<li>Repeat steps 1-3 for each time unit in the calculation, in <em>descending</em> order based on size.</li>\n</ol>\n<p>The following script implements this process in a custom <code dir=\"auto\">formatTimeSpan()</code> function. The function accepts two UNIX timestamps defining a start and end point, and its \u201cbool\u201d parameters control whether it calculates the number of weeks or smaller units covered by the time range. The function calculates the millisecond distance between the two timestamps. It then calculates the numbers of complete units covered by that distance and formats the results into a \u201cstring\u201d.</p>\n<p>The script calls <code dir=\"auto\">formatTimeSpan()</code> to express the difference between two separate <a href=\"/pine-script-docs/v5/concepts/inputs/#time-input\">time input</a> values in selected time units. It then displays the resulting \u201cstring\u201d in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> alongside <a href=\"/pine-script-docs/v5/concepts/time/#formatting-dates-and-times\">formatted</a> representations of the start and end times:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"412\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Relative-time-differences-Weekly-and-smaller-units-1.CkIHycnQ_yxUkv.webp\" width=\"1256\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Calculating time span demo\")\n\n// Assign the number of milliseconds in weekly and smaller units to \"const\" variables for convenience.\nconst int ONE_WEEK   = 604800000\nconst int ONE_DAY    =  86400000 \nconst int ONE_HOUR   =   3600000\nconst int ONE_MINUTE =     60000\nconst int ONE_SECOND =      1000\n\n//@variable A UNIX timestamp calculated from the user-input start date and time. \nint startTimeInput = input.time(timestamp(\"1 May 2022 00:00 -0400\"), \"Start date and time\", group = \"Time between\")\n//@variable A UNIX timestamp calculated from the user-input end date and time. \nint endTimeInput =   input.time(timestamp(\"7 Sep 2024 20:37 -0400\"), \"End date and time\", group = \"Time between\")\n// Create \"bool\" inputs to toggle weeks, days, hours, minutes, seconds, and milliseconds in the calculation.\nbool weeksInput        = input.bool(true, \"Weeks\",        group = \"Time units\", inline = \"A\")\nbool daysInput         = input.bool(true, \"Days\",         group = \"Time units\", inline = \"A\")\nbool hoursInput        = input.bool(true, \"Hours\",        group = \"Time units\", inline = \"B\")\nbool minutesInput      = input.bool(true, \"Minutes\",      group = \"Time units\", inline = \"B\")\nbool secondsInput      = input.bool(true, \"Seconds\",      group = \"Time units\", inline = \"B\")\nbool millisecondsInput = input.bool(true, \"Milliseconds\", group = \"Time units\", inline = \"B\")\n\n//@function Calculates the difference between two UNIX timestamps as the number of complete time units in \n//          descending order of size, formatting the results into a \"string\". The \"int\" parameters accept timestamps, \n//          and the \"bool\" parameters determine which units the function uses in its calculations. \nformatTimeSpan(\n      int startTimestamp, int endTimestamp, bool calculateWeeks, bool calculateDays, bool calculateHours, \n      bool calculateMinutes, bool calculateSeconds, bool calculateMilliseconds\n ) =&gt;\n    //@variable The milliseconds between the `startTimestamp` and `endTimestamp`.\n    int timeDifference = math.abs(endTimestamp - startTimestamp) \n    //@variable A \"string\" representation of the interval in mixed time units. \n    string formattedString = na\n    // Calculate complete units within the interval for each toggled unit, reducing the `timeDifference` by those sizes.\n    if calculateWeeks\n        int totalWeeks = math.floor(timeDifference / ONE_WEEK)\n        timeDifference %= ONE_WEEK\n        formattedString += str.tostring(totalWeeks) + (totalWeeks == 1 ? \" week \" : \" weeks \") \n    if calculateDays\n        int totalDays = math.floor(timeDifference / ONE_DAY)\n        timeDifference %= ONE_DAY\n        formattedString += str.tostring(totalDays) + (totalDays == 1 ? \" day \" : \" days \")\n    if calculateHours\n        int totalHours = math.floor(timeDifference / ONE_HOUR)\n        timeDifference %= ONE_HOUR\n        formattedString += str.tostring(totalHours) + (totalHours == 1 ? \" hour \" : \" hours \")\n    if calculateMinutes\n        int totalMinutes = math.floor(timeDifference / ONE_MINUTE)\n        timeDifference %= ONE_MINUTE\n        formattedString += str.tostring(totalMinutes) + (totalMinutes == 1 ? \" minute \" : \" minutes \")\n    if calculateSeconds\n        int totalSeconds = math.floor(timeDifference / ONE_SECOND)\n        timeDifference %= ONE_SECOND\n        formattedString += str.tostring(totalSeconds) + (totalSeconds == 1 ? \" second \" : \" seconds \")  \n    if calculateMilliseconds\n        // `timeDifference` is in milliseconds already, so add it to the `formattedString` directly.\n        formattedString += str.tostring(timeDifference) + (timeDifference == 1 ? \" millisecond\" : \" milliseconds\")\n    // Return the `formattedString`.\n    formattedString\n\nif barstate.islastconfirmedhistory\n    //@variable A table that that displays formatted start and end times and their custom-formatted time difference. \n    var table displayTable = table.new(position.middle_center, 1, 2, color.aqua)\n    //@variable A \"string\" containing formatted `startTimeInput` and `endTimeInput` values. \n    string timeText = \"Start date and time: \"    + str.format_time(startTimeInput, \"dd/MM/yy HH:mm:ss (z)\")\n                     + \"\\n  End date and time: \" + str.format_time(endTimeInput, \"dd/MM/yy HH:mm:ss (z)\")\n    //@variable A \"string\" representing the span between `startTimeInput` and `endTimeInput` in mixed time units.\n    string userTimeSpan = formatTimeSpan(\n         startTimeInput, endTimeInput, weeksInput, daysInput, hoursInput, minutesInput, secondsInput, millisecondsInput\n      )\n    // Display the `timeText` in the table.\n    displayTable.cell(0, 0, timeText, \n         text_color = color.white, text_size = size.large, text_halign = text.align_left)\n    // Display the `userTimeSpan` in the table.\n    displayTable.cell(0, 1, \"Time span: \" + userTimeSpan, \n          text_color = color.white, text_size = size.large, text_halign = text.align_left, bgcolor = color.navy)</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.floor\">math.floor()</a> to round each divided result down to the nearest \u201cint\u201d value to get the number of <em>complete</em> units in the interval. After division, it uses the modulo assignment operator (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%25=\">%=</a>) to get the <em>remainder</em> and assign that value to the <code dir=\"auto\">timeDifference</code> variable. This process repeats for each selected unit.</li>\n</ul>\n<p>The image above shows the calculated time difference in mixed time units. By toggling the \u201cbool\u201d inputs, users can also isolate specific units in the calculation. For example, this image shows the result after enabling only the \u201cMilliseconds\u201d input:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"338\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Relative-time-differences-Weekly-and-smaller-units-2.CwvuIXRj_ZdIqWW.webp\" width=\"988\"/></p>\n<h3 class=\"md-heading\" id=\"monthly-and-larger-units\"><a href=\"#monthly-and-larger-units\">Monthly and larger units<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Unlike weeks and smaller units, months and larger units <em>vary</em> in length based on calendar rules. For example, a month can contain 28, 29, 30, or 31 days, and a year can contain 365 or 366 days.</p>\n<p>Some programmers prefer to use the modular arithmetic outlined in the <a href=\"/pine-script-docs/v5/concepts/time/#weekly-and-smaller-units\">previous section</a>, with <em>approximate lengths</em> for these irregular units, to calculate large-unit durations between <a href=\"/pine-script-docs/v5/concepts/time/#unix-timestamps\">UNIX timestamps</a>. With this process, programmers usually define the units in either of the following ways:</p>\n<ul>\n<li>Using <em>common</em> lengths, e.g., a common year equals 365 days, and a common month equals 30 days.</li>\n<li>Using the <em>average</em> lengths, e.g., an average year equals 365.25 days, and an average month equals 30.4375 days.</li>\n</ul>\n<p>Calculations involving approximate units produce <em>rough estimates</em> of the elapsed time. Such estimates are often practical when expressing relatively short durations. However, their precision diminishes with the size of the difference, drifting further away from the actual time elapsed.</p>\n<p>Therefore, expressing time differences in monthly and larger units with precision requires a different calculation than the process outlined above. For a more precise estimate of months, years, and larger units elapsed, the calculations should use the <em>actual</em> span of each individual unit rather than approximations, meaning it must account for <em>leap years</em> and <em>variations</em> in month sizes.</p>\n<p>The advanced example below contains a custom <code dir=\"auto\">formatTimeDifference()</code> function that calculates the years and months, in addition to days and smaller units, elapsed between two UNIX timestamps.</p>\n<p>The function uses the process outlined in the <a href=\"/pine-script-docs/v5/concepts/time/#weekly-and-smaller-units\">previous section</a> to calculate the daily and smaller units within the interval. For the monthly and yearly units, which have <em>irregular</em> lengths, the function uses a <a href=\"/pine-script-docs/v5/language/loops/#while-loops\">while</a> loop to iterate across calendar months. On each iteration, it increments monthly and yearly counters and subtracts the number of days in the added month from the day counter. After the loop ends, the function adjusts the year, month, and day counters to account for partial months elapsed between the timestamps. Finally, it uses the counters in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a> call to create a formatted \u201cstring\u201d containing the calculated values.</p>\n<p>The script calls this <code dir=\"auto\">formatTimeDifference()</code> function to calculate the years, months, days, hours, minutes, seconds, and milliseconds elapsed between two separate <a href=\"/pine-script-docs/v5/concepts/inputs/#time-input\">time input</a> values and displays the result in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"428\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Time-Relative-time-differences-Monthly-and-larger-units-1.BhYyGmym_1QIbUd.webp\" width=\"1060\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Calculating time span for larger units demo\")\n\n//@variable The starting date and time of the time span, input by the user.\nint startTimeInput = input.time(timestamp(\"3 Apr 2022 20:00 -0400\"), \"Start date\", group = \"Time between\")\n//@variable The ending date and time of the time span, input by the user.\nint endTimeInput =   input.time(timestamp(\"3 Sep 2024 15:45 -0400\"), \"End date\",   group = \"Time between\")\n\n//@function Returns the number of days in the `monthNumber` month of the `yearNumber` year.\ndaysPerMonth(int yearNumber, int monthNumber) =&gt;\n    //@variable Is `true` if the `yearNumber` represents a leap year.\n    bool leapYear = (yearNumber % 4 == 0 and yearNumber % 100 != 0) or (yearNumber % 400 == 0)\n    //@variable The number of days calculated for the month.\n    int result = switch\n        monthNumber == 2 =&gt; leapYear ? 29 : 28\n        =&gt;                  31 - (monthNumber - 1) % 7 % 2\n\n//@function Calculates the relative time difference between two timestamps, covering monthly and larger units.\nformatTimeDifference(int timestamp1, int timestamp2) =&gt;\n    // The starting time and ending time.\n    int startTime = math.min(timestamp1, timestamp2), int endTime = math.max(timestamp1, timestamp2)\n    // The year, month, and day of the `startTime` and `endTime`.\n    int startYear = year(startTime), int startMonth = month(startTime), int startDay = dayofmonth(startTime)\n    int endYear   = year(endTime),   int endMonth   = month(endTime),   int endDay   = dayofmonth(endTime)\n    // Calculate the total number of days, hours, minutes, seconds, and milliseconds in the interval.\n    int milliseconds = endTime - startTime\n    int days         = math.floor(milliseconds / 86400000), milliseconds %= 86400000\n    int hours        = math.floor(milliseconds / 3600000),  milliseconds %= 3600000\n    int minutes      = math.floor(milliseconds / 60000),    milliseconds %= 60000\n    int seconds      = math.floor(milliseconds / 1000),     milliseconds %= 1000\n    // Calculate the number of days in the `startMonth` and `endMonth`.\n    int daysInStartMonth = daysPerMonth(startYear, startMonth), int daysInEndMonth = daysPerMonth(endYear, endMonth)\n    //@variable The number of days remaining in the `startMonth`. \n    int remainingInMonth = daysInStartMonth - startDay + 1\n    // Subtract `remainingInMonth` from the `days`, and offset the `startDay` and `startMonth`.\n    days -= remainingInMonth, startDay := 1, startMonth += 1\n    // Set `startMonth` to 1, and increase the `startYear` if the `startMonth` exceeds 12.\n    if startMonth &gt; 12\n        startMonth := 1, startYear += 1\n    // Initialize variables to count the total number of months and years in the interval.\n    int months = 0, int years  = 0\n    // Loop to increment `months` and `years` values based on the `days`.\n    while days &gt; 0\n        //@variable The number of days in the current `startMonth`.\n        int daysInMonth = daysPerMonth(startYear, startMonth)\n        // Break the loop if the number of remaining days is less than the `daysInMonth`.\n        if days &lt; daysInMonth\n            break\n        // Reduce the `days` by the `daysInMonth` and increment the `months`.\n        days -= daysInMonth, months += 1\n        // Increase the `years` and reset the `months` to 0 when `months` is 12.\n        if months == 12\n            months := 0, years += 1\n        // Increase the `startMonth` and adjust the `startMonth` and `startYear` if its value exceeds 12.\n        startMonth += 1\n        if startMonth &gt; 12\n            startMonth := 1, startYear += 1\n    // Re-add the `remainingInMonth` value to the number of `days`. Adjust the `days`, `months`, and `years` if the \n    // new value exceeds the `daysInStartMonth` or `daysInEndMonth`, depending on the `startDay`.\n    days += remainingInMonth\n    if days &gt;= (startDay &lt; daysInStartMonth / 2 ? daysInStartMonth : daysInEndMonth) \n        months += 1\n        if months == 12\n            months := 0, years += 1\n        days -= remainingInMonth\n    // Format the calculated values into a \"string\" and return the result.\n    str.format(\n         \" Years: \u2003\u2002{0}\\n Months:\u2003{1}\\n Days: \u2003\u2000 {2}\\n Hours:\u2009\u2009\u2003 {3}\\n Minutes:\u2009\u2000{4}\\n Seconds:\u2002{5}\n         \\n Milliseconds: {6}\", years, months, days, hours, minutes, seconds, milliseconds\n     )\n\nif barstate.islastconfirmedhistory\n    //@variable A \"string\" representing the time between the `startTimeInput` and `endTimeInput` in mixed units. \n    string userTimeSpan = formatTimeDifference(startTimeInput, endTimeInput)\n    //@variable Text shown in the label.\n    string labelText = \"Start time: \" + str.format_time(startTimeInput, \"dd/MM/yy HH:mm:ss (z)\") + \"\\n  End time: \"\n         +  str.format_time(endTimeInput, \"dd/MM/yy HH:mm:ss (z)\") + \"\\n---------\\nTime difference:\\n\" + userTimeSpan\n    label.new(\n         bar_index, high, labelText, color = #FF946E, size = size.large, \n         textalign = text.align_left, style = label.style_label_center\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>The script determines the number of days in each month with the user-defined <code dir=\"auto\">daysPerMonth()</code> function. The function identifies whether a month has 28, 29, 30, or 31 days based on its month number and the year it belongs to. Its calculation accounts for leap years. A leap year occurs when the year is divisible by 4 or 400 but not by 100.</li>\n<li>Before the <a href=\"/pine-script-docs/v5/language/loops/#while-loops\">while</a> loop, the function subtracts the number of days in a partial starting month from the initial day count, aligning the counters with the beginning of a new month. It re-adds the subtracted days after the loop to adjust the counters for partial months. It adjusts the month and year counters based on the days in the <code dir=\"auto\">startMonth</code> if the <code dir=\"auto\">startDay</code> is less than halfway through that month. Otherwise, it adjusts the values based on the days in the <code dir=\"auto\">endMonth</code>.</li>\n</ul>", "segment_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "66422f379a49e2a6f3e185bbafb829f7c99e8f64e8ea6d99f3510e8333340000", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/concepts/timeframes\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"timeframes\"><a href=\"#timeframes\">Timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <em>timeframe</em> of a chart is sometimes also referred to as its\n<em>interval</em> or <em>resolution</em>. It is the unit of time represented by one\nbar on the chart. All standard chart types use a timeframe: \u201cBars\u201d,\n\u201cCandles\u201d, \u201cHollow Candles\u201d, \u201cLine\u201d, \u201cArea\u201d and \u201cBaseline\u201d.\nOne non-standard chart type also uses timeframes: \u201cHeikin Ashi\u201d.</p>\n<p>Programmers interested in accessing data from multiple timeframes will\nneed to become familiar with how timeframes are expressed in Pine\nScript\u00ae, and how to use them.</p>\n<p><strong>Timeframe strings</strong> come into play in different contexts:</p>\n<ul>\n<li>They must be used in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nwhen requesting data from another symbol and/or timeframe. See the\npage on\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> to explore the use of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>.</li>\n<li>They can be used as an argument to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a>\nfunctions, to return the time of a higher timeframe bar. This, in\nturn, can be used to detect changes in higher timeframes from the\nchart\u2019s timeframe without using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>.\nSee the\n<a href=\"/pine-script-docs/v5/concepts/time/#testing-for-changes-in-higher-timeframes\">Testing for changes in higher timeframes</a> section to see how to do this.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.timeframe()</a>\nfunction provides a way to allow script users to define a timeframe\nthrough a script\u2019s \u201cInputs\u201d tab (see the\n<a href=\"/pine-script-docs/v5/concepts/inputs/#timeframe-input\">Timeframe input</a> section for more information).</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ndeclaration statement has an optional <code dir=\"auto\">timeframe</code> parameter that can\nbe used to provide multi-timeframe capabilities to simple scripts\nwithout using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>.</li>\n<li>Many built-in variables provide information on the timeframe used by\nthe chart the script is running on. See the\n<a href=\"/pine-script-docs/v5/concepts/chart-information/#chart-timeframe\">Chart timeframe</a> section for more information on them, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dperiod\">timeframe.period</a>\nwhich returns a string in Pine Script\u2019s timeframe specification\nformat.</li>\n</ul>", "segment_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"timeframe-string-specifications\"><a href=\"#timeframe-string-specifications\">Timeframe string specifications<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Timeframe strings follow these rules:</p>\n<ul>\n<li>\n<p>They are composed of the multiplier and the timeframe unit, e.g.,\n\u201c1S\u201d, \u201c30\u201d (30 minutes), \u201c1D\u201d (one day), \u201c3M\u201d (three\nmonths).</p>\n</li>\n<li>\n<p>The unit is represented by a single letter, with no letter used for\nminutes: \u201cT\u201d for ticks, \u201cS\u201d for seconds, \u201cD\u201d for days, \u201cW\u201d for weeks, and\n\u201cM\u201d for months.</p>\n</li>\n<li>\n<p>When no multiplier is used, 1 is assumed: \u201cS\u201d is equivalent to\n\u201c1S\u201d, \u201cD\u201d to \u201c1D\u201d, etc. If only \u201c1\u201d is used, it is interpreted\nas 1 minute, since no unit letter identifier is used for minutes.</p>\n</li>\n<li>\n<p>There is no \u201chour\u201d unit; \u201c1H\u201d is <strong>not</strong> valid. The correct\nformat for one hour is \u201c60\u201d (remember no unit letter is specified\nfor minutes).</p>\n</li>\n<li>\n<p>The valid multipliers vary for each timeframe unit:</p>\n<ul>\n<li>For ticks, only the discrete 1, 10, 100, and 1000 multipliers are valid.</li>\n<li>For seconds, only the discrete 1, 5, 10, 15, 30, and 45 multipliers are valid.</li>\n<li>For minutes, 1 to 1440.</li>\n<li>For days, 1 to 365.</li>\n<li>For weeks, 1 to 52.</li>\n<li>For months, 1 to 12.</li>\n</ul>\n</li>\n</ul>", "segment_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/concepts/timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"comparing-timeframes\"><a href=\"#comparing-timeframes\">Comparing timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>It can be useful to compare different timeframe strings to determine,\nfor example, if the timeframe used on the chart is lower than the higher\ntimeframes used in the script.</p>\n<p>Converting timeframe strings to a representation in fractional minutes\nprovides a way to compare them using a universal unit. This script uses\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe%7Bdot%7Din_seconds\">timeframe.in_seconds()</a>\nfunction to convert a timeframe into float seconds and then converts the\nresult into minutes:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Timeframe in minutes example\", \"\", true)\nstring tfInput = input.timeframe(defval = \"\", title = \"Input TF\")\n\nfloat chartTFInMinutes = timeframe.in_seconds() / 60\nfloat inputTFInMinutes = timeframe.in_seconds(tfInput) / 60\n\nvar table t = table.new(position.top_right, 1, 1)\nstring txt = \"Chart TF: \"    + str.tostring(chartTFInMinutes, \"#.##### minutes\") + \n\"\\nInput TF: \" + str.tostring(inputTFInMinutes, \"#.##### minutes\")\nif barstate.isfirst\n    table.cell(t, 0, 0, txt, bgcolor = color.yellow)\nelse if barstate.islast\n    table.cell_set_text(t, 0, 0, txt)\n\nif chartTFInMinutes &gt; inputTFInMinutes\n    runtime.error(\"The chart's timeframe must not be higher than the input's timeframe.\")</div>\n<p>Note that:</p>\n<ul>\n<li>We use the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe%7Bdot%7Din_seconds\">timeframe.in_seconds()</a>\nfunction to convert the chart and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.timeframe()</a>\nfunction into seconds, then divide by 60 to convert into minutes.</li>\n<li>We use two calls to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe%7Bdot%7Din_seconds\">timeframe.in_seconds()</a>\nfunction in the initialization of the <code dir=\"auto\">chartTFInMinutes</code> and\n<code dir=\"auto\">inputTFInMinutes</code> variables. In the first instance, we do not\nsupply an argument for its <code dir=\"auto\">timeframe</code> parameter, so the function\nreturns the chart\u2019s timeframe in seconds. In the second call, we\nsupply the timeframe selected by the script\u2019s user through the call\nto\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.timeframe()</a>.</li>\n<li>Next, we validate the timeframes to ensure that the input timeframe\nis equal to or higher than the chart\u2019s timeframe. If it is not, we\ngenerate a runtime error.</li>\n<li>We finally print the two timeframe values converted to minutes.</li>\n</ul>", "segment_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "a3286192cfef438b88b75998c02252c44d19a1f3da454973ba82b6b0a6a15ef1", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/error-messages\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"error-messages\"><a href=\"#error-messages\">Error messages<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"the-if-statement-is-too-long\"><a href=\"#the-if-statement-is-too-long\">The if statement is too long<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This error occurs when the indented code inside an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\nstatement</a>\nis too large for the compiler. Because of how the compiler works, you\nwon\u2019t receive a message telling you exactly how many lines of code you\nare over the limit. The only solution now is to break up your <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\nstatement</a>\ninto smaller parts (functions or smaller <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\nstatements</a>).\nThe example below shows a reasonably lengthy <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\nstatement</a>;\ntheoretically, this would throw <code dir=\"auto\">line 4: if statement is too long</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\nvar e = 0\nif barstate.islast\n    a = 1\n    b = 2\n    c = 3\n    d = 4\n    e := a + b + c + d\n\nplot(e)</div>\n<p>To fix this code, you could move these lines into their own function:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\nvar e = 0\ndoSomeWork() =&gt;\n    a = 1\n    b = 2\n    c = 3\n    d = 4\n\n    result = a + b + c + d\n\nif barstate.islast\n    e := doSomeWork()\n\nplot(e)</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-requesting-too-many-securities\"><a href=\"#script-requesting-too-many-securities\">Script requesting too many securities<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The maximum number of securities in script is limited to 40. If you\ndeclare a variable as a <code dir=\"auto\">request.security</code> function call and then use\nthat variable as input for other variables and calculations, it will not\nresult in multiple <code dir=\"auto\">request.security</code> calls. But if you will declare a\nfunction that calls <code dir=\"auto\">request.security</code> --- every call to this function\nwill count as a <code dir=\"auto\">request.security</code> call.</p>\n<p>It is not easy to say how many securities will be called looking at the\nsource code. Following example have exactly 3 calls to\n<code dir=\"auto\">request.security</code> after compilation:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Securities count\")\na = request.security(syminfo.tickerid, '42', close)  // (1) first unique security call\nb = request.security(syminfo.tickerid, '42', close)  // same call as above, will not produce new security call after optimizations\n\nplot(a)\nplot(a + 2)\nplot(b)\n\nsym(p) =&gt;  // no security call on this line\n    request.security(syminfo.tickerid, p, close)\nplot(sym('D'))  // (2) one indirect call to security\nplot(sym('W'))  // (3) another indirect call to security\n\nrequest.security(syminfo.tickerid, timeframe.period, open)  // result of this line is never used, and will be optimized out</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-could-not-be-translated-from-null\"><a href=\"#script-could-not-be-translated-from-null\">Script could not be translated from: null<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">study($)</div>\n<p>Usually this error occurs in version 1 Pine scripts, and means that code\nis incorrect. Pine Script\u00ae of version 2 (and higher) is better at\nexplaining errors of this kind. So you can try to switch to version 2 by\nadding a\n<a href=\"/pine-script-docs/v5/language/script-structure/#version\">special attribute</a> in the first line. You\u2019ll get\n<code dir=\"auto\">line 2: no viable alternative at character '$'</code>:</p>\n<div class=\"pine-colorizer not-content\">// @version=2\nstudy($)</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"line-2-no-viable-alternative-at-character-\"><a href=\"#line-2-no-viable-alternative-at-character-\">line 2: no viable alternative at character \u2019$\u2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This error message gives a hint on what is wrong. <code dir=\"auto\">$</code> stands in place of\nstring with script title. For example:</p>\n<div class=\"pine-colorizer not-content\">// @version=2\nstudy(\"title\")</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"mismatched-input--expecting-\"><a href=\"#mismatched-input--expecting-\">Mismatched input &lt;\u2026&gt; expecting &lt;???&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Same as <code dir=\"auto\">no viable alternative</code>, but it is known what should be at that\nplace. Example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\n    plot(1)</div>\n<p><code dir=\"auto\">line 3: mismatched input 'plot' expecting 'end of line without line continuation'</code></p>\n<p>To fix this you should start line with <code dir=\"auto\">plot</code> on a new line without an\nindent:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nplot(1)</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"loop-is-too-long--500-ms\"><a href=\"#loop-is-too-long--500-ms\">Loop is too long (&gt; 500 ms)<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We limit the computation time of loop on every historical bar and\nrealtime tick to protect our servers from infinite or very long loops.\nThis limit also fail-fast indicators that will take too long to compute.\nFor example, if you\u2019ll have 5000 bars, and indicator takes 500\nmilliseconds to compute on each of bars, it would have result in more\nthan 16 minutes of loading:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop is too long\", max_bars_back = 101)\ns = 0\nfor i = 1 to 1e3  // to make it longer\n    for j = 0 to 100\n        if timestamp(2017, 02, 23, 00, 00) &lt;= time[j] and time[j] &lt; timestamp(2017, 02, 23, 23, 59)\n            s := s + 1\nplot(s)</div>\n<p>It might be possible to optimize algorithm to overcome this error. In\nthis case, algorithm may be optimized like this:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop is too long\", max_bars_back = 101)\nbar_back_at(t) =&gt;\n    i = 0\n    step = 51\n    for j = 1 to 100\n        if i &lt; 0\n            i := 0\n            break\n        if step == 0\n            break\n        if time[i] &gt;= t\n            i := i + step\n            i\n        else\n            i := i - step\n            i\n        step := step / 2\n        step\n    i\n\ns = 0\nfor i = 1 to 1e3  // to make it longer\n    s := s - bar_back_at(timestamp(2017, 02, 23, 23, 59)) +\n         bar_back_at(timestamp(2017, 02, 23, 00, 00))\n    s\nplot(s)</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-has-too-many-local-variables\"><a href=\"#script-has-too-many-local-variables\">Script has too many local variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This error appears if the script is too large to be compiled. A\nstatement <code dir=\"auto\">var=expression</code> creates a local variable for <code dir=\"auto\">var</code>. Apart\nfrom this, it is important to note, that auxiliary variables can be\nimplicitly created during the process of a script compilation. The limit\napplies to variables created both explicitly and implicitly. The\nlimitation of 1000 variables is applied to each function individually.\nIn fact, the code placed in a <em>global</em> scope of a script also implicitly\nwrapped up into the main function and the limit of 1000 variables\nbecomes applicable to it. There are few refactorings you can try to\navoid this issue:</p>\n<div class=\"pine-colorizer not-content\">var1 = expr1\nvar2 = expr2\nvar3 = var1 + var2</div>\n<p>can be converted into:</p>\n<div class=\"pine-colorizer not-content\">var3 = expr1 + expr2</div>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"pine-script-cannot-determine-the-referencing-length-of-a-series-try-using-max_bars_back-in-the-indicator-or-strategy-function\"><a href=\"#pine-script-cannot-determine-the-referencing-length-of-a-series-try-using-max_bars_back-in-the-indicator-or-strategy-function\">Pine Script cannot determine the referencing length of a series. Try using max_bars_back in the indicator or strategy function<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The error appears in cases where Pine Script wrongly autodetects the\nrequired maximum length of series used in a script. This happens when a\nscript\u2019s flow of execution does not allow Pine Script to inspect the\nuse of series in branches of conditional statements (<code dir=\"auto\">if</code>, <code dir=\"auto\">iff</code> or\n<code dir=\"auto\">?</code>), and Pine Script cannot automatically detect how far back the\nseries is referenced. Here is an example of a script causing this\nproblem:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requires max_bars_back\")\ntest = 0.0\nif bar_index &gt; 1000\n    test := ta.roc(close, 20)\nplot(test)</div>\n<p>In order to help Pine Script with detection, you should add the\n<code dir=\"auto\">max_bars_back</code> parameter to the script\u2019s <code dir=\"auto\">indicator</code> or <code dir=\"auto\">strategy</code>\nfunction:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Requires max_bars_back\", max_bars_back = 20)\ntest = 0.0\nif bar_index &gt; 1000\n    test := ta.roc(close, 20)\nplot(test)</div>\n<p>You may also resolve the issue by taking the problematic expression out\nof the conditional branch, in which case the <code dir=\"auto\">max_bars_back</code> parameter\nis not required:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\ntest = 0.0\nroc20 = ta.roc(close, 20)\nif bar_index &gt; 1000\n    test := roc20\nplot(test)</div>\n<p>In cases where the problem is caused by a <strong>variable</strong> rather than a\nbuilt-in <strong>function</strong> (<code dir=\"auto\">vwma</code> in our example), you may use the\n<code dir=\"auto\">max_bars_back</code> function to explicitly define the referencing length for\nthat variable only. This has the advantage of requiring less runtime\nresources, but entails that you identify the problematic variable, e.g.,\nvariable <code dir=\"auto\">s</code> in the following example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nf(off) =&gt;\n    t = 0.0\n    s = close\n    if bar_index &gt; 242\n        t := s[off]\n    t\nplot(f(301))</div>\n<p>This situation can be resolved using the <code dir=\"auto\">max_bars_back</code> <strong>function</strong> to\ndefine the referencing length of variable <code dir=\"auto\">s</code> only, rather than for all\nthe script\u2019s variables:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nf(off) =&gt;\n    t = 0.0\n    s = close\n    max_bars_back(s, 301)\n    if bar_index &gt; 242\n        t := s[off]\n    t\nplot(f(301))</div>\n<p>When using drawings that refer to previous bars through <code dir=\"auto\">bar_index[n]</code>\nand <code dir=\"auto\">xloc = xloc.bar_index</code>, the time series received from this bar will\nbe used to position the drawings on the time axis. Therefore, if it is\nimpossible to determine the correct size of the buffer, this error may\noccur. To avoid this, you need to use <code dir=\"auto\">max_bars_back(time, n)</code>. This\nbehavior is described in more detail in the section about\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#historical-buffer-and-max_bars_back\">drawings</a>.</p>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/error-messages", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"memory-limits-exceeded-the-study-allocates-x-times-more-than-allowed\"><a href=\"#memory-limits-exceeded-the-study-allocates-x-times-more-than-allowed\">Memory limits exceeded. The study allocates X times more than allowed<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The most common cause for this error is returning <a href=\"/pine-script-docs/v5/language/objects/#objects\">objects</a> and <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> from <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">request.*()</a> functions. Other possible causes include unnecessary drawing updates, excess historical buffer capacity, or inefficient use of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back</a>.</p>\n<h3 class=\"md-heading\" id=\"returning-collections-from-request-functions\"><a href=\"#returning-collections-from-request-functions\"><span><strong>Returning collections from <code dir=\"auto\">request.*()</code> functions</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A common source of the \u201c<em>Memory limits exceeded</em>\u201d error is returning <a href=\"/pine-script-docs/v5/language/objects/#objects\">objects</a> or <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> from another chart symbol or timeframe using <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">request.*()</a> functions.</p>\n<p>When requesting data from other contexts, the data for <em>each bar</em> is copied and stored in memory to allow the script to reference it later in the main context. This can use a lot of memory, depending on the data. Requesting large collections can easily lead to excessive memory consumption.</p>\n<p>Let\u2019s look at an example script where we <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request</a> data to calculate the <a href=\"https://www.tradingview.com/support/solutions/43000589100-balance-of-power-bop/\">balance of power (BOP)</a> for the symbol at a higher timeframe. Here, the <em>request expression</em> is a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">custom function</a> that populates a <a href=\"/pine-script-docs/v5/language/arrays/#using-var-and-varip-keywords\">persistent array</a> with our calculated BOP values, returning the <em>full array</em> to the main context on <em>each</em> bar. We intend to use these stored array values to calculate and plot the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">average</a> BOP in the main context. However, returning every array instance consumes a lot of memory, and so this script can throw a memory error on charts with a sufficiently long history:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"BOP array in higher timeframe context\", \"Memory limit demo\")\n\n//@variable User-input length for calculating average of BOP values. \nint avgLength = input.int(5, \"Average BOP Length\", minval = 1)\n\n//Returns a copy of the `dataArray` on every bar, which uses a lot of memory.\ndataFunction() =&gt; \n    //@variable Persistent array containing the \"balance of power\" (BOP) values for all bars from the higher timeframe.\n    var array&lt;float&gt; dataArray = array.new_float(0)\n\n    //@variable The \"balance of power\" percentage calculated for the current bar.\n    float bop = (close - open) / (high - low) * 100\n    dataArray.push(bop)\n\n    //Return the full collection.\n    dataArray\n\n// Request the full BOP array from the 1D timeframe.\narray&lt;float&gt; reqData = request.security(syminfo.tickerid, \"1D\", dataFunction())\n\n// Plot zero line.\nhline(0, \"Zero line\", color.gray, hline.style_dotted)\n\n// Latest BOP value and average BOP are calculated in the main context if `reqData` is not `na`.\n//@variable The latest BOP value from the `reqData` array.\nfloat latestValue = na\n//@variable The average of the last `avgLength` BOP values.\nfloat avgBOP = na\n\nif not na(reqData)\n    // Retrieve BOP value for the current main context bar.\n    latestValue := reqData.last()\n\n    // Calculate the average BOP for the most-recent values from the higher timeframe array.\n    //@variable Size of the `reqData` array returned from the higher timeframe.\n    int dataSize = reqData.size()\n    //@variable A subset of the latest values from the `reqData` array. Its size is determined by the `avgLength` set.\n    array&lt;float&gt; lastValues = dataSize &gt;= avgLength ? reqData.slice(dataSize - avgLength, dataSize): reqData\n    avgBOP := lastValues.avg()\n\n// Plot the BOP value and average line.\ncolor plotColor = latestValue &gt;= 0 ? color.aqua : color.orange\nplot(latestValue, \"BOP\", plotColor, style = plot.style_columns)\nplot(avgBOP, \"Avg\", color.purple, linewidth = 3)</div>\n<h3 class=\"md-heading\" id=\"how-do-i-fix-this\"><a href=\"#how-do-i-fix-this\"><span><strong>How do I fix this?</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Optimize requests and limit the data returned to the main context to ensure that only the <em>minimum necessary</em> data is stored in memory.</p>\n<p>If possible, try to return <em>calculated results</em> directly rather than returning the collections themselves, or only return collections <em>conditionally</em>, when they are necessary in the main context.</p>\n<p>Let\u2019s consider a few common scenarios where scripts need specific data in the main context.</p>\n<h4 class=\"md-heading\" id=\"return-last-state-only\"><a href=\"#return-last-state-only\"><span><strong>Return last state only</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>If a script needs only the <em>last state</em> of a requested collection in the main context: use an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">barstate.islast</a> condition to return a copy of the <em>last bar\u2019s collection</em> only.</p>\n<p>Here, we modified our script to display only the <em>latest</em> average BOP (a single value), rather than plotting an average line. The updated request function now returns the calculated BOP values directly for each bar, and returns the higher timeframe\u2019s array only on the last bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1196\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Errors-Return-last-state-only.B7DlHDxT_1Srw3K.webp\" width=\"1702\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"BOP array on last bar\", \"Memory limit demo\")\n\n//@variable User-input length for calculating average of BOP values. \nint avgLength = input.int(5, \"Average BOP Length\", minval = 1)\n\n// Returns the calculated `bop` each bar, and a copy of the `dataArray` on the last bar or `na` otherwise.\ndataFunction() =&gt; \n    //@variable Persistent array containing the \"balance of power\" (BOP) values for all higher timeframe bars.\n    var array&lt;float&gt; dataArray = array.new_float(0)\n\n    //@variable The \"balance of power\" percentage calculated for the current higher timeframe bar.\n    float bop = (close - open) / (high - low) * 100\n    dataArray.push(bop)\n\n    // Return the collection on the last bar only.\n    if barstate.islast\n        [bop, dataArray]\n    else \n        [bop, na]\n\n// Request calculated BOP value, and BOPs array if on last bar, from the higher timeframe.\n[reqValue, reqData] = request.security(syminfo.tickerid, \"1D\", dataFunction())\n\n// Plot zero line.\nhline(0, \"Zero line\", color.gray, hline.style_dotted)\n\n// Plot the BOP value for each main context bar.\ncolor plotColor = reqValue &gt;= 0 ? color.aqua : color.orange\nplot(reqValue, \"BOP\", plotColor, style = plot.style_columns)\n\n// Calculate the average BOP for most-recent values from the higher timeframe array, and display result in a table cell.\nif not na(reqData)\n    //@variable Size of the `reqData` array returned from the higher timeframe.\n    int dataSize = reqData.size()\n    //@variable A subset of the latest values from the `reqData` array. Its size is determined by the `avgLength` set.\n    array&lt;float&gt; lastValues = dataSize &gt;= avgLength ? reqData.slice(dataSize - avgLength, dataSize): reqData\n    //@variable The average of the last `avgLength` BOP values.\n    float avgBOP = lastValues.avg()\n\n    // Display latest average value in a single-cell table.\n    var table displayTable = table.new(position.bottom_right, 1, 1, color.purple)\n    displayTable.cell(0, 0, \"Avg of last \" + str.tostring(avgLength) + \" BOPs: \" + str.tostring(avgBOP, \"##.##\") + \"%\", \n         text_color = color.white)</div>\n<h4 class=\"md-heading\" id=\"return-calculated-results\"><a href=\"#return-calculated-results\"><span><strong>Return calculated results</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>If a script needs the <em>result</em> of a calculation on a collection, but does not need the collection itself in the main context, use a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> as the request expression. The function can calculate on the collection in the <em>requested</em> context and return only the result to the main context.</p>\n<p>For example, we can calculate the average BOP directly within our request function. Therefore, only the calculated values are stored in memory, and the request expression returns a tuple (current BOP and average BOP) to plot the results in the main context:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1192\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Errors-Return-calculated-results.Do61vtAy_Z1MO38Y.webp\" width=\"1694\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Return BOP results only\", \"Memory limit demo\")\n\n//@variable User-input length for calculating average of BOP values. \nint avgLength = input.int(5, \"Average BOP Length\", minval = 1)\n\n// Returns the calculated `bop` and `avgBOP` values directly.\ndataFunction() =&gt; \n    //@variable Persistent array containing the \"balance of power\" (BOP) values for all higher timeframe bars.\n    var array&lt;float&gt; dataArray = array.new_float(0)\n\n    //@variable The \"balance of power\" percentage calculated for the current higher timeframe bar.\n    float bop = (close - open) / (high - low) * 100\n    dataArray.push(bop)\n\n    // Calculate the average BOP for the `avgLength` most-recent values.\n    //@variable Size of the `dataArray`.\n    int dataSize = dataArray.size()\n    //@variable A subset of the latest values from the `dataArray`. Its size is determined by the `avgLength` set.\n    array&lt;float&gt; lastValues = dataSize &gt;= avgLength ? dataArray.slice(dataSize - avgLength, dataSize): dataArray\n    //@variable The average of the last `avgLength` BOP values.\n    float avgBOP = lastValues.avg()\n\n    //Return the calculated results.\n    [bop, avgBOP]\n\n// Request BOP and average BOP values from the higher timeframe.\n[reqValue, reqAverage] = request.security(syminfo.tickerid, \"1D\", dataFunction())\n\n// Plot zero line.\nhline(0, \"Zero line\", color.gray, hline.style_dotted)\n\n// Plot the BOP value and average line.\ncolor plotColor = reqValue &gt;= 0 ? color.aqua : color.orange\nplot(reqValue, \"BOP\", plotColor, style = plot.style_columns)\nplot(reqAverage, \"Avg\", color.purple, linewidth = 3)</div>\n<h4 class=\"md-heading\" id=\"return-the-collection-on-some-bars\"><a href=\"#return-the-collection-on-some-bars\"><span><strong>Return the collection on some bars</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>If a script needs the <em>collection itself</em> in the main context, but <em>not for</em> <em>every bar</em>, use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">conditional expressions</a> to return only the necessary collections to the main context, returning <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> otherwise. The logic in the main context can then address the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> gaps in the series and perform its desired actions on the reduced collections.</p>\n<p>For example, if we want to calculate the average BOP across each <em>month</em> instead of using a user-input length, we can return the array from the requested context only when there is a change to a new month, returning <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> otherwise. We then maintain the previous month\u2019s values in the main context to keep a valid array for all intra-month bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1192\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Errors-Return-the-collection-on-some-bars.CQvTHovc_iqEih.webp\" width=\"1694\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Monthly BOP array\", \"Memory limit demo\")\n\n// Returns the calculated `bop`, and a copy of the `dataArray` on a month's first trading day only, or `na` otherwise.\ndataFunction() =&gt; \n    //@variable Persistent array containing the \"balance of power\" (BOP) values for all higher timeframe bars.\n    var array&lt;float&gt; dataArray = array.new_float(0)\n\n    // When a new month starts, return monthly data array to calculate average BOP for completed month.\n    //@variable Array is `na` except on first trading day of each month, when it contains completed month's BOP values. \n    array&lt;float&gt; returnArray = na\n    //@variable Is `true` on the first bar of each month, `false` otherwise.\n    bool isNewMonth = timeframe.change(\"1M\")\n    if isNewMonth\n        returnArray := dataArray\n    //Clear persistent array to start storing new month's data.\n    if isNewMonth[1]\n        dataArray.clear()\n\n    //@variable The \"balance of power\" percentage calculated for the current higher timeframe bar.\n    float bop = (close - open) / (high - low) * 100\n    dataArray.push(bop)\n\n    //Return the calculated result and the `returnArray`.\n    [bop, returnArray]\n\n// Request BOP data from the higher timeframe. (Returns calculated BOP and array of BOP values if new month starts)\n[reqValue, reqData] = request.security(syminfo.tickerid, \"1D\", dataFunction())\n\n// Calculate the average BOP for the most-recent completed month.\n//@variable Persistent array that holds the BOP values for the most-recent completed month.\nvar array&lt;float&gt; completedMonthBOPs = array.new_float(0)\n// If new month starts (i.e., `reqData` is not returned as `na`), then `completedMonthBOPs` is updated with new values.\n// Otherwise, it persists the last valid values for the rest of the month to adjust for `na` gaps.\ncompletedMonthBOPs := na(reqData) ? completedMonthBOPs : reqData\n//@variable The average BOP for the most-recent completed month.\nfloat avgBOP = completedMonthBOPs.avg()\n\n// Plot the BOP value and average line.\ncolor plotColor = reqValue &gt;= 0 ? color.aqua : color.orange\nplot(reqValue, \"BOP\", plotColor, style = plot.style_columns)\nplot(avgBOP, \"Avg\", color.purple, linewidth = 3)</div>\n<h3 class=\"md-heading\" id=\"other-possible-error-sources-and-their-fixes\"><a href=\"#other-possible-error-sources-and-their-fixes\"><span><strong>Other possible error sources and their fixes</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>There are a few other ways to optimize scripts to consume less memory.</p>\n<h4 class=\"md-heading\" id=\"minimize-request-calls\"><a href=\"#minimize-request-calls\"><span><strong>Minimize <code dir=\"auto\">request.*()</code> calls</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">request.*()</a> function calls can be computationally expensive, because they retrieve data from other contexts, which can often require significant resource usage. Excessive or inefficient requests can easily cause scripts to reach the memory limit.</p>\n<p>This memory consumption is especially substantial for scripts requesting data from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\"><em>lower timeframes</em></a>, where the request function returns an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of multiple lower timeframe bars for <em>each</em> main context bar. For example, requesting \u201c1\u201d data on a \u201c1D\u201d chart returns hundreds of \u201c1\u201d bars for each \u201c1D\u201d bar that executes the request. In the process, the script must allocate memory to store all the requested data arrays so that it can access them later in the main context, which quickly increases the memory consumption.</p>\n<p>Programmers can reduce the number of requested expressions by:</p>\n<ul>\n<li>Removing unnecessary <code dir=\"auto\">request.*()</code> function calls.</li>\n<li>Changing the requested timeframe to a higher resolution.</li>\n<li>Condensing multiple requests to the <em>same</em> context into a single <code dir=\"auto\">request.*()</code> call.</li>\n<li>Adjusting the <code dir=\"auto\">request.*()</code> function\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">calc_bars_count</a> parameter to restrict the historical data points in the requested context.</li>\n</ul>\n<p>See <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#minimizing-request-calls\">this section</a> in the User Manual for more information on optimizing <code dir=\"auto\">request.*()</code> calls.</p>\n<h4 class=\"md-heading\" id=\"refrain-from-using-max_bars_back-unless-necessary\"><a href=\"#refrain-from-using-max_bars_back-unless-necessary\"><span><strong>Refrain from using <code dir=\"auto\">max_bars_back</code> unless necessary</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <code dir=\"auto\">max_bars_back</code> parameter of an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy</a> sets the size of the <em>history buffer</em> for all series variables in a script. The history buffer determines the number of historical references <em>stored in memory</em> for the script\u2019s built-in and user-defined variables.</p>\n<p>By default, the Pine Script runtime automatically allocates an appropriate buffer for each variable. Therefore, the <code dir=\"auto\">max_bars_back</code> parameter and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">function</a> are only necessary when Pine <a href=\"https://www.tradingview.com/support/solutions/43000587849-i-see-pine-cannot-determine-the-referencing-length-of-a-series-try-using-max-bars-back-error/\">cannot determine the referencing length of a series</a>.</p>\n<p>If you encounter this referencing length error, ensure that you set the <code dir=\"auto\">max_bars_back</code> value appropriately to your script\u2019s needs. Setting a value that\u2019s too large can lead to excessive memory consumption, as it stores unnecessary historical data that the script ultimately doesn\u2019t use. Read up on how to optimize using <code dir=\"auto\">max_bars_back</code> <a href=\"https://www.tradingview.com/chart/?solution=43000587849\">in our Help Center</a>.</p>\n<h4 class=\"md-heading\" id=\"minimize-historical-buffer-calculations\"><a href=\"#minimize-historical-buffer-calculations\"><span><strong>Minimize historical buffer calculations</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The Pine Script runtime automatically creates historical buffers for all variables and function calls in a script. It determines the size of a buffer based on the <em>historical references</em> needed in the code (the references made using the <a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">[]</a> history-referencing operator).</p>\n<p>As the script runs across the dataset, referencing distant points in bar history can cause the script to restart its execution on previous bars to adjust its historical buffer size (see this <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#minimizing-historical-buffer-calculations\">User Manual article</a> to learn more). Larger buffers in turn lead to an increase in memory consumption and can result in a runtime error. Ensure that scripts are referencing <em>necessary</em> historical values only, and avoid referencing very distant points in history when possible.</p>\n<p>You can use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> function\u2019s <code dir=\"auto\">calc_bars_count</code> parameter or the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a> function to <em>manually restrict</em> the historical data capacity on a script-wide or variable-specific scale. However, be aware that these methods can also cause memory consumption issues of their own if used improperly.</p>\n<h4 class=\"md-heading\" id=\"reduce-drawing-updates-for-tables\"><a href=\"#reduce-drawing-updates-for-tables\"><span><strong>Reduce drawing updates for tables</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a> only display their <em>last state</em> on a chart. Any updates to a table on historical bars are redundant, because they are not visible. To use the least memory, draw the table <em>once</em>, and fill it on the last bar.</p>\n<p>Use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> keyword to declare table objects once. Enclose all other setter function calls in a conditional <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">barstate.islast</a> block for better performance. For more about tables, see this <a href=\"/pine-script-docs/v5/concepts/tables/\">User Manual article</a>.</p>\n<h4 class=\"md-heading\" id=\"do-not-update-drawings-on-historical-bars\"><a href=\"#do-not-update-drawings-on-historical-bars\"><span><strong>Do not update drawings on historical bars</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Similar to tables, any updates to drawing objects such as <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> and <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> that are made on historical bars are never seen by the user. The user only sees updates on <em>realtime</em> bars.</p>\n<p>Eliminate updates to historical drawings during historical bars wherever possible. For more information, see <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#reducing-drawing-updates\">this User Manual section</a>.</p>\n<h4 class=\"md-heading\" id=\"minimize-total-drawings-stored-for-a-chart\"><a href=\"#minimize-total-drawings-stored-for-a-chart\"><span><strong>Minimize total drawings stored for a chart</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">Drawing objects</a> such as <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> and <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> can consume a lot of memory, especially if a script <em>recreates</em> drawings unnecessarily.</p>\n<p>For example, if a script draws a line from point <code dir=\"auto\">x1</code> to <code dir=\"auto\">x2</code>, then needs to update the line\u2019s endpoint (<code dir=\"auto\">x2</code>), it\u2019s more computationally expensive to delete the existing line and redraw a new line from <code dir=\"auto\">x1</code> to <code dir=\"auto\">x3</code>. Instead, using the <em>setter</em> function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.set_x2\">line.set_x2()</a> to update the existing line\u2019s endpoint is more efficient.</p>\n<p>Look for ways to optimize drawing objects in a script:</p>\n<ul>\n<li>\n<p>Reduce the number of redrawn objects by initializing drawing object <em>identifiers</em> and using their setter functions to modify properties.</p>\n</li>\n<li>\n<p>Remove unnecessary chart drawings using the <code dir=\"auto\">delete()</code> functions (e.g., <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.delete\">label.delete()</a>).</p>\n</li>\n<li>\n<p>Reduce an indicator\u2019s maximum drawings limit using the <code dir=\"auto\">max_lines_count</code> or <code dir=\"auto\">max_labels_count</code> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">parameters</a>.</p>\n</li>\n</ul>\n<h4 class=\"md-heading\" id=\"filter-dates-in-strategies\"><a href=\"#filter-dates-in-strategies\"><span><strong>Filter dates in strategies</strong></span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The total number of trades or orders in a <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategy</a> can impact the memory consumption of a script. For large datasets, reduce the number of unnecessary historical orders stored in memory by limiting the <em>starting point</em> of your strategy.</p>\n<p>You can filter the strategy\u2019s date by adding a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">conditional expression</a> that compares the bar time to a specified timestamp to only place entry/exit orders beyond a certain date.</p>\n<p>See an example of date filtering in strategies <a href=\"https://www.pinecoders.com/faq_and_code/#how-do-i-implement-date-range-filtering-in-strategies\" rel=\"nofollow\">here</a>.</p>", "segment_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "8bef48503040b21b0ef82bf50542baea3c6e179acca457a4905ab021ccbe63ba", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"faq\"><a href=\"#faq\">FAQ<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-real-ohlc-price-on-a-heikin-ashi-chart\"><a href=\"#get-real-ohlc-price-on-a-heikin-ashi-chart\">Get real OHLC price on a Heikin Ashi chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Suppose, we have a Heikin Ashi chart (or Renko, Kagi, PriceBreak etc)\nand we\u2019ve added a Pine script on it:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Visible OHLC\", overlay=true)\nc = close\nplot(c)</div>\n<p>You may see that variable <code dir=\"auto\">c</code> is a Heikin Ashi <em>close</em> price which is\nnot the same as real OHLC price. Because <code dir=\"auto\">close</code> built-in variable is\nalways a value that corresponds to a visible bar (or candle) on the\nchart.</p>\n<p>So, how do we get the real OHLC prices in Pine Script\u00ae code, if current\nchart type is non-standard? We should use <code dir=\"auto\">request.security</code> function in\ncombination with <code dir=\"auto\">ticker.new</code> function. Here is an example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Real OHLC\", overlay = true)\nt = ticker.new(syminfo.prefix, syminfo.ticker)\nrealC = request.security(t, timeframe.period, close)\nplot(realC)</div>\n<p>In a similar way we may get other OHLC prices: <em>open</em>, <em>high</em> and <em>low</em>.</p>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-non-standard-ohlc-values-on-a-standard-chart\"><a href=\"#get-non-standard-ohlc-values-on-a-standard-chart\">Get non-standard OHLC values on a standard chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Backtesting on non-standard chart types (e.g. Heikin Ashi or Renko) is\nnot recommended because the bars on these kinds of charts do not\nrepresent real price movement that you would encounter while trading. If\nyou want your strategy to enter and exit on real prices but still use\nHeikin Ashi-based signals, you can use the same method to get Heikin\nAshi values on a regular candlestick chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"BarUpDn Strategy\", overlay = true, default_qty_type = strategy.percent_of_equity, default_qty_value = 10)\nmaxIdLossPcntInput = input.float(1, \"Max Intraday Loss(%)\")\nstrategy.risk.max_intraday_loss(maxIdLossPcntInput, strategy.percent_of_equity)\nneedTrade() =&gt; close &gt; open and open &gt; close[1] ? 1 : close &lt; open and open &lt; close[1] ? -1 : 0\ntrade = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, needTrade())\nif trade == 1\n    strategy.entry(\"BarUp\", strategy.long)\nif trade == -1\n    strategy.entry(\"BarDn\", strategy.short)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-arrows-on-the-chart\"><a href=\"#plot-arrows-on-the-chart\">Plot arrows on the chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You may use plotshape with style <code dir=\"auto\">shape.arrowup</code> and <code dir=\"auto\">shape.arrowdown</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator('Ex 1', overlay = true)\ncondition = close &gt;= open\nplotshape(condition, color = color.lime, style = shape.arrowup, text = \"Buy\")\nplotshape(not condition, color = color.red, style = shape.arrowdown, text = \"Sell\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Buy_sell_chart1.CyNH3Z6U_2g4dui.webp\" width=\"1600\"/></p>\n<p>You may use the <code dir=\"auto\">plotchar</code> function with any unicode character:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator('buy/sell arrows', overlay = true)\ncondition = close &gt;= open\nplotchar(not condition, char='\u2193', color = color.lime, text = \"Buy\")\nplotchar(condition, char='\u2191', location = location.belowbar, color = color.red, text = \"Sell\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Buy_sell_chart2.bwHf9rIu_dfdYz.webp\" width=\"1600\"/></p>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-a-dynamic-horizontal-line\"><a href=\"#plot-a-dynamic-horizontal-line\">Plot a dynamic horizontal line<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There is the function <code dir=\"auto\">hline</code> in Pine Script, but it is limited to only\nplot a constant value. Here is a simple script with a workaround to plot\na changing hline:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Horizontal line\", overlay = true)\nplot(close[10], trackprice = true, offset = -9999)\n// `trackprice = true` plots horizontal line on close[10]\n// `offset = -9999` hides the plot\nplot(close, color = #FFFFFFFF)  // forces display</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-a-vertical-line-on-condition\"><a href=\"#plot-a-vertical-line-on-condition\">Plot a vertical line on condition<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Vertical line\", overlay = true, scale = scale.none)\n// scale.none means do not resize the chart to fit this plot\n// if the bar being evaluated is the last baron the chart (the most recent bar), then cond is true\ncond = barstate.islast\n// when cond is true, plot a histogram with a line with height value of 100,000,000,000,000,000,000.00\n// (10 to the power of 20)\n// when cond is false, plot no numeric value (nothing is plotted)\n// use the style of histogram, a vertical bar\nplot(cond ? 10e20 : na, style = plot.style_histogram)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"access-the-previous-value\"><a href=\"#access-the-previous-value\">Access the previous value<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\n//...\ns = 0.0\ns := nz(s[1]) // Accessing previous values\nif (condition)\n    s := s + 1</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-a-5-days-high\"><a href=\"#get-a-5-days-high\">Get a 5-days high<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Lookback 5 days from the current bar, find the highest bar, plot a star\ncharacter at that price level above the current bar</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Wiki_howto_range_analysis.BO6M_QVQ_ZvUgTy.webp\" width=\"1600\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"High of last 5 days\", overlay = true)\n\n// Milliseconds in 5 days: millisecs * secs * mins * hours * days\nMS_IN_5DAYS = 1000 * 60 * 60 * 24 * 5\n\n// The range check begins 5 days from the current time.\nleftBorder = timenow - time &lt; MS_IN_5DAYS\n// The range ends on the last bar of the chart.\nrightBorder = barstate.islast\n\n// \u2014\u2014\u2014\u2014\u2014 Keep track of highest `high` during the range.\n// Intialize `maxHi` with `var` on bar zero only.\n// This way, its value is preserved, bar to bar.\nvar float maxHi = na\nif leftBorder\n    if not leftBorder[1]\n        // Range's first bar.\n        maxHi := high\n    else if not rightBorder\n        // On other bars in the range, track highest `high`.\n        maxHi := math.max(maxHi, high)\n\n// Plot level of the highest `high` on the last bar.\nplotchar(rightBorder ? maxHi : na, \"Level\", \"\u2014\", location.absolute, size = size.normal)\n// When in range, color the background.\nbgcolor(leftBorder and not rightBorder ? color.new(color.aqua, 70) : na)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"count-bars-in-a-dataset\"><a href=\"#count-bars-in-a-dataset\">Count bars in a dataset<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Get a count of all the bars in the loaded dataset. Might be useful for\ncalculating flexible lookback periods based on number of bars.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Bar Count\", overlay = true, scale = scale.none)\nplot(bar_index + 1, style = plot.style_histogram)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"enumerate-bars-in-a-day\"><a href=\"#enumerate-bars-in-a-day\">Enumerate bars in a day<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\", overlay = true, scale = scale.none)\n\nisNewDay() =&gt;\n    d = dayofweek\n    na(d[1]) or d != d[1]\n\nplot(ta.barssince(isNewDay()), style = plot.style_cross)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"find-the-highest-and-lowest-values-for-the-entire-dataset\"><a href=\"#find-the-highest-and-lowest-values-for-the-entire-dataset\">Find the highest and lowest values for the entire dataset<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n\nallTimetHi(source) =&gt;\n    var atHi = source\n    atHi := math.max(atHi, source)\n\nallTimetLo(source) =&gt;\n    var atLo = source\n    atLo := math.min(atLo, source)\n\nplot(allTimetHi(close), \"ATH\", color.green)\nplot(allTimetLo(close), \"ATL\", color.red)</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"query-the-last-non-na-value\"><a href=\"#query-the-last-non-na-value\">Query the last non-na value<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You can use the script below to avoid gaps in a series:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nseries = close &gt;= open ? close : na\nvw = fixnan(series)\nplot(series, style = plot.style_linebr, color = color.red)  // series has na values\nplot(vw)  // all na values are replaced with the last non-empty value</div>", "segment_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "e38d72410983e90bd615f908c476ffd361435260f05d3f042cfd2f59c75e2919", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/alerts\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"alerts\"><a href=\"#alerts\">Alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-do-i-make-an-alert-available-from-my-script\"><a href=\"#how-do-i-make-an-alert-available-from-my-script\">How do I make an alert available from my script?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In indicator scripts, there are two ways to define triggers for\u00a0<a href=\"/pine-script-docs/v5/concepts/alerts/\">alerts</a>:</p>\n<ul>\n<li>Using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function</li>\n<li>Using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function</li>\n</ul>\n<p>In strategy scripts, there are also two ways to define alert triggers:</p>\n<ul>\n<li>Using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function</li>\n<li>Using <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">order fill events</a></li>\n</ul>\n<p>These methods make alert triggers available but do not <em>create</em> alerts directly. Users must create alerts using a script\u2019s alert triggers by selecting the appropriate trigger in the \u201cCondition\u201d dropdown of the \u201cCreate Alert\u201d dialog box.</p>\n<p>Programmers can define multiple alert triggers of one or more types in a script.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-are-the-types-of-alerts-different\"><a href=\"#how-are-the-types-of-alerts-different\">How are the types of alerts different?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"usability\"><a href=\"#usability\">Usability<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Any script can include calls to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> functions within their code. However, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> calls have no effect unless the script is an <em>indicator</em>. <a href=\"/pine-script-docs/v5/concepts/libraries\">Libraries</a> can <em>export</em> functions containing <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> calls, but they cannot issue alert triggers directly.</p>\n<p><a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">Order fill</a> alert triggers are available only from <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategies</a>.</p>\n<h3 class=\"md-heading\" id=\"options-for-creating-alerts\"><a href=\"#options-for-creating-alerts\">Options for creating alerts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Each\u00a0<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>\u00a0call in an indicator script defines one distinct trigger and one corresponding option in the \u201cCondition\u201d dropdown menu of the \u201cCreate Alert\u201d dialog box. If the user wants multiple alerts, they must create each one <em>separately</em>.</p>\n<p>By contrast, if a script includes one or more\u00a0<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\u00a0function calls, only <em>one</em> option appears in the \u201cCondition\u201d dropdown menu, titled \u201cAny alert() function call\u201d. Selecting this option creates a <em>single alert</em> that activates based on the occurrences of <em>any</em> executed <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> call.</p>\n<p>Similarly, for strategy scripts, the \u201cOrder fills and and alert() function calls\u201d or \u201cOrder fills only\u201d option in the \u201cCondition\u201d dropdown menu creates an alert that fires when <em>any</em> <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">order fill event</a> occurs.</p>\n<h3 class=\"md-heading\" id=\"how-alerts-activate\"><a href=\"#how-alerts-activate\">How alerts activate<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function operates exclusively in an indicator\u2019s <a href=\"/pine-script-docs/v5/faq/programming/#what-does-scope-mean\">global scope</a>. Scripts cannot include calls to this function within any <em>local block</em>, such as the <em>indented</em> code within an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> structure. The function triggers an alert when its specified <code dir=\"auto\">condition</code> is <code dir=\"auto\">true</code>. Users can set the allowed <em>frequency</em> of the alert trigger using the \u201cFrequency\u201d field in the \u201cCreate Alert\u201d dialog box.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function has no <code dir=\"auto\">condition</code> parameter. Scripts trigger the alerts on any <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> call based on each call\u2019s <code dir=\"auto\">freq</code> argument. Therefore, programmers typically include such calls within the local scopes of <a href=\"/pine-script-docs/v5/language/conditional-structures\">conditional structures</a> to control when they execute.</p>\n<p>Order fill alert triggers are available from <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategies</a> <em>automatically</em> without requiring extra code. However, programmers can customize the default alert messages. These alerts fire on <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">order fill events</a>, which occur when the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">broker emulator</a> fills a strategy\u2019s <em>orders</em>.</p>\n<h3 class=\"md-heading\" id=\"messages\"><a href=\"#messages\">Messages<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">message</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function populates the \u201cMessage\u201d field of the \u201cCreate Alert\u201d dialog box with a default message, which script users can customize to suit their alert needs. It accepts a \u201cconst string\u201d argument, meaning its value cannot change after compilation. However, the argument can include <a href=\"https://www.tradingview.com/support/solutions/43000531021-how-to-use-a-variable-value-in-alert/\">placeholders</a> to make the message\u2019s information <em>dynamic</em>.</p>\n<p>The <code dir=\"auto\">message</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function accepts a \u201cseries string\u201d argument, allowing programmers to create <em>dynamic messages</em> that can include \u201cstring\u201d representations of a script\u2019s calculated values. Unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>, this function does not populate a \u201cMessage\u201d field in the \u201cCreate Alert\u201d dialog box, and it does not process placeholders. Programmers can allow users to customize <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> messages by creating <a href=\"/pine-script-docs/v5/concepts/inputs\">inputs</a> in the script\u2019s settings.</p>\n<p>Order fill alerts have a default message that describes a strategy\u2019s order fill event. This default message contains strategy-specific <a href=\"https://www.tradingview.com/support/solutions/43000531021-how-to-use-a-variable-value-in-alert/\">placeholders</a>, which the alert replaces with current strategy information each time it fires. Programmers can override the default message using the <code dir=\"auto\">//@strategy_alert_message</code> <a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation</a>, which allows text and strategy placeholders, but <em>not</em> script variables. Script users can edit the default message from the \u201cMessage\u201d field in the \u201cCreate Alert\u201d dialog.</p>\n<p>The <code dir=\"auto\">alert_message</code> parameter in a strategy\u2019s <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement commands</a> allows programmers to define distinct messages for each order fill event. The parameter accepts \u201cseries string\u201d values that can change on each event. To use the values from this parameter in a strategy\u2019s order fill alerts, include the <code dir=\"auto\">{{strategy.order.alert_message}}</code> placeholder in the <code dir=\"auto\">//@strategy_alert_message</code> annotation, or include it in the \u201cMessage\u201d field when creating an alert.</p>\n<h3 class=\"md-heading\" id=\"limitations\"><a href=\"#limitations\">Limitations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function has some limitations:</p>\n<ul>\n<li>Each active alert condition counts toward the total number of alerts the user\u2019s <a href=\"https://www.tradingview.com/pricing/\">plan</a> allows.</li>\n<li>Every <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> call contributes to the script\u2019s <a href=\"/pine-script-docs/v5/writing/limitations/#plot-limits\">plot count</a>.</li>\n<li>Only indicators can issue alert triggers with this function. Other script types do not raise a compilation error when they include calls to this function in their code, but each call has <strong>no effect</strong>.</li>\n</ul>\n<p>By contrast, all calls to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function count as <strong>one</strong> alert, regardless of the number of calls in the code. In addition, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> calls <em>do not</em> contribute to a script\u2019s plot count.</p>\n<p>Similarly, if a user creates a strategy alert based on <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">order fill events</a>, it counts as <strong>one</strong> alert, even though it can fire multiple times with distinct messages from different order executions.</p>\n<h3 class=\"md-heading\" id=\"example-alertcondition-alert\"><a href=\"#example-alertcondition-alert\"><span>Example \u200b<code dir=\"auto\">alertcondition()</code>\u200b alert</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The script below demonstrates a simple <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> call that triggers alerts when the current bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> is above the value from the previous chart bar. It also uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a> call to indicate each bar where the <code dir=\"auto\">triggerCondition</code> occurred:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Simple alert demo\", overlay = true)\n// Create condition to trigger alert.\nbool triggerCondition = close &gt; close[1]\n// Use `triggerCondition` for the `condition` parameter. \n// Define a title for the alert in the menu and a message to send with the alert. \nalertcondition(condition = triggerCondition, title = \"Example `alertcondition` Alert\", \n  message = \"The example `alertcondition` alert was triggered.\")\n// Plot a shape when `triggerCondition` is true to visually mark where alerts occur.\nplotshape(triggerCondition, \"Trigger Condition\", shape.xcross, color = color.fuchsia)</div>\n<p>See <a href=\"/pine-script-docs/v5/concepts/alerts/#alertcondition-events\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/alerts/\">Alerts</a> page to learn more.</p>\n<h3 class=\"md-heading\" id=\"example-alert-alert\"><a href=\"#example-alert-alert\"><span>Example \u200b<code dir=\"auto\">alert()</code>\u200b alert</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This example uses the <code dir=\"auto\">vstop()</code> function from our <a href=\"https://www.tradingview.com/script/BICzyhq0-ta/\">ta</a> library to calculate a volatility stop value and trend information based on the Average True Range (<a href=\"https://www.tradingview.com/support/solutions/43000501823-average-true-range-atr/\">ATR</a>). The <code dir=\"auto\">stopValue</code> trails behind the chart\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> to form a trend-following system.</p>\n<p>The script triggers an alert with an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> call each time the trend direction changes. The alert\u2019s message is a \u201cseries string\u201d that shows the trend\u2019s new direction and the current stop value. An additional alert occurs whenever the <code dir=\"auto\">stopValue</code> moves in the current trend direction, with a message containing the updated value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Vstop alert demo\", overlay = true)\n\nimport TradingView/ta/7 as TVta\n\n// Calculate ATR trailing stop and determine trend direction.\n[stopValue, trendUp] = TVta.vStop(close, 20, 2)\n\n// Round the stop value to mintick for accuracy in comparison operators.\nfloat stop = math.round_to_mintick(stopValue)\n\n// Check for trend changes.\nbool  trendReversal = trendUp != trendUp[1]\nbool  trendToDn     = trendReversal and not trendUp\nbool  trendToUp     = trendReversal and     trendUp\n// Create color variables for the plot display.\ncolor plotColor     = trendUp ? color.green : color.red\ncolor lineColor     = trendReversal ? color(na) : plotColor\n\n// Plot the stop value on the chart. Plot a circle on trend changes.\nplot(stop, \"V-Stop\", lineColor)\nplot(trendReversal ? stop : na, \"Trend Change Circle\", plotColor, 3, plot.style_circles)\n\n// Convert the stop value to string for use in the alert messages.\nstring stopStr = str.tostring(stop)\n\n// If the trend changed to up, send a long alert with the initial stop value.\nif trendToUp\n    alert(\"Long alert. Stop @ \" + stopStr, alert.freq_once_per_bar_close)\n\n// If the trend changed to down, send a short alert with the initial stop value.\nif trendToDn\n    alert(\"Short alert. Stop @ \" + stopStr, alert.freq_once_per_bar_close)\n\n// If the stop value has progressed, send an alert to update the stop value.\nif (trendUp and stop &gt; stop[1] or not trendUp and stop &lt; stop[1]) and not trendReversal\n    alert('Update stop to ' + stopStr, alert.freq_once_per_bar_close)</div>\n<p>See <a href=\"/pine-script-docs/v5/concepts/alerts/#script-alerts\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/alerts/\">Alerts</a> page for more information.</p>\n<h3 class=\"md-heading\" id=\"example-strategy-alert\"><a href=\"#example-strategy-alert\">Example strategy alert<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This example strategy places a <a href=\"/pine-script-docs/v5/concepts/strategies/#market-orders\">market order</a> with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a> and a stop-loss and take-profit (bracket) order with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.exit\">strategy.exit()</a> when a 5-bar moving average crosses over a 10-bar moving average. The stop-loss price is 1% below the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> and the take-profit price is 2% above the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>. Order fill alerts occur when the broker emulator fills an entry or exit order. Both <a href=\"/pine-script-docs/v5/concepts/strategies/#order-placement-and-cancellation\">order placement commands</a> include unique <code dir=\"auto\">alert_message</code> arguments that combine placeholders and \u201cstring\u201d representations of the <code dir=\"auto\">limit</code> and <code dir=\"auto\">stop</code> values to output details like the trade action, position size, chart symbol, and order prices:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// This annotation auto-populates the alert dialogue with the `alert_message` string.\n// @strategy_alert_message {{strategy.order.alert_message}}\n\nstrategy(\"Alert message demo\", overlay = true)\n\n// Declare two moving averages to use for the entry condition.\nfloat fastMa = ta.sma(close, 5)\nfloat slowMa = ta.sma(close, 10)\n// Declare two persistent variables that will hold our stop-loss and take-profit values.\nvar float limit = na\nvar float stop  = na\n\n// If `fastMa` has crossed over `slowMa` and we are not already in a position,\n// place an entry and exit order. \n//      \u2022 Set the `limit` to 2% above the close and the stop to 1% below.\n//      \u2022 Use a combination of script variables and placeholders in the alert strings.\n//      \u2022 The exit alert shows the order direction, position size, ticker, and order price.\n//      \u2022 The entry alert includes the same values plus the stop and limit price.\nif ta.crossover(fastMa, slowMa) and strategy.position_size == 0\n    limit := close * 1.02\n    stop  := close * 0.99\n    string exitString  = \"{{strategy.order.action}} {{strategy.position_size}} {{ticker}} @ {{strategy.order.price}}\"\n    string entryString = exitString + \" TP: \" + str.tostring(limit, format.mintick) + \" SL: \" + \n      str.tostring(stop, format.mintick)\n    strategy.entry(\"Buy\", strategy.long, alert_message = entryString)\n    strategy.exit(\"Exit\", \"Buy\", stop = stop, limit = limit, alert_message = exitString)\n\n// Plot the moving averages, stop, and limit values on the chart.\nplot(fastMa, \"Fast Moving Average\", color.aqua)\nplot(slowMa, \"Slow Moving Average\", color.orange)\nplot(strategy.position_size &gt; 0 ? limit : na, \"Limit\", color.green, style = plot.style_linebr)\nplot(strategy.position_size &gt; 0 ? stop  : na, \"Stop\",  color.red,   style = plot.style_linebr)</div>\n<p>For more information about order fill events, see <a href=\"/pine-script-docs/v5/concepts/alerts/#order-fill-events\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/alerts/\">Alerts</a> page. To learn more about how strategy scripts work, see the <a href=\"/pine-script-docs/v5/concepts/strategies/\">Strategies</a> page.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"if-i-change-my-script-does-my-alert-change\"><a href=\"#if-i-change-my-script-does-my-alert-change\">If I change my script, does my alert change?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>No, not without creating a new alert.</p>\n<p>When a user creates an alert using the \u201cCreate Alert\u201d dialog box, that action saves a \u201csnapshot\u201d of the script, its inputs, and the current chart\u2019s context on TradingView\u2019s servers. This snapshot acts as an independent <em>copy</em> of the script instance and chart. Therefore, any changes to the script, its inputs, or the user\u2019s chart <strong>do not</strong> affect that created alert. To update an alert after making changes, <em>delete</em> the existing alert and <em>create</em> a new one.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"why-arent-my-alerts-working\"><a href=\"#why-arent-my-alerts-working\">Why aren\u2019t my alerts working?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Here are some common reasons why alerts might not work as expected, and how to solve them:</p>\n<p><strong>Make sure the alert is active and has not expired</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Scripts that include alert triggers <strong>do not</strong> directly create alerts. Users must create alerts in the \u201cCreate Alert\u201d dialog box, where they specify the \u201cCondition\u201d that triggers the alert and the \u201cExpiration\u201d time. Created alerts do not fire after they expire. See this Help Center article on\u00a0<a href=\"https://www.tradingview.com/support/solutions/43000595315-how-to-set-up-alerts/\">Setting up alerts</a>.</p>\n<p><strong>Check the alert logs</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>An alert can fire without a notification, depending on the alert\u2019s settings. Check the logs in the <a href=\"https://www.tradingview.com/support/solutions/43000595311-manage-alerts/\">alert manager</a> to see whether an alert occurred. To set up notifications for an alert, use the options in the \u201cNotifications\u201d tab of the \u201cCreate/Edit Alert\u201d dialog box.</p>\n<p><strong>Check for repainting</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>If an alert fires at a different time than expected, <em>repainting</em> might be the cause. Refer to the <a href=\"/pine-script-docs/v5/concepts/repainting/\">Repainting</a> page for more information.</p>\n<p><strong>Limit the frequency of alerts</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>If more than 15 alerts occur within three minutes, the system automatically <em>halts</em> further alerts. This <a href=\"https://www.tradingview.com/support/solutions/43000690939-alert-was-triggered-too-often-and-stopped/\">frequency limit</a> helps prevent excessive notifications and potential server overload.</p>\n<p><strong>Debug script errors</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>If a script instance raises a <em>runtime error</em> at some point during its executions, alerts from that instance <strong>cannot</strong> fire because the error stops the script from continuing to execute its code. Some common issues that can halt alerts include:</p>\n<ul>\n<li>Attempting to store more than 100,000 elements within a <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collection</a></li>\n<li>Trying to access an item from a collection at an <em>out-of-bounds</em> index</li>\n<li>Referencing historical values of a time series outside its allocated <a href=\"/pine-script-docs/v5/error-messages/#pine-script-cannot-determine-the-referencing-length-of-a-series-try-using-max_bars_back-in-the-indicator-or-strategy-function\">memory buffer</a></li>\n<li>Using <a href=\"/pine-script-docs/v5/language/loops/\">loops</a> that take longer than 500 ms to complete their iterations</li>\n</ul>\n<p class=\"spacer-wrapper\"><spacer/>See <a href=\"/pine-script-docs/v5/error-messages/\">this page</a> for additional details about common error messages and troubleshooting tips.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"why-is-my-alert-firing-at-the-wrong-time\"><a href=\"#why-is-my-alert-firing-at-the-wrong-time\">Why is my alert firing at the wrong time?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Sometimes, alerts may fire when users do not expect according to what their script displays on the chart. <a href=\"/pine-script-docs/v5/concepts/repainting/\">Repainting</a> is the typical cause of such issues.</p>\n<p>A chart\u2019s realtime and historical bars often rely on <em>different</em> <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#data-feeds\">data feeds</a>. Data providers may retroactively adjust the reported values on realtime bars, which the displayed data reflects <em>after</em> users refresh their charts or restart their scripts. Such adjustments can cause discrepancies where a triggered alert\u2019s timing may not align with the script\u2019s output after reloading it.</p>\n<p>Scripts may also behave differently on historical and realtime bars, which can lead to repainting. On historical bars, scripts execute once per bar close, whereas on realtime bars, where alerts fire, scripts execute once for <em>each new tick</em> from the data feed. Therefore, if a script behaves differently on those bars, users may see differences between its signals and triggered alerts after reloading the chart.</p>\n<p>Below are some common repainting issues that can affect a script\u2019s alerts:</p>\n<p><strong>Alerts firing before bar close</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Most scripts have <a href=\"/pine-script-docs/v5/concepts/repainting/#fluid-data-values\">fluid data values</a> that update after new ticks during an unconfirmed realtime bar and finalize after the bar closes. Consequently, an alert that fires on an open bar may not reflect the <em>final state</em> of the condition after the bar\u2019s confirmation. Set the alert\u2019s frequency to \u201cOnce Per Bar Close\u201d to avoid this issue.</p>\n<p><strong>Using `calc_on_every_tick` in strategies</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>When a strategy script includes <code dir=\"auto\">calc_on_every_tick = true</code> in its declaration statement or the user selects the \u201cOn every tick\u201d option in the \u201cRecalculate\u201d section of the strategy\u2019s <a href=\"https://www.tradingview.com/support/solutions/43000628599-strategy-properties/\">properties</a>, it recalculates on <em>every</em> price update in the realtime data. This behavior can cause strategies to repaint because historical bars do not contain the same information as realtime bars. See <a href=\"/pine-script-docs/v5/concepts/strategies/#altering-calculation-behavior\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/strategies/\">Strategies</a> page to learn more.</p>\n<p><strong>Incorrect usage of `request.security()` calls</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> calls to fetch data from alternative timeframes can cause discrepancies on historical bars that scripts <strong>cannot</strong> reproduce on realtime bars. Ensure you follow the best practices for <em>non-repainting</em> data requests to avoid such discrepancies, especially with higher-timeframe data. See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">Avoiding repainting</a> section of the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page and the <a href=\"https://www.tradingview.com/script/W1YpYcOI-Higher-timeframe-requests/\">Higher-timeframe requests</a> publication from PineCoders for more information.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-use-variable-messages-with-alertcondition\"><a href=\"#can-i-use-variable-messages-with-alertcondition\">Can I use variable messages with alertcondition()?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">message</code> parameter of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function requires a \u201cconst string\u201d argument, which <strong>cannot change</strong> after compilation. However, the \u201cstring\u201d can include <a href=\"/pine-script-docs/v5/concepts/alerts/#placeholders\">placeholders</a>, which an alert substitutes with corresponding dynamic values from a script each time it fires.</p>\n<p>The script below demonstrates two <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> calls whose <code dir=\"auto\">message</code> arguments include placeholders for dynamic values. Each time alerts from these triggers occur, the message displays information about the current chart\u2019s exchange, symbol, price, and volume:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Placeholder demo\", overlay = false)\n\n[macdLine, signalLine, histLine] = ta.macd(close, 12, 26, 9)\nplot(macdLine,   \"MACD\",   color.blue)\nplot(signalLine, \"Signal\", color.orange)\nplot(histLine,   \"Hist.\",  color.red, style = plot.style_histogram)\n\nbool crossUp = ta.crossover(macdLine,  signalLine)\nbool crossDown = ta.crossunder(macdLine, signalLine)\n\nalertcondition(crossUp, \"MACD Cross Up\",   \"MACD cross up on {{exchange}}:{{ticker}}\\nprice = {{close}}\\nvolume = {{volume}}\")\nalertcondition(crossDown, \"MACD Cross Down\", \"MACD cross down on {{exchange}}:{{ticker}}\\nprice = {{close}}\\nvolume = {{volume}}\")</div>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-include-values-that-change-in-my-alerts\"><a href=\"#how-can-i-include-values-that-change-in-my-alerts\">How can I include values that change in my alerts?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The method for including dynamic values in alert messages varies with the type of alert trigger:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> function accepts a \u201cconst string\u201d <code dir=\"auto\">message</code> argument that can contain placeholders for dynamic values. See <a href=\"/pine-script-docs/v5/faq/alerts/#can-i-use-variable-messages-with-alertcondition\">Can I use variable messages with `alertcondition()`?</a> for more information.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function accepts \u201cseries string\u201d <code dir=\"auto\">message</code> arguments, which allows the convenient creation of dynamic messages that use a script\u2019s calculated values. See <a href=\"/pine-script-docs/v5/faq/alerts/#example-alert-alert\">this section</a> for an example.</li>\n<li>Order fill alerts can use \u201cseries string\u201d values and placeholders. Refer to the example <a href=\"/pine-script-docs/v5/faq/alerts/#example-strategy-alert\">here</a>.</li>\n</ul>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-get-custom-alerts-on-many-symbols\"><a href=\"#how-can-i-get-custom-alerts-on-many-symbols\">How can I get custom alerts on many symbols?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To manage alerts across multiple symbols using a custom script, one option is to set an individual alert on each symbol. There is no automated method to set the same alert across many symbols simultaneously in a single action. It\u2019s also important to note that the TradingView\u00a0<a href=\"https://www.tradingview.com/screener/\">screener</a>\u00a0uses built-in filters and does not support custom Pine Script\u00ae code.</p>\n<p>Scripts can retrieve data from other <em>contexts</em> (symbols, timeframes, and modifiers such as non-standard chart calculations and extended sessions) using the functions in the <code dir=\"auto\">request.*()</code> namespace. With these functions, programmers can design scripts that retrieve data from up to 40 unique contexts. Search for \u201c<a href=\"https://www.tradingview.com/scripts/search/screener/\">screener</a>\u201d in the Community scripts for in-depth examples.</p>\n<p>Here is an example incorporating three symbols. The <code dir=\"auto\">checkForAlert()</code> function calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> to fetch data from a specified context and evaluate the user-defined <code dir=\"auto\">checkForRsiConditions()</code> function using that data. Then, the function calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> using the result to create an alert trigger. The script calls this function three times, creating distinct alert triggers for each specified symbol:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Screener demo\", overlay = true)\n\n// Declare inputs for the alert symbols and the timeframe to run the alerts on. The default is the current chart timeframe.\nstring tfInput      = input.timeframe(\"\", \"Timeframe\")\nstring symbol1Input = input.symbol(\"BINANCE:ETHUSDT\", \"Symbol 1\")\nstring symbol2Input = input.symbol(\"BINANCE:BATUSDT\", \"Symbol 2\")\nstring symbol3Input = input.symbol(\"BINANCE:SOLUSDT\", \"Symbol 3\")\n\n// @function    Generates alert messages for RSI crossing over or under 50, and crosses of price and the 50 EMA.\n// @returns     (string) Formatted alert messages with values for each crossover and crossunder event.\ncheckForRsiConditions() =&gt;\n    float  rsi = ta.rsi(close, 14)\n    float  ema = ta.ema(close, 50)\n    string alertMessage = \"\"\n    if ta.crossover(rsi, 50)\n        alertMessage += str.format(\"RSI ({0}) crossed over 50 for {1} on {2} timeframe.\\n\", rsi, syminfo.ticker, timeframe.period)\n    if ta.crossunder(rsi, 50)\n        alertMessage += str.format(\"RSI ({0}) crossed under 50 for {1} on {2} timeframe.\\n\", rsi, syminfo.ticker, timeframe.period)\n    if ta.crossover(close, ema)\n        alertMessage += str.format(\"Crossover of 50 EMA for {0} on {1} timeframe. Price is {2}\", syminfo.ticker, timeframe.period, close)\n    if ta.crossunder(close, ema)\n        alertMessage += str.format(\"Crossunder of 50 EMA for {0} on {1} timeframe. Price is {2}\", syminfo.ticker, timeframe.period, close)\n\n// @function        Calls the `checkForRsiConditions()` function for the provided symbol and timeframe. \n//                      Triggers an alert if the function returns a message.\n// @param symbol    (simple string) The symbol to check.\n// @param tf        (simple string) The timeframe to check.\n// @param freq      (const string) The frequency of the alert. Optional. Default is `alert.freq_once_per_bar`.\n// @returns         (void) The function has no explicit return, but triggers an alert with the message if the\n//                          conditions defined within the `checkForRsiConditions()` function are met.\ncheckForAlert(simple string symbol, simple string tf, const string freq = alert.freq_once_per_bar) =&gt;\n    string msg = request.security(symbol, tf, checkForRsiConditions())\n    if msg != msg[1] and str.length(msg) &gt; 0\n        alert(msg, freq)\n\n// Check for alerts on the input symbols and timeframe.\ncheckForAlert(symbol1Input, tfInput)\ncheckForAlert(symbol2Input, tfInput)\ncheckForAlert(symbol3Input, tfInput)\n// Continue with additional symbols up to a maximum of 40...</div>\n<p>Note that:</p>\n<ul>\n<li>A script can execute up to 40 <em>unique</em> <code dir=\"auto\">request.*()</code> calls. A <code dir=\"auto\">request.*()</code> call is not unique if a script already calls the same function with the same arguments. See <a href=\"/pine-script-docs/v5/writing/limitations/#number-of-calls\">this section</a> of the <a href=\"/pine-script-docs/v5/writing/limitations/\">Limitations</a> page for more information.</li>\n<li>This script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> is not allowed within <em>local scopes</em>.</li>\n</ul>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-trigger-an-alert-for-only-the-first-instance-of-a-condition\"><a href=\"#how-can-i-trigger-an-alert-for-only-the-first-instance-of-a-condition\">How can I trigger an alert for only the first instance of a condition?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Firing an alert only on its first occurrence can help avoid redundant notifications and isolate specific conditions or state changes, which is beneficial in several use cases. For instance, if a user relies on alerts to automate order placement, restricting redundant alerts to their first occurrence can help avoid accidentally placing excessive orders.</p>\n<p>For alerts with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a> triggers, setting them to fire once using the \u201cOnly Once\u201d option in the \u201cCreate Alert\u201d dialog box is not an optimal solution because it requires <em>manual</em> reactivation each time an alert occurs. Alerts from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> function do not have an \u201cOnly Once\u201d frequency option. The programmer must use conditional logic to ensure the call executes at the appropriate time.</p>\n<p>There are two primary ways to code repeating alerts that fire on only the first instance of a condition:</p>\n<p><strong>Using more strict criteria</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Rather than relying on a continuous condition like <code dir=\"auto\">close &gt; ma</code>, which may remain <code dir=\"auto\">true</code> for multiple consecutive bars, try using a more strict condition like <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.crossover\">ta.crossover(close, ma)</a>. For simple cases, this is the easiest method.</p>\n<p><strong>Using state control</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>More complex scenarios may require controlling and tracking <em>states</em>, which entails setting flags or specific values to signify certain conditions.</p>\n<p>The example script below manages separate bullish and bearish states, and it colors the background to represent each state. When a bullish or bearish state first occurs, an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a> call executes and the script plots a triangle on the chart. It also plots smaller triangles to show where other signals occur within a state, which do not trigger additional alerts:</p>\n<p>// <img alt=\"image\" decoding=\"async\" height=\"1276\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Alerts-How-can-i-trigger-an-alert-only-once-when-the-condition-is-true-the-first-time-1.D3rDfnca_Z1HVNwq.webp\" width=\"2356\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Single alert demo\", overlay = true)\n\n// \u2014\u2014\u2014\u2014\u2014 Calculations: Determine highest/lowest values over last `lengthInput` bars.\nint   lengthInput = input.int(20, \"Length\")\nfloat highest     = ta.highest(lengthInput)\nfloat lowest      = ta.lowest(lengthInput)\n// \u2014\u2014\u2014\u2014\u2014 Trigger conditions: Define bull and bear signals. Bull signal is triggered by a new high, and bear by a new low.\nbool bullSignal = high == highest\nbool bearSignal = low  == lowest\n// \u2014\u2014\u2014\u2014\u2014 State change flags: Set true on state transition bars only.\nbool changeToBull = false\nbool changeToBear = false\n// \u2014\u2014\u2014\u2014\u2014 State tracking: `isBull` is set to true for bull state, false for bear. It's set only at the initial switch to the opposite condition.\n// This variable's state is retained from bar to bar because we use the `var` keyword to declare it.\nvar bool isBull = false\n// \u2014\u2014\u2014\u2014\u2014 State transitions: Allow a switch from bull to bear or bear to bull; ignore repeated signals in current state.\n// Set the state change flags to true only on the first bar where a new signal appears.\nif bullSignal and not isBull\n    isBull       := true\n    changeToBull := true\nelse if bearSignal and isBull\n    isBull       := false\n    changeToBear := true\n\n// Plot highest and lowest values.\nplot(highest, \"Highest\", color.new(color.green, 80), 2)\nplot(lowest,  \"Lowest\",  color.new(color.red,   80), 2)\n// Background color: Green for bull, none for bear.\nbgcolor(isBull ? color.new(color.green, 90) : na)\n// State change markers: Display \"ALERT\" text on bars where a state change occurs and an alert would trigger.\nplotchar(changeToBull, \"Change to Bull state\", \"\u25b2\", location.belowbar, color.new(color.lime, 30), size = size.small, text = \"BULL\\nALERT\")\nplotchar(changeToBear, \"Change to Bear state\", \"\u25bc\", location.abovebar, color.new(color.red,  30), size = size.small, text = \"BEAR\\nALERT\")\n// Signal markers: Display for repeated signals within the current state.\n// These signals would trigger redundant alerts if not for the state tracking flag preventing them.\nplotchar(bullSignal and not changeToBull, \"Bull signal\", \"\u25b2\", location.belowbar, color.green,  size = size.tiny)\nplotchar(bearSignal and not changeToBear, \"Bear signal\", \"\u25bc\", location.abovebar, color.maroon, size = size.tiny)\n\n// Alerts: Trigger on state changes only.\nif changeToBull\n    alert(\"Change to bull state\")\nif changeToBear\n    alert(\"Change to bear state\")</div>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-run-my-alert-on-a-timer-or-delay\"><a href=\"#how-can-i-run-my-alert-on-a-timer-or-delay\">How can I run my alert on a timer or delay?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>It is possible to program logic to delay alert triggers so that they occur <em>after</em> the initial condition. However, because Pine scripts execute on realtime bars only after new <em>price updates</em>, and an alert only fires when a script <em>executes</em>, it is difficult to predict the exact time of a delayed alert.</p>\n<p>There are no price updates in a closed market, meaning an alert with a delay will not fire until the market opens again. Similarly, thinly traded securities may have very infrequent price updates in unpredictable intervals, which can cause a larger delay than intended.</p>\n<p>The Pine script below implements a <em>time-delayed</em> alert, which is subject to the limitations above. When the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> is higher than a moving average, a delay counter starts. After the delay passes, the alert fires once, and another alert <em>cannot</em> fire until the timer resets. Users can specify whether the timer resets on each bar using the script\u2019s <code dir=\"auto\">resetInput</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1276\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Alerts-How-can-i-run-my-alert-on-a-timer-or-delay-1.K7lVQTwy_Z1XdLyV.webp\" width=\"2356\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Delayed alert demo\", overlay = true)\n\nimport PineCoders/Time/4 as PCtime\n\nstring TIME_TT  = \"The delay's duration and units. This specifies the continuous duration for which the condition must be true before triggering the alert.\"\nstring RESET_TT = \"When checked, the duration will reset every time a new realtime bar begins.\"\n\nenum TimeUnit\n    seconds\n    minutes\n    hours\n\nint    durationInput = input.int(20,     \"Condition must last\",     minval  = 1,       inline = \"00\")\nTimeUnit timeUnitInput = input.enum(TimeUnit.seconds, \"\", inline=\"00\")\nbool   resetInput    = input.bool(false, \"Reset timing on new bar\", tooltip = RESET_TT)\nint    maLengthInput = input.int(9,      \"MA length\")\n\n// Calculate and plot a SMA with `maLengthInput` length.\nfloat ma = ta.sma(close, maLengthInput), plot(ma, \"MA\")\n// Check whether the close is greater than the SMA.\nbool cond = close &gt; ma\n// Time the duration for which the condition has been true.\nint secSince = PCtime.secondsSince(cond, resetInput and barstate.isnew)\n// Check if the duration is greater than the input timer.\nbool timeAlert = secSince &gt; (PCtime.timeFrom(\"bar\", durationInput, str.tostring(timeUnitInput)) - time) / 1000\n// Format a time string for the timer label.\nstring alertTime = str.format_time(secSince * 1000, \"mm:ss\")\n\n// Set the contents for the label depending on the stage of the alert timer.\nstring alertString = switch\n    timeAlert =&gt; \"Timed Alert Triggered\\n\\n\" + alertTime\n    cond      =&gt; \"Condition Detected...\\n\\nTimer count\\n\" + alertTime\n    =&gt;           \"Waiting for condition...\"\n\n// Display alert timer using a label.  Declare a basic label once and update location, color, and text on the last bar for efficiency.\nif barstate.islast\n    var label condTime = label.new(na, na, yloc = yloc.abovebar, style = label.style_label_lower_left, textcolor = chart.fg_color)\n    label.set_x(condTime, bar_index)\n    label.set_text(condTime, alertString)\n    label.set_color(condTime, color.new(timeAlert ? color.green : cond ? color.orange : color.red, 50))\n\n// Create a flag to ensure alert is triggered only once each time the delay timer is exceeded.\nvarip bool isFirstOccurrence = true\n// Fire alert if timer is triggered.\nif timeAlert and isFirstOccurrence\n    alert(str.format(\"{0} {1} Delayed Alert Triggered\", durationInput, str.tostring(timeUnitInput)), alert.freq_all)\n\n// Toggle the flag to `false` when alert triggers, and reset when the condition clears.\nisFirstOccurrence := not timeAlert</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">secondsSince()</code> function from the PineCoders\u2019 <a href=\"https://www.tradingview.com/script/tyeeNU9I-Time/\">time</a> library determines the duration, in seconds, for which a certain condition remains continuously <code dir=\"auto\">true</code>. The duration can be tracked within bars because it uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a> keyword.</li>\n<li>The timing starts when the condition first becomes <code dir=\"auto\">true</code>. If the condition becomes <code dir=\"auto\">false</code> or an optional resetting condition occurs, the timer restarts. If \u201cReset timing on new bar\u201d is enabled in the \u201cSettings/Inputs\u201d tab, the function restarts its timing at the start of a new bar.</li>\n<li>A colored label shows what state the script is in:\n<ol>\n<li><strong>Red</strong> - The condition has not occurred yet.</li>\n<li><strong>Orange</strong> - The condition occurred and the delay timer is active.</li>\n<li><strong>Green</strong> - The timer has surpassed the set duration, simulating a delayed alert.</li>\n</ol>\n</li>\n</ul>\n<p>This script relies on variables declared with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a> keyword, which do not revert to their last committed states during realtime bar calculations. See <a href=\"/pine-script-docs/v5/language/variable-declarations/#varip\">this section</a> of the User Manual to learn more about using this keyword. To learn about how <em>rollback</em> works, see the <a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a> page.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-create-json-messages-in-my-alerts\"><a href=\"#how-can-i-create-json-messages-in-my-alerts\">How can I create JSON messages in my alerts?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Alerts can send messages containing JavaScript Object Notation (JSON) to <a href=\"https://www.tradingview.com/support/solutions/43000529348-about-webhooks/\">webhooks</a>. Pine Script does not include any built-in functions to produce JSON, but programmers can create JSON messages in Pine by constructing \u201cstring\u201d representations.</p>\n<p>When constructing JSON representations, ensure the keys and values intended as strings in the JSON-formatted text use <em>double quotes</em>, not single quotes.</p>\n<p>The following example shows three ways to construct JSON strings in Pine Script:</p>\n<ol>\n<li>\n<p><strong>Static JSON Strings</strong></p>\n<p>Define separate alerts with predefined JSON-formatted strings. This method is the simplest.</p>\n</li>\n<li>\n<p><strong>Placeholders</strong></p>\n<p>Use <a href=\"/pine-script-docs/v5/concepts/alerts/#placeholders\">placeholders</a> in the alert message, such as <code dir=\"auto\">{{close}}</code> and <code dir=\"auto\">{{volume}}</code>, to add <em>dynamic</em> values to the JSON. The alert instance replaces the placeholders with corresponding values when it fires. This method can create richer alerts, especially for <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategies</a>, which have <a href=\"https://www.tradingview.com/support/solutions/43000481368-strategy-alerts/\">extra placeholders</a> for their calculated values. See <a href=\"/pine-script-docs/v5/faq/alerts/#example-strategy-alert\">this section</a> above for an example.</p>\n</li>\n<li>\n<p><strong>Dynamic strings</strong></p>\n<p>Use the functions in the <code dir=\"auto\">str.*()</code> namespace and \u201cstring\u201d concatenation to create dynamic JSON-formatted text. This method is the most customizable and advanced. Our script below shows a simple, straightforward example of this approach. When using dynamic string formatting to construct JSON strings, ensure the resulting JSON is <em>valid</em> for all the combined values.</p>\n</li>\n</ol>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"JSON example\", overlay = true)\n\n// Define EMA cross conditions to trigger alerts, and plot the ema on the chart.\nfloat ema = ta.ema(close, 21)\nbool crossUp    = ta.crossover(close, ema)\nbool crossDown  = ta.crossunder(close, ema)\nplot(ta.ema(close, 21))\n\n// \u2014\u2014\u2014\u2014\u2014 Method 1 - Separate alerts with static messages.\nstring alertMessage1a = '{\"method\": 1, \"action\": \"buy\", \"direction\": \"long\", \"text\": \"Price crossed above EMA\"}'\nstring alertMessage1b = '{\"method\": 1, \"action\": \"sell\", \"direction\": \"short\", \"text\": \"Price crossed below EMA\"}'\nalertcondition(crossUp,     \"Method 1 - Cross up\",   alertMessage1a)\nalertcondition(crossDown,   \"Method 1 - Cross down\", alertMessage1b)\n\n// Rendered alert:\n// {\n//     \"method\": 1,\n//     \"action\": \"buy\",\n//     \"direction\": \"long\",\n//     \"text\": \"Price crossed above EMA\"\n// }\n\n// \u2014\u2014\u2014\u2014\u2014 Method 2 - Using placeholders for dynamic values.\nstring alertMessage2 = '{\"method\": 2, \"price\": {{close}}, \"volume\": {{volume}}, \"ema\": {{plot_0}}}'\nalertcondition(crossUp, \"Method 2 - Cross Up\", alertMessage2)\n\n// Rendered alert:\n// {\n//     \"method\": 2,\n//     \"price\": 2066.29,\n//     \"volume\": 100.859,\n//     \"ema\": 2066.286\n// }\n\n// \u2014\u2014\u2014\u2014\u2014 Method 3 - String concatenation using dynamic values.\nstring alertMessage3 =\n '{\"method\": 3, \"price\": ' + str.tostring(close) + ', \"volume\": ' + str.tostring(volume) + ', \"ema\": ' + str.tostring(ema) + '}'\nif crossUp\n    alert(alertMessage3, alert.freq_once_per_bar_close)\n\n// Rendered alert:\n// {\n//     \"method\": 3,\n//     \"price\": 2052.27,\n//     \"volume\": 107.683,\n//     \"ema\": 2052.168\n// }</div>\n<p>Before using the JSON-formatted string in alerts for real-world applications, such as sending messages to place orders, <em>test</em> and <em>validate</em> the JSON message to ensure it works as intended:</p>\n<ul>\n<li>Send alerts to an email address to see how the JSON message appears.</li>\n<li>Copy the alert message from the email into an online JSON validation tool.</li>\n<li>Use an API client application to check the server response to the request.</li>\n</ul>\n<p>Refer to <a href=\"https://en.wikipedia.org/wiki/JSON\" rel=\"nofollow\">this Wikipedia page</a> to learn more about JSON format. To learn more about how alerts send information using webhooks, see the Help Center article on <a href=\"https://www.tradingview.com/support/solutions/43000529348-about-webhooks/\">webhooks</a>.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-send-alerts-to-discord\"><a href=\"#how-can-i-send-alerts-to-discord\">How can I send alerts to Discord?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Sending alerts from a Pine script to a Discord chat room is possible using <a href=\"https://www.tradingview.com/support/solutions/43000529348-about-webhooks/\">webhooks</a>.</p>\n<p>The message for Discord communication requires <a href=\"https://en.wikipedia.org/wiki/JSON\" rel=\"nofollow\">JSON format</a>. The <em>minimum</em> requirement for a valid message is <code dir=\"auto\">{\"content\": \"Your message here\"}</code>.</p>\n<p>The script example below uses\u00a0<a href=\"/pine-script-docs/v5/concepts/alerts/#placeholders\">placeholders</a>\u00a0to dynamically populate alert messages with script values, including the new high or low price, and the chart\u2019s symbol and timeframe:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Discord demo\", overlay = true)\n// Calculate a Donchian channel using the TV ta library.\nimport TradingView/ta/7 as TVta\nint lengthInput = input.int(10, \"Channel length\")\n[highest, lowest, middle] = TVta.donchian(lengthInput)\n// Create conditions checking for a new channel high or low.\nbool isNewHi = high &gt; highest[1]\nbool isNewLo = low  &lt;  lowest[1]\n// Plot the Donchian channel and fill between the midpoint and the upper and lower halves.\nhi  = plot(highest, \"Channel high\", color.new(color.fuchsia, 70))\nmid = plot(middle,  \"Channel mid.\", color.new(color.gray,    70))\nlo  = plot(lowest,  \"Channel low\",  color.new(color.lime,    70))\nfill(mid, hi, color.new(color.fuchsia, 95))\nfill(mid, lo, color.new(color.lime,    95))\n// Plot shapes to mark new highs and lows to visually identify where alert trigger conditions occur.\nplotshape(isNewHi, \"isNewHi\", shape.arrowup,   location.abovebar, color.new(color.lime,    70))\nplotshape(isNewLo, \"isNewLo\", shape.arrowdown, location.belowbar, color.new(color.fuchsia, 70))\n// Create two alert conditions, one for new highs, and one for new lows.\n// Format the message for Discord in the following JSON format: {\"content\": \"Your message here\"}\nalertcondition(isNewHi, \"New High (Discord Alert Demo)\", '{\"content\": \"New high ({{high}}) on {{ticker}} on {{interval}} chart!\"}')\nalertcondition(isNewLo, \"New Low  (Discord Alert Demo)\", '{\"content\": \"New low ({{low}}) on {{ticker}} on {{interval}} chart!\"}')\n// The following test alert condition fires immediately. Set this alert frequency to \"Only Once\".\nalertcondition(true, \"Test (Discord Alert Demo)\", '{\"content\": \"This is a test alert from TradingView to Discord.\"}')</div>\n<p>To send these alert messages to Discord, follow these steps:</p>\n<p><strong>1. Create a Discord webhook</strong></p>\n<ul>\n<li>Create a new webhook in a server using an account with webhook creation and management permissions. Refer to Discord\u2019s <a href=\"https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks\" rel=\"nofollow\">Intro to Webhooks</a> article for instructions.</li>\n<li>Copy the Webhook URL. This URL represents the address where the alert sends a POST request.</li>\n</ul>\n<p><strong>2. Set up an alert on TradingView</strong></p>\n<ul>\n<li>Add the above \u201cDiscord demo\u201d script to a chart and open the \u201cCreate Alert\u201d dialog box.</li>\n<li>Choose one of the script\u2019s alert conditions as the \u201cCondition\u201d in the dialog. If you select the \u201cNew High\u201d or \u201cNew Low\u201d alerts, choose the \u201cOnce Per Bar Close\u201d option in the \u201cFrequency\u201d field to avoid triggering alerts for new highs or lows on an unconfirmed bar. When using the \u201cTest\u201d alert, choose \u201cOnly Once\u201d as the \u201cFrequency\u201d option.</li>\n<li>In the \u201cNotifications\u201d tab of the \u201cCreate Alert\u201d dialog, select \u201cWebhook URL\u201d and paste the URL of the Discord webhook.</li>\n</ul>\n<p><strong>3. Test the integration</strong></p>\n<ul>\n<li>Check that alerts appear in the alert log on TradingView.</li>\n<li>Use the \u201cTest\u201d alert to check whether the webhook works as expected. After the alert fires, check your Discord to see if it received the message.</li>\n<li>If the alert message does not appear in Discord, check whether the pasted webhook URL is correct.</li>\n<li>If the message does not display correctly in Discord, check the JSON format. The minimum required format is <code dir=\"auto\">{\"content\": \"Your message here\"}</code>.</li>\n</ul>\n<p>Consult Discord\u2019s <a href=\"https://discord.com/developers/docs/resources/webhook#webhook-resource\" rel=\"nofollow\">Webhook Resource</a> to learn about advanced JSON message configurations.</p>\n<p>For more information about dynamic values in alert messages, refer to <a href=\"/pine-script-docs/v5/faq/alerts/#how-can-i-include-values-that-change-in-my-alerts\">How can I include values that change in my alerts?</a>.</p>\n<p>To learn about using JSON format in script alerts, see <a href=\"/pine-script-docs/v5/faq/alerts/#how-can-i-create-json-messages-in-my-alerts\">How can I create JSON messages in my alerts?</a>.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/alerts", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-send-alerts-to-telegram\"><a href=\"#how-can-i-send-alerts-to-telegram\">How can I send alerts to Telegram?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Sending TradingView alerts directly to Telegram is challenging due to protocol differences and formatting requirements. One solution is to use an intermediary service, which receives webhook alerts from TradingView, formats them as required by Telegram, and then forwards them to a Telegram bot.</p>\n<ol>\n<li>Choose a platform like Zapier, Integromat, or Pipedream. Alternatively, programmers can consider developing a custom server script using Node.js or Python.</li>\n<li>In TradingView, set up alerts to send\u00a0<a href=\"https://www.tradingview.com/support/solutions/43000529348-about-webhooks/\">webhook requests</a>\u00a0to the intermediary service\u2019s provided URL.</li>\n<li>Configure the intermediary service to reformat TradingView\u2019s incoming requests for Telegram\u2019s API and send the formatted message to a Telegram bot using the\u00a0<code dir=\"auto\">sendMessage</code>\u00a0method.</li>\n</ol>\n<p>See the Telegram Bot API <a href=\"https://core.telegram.org/bots\" rel=\"nofollow\">documentation</a> for detailed technical information.</p>", "segment_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5:14", "segment_order": 14, "segment_type": "guide_section", "source_artifact_id": "d73441eb010b21e53ebbb424ab334b07c2a666eaca90a3811aaa89d4ef0e5ee5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/data-structures\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"data-structures\"><a href=\"#data-structures\">Data structures<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-data-structures-can-i-use-in-pine-script\"><a href=\"#what-data-structures-can-i-use-in-pine-script\">What data structures can I use in Pine Script\u00ae?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine data structures resemble those in other programming languages, with some important differences:</p>\n<ul>\n<li>\n<p><strong>Tuple</strong>: An arbitrary\u2014and temporary\u2014grouping of values of one or more types.</p>\n</li>\n<li>\n<p><strong>Array</strong>: An ordered sequence of values of a single type.</p>\n</li>\n<li>\n<p><strong>Matrix</strong>: A two-dimensional ordered sequence of values of a single type.</p>\n</li>\n<li>\n<p><strong>Object</strong>: An arbitrary\u2014and persistent\u2014collection of values of one or more types.</p>\n</li>\n<li>\n<p><strong>Map</strong>: An <em>unordered</em> sequence of key-value pairs, where the keys are of a single type and the values are of a single type.</p>\n</li>\n</ul>\n<p>The following sections describe each data structure in more detail.</p>\n<h3 class=\"md-heading\" id=\"tuples\"><a href=\"#tuples\">Tuples<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> in Pine Script is a list of values that is returned by a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">function</a>, <a href=\"/pine-script-docs/v5/language/methods/\">method</a>, or local block. Unlike in other languages, tuples in Pine serve no other function.\nTuples do not have names and cannot be assigned to variables.\nApart from the fact that the values are requested and returned together, the values have no relation to each other, in contrast to the other data structures described here.</p>\n<p>To define a tuple, enclose a comma-separated list of values in square brackets.</p>\n<p>Using a tuple to request several values from the same symbol and timeframe using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call is more efficient than making several calls. For instance, consider a script that contains separate <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> calls for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> prices:</p>\n<div class=\"pine-colorizer not-content\">float o = request.security(syminfo.tickerid, \"D\", open)\nfloat h = request.security(syminfo.tickerid, \"D\", high)\nfloat l = request.security(syminfo.tickerid, \"D\", low)\nfloat c = request.security(syminfo.tickerid, \"D\", close)</div>\n<p>Using a tuple can consolidate these calls into a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function call, reducing performance overhead:</p>\n<div class=\"pine-colorizer not-content\">[o, h, l, c] = request.security(syminfo.tickerid, \"D\", [open, high, low, close])</div>\n<p>See the <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">Tuples</a> section in the User Manual for more information.</p>\n<h3 class=\"md-heading\" id=\"arrays\"><a href=\"#arrays\">Arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/language/arrays/\">Arrays</a> store multiple values of the same <a href=\"/pine-script-docs/v5/language/type-system/\">type</a> in a single variable. Each <em>element</em> in an array can be efficiently accessed by its <em>index</em>\u2014an integer corresponding to its position within the array.</p>\n<p>Arrays can contain an arbitrary number of elements. Scripts can loop through arrays, testing each element in turn for certain logical conditions. There are also many built-in functions to perform different operations on arrays. This flexibility makes arrays very versatile data structures.</p>\n<p>Arrays can be created with either the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;type&gt;()</a>\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from()</a> function. In this simple example, we store the last five closing prices in an array and display it in a table:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array example\")\n// Declare an array with 5 `na` values on the first bar.\nvar array&lt;float&gt; pricesArray = array.new&lt;float&gt;(5)\n// On each bar, add a new value to the end of the array and remove the first (oldest) element.\narray.push(pricesArray, close)\narray.shift(pricesArray)\n// Display the array and its contents in a table.\nvar table displayTable = table.new(position.middle_right, 1, 1)\nif barstate.islast\n    table.cell(displayTable, 0, 0, str.tostring(pricesArray), text_color = chart.fg_color)</div>\n<p>See the <a href=\"/pine-script-docs/v5/language/arrays/\">Arrays</a> section in the User Manual for more information.</p>\n<h3 class=\"md-heading\" id=\"matrices\"><a href=\"#matrices\">Matrices<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A <a href=\"/pine-script-docs/v5/language/matrices/\">matrix</a> is a two-dimensional array, made of rows and columns, like a spreadsheet. Matrices, like arrays, store values of the same built-in or user-defined <a href=\"/pine-script-docs/v5/language/type-system/#types\">type</a>.</p>\n<p>Matrices have many built-in functions available to organize and manipulate their data. Matrices are useful for modeling complex systems, solving mathematical problems, and improving algorithm performance.</p>\n<p>This script demonstrates a simple example of matrix addition. It creates a 3x3 matrix, calculates its <a href=\"/pine-script-docs/v5/language/matrices/#transposing\">transpose</a>, then calculates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sum\">matrix.sum()</a> of the two matrices. This example displays the original matrix, its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">transpose</a>, and the resulting sum matrix in a table on the chart.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"476\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-What-are-the-primary-data-structues-available-in-the-pine-script-1.CN2IZH7V_R7sbs.webp\" width=\"740\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix sum example\")\n\n//@variable An empty matrix of type \"float\".\nm = matrix.new&lt;float&gt;()\n\n// Add rows to the matrix containing data.\nm.add_row(0, array.from(1, 2, 3))\nm.add_row(1, array.from(0, 4, 2))\nm.add_row(2, array.from(3, 1, 2))\n\nvar table displayTable = table.new(position.middle_right, 5, 2)\nif barstate.islast\n    matrix&lt;float&gt; t = m.transpose()\n    table.cell(displayTable, 0, 0, \"A\",                            text_color = chart.fg_color)\n    table.cell(displayTable, 0, 1, str.tostring(m),                text_color = chart.fg_color)\n    table.cell(displayTable, 1, 1, \"+\",                            text_color = chart.fg_color)\n    table.cell(displayTable, 2, 0, \"A\u1d40\",                           text_color = chart.fg_color)\n    table.cell(displayTable, 2, 1, str.tostring(t),                text_color = chart.fg_color)\n    table.cell(displayTable, 3, 1, \"=\",                            text_color = chart.fg_color)\n    table.cell(displayTable, 4, 0, \"A + A\u1d40\",                       text_color = color.green)\n    table.cell(displayTable, 4, 1, str.tostring(matrix.sum(m, t)), text_color = color.green)</div>\n<p>See the <a href=\"/pine-script-docs/v5/language/matrices/\">Matrices</a> section in the User Manual for more information.</p>\n<h3 class=\"md-heading\" id=\"objects\"><a href=\"#objects\">Objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script <a href=\"/pine-script-docs/v5/language/objects/\">objects</a> are containers that group together multiple fields into one logical unit.</p>\n<p>Objects are <em>instances</em> of <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> (UDTs). UDTs are similar to <em>structs</em> in traditional programming languages. They define the rules for what an object can contain. Scripts first create a UDT by using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a> keyword and then create one or more objects of that type by using the UDT\u2019s built-in <code dir=\"auto\">new()</code> method.</p>\n<p>UDTs are <em>composite</em> types; they contain an arbitrary number of fields that can be of any type. A UDT\u2019s field type can even be another UDT, which means that objects can contain other objects.</p>\n<p>Our example script creates a new <code dir=\"auto\">pivot</code> object each time a new pivot is found, and draws a label using each of the object\u2019s fields:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Object example\", overlay = true)\n\n// Create the pivot type with 3 fields: the x coordinate, the y coordinate, and a formatted time string.\ntype pivot\n    int x\n    float y\n    string pivotTime\n// Check for new pivots. `ta.pivotHigh` returns the price of the pivot.\nfloat pivFound = ta.pivothigh(10, 10)\n// When a pivot is found, create a new pivot object and generate a label using the values from its fields.\nif not na(pivFound)\n    pivot pivotObject = pivot.new(bar_index - 10, pivFound, str.format_time(time[10], \"yyyy-MM-dd HH:mm\"))\n    label.new(pivotObject.x, pivotObject.y, pivotObject.pivotTime, textcolor = chart.fg_color)</div>\n<p>See the User Manual page on <a href=\"/pine-script-docs/v5/language/objects/\">Objects</a> to learn more about working with UDTs.</p>\n<h3 class=\"md-heading\" id=\"maps\"><a href=\"#maps\">Maps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/language/maps/#maps\">Maps</a> in Pine Script are similar to <em>dictionaries</em> in other programming languages, such as dictionaries in Python, objects in JavaScript, or HashMaps in Java.\nMaps store elements as key-value pairs, where each key is unique. Scripts can access a particular value by looking up its associated key.</p>\n<p>Maps are useful when accessing data directly without searching through each element, as you need to do with arrays. For example, maps can be more performant and simpler than arrays for associating specific attributes with symbols, or dates with events.</p>\n<p>The following example illustrates the practical application of maps for managing earnings dates and values as key-value pairs, with dates serving as the keys:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1666\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-What-are-the-primary-data-structues-available-in-the-pine-script-2.F207zRIS_Kr85n.webp\" width=\"2226\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Earnings map\", overlay = true)\n// Get the earnings value if present. We use `barmerge.gaps_on` to return `na` unless earnings occurred.\nfloat earnings = request.earnings(syminfo.tickerid, earnings.actual, barmerge.gaps_on)\n// Declare a map object for storing earnings dates and values.\nvar map&lt;string, float&gt; earningsMap = map.new&lt;string, float&gt;()\n// If `request.security()` returned data, add an entry to the map with the date as the key and earnings as the value.\nif not na(earnings)\n    map.put(earningsMap, str.format_time(time, \"yyyy-MM-dd\"), earnings)\n// On the last historical bar, loop through the map in the insertion order, writing the key-value pairs to the logs.\nif barstate.islastconfirmedhistory\n    string logText = \"\\n\"\n    for [key, value] in earningsMap\n        logText += str.format(\"{0}: {1}\\n\", key, value)\n    log.info(logText)</div>\n<p>Here, we use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a> with the barmerge parameter set to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.gaps_on\">barmerge.gaps_on</a> to return the earnings value on bars where earnings data is available, and return <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> otherwise.\nWe add non-na values to the map, associating the dates that earnings occurred with the earnings numbers. Finally, on the last historical bar, the script <a href=\"/pine-script-docs/v5/language/maps/#looping-through-a-map\">loops through the map</a>, logging each key-value pair to display the map\u2019s contents.</p>\n<p>To learn more about working with maps, refer to the <a href=\"/pine-script-docs/v5/language/maps/\">Maps</a> section in the User Manual.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"whats-the-difference-between-a-series-and-an-array\"><a href=\"#whats-the-difference-between-a-series-and-an-array\">What\u2019s the difference between a series and an array?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script, <a href=\"/pine-script-docs/v5/language/type-system/#series\">\u201cseries\u201d</a> variables are calculated on each bar. Historical values cannot change. Series values can change during the realtime bar, but when the bar closes, the value for that bar becomes fixed and immutable.\nThese fixed values are automatically indexed for each bar. Scripts can access values from previous bars by using the <a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">[] history-referencing operator</a>) to go back one or more bars.</p>\n<p>Where \u201cseries\u201d variables are strictly time-indexed, and the historical values are created automatically, <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> are created, filled, and manipulated arbitrarily by a script\u2019s logic. Programmers can change the size of arrays dynamically by using functions that <a href=\"/pine-script-docs/v5/language/arrays/#inserting-and-removing-array-elements\">insert or remove elements</a>. Any element in an array can also be altered using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.set\">array.set()</a> function.</p>\n<p>The concept of <a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> is a fundamental aspect of Pine Script. Its series-based <a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> processes scripts bar-by-bar. This built-in behavior mimics looping, allowing a series to track values, accumulate totals, or perform calculations across a sequence of data on each bar.</p>\n<p>Simple calculations can thus be done efficiently using \u201cseries\u201d variables. Using arrays for similar tasks requires manually creating a dataset, managing its size, and using loops to process the array\u2019s contents, which can be far less efficient.</p>\n<p>Arrays, of course, can do many things that series variables cannot. Scripts can use arrays to store a fixed set of values, store complex data such as User-Defined Types, manipulate objects for visual display, and more.\nIn general, use arrays to handle data that doesn\u2019t fit the time series model, or for complex calculations. Arrays can also mimic series by creating custom datasets, as in the <a href=\"https://www.tradingview.com/script/Bn7QkdZR-getSeries/\">getSeries</a> library.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>An array is itself a series. Historical values of an array can be <a href=\"/pine-script-docs/v5/language/arrays/#history-referencing\">accessed by using the history-referencing operator</a>.</p></div></aside>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-do-i-create-and-use-arrays-in-pine-script\"><a href=\"#how-do-i-create-and-use-arrays-in-pine-script\">How do I create and use arrays in Pine Script?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> are one-dimensional collections that can hold multiple values of a single type.</p>\n<p><strong>Declaring arrays</strong></p>\n<p>Declare an array by using one of the following functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;type&gt;()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dfrom\">array.from()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dcopy\">array.copy()</a>.\nArrays can be declared with the <a href=\"/pine-script-docs/v5/language/variable-declarations/#var\">var</a> keyword to have their values persist from bar to bar, or without it, so that the values initialize again on each bar.\nFor more on the differences between declaring arrays with or without <a href=\"/pine-script-docs/v5/language/variable-declarations/#var\">var</a>, see <a href=\"/pine-script-docs/v5/faq/data-structures/#whats-the-difference-between-an-array-declared-with-or-without-var\">this section</a> of this FAQ.</p>\n<p><strong>Adding and removing elements</strong></p>\n<p>Pine Script provides several functions for dynamically adjusting the size and contents of arrays.</p>\n<p class=\"spacer-wrapper\"><spacer/><strong>Adding elements</strong></p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dunshift\">array.unshift()</a>\ninserts a new element at the beginning of an array (index 0) and increases the index values of any existing elements by one.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dinsert\">array.insert()</a>\ninserts a new element at the specified index and increases the index of existing elements at or after the insertion index by one.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpush\">array.push()</a>\nadds a new element at the end of an array.</li>\n</ul>\n<p class=\"spacer-wrapper\"><spacer/><strong>Removing elements</strong></p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dremove\">array.remove()</a>\nremoves the element at the specified index and returns that element\u2019s value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dshift\">array.shift()</a>\nremoves the first element from an array and returns its value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpop\">array.pop()</a>\nremoves the last element of an array and returns its value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dclear\">array.clear()</a>\nremoves all elements from an array. Note that clearing an array won\u2019t delete any objects that were referenced by its elements. If you want to delete objects contained by an array, loop through the array and delete the objects first, and then clear the array.</li>\n</ul>\n<p>The flexibility afforded by these functions supports various data management strategies, such as\n<a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queues</a> or <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-stack\">stacks</a>, which are useful for custom datasets or sliding window calculations.\nRead more about implementing a stack or queue in <a href=\"/pine-script-docs/v5/faq/data-structures/#what-are-queues-and-stacks\">this FAQ entry</a>.</p>\n<p><strong>Calculations on arrays</strong></p>\n<p>Because arrays are not <a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> data structures, performing operations across an array\u2019s elements requires special functions designed for arrays.\nProgrammers can write custom functions to perform calculations on arrays. Additionally, built-in functions enable computations like finding the maximum, minimum, or average values within an array.\nSee the <a href=\"/pine-script-docs/v5/language/arrays/#calculations-on-arrays\">Calculation on arrays</a> section of the User Manual for more information.</p>\n<p><strong>Script example</strong></p>\n<p>This script example demonstrates a practical application of arrays by tracking the opening prices of the last five sessions. The script declares a float array to hold the prices using the <a href=\"/pine-script-docs/v5/language/variable-declarations/#var\">var</a> keyword, allowing it to retain its values from bar to bar.</p>\n<p>At the start of each session, we update the array by adding the new opening price and removing the oldest one. This process, resembling a <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queue</a>, keeps the array\u2019s size constant while maintaining a moving window of the session opens for the last five days.\nBuilt-in array functions return the highest, lowest, and average opening price over the last five sessions. We plot these values to the chart.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1284\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-How-do-i-create-and-use-arrays-in-pine-script-1.SP394-6D_ZkAgVX.webp\" width=\"2366\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array demo\", overlay = true)\n// Create an input to determine the number of session opens to track, with a default value of 5.\nint numOpensInput = input.int(5, \"Number of opens to track\")\n// Create an array to store open prices. Using `var` ensures the array retains its values from bar to bar.\n// Initially, the array is filled with placeholder values (`na`), which are later updated with actual open prices.\nvar array&lt;float&gt; opensArray = array.new&lt;float&gt;(numOpensInput)\n// On the first bar of each session, update the array: add the current open price and remove the oldest entry.\nif session.isfirstbar_regular\n    array.push(opensArray, open)\n    array.shift(opensArray)\n// Plot the highest, lowest, and average open prices from the tracked sessions\nplot(array.max(opensArray), \"Highest open in n sessions\",       color.lime)\nplot(array.min(opensArray), \"Lowest open in n sessions\",        color.fuchsia)\nplot(array.avg(opensArray), \"Avg. open of the last n sessions\", color.gray)\n// Change the background color on the first bar of each session to visually indicate session starts.\nbgcolor(session.isfirstbar_regular ? color.new(color.gray, 80) : na)</div>\n<p>For more information about arrays, see the <a href=\"/pine-script-docs/v5/language/arrays/#arrays\">Arrays</a> page in the User Manual.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"whats-the-difference-between-an-array-declared-with-or-without-var\"><a href=\"#whats-the-difference-between-an-array-declared-with-or-without-var\"><span>What\u2019s the difference between an array declared with or without \u200b<code dir=\"auto\">var</code>\u200b?</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_var\">var</a> keyword, a script can declare an <a href=\"/pine-script-docs/v5/language/arrays/\">array</a> variable in a script that is initialized only once, during the first iteration on the first chart bar.</p>\n<p><strong>Persistent arrays</strong></p>\n<p>When an array is declared with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_var\">var</a>, it is initialized only once, at the first execution of the script. This allows the array to retain its contents and potentially grow in size across bars, making it ideal for cumulative data collection or tracking values over time.</p>\n<p><strong>Non-persistent arrays</strong></p>\n<p>Arrays declared without <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_var\">var</a> are reinitialized on every new bar, effectively resetting their content. This behavior suits scenarios where calculations are specific to the current bar, and historical data retention is unnecessary.</p>\n<p><strong>Example script</strong></p>\n<p>Here, we initialize two arrays. Array <code dir=\"auto\">a</code> is declared without using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_var\">var</a> keyword, while array <code dir=\"auto\">b</code>\nis declared with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_var\">var</a>, allowing us to observe and compare their behavior. Throughout the runtime, we incrementally add an element to\neach array on each bar. We use a <a href=\"/pine-script-docs/v5/concepts/tables/\">table</a> to present and compare both the sizes of these arrays and the number of chart bars, effectively illustrating the impact of\ndifferent declaration methods on array behavior:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Using `var` with arrays\")\n//@variable An array that initializes on every bar.\na = array.new&lt;float&gt;()\narray.push(a, close)\n//@variable An array that expands its size by 1 on each bar.\nvar b = array.new&lt;float&gt;(0)\narray.push(b, close)\n// Populate a table on the chart's last bar to display the sizes of the arrays and compare it to the number of chart bars.\nif barstate.islast\n    var table displayTable = table.new(position.middle_right, 2, 3)\n    table.cell(displayTable, 0, 0, \"Array A size:\",             text_color = chart.fg_color, text_halign = text.align_right)\n    table.cell(displayTable, 1, 0, str.tostring(a.size()),      text_color = chart.fg_color, text_halign = text.align_left)\n    table.cell(displayTable, 0, 1, \"Array B size:\",             text_color = chart.fg_color, text_halign = text.align_right)\n    table.cell(displayTable, 1, 1, str.tostring(b.size()),      text_color = chart.fg_color, text_halign = text.align_left)\n    table.cell(displayTable, 0, 2, \"Number of chart bars:\",     text_color = chart.fg_color, text_halign = text.align_right)\n    table.cell(displayTable, 1, 2, str.tostring(bar_index + 1), text_color = chart.fg_color, text_halign = text.align_left)</div>\n<p><strong>Results</strong></p>\n<ul>\n<li><strong>Array A (Non-Persistent):</strong> This array is reset at the beginning of each new bar. As a result, despite adding elements on each bar, its size remains constant, reflecting only the most recent addition.</li>\n<li><strong>Array B (Persistent):</strong> This array retains its elements and accumulates new entries across bars, mirroring the growing count of chart bars. This persistent nature of the array shows its ability to track or aggregate data over the script\u2019s runtime.</li>\n</ul>\n<p>For further details, consult the sections concerning variable\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#declaration-modes\">declaration modes</a> and their use in\n<a href=\"/pine-script-docs/v5/language/arrays/#using-var-and-varip-keywords\">array declarations</a> in the User Manual.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-are-queues-and-stacks\"><a href=\"#what-are-queues-and-stacks\">What are queues and stacks?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts can use <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> to create <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queues</a> and <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-stack\">stacks</a>.</p>\n<p><strong>Stacks</strong></p>\n<p class=\"spacer-wrapper\"><spacer/> A stack uses the \u201clast in, first out\u201d (LIFO) principle, where the most recently added item is the first to be taken away.\nThink of this like a stack of plates, where you can only place a new plate on top or remove the top plate. To use an array as a stack, add elements to the end of the array using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a> and remove elements from the end of the array using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.pop\">array.pop()</a>.</p>\n<p><strong>Queues</strong></p>\n<p class=\"spacer-wrapper\"><spacer/> A queue uses the \u201cfirst in, first out\u201d (FIFO) principle, where the first item to be added is the first to be removed. This kind of queue in code is like a queue in real life, such as in a coffee shop, where no matter how many people join the end of the queue, the first person still gets served first. To use an array as a queue, add elements to the end of the array using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a> and remove them from the beginning using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>.</p>\n<p>Stacks are particularly useful for accessing the most recent data, such as for tracking price levels. Queues are used for sequential data processing tasks, like event handling. Two example scripts follow, to illustrate these different usages.</p>\n<p><strong>Example: Arrays as stacks</strong></p>\n<p>This script uses arrays as stacks to manage pivot points. It draws <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> from the pivot points and extends the lines with each new bar until price intersects them.\nWhen the script detects a pivot point, it adds (pushes) a new line to the stack. With each new bar, the script extends the end point of each line in the stack.\nIt then checks whether price has intersected the high or low pivot lines at the top of the stack. If so, the script removes (pops) the intersected line from the stack, meaning that it will no longer be extended with new bars.\nNote that we do not need to iterate through the arrays to check all the lines, because price is always between only the high and low pivot lines at the end of each array.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1288\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-What-does-queue-stack-mean-1.DR_kqOoE_WYIys.webp\" width=\"2366\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array as a stack\", overlay = true)\n\n// @function                Adds a new horizontal line to an array of lines at a specified pivot level.\n// @param id                (array&lt;line&gt;) The array to which to add the new line.\n// @param pivot             (float) The price level at which to draw the horizontal line.\n// @param lineColor         (color) The color of the line.\n// @returns                 (void) The function has no explicit return.\nstackLine(array&lt;line&gt; id, float pivot, color lineColor) =&gt;\n    if not na(pivot)\n        array.push(id, line.new(bar_index - 10, pivot, bar_index, pivot, color = lineColor))\n\n// @function                Extends the endpoint (`x2`) of each line in an array to the current `bar_index`.\n// @param id                (array&lt;line&gt;) The array containing the line objects to update.\n// @returns                 (void) The function has no explicit return.\nextendLines(array&lt;line&gt; id) =&gt;\n    for eachLine in id\n        eachLine.set_x2(bar_index)\n\n// @function                Removes line objects from an array if they are above or below the current bar's high or low.\n// @param id                (array&lt;line&gt;) The array from which to remove line objects.\n// @param isBull            (bool) If true, remove bullish pivot lines below the high price;\n//                          if false, remove bearish pivot line above the low price.\n// @returns                 (void) The function has no explicit return.\nremoveLines(array&lt;line&gt; id, bool isBull) =&gt;\n    if array.size(id) &gt; 0\n        float linePrice = line.get_price(array.last(id), bar_index)\n        if isBull ? high &gt; linePrice : low &lt; linePrice\n            array.pop(id)\n    line(na)\n\n// Find the pivot high and pivot low prices.\nfloat pivotLo = ta.pivotlow(10,  10), float pivotHi = ta.pivothigh(10, 10)\n\n// Initialize two arrays on the first bar to stack our lines in.\nvar array&lt;line&gt; pivotHiArray = array.new&lt;line&gt;()\nvar array&lt;line&gt; pivotLoArray = array.new&lt;line&gt;()\n\n// If a pivot occurs, draw a line from the pivot to the current bar and add the line to the stack.\nstackLine(pivotHiArray, pivotHi, color.orange)\nstackLine(pivotLoArray, pivotLo, color.aqua)\n\n// Extend all lines in each array to the current bar on each bar.\nextendLines(pivotHiArray)\nextendLines(pivotLoArray)\n\n// Check the final element of each array to see if price exceeded the pivot lines.\n// Pop the line off the stack if it was exceeded.\nremoveLines(pivotHiArray, true)\nremoveLines(pivotLoArray, false)</div>\n<p><strong>Example: Arrays as queues</strong></p>\n<p>This script uses arrays as queues to track pivot points for monitoring recent support and resistance levels. It dynamically updates <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> extending from the four most recent pivot highs and lows to the current bar with each new bar. When the script detects a new pivot high or low, it adds a line that represents this pivot to the respective queue.\nTo maintain the queue\u2019s size at a constant four items, the script removes the oldest line in the queue whenever it adds a new line.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1142\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-What-does-queue-stack-mean-2.B1hrWGZc_Z2io8X0.webp\" width=\"2110\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array as a queue\", overlay = true)\n\nint PIVOT_LEGS = 10\n\n// @function            Queues a new `value` at the end of the `id` array and removes\n//                      the first element if the array size exceeds the specified `maxSize`.\n// @param id            (&lt;any array type&gt;) The array in which to queue the element.\n// @param maxSize       (int) The maximum allowed number of elements in the array.\n//                      If the array exceeds this size, the first element is removed.\n// @param value         (&lt;type of the array&gt;) The new element to add to the array.\n// @returns             (&lt;type of the array&gt;) The removed element.\narrayQueue(id, int maxSize, value) =&gt;\n    id.push(value)\n    if id.size() &gt; maxSize\n        id.shift()\n\n// @function                Adds a new horizontal line to an array at a certain pivot level and removes the oldest line.\n// @param id                (array&lt;line&gt;) The array to which to add the new line.\n// @param pivot             (float) The price level at which to draw the horizontal line.\n// @param numLines          (int) The number of lines to keep in the queue.\n// @param lineColor         (color) The color of the line to draw.\n// @returns                 (void) The function has no explicit return.\nqueueLine(array&lt;line&gt; id, float pivot, int numLines, color lineColor) =&gt;\n    if not na(pivot)\n        arrayQueue(id, numLines, line.new(bar_index - PIVOT_LEGS, pivot, bar_index, pivot, color = lineColor))\n\n// @function                Extends the endpoint (`x2`) of each line in an array to the current `bar_index`.\n// @param id                (array&lt;line&gt;) The array containing the line objects to update.\n// @returns                 (void) The function has no explicit return.\nextendLines(array&lt;line&gt; id) =&gt;\n    for eachLine in id\n        eachLine.set_x2(bar_index)\n\n// Find the pivot high and pivot low price.\nfloat pivotLo = ta.pivotlow(PIVOT_LEGS,  PIVOT_LEGS)\nfloat pivotHi = ta.pivothigh(PIVOT_LEGS, PIVOT_LEGS)\n\n// Initialize two arrays on the first bar to queue our lines in.\nvar array&lt;line&gt; pivotHiArray = array.new&lt;line&gt;()\nvar array&lt;line&gt; pivotLoArray = array.new&lt;line&gt;()\n\n// If a pivot occurs, draw a line from the pivot to the current bar, add it to the queue, and remove the oldest line.\nqueueLine(pivotHiArray, pivotHi, 4, color.orange)\nqueueLine(pivotLoArray, pivotLo, 4, color.aqua)\n\n// Extend all lines in each array to the current bar on each bar.\nextendLines(pivotHiArray)\nextendLines(pivotLoArray)</div>\n<p>For more information on manipulating arrays, see the <a href=\"/pine-script-docs/v5/language/arrays/\">Arrays</a> section in the User Manual.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-perform-operations-on-all-elements-in-an-array\"><a href=\"#how-can-i-perform-operations-on-all-elements-in-an-array\">How can I perform operations on all elements in an array?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script, there are no built-in functions to apply operations across the entire array at once. Instead, scripts need to iterate through the array, performing the operation on each element one at a time.</p>\n<p>The easiest way to retrieve each element in an array is by using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> structure. This type of loop retrieves each element in turn, without the need for specifying the number of iterations.</p>\n<p>The simple form of the loop has the format <code dir=\"auto\">for element in array</code>, where <code dir=\"auto\">element</code> is a variable that is assigned the current array element being accessed.</p>\n<p>If the script\u2019s logic requires the position of the element in the array, use the two-argument form: <code dir=\"auto\">for [index, element] in array</code>. This form returns both the current element and its index in a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a>.</p>\n<p><strong>Example: retrieving array elements</strong></p>\n<p>This first example script uses an array as a <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queue</a> to store <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> representing the latest four pivot highs and lows. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop performs two tasks:</p>\n<ul>\n<li>It adjusts the <code dir=\"auto\">x2</code> endpoint of each line to the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.</li>\n<li>It changes the colors of the lines to blue for support or orange for resistance, based on their position relative to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice.</li>\n</ul>\n<p>Note that neither of these operations requires knowing the index of the array element.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1288\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-How-can-i-perform-operations-on-all-elements-in-an-array-1.Cv5bYrg2_1DaPAG.webp\" width=\"2364\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example: `for...in` loop\", overlay = true)\n\n// @function            Queues a new `value` at the end of the `id` array and removes\n//                      the first element if the array size exceeds the specified `maxSize`.\n// @param id            (&lt;any array type&gt;) The array in which to queue the element.\n// @param maxSize       (int) The maximum allowed number of elements in the array.\n//                      If the array exceeds this size, the first element is removed.\n// @param value         (&lt;type of the array&gt;) The new element to add to the array.\n// @returns             (&lt;type of the array&gt;) The removed element.\narrayQueue(id, int maxSize, value) =&gt;\n    id.push(value)\n    if id.size() &gt; maxSize\n        id.shift()\n\n// @function                Adds a new horizontal line to an array at a certain pivot level and removes the oldest line.\n// @param id                (array&lt;line&gt;) The array to which to add the new line.\n// @param pivot             (float) The price level at which to draw the horizontal line.\n// @param numLines          (int) The number of lines to keep in the queue.\n// @param lineColor         (color) The color of the line to draw.\n// @returns                 (void) The function has no explicit return.\nqueueLine(array&lt;line&gt; id, float pivot, int numLines, color lineColor) =&gt;\n    if not na(pivot)\n        arrayQueue(id, numLines, line.new(bar_index - 10, pivot, bar_index, pivot, color = lineColor))\n\n// @function                Extends the endpoint (`x2`) of each line in an array to the current `bar_index`.\n// @param id                (array&lt;line&gt;) The array containing the line objects to update.\n// @returns                 (void) The function has no explicit return.\nextendLines(array&lt;line&gt; id) =&gt;\n    for eachLine in id\n        eachLine.set_x2(bar_index)\n\n// @function                Adjusts the color of each line in an array. If the `close` is above the line, the line is \n//                          set to `bullColor` (support), else, `bearColor` (resistance).\n// @param id                (array&lt;line&gt;) The array containing the line objects.\n// @param bullColor         (color) The color to apply to the line if `close` is equal to or higher than the line's price.\n// @param bearColor         (color) The color to apply to the line if `close` is below the line's price.\n// @returns                 (void) The function has no explicit return.\ncolorLines(array&lt;line&gt; id, color bullColor, color bearColor) =&gt;\n    for eachLine in id\n        if close &gt;= eachLine.get_price(bar_index)\n            eachLine.set_color(bullColor)\n        else\n            eachLine.set_color(bearColor)\n\n// Find the pivot high and pivot low prices.\nfloat pivotLo = ta.pivotlow(10,  10)\nfloat pivotHi = ta.pivothigh(10, 10)\n\n// Initialize two arrays on the first bar to queue our lines in.\nvar array&lt;line&gt; pivotHiArray = array.new&lt;line&gt;(), var array&lt;line&gt; pivotLoArray = array.new&lt;line&gt;()\n\n// If a pivot occurs, draw a line from the pivot to the current bar, add it to the queue, and remove the oldest line.\nqueueLine(pivotHiArray, pivotHi, 4, color.orange), queueLine(pivotLoArray, pivotLo, 4, color.aqua)\n\n// Extend all lines in each array to the current bar on each bar.\nextendLines(pivotHiArray), extendLines(pivotLoArray)\n\n// Set the color of lines as support or resistance by checking if the closing price is above or below the lines.\ncolorLines(pivotHiArray, color.aqua, color.orange)\ncolorLines(pivotLoArray, color.aqua, color.orange)</div>\n<p><strong>Example: retrieving array elements and indices</strong></p>\n<p>In our second script, we use the two-argument variant of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to access elements and their indices in an array.\nThis method facilitates operations that depend on element indices, such as managing parallel arrays or incorporating index values into calculations.\nThe script pairs a boolean array with an array of positive and negative random integers. The boolean array flags whether each corresponding integer in the primary array is positive.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example: `for...in` loop with index\")\n// Create an array of random integers above and below 0.\nvar valuesArray = array.from(4, -8, 11, 78, -16, 34, 7, 99, 0, 55)\n// Create an array to track the positive state of each integer.\nvar isPos = array.new_bool(10, false)\n\n// Iterate over the valuesArray using a `for...in` loop and update each corresponding element in the bool array to true\n// if the value is above 0, or false if it is below 0.\nfor [i, eachValue] in valuesArray\n    if eachValue &gt; 0\n        array.set(isPos, i, true)\n\n// Print both arrays in a label on the last historical bar.\nif barstate.islastconfirmedhistory\n    label.new(bar_index +1, high, str.tostring(valuesArray) + \"\\n\" + str.tostring(isPos), style = label.style_label_left, textcolor = chart.fg_color)</div>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"whats-the-most-efficient-way-to-search-an-array\"><a href=\"#whats-the-most-efficient-way-to-search-an-array\">What\u2019s the most efficient way to search an array?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The obvious way to search for an element in an array is to use a <a href=\"/pine-script-docs/v5/language/loops/\">loop</a> to check each element in turn.\nHowever, there are more efficient ways to search, which can be useful in different situations.\nSome of the following functions return only the index of a value. Programmers can then use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a> if the script needs the actual value.</p>\n<h3 class=\"md-heading\" id=\"checking-if-a-value-is-present-in-an-array\"><a href=\"#checking-if-a-value-is-present-in-an-array\">Checking if a value is present in an array<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If all the script needs to do is to check whether a certain value is present in an array or not, use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.includes\">array.includes()</a> function.\nIf the element is found, the function returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>; otherwise, it returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_false\">false</a>.\nThis method does not return the index of the element.</p>\n<p>The following example script checks if the value <code dir=\"auto\">3</code> is present in the <code dir=\"auto\">values</code> array, and displays either \u201cfound\u201d or \u201cnot found\u201d in a <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">label</a>.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example: Find whether an array element is present\")\narray&lt;int&gt; values = array.from(1, 3, 5)\nint searchValue = input(3, \"Value to Search For\")\nbool valuePresent = array.includes(values, searchValue)\nif barstate.islast\n    label.new(bar_index, low, valuePresent ? \"Search value found\" : \"Search value not found\", textcolor = color.white)</div>\n<h3 class=\"md-heading\" id=\"finding-the-position-of-an-element\"><a href=\"#finding-the-position-of-an-element\">Finding the position of an element<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If the script requires the <em>position</em> of an element, programmers can use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a> function.\nThis function returns the index of the <em>first</em> occurrence of a value within an array. If the value is not found, the function returns <code dir=\"auto\">-1</code>.\nThis method does not show whether there are multiple occurrences of the search value in the array. Depending on the script logic, this method might not be suitable if the array contains values that are not unique.</p>\n<p>The following script searches for the first occurrence of <code dir=\"auto\">101.2</code> in the <code dir=\"auto\">prices</code> array and displays \u201cfound\u201d and the value\u2019s index in a label, or \u201cnot found\u201d otherwise.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example: Find index of array element\")\narray&lt;float&gt; prices = array.from(100.5, 101.2, 102.8, 100.5)\nfloat searchValue = input(101.2, \"Value to Search For\")\nint indexFound = array.indexof(prices, searchValue)\nif barstate.islast\n    string lblString = switch\n        indexFound &lt; 0 =&gt; \"Search value: not found\"\n        =&gt;                \"Search value: found\\n       Index: \" + str.tostring(indexFound)\n    label.new(bar_index, high, lblString,\n         textcolor        = color.white,\n         textalign        = text.align_left,\n         text_font_family = font.family_monospace\n     )</div>\n<h3 class=\"md-heading\" id=\"binary-search\"><a href=\"#binary-search\">Binary search<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If the script requires the position of the element in a sorted array, the function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search\">array.binary_search()</a> returns the index of a value more efficiently than <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a>. The performance improvement is significant for large arrays. If the value is not found, the function returns <code dir=\"auto\">-1</code>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The array must be of type \u201cint\u201d or \u201cfloat\u201d and must be <a href=\"/pine-script-docs/v5/language/arrays/#sorting\">sorted</a> in ascending order for <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search\">array.binary_search()</a> to work.</p></div></aside>\n<p>This script uses a binary search to find the value <code dir=\"auto\">100.5</code> within an array of prices. The script displays the original array, the sorted array, the target value (100.5), and the result of the search.\nIf the value is found, it displays \u201cfound\u201d, along with the index of the value. If the value is not found, it displays \u201cnot found\u201d.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Example: Binary search in sorted array\")\narray&lt;float&gt; sortedPrices = array.from(100.5, 102.3, 98.7, 99.2)\nstring originalArrayString = str.tostring(sortedPrices)\nfloat searchValue = input(100.5)\n// Ensure that the array is sorted (order is ascending by default); this step is crucial for binary search.\narray.sort(sortedPrices)\nstring sortedArrayString = str.tostring(sortedPrices)\nint searchValueIndex = array.binary_search(sortedPrices, searchValue)\nbool valueFound = searchValueIndex &gt;= 0\nif barstate.islast\n    string lblTxt =\n     str.format(\"Original array: {0}\\n  Sorted Array: {1}\\n  Search value: {2}\\n   Value found: {3}\\n      Position: {4}\",\n         originalArrayString,\n         sortedArrayString,\n         searchValue,\n         valueFound,\n         searchValueIndex\n     )\n    label.new(bar_index, high, lblTxt,\n         textcolor        = color.white,\n         textalign        = text.align_left,\n         text_font_family = font.family_monospace\n     )</div>\n<p>If a script does not need the exact value, the functions <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search_leftmost\">array.binary_search_leftmost()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search_rightmost\">array.binary_search_rightmost()</a> provide an effective way to locate the nearest index to a given value in sorted arrays.\nThese functions return the index of the value, if it is present. If the value is not present, they return the index of the element that is closest to the search value on the left (smaller) or right (larger) side.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-debug-arrays\"><a href=\"#how-can-i-debug-arrays\">How can I debug arrays?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To debug arrays, scripts need to display the contents of the array at certain points in the script.\nTechniques that can display the contents of arrays include using plots, labels, tables, and Pine Logs.</p>\n<p>For information about commonly encountered array-related errors, refer to the array <a href=\"/pine-script-docs/v5/language/arrays/#error-handling\">Error Handling</a> section in the User Manual.</p>\n<h3 class=\"md-heading\" id=\"plotting\"><a href=\"#plotting\">Plotting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> function to inspect the contents of an array can be helpful because this function can show numerical values on the script\u2019s status line, the price\nscale, and the Data Window. It is also easy to review historical values.</p>\n<p>Limitations of this approach include:</p>\n<ul>\n<li>Arrays must be of type <a href=\"/pine-script-docs/v5/language/type-system/#float\">\u201cfloat\u201d</a> or <a href=\"/pine-script-docs/v5/language/type-system/#int\">\u201cint\u201d</a>.</li>\n<li>The number of plots used for debugging counts towards the <a href=\"/pine-script-docs/v5/concepts/plots/#plot-count-limit\">plot limit for a script</a>.</li>\n<li>Plot calls must be in the global scope and scripts cannot call them conditionally. Therefore, if the size of the array varies across bars, using this technique can be impractical.</li>\n</ul>\n<p>Here we populate an array with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> (OHLC) prices on each bar. The script retrieves all the elements of the array and plots them on the chart.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plot array elements\")\narray&lt;float&gt; ohlc = array.from(open, high, low, close)\nplot(ohlc.get(0), \"Open\",  color.red)\nplot(ohlc.get(1), \"High\",  color.yellow)\nplot(ohlc.get(2), \"Low\",   color.blue)\nplot(ohlc.get(3), \"Close\", color.green)</div>\n<h3 class=\"md-heading\" id=\"using-labels\"><a href=\"#using-labels\">Using labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Using <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> to display array values on certain bars is particularly useful for non-continuous data points or to view all elements of an array simultaneously.\nScripts can create labels within any local scope, including <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and <a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>. Scripts can also position drawings at any available chart location, irrespective of the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.\nUnlike plots, labels can display the contents of a variety of array types, including boolean and string arrays.</p>\n<p>Limitations of using labels include:</p>\n<ul>\n<li>Pine labels display only in the chart pane.</li>\n<li>Scripts can display only up to a <a href=\"/pine-script-docs/v5/writing/limitations/#line-box-polyline-and-label-limits\">maximum number of labels</a>.</li>\n</ul>\n<p>In the following example script, we monitor the close price at the last four moving average (MA) crosses in a queued array and use a label to display this array from a local scope whenever a cross occurs:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array elements in a label\", overlay = true)\n\nvar array&lt;float&gt; crossPrices = array.new&lt;float&gt;(4)\n\nfloat fastMa = ta.ema(close, 9)\nfloat slowMa = ta.ema(close, 21)\n\nif ta.cross(fastMa, slowMa)\n    crossPrices.push(close)\n    crossPrices.shift()\n    label.new(bar_index, high, str.tostring(crossPrices), textcolor = color.white)\n\nplot(fastMa, \"Fast MA\", color.aqua)\nplot(slowMa, \"Slow MA\", color.orange)</div>\n<p>For more information, see the <a href=\"/pine-script-docs/v5/writing/debugging/#using-labels\">debugging with labels</a> section in the User Manual.</p>\n<h3 class=\"md-heading\" id=\"using-label-tooltips\"><a href=\"#using-label-tooltips\">Using label tooltips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If programmers want to be able to inspect the values in an array on every bar, displaying the contents of the array in a label is not convenient, because the labels overlap and become difficult to read.\nIn this case, displaying the array contents in a label tooltip can be visually clearer. This method has the same advantages and limitations as <a href=\"/pine-script-docs/v5/faq/data-structures/#using-labels\">using labels</a> in the section above.</p>\n<p>This example script plots a fast and a slow moving average (MA). It maintains one array of the most recent three values of the fast MA, and one array for the slow MA. The script prints empty labels on each bar.\nThe tooltip shows the values of the MA arrays and whether or not the MAs crossed this bar. The labels are displayed in a semi-transparent color, and the tooltip is visible only when the cursor hovers over the label.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array elements in a label tooltip\", overlay = true)\n\n// Create two arrays to hold the MA values.\nvar array&lt;float&gt; fastMaValues = array.new&lt;float&gt;(3)\nvar array&lt;float&gt; slowMaValues = array.new&lt;float&gt;(3)\n\n// Calculate the MAs.\nfloat fastMa = ta.ema(close, 9)\nfloat slowMa = ta.ema(close, 21)\n\n// Load the current MA values into the arrays.\nfastMaValues.push(math.round(fastMa,2)), slowMaValues.push(math.round(slowMa,2))\n// Remove the first element to keep the arrays at the same size.\nfastMaValues.shift(),  slowMaValues.shift()\n// Define the string to print in the label tooltip.\nstring labelString = str.format(\"Fast MA array: {0}\\n  Slow MA array: {1}\\n  Crossed this bar? {2}\",\n  str.tostring(fastMaValues),\n  str.tostring(slowMaValues),\n  ta.cross(fastMa, slowMa))\n//Print the labels.\nlabel.new(bar_index, high, text=\"\", color=color.new(chart.fg_color,90), textcolor = chart.fg_color, tooltip=labelString)\n\nplot(fastMa, \"Fast MA\", color.aqua)\nplot(slowMa, \"Slow MA\", color.orange)</div>\n<h3 class=\"md-heading\" id=\"using-tables\"><a href=\"#using-tables\">Using tables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Using <a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a> for debugging offers a more organized and scalable alternative to labels. Tables can display multiple <a href=\"/pine-script-docs/v5/language/type-system/#series\">\u201cseries\u201d</a> strings in a clear format that remains unaffected by the chart\u2019s scale or the index of the bars.</p>\n<p>Limitations of using tables for debugging include that, unlike labels, the state of a table can only be viewed from the most recent script execution, making it hard to view historical data.\nAdditionally, tables are computationally more expensive than other debugging methods and can require more code.</p>\n<p>In the following example script, we create and display two unrelated arrays, to show how flexible this approach can be. The first array captures the times of the last six bars where a Golden Cross occurred. The second array records the last eight bar indices where the Relative Strength Index (RSI) reached new all-time highs within the chart\u2019s history. We use the <code dir=\"auto\">whenSince()</code> function from the PineCoders\u2019 <a href=\"https://www.tradingview.com/script/Bn7QkdZR-getSeries/\">getSeries</a> library to create and update the arrays. This function treats the arrays as <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queues</a>, and limits their size.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debugging arrays with tables\", overlay = true)\n\n// Import the `getSeries` PineCoders library to build fixed-size arrays populated on specific conditions.\n//      https://www.tradingview.com/v/Bn7QkdZR/\nimport PineCoders/getSeries/1 as PCgs\n\n// Calculate MAs and create cross condition.\nfloat ma50        = ta.sma(close,  50)\nfloat ma200       = ta.sma(close,  200)\nbool  goldenCross = ta.cross(ma50, ma200)\n\n// Calculate the RSI and determine if it's hitting a new all-time high.\nfloat myRsi       = ta.rsi(close,  20)\nbool newRsiAth    = myRsi == ta.max(myRsi)\n\n// Create two arrays using the imported `whenSince()` function.\narray&lt;float&gt; goldenCrossesTimes = PCgs.whenSince(time_close, goldenCross, length = 6)\narray&lt;float&gt; barIndicesOfHiRSIs = PCgs.whenSince(bar_index,  newRsiAth,   length = 8)\n\n// Plot the MAs for cross reference.\nplot(ma50,  \"50 MA\",  color.aqua)\nplot(ma200, \"200 MA\", color.orange)\n\n// On the last historical bar, display the date and time of the last crosses.\nif barstate.islast\n    // Declare our MA table to display the Golden Cross times. \n    var table maTable  = table.new(position.top_right, 2, 8, color.new(color.black, 100), color.gray, 1, color.gray, 1)\n    // Create a title cell for the MA table and merge cells to form a banner two cells wide.\n    table.cell(maTable , 0, 0, \"Golden Cross Times\", text_color = color.black, bgcolor = #FFD700)\n    table.merge_cells(maTable , 0, 0, 1, 0)\n    // Loop the array and write cells to the MA table containing the cross time for each element of the array. Number each element in the left row.\n    // Format the UNIX time value to a formatted time string using `str.format_time()`.\n    for [i, timeValue] in goldenCrossesTimes\n        table.cell(maTable, 0, i + 1, str.tostring(i + 1), text_color = #FFD700)\n        table.cell(maTable, 1, i + 1, str.format_time(int(timeValue), \"yyyy.MM.dd 'at' HH:mm:ss z\"), text_color = chart.fg_color)\n    // Create a second table to display the indices of the last eight RSI all-time highs.\n    var table rsiTable = table.new(position.bottom_right, 1, 1, color.new(color.black, 100), color.gray, 1, color.gray, 1)\n    table.cell(rsiTable, 0, 0, \"Bar indices of RSI ATHs\\n\" + str.tostring(barIndicesOfHiRSIs), text_color = chart.fg_color)</div>\n<h3 class=\"md-heading\" id=\"using-pine-logs\"><a href=\"#using-pine-logs\">Using Pine Logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> are messages that display in the Pine Logs pane, along with a timestamp when the logging function was called.\nScripts can create log messages at specific points during the execution of a script. Pine Logs can display any script values or variables at any part of your code, including <a href=\"/pine-script-docs/v5/writing/debugging/#local-drawings-and-logs\">local scopes</a>, <a href=\"/pine-script-docs/v5/writing/debugging/#debugging-functions\">functions</a>, and <a href=\"/pine-script-docs/v5/writing/debugging/#debugging-loops\">loops</a>.</p>\n<p>By logging messages to the console whenever there is a modification to the array, programmers can track the logical flow of array operations in much more detail than by using other approaches.</p>\n<p>The script below updates a previous example script from the section on <a href=\"/pine-script-docs/v5/faq/data-structures/#what-are-queues-and-stacks\">queues and stacks</a> to add logging. It uses arrays as <a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-stack\">stacks</a> to track lines drawn from pivot points. When a pivot occurs, the script adds a new line to the stack and continues to extend the lines on each bar until an intersection with price occurs. If an intersection is found, the script removes (pops) the intersected line from the stack, meaning it will no longer be extended with new bars.</p>\n<p>The <a href=\"/pine-script-docs/v5/writing/debugging/#creating-logs\">console messages</a> are time stamped and offer detailed information about when elements are added to and removed from the arrays, the current size of the arrays, and the specific prices at which elements were added.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1288\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-How-do-i-debug-arrays-1.BCL_wjfL_SSFpt.webp\" width=\"2364\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Array as a stack\", overlay = true)\n\n// @function                Adds a new horizontal line to an array of lines at a specified pivot level.\n// @param id                (array&lt;line&gt;) The array to which to add the new line.\n// @param pivot             (float) The price level at which to draw the horizontal line.\n// @param lineColor         (color) The color of the line.\n// @returns                 (void) The function has no explicit return.\nstackLine(array&lt;line&gt; id, float pivot, color lineColor) =&gt;\n    if not na(pivot)\n        array.push(id, line.new(bar_index - 10, pivot, bar_index, pivot, color = lineColor))\n        if barstate.isconfirmed\n            log.info(\"\\nNew line added at {0}\\nArray size: {1}\", pivot, id.size())\n\n// @function                Extends the endpoint (`x2`) of each line in an array to the current `bar_index`.\n// @param id                (array&lt;line&gt;) The array containing the line objects to update.\n// @returns                 (void) The function has no explicit return.\nextendLines(array&lt;line&gt; id) =&gt;\n    for eachLine in id\n        eachLine.set_x2(bar_index)\n\n// @function                Removes line objects from an array if they are above or below the current bar's high or low.\n// @param id                (array&lt;line&gt;) The array from which to remove line objects.\n// @param isBull            (bool) If true, remove bullish pivot lines below the high price;\n//                          if false, remove bearish pivot line above the low price.\n// @returns                 (void) The function has no explicit return.\nremoveLines(array&lt;line&gt; id, bool isBull) =&gt;\n    if array.size(id) &gt; 0\n        float linePrice = line.get_price(array.last(id), bar_index)\n        if isBull ? high &gt; linePrice : low &lt; linePrice\n            array.pop(id)\n            if barstate.isconfirmed\n                log.warning(\n                 \"\\nLine removed from {0} array.\\nPrice breached {1}\\nArray size: {2}\", \n                 isBull ? \"Highs\" : \"Lows\", linePrice, id.size())\n\n// Find the pivot high and pivot low prices.\nfloat pivotLo = ta.pivotlow(10,  10), float pivotHi = ta.pivothigh(10, 10)\n\n// Initialize two arrays on the first bar to stack our lines in.\nvar array&lt;line&gt; pivotHiArray = array.new&lt;line&gt;()\nvar array&lt;line&gt; pivotLoArray = array.new&lt;line&gt;()\n\n// If a pivot occurs, draw a line from the pivot to the current bar and add the line to the stack.\nstackLine(pivotHiArray, pivotHi, color.orange), stackLine(pivotLoArray, pivotLo, color.aqua)\n\n// Extend all lines in each array to the current bar on each bar.\nextendLines(pivotHiArray), extendLines(pivotLoArray)\n\n// Check the final element of each array. If price exceeded the pivot lines, pop the line off the stack.\nremoveLines(pivotHiArray, true), removeLines(pivotLoArray, false)</div>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-use-matrices-or-multidimensional-arrays-in-pine-script\"><a href=\"#can-i-use-matrices-or-multidimensional-arrays-in-pine-script\">Can I use matrices or multidimensional arrays in Pine Script?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script does not directly support multidimensional arrays; however, it provides <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> and <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> (UDTs).\nProgrammers can use these data structures to create and manipulate complex datasets.</p>\n<p><strong>Matrices</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Pine Script <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> are like two-dimensional arrays. They organize data in a rectangular grid, facilitating operations like transformations, linear algebra, and other complex calculations. They are particularly useful for quantitative modeling, such as portfolio optimization, correlation matrix analysis, and more.\nJust as in <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, all elements in a matrix must be of the same <a href=\"/pine-script-docs/v5/language/type-system/#types\">type</a>, which can be a built-in or a <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined</a> type. Pine Script provides a range of functions for <a href=\"/pine-script-docs/v5/language/matrices/#manipulating-a-matrix\">manipulating</a> and performing <a href=\"/pine-script-docs/v5/language/matrices/#matrix-calculations\">calculations</a> on matrices, including addition, subtraction, multiplication, and more.</p>\n<p><strong>Using UDTs for multidimensional structures</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Programmers can achieve similar functionality to multidimensional arrays through defining <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> (UDTs). For example, a script can define a UDT that includes an array as one of its fields. UDTs themselves can be contained in arrays. In this way, scripts can effectively have arrays of arrays.</p>\n<p>For more information, see the sections on <a href=\"/pine-script-docs/v5/language/matrices/\">Matrices</a>, <a href=\"/pine-script-docs/v5/language/maps/\">Maps</a>, and <a href=\"/pine-script-docs/v5/language/objects/\">Objects</a> in the User Manual.</p>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/data-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-debug-objects\"><a href=\"#how-can-i-debug-objects\">How can I debug objects?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To debug <a href=\"/pine-script-docs/v5/language/objects/\">objects</a>, create custom functions that break down an object into its constituent fields and convert these fields into strings.\nSee the <a href=\"/pine-script-docs/v5/writing/debugging/\">Debugging</a> section of the User Manual for information about methods to display debug information.\nIn particular, <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> can display extensive and detailed debug information. See the FAQ section about debugging arrays <a href=\"/pine-script-docs/v5/faq/data-structures/#using-pine-logs\">using Pine Logs</a> for an explanation of using logs for debugging.</p>\n<p>In our example script, we create a <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> (UDT) named <code dir=\"auto\">openLine</code>, which includes fields such as <code dir=\"auto\">price</code>, <code dir=\"auto\">openTime</code>, and a line object called <code dir=\"auto\">level</code>.\nOn the first bar of each session, the script initializes a new <code dir=\"auto\">openLine</code> instance. This object tracks the session\u2019s opening price and time, and it draws a line at the open price, extending from the session\u2019s start to\nits close. An array stores each <code dir=\"auto\">openLine</code> object. A custom function <code dir=\"auto\">debugOpenLine()</code> breaks an <code dir=\"auto\">openLine</code> object into its individual fields, converts the fields to strings, and then logs a message that displays these strings in the console.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1288\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Data-structures-How-can-i-debug-objects-1.C0Wd6CjK_o8uds.webp\" width=\"2364\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debugging objects\", overlay = true)\n\n// Define the user-defined type.\ntype openLine\n    float price\n    int   openTime\n    line  level\n\n// @function            Queues a new `arrayElement` at the end of the `id` array and removes\n//                      the first element if the array size exceeds the specified `maxSize`.\n// @param id            (&lt;any array type&gt;) The array in which the element is queued.\n// @param maxSize       (int) The maximum allowed number of elements in the array.\n//                      If the array exceeds this size, the first element is removed.\n// @param arrayElement  (&lt;array type) The new element to add to the array.\n// @returns             (&lt;array type&gt;) The removed element.\narrayQueue(id, int maxSize, value) =&gt;\n    id.push(value)\n    if id.size() &gt; maxSize\n        id.shift()\n\n// @function            Logs detailed information about an open line object for debugging purposes.\n// @param ol            (openLine) The open line object to log.\n// @returns             (void) Function has no explicit return.\ndebugOpenLine(openLine ol) =&gt;\n    if barstate.isconfirmed\n        log.info(\"\\nprice: {0}\\nopenTime: {1}\\nlevel line coords:\\nx1: {2}\\ny1: {3}\\nx2: {4}\\ny2: {5}\",\n             ol.price, ol.openTime, str.format_time(ol.level.get_x1()), ol.level.get_y1(),\n             str.format_time(ol.level.get_x2()), ol.level.get_y2())\n\n// Create an empty `openLine` array.\nvar openLineArray = array.new&lt;openLine&gt;()\n\n// On session start, create a new `openLine` object and add it to the array.\n// Use the custom debug function to print the object's fields to the Pine Logs pane.\nif session.isfirstbar_regular\n    openLine ol = openLine.new(open, time)\n    ol.level := line.new(time, open, time_close(\"D\"), open, xloc.bar_time, color = color.aqua)\n    arrayQueue(openLineArray, 4, ol)\n    debugOpenLine(ol)</div>", "segment_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "e9531e0fd98417b8220c949ad4ac0ae07fe885f94446d4a5abc4e69e64772611", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/functions\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"functions\"><a href=\"#functions\">Functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-use-a-variable-length-in-functions\"><a href=\"#can-i-use-a-variable-length-in-functions\">Can I use a variable length in functions?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Many <a href=\"/pine-script-docs/v5/language/built-ins/#built-in-functions\">built-in</a> technical analysis (TA) functions have a <code dir=\"auto\">length</code> parameter, such as <code dir=\"auto\">ta.sma(source, length)</code>.\nA majority of these functions can process \u201c<a href=\"/pine-script-docs/v5/language/type-system/#series\">series</a>\u201d lengths, i.e., lengths that can change from bar to bar.\nSome functions, however, only accept \u201c<a href=\"/pine-script-docs/v5/language/type-system/#simple\">simple</a>\u201d integer lengths, which must be known on bar zero and not change during the execution of the script.</p>\n<p>Check the Reference Manual entry for a function to see what type of values a function can process.</p>\n<p><strong>Additional resources</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>For more advanced versions of functions that support \u201cseries\u201d lengths, or for extra technical analysis tools explore the <a href=\"https://www.tradingview.com/script/BICzyhq0-ta/\">ta library</a> on the TradingView profile.\nThis library offers a range of extended TA-related capabilities and custom implementations.</p>\n<p><strong>User-defined functions</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>For built-in functions that do not accept \u201cseries\u201d lengths and for which the functionality is not available in the <a href=\"https://www.tradingview.com/script/BICzyhq0-ta/\">ta library</a>, consider creating a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a>.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-calculate-values-depending-on-variable-lengths-that-reset-on-a-condition\"><a href=\"#how-can-i-calculate-values-depending-on-variable-lengths-that-reset-on-a-condition\">How can I calculate values depending on variable lengths that reset on a condition?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To calculate certain values that are dependent on varying lengths, which also reset under specific conditions, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.barssince\">ta.barssince()</a>\nfunction can be useful.\nThis function counts the number of bars since the last occurrence of a specified condition, automatically resetting the count each time this condition is met.\nThere are, however, some considerations to take into account when using this function for this purpose.</p>\n<p>Firstly, before the condition is met for the first time in a chart\u2019s history, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.barssince\">ta.barssince()</a> returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>. This value is not usable as a length for functions and can cause errors, especially during execution on a chart\u2019s early bars.\nFor a more robust version, use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> to replace the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> return of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.barssince\">ta.barssince()</a> with zero for early bars.</p>\n<p>Secondly, when the condition is met, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.barssince\">ta.barssince()</a> returns zero for that bar, since zero bars have elapsed since the condition was last true.</p>\n<p>Since lengths cannot be zero, it is necessary to add one to a returned value of zero, ensuring that the length is always at least one.</p>\n<p>Here\u2019s an example of how to use these principles for a practical purpose. The following example script calculates the highest and lowest price points since the start of a new day.\nWe use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.change\">timeframe.change()</a> to detect the start of a new day, which is our condition.\nThe <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.barssince\">ta.barssince()</a> function calculates the number of bars that elapsed since this condition was last met.\nThe script passes this number, or \u201clookback\u201d, to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.lowest\">ta.lowest()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\nfunctions, which determine the highest and lowest points since the start of the new day:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1276\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Functions-How-can-i-calculate-values-depending-on-variable-lengths-that-reset-on-a-condition-1.BG9cnL10_Z2jJ0Tt.webp\" width=\"2356\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Highest/lowest since new day\", \"\", true)\n\n// Identify the start of a new day and calculate the number of bars since then.\nbool newDay  = timeframe.change(\"D\")\nint lookback = nz(ta.barssince(newDay)) + 1\n\n// Calculate the highest and lowest point since the new day began.\nfloat lowestSinceNewDay  = ta.lowest(lookback)\nfloat highestSinceNewDay = ta.highest(lookback)\n\n// Plot the high/low level since the start of a new day.\nplot(lowestSinceNewDay, \"High today\", color.orange)\nplot(highestSinceNewDay, \"Low today\", color.aqua)\n// Change the background color to indicate the start of a new day.\nbgcolor(newDay ? color.new(color.gray, 80) : na)\n// Display the varying lookback period in Data Window.\nplot(lookback, \"Lookback\", display = display.data_window)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>When scripts pass variable lengths to built-in functions, an error can occur if the specified number of bars back is excessively large and increases dynamically and unpredictably.\nThe error message \u201c<em>Pine cannot determine the referencing length of a series. Try using max_bars_back</em>\u201d indicates this issue. For more information on resolving this problem, refer to the\n<a href=\"https://www.tradingview.com/support/solutions/43000587849-i-see-pine-cannot-determine-the-referencing-length-of-a-series-try-using-max-bars-back-error/\">Help Center</a> article and\n<a href=\"/pine-script-docs/v5/error-messages/#pine-script-cannot-determine-the-referencing-length-of-a-series-try-using-max_bars_back-in-the-indicator-or-strategy-function\">User Manual</a>\nentry on the topic.</p></div></aside>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-round-a-number-to-x-increments\"><a href=\"#how-can-i-round-a-number-to-x-increments\">How can I round a number to x increments?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Rounding numbers to specific increments is useful for tasks like calculating levels for grid trading, dealing with fractional shares, or aligning trading parameters to specific pip values.</p>\n<p>In this example, the <code dir=\"auto\">roundToIncrement()</code> function accepts a value and an increment as parameters. It divides the value by the increment, rounds the result, then multiplies it by the increment to give the rounded value.\nTo demonstrate the function, the closing price is rounded to the nearest increment defined in the user menu:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Round to x increment demo\", overlay = true)\n\nfloat incrementInput = input.float(0.75, \"Increment\", step = 0.25)\n\n// @function                Rounds a value to the nearest multiple of a specified increment.\n// @param value             The value to round.\n// @param increment         The increment to round the value to.\n// @returns                 The rounded value.\nroundToIncrement(value, increment) =&gt;\n    math.round(value / increment) * increment\n\nplot(series = roundToIncrement(close, incrementInput), color = chart.fg_color)</div>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-control-the-precision-of-values-my-script-displays\"><a href=\"#how-can-i-control-the-precision-of-values-my-script-displays\">How can I control the precision of values my script displays?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">precision</code> and <code dir=\"auto\">format</code> arguments in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement control the number of decimals in the values that a script displays.</p>\n<p>By default, scripts use the precision of the price scale. To display more decimal places, specify a <code dir=\"auto\">precision</code> argument that exceeds the value of the current price scale.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-control-the-precision-of-values-used-in-my-calculations\"><a href=\"#how-can-i-control-the-precision-of-values-used-in-my-calculations\">How can I control the precision of values used in my calculations?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">math.round(number, precision)</code> variation of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.round\">math.round()</a> function rounds values according to a specified precision.\nAlternatively, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.round_to_mintick\">math.round_to_mintick()</a> function rounds values to the nearest tick precision of the chart\u2019s symbol.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-round-to-ticks\"><a href=\"#how-can-i-round-to-ticks\">How can I round to ticks?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To round values to the tick precision of a chart\u2019s symbol, use the function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.round_to_mintick\">math.round_to_mintick()</a>.\nTo convert the resulting number to a string, use <code dir=\"auto\">str.tostring(myValue, format.mintick)</code> to first round the number to tick precision and then return its string representation, where <code dir=\"auto\">myValue</code> is the number to convert into a rounded string.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-abbreviate-large-values\"><a href=\"#how-can-i-abbreviate-large-values\">How can I abbreviate large values?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are different ways to abbreviate large numerical values, such as volume. For instance, the number 1,222,333.0 can be simplified to 1.222M.\nHere are some methods to accomplish this:</p>\n<p><strong>Apply a global setting</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Use the argument <code dir=\"auto\">format = format.volume</code> within either the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> statements. Using this setting, displays all values in the script in their abbreviated forms.</p>\n<p><strong>Abbreviate specific values</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To abbreviate only certain values for string display, use the <code dir=\"auto\">str.tostring(value, format.volume)</code> function.</p>\n<p><strong>Use a custom function</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To specify a custom precision or abbreviate values up to trillions, use a custom function. In the following example script, the <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> <code dir=\"auto\">abbreviateValue()</code> divides the <code dir=\"auto\">value</code> by a power of ten based on its magnitude, and adds an abbreviation letter (K, M, B, or T) to represent the magnitude of the original value.\nThe function also adds a subtle space between the value and the magnitude letter. The <code dir=\"auto\">print()</code> function displays the value on the chart for visualization.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Value abbreviation example\")\n\n// @function            Converts a numeric value into a readable string representation featuring the appropriate order\n//                          of magnitude abbreviation (K, M, B, T).\n// @param value         (float) The value to format.\n// @param precision         (string) The numerical precision of the result. (\"\" for none, \".00\" for two digits, etc.)\n// @returns                 (string) The formatted value as a string with the appropriate abbreviation suffix.\nabbreviateValue(float value, string precision) =&gt;\n    float digitsAmt = math.log10(math.abs(value))\n    string formatPrecision = \"#\" + precision\n    string result = switch\n        digitsAmt &gt; 12 =&gt; str.tostring(value / 1e12, formatPrecision + \"\u200a\u200aT\")\n        digitsAmt &gt; 9  =&gt; str.tostring(value / 1e9,  formatPrecision + \"\u200a\u200aB\")\n        digitsAmt &gt; 6  =&gt; str.tostring(value / 1e6,  formatPrecision + \"\u200a\u200aM\")\n        digitsAmt &gt; 3  =&gt; str.tostring(value / 1e3,  formatPrecision + \"\u200a\u200aK\")\n        =&gt;                str.tostring(value, \"#\" +  formatPrecision)\n\nprint(formattedString) =&gt;\n    var table t = table.new(position.middle_right, 1, 1)\n    table.cell(t, 0, 0, formattedString, bgcolor = color.yellow)\n\nprint(abbreviateValue(volume, \".00\"))</div>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-calculate-using-pips\"><a href=\"#how-can-i-calculate-using-pips\">How can I calculate using pips?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Use the custom function <code dir=\"auto\">calcBaseUnit()</code> in the following example script to return the correct pip value for Forex symbols, or the base unit of change for non-forex symbols:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pip calculation example\")\n\n// @function            Calculates the chart symbol's base unit of change in asset prices.\n// @returns             (float) A ticks or pips value of base units of change.\ncalcBaseUnit() =&gt;\n    bool isForexSymbol = syminfo.type         == \"forex\"\n    bool isYenQuote    = syminfo.currency     == \"JPY\"\n    bool isYenBase     = syminfo.basecurrency == \"JPY\"\n    float result = isForexSymbol ? isYenQuote ? 0.01 : isYenBase ? 0.00001 : 0.0001 : syminfo.mintick\n\n// Call the function and plot the result in a label\nvar label baseUnitLabel = na\nif barstate.islast\n    baseUnitLabel := label.new(x=bar_index + 1, y=open, text=\"Base Unit: \" + str.tostring(calcBaseUnit(), \"#.######\"), \n      style=label.style_label_left, color=color.new(color.blue, 0), textcolor=color.white)\n    label.delete(baseUnitLabel[1])</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This function might not address all potential scenarios, so confirm the results with your broker to ensure the function\u2019s output matches the broker\u2019s values.</p></div></aside>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-do-i-calculate-averages\"><a href=\"#how-do-i-calculate-averages\">How do I calculate averages?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The method of calculating averages depends on the type of values to average.</p>\n<p><strong>Distinct variables</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To find the average of a small number of discrete variables, use the function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.avg\">math.avg(number0, number1, \u2026)</a>.\nSimply pass each of the variables as an argument to this function.</p>\n<p><strong>Bar prices</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To find the average price of a single bar, use the built-in variables <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>.</p>\n<p><strong>Series values</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To compute the average of the last <em>n</em> values in a series, use the function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(series,n)</a>.</p>\n<p><strong>Custom datasets</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>To average a custom set of values, organize them into an <a href=\"/pine-script-docs/v5/language/arrays/\">array</a> and use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">array.avg()</a>. For complex datasets, programmers can use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.avg\">matrix.avg()</a> function to average the contents of a matrix. For a deeper understanding of averaging custom datasets, refer to  this <a href=\"https://www.tradingview.com/script/9l0ZpuQU-ConditionalAverages/\">conditional averages</a> publication.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-calculate-an-average-only-when-a-certain-condition-is-true\"><a href=\"#how-can-i-calculate-an-average-only-when-a-certain-condition-is-true\">How can I calculate an average only when a certain condition is true?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The usual methods of calculating averages, which were discussed in the <a href=\"/pine-script-docs/v5/faq/functions/#how-do-i-calculate-averages\">calculating averages section</a> above, apply across <em>all</em> data points in a range.\nTo calculate averages of only those values that occur under specific conditions, calculate <em>conditional averages</em> using custom functions.</p>\n<p>The example script below imports a <a href=\"/pine-script-docs/v5/concepts/libraries/\">library</a> called <a href=\"https://www.tradingview.com/script/9l0ZpuQU-ConditionalAverages/\">ConditionalAverages</a> and uses two of its functions:</p>\n<ul>\n<li>The <code dir=\"auto\">avgWhen()</code> function calculates the average volume of session opening bars across the entire dataset.</li>\n<li>The <code dir=\"auto\">avgWhenLast()</code> function averages the opening volumes for the last five session opening bars.</li>\n</ul>\n<p>The condition for these conditional averages is <em>session opening bars</em>, which we determine using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session.isfirstbar_regular\">session.isfirstbar_regular</a> variable.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1276\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Functions-How-can-i-calculate-an-average-only-when-a-certain-condition-is-true-1.zmzMnsL2_2dPpkK.webp\" width=\"2356\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Average session opening volume\")\n\nimport PineCoders/ConditionalAverages/1 as PCca\n\n// Color aqua for the session's opening bar, otherwise distinct colors for up/down volume columns.\ncolor volumeColor = switch\n    session.isfirstbar_regular =&gt; color.aqua\n    close &gt; open               =&gt; color.new(#D1D4DC, 65)\n    =&gt;                            color.new(#787B86, 65)\n\n// Plot the volume columns.\nplot(volume, \"volume\", volumeColor, 4, plot.style_histogram)\n// Average volume over *all* session opening bars in the dataset.\nplot(PCca.avgWhen(src = volume, cond = session.isfirstbar_regular), \"avg. When\", #FF00FF)\n// Average volume over the last five opening bars.\nplot(PCca.avgWhenLast(src = volume, cond = session.isfirstbar_regular, cnt = 5), \"avgWhenInLast()\", #00FF00)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The <a href=\"https://www.tradingview.com/script/9l0ZpuQU-ConditionalAverages/\">ConditionalAverages</a> and <a href=\"https://www.tradingview.com/script/Bn7QkdZR-getSeries/\">getSeries</a> libraries by PineCoders offer additional functions for conditional averaging and the creation of custom datasets.</p></div></aside>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-generate-a-random-number\"><a href=\"#how-can-i-generate-a-random-number\">How can I generate a random number?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">math.random()</a> function to generate random numbers.\nThis example script creates a circle plot with random RGB color values and a random y value between 0 and 1:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Random demo\", overlay = false)\n\n// Generate a random price value (the default range is 0 to 1).\nfloat y = math.random()\n// Generate a color with red, green, and blue values as separate random values between 0 and 255.\ncolor plotColor = color.rgb(math.random(0, 255), math.random(0, 255), math.random(0, 255))\nplot(series = y, title = \"Random number\", color = plotColor, linewidth = 2, style = plot.style_circles)</div>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-evaluate-a-filter-i-am-planning-to-use\"><a href=\"#how-can-i-evaluate-a-filter-i-am-planning-to-use\">How can I evaluate a filter I am planning to use?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To evaluate a filter, insert your filter code into the <a href=\"https://www.tradingview.com/script/oTEP9DJF-Filter-Information-Box-PineCoders-FAQ/\">Filter Information Box - PineCoders FAQ</a> script.\nThis script conducts an impulse response analysis and shows the filter\u2019s characteristics in a label on the chart.</p>\n<p>For further details and a guide on integrating your filter into the code, refer to the publication\u2019s description.</p>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-does-nz-do\"><a href=\"#what-does-nz-do\">What does nz() do?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> function replaces any <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values with zero, or with a user-defined value if the <code dir=\"auto\">replacement</code> argument is specified. This function helps to prevent <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values from interfering with calculations.</p>\n<p>The following example script shows an exaggerated failure as a result of a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value. The <code dir=\"auto\">barRangeRaw</code> variable is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> only once, on the first bar, because it references a bar that does not exist, using the history-referencing operator. The alternative variable <code dir=\"auto\">barRangeWithNz</code> uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> to prevent an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value from ever occurring.</p>\n<p>The <code dir=\"auto\">dependentCalculation</code> variable takes one of these values and uses it to calculate a crude average of the bar range.\nIf the input to this calculation is ever <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, the series will be <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> forever after that.</p>\n<p>Choose between the two values for bar range using the input setting, and the range either displays or not. In the latter case, the Data Window shows that the value of <code dir=\"auto\">dependentCalculation</code> is <code dir=\"auto\">\u03f4</code>, meaning <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`na` values on first bar demo\")\n\nbool useNzInput = input.bool(true, \"Use `nz` to ensure value is never na\")\n\n// This variable is na on the first bar.\nfloat barRangeRaw = close - close[1]\n// This variable is never na.\nfloat barRangeWithNz = close - nz(close[1], open)\n// Choose the value to use based on the input\nfloat barRange = useNzInput ? barRangeWithNz : barRangeRaw\n\n// Perform a calculation that depends on the barRange\nvar float dependentCalculation = 0\ndependentCalculation := ((dependentCalculation + barRange)/2)\n// Plot the results\nplot(dependentCalculation, title=\"Average Bar Range\")</div>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> function is also useful to protect against any potential divide-by-zero errors. It guarantees a return value even when an equation unintentionally features a zero in the denominator. Consider the following code snippet that intentionally creates a divide-by-zero\nscenario by setting the denominator to zero. Without the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> function, this expression would return <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\ninstead of zero:</p>\n<div class=\"pine-colorizer not-content\">float dbzTest = nz(close / (close - close))</div>", "segment_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90:14", "segment_order": 14, "segment_type": "guide_section", "source_artifact_id": "78bf1cc6d99eee978605164febbac9e27607e65a3368aa572023533117d08d90", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/general\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"faq\"><a href=\"#faq\">FAQ<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-real-ohlc-price-on-a-heikin-ashi-chart\"><a href=\"#get-real-ohlc-price-on-a-heikin-ashi-chart\">Get real OHLC price on a Heikin Ashi chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Suppose, we have a Heikin Ashi chart (or Renko, Kagi, PriceBreak etc)\nand we\u2019ve added a Pine script on it:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Visible OHLC\", overlay=true)\nc = close\nplot(c)</div>\n<p>You may see that variable <code dir=\"auto\">c</code> is a Heikin Ashi <em>close</em> price which is\nnot the same as real OHLC price. Because <code dir=\"auto\">close</code> built-in variable is\nalways a value that corresponds to a visible bar (or candle) on the\nchart.</p>\n<p>So, how do we get the real OHLC prices in Pine Script\u00ae code, if current\nchart type is non-standard? We should use <code dir=\"auto\">request.security</code> function in\ncombination with <code dir=\"auto\">ticker.new</code> function. Here is an example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Real OHLC\", overlay = true)\nt = ticker.new(syminfo.prefix, syminfo.ticker)\nrealC = request.security(t, timeframe.period, close)\nplot(realC)</div>\n<p>In a similar way we may get other OHLC prices: <em>open</em>, <em>high</em> and <em>low</em>.</p>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-non-standard-ohlc-values-on-a-standard-chart\"><a href=\"#get-non-standard-ohlc-values-on-a-standard-chart\">Get non-standard OHLC values on a standard chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Backtesting on non-standard chart types (e.g. Heikin Ashi or Renko) is\nnot recommended because the bars on these kinds of charts do not\nrepresent real price movement that you would encounter while trading. If\nyou want your strategy to enter and exit on real prices but still use\nHeikin Ashi-based signals, you can use the same method to get Heikin\nAshi values on a regular candlestick chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"BarUpDn Strategy\", overlay = true, default_qty_type = strategy.percent_of_equity, default_qty_value = 10)\nmaxIdLossPcntInput = input.float(1, \"Max Intraday Loss(%)\")\nstrategy.risk.max_intraday_loss(maxIdLossPcntInput, strategy.percent_of_equity)\nneedTrade() =&gt; close &gt; open and open &gt; close[1] ? 1 : close &lt; open and open &lt; close[1] ? -1 : 0\ntrade = request.security(ticker.heikinashi(syminfo.tickerid), timeframe.period, needTrade())\nif trade == 1\n    strategy.entry(\"BarUp\", strategy.long)\nif trade == -1\n    strategy.entry(\"BarDn\", strategy.short)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-arrows-on-the-chart\"><a href=\"#plot-arrows-on-the-chart\">Plot arrows on the chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You may use plotshape with style <code dir=\"auto\">shape.arrowup</code> and <code dir=\"auto\">shape.arrowdown</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator('Ex 1', overlay = true)\ncondition = close &gt;= open\nplotshape(condition, color = color.lime, style = shape.arrowup, text = \"Buy\")\nplotshape(not condition, color = color.red, style = shape.arrowdown, text = \"Sell\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Buy_sell_chart1.CyNH3Z6U_2g4dui.webp\" width=\"1600\"/></p>\n<p>You may use the <code dir=\"auto\">plotchar</code> function with any unicode character:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator('buy/sell arrows', overlay = true)\ncondition = close &gt;= open\nplotchar(not condition, char='\u2193', color = color.lime, text = \"Buy\")\nplotchar(condition, char='\u2191', location = location.belowbar, color = color.red, text = \"Sell\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Buy_sell_chart2.bwHf9rIu_dfdYz.webp\" width=\"1600\"/></p>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-a-dynamic-horizontal-line\"><a href=\"#plot-a-dynamic-horizontal-line\">Plot a dynamic horizontal line<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There is the function <code dir=\"auto\">hline</code> in Pine Script, but it is limited to only\nplot a constant value. Here is a simple script with a workaround to plot\na changing hline:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Horizontal line\", overlay = true)\nplot(close[10], trackprice = true, offset = -9999)\n// `trackprice = true` plots horizontal line on close[10]\n// `offset = -9999` hides the plot\nplot(close, color = #FFFFFFFF)  // forces display</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"plot-a-vertical-line-on-condition\"><a href=\"#plot-a-vertical-line-on-condition\">Plot a vertical line on condition<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Vertical line\", overlay = true, scale = scale.none)\n// scale.none means do not resize the chart to fit this plot\n// if the bar being evaluated is the last baron the chart (the most recent bar), then cond is true\ncond = barstate.islast\n// when cond is true, plot a histogram with a line with height value of 100,000,000,000,000,000,000.00\n// (10 to the power of 20)\n// when cond is false, plot no numeric value (nothing is plotted)\n// use the style of histogram, a vertical bar\nplot(cond ? 10e20 : na, style = plot.style_histogram)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"access-the-previous-value\"><a href=\"#access-the-previous-value\">Access the previous value<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\n//...\ns = 0.0\ns := nz(s[1]) // Accessing previous values\nif (condition)\n    s := s + 1</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"get-a-5-days-high\"><a href=\"#get-a-5-days-high\">Get a 5-days high<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Lookback 5 days from the current bar, find the highest bar, plot a star\ncharacter at that price level above the current bar</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Wiki_howto_range_analysis.BO6M_QVQ_ZvUgTy.webp\" width=\"1600\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"High of last 5 days\", overlay = true)\n\n// Milliseconds in 5 days: millisecs * secs * mins * hours * days\nMS_IN_5DAYS = 1000 * 60 * 60 * 24 * 5\n\n// The range check begins 5 days from the current time.\nleftBorder = timenow - time &lt; MS_IN_5DAYS\n// The range ends on the last bar of the chart.\nrightBorder = barstate.islast\n\n// \u2014\u2014\u2014\u2014\u2014 Keep track of highest `high` during the range.\n// Intialize `maxHi` with `var` on bar zero only.\n// This way, its value is preserved, bar to bar.\nvar float maxHi = na\nif leftBorder\n    if not leftBorder[1]\n        // Range's first bar.\n        maxHi := high\n    else if not rightBorder\n        // On other bars in the range, track highest `high`.\n        maxHi := math.max(maxHi, high)\n\n// Plot level of the highest `high` on the last bar.\nplotchar(rightBorder ? maxHi : na, \"Level\", \"\u2014\", location.absolute, size = size.normal)\n// When in range, color the background.\nbgcolor(leftBorder and not rightBorder ? color.new(color.aqua, 70) : na)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"count-bars-in-a-dataset\"><a href=\"#count-bars-in-a-dataset\">Count bars in a dataset<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Get a count of all the bars in the loaded dataset. Might be useful for\ncalculating flexible lookback periods based on number of bars.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Bar Count\", overlay = true, scale = scale.none)\nplot(bar_index + 1, style = plot.style_histogram)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"enumerate-bars-in-a-day\"><a href=\"#enumerate-bars-in-a-day\">Enumerate bars in a day<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\", overlay = true, scale = scale.none)\n\nisNewDay() =&gt;\n    d = dayofweek\n    na(d[1]) or d != d[1]\n\nplot(ta.barssince(isNewDay()), style = plot.style_cross)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"find-the-highest-and-lowest-values-for-the-entire-dataset\"><a href=\"#find-the-highest-and-lowest-values-for-the-entire-dataset\">Find the highest and lowest values for the entire dataset<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n\nallTimetHi(source) =&gt;\n    var atHi = source\n    atHi := math.max(atHi, source)\n\nallTimetLo(source) =&gt;\n    var atLo = source\n    atLo := math.min(atLo, source)\n\nplot(allTimetHi(close), \"ATH\", color.green)\nplot(allTimetLo(close), \"ATL\", color.red)</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/general", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"query-the-last-non-na-value\"><a href=\"#query-the-last-non-na-value\">Query the last non-na value<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You can use the script below to avoid gaps in a series:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nseries = close &gt;= open ? close : na\nvw = fixnan(series)\nplot(series, style = plot.style_linebr, color = color.red)  // series has na values\nplot(vw)  // all na values are replaced with the last non-empty value</div>", "segment_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "3013203e3fae5a98f0b97431e6504f6a968d5227182a592cb664848d5afd81e5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/indicators\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"indicators\"><a href=\"#indicators\">Indicators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-create-an-indicator-that-plots-like-the-built-in-volume-or-volume-profile-indicators\"><a href=\"#can-i-create-an-indicator-that-plots-like-the-built-in-volume-or-volume-profile-indicators\">Can I create an indicator that plots like the built-in Volume or Volume Profile indicators?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/scripts/volumestudies/?script_type=indicators&amp;solution=43000591617\">Volume</a> and <a href=\"https://www.tradingview.com/scripts/volumestudies/?script_type=indicators&amp;solution=43000703076\">Visible Range Volume Profile</a> indicators (along with some other built-in indicators) are written in Java. They display data on the main chart pane in a unique way:</p>\n<ul>\n<li>The bars are anchored to the bottom or right edge of the chart, not to an absolute x or y value.</li>\n<li>The length of the bars is a relative percentage of the available space and is not an absolute price or number of bars.</li>\n<li>The length of the bars adjusts automatically according to the data from the range of bars that are visible on the chart. The lengths of the bars are normalized so as never to appear too small or too large.</li>\n<li>The width of the bars adjusts automatically to fit the visible space.</li>\n</ul>\n<p>It is difficult for Pine Script\u00ae indicators to plot values in the same way.</p>\n<p><strong>Limitations of `plot.style_columns`</strong></p>\n<p class=\"spacer-wrapper\"><spacer/><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">Volume</a>, or another series, plotted as columns, is anchored to the bottom of the chart, and the width and length of the bars can adjust dynamically. However, the tops of the bars are defined by absolute price values. This means that it is not possible for the series to be plotted on the main chart without distorting the price scale. Also, plots must be defined during processing of the bar they are plotted on, and cannot be plotted retroactively.</p>\n<p><strong>Limitations of drawings</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>Drawing objects such as <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines-and-boxes\">lines and boxes</a> are anchored to an absolute price scale, not to the edge of the chart. Drawing objects do not adjust their length automatically. Lines do not adjust their width automatically. Although boxes can be drawn exactly one bar wide, and so adjust their width automatically, they cannot be drawn so as to fit exactly in one bar; they always draw from the middle of one bar to the middle of another.</p>\n<p>The following example script demonstrates some techniques for approximating the way that the built-in <a href=\"https://www.tradingview.com/scripts/volumestudies/?script_type=indicators&amp;solution=43000591617\">Volume</a> indicator displays.</p>\n<ul>\n<li>We use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> built-in variables, through the PineCoders\u2019 <a href=\"https://www.tradingview.com/script/j7vCseM2-VisibleChart/\">VisibleChart library</a>, to define the bars that are visible. Then we calculate the highest and lowest price, and the highest <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>, for that period.</li>\n<li>We plot lines retroactively, after the visible window and all related values are known.</li>\n<li>We anchor the lines below the lowest visible price, so that it looks as if they are anchored to the bottom edge of the chart.</li>\n<li>We scale the length of all the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a> bars so that the longest bar in the set is approximately 30% of the screen height, similar to the built-in <a href=\"https://www.tradingview.com/scripts/volumestudies/?script_type=indicators&amp;solution=43000591617\">Volume</a> indicator.</li>\n<li>We adjust the width of the lines depending on how many bars are visible.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The bottom margin of the chart must be set to zero in order for the lines to start from the bottom edge of the chart. To set the margin, right-click the chart background and click \u201cSettings\u2026\u201d then \u201cCanvas\u201d, and set the \u201cBottom\u201d margin in the \u201cMargins\u201d section. To preserve the same space at the bottom of the chart, the user can add a bottom margin in the script settings.</p></div></aside>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Dynamically scaled volume\", overlay=true, max_lines_count=500)\n\n// Import the PineCoders' VisibleChart library\nimport PineCoders/VisibleChart/4 as visibleChart\n\nconst float    RELATIVE_HEIGHT    = 0.3 // 30% matches the built-in volume indicator.\nconst string   BOTTOM_TTIP = \"Copy the bottom margin % from your chart settings to here, and then set\n  the bottom margin to *zero* on the chart settings.\"\n\nint bottomInput = input.int(title = \"Bottom Margin %\", defval = 10, minval = 0, maxval = 100, tooltip = BOTTOM_TTIP)\n\n// Get the highest volume, and highest and lowest price points, by calculating on each bar during the visible window.\nvar float hiVol   = na\nvar float hiPrice = na\nvar float loPrice = na\nif visibleChart.barIsVisible()\n    hiVol   := na(hiVol)   ? volume : math.max(hiVol,   volume)\n    hiPrice := na(hiPrice) ? high   : math.max(hiPrice, high)\n    loPrice := na(loPrice) ? low    : math.min(loPrice, low)\n\nint bars = visibleChart.bars()\n// Calculate the thickness for the lines based on how many bars are displayed.\nint lineWidth = math.ceil(1000/bars)\n\n// Draw the lines once, when the visible window ends.\nif time == chart.right_visible_bar_time\n    // Calculate the bottom y coordinate for all lines once.\n    float priceDifference = hiPrice - loPrice\n    float scale = (priceDifference / hiVol) * RELATIVE_HEIGHT\n    float bottomY = loPrice - (bottomInput / 100) * priceDifference\n    // Loop through the visible window using the historical operator.\n    for i = bars - 1 to 0\n        // Calculate the top y coordinate for each line.\n        float topY = bottomY + (volume[i] * scale)\n        // Draw the line.\n        line.new(x1 = bar_index - i, y1 = bottomY, x2 = bar_index - i, y2 = topY, color = close[i] &gt;= open[i] ?\n          color.new(color.green, 50) : color.new(color.red, 50), width = lineWidth)</div>\n<p>This script has some other limitations:</p>\n<ul>\n<li>The lines do not begin from the bottom of the chart if other indicators display plots or drawings below that level.</li>\n<li>In common with any script that uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a> built-in variables, the script must refresh each time the chart is moved or a new bar appears.</li>\n<li>There is a maximum <a href=\"/pine-script-docs/v5/writing/limitations/#line-box-polyline-and-label-limits\">limit</a> of 500 lines per script.</li>\n<li>The width of the lines is calculated based on how many bars are visible. However, a Pine script has no way of knowing how much blank space there is to the right of the final bar. If the user scrolls to the right, the lines can appear too wide and overlap each other.</li>\n</ul>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-use-a-pine-script-with-the-tradingview-screener\"><a href=\"#can-i-use-a-pine-script-with-the-tradingview-screener\">Can I use a Pine script with the TradingView screener?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The TradingView <a href=\"https://www.tradingview.com/screener/\">screener</a> uses only its built-in filters, and cannot use a Pine script.\n<a href=\"https://www.tradingview.com/scripts/search/screener/\">Search for \u201cscreener\u201d</a> in the Community Collection to find scripts that use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function to screen pre-set lists of symbols.</p>\n<p>See also <a href=\"/pine-script-docs/v5/faq/alerts/#how-can-i-get-custom-alerts-on-many-symbols\">this FAQ entry</a> for an example script that generates alerts on multiple\nsymbols.\nNote that using several <code dir=\"auto\">request.security()</code> calls can cause scripts compile and run more slowly than expected.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Scripts can make a maximum of 40 distinct <code dir=\"auto\">request.*()</code> function calls. Therefore, scripts can retrive data from a maximum of 40 symbols.</p></div></aside>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-use-the-output-from-one-script-as-input-to-another\"><a href=\"#how-can-i-use-the-output-from-one-script-as-input-to-another\">How can I use the output from one script as input to another?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts with an input of type <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a> can take a plot from another script (up to a maximum of ten) as an input.\nSelect the script and plot to take as input in the script\u2019s \u201cSettings\u201d tab. If the user removes the script from the chart and adds it again, they must select the correct inputs again.</p>\n<p>The sources used as external inputs must originate from indicators; they cannot originate from strategies. However, plots originating from indicators <em>can</em> be used in strategies.</p>\n<p>For further information, refer to <a href=\"https://www.tradingview.com/blog/en/more-external-inputs-for-scripts-38014/\">this blog post</a> and the <a href=\"/pine-script-docs/v5/concepts/inputs/#source-input\">Source input section</a> in the User Manual.</p>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-my-script-draw-on-the-main-chart-when-its-running-in-a-separate-pane\"><a href=\"#can-my-script-draw-on-the-main-chart-when-its-running-in-a-separate-pane\">Can my script draw on the main chart when it\u2019s running in a separate pane?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts that have the <code dir=\"auto\">overlay</code> parameter in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> functions set to <code dir=\"auto\">false</code> appear in a separate pane to the main chart.\nSuch scripts can affect the display of the main chart in only two ways:</p>\n<ul>\n<li>Changing bar colors, using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a> function.</li>\n<li>Forcing plots to overlay, using <code dir=\"auto\">force_overlay = true</code> in the plotting function. The <code dir=\"auto\">force_overlay</code> parameter is available in most functions that draw on the chart.</li>\n</ul>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/indicators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"is-it-possible-to-export-indicator-data-to-a-file\"><a href=\"#is-it-possible-to-export-indicator-data-to-a-file\">Is it possible to export indicator data to a file?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The option \u201cExport chart data\u2026\u201d in the dropdown menu at the top right corner of the chart exports a comma-separated values (CSV) file that includes time, OHLC data, and any plots generated by your script. This option can also export strategy data.</p>\n<p>To include specific information in the CSV file, ensure that it is plotted by the script.\nIf this extra information is far from the symbol\u2019s price and the existing indicator plots, and plotting it on the chart could distort the scale of the script, or if you prefer not to display\ncertain plots, consider using the <code dir=\"auto\">display</code> parameter in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> function.</p>\n<p>Here is an example plot that displays the close only in the Data Window. The plot title \u201cNo chart display\u201d becomes the column header for this value in the CSV file.</p>\n<div class=\"pine-colorizer not-content\">plot(close * 0.5, \"No chart display\", display = display.data_window)</div>\n<p>Alternatively, the \u201cScale price chart only\u201d in the chart settings maintains the script\u2019s scale. To access these settings, right-click on the chart\u2019s price scale.</p>\n<p>To determine if a condition is true or false, use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a> function, which records a 1 (for true) or 0 (for false) in the CSV file.</p>", "segment_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "fa6effd1de0e260061b4b7a3851364179811f1358ce7b11b79ae7f626e147335", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/other-data-and-timeframes\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"other-data-and-timeframes\"><a href=\"#other-data-and-timeframes\">Other data and timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-kinds-of-data-can-i-get-from-a-higher-timeframe\"><a href=\"#what-kinds-of-data-can-i-get-from-a-higher-timeframe\">What kinds of data can I get from a higher timeframe?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Generally speaking, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function can get the same kinds of data from another timeframe that is available on the chart timeframe. Scripts can retrieve built-in variables like <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function can also evaluate built-in or user-defined functions in the requested <em>context</em> (timeframe and symbol). For example, the following example script retrieves the <a href=\"https://www.tradingview.com/support/solutions/43000501823-average-true-range-atr/\">Average True Range</a> (ATR) value from the daily (<code dir=\"auto\">1D</code>) timeframe by passing the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.atr\">ta.atr()</a> function as the <code dir=\"auto\">expression</code> argument.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"HTF ATR\")\nfloat higherTfAtr = request.security(symbol = syminfo.tickerid, timeframe = \"1D\", expression = ta.atr(14))\nplot(higherTfAtr)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This script <a href=\"/pine-script-docs/v5/concepts/repainting/\">repaints</a> elapsed realtime bars when the daily value is finalized. See the <a href=\"/pine-script-docs/v5/faq/other-data-and-timeframes/#how-to-avoid-repainting-when-using-the-requestsecurity-function\">How to avoid repainting when using the `request.security()` function?</a> FAQ section to find out how to prevent repainting.</p></div></aside>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"which-security-function-should-i-use-for-lower-timeframes\"><a href=\"#which-security-function-should-i-use-for-lower-timeframes\"><span>Which \u200b<code dir=\"auto\">security.*</code>\u200b function should I use for lower timeframes?</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function is intended for accessing data at timeframes that are equal to or higher than the chart\u2019s current timeframe.\nIt is <em>possible</em> to retrieve data from lower timeframes (LTF) using this function. However, the function returns the value from only <em>one</em> LTF bar within the chart\u2019s current bar (the last bar, by default).</p>\n<p>If the script supplies the <code dir=\"auto\">expression</code> as a variable or simple calculation, directly or within a function, the data that <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> returns from a lower timeframe is generally of limited use (see the first script in <a href=\"/pine-script-docs/v5/faq/other-data-and-timeframes/#how-can-i-plot-a-moving-average-only-when-the-charts-timeframe-is-1d-or-higher\">this section</a> for an example). It is possible, however, to construct a function that performs meaningful calculations on the LTF bars and then returns the result on the last bar. The following example script counts the number of LTF bars in a chart bar and returns this value on the last LTF bar. For simplicity, the timeframes are hardcoded to <code dir=\"auto\">\"1D\"</code> and <code dir=\"auto\">\"1W\"</code> and the script should therefore be run from a chart on the weekly timeframe.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Counting intrabars using `request.security()`\")\n\n// @function    Calculates the quantity of 1D bars in a week of trading.\n// @returns     (int) The number of intrabars within the current weekly bar up to the current moment.\nqtyIntrabars() =&gt;\n    var int count = 0\n    count := timeframe.change(\"W\") ? 1 : count + 1\n\nint qtyIntrabars = request.security(syminfo.tickerid, \"1D\", qtyIntrabars())\n\nplot(qtyIntrabars, \"qtyIntrabars\", style=plot.style_histogram)</div>\n<p>When using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function on a lower timeframe, all calculations that reference individual LTF bars must be done <em>within the requested context</em>, and only the <em>result</em> of the calculation is returned.\nUsing the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> function for intrabar analysis is usually easier and more powerful, because it returns an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of data from <em>all</em> available intrabars within a chart bar. Returning the data for each bar allows scripts to perform calculations on specific bars or all bars in the main script context.</p>\n<p>In the following version of our example script, we use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> to perform the same calculations. With this approach, we do not need to explicitly define the current chart\u2019s timeframe, nor do we need a custom function.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Counting intrabars using `request.security_lower_tf()`\")\n\n// Count the number of elements in the array of close prices for each LTF bar in the current chart's bar.\nint qtyIntrabars = array.size(request.security_lower_tf(syminfo.tickerid, \"1D\", close))\n\nplot(qtyIntrabars, \"qtyIntrabars\", style=plot.style_histogram)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>While easier to work with, this approach is more computationally expensive, because the script has to commit to memory an array of several values instead of a single value. If the logic of the script allows for it \u2014 as it does in our case, where both approaches return identical data \u2014 it\u2019s often better to use the first approach in big scripts with a lot of intrabar computations, due to the performance benefits it brings.</p></div></aside>\n<p>See the sections in the User Manual page \u201cOther timeframes and Data\u201d about\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lower-timeframes\"><code dir=\"auto\">request.security_lower_tf()</code></a> and\nusing <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity_lower_tf\"><code dir=\"auto\">request.security()</code> on lower timeframes</a>\nto learn more about the differences between running these functions on a lower timeframe.</p>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-to-avoid-repainting-when-using-the-requestsecurity-function\"><a href=\"#how-to-avoid-repainting-when-using-the-requestsecurity-function\"><span>How to avoid repainting when using the \u200b<code dir=\"auto\">request.security()</code>\u200b function?</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"/pine-script-docs/v5/concepts/repainting/\">Repainting</a> can be a problem when retrieving data from higher or lower timeframes using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.</p>\n<p>Retrieving data from a different symbol on the chart\u2019s timeframe does not risk repainting. Requesting data from the chart\u2019s own symbol and timeframe does not result in repainting either, but it is usually unnecessary to use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> rather than simply referencing the chart\u2019s own values (except when modifying the chart\u2019s ticker using <code dir=\"auto\">ticker.*()</code> functions). When using the chart\u2019s timeframe, there is no need to offset the data, change the default <code dir=\"auto\">lookahead</code> value, or use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_on\">barmerge.lookahead_on</a> in order to avoid repainting.</p>\n<h3 class=\"md-heading\" id=\"higher-timeframes\"><a href=\"#higher-timeframes\">Higher timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values from a <em>higher timeframe</em> (HTF) often repaint because a <a href=\"/pine-script-docs/v5/language/execution-model/#calculation-based-on-historical-bars\">historical bar</a> on the chart might include data from a <a href=\"/pine-script-docs/v5/language/execution-model/#calculation-based-on-realtime-bars\">realtime bar</a> on the HTF. Realtime values can change throughout the bar; for example, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> price reflects the <em>latest</em> price update in a realtime bar. When the HTF bar closes and its values become fixed, the relevant historical chart bars <em>change</em> to adjust to the fixed HTF values. This behavior is described in the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#historical-and-realtime-behavior\">Historical and realtime behavior</a> section of the User Manual. Users expect historical bars not to change, which is one reason why repainting is such a concern.</p>\n<p>To prevent repainting, use confirmed values that remain consistent across all bars. The most robust method is to offset all expressions by 1. For example, instead of <code dir=\"auto\">close</code>, which is equivalent to <code dir=\"auto\">close[0]</code>, use <code dir=\"auto\">close[1]</code>. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call must also use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_on\">barmerge.lookahead_on</a>.\nThis method returns data that is up to one HTF bar \u201clate\u201d, and is thus not subject to change.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Failing to offset the <code dir=\"auto\">expression</code> argument results in <em>lookahead bias</em>, where the script appears to have access to historical values before they would actually have occurred.\nSee the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lookahead\">lookahead</a> and <a href=\"/pine-script-docs/v5/concepts/repainting/#future-leak-with-requestsecurity\">future leak</a> sections for more information.</p></div></aside>\n<p>The following example script demonstrates the use of a single bar offset to the <code dir=\"auto\">expression</code> argument and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_on\">barmerge.lookahead_on</a> in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> to ensure that the data behaves the same on historical and realtime bars.\nThe script triggers a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime.error\">runtime error</a> if the chart\u2019s timeframe exceeds or matches the daily timeframe, to prevent the return of inaccurate values.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"HTF close\" , overlay = true)\nfloat dailyClose = request.security(syminfo.tickerid, \"1D\", close[1], lookahead = barmerge.lookahead_on)\nplot(dailyClose)\nif timeframe.in_seconds() &gt;= timeframe.in_seconds(\"1D\")\n    runtime.error(\"Chart timeframe must be less than 1D.\")</div>\n<p>See the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#avoiding-repainting\">Avoiding repainting</a> section of the User Manual for more information.</p>\n<h3 class=\"md-heading\" id=\"lower-timeframes\"><a href=\"#lower-timeframes\">Lower timeframes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Although the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function is intended to operate on timeframes greater than or equal to the chart timeframe, it <em>can</em> request data from a <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lower-timeframes\">lower timeframe</a> (LTF), with limitations. When accessing data from a LTF, the function evaluates the given expression in the LTF context and returns the result from a <em>single</em> LTF bar per chart bar. The specific LTF bar returned depends on the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#lookahead\">lookahead</a> parameter:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_on\">barmerge.lookahead_on</a> returns the <em>first</em> intrabar of the period historically, but the <em>last</em> intrabar in realtime.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_off\">barmerge.lookahead_off</a> always returns the last intrabar for both historical and realtime data.\nTo prevent <a href=\"/pine-script-docs/v5/concepts/repainting/\">repainting</a> (in this case, inconsistent results between realtime and historical data) use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_barmerge.lookahead_off\">barmerge.lookahead_off</a> for lower timeframe data requests.</li>\n</ul>\n<p>In most cases, using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> function is more suitable for lower timeframes, as it returns an\n<a href=\"/pine-script-docs/v5/language/arrays/\">array</a> containing data from <em>all</em> available intrabars within a chart bar. See the section on <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity_lower_tf\"><code dir=\"auto\">request.security_lower_tf()</code></a> to learn more.</p>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-convert-the-charts-timeframe-into-a-numeric-format\"><a href=\"#how-can-i-convert-the-charts-timeframe-into-a-numeric-format\">How can I convert the chart\u2019s timeframe into a numeric format?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a> function converts a timeframe specified in <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a> format into an equivalent number of seconds. Having the timeframe in a numeric format means that scripts can calculate the number of time units within a specific timeframe, or perform operations that adjust the timeframe used in HTF calls in relation to the chart\u2019s timeframe, as described in <a href=\"/pine-script-docs/v5/faq/other-data-and-timeframes/#how-do-i-define-a-higher-timeframe-that-is-a-multiple-of-the-chart-timeframe\">this FAQ entry</a>.</p>\n<p>In this script example, we use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a> function to determine the chart\u2019s timeframe, measured in seconds. Since no specific\n<code dir=\"auto\">timeframe</code> argument is specified, the function defaults to using <code dir=\"auto\">timeframe.period</code>, which returns the chart\u2019s current timeframe. The script then converts the timeframe in seconds into various other units of time, including minutes, hours, and days, and displays the original string and converted numeric values in a <a href=\"/pine-script-docs/v5/concepts/tables/\">table</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Timeframe to value\")\n\ntfInSec  = timeframe.in_seconds()\ntfInMin  = tfInSec / 60\ntfInHrs  = tfInMin / 60\ntfInDays = tfInHrs / 24\n\nif barstate.islastconfirmedhistory\n    var table displayTable = table.new(position.top_right, 2, 5, na, color.gray, 1, color.gray, 1)\n    table.cell(displayTable, 0, 0, \"Original TF string\",   text_color = chart.fg_color)\n    table.cell(displayTable, 1, 0, \"\\\"\" + timeframe.period + \"\\\"\", text_color = chart.fg_color)\n    table.cell(displayTable, 0, 1, \"Timeframe in seconds\", text_color = chart.fg_color)\n    table.cell(displayTable, 1, 1, str.tostring(tfInSec),  text_color = chart.fg_color)\n    table.cell(displayTable, 0, 2, \"Timeframe in minutes\", text_color = chart.fg_color)\n    table.cell(displayTable, 1, 2, str.tostring(tfInMin),  text_color = chart.fg_color)\n    table.cell(displayTable, 0, 3, \"Timeframe in hours\",   text_color = chart.fg_color)\n    table.cell(displayTable, 1, 3, str.tostring(tfInHrs),  text_color = chart.fg_color)\n    table.cell(displayTable, 0, 4, \"Timeframe in days\",    text_color = chart.fg_color)\n    table.cell(displayTable, 1, 4, str.tostring(tfInDays), text_color = chart.fg_color)</div>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-convert-a-timeframe-in-float-minutes-into-a-string-usable-with-requestsecurity\"><a href=\"#how-can-i-convert-a-timeframe-in-float-minutes-into-a-string-usable-with-requestsecurity\"><span>How can I convert a timeframe in \u201cfloat\u201d minutes into a string usable with \u200b<code dir=\"auto\">request.security()</code>\u200b?</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The built-in function <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a> function converts a number of seconds into a timeframe string that is compatible with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.</p>\n<p>The example script below converts a user-defined number of minutes into a timeframe string using the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a> function.\nThe script then requests the close price from that timeframe using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> and plots it.\nAdditionally, we display the resulting timeframe string in a <a href=\"/pine-script-docs/v5/concepts/tables/\">table</a> on the chart\u2019s top right corner:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Target TF in string from float minutes\", \"\", true)\nfloat tfInMinInput = input.float(1440, \"Minutes in target timeframe (&lt;= 0.0167 [1 sec.])\", minval = 0.0167)\n// Convert target TF in minutes from input into string.\nstring targetTfString = timeframe.from_seconds(int(tfInMinInput * 60))\n// Fetch target timeframe's close.\nfloat targetTfClose = request.security(syminfo.tickerid, targetTfString, close)\n// Plot target timeframe close.\nplot(targetTfClose, \"Target TF close\")\n// Display the target timeframe string in a table cell at the chart's top right.\nif barstate.islastconfirmedhistory\n    var table displayTable = table.new(position.top_right, 1, 1, color.new(color.yellow, 70), color.gray, 1, color.gray, 1)\n    table.cell(displayTable, 0, 0, str.format(\"Target TF (string): {0}\", targetTfString), text_color = chart.fg_color)</div>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-do-i-define-a-higher-timeframe-that-is-a-multiple-of-the-chart-timeframe\"><a href=\"#how-do-i-define-a-higher-timeframe-that-is-a-multiple-of-the-chart-timeframe\">How do I define a higher timeframe that is a multiple of the chart timeframe?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This example script uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a> functions to calculate a higher timeframe that is a fixed multiple of the chart\u2019s current timeframe. Using the input for the multiplier, the user can define the ratio between the chart\u2019s\ntimeframe and the higher timeframe. The script then calculates the <a href=\"https://www.tradingview.com/support/solutions/43000502338-relative-strength-index-rsi/\">Relative Strength Index</a> (RSI) for both the chart\u2019s timeframe and the  higher timeframe, plotting both in a separate pane for comparison. We display the calculated higher timeframe string in a <a href=\"/pine-script-docs/v5/concepts/tables/\">table</a> on the main chart pane by using <code dir=\"auto\">force_overlay</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Multiple of current TF\", overlay = false)\n\n// Provide an input to specify the multiple to apply to the chart's timeframe.\nfloat tfMult = input.float(4, minval = 1)\n\n// Get multiple of current timeframe.\nstring targetTfString = timeframe.from_seconds(int(timeframe.in_seconds() * tfMult))\n// Create RSI from the current timeframe.\nfloat myRsi = ta.rsi(close, 14)\nplot(myRsi, \"Current TF RSI\", color = color.silver)\n// Non-repainting HTF RSI.\nfloat myRsiHtf = request.security(syminfo.tickerid, targetTfString, myRsi[1], lookahead = barmerge.lookahead_on)\nplot(myRsiHtf, \"Non-repainting HTF RSI\", color = color.green)\n\n// Display the calculated timeframe at the top right of the main chart pane. \nif barstate.islastconfirmedhistory\n    var table displayTable = table.new(position.top_right, 1, 1, color.new(color.yellow, 70), color.gray, 1, color.gray, 1, force_overlay = true)\n    table.cell(displayTable, 0, 0, str.format(\"Target TF (string): {0}\", targetTfString), text_color = chart.fg_color)</div>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-plot-a-moving-average-only-when-the-charts-timeframe-is-1d-or-higher\"><a href=\"#how-can-i-plot-a-moving-average-only-when-the-charts-timeframe-is-1d-or-higher\">How can I plot a moving average only when the chart\u2019s timeframe is 1D or higher?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To plot a moving average on a chart only if it has a timeframe of daily (\u201c1D\u201d) or higher, scripts can use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.in_seconds\">timeframe.in_seconds()</a> function to convert the chart\u2019s current timeframe into seconds. Since a day consists of 86400 seconds, any timeframe equal to or exceeding this value corresponds to a daily or longer duration.</p>\n<p>The example script below calculates and plots a <a href=\"https://www.tradingview.com/support/solutions/43000696841-simple-moving-average/\">Simple Moving Average</a> (SMA) of the closing prices over the last 200 bars.\nThe script uses a <a href=\"/pine-script-docs/v5/language/operators/#-ternary-operator\">ternary operator</a> to return the moving average on timeframes of 1D or greater, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> if the timeframe is shorter than one day. Because <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> calls cannot be in a local scope, scripts cannot conditionally call this function. Passing an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value as the <code dir=\"auto\">series</code> argument is an effective way to not plot anything. Note that plotting an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value <em>does</em> count towards the script\u2019s <a href=\"/pine-script-docs/v5/writing/limitations/#plot-limits\">plot limit</a>.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Timeframe-dependent MA\", overlay = true)\nbool tfIsDailyOrGreater = timeframe.in_seconds() &gt;= 86400\nfloat ma = ta.sma(close, 200)\nplot(tfIsDailyOrGreater ? ma : na, \"MA\", color.aqua)</div>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-happens-if-i-plot-a-moving-average-from-the-1h-timeframe-on-a-different-timeframe\"><a href=\"#what-happens-if-i-plot-a-moving-average-from-the-1h-timeframe-on-a-different-timeframe\">What happens if I plot a moving average from the 1H timeframe on a different timeframe?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function can access data from a different <em>context</em>, such as a different symbol or timeframe. There are different considerations when accessing data from a timeframe <em>higher</em> or <em>lower</em> than the chart timeframe.</p>\n<p>First, let\u2019s consider an example of plotting data from a <em>lower</em> timeframe. The following script plots a 21-period <a href=\"https://www.tradingview.com/support/solutions/43000592270-exponential-moving-average/\">Exponential Moving Average</a> (EMA) derived from the 1-hour (1H) timeframe on any chart, irrespective of the timeframe of that chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"1hr EMA\", overlay = true)\nplot(request.security(syminfo.tickerid, \"60\", ta.ema(close, 21)), color = color.orange)</div>\n<p>Assuming that we run this script on a chart with a daily timeframe, we encounter the following problems:</p>\n<ul>\n<li>For each daily bar, the chart can plot only 1 of the 24 MA values theoretically available. The plot misses out the intraday fluctuations and trends that a 1H moving average (MA) is typically used to identify.</li>\n<li>The script above displays only the EMA value calculated for the <em>final</em> 1-hour bar of each day. In realtime, the plot displays the most recently known value.</li>\n</ul>\n<p>Unlike <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> function is intended for use on lower timeframes. It returns an <a href=\"/pine-script-docs/v5/language/arrays/\">array</a> containing data from all available intrabars within a chart bar. See <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#requestsecurity_lower_tf\">this section</a> of the User Manual to learn more.</p>\n<p>We could rewrite the script to use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>, but plotting a moving average from a lower timeframe is still not very practical.</p>\n<p>A more logical approach is to plot MAs from a <em>higher</em> timeframe. This strategy shows broader market trends within the context of shorter-term price movements. For example, plotting a daily MA on a 1H chart provides insights into how intraday prices are trending relative to the longer-term daily average.</p>\n<p>In the following example script, we plot the 21 EMA calculated at the 1H timeframe, but only when the chart\u2019s timeframe is <em>equal to or lower than</em> 1H. We call the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> function <a href=\"/pine-script-docs/v5/faq/other-data-and-timeframes/#higher-timeframes\">in the recommended way</a> to avoid repainting.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"HTF EMA\", overlay = true)\n\n// Input to specify the timeframe for `request.security() call.\nstring tfinput      = input.timeframe(\"60\", \"Timeframe for MA\")\n\n// @function            A wrapper for the `request.security()` function for non-repainting calls to HTFs.\n// @param timeframe     Timeframe of the requested data. \n//                      To use the chart's timeframe, use an empty string or the `timeframe.period` variable.\n// @param expression    An expression to calculate and returne from the request.security() call's context.\n// @returns             The result of the calculated expression.\nhtfSecurity(string timeframe, expression) =&gt;\n    result = request.security(syminfo.tickerid, timeframe, expression[1], lookahead = barmerge.lookahead_on)\n\n// Calculate the moving average in the chart context.\nfloat ma = ta.ema(close, 21)\n// Calculate the moving average in the specified `tfInput` timeframe.\nfloat htfMA = htfSecurity(tfinput, ma)\n\n// Check whether the requested timeframe is greater or less than the chart's timeframe.\nbool tfIsGreater = timeframe.in_seconds() &lt; timeframe.in_seconds(tfinput)\nbool tfIsLess    = timeframe.in_seconds() &gt; timeframe.in_seconds(tfinput)\n\n// Plot the HTF MA, the chart MA, or nothing, depending on the timeframe.\nfloat maPlot = tfIsGreater ? htfMA : tfIsLess ? na : ma\nplot(maPlot, \"Requested MA\", color.orange)\n\n// Display a message in a table indicating that the requested timeframe is lower than the chart's timeframe, if applicable.\nif barstate.islastconfirmedhistory and tfIsLess\n    var table displayTable = table.new(position.bottom_right, 1, 1, color.new(color.yellow, 70))\n    table.cell(displayTable, 0, 0, \"Requested TF is lower than chart's TF\\nNo MA displayed\", text_color = color.red)</div>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/other-data-and-timeframes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"why-do-intraday-price-and-volume-values-differ-from-values-retrieved-with-requestsecurity-at-daily-timeframes-and-higher\"><a href=\"#why-do-intraday-price-and-volume-values-differ-from-values-retrieved-with-requestsecurity-at-daily-timeframes-and-higher\"><span>Why do intraday price and volume values differ from values retrieved with \u200b<code dir=\"auto\">request.security()</code>\u200b at daily timeframes and higher?</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Intraday <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a> (OHLCV) values can be different from those from <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> at daily timeframes and higher for a number of reasons, including the following:</p>\n<ul>\n<li><strong>Different data feeds:</strong> Certain trades (like block trades and OTC trades, especially in stocks) are recorded only at the end of the trading day, so their volume affects the End-of-Day (EOD) feed but not the intraday feed.</li>\n<li><strong>Price discrepancies:</strong> There can be slight differences in prices between EOD and intraday data. For example, an EOD high might not match any intraday highs due to variations in data feeds.</li>\n<li><strong>Extended hours data:</strong> EOD data feeds do not include information from trading outside regular hours, unlike some intraday feeds. For instance, the bars of an hourly chart might straddle the open of a session, mixing data from pre-market and regular trading.</li>\n</ul>\n<p>For an extended list of factors with detailed explanations, refer to the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#data-feeds\">Data feeds</a> section in the User Manual.</p>", "segment_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "f26117c960d61bc5e2de8583d78b002a2e53a3328b5585c90c1bba6d4ffdd341", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/faq/programming\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"programming\"><a href=\"#programming\">Programming<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"what-does-scope-mean\"><a href=\"#what-does-scope-mean\">What does \u201cscope\u201d mean?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <em>scope</em> of a variable is the part of a script that defines the variable and in which it can be referenced. There are two main types of scope: <em>global</em> and <em>local</em>.</p>\n<p class=\"spacer-wrapper\"><spacer/> <strong>Global Scope:</strong> The global scope is all of the script that is not inside a <a href=\"/pine-script-docs/language/user-defined-functions/\">function</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> statement, or other <a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structure</a>. Code from anywhere in the script can access global variables. There is only one global scope.</p>\n<p class=\"spacer-wrapper\"><spacer/> <strong>Local Scope:</strong> Code that is inside a function or in any local block (one that is inset by four spaces) defines a local scope. Only code that is in the same local scope can access a local variable. There can be many local scopes.</p>\n<p>The following example script gives an \u201cUndeclared identifier\u201d error when we try to access a local variable from the global scope.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scope demo\")\n\n// Global scope\nint globalValue = close &gt; open ? 1 : -1\n\nif barstate.isconfirmed\n    // Local scope\n    int localValue = close &gt; open ? 1 : -1\n\nplot(localValue, \"Local variable\", chart.fg_color, 2)</div>\n<p>To fix this error, we can declare the variable in the global scope, thus making it accessible from any scope in the script, and then conditionally modify it within a local block:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scope demo\")\n\n// Global scope\nint globalValue = close &gt; open ? 1 : -1\nint localValue  = na\n\nif barstate.isconfirmed\n    // Local scope\n    localValue := close &gt; open ? 1 : -1\n\nplot(localValue, \"Local variable\", chart.fg_color, 2)</div>\n<p>Similarly, the following script gives an \u201cUndeclared identifier\u201d error when we try to access a variable defined in one local scope from another local scope. In this case, local scope 1 <em>contains</em> local scope 2, but the same problem would be present if they were on the same level. When a scope contains another one, the inner scope can access variables declared in the outer one, but not vice versa.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scope demo\")\n\nbool isUpCandleWithLargerUpWick = false\n\nif barstate.isconfirmed\n    // Local scope 1\n    bool upWickIsLarger = (high - math.max(open, close)) &gt; (math.min(open,close) - low)\n    if close &gt; open\n        // Local scope 2\n        bool isUpCandle = true\n    isUpCandleWithLargerUpWick := upWickIsLarger and isUpCandle ? true : false\n\nplot(isUpCandleWithLargerUpWick, \"Global variable depending on two local variables\", chart.fg_color, 2)</div>\n<p>For more information about scopes, see the <a href=\"/pine-script-docs/v5/language/script-structure/#code\">Code</a> section of the User Manual.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-convert-a-script-to-a-newer-version-of-pine-script\"><a href=\"#how-can-i-convert-a-script-to-a-newer-version-of-pine-script\">How can I convert a script to a newer version of Pine Script\u00ae?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>See the <a href=\"/pine-script-docs/v5/migration-guides/\">Migration Guides</a> section of the User Manual for instructions about upgrading the version of Pine that a script uses.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"can-i-access-the-source-code-of-invite-only-or-closed-source-scripts\"><a href=\"#can-i-access-the-source-code-of-invite-only-or-closed-source-scripts\">Can I access the source code of \u201cInvite-Only\u201d or \u201cclosed-source\u201d scripts?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>No; only <em>open</em> scripts have their source code visible. The source code of <em>protected</em> and <em>Invite-Only</em> scripts is hidden and can only be seen by the script author.</p>\n<p>For a definition of the <em>access types</em> of published scripts: open, protected, and Invite-Only, see <a href=\"https://www.tradingview.com/support/solutions/43000482573-what-are-the-different-types-of-published-scripts/\">this article</a> in the Help Center.</p>\n<p>For an explanation on the <em>visibility</em> (public/private) that a script can have, see the <a href=\"/pine-script-docs/v5/writing/publishing/#visibility\">Visibility</a> section of the Publishing scripts page in the User Manual.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"is-pine-script-an-object-oriented-language\"><a href=\"#is-pine-script-an-object-oriented-language\">Is Pine Script an object-oriented language?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Although Pine Script is not strictly an object-oriented programming language, it incorporates some object-oriented features, notably <a href=\"/pine-script-docs/language/type-system/#user-defined-types\">user-defined types</a> (UDTs).\nScripts can create <a href=\"/pine-script-docs/language/objects/\">objects</a> as instances of a UDT. These objects have one or more fields, which can store values of various data types.</p>\n<p>Here is a simple example of how to use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a> keyword to create an object:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Object demo\")\n\n// Define a new type named `pivot`.\ntype pivot\n    int   x\n    float y\n    bool  isHigh\n\n// Create a new `pivot` with specific values.\npivot newPivot = pivot.new(bar_index, close, true)\n\n// Plot the `y` component of `newPivot`.\nplot(newPivot.y)</div>\n<p>In this example, we create an object <code dir=\"auto\">newPivot</code>, which is an instance of the user-defined type <code dir=\"auto\">pivot</code>. The script then plots the <code dir=\"auto\">y</code> field of <code dir=\"auto\">newPivot</code>.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-access-the-source-code-of-built-in-indicators\"><a href=\"#how-can-i-access-the-source-code-of-built-in-indicators\">How can I access the source code of built-in indicators?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are two ways to access the source code of built-in indicators that are written in Pine:</p>\n<p><strong>Create a new indicator</strong></p>\n<p class=\"spacer-wrapper\"><spacer/>In the Pine Script Editor, click the \u201c<em>Open</em>\u201d menu and choose the \u201c<em>Built-in script</em>\u201d option. Select the built-in indicator that you want to work with.</p>\n<p><strong>Edit the code</strong></p>\n<p class=\"spacer-wrapper\"><spacer/> With the indicator displayed on the chart, click on the curly braces <code dir=\"auto\">{}</code> next to the indicator name to open it in the Pine Editor.\nTo edit the code, click the option to create a working copy.</p>\n<p>Some built-in indicators, such as the Volume Profile or chart pattern indicators, are not written in Pine and so the code for these indicators is not accessible.\nThese indicators are not included in the \u201c<em>Built-in script</em>\u201d menu, and curly braces are not displayed next to their names on the chart.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-examine-the-value-of-a-string-in-my-script\"><a href=\"#how-can-i-examine-the-value-of-a-string-in-my-script\">How can I examine the value of a string in my script?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts can print strings to Pine Logs on any or every bar, along with messages about the logic of the script at that point.\nSee the <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> section of the User Manual for information about logging.</p>\n<p>Scripts can also display string in labels or label tooltips. The following example scripts displays a string in a label on the last bar of the chart using a custom function.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"print()\", \"\", true)\n\nprint(string txt) =&gt;\n    // Create a persistent label\n    var label myLabel = label.new(bar_index, na, txt, xloc.bar_index, yloc.price, color(na), label.style_label_left, chart.fg_color, size.large, text.align_left)\n    // Update the label's x and y position, and the text it displays.\n    label.set_xy(myLabel, bar_index, open)\n    label.set_text(myLabel, txt)\n\nif barstate.islast\n    print(\"Timeframe = \" + timeframe.period)</div>\n<p>For more techniques, see the <a href=\"/pine-script-docs/writing/debugging/#strings\">debugging strings</a> section of the User Manual.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-visualize-my-scripts-conditions\"><a href=\"#how-can-i-visualize-my-scripts-conditions\">How can I visualize my script\u2019s conditions?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>If a script contains complex logical conditions, it can be difficult to debug the output. Visualizing each condition separately can help to debug any problems.\nSee the <a href=\"/pine-script-docs/v5/writing/debugging/#compound-and-nested-conditions\">Compound and nested conditions</a> section of the User Manual for an example.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-make-the-console-appear-in-the-editor\"><a href=\"#how-can-i-make-the-console-appear-in-the-editor\">How can I make the console appear in the editor?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To display the console in the editor, either press the keyboard shortcut Ctrl + ` (grave accent), or right-click within the editor and choose the \u201cToggle Console\u201d option.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/faq/programming", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-can-i-plot-numeric-values-so-that-they-dont-affect-the-indicators-scale\"><a href=\"#how-can-i-plot-numeric-values-so-that-they-dont-affect-the-indicators-scale\">How can I plot numeric values so that they don\u2019t affect the indicator\u2019s scale?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Plotting numerical values on the main chart pane can distort the price scale if the values differ too much from the price.</p>\n<p>One way around this is not to plot the values on the chart, but use the Data Window to inspect them. Add <code dir=\"auto\">display = display.data_window</code> to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a> call, and the values are visible in the Data Window for any single historical or realtime bar that the cursor hovers over.</p>\n<p>Another option is to set the script to display in a separate pane by using <code dir=\"auto\">overlay = false</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration. The user needs to delete and re-add the script to the chart if this parameter is changed. Plot the numeric values to track in the separate pane, and draw the rest of the script visuals on the main chart pane by using the <code dir=\"auto\">force_overlay</code> parameter.</p>\n<p>Additionally, right-clicking on the scale on the chart brings out the dropdown menu. The \u201cScale Price Chart Only\u201d option there makes it so the Auto mode of the chart scale only takes the chart itself into account, without adjusting for plots or other graphics of all indicators that overlay that chart.</p>", "segment_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "5d47c8d8f51a6cb9b1c841c14974eb135e235837d52819e7789ed6614a600371", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/arrays\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"arrays\"><a href=\"#arrays\">Arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script Arrays are one-dimensional collections that can hold\nmultiple value references. Think of them as a better way to handle cases\nwhere one would otherwise need to explicitly declare a set of similar\nvariables (e.g., <code dir=\"auto\">price00</code>, <code dir=\"auto\">price01</code>, <code dir=\"auto\">price02</code>, \u2026).</p>\n<p>All elements in an array must be of the same <a href=\"/pine-script-docs/v5/language/type-system/#types\">built-in type</a>, <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a>, or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>.</p>\n<p>Scripts reference arrays using array IDs similar to the IDs of <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>, <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>, and other <em>special types</em>. Pine Script does not use an indexing operator to reference individual array elements.\nInstead, functions including <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.set\">array.set()</a> read and write the values of array elements.</p>\n<p>Scripts reference the elements of an array using an <em>index</em>, which\nstarts at 0 and extends to the number of elements in the array minus\none. Arrays in Pine Script can have a dynamic size that varies across\nbars, as one can change the number of elements in an array on each\niteration of a script. Scripts can contain multiple array instances. The\nsize of arrays is limited to 100,000 elements.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>We will use <em>beginning</em> of an array to designate index 0, and <em>end</em> of\nan array to designate the array\u2019s element with the highest index value.\nWe will also extend the meaning of <em>array</em> to include array IDs, for the\nsake of brevity.</p></div></aside>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaring-arrays\"><a href=\"#declaring-arrays\">Declaring arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script uses the following syntax to declare arrays:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var/varip ][array&lt;type&gt;/&lt;type[]&gt; ]&lt;identifier&gt; = &lt;expression&gt;</span></div></div></code></pre></figure></link></div>\n<p>Where <code dir=\"auto\">&lt;type&gt;</code> is a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> for the array that declares the type of values it will\ncontain, and the <code dir=\"auto\">&lt;expression&gt;</code> returns either an array of the specified\ntype or <code dir=\"auto\">na</code>.</p>\n<p>When declaring a variable as an array, we can use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nkeyword followed by a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a>. Alternatively, we can use the <code dir=\"auto\">type</code> name followed by the\n<code dir=\"auto\">[]</code> modifier (not to be confused with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\n<em>history-referencing operator</em>).</p>\n<p>Since Pine always uses type-specific functions to create arrays, the\n<code dir=\"auto\">array&lt;type&gt;/type[]</code> part of the declaration is redundant, except when\ndeclaring an array variable assigned to <code dir=\"auto\">na</code>. Even when not required,\nexplicitly declaring the array type helps clearly state the intention to\nreaders.</p>\n<p>This line of code declares an array variable named <code dir=\"auto\">prices</code> that points\nto <code dir=\"auto\">na</code>. In this case, we must specify the type to declare that the\nvariable can reference arrays containing \u201cfloat\u201d values:</p>\n<div class=\"pine-colorizer not-content\">array&lt;float&gt; prices = na</div>\n<p>We can also write the above example in this form:</p>\n<div class=\"pine-colorizer not-content\">float[] prices = na</div>\n<p>When declaring an array and the <code dir=\"auto\">&lt;expression&gt;</code> is not <code dir=\"auto\">na</code>, use one of\nthe following functions: <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;type&gt;(size, initial_value)</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.copy\">array.copy()</a>.\nFor <code dir=\"auto\">array.new&lt;type&gt;(size, initial_value)</code> functions, the arguments of\nthe <code dir=\"auto\">size</code> and <code dir=\"auto\">initial_value</code> parameters can be \u201cseries\u201d to allow\ndynamic sizing and initialization of array elements. The following\nexample creates an array containing zero \u201cfloat\u201d elements, and this\ntime, the array ID returned by the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;float&gt;()</a>\nfunction call is assigned to <code dir=\"auto\">prices</code>:</p>\n<div class=\"pine-colorizer not-content\">prices = array.new&lt;float&gt;(0)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The <code dir=\"auto\">array.*</code> namespace also contains type-specific functions for\ncreating arrays, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_int\">array.new_int()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_float\">array.new_float()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_bool\">array.new_bool()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_color\">array.new_color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_string\">array.new_string()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_line\">array.new_line()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_linefill\">array.new_linefill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_label\">array.new_label()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_box\">array.new_box()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new_table\">array.new_table()</a>.\nThe <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;type&gt;()</a>\nfunction can create an array of any type, including\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>.</p></div></aside>\n<p>The <code dir=\"auto\">initial_value</code> parameter of <code dir=\"auto\">array.new*</code> functions allows users to\nset all elements in the array to a specified value. If no argument is\nprovided for <code dir=\"auto\">initial_value</code>, the array is filled with <code dir=\"auto\">na</code> values.</p>\n<p>This line declares an array ID named <code dir=\"auto\">prices</code> pointing to an array\ncontaining two elements, each assigned to the bar\u2019s <code dir=\"auto\">close</code> value:</p>\n<div class=\"pine-colorizer not-content\">prices = array.new&lt;float&gt;(2, close)</div>\n<p>To create an array and initialize its elements with different values,\nuse\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from()</a>.\nThis function infers the array\u2019s size and the type of elements it will\nhold from the arguments in the function call. As with <code dir=\"auto\">array.new*</code>\nfunctions, it accepts \u201cseries\u201d arguments. All values supplied to the\nfunction must be of the same type.</p>\n<p>For example, all three of these lines of code will create identical\n\u201cbool\u201d arrays with the same two elements:</p>\n<div class=\"pine-colorizer not-content\">statesArray = array.from(close &gt; open, high != close)\nbool[] statesArray = array.from(close &gt; open, high != close)\narray&lt;bool&gt; statesArray = array.from(close &gt; open, high != close)</div>\n<h3 class=\"md-heading\" id=\"using-var-and-varip-keywords\"><a href=\"#using-var-and-varip-keywords\"><span>Using \u200b<code dir=\"auto\">var</code>\u200b and \u200b<code dir=\"auto\">varip</code>\u200b keywords</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users can utilize\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeywords to instruct a script to declare an array variable only once on\nthe first iteration of the script on the first chart bar. Array\nvariables declared using these keywords point to the same array\ninstances until explicitly reassigned, allowing an array and its element\nreferences to persist across bars.</p>\n<p>When declaring an array variable using these keywords and pushing a new\nvalue to the end of the referenced array on each bar, the array will\ngrow by one on each bar and be of size <code dir=\"auto\">bar_index + 1</code>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nstarts at zero) by the time the script executes on the last bar, as this\ncode demonstrates:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Using `var`\")\n//@variable An array that expands its size by 1 on each bar.\nvar a = array.new&lt;float&gt;(0)\narray.push(a, close)\n\nif barstate.islast\n    //@variable A string containing the size of `a` and the current `bar_index` value.\n    string labelText = \"Array size: \" + str.tostring(a.size()) + \"\\nbar_index: \" + str.tostring(bar_index)\n    // Display the `labelText`.\n    label.new(bar_index, 0, labelText, size = size.large)</div>\n<p>The same code without the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword would re-declare the array on each bar. In this case, after\nexecution of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\ncall, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">a.size()</a>\ncall would return a value of 1.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Array variables declared using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nbehave as ones using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> on\nhistorical data, but they update their values for realtime bars (i.e.,\nthe bars since the script\u2019s last compilation) on each new price tick.\nArrays assigned to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nvariables can only hold\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_bool\">bool</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_color\">color</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\ntypes or\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> that exclusively contain within their fields these types or\ncollections (arrays, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>) of\nthese types.</p></div></aside>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"reading-and-writing-array-elements\"><a href=\"#reading-and-writing-array-elements\">Reading and writing array elements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts can write values to existing individual array elements using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.set\">array.set(id, index,\nvalue)</a>,\nand read using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get(id,\nindex)</a>.\nWhen using these functions, it is imperative that the <code dir=\"auto\">index</code> in the\nfunction call is always less than or equal to the array\u2019s size (because\narray indices start at zero). To get the size of an array, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size(id)</a>\nfunction.</p>\n<p>The following example uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.set\">set()</a>\nmethod to populate a <code dir=\"auto\">fillColors</code> array with instances of one base color\nusing different transparency levels. It then uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a>\nto retrieve one of the colors from the array based on the location of\nthe bar with the highest price within the last <code dir=\"auto\">lookbackInput</code> bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-ReadingAndWriting-DistanceFromHigh.B8Ur_B4a_Z1HV6bi.webp\" width=\"1542\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Distance from high\", \"\", true)\nlookbackInput = input.int(100)\nFILL_COLOR = color.green\n// Declare array and set its values on the first bar only.\nvar fillColors = array.new&lt;color&gt;(5)\nif barstate.isfirst\n    // Initialize the array elements with progressively lighter shades of the fill color.\n    fillColors.set(0, color.new(FILL_COLOR, 70))\n    fillColors.set(1, color.new(FILL_COLOR, 75))\n    fillColors.set(2, color.new(FILL_COLOR, 80))\n    fillColors.set(3, color.new(FILL_COLOR, 85))\n    fillColors.set(4, color.new(FILL_COLOR, 90))\n\n// Find the offset to highest high. Change its sign because the function returns a negative value.\nlastHiBar = - ta.highestbars(high, lookbackInput)\n// Convert the offset to an array index, capping it to 4 to avoid a runtime error.\n// The index used by `array.get()` will be the equivalent of `floor(fillNo)`.\nfillNo = math.min(lastHiBar / (lookbackInput / 5), 4)\n// Set background to a progressively lighter fill with increasing distance from location of highest high.\nbgcolor(array.get(fillColors, fillNo))\n// Plot key values to the Data Window for debugging.\nplotchar(lastHiBar, \"lastHiBar\", \"\", location.top, size = size.tiny)\nplotchar(fillNo, \"fillNo\", \"\", location.top, size = size.tiny)</div>\n<p>Another technique for initializing the elements in an array is to create\nan <em>empty array</em> (an array with no elements), then use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nto append <strong>new</strong> elements to the end of the array, increasing the size\nof the array by one on each call. The following code is functionally\nidentical to the initialization section from the preceding script:</p>\n<div class=\"pine-colorizer not-content\">// Declare array and set its values on the first bar only.\nvar fillColors = array.new&lt;color&gt;(0)\nif barstate.isfirst\n    // Initialize the array elements with progressively lighter shades of the fill color.\n    array.push(fillColors, color.new(FILL_COLOR, 70))\n    array.push(fillColors, color.new(FILL_COLOR, 75))\n    array.push(fillColors, color.new(FILL_COLOR, 80))\n    array.push(fillColors, color.new(FILL_COLOR, 85))\n    array.push(fillColors, color.new(FILL_COLOR, 90))</div>\n<p>This code is equivalent to the one above, but it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.unshift\">array.unshift()</a>\nto insert new elements at the <em>beginning</em> of the <code dir=\"auto\">fillColors</code> array:</p>\n<div class=\"pine-colorizer not-content\">// Declare array and set its values on the first bar only.\nvar fillColors = array.new&lt;color&gt;(0)\nif barstate.isfirst\n    // Initialize the array elements with progressively lighter shades of the fill color.\n    array.unshift(fillColors, color.new(FILL_COLOR, 90))\n    array.unshift(fillColors, color.new(FILL_COLOR, 85))\n    array.unshift(fillColors, color.new(FILL_COLOR, 80))\n    array.unshift(fillColors, color.new(FILL_COLOR, 75))\n    array.unshift(fillColors, color.new(FILL_COLOR, 70))</div>\n<p>We can also use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.from\">array.from()</a>\nto create the same <code dir=\"auto\">fillColors</code> array with a single function call:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Using `var`\")\nFILL_COLOR = color.green\nvar array&lt;color&gt; fillColors = array.from(\n     color.new(FILL_COLOR, 70),\n     color.new(FILL_COLOR, 75),\n     color.new(FILL_COLOR, 80),\n     color.new(FILL_COLOR, 85),\n     color.new(FILL_COLOR, 90)\n )\n// Cycle background through the array's colors.\nbgcolor(array.get(fillColors, bar_index % (fillColors.size())))</div>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.fill\">array.fill(id, value, index_from,\nindex_to)</a>\nfunction points all array elements, or the elements within the\n<code dir=\"auto\">index_from</code> to <code dir=\"auto\">index_to</code> range, to a specified <code dir=\"auto\">value</code>. Without the\nlast two optional parameters, the function fills the whole array, so:</p>\n<div class=\"pine-colorizer not-content\">a = array.new&lt;float&gt;(10, close)</div>\n<p>and:</p>\n<div class=\"pine-colorizer not-content\">a = array.new&lt;float&gt;(10)\na.fill(close)</div>\n<p>are equivalent, but:</p>\n<div class=\"pine-colorizer not-content\">a = array.new&lt;float&gt;(10)\na.fill(close, 1, 3)</div>\n<p>only fills the second and third elements (at index 1 and 2) of the array\nwith <code dir=\"auto\">close</code>. Note how\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.fill\">array.fill()</a>\u2018s\nlast parameter, <code dir=\"auto\">index_to</code>, must be one greater than the last index the\nfunction will fill. The remaining elements will hold <code dir=\"auto\">na</code> values, as the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new()</a>\nfunction call does not contain an <code dir=\"auto\">initial_value</code> argument.</p>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"looping-through-array-elements\"><a href=\"#looping-through-array-elements\">Looping through array elements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When looping through an array\u2019s element indices and the array\u2019s size\nis unknown, one can use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a>\nfunction to get the maximum index value. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Protected `for` loop\", overlay = true)\n//@variable An array of `close` prices from the 1-minute timeframe.\narray&lt;float&gt; a = request.security_lower_tf(syminfo.tickerid, \"1\", close)\n\n//@variable A string representation of the elements in `a`.\nstring labelText = \"\"\nfor i = 0 to (array.size(a) == 0 ? na : array.size(a) - 1)\n    labelText += str.tostring(array.get(a, i)) + \"\\n\"\n\nlabel.new(bar_index, high, text = labelText)</div>\n<p>Note that:</p>\n<ul>\n<li>We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction which returns an array of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices at the <code dir=\"auto\">1 minute</code> timeframe.</li>\n<li>This code example will throw an error if you use it on a chart\ntimeframe smaller than <code dir=\"auto\">1 minute</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloops do not execute if the <code dir=\"auto\">to</code> expression is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.\nNote that the <code dir=\"auto\">to</code> value is only evaluated once upon entry.</li>\n</ul>\n<p>An alternative method to loop through an array is to use a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop. This approach is a variation of the standard for loop that can\niterate over the value references and indices in an array. Here is an\nexample of how we can write the code example from above using a\n<code dir=\"auto\">for...in</code> loop:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for...in` loop\", overlay = true)\n//@variable An array of `close` prices from the 1-minute timeframe.\narray&lt;float&gt; a = request.security_lower_tf(syminfo.tickerid, \"1\", close)\n\n//@variable A string representation of the elements in `a`.\nstring labelText = \"\"\nfor price in a\n    labelText += str.tostring(price) + \"\\n\"\n\nlabel.new(bar_index, high, text = labelText)</div>\n<p>Note that:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloops can return a tuple containing each index and corresponding\nelement. For example, <code dir=\"auto\">for [i, price] in a</code> returns the <code dir=\"auto\">i</code>\nindex and <code dir=\"auto\">price</code> value for each element in <code dir=\"auto\">a</code>.</li>\n</ul>\n<p>A\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nloop statement can also be used:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`while` loop\", overlay = true)\narray&lt;float&gt; a = request.security_lower_tf(syminfo.tickerid, \"1\", close)\n\nstring labelText = \"\"\nint i = 0\nwhile i &lt; array.size(a)\n    labelText += str.tostring(array.get(a, i)) + \"\\n\"\n    i += 1\n\nlabel.new(bar_index, high, text = labelText)</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"scope\"><a href=\"#scope\">Scope<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Users can declare arrays within the global scope of a script, as well as\nthe local scopes of\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a>,\n<a href=\"/pine-script-docs/v5/language/methods/\">methods</a>, and\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>. Unlike some of the other built-in types, namely\n<em>fundamental</em> types, scripts can modify globally-assigned arrays from\nwithin local scopes, allowing users to implement global variables that\nany function in the script can directly interact with. We use the\nfunctionality here to calculate progressively lower or higher price\nlevels:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-Scope-Bands.BasWVnm1_2v9lBn.webp\" width=\"1600\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Bands\", \"\", true)\n//@variable The distance ratio between plotted price levels.\nfactorInput = 1 + (input.float(-2., \"Step %\") / 100)\n//@variable A single-value array holding the lowest `ohlc4` value within a 50 bar window from 10 bars back.\nlevel = array.new&lt;float&gt;(1, ta.lowest(ohlc4, 50)[10])\n\nnextLevel(val) =&gt;\n    newLevel = level.get(0) * val\n    // Write new level to the global `level` array so we can use it as the base in the next function call.\n    level.set(0, newLevel)\n    newLevel\n\nplot(nextLevel(1))\nplot(nextLevel(factorInput))\nplot(nextLevel(factorInput))\nplot(nextLevel(factorInput))</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"history-referencing\"><a href=\"#history-referencing\">History referencing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u2019s history-referencing operator <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[\n]</a> can\naccess the history of array variables, allowing scripts to interact with\npast array instances previously assigned to a variable.</p>\n<p>To illustrate this, let\u2019s create a simple example to show how one can\nfetch the previous bar\u2019s <code dir=\"auto\">close</code> value in two equivalent ways. This\nscript uses the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[\n]</a>\noperator to get the array instance assigned to <code dir=\"auto\">a</code> on the previous bar,\nthen uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">get()</a>\nmethod to retrieve the value of the first element (<code dir=\"auto\">previousClose1</code>).\nFor <code dir=\"auto\">previousClose2</code>, we use the history-referencing operator on the\n<code dir=\"auto\">close</code> variable directly to retrieve the value. As we see from the\nplots, <code dir=\"auto\">previousClose1</code> and <code dir=\"auto\">previousClose2</code> both return the same value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"314\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-History-referencing.D1DIjFIM_Z23jPGQ.webp\" width=\"1728\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"History referencing\")\n\n//@variable A single-value array declared on each bar.\na = array.new&lt;float&gt;(1)\n// Set the value of the only element in `a` to `close`.\narray.set(a, 0, close)\n\n//@variable The array instance assigned to `a` on the previous bar.\nprevious = a[1]\n\npreviousClose1 = na(previous) ? na : previous.get(0)\npreviousClose2 = close[1]\n\nplot(previousClose1, \"previousClose1\", color.gray, 6)\nplot(previousClose2, \"previousClose2\", color.white, 2)</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"inserting-and-removing-array-elements\"><a href=\"#inserting-and-removing-array-elements\">Inserting and removing array elements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"inserting\"><a href=\"#inserting\">Inserting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The following three functions can insert new elements into an array.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.unshift\">array.unshift()</a>\ninserts a new element at the beginning of an array (index 0) and\nincreases the index values of any existing elements by one.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.insert\">array.insert()</a>\ninserts a new element at the specified <code dir=\"auto\">index</code> and increases the index\nof existing elements at or after the <code dir=\"auto\">index</code> by one.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"182\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-InsertingAndRemovingArrayElements-Insert.jdY5CZ2M_Z1kDUQL.webp\" width=\"1020\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.insert()`\")\na = array.new&lt;float&gt;(5, 0)\nfor i = 0 to 4\n    array.set(a, i, i + 1)\nif barstate.islast\n    label.new(bar_index, 0, \"BEFORE\\na: \" + str.tostring(a), size = size.large)\n    array.insert(a, 2, 999)    \n    label.new(bar_index, 0, \"AFTER\\na: \" + str.tostring(a), style = label.style_label_up, size = size.large)</div>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nadds a new element at the end of an array.</p>\n<h3 class=\"md-heading\" id=\"removing\"><a href=\"#removing\">Removing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>These four functions remove elements from an array. The first three also\nreturn the value of the removed element.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.remove\">array.remove()</a>\nremoves the element at the specified <code dir=\"auto\">index</code> and returns that element\u2019s\nvalue.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nremoves the first element from an array and returns its value.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.pop\">array.pop()</a>\nremoves the last element of an array and returns its value.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.clear\">array.clear()</a>\nremoves all elements from an array. Note that clearing an array won\u2019t\ndelete any objects its elements referenced. See the example below that\nillustrates how this works:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.clear()` example\", overlay = true)\n\n// Create a label array and add a label to the array on each new bar.\nvar a = array.new&lt;label&gt;()\nlabel lbl = label.new(bar_index, high, \"Text\", color = color.red)\narray.push(a, lbl)\n\nvar table t = table.new(position.top_right, 1, 1)\n// Clear the array on the last bar. This doesn't remove the labels from the chart. \nif barstate.islast\n    array.clear(a)\n    table.cell(t, 0, 0, \"Array elements count: \" + str.tostring(array.size(a)), bgcolor = color.yellow)</div>\n<h3 class=\"md-heading\" id=\"using-an-array-as-a-stack\"><a href=\"#using-an-array-as-a-stack\">Using an array as a stack<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Stacks are LIFO (last in, first out) constructions. They behave somewhat\nlike a vertical pile of books to which books can only be added or\nremoved one at a time, always from the top. Pine Script arrays can be\nused as a stack, in which case we use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.pop\">array.pop()</a>\nfunctions to add and remove elements at the end of the array.</p>\n<p><code dir=\"auto\">array.push(prices, close)</code> will add a new element to the end of the\n<code dir=\"auto\">prices</code> array, increasing the array\u2019s size by one.</p>\n<p><code dir=\"auto\">array.pop(prices)</code> will remove the end element from the <code dir=\"auto\">prices</code> array,\nreturn its value and decrease the array\u2019s size by one.</p>\n<p>See how the functions are used here to track successive lows in rallies:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"568\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-InsertingAndRemovingArrayElements-LowsFromNewHighs.V3h-ojnF_Z1hO9xN.webp\" width=\"1600\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Lows from new highs\", \"\", true)\nvar lows = array.new&lt;float&gt;(0)\nflushLows = false\n\n// Remove last element from the stack when `_cond` is true.\narray_pop(id, cond) =&gt; cond and array.size(id) &gt; 0 ? array.pop(id) : float(na)\n\nif ta.rising(high, 1)\n    // Rising highs; push a new low on the stack.\n    lows.push(low)\n    // Force the return type of this `if` block to be the same as that of the next block.\n    bool(na)\nelse if lows.size() &gt;= 4 or low &lt; array.min(lows)\n    // We have at least 4 lows or price has breached the lowest low;\n    // sort lows and set flag indicating we will plot and flush the levels.\n    array.sort(lows, order.ascending)\n    flushLows := true\n\n// If needed, plot and flush lows.\nlowLevel = array_pop(lows, flushLows)\nplot(lowLevel, \"Low 1\", low &gt; lowLevel ? color.silver : color.purple, 2, plot.style_linebr)\nlowLevel := array_pop(lows, flushLows)\nplot(lowLevel, \"Low 2\", low &gt; lowLevel ? color.silver : color.purple, 3, plot.style_linebr)\nlowLevel := array_pop(lows, flushLows)\nplot(lowLevel, \"Low 3\", low &gt; lowLevel ? color.silver : color.purple, 4, plot.style_linebr)\nlowLevel := array_pop(lows, flushLows)\nplot(lowLevel, \"Low 4\", low &gt; lowLevel ? color.silver : color.purple, 5, plot.style_linebr)\n\nif flushLows\n    // Clear remaining levels after the last 4 have been plotted.\n    lows.clear()</div>\n<h3 class=\"md-heading\" id=\"using-an-array-as-a-queue\"><a href=\"#using-an-array-as-a-queue\">Using an array as a queue<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Queues are FIFO (first in, first out) constructions. They behave\nsomewhat like cars arriving at a red light. New cars are queued at the\nend of the line, and the first car to leave will be the first one that\narrived to the red light.</p>\n<p>In the following code example, we let users decide through the script\u2019s\ninputs how many labels they want to have on their chart. We use that\nquantity to determine the size of the array of labels we then create,\ninitializing the array\u2019s elements to <code dir=\"auto\">na</code>.</p>\n<p>When a new pivot is detected, we create a label for it, saving the\nlabel\u2019s ID in the <code dir=\"auto\">pLabel</code> variable. We then queue the ID of that label\nby using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nto append the new label\u2019s ID to the end of the array, making our array\nsize one greater than the maximum number of labels to keep on the chart.</p>\n<p>Lastly, we de-queue the oldest label by removing the array\u2019s first\nelement using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nand deleting the label referenced by that array element\u2019s value. As we\nhave now de-queued an element from our queue, the array contains\n<code dir=\"auto\">pivotCountInput</code> elements once again. Note that on the dataset\u2019s first\nbars we will be deleting <code dir=\"auto\">na</code> label IDs until the maximum number of\nlabels has been created, but this does not cause runtime errors. Let\u2019s\nlook at our code:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"572\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-InsertingAndRemovingArrayElements-ShowLastnHighPivots.WcryVum8_201EAB.webp\" width=\"1602\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nMAX_LABELS = 100\nindicator(\"Show Last n High Pivots\", \"\", true, max_labels_count = MAX_LABELS)\n\npivotCountInput = input.int(5, \"How many pivots to show\", minval = 0, maxval = MAX_LABELS)\npivotLegsInput  = input.int(3, \"Pivot legs\", minval = 1, maxval = 5)\n\n// Create an array containing the user-selected max count of label IDs.\nvar labelIds = array.new&lt;label&gt;(pivotCountInput)\n\npHi = ta.pivothigh(pivotLegsInput, pivotLegsInput)\nif not na(pHi)\n    // New pivot found; plot its label `i_pivotLegs` bars back.\n    pLabel = label.new(bar_index[pivotLegsInput], pHi, str.tostring(pHi, format.mintick), textcolor = color.white)\n    // Queue the new label's ID by appending it to the end of the array.\n    array.push(labelIds, pLabel)\n    // De-queue the oldest label ID from the queue and delete the corresponding label.\n    label.delete(array.shift(labelIds))</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"calculations-on-arrays\"><a href=\"#calculations-on-arrays\">Calculations on arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>While series variables can be viewed as a horizontal set of values\nstretching back in time, Pine Script\u2019s one-dimensional arrays can be\nviewed as vertical structures residing on each bar. As an array\u2019s set\nof elements is not a\n<a href=\"/pine-script-docs/v5/language/time-series/\">time series</a>,\nPine Script\u2019s usual mathematical functions are not allowed on them.\nSpecial-purpose functions must be used to operate on all of an array\u2019s\nvalues. The available functions are:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.abs\">array.abs()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">array.avg()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.covariance\">array.covariance()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">array.min()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.max\">array.max()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.median\">array.median()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.mode\">array.mode()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.percentile_linear_interpolation\">array.percentile_linear_interpolation()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.percentile_nearest_rank\">array.percentile_nearest_rank()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.percentrank\">array.percentrank()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.range\">array.range()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.standardize\">array.standardize()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.stdev\">array.stdev()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.sum\">array.sum()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.variance\">array.variance()</a>.</p>\n<p>Note that contrary to the usual mathematical functions in Pine Script,\nthose used on arrays do not return <code dir=\"auto\">na</code> when some of the values they\ncalculate on have <code dir=\"auto\">na</code> values. There are a few exceptions to this rule:</p>\n<ul>\n<li>When all array elements have <code dir=\"auto\">na</code> value or the array contains no\nelements, <code dir=\"auto\">na</code> is returned. <code dir=\"auto\">array.standardize()</code> however, will\nreturn an empty array.</li>\n<li><code dir=\"auto\">array.mode()</code> will return <code dir=\"auto\">na</code> when no mode is found.</li>\n</ul>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"manipulating-arrays\"><a href=\"#manipulating-arrays\">Manipulating arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"concatenation\"><a href=\"#concatenation\">Concatenation<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Two arrays can be merged \u2014 or concatenated \u2014 using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.concat\">array.concat()</a>.\nWhen arrays are concatenated, the second array is appended to the end of\nthe first, so the first array is modified while the second one remains\nintact. The function returns the array ID of the first array:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"246\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-ManipulatingArrays-Concat.CQ5DQ3gZ_ZTX5jU.webp\" width=\"1036\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.concat()`\")\na = array.new&lt;float&gt;(0)\nb = array.new&lt;float&gt;(0)\narray.push(a, 0)\narray.push(a, 1)\narray.push(b, 2)\narray.push(b, 3)\nif barstate.islast\n    label.new(bar_index, 0, \"BEFORE\\na: \" + str.tostring(a) + \"\\nb: \" + str.tostring(b), size = size.large)\n    c = array.concat(a, b)\n    array.push(c, 4)\n    label.new(bar_index, 0, \"AFTER\\na: \" + str.tostring(a) + \"\\nb: \" + str.tostring(b) + \"\\nc: \" + str.tostring(c), style = label.style_label_up, size = size.large)</div>\n<h3 class=\"md-heading\" id=\"copying\"><a href=\"#copying\">Copying<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>You can copy an array using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.copy\">array.copy()</a>.\nHere we copy the array <code dir=\"auto\">a</code> to a new array named <code dir=\"auto\">_b</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"190\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-ManipulatingArrays-Copy.CEsYR745_Z1XGnfX.webp\" width=\"1018\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.copy()`\")\na = array.new&lt;float&gt;(0)\narray.push(a, 0)\narray.push(a, 1)\nif barstate.islast\n    b = array.copy(a)\n    array.push(b, 2)\n    label.new(bar_index, 0, \"a: \" + str.tostring(a) + \"\\nb: \" + str.tostring(b), size = size.large)</div>\n<p>Note that simply using <code dir=\"auto\">_b = a</code> in the previous example would not have\ncopied the array, but only its ID. From thereon, both variables would\npoint to the same array, so using either one would affect the same\narray.</p>\n<h3 class=\"md-heading\" id=\"joining\"><a href=\"#joining\">Joining<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.join\">array.join()</a>\nto concatenate all of the elements in the array into a string and\nseparate these elements with the specified separator:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nv1 = array.new&lt;string&gt;(10, \"test\")\nv2 = array.new&lt;string&gt;(10, \"test\")\narray.push(v2, \"test1\")\nv3 = array.new_float(5, 5)\nv4 = array.new_int(5, 5)\nl1 = label.new(bar_index, close, array.join(v1))\nl2 = label.new(bar_index, close, array.join(v2, \",\"))\nl3 = label.new(bar_index, close, array.join(v3, \",\"))\nl4 = label.new(bar_index, close, array.join(v4, \",\"))</div>\n<h3 class=\"md-heading\" id=\"sorting\"><a href=\"#sorting\">Sorting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Arrays containing \u201cint\u201d or \u201cfloat\u201d elements can be sorted in either\nascending or descending order using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.sort\">array.sort()</a>.\nThe <code dir=\"auto\">order</code> parameter is optional and defaults to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_order.ascending\">order.ascending</a>.\nAs all <code dir=\"auto\">array.*()</code> function arguments, it is qualified as \u201cseries\u201d, so\ncan be determined at runtime, as is done here. Note that in the example,\nwhich array is sorted is also determined at runtime:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"570\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-ManipulatingArrays-Sort.haUz9_aY_1pWobe.webp\" width=\"1077\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.sort()`\")\na = array.new&lt;float&gt;(0)\nb = array.new&lt;float&gt;(0)\narray.push(a, 2)\narray.push(a, 0)\narray.push(a, 1)\narray.push(b, 4)\narray.push(b, 3)\narray.push(b, 5)\nif barstate.islast\n    barUp = close &gt; open\n    array.sort(barUp ? a : b, barUp ? order.ascending : order.descending)\n    label.new(bar_index, 0, \n      \"a \" + (barUp ? \"is sorted \u25b2: \"   : \"is not sorted: \") + str.tostring(a) + \"\\n\\n\" +\n      \"b \" + (barUp ? \"is not sorted: \" : \"is sorted \u25bc: \")   + str.tostring(b), size = size.large)</div>\n<p>Another useful option for sorting arrays is to use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.sort_indices\">array.sort_indices()</a>\nfunction, which takes a reference to the original array and returns an\narray containing the indices from the original array. Please note that\nthis function won\u2019t modify the original array. The <code dir=\"auto\">order</code> parameter is\noptional and defaults to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_order.ascending\">order.ascending</a>.</p>\n<h3 class=\"md-heading\" id=\"reversing\"><a href=\"#reversing\">Reversing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.reverse\">array.reverse()</a>\nto reverse an array:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.reverse()`\")\na = array.new&lt;float&gt;(0)\narray.push(a, 0)\narray.push(a, 1)\narray.push(a, 2)\nif barstate.islast\n    array.reverse(a)\n    label.new(bar_index, 0, \"a: \" + str.tostring(a))</div>\n<h3 class=\"md-heading\" id=\"slicing\"><a href=\"#slicing\">Slicing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Slicing an array using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.slice\">array.slice()</a>\ncreates a shallow copy of a subset of the parent array. You determine\nthe size of the subset to slice using the <code dir=\"auto\">index_from</code> and <code dir=\"auto\">index_to</code>\nparameters. The <code dir=\"auto\">index_to</code> argument must be one greater than the end of\nthe subset you want to slice.</p>\n<p>The shallow copy created by the slice acts like a window on the parent\narray\u2019s content. The indices used for the slice define the window\u2019s\nposition and size over the parent array. If, as in the example below, a\nslice is created from the first three elements of an array (indices 0 to\n2), then regardless of changes made to the parent array, and as long as\nit contains at least three elements, the shallow copy will always\ncontain the parent array\u2019s first three elements.</p>\n<p>Additionally, once the shallow copy is created, operations on the copy\nare mirrored on the parent array. Adding an element to the end of the\nshallow copy, as is done in the following example, will widen the window\nby one element and also insert that element in the parent array at index\n3. In this example, to slice the subset from index 0 to index 2 of array\n<code dir=\"auto\">a</code>, we must use <code dir=\"auto\">_sliceOfA = array.slice(a, 0, 3)</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"214\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Arrays-ManipulatingArrays-Slice.DDHrRFqO_1X3bnc.webp\" width=\"1016\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`array.slice()`\")\na = array.new&lt;float&gt;(0)\narray.push(a, 0)\narray.push(a, 1)\narray.push(a, 2)\narray.push(a, 3)\nif barstate.islast\n    // Create a shadow of elements at index 1 and 2 from array `a`.\n    sliceOfA = array.slice(a, 0, 3)\n    label.new(bar_index, 0, \"BEFORE\\na: \" + str.tostring(a) + \"\\nsliceOfA: \" + str.tostring(sliceOfA))\n    // Remove first element of parent array `a`.\n    array.remove(a, 0)\n    // Add a new element at the end of the shallow copy, thus also affecting the original array `a`.\n    array.push(sliceOfA, 4)\n    label.new(bar_index, 0, \"AFTER\\na: \" + str.tostring(a) + \"\\nsliceOfA: \" + str.tostring(sliceOfA), style = label.style_label_up)</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"searching-arrays\"><a href=\"#searching-arrays\">Searching arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We can test if a value is part of an array with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.includes\">array.includes()</a>\nfunction, which returns true if the element is found. We can find the\nfirst occurrence of a value in an array by using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a>\nfunction. The first occurence is the one with the lowest index. We can\nalso find the last occurrence of a value with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.lastindexof\">array.lastindexof()</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Searching in arrays\")\nvalueInput = input.int(1)\na = array.new&lt;float&gt;(0)\narray.push(a, 0)\narray.push(a, 1)\narray.push(a, 2)\narray.push(a, 1)\nif barstate.islast\n    valueFound      = array.includes(a, valueInput)\n    firstIndexFound = array.indexof(a, valueInput)\n    lastIndexFound  = array.lastindexof(a, valueInput)\n    label.new(bar_index, 0, \"a: \" + str.tostring(a) + \n      \"\\nFirst \" + str.tostring(valueInput) + (firstIndexFound != -1 ? \" value was found at index: \" + str.tostring(firstIndexFound) : \" value was not found.\") +\n      \"\\nLast \" + str.tostring(valueInput)  + (lastIndexFound  != -1 ? \" value was found at index: \" + str.tostring(lastIndexFound) : \" value was not found.\"))</div>\n<p>We can also perform a binary search on an array but note that performing\na binary search on an array means that the array will first need to be\nsorted in ascending order only. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search\">array.binary_search()</a>\nfunction will return the value\u2019s index if it was found or -1 if it\nwasn\u2019t. If we want to always return an existing index from the array\neven if our chosen value wasn\u2019t found, then we can use one of the other\nbinary search functions available. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search_leftmost\">array.binary_search_leftmost()</a>\nfunction, which returns an index if the value was found or the first\nindex to the left where the value would be found. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.binary_search_rightmost\">array.binary_search_rightmost()</a>\nfunction is almost identical and returns an index if the value was found\nor the first index to the right where the value would be found.</p>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/arrays", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"error-handling\"><a href=\"#error-handling\">Error handling<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Malformed <code dir=\"auto\">array.*()</code> call syntax in Pine scripts will cause the usual\n<strong>compiler</strong> error messages to appear in Pine Editor\u2019s console, at the\nbottom of the window, when you save a script. Refer to the Pine Script\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/\">v5 Reference\nManual</a> when in\ndoubt regarding the exact syntax of function calls.</p>\n<p>Scripts using arrays can also throw <strong>runtime</strong> errors, which appear as\nan exclamation mark next to the indicator\u2019s name on the chart. We\ndiscuss those runtime errors in this section.</p>\n<h3 class=\"md-heading\" id=\"index-xx-is-out-of-bounds-array-size-is-yy\"><a href=\"#index-xx-is-out-of-bounds-array-size-is-yy\">Index xx is out of bounds. Array size is yy<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This will most probably be the most frequent error you encounter. It\nwill happen when you reference an nonexistent array index. The \u201cxx\u201d\nvalue will be the value of the faulty index you tried to use, and \u201cyy\u201d\nwill be the size of the array. Recall that array indices start at\nzero \u2014 not one \u2014 and end at the array\u2019s size, minus one. An array of\nsize 3\u2019s last valid index is thus <code dir=\"auto\">2</code>.</p>\n<p>To avoid this error, you must make provisions in your code logic to\nprevent using an index lying outside of the array\u2019s index boundaries.\nThis code will generate the error because the last index we use in the\nloop is outside the valid index range for the array:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Out of bounds index\")\na = array.new&lt;float&gt;(3)\nfor i = 1 to 3\n    array.set(a, i, i)\nplot(array.pop(a))</div>\n<p>The correct <code dir=\"auto\">for</code> statement is:</p>\n<div class=\"pine-colorizer not-content\">for i = 0 to 2</div>\n<p>To loop on all array elements in an array of unknown size, use:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Protected `for` loop\")\nsizeInput = input.int(0, \"Array size\", minval = 0, maxval = 100000)\na = array.new&lt;float&gt;(sizeInput)\nfor i = 0 to (array.size(a) == 0 ? na : array.size(a) - 1)\n    array.set(a, i, i)\nplot(array.pop(a))</div>\n<p>When you size arrays dynamically using a field in your script\u2019s\n<em>Settings/Inputs</em> tab, protect the boundaries of that value using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\u2018s\n<code dir=\"auto\">minval</code> and <code dir=\"auto\">maxval</code> parameters:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Protected array size\")\nsizeInput = input.int(10, \"Array size\", minval = 1, maxval = 100000)\na = array.new&lt;float&gt;(sizeInput)\nfor i = 0 to sizeInput - 1\n    array.set(a, i, i)\nplot(array.size(a))</div>\n<p>See the <a href=\"/pine-script-docs/v5/language/arrays/#looping-through-array-elements\">Looping through array elements</a>\nsection of this page for more information.</p>\n<h3 class=\"md-heading\" id=\"cannot-call-array-methods-when-id-of-array-is-na\"><a href=\"#cannot-call-array-methods-when-id-of-array-is-na\">Cannot call array methods when ID of array is \u2018na\u2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When an array ID is initialized to <code dir=\"auto\">na</code>, operations on it are not\nallowed, since no array exists. All that exists at that point is an\narray variable containing the <code dir=\"auto\">na</code> value rather that a valid array ID\npointing to an existing array. Note that an array created with no\nelements in it, as you do when you use <code dir=\"auto\">a = array.new_int(0)</code>, has a\nvalid ID nonetheless. This code will throw the error we are discussing:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Out of bounds index\")\narray&lt;int&gt; a = na\narray.push(a, 111)\nlabel.new(bar_index, 0, \"a: \" + str.tostring(a))</div>\n<p>To avoid it, create an array with size zero using:</p>\n<div class=\"pine-colorizer not-content\">array&lt;int&gt; a = array.new_int(0)</div>\n<p>or:</p>\n<div class=\"pine-colorizer not-content\">a = array.new_int(0)</div>\n<h3 class=\"md-heading\" id=\"array-is-too-large-maximum-size-is-100000\"><a href=\"#array-is-too-large-maximum-size-is-100000\">Array is too large. Maximum size is 100000<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This error will appear if your code attempts to declare an array with a\nsize greater than 100,000. It will also occur if, while dynamically\nappending elements to an array, a new element would increase the\narray\u2019s size past the maximum.</p>\n<h3 class=\"md-heading\" id=\"cannot-create-an-array-with-a-negative-size\"><a href=\"#cannot-create-an-array-with-a-negative-size\">Cannot create an array with a negative size<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We haven\u2019t found any use for arrays of negative size yet, but if you\never do, we may allow them :)</p>\n<h3 class=\"md-heading\" id=\"cannot-use-shift-if-array-is-empty\"><a href=\"#cannot-use-shift-if-array-is-empty\">Cannot use shift() if array is empty.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This error will occur if\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nis called to remove the first element of an empty array.</p>\n<h3 class=\"md-heading\" id=\"cannot-use-pop-if-array-is-empty\"><a href=\"#cannot-use-pop-if-array-is-empty\">Cannot use pop() if array is empty.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This error will occur if\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.pop\">array.pop()</a>\nis called to remove the last element of an empty array.</p>\n<h3 class=\"md-heading\" id=\"index-from-should-be-less-than-index-to\"><a href=\"#index-from-should-be-less-than-index-to\">Index \u2018from\u2019 should be less than index \u2018to\u2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When two indices are used in functions such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.slice\">array.slice()</a>,\nthe first index must always be smaller than the second one.</p>\n<h3 class=\"md-heading\" id=\"slice-is-out-of-bounds-of-the-parent-array\"><a href=\"#slice-is-out-of-bounds-of-the-parent-array\">Slice is out of bounds of the parent array<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This message occurs whenever the parent array\u2019s size is modified in\nsuch a way that it makes the shallow copy created by a slice point\noutside the boundaries of the parent array. This code will reproduce it\nbecause after creating a slice from index 3 to 4 (the last two elements\nof our five-element parent array), we remove the parent\u2019s first\nelement, making its size four and its last index 3. From that moment on,\nthe shallow copy which is still poiting to the \u201cwindow\u201d at the parent\narray\u2019s indices 3 to 4, is pointing out of the parent array\u2019s\nboundaries:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Slice out of bounds\")\na = array.new&lt;float&gt;(5, 0)\nb = array.slice(a, 3, 5)\narray.remove(a, 0)\nc = array.indexof(b, 2)\nplot(c)</div>", "segment_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "c3f0455e2e2afe8e0126e5882a9b93f6abdc3732cfd046ef38e35b8757a25121", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/built-ins", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/built-ins\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"built-ins\"><a href=\"#built-ins\">Built-ins<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/built-ins", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae has hundreds of <em>built-in</em> variables and functions. They\nprovide your scripts with valuable information and make calculations for\nyou, dispensing you from coding them. The better you know the built-ins,\nthe more you will be able to do with your Pine scripts.</p>\n<p>In this page we present an overview of some of Pine Script\u2019s built-in\nvariables and functions. They will be covered in more detail in the\npages of this manual covering specific themes.</p>\n<p>All built-in variables and functions are defined in the Pine Script <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">v5\nReference\nManual</a>. It is\ncalled a \u201cReference Manual\u201d because it is the definitive reference on\nthe Pine Script language. It is an essential tool that will accompany\nyou anytime you code in Pine, whether you are a beginner or an expert.\nIf you are learning your first programming language, make the <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">Reference\nManual</a> your\nfriend. Ignoring it will make your programming experience with Pine\nScript difficult and frustrating \u2014 as it would with any other\nprogramming language.</p>\n<p>Variables and functions in the same family share the same <em>namespace</em>,\nwhich is a prefix to the function\u2019s name. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>\nfunction, for example, is in the <code dir=\"auto\">ta</code> namespace, which stands for\n\u201ctechnical analysis\u201d. A namespace can contain both variables and\nfunctions.</p>\n<p>Some variables have function versions as well, e.g.:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dtr\">ta.tr</a>\nvariable returns the \u201cTrue Range\u201d of the current bar. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dtr\">ta.tr(true)</a>\nfunction call also returns the \u201cTrue Range\u201d, but when the previous\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalue which is normally needed to calculate it is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nit calculates using <code dir=\"auto\">high - low</code> instead.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nvariable gives the time at the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nof the current bar. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time(timeframe)</a>\nfunction returns the time of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nfrom the <code dir=\"auto\">timeframe</code> specified, even if the chart\u2019s timeframe is\ndifferent. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time(timeframe,\nsession)</a>\nfunction returns the time of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nfrom the <code dir=\"auto\">timeframe</code> specified, but only if it is within the\n<code dir=\"auto\">session</code> time. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time(timeframe, session,\ntimezone)</a>\nfunction returns the time of the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nfrom the <code dir=\"auto\">timeframe</code> specified, but only if it is within the\n<code dir=\"auto\">session</code> time in the specified <code dir=\"auto\">timezone</code>.</li>\n</ul>", "segment_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/built-ins", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"built-in-variables\"><a href=\"#built-in-variables\">Built-in variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Built-in variables exist for different purposes. These are a few\nexamples:</p>\n<ul>\n<li>Price- and volume-related variables:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlc3\">hlc3</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>.</li>\n<li>Symbol-related information in the <code dir=\"auto\">syminfo</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dbasecurrency\">syminfo.basecurrency</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dcurrency\">syminfo.currency</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Ddescription\">syminfo.description</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dmintick\">syminfo.mintick</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dpointvalue\">syminfo.pointvalue</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dprefix\">syminfo.prefix</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Droot\">syminfo.root</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dsession\">syminfo.session</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dticker\">syminfo.ticker</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtickerid\">syminfo.tickerid</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtimezone\">syminfo.timezone</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dtype\">syminfo.type</a>.</li>\n<li>Timeframe (a.k.a. \u201cinterval\u201d or \u201cresolution\u201d, e.g., 15sec,\n30min, 60min, 1D, 3M) variables in the <code dir=\"auto\">timeframe</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disseconds\">timeframe.isseconds</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disminutes\">timeframe.isminutes</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disintraday\">timeframe.isintraday</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdaily\">timeframe.isdaily</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disweekly\">timeframe.isweekly</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dismonthly\">timeframe.ismonthly</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdwm\">timeframe.isdwm</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dmultiplier\">timeframe.multiplier</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dperiod\">timeframe.period</a>.</li>\n<li>Bar states in the <code dir=\"auto\">barstate</code> namespace (see the\n<a href=\"/pine-script-docs/v5/concepts/bar-states/\">Bar states</a> page):\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disconfirmed\">barstate.isconfirmed</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disfirst\">barstate.isfirst</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dishistory\">barstate.ishistory</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislastconfirmedhistory\">barstate.islastconfirmedhistory</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disrealtime\">barstate.isrealtime</a>.</li>\n<li>Strategy-related information in the <code dir=\"auto\">strategy</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dequity\">strategy.equity</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dinitial_capital\">strategy.initial_capital</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dgrossloss\">strategy.grossloss</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dgrossprofit\">strategy.grossprofit</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dwintrades\">strategy.wintrades</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dlosstrades\">strategy.losstrades</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dposition_size\">strategy.position_size</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dposition_avg_price\">strategy.position_avg_price</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dwintrades\">strategy.wintrades</a>,\netc.</li>\n</ul>", "segment_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/built-ins", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"built-in-functions\"><a href=\"#built-in-functions\">Built-in functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Many functions are used for the result(s) they return. These are a few\nexamples:</p>\n<ul>\n<li>Math-related functions in the <code dir=\"auto\">math</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dabs\">math.abs()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dlog\">math.log()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dmax\">math.max()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Drandom\">math.random()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dround_to_mintick\">math.round_to_mintick()</a>,\netc.</li>\n<li>Technical indicators in the <code dir=\"auto\">ta</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmacd\">ta.macd()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Drsi\">ta.rsi()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsupertrend\">ta.supertrend()</a>,\netc.</li>\n<li>Support functions often used to calculate technical indicators in\nthe <code dir=\"auto\">ta</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dbarssince\">ta.barssince()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dcrossover\">ta.crossover()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dhighest\">ta.highest()</a>,\netc.</li>\n<li>Functions to request data from other symbols or timeframes in the\n<code dir=\"auto\">request</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Ddividends\">request.dividends()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dearnings\">request.earnings()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dfinancial\">request.financial()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dquandl\">request.quandl()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsplits\">request.splits()</a>.</li>\n<li>Functions to manipulate strings in the <code dir=\"auto\">str</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dformat\">str.format()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dlength\">str.length()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtonumber\">str.tonumber()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dtostring\">str.tostring()</a>,\netc.</li>\n<li>Functions used to define the input values that script users can\nmodify in the script\u2019s \u201cSettings/Inputs\u201d tab, in the <code dir=\"auto\">input</code>\nnamespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input\">input()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dcolor\">input.color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dint\">input.int()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.session()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsymbol\">input.symbol()</a>,\netc.</li>\n<li>Functions used to manipulate colors in the <code dir=\"auto\">color</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dfrom_gradient\">color.from_gradient()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.rgb()</a>,\netc.</li>\n</ul>\n<p>Some functions do not return a result but are used for their side\neffects, which means they do something, even if they don\u2019t return a\nresult:</p>\n<ul>\n<li>Functions used as a declaration statement defining one of three\ntypes of Pine scripts, and its properties. Each script must begin\nwith a call to one of these functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>.</li>\n<li>Plotting or coloring functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>.</li>\n<li>Strategy functions placing orders, in the <code dir=\"auto\">strategy</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dcancel\">strategy.cancel()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dorder\">strategy.order()</a>,\netc.</li>\n<li>Strategy functions returning information on indivdual past trades,\nin the <code dir=\"auto\">strategy</code> namespace:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_bar_index\">strategy.closedtrades.entry_bar_index()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_price\">strategy.closedtrades.entry_price()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_time\">strategy.closedtrades.entry_time()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_bar_index\">strategy.closedtrades.exit_bar_index()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dmax_drawdown\">strategy.closedtrades.max_drawdown()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dmax_runup\">strategy.closedtrades.max_runup()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dprofit\">strategy.closedtrades.profit()</a>,\netc.</li>\n<li>Functions to generate alert events:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>.</li>\n</ul>\n<p>Other functions return a result, but we don\u2019t always use it, e.g.:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpop\">array.pop()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>,\netc.</p>\n<p>All built-in functions are defined in the Pine Script <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">v5 Reference\nManual</a>. You can\nclick on any of the function names listed here to go to its entry in the\nReference Manual, which documents the function\u2019s signature, i.e., the\nlist of <em>parameters</em> it accepts and the qualified type of the value(s)\nit returns (a function can return more than one result). The Reference\nManual entry will also list, for each parameter:</p>\n<ul>\n<li>Its name.</li>\n<li>The qualified type of the value it requires (we use <em>argument</em> to\nname the values passed to a function when calling it).</li>\n<li>If the parameter is required or not.</li>\n</ul>\n<p>All built-in functions have one or more parameters defined in their\nsignature. Not all parameters are required for every function.</p>\n<p>Let\u2019s look at the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dvwma\">ta.vwma()</a>\nfunction, which returns the volume-weighted moving average of a source\nvalue. This is its entry in the Reference Manual:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"838\" loading=\"lazy\" src=\"/pine-script-docs/_astro/BuiltIns-BuiltInFunctions.Csw66lto_Z11CbGU.webp\" width=\"1418\"/></p>\n<p>The entry gives us the information we need to use it:</p>\n<ul>\n<li>What the function does.</li>\n<li>Its signature (or definition):</li>\n</ul>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">ta.vwma(source, length) \u2192 series float</span></div></div></code></pre></figure></link></div>\n<ul>\n<li>The parameters it includes: <code dir=\"auto\">source</code> and <code dir=\"auto\">length</code></li>\n<li>The qualified type of the result it returns: \u201cseries float\u201d.</li>\n<li>An example showing it in use: <code dir=\"auto\">plot(ta.vwma(close, 15))</code>.</li>\n<li>An example showing what it does, but in long form, so you can better\nunderstand its calculations. Note that this is meant to explain ---\nnot as usable code, because it is more complicated and takes longer\nto execute. There are only disadvantages to using the long form.</li>\n<li>The \u201cRETURNS\u201d section explains exacty what value the function\nreturns.</li>\n<li>The \u201cARGUMENTS\u201d section lists each parameter and gives the\ncritical information concerning what qualified type is required for\narguments used when calling the function.</li>\n<li>The \u201cSEE ALSO\u201d section refers you to related Reference Manual\nentries.</li>\n</ul>\n<p>This is a call to the function in a line of code that declares a\n<code dir=\"auto\">myVwma</code> variable and assigns the result of <code dir=\"auto\">ta.vwma(close, 20)</code> to it:</p>\n<div class=\"pine-colorizer not-content\">myVwma = ta.vwma(close, 20)</div>\n<p>Note that:</p>\n<ul>\n<li>We use the built-in variable\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nas the argument for the <code dir=\"auto\">source</code> parameter.</li>\n<li>We use <code dir=\"auto\">20</code> as the argument for the <code dir=\"auto\">length</code> parameter.</li>\n<li>If placed in the global scope (i.e., starting in a line\u2019s first\nposition), it will be executed by the Pine Script runtime on each\nbar of the chart.</li>\n</ul>\n<p>We can also use the parameter names when calling the function. Parameter\nnames are called <em>keyword arguments</em> when used in a function call:</p>\n<div class=\"pine-colorizer not-content\">myVwma = ta.vwma(source = close, length = 20)</div>\n<p>You can change the position of arguments when using keyword arguments,\nbut only if you use them for all your arguments. When calling functions\nwith many parameters such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\nyou can also forego keyword arguments for the first arguments, as long\nas you don\u2019t skip any. If you skip some, you must then use keyword\narguments so the Pine Script compiler can figure out which parameter\nthey correspond to, e.g.:</p>\n<div class=\"pine-colorizer not-content\">indicator(\"Example\", \"Ex\", true, max_bars_back = 100)</div>\n<p>Mixing things up this way is not allowed:</p>\n<div class=\"pine-colorizer not-content\">indicator(precision = 3, \"Example\") // Compilation error!</div>\n<p><strong>When calling built-ins, it is critical to ensure that the arguments\nyou use are of the required qualified type, which will vary for each\nparameter.</strong></p>\n<p>To learn how to do this, one needs to understand Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/\">type system</a>. The\nReference Manual entry for each built-in function includes an\n\u201cARGUMENTS\u201d section which lists the qualified type required for the\nargument supplied to each of the function\u2019s parameters.</p>", "segment_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "33140045eac476a912a32134d992faeb2942b2e0c1499652cd73defaf2082ce4", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/conditional-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/conditional-structures\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"conditional-structures\"><a href=\"#conditional-structures\">Conditional structures<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/conditional-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The conditional structures in Pine Script\u00ae are\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>.\nThey can be used:</p>\n<ul>\n<li>For their side effects, i.e., when they don\u2019t return a value but do\nthings, like reassign values to variables or call functions.</li>\n<li>To return a value or a tuple which can then be assigned to one (or\nmore, in the case of tuples) variable.</li>\n</ul>\n<p>Conditional structures, like the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nstructures, can be embedded; you can use an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\ninside another structure.</p>\n<p>Some Pine Script built-in functions cannot be called from within the\nlocal blocks of conditional structures. They are:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>.\nThis does not entail their functionality cannot be controlled by\nconditions evaluated by your script \u2014 only that it cannot be done by\nincluding them in conditional structures. Note that while <code dir=\"auto\">input*.()</code>\nfunction calls are allowed in local blocks, their functionality is the\nsame as if they were in the script\u2019s global scope.</p>\n<p>The local blocks in conditional structures must be indented by four\nspaces or a tab.</p>", "segment_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/conditional-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"if-structure\"><a href=\"#if-structure\"><span>\u200b<code dir=\"auto\">if</code>\u200b structure</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"if-used-for-its-side-effects\"><a href=\"#if-used-for-its-side-effects\"><span>\u200b<code dir=\"auto\">if</code>\u200b used for its side effects</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>An <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure used for its side effects has the following syntax:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">if &lt;expression&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">{else if &lt;expression&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[else</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;]</span></div></div></code></pre></figure></link></div>\n<p>where:</p>\n<ul>\n<li>Parts enclosed in square brackets (<code dir=\"auto\">[]</code>) can appear zero or one\ntime, and those enclosed in curly braces (<code dir=\"auto\">{}</code>) can appear zero or\nmore times.</li>\n<li>&lt;expression&gt; must be of \u201cbool\u201d type or be auto-castable to that\ntype, which is only possible for \u201cint\u201d or \u201cfloat\u201d values (see\nthe <a href=\"/pine-script-docs/v5/language/type-system/#types\">Type system</a> page).</li>\n<li>&lt;local_block&gt; consists of zero or more statements followed by a\nreturn value, which can be a tuple of values. It must be indented by\nfour spaces or a tab.</li>\n<li>There can be zero or more <code dir=\"auto\">else if</code> clauses.</li>\n<li>There can be zero or one <code dir=\"auto\">else</code> clause.</li>\n</ul>\n<p>When the &lt;expression&gt; following the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nevaluates to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>,\nthe first local block is executed, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s execution ends, and the value(s) evaluated at the end of\nthe local block are returned.</p>\n<p>When the &lt;expression&gt; following the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nevaluates to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_false\">false</a>,\nthe successive <code dir=\"auto\">else if</code> clauses are evaluated, if there are any. When\nthe &lt;expression&gt; of one evaluates to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>,\nits local block is executed, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s execution ends, and the value(s) evaluated at the end of\nthe local block are returned.</p>\n<p>When no &lt;expression&gt; has evaluated to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>\nand an <code dir=\"auto\">else</code> clause exists, its local block is executed, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s execution ends, and the value(s) evaluated at the end of\nthe local block are returned.</p>\n<p>When no &lt;expression&gt; has evaluated to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>\nand no <code dir=\"auto\">else</code> clause exists,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> is\nreturned.</p>\n<p>Using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructures for their side effects can be useful to manage the order flow\nin strategies, for example. While the same functionality can often be\nachieved using the <code dir=\"auto\">when</code> parameter in <code dir=\"auto\">strategy.*()</code> calls, code using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructures is easier to read:</p>\n<div class=\"pine-colorizer not-content\">if (ta.crossover(source, lower))\n    strategy.entry(\"BBandLE\", strategy.long, stop=lower,\n                   oca_name=\"BollingerBands\",\n                   oca_type=strategy.oca.cancel, comment=\"BBandLE\")\nelse\n    strategy.cancel(id=\"BBandLE\")</div>\n<p>Restricting the execution of your code to specific bars ican be done\nusing <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructures, as we do here to restrict updates to our label to the\nchart\u2019s last bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nvar ourLabel = label.new(bar_index, na, na, color = color(na), textcolor = color.orange)\nif barstate.islast\n    label.set_xy(ourLabel, bar_index + 2, hl2[1])\n    label.set_text(ourLabel, str.tostring(bar_index + 1, \"# bars in chart\"))</div>\n<p>Note that:</p>\n<ul>\n<li>We initialize the <code dir=\"auto\">ourLabel</code> variable on the script\u2019s first bar\nonly, as we use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\ndeclaration mode. The value used to initialize the variable is\nprovided by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nfunction call, which returns a label ID pointing to the label it\ncreates. We use that call to set the label\u2019s properties because\nonce set, they will persist until we change them.</li>\n<li>What happens next is that on each successive bar the Pine Script\nruntime will skip the initialization of <code dir=\"auto\">ourLabel</code>, and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s condition\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>)\nis evaluated. It returns <code dir=\"auto\">false</code> on all bars until the last one, so\nthe script does nothing on most historical bars after bar zero.</li>\n<li>On the last bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nbecomes true and the structure\u2019s local block executes, modifying on\neach chart update the properties of our label, which displays the\nnumber of bars in the dataset.</li>\n<li>We want to display the label\u2019s text without a background, so we\nmake the label\u2019s background\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nfunction call, and we use <code dir=\"auto\">hl2[1]</code> for the label\u2019s <em>y</em> position\nbecause we don\u2019t want it to move all the time. By using the average\nof the <strong>previous</strong> bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nvalues, the label doesn\u2019t move until the moment when the next\nrealtime bar opens.</li>\n<li>We use <code dir=\"auto\">bar_index + 2</code> in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_xy\">label.set_xy()</a>\ncall to offset the label to the right by two bars.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"if-used-to-return-a-value\"><a href=\"#if-used-to-return-a-value\"><span>\u200b<code dir=\"auto\">if</code>\u200b used to return a value</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>An <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure used to return one or more values has the following syntax:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt; = if &lt;expression&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">{else if &lt;expression&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[else</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;]</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<ul>\n<li>Parts enclosed in square brackets (<code dir=\"auto\">[]</code>) can appear zero or one\ntime, and those enclosed in curly braces (<code dir=\"auto\">{}</code>) can appear zero or\nmore times.</li>\n<li>&lt;declaration_mode&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#declaration-modes\">declaration mode</a></li>\n<li>&lt;type&gt; is optional, as in almost all Pine Script variable\ndeclarations (see <a href=\"/pine-script-docs/v5/language/type-system/#types\">types</a>)</li>\n<li>&lt;identifier&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/identifiers/\">name</a></li>\n<li>&lt;expression&gt; can be a literal, a variable, an expression or a\nfunction call.</li>\n<li>&lt;local_block&gt; consists of zero or more statements followed by a\nreturn value, which can be a tuple of values. It must be indented by\nfour spaces or a tab.</li>\n<li>The value assigned to the variable is the return value of the\n&lt;local_block&gt;, or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nif no local block is executed.</li>\n</ul>\n<p>This is an example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nstring barState = if barstate.islastconfirmedhistory\n    \"islastconfirmedhistory\"\nelse if barstate.isnew\n    \"isnew\"\nelse if barstate.isrealtime\n    \"isrealtime\"\nelse\n    \"other\"\n\nf_print(_text) =&gt; \n    var table _t = table.new(position.middle_right, 1, 1)\n    table.cell(_t, 0, 0, _text, bgcolor = color.yellow)\nf_print(barState)</div>\n<p>It is possible to omit the <em>else</em> block. In this case, if the\n<code dir=\"auto\">condition</code> is false, an <em>empty</em> value (<code dir=\"auto\">na</code>, <code dir=\"auto\">false</code>, or <code dir=\"auto\">\"\"</code>) will be\nassigned to the <code dir=\"auto\">var_declarationX</code> variable.</p>\n<p>This is an example showing how\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> is\nreturned when no local block is executed. If <code dir=\"auto\">close &gt; open</code> is <code dir=\"auto\">false</code>\nin here,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> is\nreturned:</p>\n<div class=\"pine-colorizer not-content\">x = if close &gt; open\n    close</div>\n<p>Scripts can contain <code dir=\"auto\">if</code> structures with nested <code dir=\"auto\">if</code> and other\nconditional structures. For example:</p>\n<div class=\"pine-colorizer not-content\">if condition1\n    if condition2\n        if condition3\n            expression</div>\n<p>However, nesting these structures is not recommended from a performance\nperspective. When possible, it is typically more optimal to compose a\nsingle <code dir=\"auto\">if</code> statement with multiple logical operators rather than\nseveral nested <code dir=\"auto\">if</code> blocks:</p>\n<div class=\"pine-colorizer not-content\">if condition1 and condition2 and condition3\n    expression</div>", "segment_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/conditional-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"switch-structure\"><a href=\"#switch-structure\"><span>\u200b<code dir=\"auto\">switch</code>\u200b structure</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure exists in two forms. One switches on the different values of a\nkey expression:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[[&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt; = ]switch &lt;expression&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">{&lt;expression&gt; =&gt; &lt;local_block&gt;}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">=&gt; &lt;local_block&gt;</span></div></div></code></pre></figure></div>\n<p>The other form does not use an expression as a key; it switches on the\nevaluation of different expressions:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[[&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt; = ]switch</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">{&lt;expression&gt; =&gt; &lt;local_block&gt;}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">=&gt; &lt;local_block&gt;</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<ul>\n<li>Parts enclosed in square brackets (<code dir=\"auto\">[]</code>) can appear zero or one\ntime, and those enclosed in curly braces (<code dir=\"auto\">{}</code>) can appear zero or\nmore times.</li>\n<li>&lt;declaration_mode&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#declaration-modes\">declaration mode</a></li>\n<li>&lt;type&gt; is optional, as in almost all Pine Script variable\ndeclarations (see <a href=\"/pine-script-docs/v5/language/type-system/#types\">types</a>)</li>\n<li>&lt;identifier&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/identifiers/\">name</a></li>\n<li>&lt;expression&gt; can be a literal, a variable, an expression or a\nfunction call.</li>\n<li>&lt;local_block&gt; consists of zero or more statements followed by a\nreturn value, which can be a tuple of values. It must be indented by\nfour spaces or a tab.</li>\n<li>The value assigned to the variable is the return value of the\n&lt;local_block&gt;, or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nif no local block is executed.</li>\n<li>The <code dir=\"auto\">=&gt; &lt;local_block&gt;</code> at the end allows you to specify a return\nvalue which acts as a default to be used when no other case in the\nstructure is executed.</li>\n</ul>\n<p>Only one local block of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure is executed. It is thus a <em>structured switch</em> that doesn\u2019t\n<em>fall through</em> cases. Consequently, <code dir=\"auto\">break</code> statements are unnecessary.</p>\n<p>Both forms are allowed as the value used to initialize a variable.</p>\n<p>As with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure, if no local block is exectuted,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> is\nreturned.</p>\n<h3 class=\"md-heading\" id=\"switch-with-an-expression\"><a href=\"#switch-with-an-expression\"><span>\u200b<code dir=\"auto\">switch</code>\u200b with an expression</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Let\u2019s look at an example of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nusing an expression:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Switch using an expression\", \"\", true)\n\nstring maType = input.string(\"EMA\", \"MA type\", options = [\"EMA\", \"SMA\", \"RMA\", \"WMA\"])\nint maLength = input.int(10, \"MA length\", minval = 2)\n\nfloat ma = switch maType\n    \"EMA\" =&gt; ta.ema(close, maLength)\n    \"SMA\" =&gt; ta.sma(close, maLength)\n    \"RMA\" =&gt; ta.rma(close, maLength)\n    \"WMA\" =&gt; ta.wma(close, maLength)\n    =&gt; \n        runtime.error(\"No matching MA type found.\")\n        float(na)\n\nplot(ma)</div>\n<p>Note that:</p>\n<ul>\n<li>The expression we are switching on is the variable <code dir=\"auto\">maType</code>, which\nis of \u201cinput int\u201d type (see here for an explanation of what the\n\u201c<a href=\"/pine-script-docs/v5/language/type-system/#input\">input</a>\u201d qualifier is). Since it cannot change during the\nexecution of the script, this guarantees that whichever MA type the\nuser selects will be executing on each bar, which is a requirement\nfor functions like\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>\nwhich require a \u201csimple int\u201d argument for their <code dir=\"auto\">length</code>\nparameter.</li>\n<li>If no matching value is found for <code dir=\"auto\">maType</code>, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nexecutes the last local block introduced by <code dir=\"auto\">=&gt;</code>, which acts as a\ncatch-all. We generate a runtime error in that block. We also end it\nwith <code dir=\"auto\">float(na)</code> so the local block returns a value whose type is\ncompatible with that of the other local blocks in the structure, to\navoid a compilation error.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"switch-without-an-expression\"><a href=\"#switch-without-an-expression\"><span>\u200b<code dir=\"auto\">switch</code>\u200b without an expression</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This is an example of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure which does not use an expression:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Switch without an expression\", \"\", true)\n\nbool longCondition  = ta.crossover( ta.sma(close, 14), ta.sma(close, 28))\nbool shortCondition = ta.crossunder(ta.sma(close, 14), ta.sma(close, 28))\n\nswitch\n    longCondition  =&gt; strategy.entry(\"Long ID\", strategy.long)\n    shortCondition =&gt; strategy.entry(\"Short ID\", strategy.short)</div>\n<p>Note that:</p>\n<ul>\n<li>We are using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nto select the appropriate strategy order to emit, depending on\nwhether the <code dir=\"auto\">longCondition</code> or <code dir=\"auto\">shortCondition</code> \u201cbool\u201d variables\nare <code dir=\"auto\">true</code>.</li>\n<li>The building conditions of <code dir=\"auto\">longCondition</code> and <code dir=\"auto\">shortCondition</code> are\nexclusive. While they can both be <code dir=\"auto\">false</code> simultaneously, they\ncannot be <code dir=\"auto\">true</code> at the same time. The fact that only <strong>one</strong> local\nblock of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure is ever executed is thus not an issue for us.</li>\n<li>We evaluate the calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dcrossover\">ta.crossover()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dcrossunder\">ta.crossunder()</a>\n<strong>prior</strong> to entry in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure. Not doing so, as in the following example, would prevent\nthe functions to be executed on each bar, which would result in a\ncompiler warning and erratic behavior:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"Switch without an expression\", \"\", true)\n\nswitch\n    // Compiler warning! Will not calculate correctly!\n    ta.crossover( ta.sma(close, 14), ta.sma(close, 28)) =&gt; strategy.entry(\"Long ID\", strategy.long)\n    ta.crossunder(ta.sma(close, 14), ta.sma(close, 28)) =&gt; strategy.entry(\"Short ID\", strategy.short)</div>", "segment_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/conditional-structures", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"matching-local-block-type-requirement\"><a href=\"#matching-local-block-type-requirement\">Matching local block type requirement<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When multiple local blocks are used in structures, the type of the\nreturn value of all its local blocks must match. This applies only if\nthe structure is used to assign a value to a variable in a declaration,\nbecause a variable can only have one type, and if the statement returns\ntwo incompatible types in its branches, the variable type cannot be\nproperly determined. If the structure is not assigned anywhere, its\nbranches can return different values.</p>\n<p>This code compiles fine because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nare both of the <code dir=\"auto\">float</code> type:</p>\n<div class=\"pine-colorizer not-content\">x = if close &gt; open\n    close\nelse\n    open</div>\n<p>This code does not compile because the first local block returns a\n<code dir=\"auto\">float</code> value, while the second one returns a <code dir=\"auto\">string</code>, and the result\nof the <code dir=\"auto\">if</code>-statement is assigned to the <code dir=\"auto\">x</code> variable:</p>\n<div class=\"pine-colorizer not-content\">// Compilation error!\nx = if close &gt; open\n    close\nelse\n    \"open\"</div>", "segment_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "bf946da8b68935f4bc4105bdcde5cfe96da9dc115cf4b53b81e0167c5d2762b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"declaration-statements\"><a href=\"#declaration-statements\">Declaration statements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"indicator\"><a href=\"#indicator\"><span>\u200b<code dir=\"auto\">indicator()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Every <em>indicator</em><sup><a aria-describedby=\"footnote-label\" data-footnote-ref=\"\" href=\"#user-content-fn-1\" id=\"user-content-fnref-1\">1</a></sup> script must contain one call to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator</a>\nfunction, which has the following signature:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">indicator(title, shorttitle, overlay, format, precision, scale, max_bars_back, timeframe, timeframe_gaps, explicit_plot_zorder, max_lines_count, max_labels_count, max_boxes_count)</span></div></div></code></pre></figure></link></div>\n<p>The <code dir=\"auto\">indicator</code> function determines the indicator\u2019s general properties.\nThe most important arguments of the indicator function are described\nbelow, a full overview of all [indicator()]` parameters can\nbe found in its Reference Manual entry.</p>\n<p>Only the <code dir=\"auto\">title</code> parameter is mandatory. It defines the name of the\nindicator. This name will be used in the <em>Indicators</em> dialog box and is\nindependent of the name used to save the script in your Personal\nLibrary.</p>\n<p><code dir=\"auto\">shorttitle</code> is the short name of the indicator displayed on the chart,\nif it must be different than the value of <code dir=\"auto\">title</code>.</p>\n<p><code dir=\"auto\">overlay</code> is a \u201cbool\u201d parameter. If it is true then the study will be\nadded as an overlay on top of the main chart. If it is false then it\nwill be added in a separate pane. False is the default setting. Note\nthat if you change the parameter\u2019s value in a script that is already on\na chart, you need to use the <em>Add to Chart</em> button to apply the change.</p>\n<p><code dir=\"auto\">format</code> defines the type of formatting used for study values appearing\non the price axis, in indicator values or in the Data Window. Possible\nvalues are: <code dir=\"auto\">format.inherit</code>, <code dir=\"auto\">format.price</code> and <code dir=\"auto\">format.volume</code>. The\ndefault is <code dir=\"auto\">format.inherit</code>, which uses the format settings from the\nchart, unless <code dir=\"auto\">precision =</code> is also used, in which case it will override\nthe effect of <code dir=\"auto\">format.inherit</code>. When <code dir=\"auto\">format.price</code> is used, the default\nprecision will be \u201c2\u201d, unless one is specified using <code dir=\"auto\">precision =</code>.\nWhen <code dir=\"auto\">format.volume</code> is used, the format is equivalent to\n<code dir=\"auto\">precision = 0</code> used in earlier versions of Pine Script\u00ae, where \u201c5183\u201d\nbecomes \u201c5.183K\u201d.</p>\n<p><code dir=\"auto\">precision</code> is the number of digits after the floating point used to\nformat study values. It must be a non-negative integer and not greater\nthan 16. If omitted, then formatting from the parent series on the chart\nwill be used. If the format is <code dir=\"auto\">format.inherit</code> and the <code dir=\"auto\">precision</code>\nparameter is used with a value, then the study will not inherit\nformatting from the chart\u2019s settings and the value specified will be\nused instead, as if <code dir=\"auto\">format = format.price</code> had been used.</p>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"strategy\"><a href=\"#strategy\"><span>\u200b<code dir=\"auto\">strategy()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"library\"><a href=\"#library\"><span>\u200b<code dir=\"auto\">library()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><strong>Footnote</strong></p>\n<section class=\"footnotes\" data-footnotes=\"\"><h2 class=\"md-heading\" id=\"footnote-label\"><a href=\"#footnote-label\">Footnotes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ol>\n<li id=\"user-content-fn-1\">\n<p>Pine Script also has a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nannotation function which is used to create a\n<a href=\"/pine-script-docs/v5/concepts/strategies/\">strategy</a> rather\nthan an indicator. <a aria-label=\"Back to reference 1\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1\">\u21a9</a></p>\n</li>\n</ol>\n</section>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/declaration-statements", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"footnote-label\"><a href=\"#footnote-label\">Footnotes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ol>\n<li id=\"user-content-fn-1\">\n<p>Pine Script also has a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nannotation function which is used to create a\n<a href=\"/pine-script-docs/v5/concepts/strategies/\">strategy</a> rather\nthan an indicator. <a aria-label=\"Back to reference 1\" class=\"data-footnote-backref\" data-footnote-backref=\"\" href=\"#user-content-fnref-1\">\u21a9</a></p>\n</li>\n</ol>", "segment_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "72d725368c64219c63e7104dd2c3bbdada6e6c7e74e4c339a4107d2c3bac64d3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/enums\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"enums\"><a href=\"#enums\">Enums<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script Enums, otherwise known as <em>enumerations</em>, <em>enumerated\ntypes</em>, or\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a>, are unique data types with all possible values (<em>members</em>)\nexplicitly defined by the programmer. They provide a human-readable,\nexpressive way to declare distinct sets of <em>predefined values</em> that\nvariables, conditional expressions, and\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> can accept, allowing more strict control over the values\nused in a script\u2019s logic.</p>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaring-an-enum\"><a href=\"#declaring-an-enum\">Declaring an enum<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To declare an enum, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_enum\">enum</a>\nkeyword with the following syntax:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[export ]enum &lt;enumName&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_1&gt;[ = &lt;title_1&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_2&gt;[ = &lt;title_2&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_N&gt;[ = &lt;title_N&gt;]</span></div></div></code></pre></figure></link></div>\n<p>Each <strong>field</strong> in the enum represents a unique, <em>named member</em> (value)\nof the <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>. Users can specify optional \u201cconst string\u201d <strong>titles</strong> for\nenum fields to add extra information about what their values represent.\nIf the programmer does not specify a field\u2019s title, its title is the\n\u201cstring\u201d representation of its name.\n<a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">Enum inputs</a> display enum field titles within their dropdown menus in a\nscript\u2019s \u201cSettings/Inputs\u201d tab. Scripts can also retrieve enum field\ntitles using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\nfunction, allowing their use in additional calculations. See\n<a href=\"/pine-script-docs/v5/language/enums/#utilizing-field-titles\">this section</a> below for more information.</p>\n<p>While the above syntax may look similar to the syntax for declaring\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types (UDTs)</a>, it\u2019s crucial to understand that\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a> and\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>\nserve different purposes. Scripts use\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>\nto create <a href=\"/pine-script-docs/v5/language/objects/\">objects</a> with\n\u201cseries\u201d fields that can hold values of <em>any</em> specified type. In\ncontrast, enums are distinct groups of \u201csimple\u201d fields representing\nthe specific, <em>predefined values</em> of the same <em>unique</em> type that\nvariables, expressions, and\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> can accept.</p>\n<p>For example, this code block declares a <code dir=\"auto\">Signal</code> enum with three fields:\n<code dir=\"auto\">buy</code>, <code dir=\"auto\">sell</code>, and <code dir=\"auto\">neutral</code>. Each field represents a distinct member\n(possible value) of the <code dir=\"auto\">Signal</code>\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>:</p>\n<div class=\"pine-colorizer not-content\">//@enum           An enumeration of named values representing buy, sell, and neutral signal states.\n//@field buy      Represents a \"Buy signal\" state.\n//@field sell     Represents a \"Sell signal\" state.\n//@field neutral  Represents a \"neutral\" state. \nenum Signal\n    buy     = \"Buy signal\"\n    sell    = \"Sell signal\"\n    neutral </div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">Signal</code> identifier represents the enum\u2019s name, which\nsignifies the <em>unique type</em> the fields belong to.</li>\n<li>We used the <code dir=\"auto\">//@enum</code> and <code dir=\"auto\">//@field</code>\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">annotations</a> to document the meaning of the enum and its fields.</li>\n<li>Unlike the <code dir=\"auto\">buy</code> and <code dir=\"auto\">sell</code> fields, the <code dir=\"auto\">neutral</code> field does not\ninclude a specified title. As such, its title is the \u201cstring\u201d\nrepresentation of its <em>name</em> (\u201cneutral\u201d).</li>\n</ul>\n<p>To retrieve a member of an enum, reference its field name using <em>dot\nnotation</em> syntax, i.e.:</p>\n<div class=\"pine-colorizer not-content\">enumName.fieldName</div>\n<p>As with other types, scripts can assign enum members to variables,\nfunction parameters, and\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\nfields, allowing strict control over their allowed values.</p>\n<p>For instance, this line of code declares a <code dir=\"auto\">mySignal</code> variable whose\nvalue is the <code dir=\"auto\">neutral</code> member of the <code dir=\"auto\">Signal</code> enum. Any value assigned\nto this variable later must also be of the same\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>:</p>\n<div class=\"pine-colorizer not-content\">mySignal = Signal.neutral</div>\n<p>Note that the above line does not require declaring the variable\u2019s\n<em>type</em> as <code dir=\"auto\">Signal</code> because the compiler can automatically infer that\ninformation from the assigned value. If we use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> as\nthe initial value instead, we must use <code dir=\"auto\">Signal</code> as the type keyword to\nspecify that <code dir=\"auto\">mySignal</code> will accept a <code dir=\"auto\">Signal</code> member:</p>\n<div class=\"pine-colorizer not-content\">Signal mySignal = na</div>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"using-enums\"><a href=\"#using-enums\">Using enums<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Scripts can compare enum members with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_==\">==</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_!=\">!=</a>\noperators and use them in\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>, allowing the convenient creation of logical patterns with a\nreduced risk of unintended values or operations.</p>\n<p>The following example declares an <code dir=\"auto\">OscType</code> enum with three fields\nrepresenting different oscillator choices: <code dir=\"auto\">rsi</code>, <code dir=\"auto\">mfi</code>, and <code dir=\"auto\">cci</code>. The\n<code dir=\"auto\">calcOscillator()</code> function uses <code dir=\"auto\">OscType</code> members within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure to determine which oscillator it calculates. The script calls\nthis function using the value from an\n<a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">enum input</a> as the <code dir=\"auto\">selection</code> argument and plots the\nresulting oscillator:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"620\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Enums-Using-enums-1.nGh65GZL_1UbRFt.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Using enums demo\")\n\n//@enum An enumeration of oscillator choices.\nenum OscType\n    rsi = \"Relative Strength Index\"\n    mfi = \"Money Flow Index\"\n    cci = \"Commodity Channel Index\"\n\n//@variable An enumerator (member) of the `OscType` enum.\nOscType oscInput = input.enum(OscType.rsi, \"Oscillator type\")\n\n//@function         Calculates one of three oscillators based on a specified `selection`.\n//@param source     The series of values to process.\n//@param length     The number of bars in the calculation.\n//@param selection  Determines which oscillator to calculate.\ncalcOscillator(float source, simple int length, OscType selection) =&gt;\n    result = switch selection\n        OscType.rsi =&gt; ta.rsi(source, length)\n        OscType.mfi =&gt; ta.mfi(source, length)\n        OscType.cci =&gt; ta.cci(source, length)\n\n// Plot the value of a `calcOscillator()` call with `oscInput` as the `selection`.\nplot(calcOscillator(close, 20, oscInput))</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">selection</code> parameter of the <code dir=\"auto\">calcOscillator()</code> function can\nonly take on one of <em>four</em> values: <code dir=\"auto\">OscType.rsi</code>, <code dir=\"auto\">OscType.mfi</code>,\n<code dir=\"auto\">OscType.cci</code>, or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</li>\n<li>The \u201cOscillator type\u201d input in the script\u2019s\n\u201cSettings/Inputs\u201d tab displays all <code dir=\"auto\">OscType</code> field titles in\nits dropdown. See\n<a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">this section</a> to learn more about enum inputs.</li>\n</ul>\n<p>It\u2019s crucial to note that each declared enum represents a <em>unique</em>\ntype. Scripts <strong>cannot</strong> compare members of different enums or use such\nmembers in expressions requiring a specific\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>, even if the fields have identical names and titles.</p>\n<p>In this example, we added an <code dir=\"auto\">OscType2</code> enum to the above script and\nchanged the <code dir=\"auto\">oscInput</code> variable to use a member of that enum. The script\nnow raises a <em>compilation error</em> because it can\u2019t use a member of the\n<code dir=\"auto\">OscType2</code> enum as the <code dir=\"auto\">selection</code> argument in the <code dir=\"auto\">calcOscillator()</code>\ncall:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Incompatible enums demo\")\n\n//@enum An enumeration of oscillator choices.\nenum OscType\n    rsi = \"Relative Strength Index\"\n    mfi = \"Money Flow Index\"\n    cci = \"Commodity Channel Index\"\n\n//@enum An enumeration of oscillator choices. Its fields DO NOT represent the same values those in the `OscType` enum.\nenum OscType2\n    rsi = \"Relative Strength Index\"\n    mfi = \"Money Flow Index\"\n    cci = \"Commodity Channel Index\"\n\n//@variable An enumerator (member) of the `OscType2` enum.\nOscType2 oscInput = input.enum(OscType2.rsi, \"Oscillator type\")\n\n//@function         Calculates one of three oscillators based on a specified `selection`.\n//@param source     The series of values to process.\n//@param length     The number of bars in the calculation.\n//@param selection  Determines which oscillator to calculate.\ncalcOscillator(float source, simple int length, OscType selection) =&gt;\n    result = switch selection\n        OscType.rsi =&gt; ta.rsi(source, length)\n        OscType.mfi =&gt; ta.mfi(source, length)\n        OscType.cci =&gt; ta.cci(source, length)\n\n// Plot the value of a `calcOscillator()` call with `oscInput` as the `selection`.\n// Raises a compilation error because only members of `OscType` are allowed. \nplot(calcOscillator(close, 20, oscInput))</div>\n<h3 class=\"md-heading\" id=\"utilizing-field-titles\"><a href=\"#utilizing-field-titles\">Utilizing field titles<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The \u201cstring\u201d titles of an enum\u2019s fields allow programmers to add\nextra information to each member. These field titles appear within a\ndropdown in the script\u2019s \u201cSettings/Inputs\u201d tab when calling the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nfunction.</p>\n<p>Scripts can also utilize enum field titles in their calculations and\nlogic. Use the string conversion function\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>)\non an enum field to access its title.</p>\n<p>The following example combines different enum field titles to construct\na ticker ID for requesting data from\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">another context</a>. The script declares two enums, <code dir=\"auto\">Exchange</code> and <code dir=\"auto\">Pair</code>, whose\nrespective fields represent <em>exchange</em> and <em>currency pair</em> names. It\nuses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nto assign user-specified enum members to the <code dir=\"auto\">exchangeInput</code> and\n<code dir=\"auto\">pairInput</code> variables, then retrieves the \u201cstring\u201d titles from those\nvariables with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\nand concatenates them to form an \u201cExchange:Symbol\u201d pair for use in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"620\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Enums-Using-enums-Utilizing-field-titles-1.AzP84EB1_1aSLkU.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Utilizing field titles demo\")\n\n//@enum An enumeration of cryptocurrency exchanges. All field titles are the same as the field names.\nenum Exchange\n    BINANCE\n    BITSTAMP\n    BITFINEX\n    COINBASE\n    KRAKEN\n\n//@enum An enumeration of cryptocurrency pairs. All the field titles are the same as the field names. \nenum Pair\n    BTCUSD\n    ETHUSD\n    SOLUSD\n    XRPUSD\n\n//@variable An enumerator (member) of the `Exchange` enum.\nExchange exchangeInput = input.enum(Exchange.BINANCE, \"Exchange\")\n//@variable An enumerator (member) of the `Pair` enum.\nPair pairInput = input.enum(Pair.BTCUSD, \"Pair\")\n\n//@variable The exchange-symbol pair for the data request. \nsimple string symbol = str.tostring(exchangeInput) + \":\" + str.tostring(pairInput)\n\n// Plot the `close` value requested from the `symbol` context.\nplot(request.security(symbol, timeframe.period, close), \"Requested close\", color.purple, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>None of the members of the <code dir=\"auto\">Exchange</code> or <code dir=\"auto\">Pair</code> enums have\nspecified titles. Therefore, each field\u2019s title is the\n\u201cstring\u201d representation of its name, as shown by the script\u2019s\n<a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">enum inputs</a>.</li>\n<li>Calling the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\nfunction on an enum field is the <strong>only</strong> way to retrieve its\ntitle for additional calculations. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nand <code dir=\"auto\">log.*()</code> functions <em>cannot</em> accept enum members. To use a\nfield\u2019s title in a string formatting function, call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\non the field first, then pass the resulting \u201cstring\u201d to the\nfunction.</li>\n</ul>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"collecting-enum-members\"><a href=\"#collecting-enum-members\">Collecting enum members<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) can store enum members, allowing strict control over the values they can contain. To declare a collection of enum members, include the enum\u2019s <em>name</em> in the collection\u2019s <a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a>.</p>\n<p>For example, this code block creates an empty\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nto hold members of the <code dir=\"auto\">FooBar</code> enum. The only values this array can\nallow as elements are <code dir=\"auto\">FooBar.foo</code>, <code dir=\"auto\">FooBar.bar</code>, <code dir=\"auto\">FooBar.baz</code>, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>:</p>\n<div class=\"pine-colorizer not-content\">//@variable An enumeration of miscellaneous named members.\nenum FooBar\n    foo\n    bar\n    baz\n\n//@variable An array that can only contain the following values: `FooBar.foo`, `FooBar.bar`, `FooBar.baz`, `na`.\narray&lt;FooBar&gt; fooBarArray = array.new&lt;FooBar&gt;()</div>\n<p>Enums are particularly helpful when working with\n<a href=\"/pine-script-docs/v5/language/maps/\">maps</a>, as unlike other\n<em>non-fundamental</em> <a href=\"/pine-script-docs/v5/language/type-system/#types\">types</a>, scripts can declare <a href=\"/pine-script-docs/v5/language/maps/\">maps</a> with <em>keys</em> of an\n<a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>, enabling strict control over all possible keys allowed in\ntheir key-value pairs.</p>\n<p>The following example uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nwith enum keys and \u201cint\u201d values to track and count signal states\nacross chart bars. The script\u2019s <code dir=\"auto\">Signal</code> enum contains five fields\nrepresenting specific named states. The <code dir=\"auto\">signalCounters</code>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nuses the <code dir=\"auto\">Signal</code> name as the <em>first keyword</em> in its\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> to specify that it can only accept <code dir=\"auto\">Signal</code> members as keys.</p>\n<p>The script uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure to calculate a <code dir=\"auto\">signalState</code> variable whose value is a member\nof the <code dir=\"auto\">Signal</code> enum, which it uses to determine the counter value to\nupdate in the <code dir=\"auto\">signalCounters</code> map. It constructs a \u201cstring\u201d to\nrepresent the key-value pairs of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nand displays the result in a single-cell\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\non the last chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"524\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Enums-Collecting-enums-1.ZTw8lVuz_1tEOAf.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Collecting enum members demo\", overlay = true)\n\n//@enum An enumeration of named signal states. \nenum Signal\n    strongBuy  = \"Strong buy\"\n    buy        = \"Buy\"\n    neutral    = \"Neutral\"\n    sell       = \"Sell\"\n    strongSell = \"Strong sell\"\n\n//@variable The number of bars in the signal calculation.\nint lengthInput = input.int(50, \"Length\", 2)\n\n//@variable A map of `Signal.*` keys and \"int\" values counting the number of bars with each signal state. \n//          Allowed keys: `Signal.strongBuy`, `Signal.buy`, `Signal.neutral`, `Signal.sell`, `Signal.strongSell`, `na`.\nvar map&lt;Signal, float&gt; signalCounters = map.new&lt;Signal, float&gt;()\n\n//@variable A single-cell table displaying the key-value pairs of the `signalCounters` map.\nvar table infoTable = table.new(position.top_right, 1, 1, chart.fg_color)\n\nif barstate.isfirst\n    // Put `Signal.*`-\"int\" pairs into the `signalCounters` map to establish insertion order.\n    signalCounters.put(Signal.strongBuy, 0)\n    signalCounters.put(Signal.buy, 0)\n    signalCounters.put(Signal.neutral, 0)\n    signalCounters.put(Signal.sell, 0)\n    signalCounters.put(Signal.strongSell, 0)\n    // Initialize the `infoTable` cell.\n    infoTable.cell(0, 0, text_color = chart.bg_color, text_halign = text.align_left, text_size = size.large)\n\n// Calculate the EMA and Percent rank of `source` data over `length` bars.\nfloat ema  = ta.ema(close, lengthInput)\nfloat rank = ta.percentrank(close, lengthInput)\n\n//@variable A `Signal` member representing the current signal state based on `ema` and `rank` values. \nSignal signalState = switch\n    close &gt; ema =&gt; rank &gt; 70 ? Signal.strongBuy  : rank &gt; 50 ? Signal.buy  : Signal.neutral\n    close &lt; ema =&gt; rank &lt; 30 ? Signal.strongSell : rank &lt; 50 ? Signal.sell : Signal.neutral\n    =&gt; Signal.neutral\n\n// Add 1 to the value in the `signalCounters` map associated with the `signalState` key.\nsignalCounters.put(signalState, signalCounters.get(signalState) + 1)\n\n// Update the `infoTable` cell's text using the keys and values from the `signalCounters` map on the last bar.\nif barstate.islast\n    string tableText = \"\"\n    for [state, count] in signalCounters\n        tableText += str.tostring(state) + \": \" + str.tostring(count) + \"\\n\"\n    infoTable.cell_set_text(0, 0, str.trim(tableText))</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">signalCounters</code> map can contain up to <em>six</em> key-value\npairs, as the <code dir=\"auto\">Signal</code> enum has <em>five</em> predefined values, plus a\npossible value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nand <a href=\"/pine-script-docs/v5/language/maps/\">maps</a> cannot\ncontain <em>repetitive</em> keys.</li>\n<li>The script declares the <code dir=\"auto\">signalCounters</code> variable using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword, signifying that the assigned\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\ninstance persists across executions.</li>\n<li>On the first chart bar, the script uses five\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>\ncalls to establish the <em>insertion order</em> of keys in the\n<code dir=\"auto\">signalCounters</code> map. See\n<a href=\"/pine-script-docs/v5/language/maps/#mapkeys-and-mapvalues\">this section</a> of the <a href=\"/pine-script-docs/v5/language/maps/\">Maps</a> page for more information.</li>\n<li>To minimize <em>resource usage</em>, the script declares the\n<code dir=\"auto\">infoTable</code> and initializes its cell on the <em>first bar</em>, then\nupdates the cell\u2019s text on the <em>latest bar</em>. See\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#reducing-drawing-updates\">this section</a> of the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/\">Profiling and optimization</a> page to learn more.</li>\n</ul>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/enums", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"shadowing\"><a href=\"#shadowing\">Shadowing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To avoid potential conflicts where namespaces added to Pine Script in\nthe future would conflict with the names of enums in existing scripts,\nenum names can <em>shadow</em> some of Pine\u2019s namespaces.</p>\n<p>For example, one can declare an enum like the following, whose name\nshadows the <code dir=\"auto\">syminfo.*</code> namespace:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shadowing demo\")\n\nenum syminfo\n    abcd\n\nlog.info(str.tostring(syminfo.abcd))</div>\n<p>However, using such a name for an enum is only allowed if the enum\u2019s\nfields <strong>do not</strong> have names matching any of the namespace\u2019s built-ins.\nOtherwise, Pine will not be able to determine which value the script is\nsupposed to use, resulting in a compilation error:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Name conflict demo\")\n\nenum syminfo\n    abcd\n    tickerid // This matches the built-in `syminfo.tickerid` variable, causing a compilation error.\n\nlog.info(str.tostring(syminfo.tickerid))</div>\n<p>Additionally, one cannot use any of Pine\u2019s built-in\n<a href=\"/pine-script-docs/v5/language/type-system/\">type</a> names as the name of an\nenum.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>While it is possible for some enum names to shadow language namespaces,\nas shown above, we recommend choosing <strong>unique</strong> names for enums\nwherever possible for more readable code that\u2019s easier to maintain.</p></div></aside>", "segment_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "fbec050bd0fdc38d0b9a5e2e73270d0a44cc3bccf22ca9c1eceff922fe843d16", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/execution-model\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"execution-model\"><a href=\"#execution-model\">Execution model<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>The execution model of the Pine Script\u00ae runtime is intimately linked to\nPine Script\u2019s <a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> and <a href=\"/pine-script-docs/v5/language/type-system/\">type system</a>. Understanding all three is key to making the most of the\npower of Pine Script.</p>\n<p>The execution model determines how your script is executed on charts,\nand thus how the code you write in scripts works. Your code would do\nnothing were it not for Pine Script\u2019s runtime, which kicks in after\nyour code has compiled and it is executed on your chart because one of\nthe\n<a href=\"/pine-script-docs/v5/language/execution-model/#events-triggering-the-execution-of-a-script\">events triggering the execution of a script</a> has occurred.</p>\n<p>When a Pine script is loaded on a chart it executes once on each\nhistorical bar using the available OHLCV (open, high, low, close,\nvolume) values for each bar. Once the script\u2019s execution reaches the\nrightmost bar in the dataset, if trading is currently active on the\nchart\u2019s symbol, then Pine Script <em>indicators</em> will execute once every\ntime an <em>update</em> occurs, i.e., price or volume changes. Pine Script\n<em>strategies</em> will by default only execute when the rightmost bar closes,\nbut they can also be configured to execute on every update, like\nindicators do.</p>\n<p>All symbol/timeframe pairs have a dataset comprising a limited number of\nbars. When you scroll a chart to the left to see the dataset\u2019s earlier\nbars, the corresponding bars are loaded on the chart. The loading\nprocess stops when there are no more bars for that particular\nsymbol/timeframe pair or the <a href=\"/pine-script-docs/v5/writing/limitations/#chart-bars\">maximum number of\nbars</a>\nyour account type permits has been loaded. You can scroll the chart to\nthe left until the very first bar of the dataset, which has an index\nvalue of 0 (see\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>).</p>\n<p>When the script first runs on a chart, all bars in a dataset are\n<em>historical bars</em>, except the rightmost one if a trading session is\nactive. When trading is active on the rightmost bar, it is called the\n<em>realtime bar</em>. The realtime bar updates when a price or volume change\nis detected. When the realtime bar closes, it becomes an <em>elapsed\nrealtime bar</em> and a new realtime bar opens.</p>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"calculation-based-on-historical-bars\"><a href=\"#calculation-based-on-historical-bars\">Calculation based on historical bars<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Let\u2019s take a simple script and follow its execution on historical bars:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\", overlay = true)\nsrc = close\na = ta.sma(src, 5)\nb = ta.sma(src, 50)\nc = ta.cross(a, b)\nplot(a, color = color.blue)\nplot(b, color = color.black)\nplotshape(c, color = color.red)</div>\n<p>On historical bars, a script executes at the equivalent of the bar\u2019s\nclose, when the OHLCV values are all known for that bar. Prior to\nexecution of the script on a bar, the built-in variables such as <code dir=\"auto\">open</code>,\n<code dir=\"auto\">high</code>, <code dir=\"auto\">low</code>, <code dir=\"auto\">close</code>, <code dir=\"auto\">volume</code> and <code dir=\"auto\">time</code> are set to values\ncorresponding to those from that bar. A script executes <strong>once per\nhistorical bar</strong>.</p>\n<p>Our example script is first executed on the very first bar of the\ndataset at index 0. Each statement is executed using the values for the\ncurrent bar. Accordingly, on the first bar of the dataset, the following\nstatement:</p>\n<div class=\"pine-colorizer not-content\">src = close</div>\n<p>initializes the variable <code dir=\"auto\">src</code> with the <code dir=\"auto\">close</code> value for that first\nbar, and each of the next lines is executed in turn. Because the script\nonly executes once for each historical bar, the script will always\ncalculate using the same <code dir=\"auto\">close</code> value for a specific historical bar.</p>\n<p>The execution of each line in the script produces calculations which in\nturn generate the indicator\u2019s output values, which can then be plotted\non the chart. Our example uses the <code dir=\"auto\">plot</code> and <code dir=\"auto\">plotshape</code> calls at the\nend of the script to output some values. In the case of a strategy, the\noutcome of the calculations can be used to plot values or dictate the\norders to be placed.</p>\n<p>After execution and plotting on the first bar, the script is executed on\nthe dataset\u2019s second bar, which has an index of 1. The process then\nrepeats until all historical bars in the dataset are processed and the\nscript reaches the rightmost bar on the chart.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/execution_model_calculation_on_history.ZMeUmfch_jaqxS.webp\" width=\"1600\"/></p>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"calculation-based-on-realtime-bars\"><a href=\"#calculation-based-on-realtime-bars\">Calculation based on realtime bars<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The behavior of a Pine script on the realtime bar is very different than\non historical bars. Recall that the realtime bar is the rightmost bar on\nthe chart when trading is active on the chart\u2019s symbol. Also, recall\nthat strategies can behave in two different ways in the realtime bar. By\ndefault, they only execute when the realtime bar closes, but the\n<code dir=\"auto\">calc_on_every_tick</code> parameter of the <code dir=\"auto\">strategy</code> declaration statement\ncan be set to true to modify the strategy\u2019s behavior so that it\nexecutes each time the realtime bar updates, as indicators do. The\nbehavior described here for indicators will thus only apply to\nstrategies using <code dir=\"auto\">calc_on_every_tick=true</code>.</p>\n<p>The most important difference between execution of scripts on historical\nand realtime bars is that while they execute only once on historical\nbars, scripts execute every time an update occurs during a realtime bar.\nThis entails that built-in variables such as <code dir=\"auto\">high</code>, <code dir=\"auto\">low</code> and <code dir=\"auto\">close</code>\nwhich never change on a historical bar, <strong>can</strong> change at each of a\nscript\u2019s iteration in the realtime bar. Changes in the built-in\nvariables used in the script\u2019s calculations will, in turn, induce\nchanges in the results of those calculations. This is required for the\nscript to follow the realtime price action. As a result, the same script\nmay produce different results every time it executes during the realtime\nbar.</p>\n<p><strong>Note:</strong> In the realtime bar, the <code dir=\"auto\">close</code> variable always represents\nthe <strong>current price</strong>. Similarly, the <code dir=\"auto\">high</code> and <code dir=\"auto\">low</code> built-in\nvariables represent the highest high and lowest low reached since the\nrealtime bar\u2019s beginning. Pine Script\u2019s built-in variables will only\nrepresent the realtime bar\u2019s final values on the bar\u2019s last update.</p>\n<p>Let\u2019s follow our script example in the realtime bar.</p>\n<p>When the script arrives on the realtime bar it executes a first time. It\nuses the current values of the built-in variables to produce a set of\nresults and plots them if required. Before the script executes another\ntime when the next update happens, its user-defined variables are reset\nto a known state corresponding to that of the last <em>commit</em> at the close\nof the previous bar. If no commit was made on the variables because they\nare initialized every bar, then they are reinitialized. In both cases\ntheir last calculated state is lost. The state of plotted labels and\nlines is also reset. This resetting of the script\u2019s user-defined\nvariables and drawings prior to each new iteration of the script in the\nrealtime bar is called <em>rollback</em>. Its effect is to reset the script to\nthe same known state it was in when the realtime bar opened, so\ncalculations in the realtime bar are always performed from a clean\nstate.</p>\n<p>The constant recalculation of a script\u2019s values as price or volume\nchanges in the realtime bar can lead to a situation where variable <code dir=\"auto\">c</code>\nin our example becomes true because a cross has occurred, and so the red\nmarker plotted by the script\u2019s last line would appear on the chart. If\non the next price update the price has moved in such a way that the\n<code dir=\"auto\">close</code> value no longer produces calculations making <code dir=\"auto\">c</code> true because\nthere is no longer a cross, then the marker previously plotted will\ndisappear.</p>\n<p>When the realtime bar closes, the script executes a last time. As usual,\nvariables are rolled back prior to execution. However, since this\niteration is the last one on the realtime bar, variables are committed\nto their final values for the bar when calculations are completed.</p>\n<p>To summarize the realtime bar process:</p>\n<ul>\n<li>A script executes <strong>at the open of the realtime bar and then once per update</strong>.</li>\n<li>Variables are rolled back <strong>before every realtime update</strong>.</li>\n<li>Variables are committed <strong>once at the closing bar update</strong>.</li>\n</ul>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"events-triggering-the-execution-of-a-script\"><a href=\"#events-triggering-the-execution-of-a-script\">Events triggering the execution of a script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A script is executed on the complete set of bars on the chart when one\nof the following events occurs:</p>\n<ul>\n<li>A new symbol or timeframe is loaded on a chart.</li>\n<li>A script is saved or added to the chart, from the Pine Script Editor or the chart\u2019s \u201cIndicators &amp; strategies\u201d dialog box.</li>\n<li>A value is modified in the script\u2019s \u201cSettings/Inputs\u201d dialog box.</li>\n<li>A value is modified in a strategy\u2019s \u201cSettings/Properties\u201d dialog box.</li>\n<li>A browser refresh event is detected.</li>\n</ul>\n<p>A script is executed on the realtime bar when trading is active and:</p>\n<ul>\n<li>One of the above conditions occurs, causing the script to execute on the open of the realtime bar, or</li>\n<li>The realtime bar updates because a price or volume change was detected.</li>\n</ul>\n<p>Note that when a chart is left untouched when the market is active, a\nsuccession of realtime bars which have been opened and then closed will\ntrail the current realtime bar. While these <em>elapsed realtime bars</em> will\nhave been <em>confirmed</em> because their variables have all been committed,\nthe script will not yet have executed on them in their <em>historical</em>\nstate, since they did not exist when the script was last run on the\nchart\u2019s dataset.</p>\n<p>When an event triggers the execution of the script on the chart and\ncauses it to run on those bars which have now become historical bars,\nthe script\u2019s calculation can sometimes vary from what they were when\ncalculated on the last closing update of the same bars when they were\nrealtime bars. This can be caused by slight variations between the OHLCV\nvalues saved at the close of realtime bars and those fetched from data\nfeeds when the same bars have become historical bars. This behavior is\none of the possible causes of <em>repainting</em>.</p>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"more-information\"><a href=\"#more-information\">More information<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ul>\n<li>The built-in <code dir=\"auto\">barstate.*</code> variables provide information on\n<a href=\"/pine-script-docs/v5/concepts/bar-states/\">the type of bar or the event</a> where the script is executing. The page where they are\ndocumented also contains a script that allows you to visualize the\ndifference between elapsed realtime and historical bars, for\nexample.</li>\n<li>The <a href=\"/pine-script-docs/v5/concepts/strategies/\">Strategies</a> page\nexplains the details of strategy calculations, which are not\nidentical to those of indicators.</li>\n</ul>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/execution-model", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"historical-values-of-functions\"><a href=\"#historical-values-of-functions\">Historical values of functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Every function call in Pine leaves a trail of historical values that a\nscript can access on subsequent bars using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator. The historical series of functions depend on successive calls\nto record the output on every bar. When a script does not call functions\non each bar, it can produce an inconsistent history that may impact\ncalculations and results, namely when it depends on the continuity of\ntheir historical series to operate as expected. The compiler warns users\nin these cases to make them aware that the values from a function,\nwhether built-in or user-defined, might be misleading.</p>\n<p>To demonstrate, let\u2019s write a script that calculates the index of the\ncurrent bar and outputs that value on every second bar. In the following\nscript, we\u2019ve defined a <code dir=\"auto\">calcBarIndex()</code> function that adds 1 to the\nprevious value of its internal <code dir=\"auto\">index</code> variable on every bar. The script\ncalls the function on each bar that the <code dir=\"auto\">condition</code> returns <code dir=\"auto\">true</code> on\n(every other bar) to update the <code dir=\"auto\">customIndex</code> value. It plots this value\nalongside the built-in <code dir=\"auto\">bar_index</code> to validate the output:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"836\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Function_historical_context_1.BS8uzH0h_1erubd.webp\" width=\"1712\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\n//@function Calculates the index of the current bar by adding 1 to its own value from the previous bar.\n// The first bar will have an index of 0.\ncalcBarIndex() =&gt;\n    int index = na\n    index := nz(index[1], replacement = -1) + 1\n\n//@variable Returns `true` on every other bar.\ncondition = bar_index % 2 == 0\n\nint customIndex = na\n\n// Call `calcBarIndex()` when the `condition` is `true`. This prompts the compiler to raise a warning.\nif condition\n    customIndex := calcBarIndex()\n\nplot(bar_index,   \"Bar index\",    color = color.green)\nplot(customIndex, \"Custom index\", color = color.red, style = plot.style_cross)</div>\n<p><strong>Note that:</strong></p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a>\nfunction replaces\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues with a specified <code dir=\"auto\">replacement</code> value (0 by default). On the\nfirst bar of the script, when the <code dir=\"auto\">index</code> series has no history, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalue is replaced with -1 before adding 1 to return an initial value\nof 0.</li>\n</ul>\n<p>Upon inspecting the chart, we see that the two plots differ wildly. The\nreason for this behavior is that the script called <code dir=\"auto\">calcBarIndex()</code>\nwithin the scope of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure on every other bar, resulting in a historical output\ninconsistent with the <code dir=\"auto\">bar_index</code> series. When calling the function once\nevery two bars, internally referencing the previous value of <code dir=\"auto\">index</code>\ngets the value from two bars ago, i.e., the last bar the function\nexecuted on. This behavior results in a <code dir=\"auto\">customIndex</code> value of half that\nof the built-in <code dir=\"auto\">bar_index</code>.</p>\n<p>To align the <code dir=\"auto\">calcBarIndex()</code> output with the <code dir=\"auto\">bar_index</code>, we can move\nthe function call to the script\u2019s global scope. That way, the function\nwill execute on every bar, allowing its entire history to be recorded\nand referenced rather than only the results from every other bar. In the\ncode below, we\u2019ve defined a <code dir=\"auto\">globalScopeBarIndex</code> variable in the\nglobal scope and assigned it to the return from <code dir=\"auto\">calcBarIndex()</code> rather\nthan calling the function locally. The script sets the <code dir=\"auto\">customIndex</code> to\nthe value of <code dir=\"auto\">globalScopeBarIndex</code> on the occurrence of the <code dir=\"auto\">condition</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"836\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Function_historical_context_2.DMU4JJfT_ZCks6f.webp\" width=\"1712\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\n//@function Calculates the index of the current bar by adding 1 to its own value from the previous bar.\n// The first bar will have an index of 0.\ncalcBarIndex() =&gt;\n    int index = na\n    index := nz(index[1], replacement = -1) + 1\n\n//@variable Returns `true` on every second bar.\ncondition = bar_index % 2 == 0\n\nglobalScopeBarIndex = calcBarIndex()\nint customIndex = na\n\n// Assign `customIndex` to `globalScopeBarIndex` when the `condition` is `true`. This won't produce a warning.\nif condition\n    customIndex := globalScopeBarIndex\n\nplot(bar_index,   \"Bar index\",    color = color.green)\nplot(customIndex, \"Custom index\", color = color.red, style = plot.style_cross)</div>\n<p>This behavior can also radically impact built-in functions that\nreference history internally. For example, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>\nfunction references its past values \u201cunder the hood\u201d. If a script\ncalls this function conditionally rather than on every bar, the values\nwithin the calculation can change significantly. We can ensure\ncalculation consistency by assigning\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>\nto a variable in the global scope and referencing that variable\u2019s\nhistory as needed.</p>\n<p>The following example calculates three SMA series: <code dir=\"auto\">controlSMA</code>,\n<code dir=\"auto\">localSMA</code>, and <code dir=\"auto\">globalSMA</code>. The script calculates <code dir=\"auto\">controlSMA</code> in the\nglobal scope and <code dir=\"auto\">localSMA</code> within the local scope of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure. Within the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure, it also updates the value of <code dir=\"auto\">globalSMA</code> using the\n<code dir=\"auto\">controlSMA</code> value. As we can see, the values from the <code dir=\"auto\">globalSMA</code> and\n<code dir=\"auto\">controlSMA</code> series align, whereas the <code dir=\"auto\">localSMA</code> series diverges from\nthe other two because it uses an incomplete history, which affects its\ncalculations:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"836\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Function_historical_context_3.B-yx15UY_1PfdyK.webp\" width=\"1712\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\n//@variable Returns `true` on every second bar.\ncondition = bar_index % 2 == 0\n\ncontrolSMA = ta.sma(close, 20)\nfloat globalSMA = na\nfloat localSMA  = na\n\n// Update `globalSMA` and `localSMA` when `condition` is `true`.\nif condition\n    globalSMA := controlSMA        // No warning.\n    localSMA  := ta.sma(close, 20) // Raises warning. This function depends on its history to work as intended.\n\nplot(controlSMA, \"Control SMA\", color = color.green)\nplot(globalSMA,  \"Global SMA\",  color = color.blue, style = plot.style_cross)\nplot(localSMA,   \"Local SMA\",   color = color.red,  style = plot.style_cross)</div>\n<h3 class=\"md-heading\" id=\"why-this-behavior\"><a href=\"#why-this-behavior\">Why this behavior?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This behavior is required because forcing the execution of functions on\neach bar would lead to unexpected results in those functions that\nproduce side effects, i.e., the ones that do something aside from\nreturning the value. For example, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>\nfunction creates a label on the chart, so forcing it to be called on\nevery bar even when it is inside of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure would create labels where they should not logically appear.</p>\n<h3 class=\"md-heading\" id=\"exceptions\"><a href=\"#exceptions\">Exceptions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Not all built-in functions use their previous values in their\ncalculations, meaning not all require execution on every bar. For\nexample,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dmax\">math.max()</a>\ncompares all arguments passed into it to return the highest value. Such\nfunctions that do not interact with their history in any way do not\nrequire special treatment.</p>\n<p>If the usage of a function within a conditional block does not cause a\ncompiler warning, it\u2019s safe to use without impacting calculations.\nOtherwise, move the function call to the global scope to force\nconsistent execution. When keeping a function call within a conditional\nblock despite the warning, ensure the output is correct at the very\nleast to avoid unexpected results.</p>", "segment_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "9746b609580e4fae879f085c83aac453d8fd89c34b2eb371893d0fe7b97294b9", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/loops\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"loops\"><a href=\"#loops\">Loops<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Loops are structures that repeatedly execute a block of statements based on specified criteria. They allow scripts to perform repetitive tasks without requiring duplicated lines of code. Pine Script\u00ae features three distinct loop types: <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a>, <a href=\"/pine-script-docs/v5/language/loops/#while-loops\">while</a>, and <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">for\u2026in</a>.</p>\n<p>Every loop structure in Pine Script consists of two main parts: a <em>loop header</em> and a <em>loop body</em>. The loop header determines the criteria under which the loop executes. The loop body is the indented block of code (<a href=\"/pine-script-docs/v5/language/loops/#scope\">local block</a>) that the script executes on each loop cycle (<em>iteration</em>) as long as the header\u2019s conditions remain valid. See the <a href=\"/pine-script-docs/v5/language/loops/#common-characteristics\">Common characteristics</a> section to learn more.</p>\n<p>Understanding when and how to use loops is essential for making the most of the power of Pine Script. Inefficient or <a href=\"/pine-script-docs/v5/language/loops/#when-loops-are-unnecessary\">unnecessary</a> usage of loops can lead to suboptimal runtime performance. However, effectively using loops <a href=\"/pine-script-docs/v5/language/loops/#when-loops-are-necessary\">when necessary</a> enables scripts to perform a wide range of calculations that would otherwise be impractical or impossible without them.</p>\n<h3 class=\"md-heading\" id=\"when-loops-are-unnecessary\"><a href=\"#when-loops-are-unnecessary\">When loops are unnecessary<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine\u2019s <a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and <a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> structure make loops <em>unnecessary</em> in many situations.</p>\n<p>When a user adds a Pine script to a chart, it runs within the equivalent of a <em>large loop</em>, executing its code once on <em>every</em> historical bar and realtime tick in the available data. Scripts can access the values from the executions on previous bars with the <a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">history-referencing operator</a>, and calculated values can <em>persist</em> across executions when assigned to variables declared with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a> keywords. These capabilities enable scripts to utilize bar-by-bar calculations to accomplish various tasks instead of relying on explicit loops.</p>\n<p>In addition, several <a href=\"/pine-script-docs/v5/language/built-ins/\">built-ins</a>, such as those in the <code dir=\"auto\">ta.*</code> namespace, are internally optimized to eliminate the need to use loops for various calculations.</p>\n<p>Let\u2019s consider a simple example demonstrating unnecessary loop usage in Pine Script. To calculate the average <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> over a specified number of bars, newcomers to Pine may write a code like the following, which uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop to calculate the sum of historical values over <code dir=\"auto\">lengthInput</code> bars and divides the result by the <code dir=\"auto\">lengthInput</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"508\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-When-loops-are-unnecessary-1.BXNHgEl8_1LIA2B.webp\" width=\"1316\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Unnecessary loops demo\", overlay = true)\n\n//@variable The number of bars in the calculation window.\nint lengthInput = input.int(defval = 20, title = \"Length\")\n\n//@variable The sum of `close` values over `lengthInput` bars.\nfloat closeSum = 0\n\n// Loop over the most recent `lengthInput` bars, adding each bar's `close` to the `closeSum`.\nfor i = 0 to lengthInput - 1\n    closeSum += close[i]\n\n//@variable The average `close` value over `lengthInput` bars.\nfloat avgClose = closeSum / lengthInput\n\n// Plot the `avgClose`.\nplot(avgClose, \"Average close\", color.orange, 2)</div>\n<p>Using a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a> loop is an <strong>unnecessary</strong>, inefficient way to accomplish tasks like this in Pine. There are several ways to leverage the <a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and the available built-ins to eliminate this loop. Below, we replaced these calculations with a simple call to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a> function. This code is shorter, and it achieves the same result much more efficiently:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"506\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-When-loops-are-unnecessary-2.BqNbiiYY_ZoMQmT.webp\" width=\"1314\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Unnecessary loops corrected demo\", overlay = true)\n\n//@variable The number of bars in the calculation window.\nint lengthInput = input.int(defval = 20, title = \"Length\")\n\n//@variable The average `close` value over `lengthInput` bars.\nfloat avgClose = ta.sma(close, lengthInput)\n\n// Plot the `avgClose`.\nplot(avgClose, \"Average close\", color.blue, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>Users can see the substantial difference in efficiency between these two example scripts by analyzing their performance with the <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Pine Profiler</a>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"when-loops-are-necessary\"><a href=\"#when-loops-are-necessary\">When loops are necessary<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Although Pine\u2019s <a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a>, <a href=\"/pine-script-docs/v5/language/time-series/\">time series</a>, and available <a href=\"/pine-script-docs/v5/language/built-ins/\">built-ins</a> often eliminate the need for loops in many cases, not all iterative tasks have loop-free alternatives. Loops <em>are necessary</em> for several types of tasks, including:</p>\n<ul>\n<li>Iterating through or manipulating <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>)</li>\n<li>Performing calculations that one <strong>cannot</strong> accomplish with loop-free expressions or the available built-ins</li>\n<li>Looking back through history to analyze past bars with a reference value only available on the <em>current bar</em></li>\n</ul>\n<p>For example, a loop is <em>necessary</em> to identify which past bars\u2019 <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> values are above the current bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> because the current value is <strong>not</strong> obtainable during a script\u2019s executions on previous bars. The script can only access the current bar\u2019s value while it executes on that bar, and it must <em>look back</em> through the historical series during that execution to compare the previous values.</p>\n<p>The script below uses a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a> loop to compare the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> values of <code dir=\"auto\">lengthInput</code> previous bars with the last historical bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>. Within the loop, it calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> to draw a circular <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> above each past bar that has a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> value exceeding that of the last historical bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"528\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-When-loops-are-necessary.Bpzukabm_Z288WAS.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Necessary loop demo\", overlay = true, max_labels_count = 500)\n\n//@variable The number of previous `high` values to compare to the last historical bar's `high`. \nint lengthInput = input.int(20, \"Length\", 1, 500)\n\nif barstate.islastconfirmedhistory\n    // Draw a horizontal line segment at the last historical bar's `high` to visualize the level. \n    line.new(bar_index - lengthInput, high, bar_index, high, color = color.gray, style = line.style_dashed, width = 2)\n    // Create a `for` loop that counts from 1 to `lengthInput`.\n    for i = 1 to lengthInput\n        // Draw a circular `label` above the bar from `i` bars ago if that bar's `high` is above the current `high`.\n        if high[i] &gt; high\n            label.new(\n                 bar_index - i, na, \"\", yloc = yloc.abovebar, color = color.purple, \n                 style = label.style_circle, size = size.tiny\n             )\n\n// Highlight the last historical bar.\nbarcolor(barstate.islastconfirmedhistory ? color.orange : na, title = \"Last historical bar highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>Each <em>iteration</em> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop retrieves a previous bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> with the history-referencing operator <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>, using the loop\u2019s <em>counter</em> (<code dir=\"auto\">i</code>) as the historical offset. The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> call also uses the counter to determine each label\u2019s x-coordinate.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator</a> declaration statement includes <code dir=\"auto\">max_labels_count = 500</code>, meaning the script can show up to 500 <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on the chart.</li>\n<li>The script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a> to highlight the last historical chart bar, and it draws a horizontal <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> at that bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> for visual reference.</li>\n</ul>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"common-characteristics\"><a href=\"#common-characteristics\">Common characteristics<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a>, <a href=\"/pine-script-docs/v5/language/loops/#while-loops\">while</a>, and <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">for\u2026in</a> loop statements all have similarities in their structure, syntax, and general behavior. Before we explore each specific loop type, let\u2019s familiarize ourselves with these characteristics.</p>\n<h3 class=\"md-heading\" id=\"structure-and-syntax\"><a href=\"#structure-and-syntax\">Structure and syntax<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In any loop statement, programmers define the criteria under which a script remains in a loop and performs <em>iterations</em>, where an iteration refers to <em>one execution</em> of the code within the loop\u2019s <a href=\"/pine-script-docs/v5/language/loops/#scope\">local block</a> (<em>body</em>). These criteria are part of the <em>loop header</em>. A script evaluates the header\u2019s criteria <em>before</em> each iteration, only allowing new iterations to occur while they remain valid. When the header\u2019s criteria are no longer valid, the script <em>exits</em> the loop and skips over its body.</p>\n<p>The specific header syntax varies with each loop statement (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>) because each uses <em>distinct</em> criteria to control its iterations. Effective use of loops entails choosing the structure with control criteria best suited for a script\u2019s required tasks. See the <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">`for` loops</a>, <a href=\"/pine-script-docs/v5/language/loops/#while-loops\">`while` loops</a>, and <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">`for\u2026in` loops</a> sections below for more information on each loop statement and its control criteria.</p>\n<p>All loop statements in Pine Script follow the same general syntax:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var_declaration =] loop_header</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">statements | continue | break</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">return_expression</span></div></div></code></pre></figure></link></div>\n<p>Where:</p>\n<ul>\n<li><code dir=\"auto\">loop_header</code> refers to the loop structure\u2019s header statement, which defines the criteria that control its iterations.</li>\n<li><code dir=\"auto\">statements</code> refers to the code statements and expressions within the loop\u2019s body, i.e., the <em>indented</em> block of code beneath the loop header. All statements within the body belong to the loop\u2019s <a href=\"/pine-script-docs/v5/language/loops/#scope\">local scope</a>.</li>\n<li><code dir=\"auto\">continue</code> and <code dir=\"auto\">break</code> are loop-specific <em>keywords</em> that control the flow of a loop\u2019s iterations. The <code dir=\"auto\">continue</code> keyword instructs the script to <em>skip</em> the remainder of the current loop iteration and <em>continue</em> to the next iteration. The <code dir=\"auto\">break</code> keyword prompts the script to <em>stop</em> the current iteration and <em>exit</em> the loop entirely. See <a href=\"/pine-script-docs/v5/language/loops/#keywords-and-return-expressions\">this section</a> for more information.</li>\n<li><code dir=\"auto\">return_expression</code> represents the last code line or block within the loop\u2019s body. The loop returns the results from this code after the final iteration. To use the values from a loop\u2019s return expression, <em>assign</em> the results to a variable or <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a>.</li>\n<li><code dir=\"auto\">var_declaration</code> is an optional variable or tuple <a href=\"/pine-script-docs/v5/language/variable-declarations/\">declaration</a>. If a loop statement includes a declared variable or tuple, the <code dir=\"auto\">return_expression</code> determines the assigned values. If the header\u2019s conditions do not allow the loop to iterate, the assigned values are <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"scope\"><a href=\"#scope\">Scope<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>All code lines that a script will execute within a loop must have an indentation of <em>four spaces</em> or a <em>tab</em> relative to the loop\u2019s header. The indented lines following the header define the loop\u2019s body. This code represents a <em>local block</em>, meaning that all the definitions within the body are accessible only during the loop\u2019s execution. In other words, the code within the loop\u2019s body is part of its <em>local scope</em>.</p>\n<p>Scripts can modify and <a href=\"/pine-script-docs/v5/language/variable-declarations/#variable-reassignment\">reassign</a> most variables from <em>outer</em> scopes inside a loop. However, any variables declared within the loop\u2019s body strictly belong to that loop\u2019s local scope. A script <strong>cannot</strong> access a loop\u2019s declared variables <em>outside</em> its local block.</p>\n<p>Note that:</p>\n<ul>\n<li>Variables declared within a loop\u2019s <em>header</em> are also part of the local scope. For instance, a script cannot use the <em>counter variable</em> in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop anywhere but within the loop\u2019s local block.</li>\n</ul>\n<p>The body of any Pine loop statement can include <a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> and <em>nested</em> loop statements. When a loop includes nested structures, each structure within the body maintains a <em>distinct</em> local scope. For example, variables declared within an <em>outer</em> loop\u2019s scope are accessible to an <em>inner</em> loop. However, any variables declared within the inner loop\u2019s scope are <strong>not</strong> accessible to the outer loop.</p>\n<p>The simple example below demonstrates how a loop\u2019s local scope works. This script calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop on the last historical bar to draw <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> above <code dir=\"auto\">lengthInput</code> past bars. The color of each label depends on the <code dir=\"auto\">labelColor</code> variable declared <em>within</em> the loop\u2019s local block, and each label\u2019s location depends on the loop counter (<code dir=\"auto\">i</code>):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"448\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-Common-characteristics-Scope.C3aeQeOf_uwxmQ.webp\" width=\"996\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop scope demo\", overlay = true)\n\n//@variable The number of bars in the calculation.\nint lengthInput = input.int(20, \"Lookback length\", 1)\n\nif barstate.islastconfirmedhistory\n    for i = 1 to lengthInput\n        //@variable Has a value of `color.blue` if `close[i]` is above the current `close`, `color.orange` otherwise.\n        //          This variable is LOCAL to the `for` loop's scope.\n        color labelColor = close[i] &gt; close ? color.blue : color.orange\n        // Display a colored `label` on the historical `high` from `i` bars back, using `labelColor` to set the color.\n        label.new(bar_index - i, high[i], \"\", color = labelColor, size = size.normal)</div>\n<p>In the above code, the <code dir=\"auto\">i</code> and <code dir=\"auto\">labelColor</code> variables are only accessible to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\u2019s local scope. They are <strong>not</strong> usable within any outer scopes. Here, we added a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> call <em>after</em> the loop with <code dir=\"auto\">bar_index - i</code> as the <code dir=\"auto\">x</code> argument and <code dir=\"auto\">labelColor</code> as the <code dir=\"auto\">color</code> argument. This code causes a <em>compilation error</em> because neither <code dir=\"auto\">i</code> nor <code dir=\"auto\">labelColor</code> are valid variables in the outer scope:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop scope demo\", overlay = true)\n\n//@variable The number of bars in the calculation.\nint lengthInput = input.int(20, \"Lookback length\", 1)\n\nif barstate.islastconfirmedhistory\n    for i = 1 to lengthInput\n        //@variable Has a value of `color.blue` if `close[i]` is above the current `close`, `color.orange` otherwise.\n        //          This variable is LOCAL to the `for` loop's scope.\n        color labelColor = close[i] &gt; close ? color.blue : color.orange\n        // Display a colored `label` on the historical `high` from `i` bars back, using `labelColor` to set the color.\n        label.new(bar_index - i, high[i], \"\", color = labelColor, size = size.normal)\n\n    // Call `label.new()` to using the `i` and `labelColor` variables outside the loop's local scope.\n    // This code causes a compilation error because these variables are not accessible in this location.  \n    label.new(\n         bar_index - i, low, \"Scope test\", textcolor = color.white, color = labelColor, style = label.style_label_up\n     )</div>\n<h3 class=\"md-heading\" id=\"keywords-and-return-expressions\"><a href=\"#keywords-and-return-expressions\">Keywords and return expressions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Every loop in Pine Script implicitly <em>returns</em> a result. The values a loop returns come from the <em>latest</em> execution of the <em>last</em> expression or nested structure within the loop body as of the <em>final</em> iteration. Loops return <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> values when no iterations occur. A loop\u2019s returned results are <em>usable</em> only if they are not of the <a href=\"/pine-script-docs/v5/language/type-system/#void\">void</a> type and the script assigns a variable or tuple <a href=\"/pine-script-docs/v5/language/variable-declarations/\">declaration</a> to the loop statement. The declared variables hold the values from the return expression for use in additional calculations outside the loop\u2019s <a href=\"/pine-script-docs/v5/language/loops/#scope\">scope</a>.</p>\n<p>The values a loop returns may come from evaluating the last written expression or nested code block on the <em>final</em> iteration. However, a loop\u2019s body can include <code dir=\"auto\">continue</code> and <code dir=\"auto\">break</code> keywords to control the flow of iterations beyond the criteria the loop header specifies, which can also affect the returned results. Programmers often include these keywords within <a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> to control how iterations behave when certain conditions occur.</p>\n<p>The <code dir=\"auto\">continue</code> keyword instructs a script to <em>skip</em> the remaining statements and expressions in the current loop iteration, re-evaluate the loop header\u2019s criteria, and proceed to the <em>next</em> iteration. The script <em>exits</em> the loop if the header\u2019s criteria do not allow another iteration.</p>\n<p>The <code dir=\"auto\">break</code> keyword instructs a script to <em>stop</em> the loop entirely and immediately <em>exit</em> at that point without allowing any subsequent iterations. After breaking the loop, the script skips any remaining code within the loop\u2019s body and <em>does not</em> re-evaluate the header\u2019s criteria.</p>\n<p>If a loop stops <em>prematurely</em> due to a <code dir=\"auto\">continue</code> or <code dir=\"auto\">break</code> keyword, it returns the values from the <em>last iteration</em> where the script <em>evaluated</em> the return expression. If the script <em>did not</em> evaluate the return expression across any of the loop\u2019s iterations, the loop returns <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> results.</p>\n<p>The example below selectively displays numbers from an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> on the last historical bar. It uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to iterate through the array\u2019s elements and build a \u201cstring\u201d to use as the displayed text. The loop\u2019s body contains an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> statement that controls the flow of specific iterations. If the <code dir=\"auto\">number</code> in the current iteration is 8, the script immediately <em>exits</em> the loop using the <code dir=\"auto\">break</code> keyword. Otherwise, if the <code dir=\"auto\">number</code> is even, it <em>skips</em> the rest of the current iteration and moves to the next one using the <code dir=\"auto\">continue</code> keyword.</p>\n<p>If neither of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> statement\u2019s conditions occur, the script evaluates the <em>last expression</em> within the loop\u2019s body (i.e., the return expression), which converts the current <code dir=\"auto\">number</code> to a \u201cstring\u201d and concatenates the result with the <code dir=\"auto\">tempString</code> value. The loop returns the <em>last evaluated result</em> from this expression after termination. The script assigns the returned value to the <code dir=\"auto\">finalLabelText</code> variable and uses that variable as the <code dir=\"auto\">text</code> argument in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"282\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-Common-characteristics-Keywords-and-return-expressions.DPxrsv1p_Zh1F86.webp\" width=\"750\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop keywords and variable assignment demo\")\n\n//@variable An `array` of arbitrary \"int\" values to selectively convert to \"string\" and display in a `label`.\nvar array&lt;int&gt; randomArray = array.from(1, 5, 2, -3, 14, 7, 9, 8, 15, 12)\n\n// Label creation logic.\nif barstate.islastconfirmedhistory\n    //@variable A \"string\" containing representations of selected values from the `randomArray`.\n    string tempString = \"\"\n    //@variable The final text to display in the `label`. The `for..in` loop returns the result after it terminates.\n    string finalLabelText = for number in randomArray\n        // Stop the current iteration and exit the loop if the `number` from the `randomArray` is 8.\n        if number == 8             \n            break \n        // Skip the rest of the current iteration and proceed to the next iteration if the `number` is even.   \n        else if number % 2 == 0   \n            continue\n        // Convert the `number` to a \"string\", append \", \", and concatenate the result with the current `tempString`.\n        // This code represents the loop's return expression. \n        tempString += str.tostring(number) + \", \"\n    \n    // Display the value of the `finalLabelText` within a `label` on the current bar.\n    label.new(bar_index, 0, finalLabelText, color = color.blue, textcolor = color.white, size = size.huge)</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> displays only <em>odd</em> numbers from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> because the script does not reassign the <code dir=\"auto\">tempString</code> when the loop iteration\u2019s <code dir=\"auto\">number</code> is even. However, it does not include the <em>last</em> odd number from the array (15) because the loop stops when <code dir=\"auto\">number == 8</code>, preventing iteration over the remaining <code dir=\"auto\">randomArray</code> elements.</li>\n<li>When the script exits the loop due to the <code dir=\"auto\">break</code> keyword, the loop\u2019s return value becomes the last evaluated result from the <code dir=\"auto\">tempString</code> reassignment expression. In this case, the last time that code executes is on the iteration where <code dir=\"auto\">number == 9</code>.</li>\n</ul>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"for-loops\"><a href=\"#for-loops\"><span>\u200b<code dir=\"auto\">for</code>\u200b loops</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop statement creates a <em>count-controlled</em> loop, which uses a <em>counter</em> variable to manage the executions of its local code block over a <em>defined number</em> of iterations.</p>\n<p>Pine Script uses the following syntax to define a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var_declaration =] for counter = from_num to to_num [by step_num]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">statements | continue | break</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">return_expression</span></div></div></code></pre></figure></div>\n<p>Where the following parts define the <em>loop header</em>:</p>\n<ul>\n<li><code dir=\"auto\">counter</code> represents the <em>variable</em> whose value the loop increments after each iteration.</li>\n<li><code dir=\"auto\">from_num</code> determines the <code dir=\"auto\">counter</code> variable\u2019s <em>initial value</em>, i.e., the value on the first iteration.</li>\n<li><code dir=\"auto\">to_num</code> determines the <code dir=\"auto\">counter</code> variable\u2019s <em>final value</em>, i.e., the maximum value of the loop counter that the header allows a new iteration for. The loop increments the <code dir=\"auto\">counter</code> value by a fixed amount until it <em>reaches or passes</em> this value.</li>\n<li><code dir=\"auto\">step_num</code> is the amount by which the <code dir=\"auto\">counter</code> value increases or decreases after each iteration until it reaches or passes the <code dir=\"auto\">to_num</code>. Specifying this value is optional. The default value is 1.</li>\n</ul>\n<p>See the <a href=\"/pine-script-docs/v5/language/loops/#common-characteristics\">Common characteristics</a> section above for detailed information about the <code dir=\"auto\">var_declaration</code>, <code dir=\"auto\">statements</code>, <code dir=\"auto\">continue</code>, <code dir=\"auto\">break</code>, and <code dir=\"auto\">return_expression</code> parts of the loop\u2019s syntax.</p>\n<p>This simple script demonstrates a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop that draws several <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> at future bar indices during its execution on the last historical chart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"322\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-loops-1.JEmTwodf_Zk2Mts.webp\" width=\"868\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Simple `for` loop demo\")\n\nif barstate.islastconfirmedhistory\n    // Define a `for` loop that iterates from `i == 0` to `i == 10`.\n    for i = 0 to 10\n        // Draw a new `label` on the current bar at the `i` level. \n        label.new(bar_index + i, 0, str.tostring(i), textcolor = color.white, size = size.large)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">i</code> variable represents the loop\u2019s <em>counter</em>. This variable is local to the loop\u2019s <a href=\"/pine-script-docs/v5/language/loops/#scope\">scope</a>, meaning no <em>outer scopes</em> can access it. The code uses the variable within the loop\u2019s body to determine the location and text of each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> drawing.</li>\n<li>Programmers often use <code dir=\"auto\">i</code>, <code dir=\"auto\">j</code>, and <code dir=\"auto\">k</code> as loop counter identifiers. However, <em>any</em> valid variable name is allowed. For example, this code would behave the same if we named the counter <code dir=\"auto\">level</code> instead of <code dir=\"auto\">i</code>.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop structure <em>automatically</em> manages the counter variable. We do not need to define code in the loop\u2019s body to increment its value.</li>\n<li>The loop\u2019s header specifies that the counter starts at 0 when the script enters the loop, and its value increases by 1 after each iteration until it reaches 10, at which point the last iteration occurs. In other words, the loop executes <em>11 iterations</em> in total.</li>\n</ul>\n<p>A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\u2019s local block repeatedly executes for the number of times required for its counter variable\u2019s value to reach the specified <code dir=\"auto\">to_num</code> boundary. The counter\u2019s defined boundaries and step size directly control the number of loop iterations. Therefore, a script establishes the expected number of iterations <em>before</em> the loop starts. As such, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loops are best suited for iterative tasks where the maximum number of iterations is knowable <em>in advance</em>.</p>\n<p>The example below calculates and plots the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.vwma\">volume-weighted moving average</a> (VWMA) of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a> prices across <code dir=\"auto\">maLengthInput</code> chart bars, and it analyzes the differences between the current <code dir=\"auto\">vwmaOpen</code> and past <code dir=\"auto\">vwmaOpen</code> values within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop on the last historical chart bar. On each loop iteration, the script retrieves a previous bar\u2019s <code dir=\"auto\">vwmaOpen</code> value, takes the difference between that value and the current <code dir=\"auto\">vwmaOpen</code>, and displays the result in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> at the corresponding historical bar\u2019s opening price:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-loops-2.WC3Reqlz_Z1587F3.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for` loop demo\", \"VWMA differences\", true, max_labels_count = 500)\n\n//@variable Display color for indicator visuals.\nconst color DISPLAY_COLOR = color.rgb(17, 127, 218)\n\n//@variable The number of bars in the `vwmaOpen` calculation.\nint maLengthInput = input.int(20, \"VWMA length\", 1)\n//@variable The number of past bars to look back through and compare to the current bar.\nint lookbackInput = input.int(15, \"Lookback length\", 1, 500)\n\n//@variable The volume-weighted moving average of `open` values over `maLengthInput` bars. \nfloat vwmaOpen = ta.vwma(open, maLengthInput)\n\n//On last bar, loop through `lengthInput` most recent historical bars and output `label` of differences in `vwmaOpen`.\nif barstate.islastconfirmedhistory\n    for i = lookbackInput to 1\n        //@variable The difference between the `vwmaOpen` from `i` bars ago and the current `vwmaOpen`.\n        float vwmaDifference = vwmaOpen[i] - vwmaOpen\n        //@variable A \"string\" representation of the `vwmaDifference` with sign specification and rounding. \n        string displayText = (vwmaDifference &gt; 0 ? \"+\" : \"\") + str.tostring(vwmaDifference, \"0.00\")\n        // Draw a `label` showing the `displayText` at the `open` of the bar from `i` bars back.\n        label.new(\n             bar_index - i, open[i], displayText, textcolor = color.white, color = DISPLAY_COLOR,\n             style = label.style_label_lower_right, size = size.normal\n         )\n\n// Plot the `vwmaOpen`.\nplot(vwmaOpen, \"VWMA\", color = DISPLAY_COLOR, linewidth = 2)</div>\n<p>Note that:</p>\n<ul>\n<li>The script uses the loop\u2019s counter (<code dir=\"auto\">i</code>) to within the <a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">history-referencing operator</a> to retrieve past values of the <code dir=\"auto\">vwmaOpen</code> series. It also uses the counter to determine the location of each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> drawing.</li>\n<li>The loop counter\u2019s value starts at the <code dir=\"auto\">lookbackInput</code> and <em>decreases</em> by 1 until <code dir=\"auto\">i == 1</code>.</li>\n</ul>\n<p>Programmers can use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loops to iterate through <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>, such as <a href=\"/pine-script-docs/v5/language/arrays\">arrays</a> and <a href=\"/pine-script-docs/v5/language/matrices\">matrices</a>. The loop\u2019s counter can serve as an <em>index</em> for retrieving or modifying a collection\u2019s contents. For example, this code block uses <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a> inside a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop to successively retrieve elements from an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>:</p>\n<div class=\"pine-colorizer not-content\">for i = 0 to array.size(myArray) \u2013 1\n   element = array.get(i)</div>\n<p>Note that:</p>\n<ul>\n<li>Array <em>indexing</em> starts from 0, but the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a> function <em>counts</em> the elements (i.e., starting from 1). Therefore, we have to subtract one from the array\u2019s size to get the maximum index value. This way, the loop counter avoids representing an array index that is <a href=\"/pine-script-docs/v5/language/arrays/#index-xx-is-out-of-bounds-array-size-is-yy\">out of bounds</a> on the last loop iteration.</li>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement is often the <em>preferred</em> way to loop through <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>. However, programmers may prefer a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop for some tasks, such as looping through stepped index values, iterating over a collection\u2019s contents in reverse or a nonlinear order, and more. See the <a href=\"/pine-script-docs/v5/language/loops/#looping-through-arrays\">Looping through arrays</a> and <a href=\"/pine-script-docs/v5/language/loops/#looping-through-matrices\">Looping through matrices</a> sections to learn more about the best practices for looping through these collection types.</li>\n</ul>\n<p>The script below calculates the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rsi\">RSI</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.mom\">momentum</a> of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> prices over three different lengths (10, 20, and 50) and displays their values within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> on the last chart bar. It stores \u201cstring\u201d values for the header title within <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and the \u201cfloat\u201d values of the calculated indicators within a 2x3 <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>. The script uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop to access the elements in the arrays and initialize the <code dir=\"auto\">displayTable</code> header cells. It then uses <em>nested</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loops to iterate over the <em>row</em> and <em>column</em> indices in the <code dir=\"auto\">taMatrix</code> to access its elements, convert their values to strings, and populate the remaining <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> cells:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"390\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-loops-3.LT8BH3HO_Z2ihhrX.webp\" width=\"932\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for` loop with collections demo\", \"Table of TA Indexes\", overlay = true)\n\n// Calculate the RSI and momentum of `close` values with constant lengths of 10, 20, and 50.\nfloat rsi10 = ta.rsi(close, 10)\nfloat rsi20 = ta.rsi(close, 20)\nfloat rsi50 = ta.rsi(close, 50)\nfloat mom10 = ta.mom(close, 10)\nfloat mom20 = ta.mom(close, 20)\nfloat mom50 = ta.mom(close, 50)\n \nif barstate.islast\n    //@variable A `table` that displays indicator values in the top-right corner of the chart. \n    var table displayTable = table.new(\n         position.top_right, columns = 5, rows = 4, border_color = color.black, border_width = 1 \n     )\n    //@variable An array containing the \"string\" titles to display within the side header of each table row. \n    array&lt;string&gt; sideHeaderTitles = array.from(\"TA Index\", \"RSI\", \"Momentum\")\n    //@variable An array containing the \"string\" titles to representing the length of each displayed indicator. \n    array&lt;string&gt; topHeaderTitles = array.from(\"10\", \"20\", \"50\")\n    //@variable A matrix containing the values to display within the table. \n    matrix&lt;float&gt; taMatrix = matrix.new&lt;float&gt;()\n    // Populate the `taMatrix` with indicator values. The first row contains RSI data and the second contains momentum.\n    taMatrix.add_row(0, array.from(rsi10, rsi20, rsi50, mom10, mom20, mom50))\n    taMatrix.reshape(2, 3)\n\n    // Initialize top header cells.\n    displayTable.cell(1, 0, \"Bars Length\", text_color = color.white, bgcolor = color.blue)\n    displayTable.merge_cells(1, 0, 3, 0)\n\n    // Initialize additional header cells within a `for` loop. \n    for i = 0 to 2\n        displayTable.cell(0, i + 1, sideHeaderTitles.get(i), text_color = color.white, bgcolor = color.blue)\n        displayTable.cell(i + 1, 1, topHeaderTitles.get(i), text_color = color.white, bgcolor = color.purple)\n\n    // Use nested `for` loops to iterate through the row and column indices of the `taMatrix`.\n    for i = 0 to taMatrix.rows() - 1 \n        for j = 0 to taMatrix.columns() - 1\n            //@variable The value stored in the `taMatrix` at the `i` row and `j` column. \n            float elementValue =  taMatrix.get(i, j)\n            // Initialize a cell in the `displayTable` at the `i + 2` row and `j + 1` column showing a \"string\" \n            // representation of the `elementValue`.\n            displayTable.cell(\n                 column = j + 1, row = i + 2, text = str.tostring(elementValue, \"#.##\"), text_color = chart.fg_color\n             )</div>\n<p>Note that:</p>\n<ul>\n<li>Both <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> of header names (<code dir=\"auto\">sideHeaderTitles</code> and <code dir=\"auto\">topHeaderTitles</code>) contain the same number of elements, which allows us to iterate through their contents simultaneously using a single <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop.</li>\n<li>The nested <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loops iterate over <em>all</em> the index values in the <code dir=\"auto\">taMatrix</code>. The <em>outer</em> loop iterates over each <em>row</em> index, and the <em>inner</em> loop iterates over every <em>column</em> index on each outer loop iteration.</li>\n<li>The script creates and displays the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> only on the last historical bar and all realtime bars because the historical states of <a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a> are <em>never</em> visible. See <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#reducing-drawing-updates\">this section</a> of the <a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/\">Profiling and optimization</a> page for more information.</li>\n</ul>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"while-loops\"><a href=\"#while-loops\"><span>\u200b<code dir=\"auto\">while</code>\u200b loops</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop statement creates a <em>condition-controlled</em> loop, which uses a <em>conditional expression</em> to control the executions of its local block. The loop continues its iterations as long as the conditional expression remains <code dir=\"auto\">true</code>.</p>\n<p>Pine Script uses the following syntax to define a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var_declaration =] while condition</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">statements | continue | break</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">return_expression</span></div></div></code></pre></figure></div>\n<p>Where the <code dir=\"auto\">condition</code> in the loop\u2019s <em>header</em> can be a literal, variable, expression, or function call that returns a \u201cbool\u201d value.</p>\n<p>See the <a href=\"/pine-script-docs/v5/language/loops/#common-characteristics\">Common characteristics</a> section above for detailed information about the <code dir=\"auto\">var_declaration</code>, <code dir=\"auto\">statements</code>, <code dir=\"auto\">continue</code>, <code dir=\"auto\">break</code>, and <code dir=\"auto\">return_expression</code> parts of the loop\u2019s syntax.</p>\n<p>A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop\u2019s header evaluates its <code dir=\"auto\">condition</code> before each iteration. Consequently, when the script modifies the condition within an iteration, the loop\u2019s header reflects those changes on the <em>next</em> iteration.</p>\n<p>Depending on the specified condition in the loop header, a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop can behave similarly to a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop, continuing iteration until a <em>counter</em> variable reaches a specified limit. For example, the following script uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop to perform the same task. Both loops draw a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> displaying their respective counter value on each iteration:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"316\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-While-loops-1.D6NOmppL_ZjTEtl.webp\" width=\"868\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`while` loop with a counter condition demo\")\n\nif barstate.islastconfirmedhistory\n    // A `for` loop that creates blue labels displaying each `i` value.\n    for i = 0 to 10\n        label.new(\n             bar_index + i, 0, str.tostring(i), color = color.blue, textcolor = color.white, \n             size = size.large, style = label.style_label_down\n         )\n\n    //@variable An \"int\" to use as a counter within a `while` loop.\n    int j = 0\n    // A `while` loop that creates orange labels displaying each `j` value.\n    while j &lt;= 10\n        label.new(\n             bar_index + j, 0, str.tostring(j), color = color.orange, textcolor = color.white, \n             size = size.large, style = label.style_label_up\n         )\n        // Update the `j` counter within the local block.\n        j += 1</div>\n<p>Note that:</p>\n<ul>\n<li>When a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop uses count-based logic, it must explicitly manage the user-specified counter within the local block. In contrast, a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop increments its counter automatically.</li>\n<li>The script declares the variable the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop uses as a counter <em>outside</em> the loop\u2019s <a href=\"/pine-script-docs/v5/language/loops/#scope\">scope</a>, meaning its value is usable in additional calculations after the loop terminates.</li>\n<li>If this code did not increment the <code dir=\"auto\">j</code> variable within the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop\u2019s body, the value would <em>never</em> reach 10, meaning the loop would run <em>indefinitely</em> until causing a <a href=\"/pine-script-docs/v5/error-messages/#loop-is-too-long--500-ms\">runtime error</a>.</li>\n</ul>\n<p>Because a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop\u2019s execution depends on its condition remaining <code dir=\"auto\">true</code> and the condition may not change on a specific iteration, the <em>precise</em> number of expected iterations may <strong>not</strong> be knowable <em>before</em> the loop begins, unlike a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop. Therefore, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loops are advantageous in scenarios where the exact loop boundaries are <em>unknown</em>.</p>\n<p>The script below tracks when the chart\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> crosses outside Keltner Channels with a user-specified length and channel width. When the price crosses outside the current bar\u2019s channel, the script draws a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a> highlighting all the previous <em>consecutive</em> bars with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> values within that price window. The script uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop to analyze past bars\u2019 prices and incrementally adjust the left side of each new <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a> until the drawing covers all the latest consecutive bars in the current range.</p>\n<p>A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop is necessary in this case because the current bar\u2019s channel values are <em>not</em> knowable in advance, and we <strong>cannot</strong> predict the precise number of iterations required to encapsulate all the consecutive bars within the channel\u2019s range:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"560\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-While-loops-2.CDUKt8KX_JSuga.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`while` loop demo\", \"Price window boxes\", true)\n\n//@variable The length of the channel.\nint lengthInput = input.int(20, \"Channel length\", 1, 4999)\n//@variable The width multiplier of the channel. \nfloat widthInput = input.float(2.0, \"Width multiplier\", 0)\n\n//@variable The `lengthInput`-bar EMA of `close` prices.\nfloat ma = ta.ema(close, lengthInput)\n//@variable The `lengthInput`-bar ATR, multiplied by the `widthInput`.\nfloat atr = ta.atr(lengthInput) * widthInput\n//@variable The lower bound of the channel.\nfloat channelLow = ma - atr\n//@variable The upper bound of the channel. \nfloat channelHigh = ma + atr\n\n//@variable Is `true` when the `close` price is outside the current channel range, `false` otherwise. \nbool priceOutsideChannel = close &lt; channelLow or close &gt; channelHigh\n\n// Check if the `close` crossed outside the channel range, then analyze the past bars within the current range. \nif priceOutsideChannel and not priceOutsideChannel[1]\n    //@variable A box that highlights consecutive past bars within the current channel's price window.  \n    box windowBox = box.new(\n         bar_index, channelHigh, bar_index, channelLow, border_width = 2, bgcolor = color.new(color.gray, 85)\n     )\n    //@variable The lookback index for box adjustment. The `while` loop increments this value on each iteration. \n    int i = 1\n    // Use a `while` loop to look backward through close` prices. The loop iterates as long as the past `close` \n    // from `i` bars ago is between the current bar's `channelLow` and `channelHigh`. \n    while close[i] &gt;= channelLow and close[i] &lt;= channelHigh\n        // Adjust the left side of the box. \n        windowBox.set_left(bar_index - i)\n        // Add 1 to the `i` value to check the `close` from the next bar back on the next iteration. \n        i += 1\n\n// Plot the `channelLow` and `channelHigh` for visual reference. \nplot(channelLow, \"Channel low\")\nplot(channelHigh, \"Channel high\")</div>\n<p>Note that:</p>\n<ul>\n<li>The left and right edges of <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> sit within the horizontal <em>center</em> of their respective bars, meaning that each drawing spans from the middle of the first consecutive bar to the middle of the last bar within each window.</li>\n<li>This script uses the <code dir=\"auto\">i</code> variable as a <a href=\"/pine-script-docs/v5/language/operators/#--history-referencing-operator\">history-referencing</a> index within the <em>conditional expression</em> the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop checks on each iteration. The variable <strong>does not</strong> behave as a loop counter, as the iteration boundaries are <strong>unknown</strong>. The loop executes its local block repeatedly until the condition becomes <code dir=\"auto\">false</code>.</li>\n</ul>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/loops", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"forin-loops\"><a href=\"#forin-loops\"><span>\u200b<code dir=\"auto\">for...in</code>\u200b loops</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement creates a <em>collection-controlled</em> loop, which uses the <em>contents</em> of a <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collection</a> to control its iterations. This loop structure is often the preferred approach for looping through <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>.</p>\n<p>A <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop traverses a collection <em>in order</em>, retrieving one of its stored items on each iteration. Therefore, the loop\u2019s boundaries depend directly on the number of <em>items</em> (<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> <em>elements</em>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> <em>rows</em>, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> <em>key-value pairs</em>). As such, similar to a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop, a script establishes the expected number of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop iterations <em>before</em> the loop starts.</p>\n<p>Pine Script features <em>two</em> general forms of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement. The <em>first form</em> uses the following syntax:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var_declaration =] for item in collection_id</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">statements | continue | break</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">return_expression</span></div></div></code></pre></figure></div>\n<p>Where <code dir=\"auto\">item</code> is a <em>variable</em> that holds sequential values from the specified <code dir=\"auto\">collection_id</code>. The variable\u2019s value starts with the collection\u2019s <em>first item</em> and takes on successive items in order after each iteration. This form is convenient when a script must access values from an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> iteratively but does not require the item\u2019s index in its calculations.</p>\n<p>The <em>second form</em> has a slightly different syntax that includes a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> in its <em>header</em>:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var_declaration =] for [index, item] in collection_id</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">statements | continue | break</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">return_expression</span></div></div></code></pre></figure></div>\n<p>Where <code dir=\"auto\">index</code> is a variable that contains the <em>index</em> or <em>key</em> of the retrieved <code dir=\"auto\">item</code>. This form is convenient when a task requires using a collection\u2019s items <em>and</em> their indices in iterative calculations. This form of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop is required when directly iterating through the contents of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>. See <a href=\"/pine-script-docs/v5/language/loops/#looping-through-maps\">this section</a> for more information.</p>\n<p>See the <a href=\"/pine-script-docs/v5/language/loops/#common-characteristics\">Common characteristics</a> section above for detailed information about the <code dir=\"auto\">var_declaration</code>, <code dir=\"auto\">statements</code>, <code dir=\"auto\">continue</code>, <code dir=\"auto\">break</code>, and <code dir=\"auto\">return_expression</code> parts of the loop\u2019s syntax.</p>\n<p>The iterative behavior of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop depends on the <em>type</em> of collection the header specifies as the <code dir=\"auto\">collection_id</code>:</p>\n<ul>\n<li>When using an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> in the header, the loop performs <a href=\"/pine-script-docs/v5/language/loops/#looping-through-arrays\"><em>element-wise</em> iteration</a>, meaning the retrieved <code dir=\"auto\">item</code> on each iteration is one of the array\u2019s <em>elements</em>.</li>\n<li>When using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> in the header, the loop performs <a href=\"/pine-script-docs/v5/language/loops/#looping-through-matrices\"><em>row-wise</em> iteration</a>, which means that each <code dir=\"auto\">item</code> represents a <em>row array</em>.</li>\n<li>When using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> in the header, the loop performs <a href=\"/pine-script-docs/v5/language/loops/#looping-through-maps\"><em>pair-wise</em> iteration</a>, which retrieves a <em>key</em> and corresponding <em>value</em> on each iteration.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"looping-through-arrays\"><a href=\"#looping-through-arrays\">Looping through arrays<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine scripts can iterate over the elements of <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> using any loop structure. However, the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop is typically the most convenient because it automatically verifies the size of an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> when controlling iterations. With other loop structures, programmers must carefully set the header\u2019s boundaries or conditions to <em>prevent</em> the loop from attempting to access an element at a <em>nonexistent</em> index.</p>\n<p>For example, one can use a <a href=\"/pine-script-docs/v5/language/loops/#for-loops\">for</a> loop to access an array\u2019s elements using the counter variable as the lookup index in functions such as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a>. However, to prevent <a href=\"/pine-script-docs/v5/language/arrays/#index-xx-is-out-of-bounds-array-size-is-yy\">out-of-bounds</a> errors, programmers must ensure the counter always represents a <em>valid index</em>. Additionally, if an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> might be <em>empty</em>, programmers must set conditions to prevent the loop\u2019s execution entirely.</p>\n<p>The code below shows a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop whose counter boundaries depend on the number of elements in an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>. If the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> is empty, containing 0 elements, the header\u2019s final counter value is <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, which <em>prevents</em> iteration. Otherwise, the final value is <em>one less</em> than the array\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">size</a> (i.e., the index of the last element):</p>\n<div class=\"pine-colorizer not-content\">for index = 0 to (array.size(myArray) == 0 ? na : array.size(myArray) - 1)\n    element = array.get(myArray, index)</div>\n<p>In contrast, a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop automatically validates an array\u2019s size and <em>directly</em> accesses its elements, providing a more convenient solution than a traditional <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop. The line below achieves the <em>same effect</em> as the code above without requiring the programmer to define boundaries explicitly or use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">array.get()</a> function to access each element:</p>\n<div class=\"pine-colorizer not-content\">for element in myArray</div>\n<p>The following example examines bars on a lower timeframe to gauge the strength of <em>intrabar</em> trends within each chart bar. The script uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> call to retrieve an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of intrabar <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hl2\">hl2</a> prices from a calculated <code dir=\"auto\">lowerTimeframe</code>. Then, it uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to access each <code dir=\"auto\">price</code> within the <code dir=\"auto\">intrabarPrices</code> array and compare the value to the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> to calculate the bar\u2019s <code dir=\"auto\">strength</code>. The script plots the <code dir=\"auto\">strength</code> as columns in a separate pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"554\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-arrays-1.D-rbYJQk_ZdCBAV.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for element in array` demo\", \"Intrabar strength\")\n\n//@variable A valid timeframe closest to one-tenth of the current chart's timeframe, \"1\" if the timeframe is too small.\nvar string lowerTimeframe = timeframe.from_seconds(math.max(int(timeframe.in_seconds() / 10), 60))\n//@variable An array of intrabar `hl2` prices calculated from the `lowerTimeframe`.\narray&lt;float&gt; intrabarPrices = request.security_lower_tf(\"\", lowerTimeframe, hl2)\n\n//@variable The excess trend strength of `intrabarPrices`. \nfloat strength = 0.0\n\n// Loop directly through the `intrabarPrices` array. Each iteration's `price` represents an array element.\nfor price in intrabarPrices\n    // Subtract 1 from the `strength` if the retrieved `price` is above the current bar's `close` price. \n    if price &gt; close\n        strength -= 1\n    // Add 1 to the `strength` if the retrieved `price` is below the current bar's `close` price. \n    else if price &lt; close\n        strength += 1\n\n//@variable Is `color.teal` when the `strength` is positive, `color.maroon` otherwise.\ncolor strengthColor = strength &gt; 0 ? color.teal : color.maroon\n\n// Plot the `strength` as columns colored by the `strengthColor`.\nplot(strength, \"Intrabar strength\", strengthColor, 1, plot.style_columns)</div>\n<p>The <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">second form</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop is a convenient solution when a script\u2019s calculations require accessing each element <em>and</em> corresponding index within an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>:</p>\n<div class=\"pine-colorizer not-content\">for [index, element] in myArray</div>\n<p>For example, suppose we want to display a <em>numerated</em> list of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> elements within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> while excluding values at specific indices. We can use the second form of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop structure to accomplish this task. The simple script below declares a <code dir=\"auto\">stringArray</code> variable that references an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of predefined \u201cstring\u201d values. On the last historical bar, the script uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to access each <code dir=\"auto\">index</code> and <code dir=\"auto\">element</code> in the <code dir=\"auto\">stringArray</code> to construct the <code dir=\"auto\">labelText</code>, which it uses in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a> call after the loop ends:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"400\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-arrays-2.CVOFB_ZV_Z20I1Ef.webp\" width=\"840\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for [index, item] in array` demo\", \"Array numerated output\")\n\n//@variable An array of \"string\" values to display as a numerated list.\nvar array&lt;string&gt; stringArray = array.from(\"First\", \"Second\", \"Third\", \"Before Last\", \"Last\")\n\nif barstate.islastconfirmedhistory\n    //@variable A \"string\" modified within a loop to display within the `label`.\n    string labelText = \"Array values: \\n\"\n    // Loop through the `stringArray`, accessing each `index` and corresponding `element`. \n    for [index, element] in stringArray\n        // Skip the third `element` (at `index == 2`) in the `labelText`. Include an \"ELEMENT SKIPPED\" message instead. \n        if index == 2\n            labelText += \"-- ELEMENT SKIPPED -- \\n\"\n            continue\n        labelText += str.tostring(index + 1) + \": \" + element + \"\\n\"\n    // Display the `labelText` within a `label`.\n    label.new(\n         bar_index, 0, labelText, textcolor = color.white, size = size.huge, \n         style = label.style_label_center, textalign = text.align_left\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>This example adds 1 to the <code dir=\"auto\">index</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a> call to start the numerated list with a value of \u201c1\u201d, as <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> indexing always begins at 0.</li>\n<li>On the <em>third</em> loop iteration, when <code dir=\"auto\">index == 2</code>, the script adds an \u201cELEMENT SKIPPED\u201d message to the <code dir=\"auto\">labelText</code> instead of the retrieved <code dir=\"auto\">element</code> and uses the <code dir=\"auto\">continue</code> keyword to skip the remainder of the iteration. See <a href=\"/pine-script-docs/v5/language/loops/#keywords-and-return-expressions\">this section</a> above to learn more about loop keywords.</li>\n</ul>\n<p>Let\u2019s explore an advanced example demonstrating the utility of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loops. The following indicator draws a fixed number of horizontal <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> at calculated <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.pivothigh\">pivot high</a> levels, and it analyzes the lines within a loop to determine which ones represent active (<em>uncrossed</em>) pivots.</p>\n<p>Each time the script detects a new pivot high point, it creates a new <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>, <em>inserts</em> that line at the beginning of the <code dir=\"auto\">pivotLines</code> array, then removes the oldest element and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">deletes</a> its ID. The script accesses each <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a> within the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop, analyzing and <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#modifying-lines\">modifying</a> the properties of the <code dir=\"auto\">pivotLine</code> retrieved on each iteration. When the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> crosses above the <code dir=\"auto\">pivotLine</code>, the script changes its style to signify that it is no longer an active level. Otherwise, it extends the line\u2019s <code dir=\"auto\">x2</code> coordinate and uses its <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.get_price\">price</a> to calculate the average <em>active</em> pivot value. The script also plots each pivot high value and the average active pivot for visual reference:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"556\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-arrays-3.92QH6mmE_Z1GaAhA.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for...in` loop with arrays demo\", \"Active high pivots\", true, max_lines_count = 500)\n\n//@variable The number of bars required on the left and right to confirm a pivot point. \nint pivotBarsInput = input.int(5, \"Pivot leg length\", 1)\n//@variable The number of recent pivot lines to analyze. Controls the size of the `pivotLines` array.\nint maxRecentLines = input.int(20, \"Maximum recent lines\", 1, 500)\n\n//@variable An array that acts as a queue holding the most recent pivot high lines. \nvar array&lt;line&gt; pivotLines = array.new&lt;line&gt;(maxRecentLines)\n//@variable The pivot high price, or `na` if no pivot is found.\nfloat highPivotPrice = ta.pivothigh(pivotBarsInput, pivotBarsInput)\n//@variable The average active `highPivotPrice`. \nfloat avgHiPivot = ta.sma(highPivotPrice, maxRecentLines)\n\nif not na(highPivotPrice)\n    //@variable The `chart.point` for the start of the line. Does not contain `time` information.\n    firstPoint = chart.point.from_index(bar_index - pivotBarsInput, highPivotPrice)\n    //@variable The `chart.point` for the end of each line. Does not contain `time` information.\n    secondPoint = chart.point.from_index(bar_index, highPivotPrice)\n    //@variable A horizontal line at the new pivot level. \n    line hiPivotLine = line.new(firstPoint, secondPoint, width = 2, color = color.green) \n    // Insert the `hiPivotLine` at the beginning of the `pivotLines` array.\n    pivotLines.unshift(hiPivotLine)\n    // Remove the oldest line from the array and delete its ID.\n    line.delete(pivotLines.pop())\n\n//@variable The sum of active pivot prices.\nfloat activePivotSum = 0.0\n//@variable The number of active pivot high levels.\nint numActivePivots = 0\n\n// Loop through the `pivotLines` array, directly accessing each `pivotLine` element. \nfor pivotLine in pivotLines\n    //@variable The `x2` coordinate of the `pivotline`.\n    int lineEnd = pivotLine.get_x2()\n    // Move to the next `pivotline` in the array if the current line is inactive.\n    if pivotLine.get_x2() &lt; bar_index - 1\n        continue\n    //@variable The price value of the `pivotLine`.\n    float pivotPrice = pivotLine.get_price(bar_index)\n    // Change the style of the `pivotLine` and stop extending its display if the `high` is above the `pivotPrice`.\n    if high &gt; pivotPrice\n        pivotLine.set_color(color.maroon)\n        pivotLine.set_style(line.style_dotted)\n        pivotLine.set_width(1)\n        continue\n    // Extend the `pivotLine` and add the `pivotPrice` to the `activePivotSum` when the loop allows a full iteration.\n    pivotLine.set_x2(bar_index)\n    activePivotSum  += pivotPrice\n    numActivePivots += 1\n\n//@variable The average active pivot high value.\nfloat avgActivePivot = activePivotSum / numActivePivots\n\n// Plot crosses at the `highPivotPrice`, offset backward by the `pivotBarsInput`.\nplot(highPivotPrice, \"High pivot marker\", color.green, 3, plot.style_cross, offset = -pivotBarsInput)\n// Plot the `avgActivePivot` as a line with breaks.\nplot(avgActivePivot, \"Avg. active pivot\", color.orange, 3, plot.style_linebr)</div>\n<p>Note that:</p>\n<ul>\n<li>The loop in this example executes on <em>every bar</em> because it has to compare each active <code dir=\"auto\">pivotLine</code>\u2019s price with the current <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a> value, and it uses the prices to calculate the <code dir=\"auto\">avgActivePivot</code> on each bar.</li>\n<li>Pine Script features several ways to calculate averages, many of which <em>do not</em> require a loop. However, a loop is <a href=\"/pine-script-docs/v5/language/loops/#when-loops-are-necessary\">necessary</a> in this example because the script uses information only available on the <strong>current bar</strong> to determine which prices contribute toward the average.</li>\n<li>The <em>first</em> form of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop is the most convenient option in this example because we need\u00a0direct\u00a0access to the <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a> within the <code dir=\"auto\">pivotLines</code> array, but we do not need the corresponding <em>index</em> values.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"looping-through-matrices\"><a href=\"#looping-through-matrices\">Looping through matrices<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine scripts can iterate over the contents of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> in several different ways. Unlike <a href=\"/pine-script-docs/v5/language/arrays\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> use <em>two</em> indices to reference their elements because they store data in a <em>rectangular</em> format. The first index refers to <em>rows</em>, and the second refers to <em>columns</em>. If a programmer opts to use <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loops to iterate through <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> instead of using <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>, they must carefully define the loop boundaries or conditions to avoid <a href=\"/pine-script-docs/v5/language/matrices/#the-rowcolumn-index-xx-is-out-of-bounds-rowcolumn-size-is-yy\">out-of-bounds</a> errors.</p>\n<p>This code block shows a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop that performs <em>row-wise</em> iteration, looping through each <em>row index</em> in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> and using the value in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a> call to retrieve a row <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>. If the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> is empty, the loop statement uses a final loop counter value of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> to <em>prevent</em> iteration. Otherwise, the final counter is <em>one less</em> than the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">row count</a>, which represents the <em>last</em> row index:</p>\n<div class=\"pine-colorizer not-content\">for rowIndex = 0 to (myMatrix.rows() == 0 ? na : myMatrix.rows() - 1)\n    rowArray = myMatrix.row(rowIndex)</div>\n<p>Note that:</p>\n<ul>\n<li>If we replace the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">matrix.rows()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a> calls with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.columns\">matrix.columns()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">matrix.col()</a>, the loop performs <em>column-wise</em> iteration instead.</li>\n</ul>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement is the more convenient approach to loop over and access the rows of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> in order, as it automatically validates the number of rows and retrieves an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> of the current row\u2019s elements on each iteration:</p>\n<div class=\"pine-colorizer not-content\">for rowArray in myMatrix</div>\n<p>When a script\u2019s calculations require access to each row from a matrix and its corresponding <em>index</em>, programmers can use the <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">second form</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop:</p>\n<div class=\"pine-colorizer not-content\">for [rowIndex, rowArray] in myMatrix</div>\n<p>Note that:</p>\n<ul>\n<li>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop only performs <strong>row-wise</strong> iteration on <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>. To <em>emulate</em> column-wise iteration, programmers can use a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop on a <a href=\"/pine-script-docs/v5/language/matrices/#transposing\">transposed copy</a>.</li>\n</ul>\n<p>The following example displays a custom \u201cstring\u201d representing the rows of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> with extra information, which it displays within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>. When the script executes on the last historical bar, it creates a 3x3 <code dir=\"auto\">randomMatrix</code> populated with <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a> values. Then, using the <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">first form</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop, the script iterates through each <code dir=\"auto\">row</code> in the <code dir=\"auto\">randomMatrix</code> to create a \u201cstring\u201d representing the row\u2019s contents, its <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">average</a>, and whether the average is above 0.5, and it concatenates that \u201cstring\u201d with the <code dir=\"auto\">labelText</code>. After the loop ends, the script creates a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> displaying the <code dir=\"auto\">labelText</code> value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"404\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-matrices-1.MLIBFwlx_ZsMuB0.webp\" width=\"1036\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`for row in matrix` demo\", \"Custom matrix label\")\n\n//@variable Generates a random value between 0 and 1, rounded to 4 decimal places. \nrand() =&gt;\n    math.round(math.random(), 4)\n\nif barstate.islastconfirmedhistory\n    //@variable A matrix of randomized values to format and display in a `label`. \n    matrix&lt;float&gt; randomMatrix = matrix.new&lt;float&gt;()\n    // Add a row of 9 randomized values and reshape the matrix to 3x3.\n    randomMatrix.add_row(\n         0, array.from(rand(), rand(), rand(), rand(), rand(), rand(), rand(), rand(), rand())\n     )\n    randomMatrix.reshape(3, 3)\n\n    //@variable A custom \"string\" representation of `randomMatrix` information. Modified within a loop.\n    string labelText = \"Matrix rows: \\n\"\n\n    // Loop through the rows in the `randomMatrix`.\n    for row in randomMatrix\n        //@variable The average element value within the `row`.\n        float rowAvg = row.avg()\n        //@variable An upward arrow when the `rowAvg` is above 0.5, a downward arrow otherwise.\n        string directionChar = rowAvg &gt; 0.5 ? \"\u2b06\" : \"\u2b07\"\n        // Add a \"string\" representing the `row` array, its average, and the `directionChar` to the `labelText`.\n        labelText += str.format(\"Row: {0} Avg: {1} {2}\\n\", row, rowAvg, directionChar)\n    \n    // Draw a `label` displaying the `labelText` on the current bar.\n    label.new(\n         bar_index, 0, labelText, color = color.purple, textcolor = color.white, size = size.huge, \n         style = label.style_label_center, textalign = text.align_left\n     )</div>\n<p>Working with <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> often entails iteratively accessing their <em>elements</em>, not just their rows and columns, typically using <em>nested loops</em>. For example, this code block uses an outer <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop to iterate over row indices. The inner <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop iterates over column indices on <em>each</em> outer loop iteration and calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">matrix.get()</a> to access an element:</p>\n<div class=\"pine-colorizer not-content\">for rowIndex = 0 to (myMatrix.rows() == 0 ? na : myMatrix.rows() - 1)\n    for columnIndex = 0 to myMatrix.columns() \u2013 1\n        element = myMatrix.get(rowIndex, columnIndex)</div>\n<p>Alternatively, a more convenient approach for this type of task is to use nested <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loops. The outer <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop in this code block retrieves each row <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> in a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>, and the inner <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> statement <a href=\"/pine-script-docs/v5/language/loops/#looping-through-arrays\">loops through that array</a>:</p>\n<div class=\"pine-colorizer not-content\">for rowArray in myMatrix\n    for element in rowArray</div>\n<p>The script below creates a 3x2 <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>, then accesses and modifies its elements within nested <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loops. Both loops use the <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">second form</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> statement to retrieve index values and corresponding items. The outer loop accesses a row index and row <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> from the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>. The inner loop accesses each index and respective element from that <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.</p>\n<p>Within the nested loop\u2019s iterations, the script converts each <code dir=\"auto\">element</code> to a \u201cstring\u201d and initializes a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a> cell at the <code dir=\"auto\">rowIndex</code> row and <code dir=\"auto\">colIndex</code> column. Then, it uses the loop header variables within <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">matrix.set()</a> to update the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> element. After the outer loop terminates, the script displays a \u201cstring\u201d representation of the <em>updated</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a> within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"370\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-matrices-2.CZ4aQPdE_2aLlhM.webp\" width=\"848\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Nested `for...in` loops on matrices demo\")\n\nif barstate.islastconfirmedhistory\n    //@variable  A matrix containing numbers to display.\n    matrix&lt;float&gt; displayNumbers = matrix.new&lt;float&gt;()\n    // Populate the `displayNumbers` matrix and reshape to 3x2.\n    displayNumbers.add_row(0, array.from(1, 2, 3, 4, 5, 6))\n    displayNumbers.reshape(3, 2)\n\n    //@variable A table that displays the elements of the `displayNumbers` before modification. \n    table displayTable = table.new(\n         position = position.middle_center, columns = displayNumbers.columns(), rows = displayNumbers.rows(), \n         bgcolor = color.purple, border_color = color.white, border_width = 2\n     )\n\n    // Loop through the `displayNumbers`, retrieving the `rowIndex` and the current `row`. \n    for [rowIndex, row] in displayNumbers\n        // Loop through the current `row` on each outer loop iteration to retrieve the `colIndex` and `element`.\n        for [colIndex, element] in row\n            // Initialize a table cell at the `rowIndex` row and `colIndex` column displaying the current `element`.\n            displayTable.cell(column = colIndex, row = rowIndex, text = str.tostring(element), \n                 text_color = color.white, text_size = size.huge\n             )\n            // Update the `displayNumbers` value at the `rowIndex` and `colIndex`.\n            displayNumbers.set(rowIndex, colIndex, math.round(math.exp(element), 3))\n\n    // Draw a `label` to display a \"string\" representation of the updated `displayNumbers` matrix. \n    label.new( \n         x = bar_index, y = 0, text = \"Matrix now modified: \\n\" + str.tostring(displayNumbers), color = color.orange, \n         textcolor = color.white, size = size.huge, style = label.style_label_up \n     )</div>\n<h3 class=\"md-heading\" id=\"looping-through-maps\"><a href=\"#looping-through-maps\">Looping through maps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement is the primary, most convenient approach for iterating over the data within Pine Script <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>.</p>\n<p>Unlike <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, maps are <em>unordered collections</em> that store data in <em>key-value pairs</em>. Rather than traversing an internal lookup index, a script references the <em>keys</em> from the pairs within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> to access its <em>values</em>. Therefore, when looping through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>, scripts must perform <em>pair-wise</em> iteration, which entails retrieving key-value pairs across iterations rather than indexed <a href=\"/pine-script-docs/v5/language/loops/#looping-through-arrays\">elements</a> or <a href=\"/pine-script-docs/v5/language/loops/#looping-through-matrices\">rows</a>.</p>\n<p>Note that:</p>\n<ul>\n<li>Although <a href=\"/pine-script-docs/v5/language/maps/\">maps</a> are unordered collections, Pine Script internally tracks the <em>insertion order</em> of their key-value pairs.</li>\n</ul>\n<p>One way to access the data from a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> is to use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a> function, which returns an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> containing all the <em>keys</em> from the map, sorted in their insertion order. A script can use the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> structure to <a href=\"/pine-script-docs/v5/language/loops/#looping-through-arrays\">loop through the array</a> of keys and call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.get\">map.get()</a> to retrieve corresponding values:</p>\n<div class=\"pine-colorizer not-content\">for key in myMap.keys()\n    value = myMap.get(key)</div>\n<p>However, the more convenient, <em>recommended</em> approach is to loop through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> directly <em>without</em> creating new <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>. To loop through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> directly, use the <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">second form</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement. Using this loop with a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> creates a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> containing a <em>key</em> and respective <em>value</em> on each iteration. As when looping through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a> array, this <em>direct</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop iterates through a map\u2019s contents in their insertion order:</p>\n<div class=\"pine-colorizer not-content\">for [key, value] in myMap</div>\n<p>Note that:</p>\n<ul>\n<li>The second form of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop is the <strong>only</strong> way to iterate <em>directly</em> through a map. A script cannot directly loop through this collection type without retrieving a key and value on each iteration.</li>\n</ul>\n<p>Let\u2019s consider a simple example demonstrating how a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop works on a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>. When the script below executes on the last historical bar, it declares a <code dir=\"auto\">simpleMap</code> variable with an assigned <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> of \u201cstring\u201d keys and \u201cfloat\u201d values. The script <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">puts</a> the keys from the <code dir=\"auto\">newKeys</code> array into the collection with corresponding <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a> values. It then uses a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to iterate through the key-value pairs from the <code dir=\"auto\">simpleMap</code> and construct the <code dir=\"auto\">displayText</code>. After the loop ends, the script shows the <code dir=\"auto\">displayText</code> within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a> to visualize the result:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"404\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Loops-For-in-loops-Looping-through-maps.CZTQ1Hx7_Z1jyX7b.webp\" width=\"860\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Looping through map demo\")\n\nif barstate.islastconfirmedhistory\n    //@variable A map of \"string\" keys and \"float\" values to render within a `label`.\n    map&lt;string, float&gt; simpleMap = map.new&lt;string, float&gt;()\n\n    //@variable An array of \"string\" values representing the keys to put into the map. \n    array&lt;string&gt; newKeys = array.from(\"A\", \"B\", \"C\", \"D\", \"E\")\n    // Put key-value pairs into the `simpleMap`. \n    for key in newKeys\n        simpleMap.put(key, math.random(1, 20))\n\n    //@variable A \"string\" representation of the `simpleMap` contents. Modified within a loop. \n    string displayText = \"simpleMap content: \\n \"\n\n    // Loop through each key-value pair within the `simpleMap`. \n    for [key, value] in simpleMap\n        // Add a \"string\" representation of the pair to the `displayText`.\n        displayText += key + \": \" + str.tostring(value, \"#.##\") + \"\\n \"\n    \n    // Draw a `label` showing the `displayText` on the current bar. \n    label.new( \n         x = bar_index, y = 0, text = displayText, color = color.green, textcolor = color.white, \n         size = size.huge, textalign = text.align_left, style = label.style_label_center\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>This script utilizes <a href=\"/pine-script-docs/v5/language/loops/#forin-loops\">both forms</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop statement. The first loop iterates through the \u201cstring\u201d elements of the <code dir=\"auto\">newKeys</code> array to put key-value pairs into the <code dir=\"auto\">simpleMap</code>, and the second iterates directly through the map\u2019s key-value pairs to construct the custom <code dir=\"auto\">displayText</code>.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span></p><p>Scripts can modify the sizes of <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> while iterating through them with a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop. However, it\u2019s crucial to note that while a script iterates through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> with a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop, that map\u2019s size <strong>cannot</strong> change. Attempting to <em>add</em> or <em>remove</em> key-value pairs while looping directly through a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> will cause a <em>runtime error</em>.</p><p>To modify a map\u2019s size within a loop, programmers can do any of the following:</p><ul>\n<li>Make a <a href=\"/pine-script-docs/v5/language/maps/#copying-a-map\">copy</a> of the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a> and loop through that copied instance.</li>\n<li>Use a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop to iterate through the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a> array.</li>\n<li>Use a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a> loop instead of a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a> loop.</li>\n</ul><p></p></div></aside>", "segment_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "89267b105f9c87a0742754edfd92ce88f368accbe138aa53e02c9f6ba68be164", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/maps\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"maps\"><a href=\"#maps\">Maps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script Maps are collections that store elements in <em>key-value\npairs</em>. They allow scripts to collect multiple value references\nassociated with unique identifiers (keys).</p>\n<p>Unlike <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, maps are <em>unordered</em> collections. Scripts quickly access a map\u2019s\nvalues by referencing the keys from the key-value pairs put into them\nrather than traversing an internal index.</p>\n<p>A map\u2019s keys can be of any <a href=\"/pine-script-docs/v5/language/type-system/#types\">fundamental type</a> or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>,\nand its values can be of any available type. Maps cannot directly use other <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> (maps, <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, or <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>) as values, but they can hold <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a> instances containing these data structures within their fields. See <a href=\"/pine-script-docs/v5/language/maps/#maps-of-other-collections\">this section</a> for more information.</p>\n<p>As with other collections, maps can contain up to 100,000 elements in\ntotal. Since each key-value pair in a map consists of two elements (a\nunique <em>key</em> and its associated <em>value</em>), the maximum number of\nkey-value pairs a map can hold is 50,000.</p>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaring-a-map\"><a href=\"#declaring-a-map\">Declaring a map<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script uses the following syntax to declare maps:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var/varip ][map&lt;keyType, valueType&gt; ]&lt;identifier&gt; = &lt;expression&gt;</span></div></div></code></pre></figure></link></div>\n<p>Where <code dir=\"auto\">&lt;keyType, valueType&gt;</code> is the map\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> that declares the types of keys and values it will contain,\nand the <code dir=\"auto\">&lt;expression&gt;</code> returns either a map instance or <code dir=\"auto\">na</code>.</p>\n<p>When declaring a map variable assigned to <code dir=\"auto\">na</code>, users must include the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nkeyword followed by a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> to tell the compiler that the variable can accept maps with\n<code dir=\"auto\">keyType</code> keys and <code dir=\"auto\">valueType</code> values.</p>\n<p>For example, this line of code declares a new <code dir=\"auto\">myMap</code> variable that can\naccept map instances holding pairs of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues:</p>\n<div class=\"pine-colorizer not-content\">map&lt;string, float&gt; myMap = na</div>\n<p>When the <code dir=\"auto\">&lt;expression&gt;</code> is not <code dir=\"auto\">na</code>, the compiler does not require\nexplicit type declaration, as it will infer the type information from\nthe assigned map object.</p>\n<p>This line declares a <code dir=\"auto\">myMap</code> variable assigned to an empty map with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues. Any maps assigned to this variable later must have the same key\nand value types:</p>\n<div class=\"pine-colorizer not-content\">myMap = map.new&lt;string, float&gt;()</div>\n<h3 class=\"md-heading\" id=\"using-var-and-varip-keywords\"><a href=\"#using-var-and-varip-keywords\"><span>Using \u200b<code dir=\"auto\">var</code>\u200b and \u200b<code dir=\"auto\">varip</code>\u200b keywords</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users can include the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeywords to instruct their scripts to declare map variables only on the\nfirst chart bar. Variables that use these keywords point to the same map\ninstances on each script iteration until explicitly reassigned.</p>\n<p>For example, this script declares a <code dir=\"auto\">colorMap</code> variable assigned to a\nmap that holds pairs of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_color\">color</a>\nvalues on the first chart bar. The script displays an <code dir=\"auto\">oscillator</code> on\nthe chart and uses the values it\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">put</a>\ninto the <code dir=\"auto\">colorMap</code> on the <em>first</em> bar to color the plots on <em>all</em> bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"646\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Declaring-a-map-Using-var-and-varip-keywords-1.DMKyDQUN_ZNaztD.webp\" width=\"1280\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"var map demo\")\n\n//@variable A map associating color values with string keys.\nvar colorMap = map.new&lt;string, color&gt;()\n\n// Put `&lt;string, color&gt;` pairs into `colorMap` on the first bar.\nif bar_index == 0\n    colorMap.put(\"Bull\", color.green)\n    colorMap.put(\"Bear\", color.red)\n    colorMap.put(\"Neutral\", color.gray)\n\n//@variable The 14-bar RSI of `close`.\nfloat oscillator = ta.rsi(close, 14)\n\n//@variable The color of the `oscillator`.\ncolor oscColor = switch\n    oscillator &gt; 50 =&gt; colorMap.get(\"Bull\")\n    oscillator &lt; 50 =&gt; colorMap.get(\"Bear\")\n    =&gt;                 colorMap.get(\"Neutral\")\n\n// Plot the `oscillator` using the `oscColor` from our `colorMap`.\nplot(oscillator, \"Histogram\", oscColor, 2, plot.style_histogram, histbase = 50)\nplot(oscillator, \"Line\", oscColor, 3)</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Map variables declared using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nbehave as ones using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> on\nhistorical data, but they update their key-value pairs for realtime bars\n(i.e., the bars since the script\u2019s last compilation) on each new price\ntick. Maps assigned to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nvariables can only hold values of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_bool\">bool</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_color\">color</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\ntypes or\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> that exclusively contain within their fields these types or\ncollections (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>,\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, or maps) of\nthese types.</p></div></aside>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"reading-and-writing\"><a href=\"#reading-and-writing\">Reading and writing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"putting-and-getting-key-value-pairs\"><a href=\"#putting-and-getting-key-value-pairs\">Putting and getting key-value pairs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>\nfunction is one that map users will utilize quite often, as it\u2019s the\nprimary method to put a new key-value pair into a map. It associates the\n<code dir=\"auto\">key</code> argument with the <code dir=\"auto\">value</code> argument in the call and adds the pair\nto the map <code dir=\"auto\">id</code>.</p>\n<p>If the <code dir=\"auto\">key</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>\ncall already exists in the map\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">keys</a>,\nthe new pair passed into the function will <strong>replace</strong> the existing one.</p>\n<p>To retrieve the value from a map <code dir=\"auto\">id</code> associated with a given <code dir=\"auto\">key</code>, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.get\">map.get()</a>.\nThis function returns the value if the <code dir=\"auto\">id</code> map\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.contains\">contains</a>\nthe <code dir=\"auto\">key</code>. Otherwise, it returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>The following example calculates the difference between the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nvalues from when\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nwas last\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rising\">rising</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.falling\">falling</a>\nover a given <code dir=\"auto\">length</code> with the help of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.get\">map.get()</a>\nmethods. The script puts a <code dir=\"auto\">(\"Rising\", bar_index)</code> pair into the <code dir=\"auto\">data</code>\nmap when the price is rising and puts a <code dir=\"auto\">(\"Falling\", bar_index)</code> pair\ninto the map when the price is falling. It then puts a pair containing\nthe \u201cDifference\u201d between the \u201cRising\u201d and \u201cFalling\u201d values into\nthe map and plots its value on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"646\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Putting-and-getting-key-value-pairs-1.CnULguMa_ZMFlOi.webp\" width=\"1280\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Putting and getting demo\")\n\n//@variable The length of the `ta.rising()` and `ta.falling()` calculation.\nint length = input.int(2, \"Length\")\n\n//@variable A map associating `string` keys with `int` values.\nvar data = map.new&lt;string, int&gt;()\n\n// Put a new (\"Rising\", `bar_index`) pair into the `data` map when `close` is rising.\nif ta.rising(close, length)\n    data.put(\"Rising\", bar_index)\n// Put a new (\"Falling\", `bar_index`) pair into the `data` map when `close` is falling.\nif ta.falling(close, length)\n    data.put(\"Falling\", bar_index)\n\n// Put the \"Difference\" between current \"Rising\" and \"Falling\" values into the `data` map.\ndata.put(\"Difference\", data.get(\"Rising\") - data.get(\"Falling\"))\n\n//@variable The difference between the last \"Rising\" and \"Falling\" `bar_index`.\nint index = data.get(\"Difference\")\n\n//@variable Returns `color.green` when `index` is positive, `color.red` when negative, and `color.gray` otherwise.\ncolor indexColor = index &gt; 0 ? color.green : index &lt; 0 ? color.red : color.gray\n\nplot(index, color = indexColor, style = plot.style_columns)</div>\n<p>Note that:</p>\n<ul>\n<li>This script replaces the values associated with the \u201cRising\u201d,\n\u201cFalling\u201d, and \u201cDifference\u201d keys on successive\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">data.put()</a>\ncalls, as each of these keys is unique and can only appear once\nin the <code dir=\"auto\">data</code> map.</li>\n<li>Replacing the pairs in a map does not change the internal\n<em>insertion order</em> of its keys. We discuss this further in the\n<a href=\"/pine-script-docs/v5/language/maps/#inspecting-keys-and-values\">next section</a>.</li>\n</ul>\n<p>Similar to working with other collections, when putting a value of a\n<em>special type</em>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>)\nor a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> into a map, it\u2019s important to note the inserted pair\u2019s\n<code dir=\"auto\">value</code> points to that same object without copying it. Modifying the\nvalue referenced by a key-value pair will also affect the original\nobject.</p>\n<p>For example, this script contains a custom <code dir=\"auto\">ChartData</code> type with <code dir=\"auto\">o</code>,\n<code dir=\"auto\">h</code>, <code dir=\"auto\">l</code>, and <code dir=\"auto\">c</code> fields. On the first chart bar, the script declares a\n<code dir=\"auto\">myMap</code> variable and adds the pair <code dir=\"auto\">(\"A\", myData)</code>, where <code dir=\"auto\">myData</code> is a\n<code dir=\"auto\">ChartData</code> instance with initial field values of <code dir=\"auto\">na</code>. It adds the pair\n<code dir=\"auto\">(\"B\", myData)</code> to <code dir=\"auto\">myMap</code> and updates the object from this pair on\nevery bar via the user-defined <code dir=\"auto\">update()</code> method.</p>\n<p>Each change to the object with the \u201cB\u201d key affects the one referenced\nby the \u201cA\u201d key, as shown by the candle plot of the \u201cA\u201d object\u2019s\nfields:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"506\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Putting-and-getting-key-value-pairs-2.wNHX2-4R_Z21EdVP.webp\" width=\"1332\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Putting and getting objects demo\")\n\n//@type A custom type to hold OHLC data.\ntype ChartData\n    float o\n    float h\n    float l\n    float c\n\n//@function Updates the fields of a `ChartData` object.\nmethod update(ChartData this) =&gt;\n    this.o := open\n    this.h := high\n    this.l := low\n    this.c := close\n\n//@variable A new `ChartData` instance declared on the first bar.\nvar myData = ChartData.new()\n//@variable A map associating `string` keys with `ChartData` instances.\nvar myMap = map.new&lt;string, ChartData&gt;()\n\n// Put a new pair with the \"A\" key into `myMap` only on the first bar.\nif bar_index == 0\n    myMap.put(\"A\", myData)\n\n// Put a pair with the \"B\" key into `myMap` on every bar.\nmyMap.put(\"B\", myData)\n\n//@variable The `ChartData` value associated with the \"A\" key in `myMap`.\nChartData oldest = myMap.get(\"A\")\n//@variable The `ChartData` value associated with the \"B\" key in `myMap`.\nChartData newest = myMap.get(\"B\")\n\n// Update `newest`. Also affects `oldest` and `myData` since they all reference the same `ChartData` object.\nnewest.update()\n\n// Plot the fields of `oldest` as candles.\nplotcandle(oldest.o, oldest.h, oldest.l, oldest.c)</div>\n<p>Note that:</p>\n<ul>\n<li>This script would behave differently if it passed a copy of\n<code dir=\"auto\">myData</code> into each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">myMap.put()</a>\ncall. For more information, see\n<a href=\"/pine-script-docs/v5/language/objects/#copying-objects\">this</a> section of our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/language/objects/\">objects</a>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"inspecting-keys-and-values\"><a href=\"#inspecting-keys-and-values\">Inspecting keys and values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"mapkeys-and-mapvalues\"><a href=\"#mapkeys-and-mapvalues\"><span>\u200b<code dir=\"auto\">map.keys()</code>\u200b and \u200b<code dir=\"auto\">map.values()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>To retrieve all keys and values put into a map, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">map.values()</a>.\nThese functions copy all key/value references within a map <code dir=\"auto\">id</code> to a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nobject. Modifying the array returned from either of these functions does\nnot affect the <code dir=\"auto\">id</code> map.</p>\n<p>Although maps are <em>unordered</em> collections, Pine Script internally\nmaintains the <em>insertion order</em> of a map\u2019s key-value pairs. As a\nresult, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">map.values()</a>\nfunctions always return <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> with their elements ordered based on the <code dir=\"auto\">id</code> map\u2019s\ninsertion order.</p>\n<p>The script below demonstrates this by displaying the key and value\narrays from an <code dir=\"auto\">m</code> map in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nonce every 50 bars. As we see on the chart, the order of elements in\neach array returned by <code dir=\"auto\">m.keys()</code> and <code dir=\"auto\">m.values()</code> aligns with the\ninsertion order of the key-value pairs in <code dir=\"auto\">m</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Inspecting-keys-and-values-1.BtySOORc_ZqH8ET.webp\" width=\"1078\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Keys and values demo\")\n\nif bar_index % 50 == 0\n    //@variable A map containing pairs of `string` keys and `float` values.\n    m = map.new&lt;string, float&gt;()\n\n    // Put pairs into `m`. The map will maintain this insertion order.\n    m.put(\"First\", math.round(math.random(0, 100)))\n    m.put(\"Second\", m.get(\"First\") + 1)\n    m.put(\"Third\", m.get(\"Second\") + 1)\n\n    //@variable An array containing the keys of `m` in their insertion order.\n    array&lt;string&gt; keys = m.keys()\n    //@variable An array containing the values of `m` in their insertion order.\n    array&lt;float&gt; values = m.values()\n\n    //@variable A label displaying the `size` of `m` and the `keys` and `values` arrays.\n    label debugLabel = label.new(\n         bar_index, 0,\n         str.format(\"Pairs: {0}\\nKeys: {1}\\nValues: {2}\", m.size(), keys, values),\n         color = color.navy, style = label.style_label_center, \n         textcolor = color.white, size = size.huge\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>The value with the \u201cFirst\u201d key is a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a>\nwhole number between 0 and 100. The \u201cSecond\u201d value is one\ngreater than the \u201cFirst\u201d, and the \u201cThird\u201d value is one\ngreater than the \u201cSecond\u201d.</li>\n</ul>\n<p>It\u2019s important to note a map\u2019s internal insertion order <strong>does not</strong>\nchange when replacing its key-value pairs. The locations of the new\nelements in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">keys()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">values()</a>\narrays will be the same as the old elements in such cases. The only\nexception is if the script completely\n<a href=\"/pine-script-docs/v5/language/maps/#removing-key-value-pairs\">removes</a> the key beforehand.</p>\n<p>Below, we\u2019ve added a line of code to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">put</a>\na new value with the \u201cSecond\u201d key into the <code dir=\"auto\">m</code> map, overwriting the\nprevious value associated with that key. Although the script puts this\nnew pair into the map <em>after</em> the one with the \u201cThird\u201d key, the\npair\u2019s key and value are still second in the <code dir=\"auto\">keys</code> and <code dir=\"auto\">values</code> arrays\nsince the key was already present in <code dir=\"auto\">m</code> <em>before</em> the change:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Inspecting-keys-and-values-2.CRhK5y_B_Z25ivPS.webp\" width=\"1078\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Keys and values demo\")\n\nif bar_index % 50 == 0\n    //@variable A map containing pairs of `string` keys and `float` values.\n    m = map.new&lt;string, float&gt;()\n\n    // Put pairs into `m`. The map will maintain this insertion order.\n    m.put(\"First\", math.round(math.random(0, 100)))\n    m.put(\"Second\", m.get(\"First\") + 1)\n    m.put(\"Third\", m.get(\"Second\") + 1)\n\n    // Overwrite the \"Second\" pair in `m`. This will NOT affect the insertion order.\n    // The key and value will still appear second in the `keys` and `values` arrays.\n    m.put(\"Second\", -2)\n\n    //@variable An array containing the keys of `m` in their insertion order.\n    array&lt;string&gt; keys = m.keys()\n    //@variable An array containing the values of `m` in their insertion order.\n    array&lt;float&gt; values = m.values()\n\n    //@variable A label displaying the `size` of `m` and the `keys` and `values` arrays.\n    label debugLabel = label.new(\n         bar_index, 0,\n         str.format(\"Pairs: {0}\\nKeys: {1}\\nValues: {2}\", m.size(), keys, values),\n         color = color.navy, style = label.style_label_center, \n         textcolor = color.white, size = size.huge\n     )</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The elements in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">map.values()</a>\narray point to the same values as the map <code dir=\"auto\">id</code>. Consequently, when the\nmap\u2019s values are of <em>reference types</em>, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>,\nor <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>, modifying the instances referenced by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">map.values()</a>\narray will also affect those referenced by the map <code dir=\"auto\">id</code> since the\ncontents of both collections point to identical objects.</p></div></aside>\n<h4 class=\"md-heading\" id=\"mapcontains\"><a href=\"#mapcontains\"><span>\u200b<code dir=\"auto\">map.contains()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>To check if a specific <code dir=\"auto\">key</code> exists within a map <code dir=\"auto\">id</code>, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.contains\">map.contains()</a>.\nThis function is a convenient alternative to calling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.includes\">array.includes()</a>\non the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nreturned from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">map.keys()</a>.</p>\n<p>For example, this script checks if various keys exist within an <code dir=\"auto\">m</code> map,\nthen displays the results in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"272\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Inspecting-keys-and-values-3.BFc856qo_2slIVc.webp\" width=\"864\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inspecting keys demo\")\n\n//@variable A map containing `string` keys and `string` values.\nm = map.new&lt;string, string&gt;()\n\n// Put key-value pairs into the map.\nm.put(\"A\", \"B\")\nm.put(\"C\", \"D\")\nm.put(\"E\", \"F\")\n\n//@variable An array of keys to check for in `m`.\narray&lt;string&gt; testKeys = array.from(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\")\n\n//@variable An array containing all elements from `testKeys` found in the keys of `m`.\narray&lt;string&gt; mappedKeys = array.new&lt;string&gt;()\n\nfor key in testKeys\n    // Add the `key` to `mappedKeys` if `m` contains it.\n    if m.contains(key)\n        mappedKeys.push(key)\n\n//@variable A string representing the `testKeys` array and the elements found within the keys of `m`.\nstring testText = str.format(\"Tested keys: {0}\\nKeys found: {1}\", testKeys, mappedKeys)\n\nif bar_index == last_bar_index - 1\n    //@variable Displays the `testText` in a label at the `bar_index` before the last.\n    label debugLabel = label.new(\n         bar_index, 0, testText, style = label.style_label_center, \n         textcolor = color.white, size = size.huge\n     )</div>\n<h3 class=\"md-heading\" id=\"removing-key-value-pairs\"><a href=\"#removing-key-value-pairs\">Removing key-value pairs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To remove a specific key-value pair from a map <code dir=\"auto\">id</code>, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.remove\">map.remove()</a>.\nThis function removes the <code dir=\"auto\">key</code> and its associated value from the map\nwhile preserving the insertion order of other key-value pairs. It\nreturns the removed value if the map\n<a href=\"/pine-script-docs/v5/language/maps/#mapcontains\">contained</a> the <code dir=\"auto\">key</code>. Otherwise, it returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>To remove all key-value pairs from a map <code dir=\"auto\">id</code> at once, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.clear\">map.clear()</a>.</p>\n<p>The following script creates a new <code dir=\"auto\">m</code> map,\n<a href=\"/pine-script-docs/v5/language/maps/#putting-and-getting-key-value-pairs\">puts</a> key-value pairs into the map, uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.remove\">m.remove()</a>\nwithin a loop to remove each valid <code dir=\"auto\">key</code> listed in the <code dir=\"auto\">removeKeys</code>\narray, then calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.clear\">m.clear()</a>\nto remove all remaining key-value pairs. It uses a custom <code dir=\"auto\">debugLabel()</code>\nmethod to display the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.size\">size</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">keys</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">values</a>\nof <code dir=\"auto\">m</code> after each change:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"324\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Removing-key-value-pairs-1.vUrgRJdK_Z11m7iy.webp\" width=\"1134\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Removing key-value pairs demo\")\n\n//@function Returns a label to display the keys and values from a map.\nmethod debugLabel(\n     map&lt;string, int&gt; this, int barIndex = bar_index,\n     color bgColor = color.blue, string note = \"\"\n ) =&gt;\n    //@variable A string representing the size, keys, and values in `this` map.\n    string repr = str.format(\n         \"{0}\\nSize: {1}\\nKeys: {2}\\nValues: {3}\",\n         note, this.size(), str.tostring(this.keys()), str.tostring(this.values())\n     )\n    label.new(\n         barIndex, 0, repr, color = bgColor, style = label.style_label_center,\n         textcolor = color.white, size = size.huge\n     )\n\nif bar_index == last_bar_index - 1\n    //@variable A map containing `string` keys and `int` values.\n    m = map.new&lt;string, int&gt;()\n\n    // Put key-value pairs into `m`.\n    for [i, key] in array.from(\"A\", \"B\", \"C\", \"D\", \"E\")\n        m.put(key, i)\n    m.debugLabel(bar_index, color.green, \"Added pairs\")\n\n    //@variable An array of keys to remove from `m`.\n    array&lt;string&gt; removeKeys = array.from(\"B\", \"B\", \"D\", \"F\", \"a\")\n\n    // Remove each `key` in `removeKeys` from `m`.\n    for key in removeKeys\n        m.remove(key)\n    m.debugLabel(bar_index + 10, color.red, \"Removed pairs\")\n\n    // Remove all remaining keys from `m`.\n    m.clear()\n    m.debugLabel(bar_index + 20, color.purple, \"Cleared the map\")</div>\n<p>Note that:</p>\n<ul>\n<li>Not all strings in the <code dir=\"auto\">removeKeys</code> array were present in the\nkeys of <code dir=\"auto\">m</code>. Attempting to remove non-existent keys (\u201cF\u201d,\n\u201ca\u201d, and the second \u201cB\u201d in this example) has no effect on a\nmap\u2019s contents.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"combining-maps\"><a href=\"#combining-maps\">Combining maps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can combine two maps via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put_all\">map.put_all()</a>.\nThis function puts <em>all</em> key-value pairs from the <code dir=\"auto\">id2</code> map, in their\ninsertion order, into the <code dir=\"auto\">id1</code> map. As with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>,\nif any keys in <code dir=\"auto\">id2</code> are also present in <code dir=\"auto\">id1</code>, this function\n<strong>replaces</strong> the key-value pairs that contain those keys without\naffecting their initial insertion order.</p>\n<p>This example contains a user-defined <code dir=\"auto\">hexMap()</code> function that maps\ndecimal\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nkeys to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nrepresentations of their\n<a href=\"https://en.wikipedia.org//wiki/Hexadecimal\" rel=\"nofollow\">hexadecimal</a> forms. The\nscript uses this function to create two maps, <code dir=\"auto\">mapA</code> and <code dir=\"auto\">mapB</code>, then\nuses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put_all\">mapA.put_all(mapB)</a>\nto put all key-value pairs from <code dir=\"auto\">mapB</code> into <code dir=\"auto\">mapA</code>.</p>\n<p>The script uses a custom <code dir=\"auto\">debugLabel()</code> function to display labels\nshowing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">keys</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">values</a>\nof <code dir=\"auto\">mapA</code> and <code dir=\"auto\">mapB</code>, then another label displaying the contents of\n<code dir=\"auto\">mapA</code> after putting all key-value pairs from <code dir=\"auto\">mapB</code> into it:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"364\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Reading-and-writing-Combining-maps-1.pxWmo3rc_Z1eFido.webp\" width=\"1230\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Combining maps demo\", \"Hex map\")\n\n//@variable An array of string hex digits.\nvar array&lt;string&gt; hexDigits = str.split(\"0123456789ABCDEF\", \"\")\n\n//@function Returns a hexadecimal string for the specified `value`.\nhex(int value) =&gt;\n    //@variable A string representing the hex form of the `value`.\n    string result = \"\"\n    //@variable A temporary value for digit calculation.\n    int tempValue = value  \n    while tempValue &gt; 0\n        //@variable The next integer digit.\n        int digit = tempValue % 16\n        // Add the hex form of the `digit` to the `result`.\n        result := hexDigits.get(digit) + result\n        // Divide the `tempValue` by the base.\n        tempValue := int(tempValue / 16)\n    result\n\n//@function Returns a map holding the `numbers` as keys and their `hex` strings as values.  \nhexMap(array&lt;int&gt; numbers) =&gt;\n    //@variable A map associating `int` keys with `string` values.\n    result = map.new&lt;int, string&gt;()\n    for number in numbers\n        // Put a pair containing the `number` and its `hex()` representation into the `result`.\n        result.put(number, hex(number))\n    result\n\n//@function Returns a label to display the keys and values of a hex map.\ndebugLabel(\n     map&lt;int, string&gt; this, int barIndex = bar_index, color bgColor = color.blue, \n     string style = label.style_label_center, string note = \"\"\n ) =&gt;\n    string repr = str.format(\n         \"{0}\\nDecimal: {1}\\nHex: {2}\", \n         note, str.tostring(this.keys()), str.tostring(this.values())\n     )\n    label.new(\n         barIndex, 0, repr, color = bgColor, style = style,\n         textcolor = color.white, size = size.huge\n     )\n\nif bar_index == last_bar_index - 1\n    //@variable A map with decimal `int` keys and hexadecimal `string` values.\n    map&lt;int, string&gt; mapA = hexMap(array.from(101, 202, 303, 404))\n    debugLabel(mapA, bar_index, color.navy, label.style_label_down, \"A\")\n\n    //@variable A map containing key-value pairs to add to `mapA`.\n    map&lt;int, string&gt; mapB = hexMap(array.from(303, 404, 505, 606, 707, 808))\n    debugLabel(mapB, bar_index, color.maroon, label.style_label_up, \"B\")\n\n    // Put all pairs from `mapB` into `mapA`.\n    mapA.put_all(mapB)\n    debugLabel(mapA, bar_index + 10, color.purple, note = \"Merge B into A\")</div>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"looping-through-a-map\"><a href=\"#looping-through-a-map\">Looping through a map<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are several ways scripts can iteratively access the keys and\nvalues in a map. For example, one could loop through a map\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.keys\">keys()</a>\narray and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.get\">get()</a>\nthe value for each <code dir=\"auto\">key</code>, like so:</p>\n<div class=\"pine-colorizer not-content\">for key in thisMap.keys()\n    value = thisMap.get(key)</div>\n<p>However, we recommend using a <code dir=\"auto\">for...in</code> loop directly on a map, as it\niterates over the map\u2019s key-value pairs in their insertion order,\nreturning a tuple containing the next pair\u2019s key and value on each\niteration.</p>\n<p>For example, this line of code loops through each <code dir=\"auto\">key</code> and <code dir=\"auto\">value</code> in\n<code dir=\"auto\">thisMap</code>, starting from the first key-value pair put into it:</p>\n<div class=\"pine-colorizer not-content\">for [key, value] in thisMap</div>\n<p>Let\u2019s use this structure to write a script that displays a map\u2019s\nkey-value pairs in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>.\nIn the example below, we\u2019ve defined a custom <code dir=\"auto\">toTable()</code> method that\ncreates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nthen uses a <code dir=\"auto\">for...in</code> loop to iterate over the map\u2019s key-value pairs\nand populate the table\u2019s cells. The script uses this method to\nvisualize a map containing <code dir=\"auto\">length</code>-bar <code dir=\"auto\">averages</code> of price and volume\ndata:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"620\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Looping-through-a-map-1.CTALDkOv_261pAn.webp\" width=\"1264\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Looping through a map demo\", \"Table of averages\")\n\n//@variable The length of the moving average.\nint length = input.int(20, \"Length\")\n//@variable The size of the table text.\nstring txtSize = input.string(\n     size.huge, \"Text size\",\n     options = [size.auto, size.tiny, size.small, size.normal, size.large, size.huge]\n )\n\n//@function Displays the pairs of `this` map within a table.\n//@param    this A map with `string` keys and `float` values.\n//@param    position The position of the table on the chart.\n//@param    header The string to display on the top row of the table.\n//@param    textSize The size of the text in the table.\n//@returns  A new `table` object with cells displaying each pair in `this`.\nmethod toTable(\n     map&lt;string, float&gt; this, string position = position.middle_center, string header = na,\n     string textSize = size.huge\n ) =&gt;\n    // Color variables\n    borderColor = #000000\n    headerColor = color.rgb(1, 88, 80)\n    pairColor   = color.maroon\n    textColor   = color.white\n\n    //@variable A table that displays the key-value pairs of `this` map.\n    table result = table.new(\n         position, this.size() + 1, 3, border_width = 2, border_color = borderColor\n     )\n    // Initialize top and side header cells.\n    result.cell(1, 0, header, bgcolor = headerColor, text_color = textColor, text_size = textSize)\n    result.merge_cells(1, 0, this.size(), 0)\n    result.cell(0, 1, \"Key\", bgcolor = headerColor, text_color = textColor, text_size = textSize)\n    result.cell(0, 2, \"Value\", bgcolor = headerColor, text_color = textColor, text_size = textSize)\n\n    //@variable The column index of the table. Updates on each loop iteration.\n    int col = 1\n\n    // Loop over each `key` and `value` from `this` map in the insertion order.\n    for [key, value] in this\n        // Initialize a `key` cell in the `result` table on row 1.\n        result.cell(\n             col, 1, str.tostring(key), bgcolor = color.maroon,\n             text_color = color.white, text_size = textSize\n         )\n        // Initialize a `value` cell in the `result` table on row 2.\n        result.cell(\n             col, 2, str.tostring(value), bgcolor = color.maroon,\n             text_color = color.white, text_size = textSize\n         )\n        // Move to the next column index.\n        col += 1\n    result // Return the `result` table.\n\n//@variable A map with `string` keys and `float` values to hold `length`-bar averages.\naverages = map.new&lt;string, float&gt;()\n\n// Put key-value pairs into the `averages` map.\naverages.put(\"Open\", ta.sma(open, length))\naverages.put(\"High\", ta.sma(high, length))\naverages.put(\"Low\", ta.sma(low, length))\naverages.put(\"Close\", ta.sma(close, length))\naverages.put(\"Volume\", ta.sma(volume, length))\n\n//@variable The text to display at the top of the table.\nstring headerText = str.format(\"{0} {1}-bar averages\", \"'\" + syminfo.tickerid + \"'\", length)\n// Display the `averages` map in a `table` with the `headerText`.\naverages.toTable(header = headerText, textSize = txtSize)</div>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"copying-a-map\"><a href=\"#copying-a-map\">Copying a map<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"shallow-copies\"><a href=\"#shallow-copies\">Shallow copies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can make a <em>shallow copy</em> of a map <code dir=\"auto\">id</code> using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.copy\">map.copy()</a>\nfunction. Modifications to a shallow copy do not affect the original\n<code dir=\"auto\">id</code> map or its internal insertion order.</p>\n<p>For example, this script constructs an <code dir=\"auto\">m</code> map with the keys \u201cA\u201d,\n\u201cB\u201d, \u201cC\u201d, and \u201cD\u201d assigned to four\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a>\nvalues between 0 and 10. It then creates an <code dir=\"auto\">mCopy</code> map as a shallow\ncopy of <code dir=\"auto\">m</code> and updates the values associated with its keys. The script\ndisplays the key-value pairs in <code dir=\"auto\">m</code> and <code dir=\"auto\">mCopy</code> on the chart using our\ncustom <code dir=\"auto\">debugLabel()</code> method:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"320\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Copying-a-map-Shallow-copies-1.e7-GYyqa_2eTTgn.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shallow copy demo\")\n\n//@function Displays the key-value pairs of `this` map in a label. \nmethod debugLabel(\n     map&lt;string, float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    //@variable The text to display in the label.\n    labelText = note + \"\\n{\"\n    for [key, value] in this\n        labelText += str.format(\"{0}: {1}, \", key, value)\n    labelText := str.replace(labelText, \", \", \"}\", this.size() - 1)\n\n    if barstate.ishistory\n        label result = label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center, \n             textcolor = textColor, size = size.huge\n         )\n\nif bar_index == last_bar_index - 1\n    //@variable A map of `string` keys and random `float` values.\n    m = map.new&lt;string, float&gt;()\n\n    // Assign random values to an array of keys in `m`.\n    for key in array.from(\"A\", \"B\", \"C\", \"D\")\n        m.put(key, math.random(0, 10))\n\n    //@variable A shallow copy of `m`.\n    mCopy = m.copy()\n\n    // Assign the insertion order value `i` to each `key` in `mCopy`.\n    for [i, key] in mCopy.keys()\n        mCopy.put(key, i)\n\n    // Display the labels.\n    m.debugLabel(bar_index, note = \"Original\")\n    mCopy.debugLabel(bar_index + 10, color.purple, note = \"Copied and changed\")</div>\n<h3 class=\"md-heading\" id=\"deep-copies\"><a href=\"#deep-copies\">Deep copies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>While a <a href=\"/pine-script-docs/v5/language/maps/#shallow-copies\">shallow copy</a> will suffice when copying maps that have values of a\n<a href=\"/pine-script-docs/v5/language/type-system/#types\">fundamental type</a> or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>, it\u2019s crucial to understand that shallow copies of a map holding values of a <em>special type</em>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nor a <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>) point to the same objects as the original. Modifying the\nobjects referenced by a shallow copy will affect the instances\nreferenced by the original map and vice versa.</p>\n<p>To ensure changes to objects referenced by a copied map do not affect\ninstances referenced in other locations, one can make a <em>deep copy</em> by\ncreating a new map with key-value pairs containing copies of each value\nin the original map.</p>\n<p>This example creates an <code dir=\"auto\">original</code> map of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nvalues and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">puts</a>\na key-value pair into it. The script copies the map to a <code dir=\"auto\">shallow</code>\nvariable via the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.copy\">copy()</a>\nmethod, then to a <code dir=\"auto\">deep</code> variable using a custom <code dir=\"auto\">deepCopy()</code> method.</p>\n<p>As we see from the chart, changes to the label retrieved from the\n<code dir=\"auto\">shallow</code> copy also affect the instance referenced by the <code dir=\"auto\">original</code>\nmap, but changes to the one from the <code dir=\"auto\">deep</code> copy do not:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"264\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Copying-a-map-Deep-copies-1.DxdX2Bvp_23djFR.webp\" width=\"870\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Deep copy demo\")\n\n//@function Returns a deep copy of `this` map.\nmethod deepCopy(map&lt;string, label&gt; this) =&gt;\n    //@variable A deep copy of `this` map.\n    result = map.new&lt;string, label&gt;()\n    // Add key-value pairs with copies of each `value` to the `result`.\n    for [key, value] in this\n        result.put(key, value.copy())\n    result //Return the `result`.\n\n//@variable A map containing `string` keys and `label` values.\nvar original = map.new&lt;string, label&gt;()\n\nif bar_index == last_bar_index - 1\n    // Put a new key-value pair into the `original` map.\n    map.put(\n         original, \"Test\",\n         label.new(bar_index, 0, \"Original\", textcolor = color.white, size = size.huge)\n     )\n\n    //@variable A shallow copy of the `original` map.\n    map&lt;string, label&gt; shallow = original.copy()\n    //@variable A deep copy of the `original` map.\n    map&lt;string, label&gt; deep = original.deepCopy()\n\n    //@variable The \"Test\" label from the `shallow` copy.\n    label shallowLabel = shallow.get(\"Test\")\n    //@variable The \"Test\" label from the `deep` copy.\n    label deepLabel = deep.get(\"Test\")\n\n    // Modify the \"Test\" label's `y` attribute in the `original` map.\n    // This also affects the `shallowLabel`.\n    original.get(\"Test\").set_y(label.all.size())\n\n    // Modify the `shallowLabel`. Also modifies the \"Test\" label in the `original` map.\n    shallowLabel.set_text(\"Shallow copy\")\n    shallowLabel.set_color(color.red)\n    shallowLabel.set_style(label.style_label_up)\n\n    // Modify the `deepLabel`. Does not modify any other label instance.\n    deepLabel.set_text(\"Deep copy\")\n    deepLabel.set_color(color.navy)\n    deepLabel.set_style(label.style_label_left)\n    deepLabel.set_x(bar_index + 5)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">deepCopy()</code> method loops through the <code dir=\"auto\">original</code> map,\ncopying each <code dir=\"auto\">value</code> and\n<a href=\"/pine-script-docs/v5/language/maps/#putting-and-getting-key-value-pairs\">putting</a> key-value pairs containing the copies into a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.new%3Ctype,type%3E\">new</a>\nmap instance.</li>\n</ul>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"scope-and-history\"><a href=\"#scope-and-history\">Scope and history<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>As with other collections in Pine, map variables leave historical trails\non each bar, allowing a script to access past map instances assigned to\na variable using the history-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>.\nScripts can also assign maps to global variables and interact with them\nfrom the scopes of\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a>,\n<a href=\"/pine-script-docs/v5/language/methods/\">methods</a>, and\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>.</p>\n<p>As an example, this script uses a global map and its history to\ncalculate an aggregate set of\n<a href=\"https://www.tradingview.com/support/solutions/43000592270/\">EMAs</a>. It\ndeclares a <code dir=\"auto\">globalData</code> map of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues, where each key in the map corresponds to the length of each EMA\ncalculation. The user-defined <code dir=\"auto\">update()</code> function calculates each\n<code dir=\"auto\">key</code>-length EMA by mixing the values from the <code dir=\"auto\">previous</code> map assigned\nto <code dir=\"auto\">globalData</code> with the current <code dir=\"auto\">source</code> value.</p>\n<p>The script plots the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.max\">maximum</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">minimum</a>\nvalues in the global map\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.values\">values()</a>\narray and the value from <code dir=\"auto\">globalData.get(50)</code> (i.e., the 50-bar EMA):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"500\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Scope-and-history-1.D57XNJl__ZkKAgd.webp\" width=\"1316\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scope and history demo\", overlay = true)\n\n//@variable The source value for EMA calculation.\nfloat source = input.source(close, \"Source\")\n\n//@variable A map containing global key-value pairs.\nglobalData = map.new&lt;int, float&gt;()\n\n//@function Calculates a set of EMAs and updates the key-value pairs in `globalData`.\nupdate() =&gt;\n    //@variable The previous map instance assigned to `globalData`.\n    map&lt;int, float&gt; previous = globalData[1]\n\n    // Put key-value pairs with keys 10-200 into `globalData` if `previous` is `na`.\n    if na(previous)\n        for i = 10 to 200\n            globalData.put(i, source)\n    else\n        // Iterate each `key` and `value` in the `previous` map.\n        for [key, value] in previous\n            //@variable The smoothing parameter for the `key`-length EMA.\n            float alpha = 2.0 / (key + 1.0)\n            //@variable The `key`-length EMA value.\n            float ema = (1.0 - alpha) * value + alpha * source\n            // Put the `key`-length `ema` into the `globalData` map.\n            globalData.put(key, ema)\n\n// Update the `globalData` map.\nupdate()\n\n//@variable The array of values from `globalData` in their insertion order.\narray&lt;float&gt; values = globalData.values()\n\n// Plot the max EMA, min EMA, and 50-bar EMA values.\nplot(values.max(), \"Max EMA\", color.green, 2)\nplot(values.min(), \"Min EMA\", color.red, 2)\nplot(globalData.get(50), \"50-bar EMA\", color.orange, 3)</div>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/maps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"maps-of-other-collections\"><a href=\"#maps-of-other-collections\">Maps of other collections<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Maps cannot directly use other maps,\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, or\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> as values, but\nthey can hold values of a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> that contains collections within its fields.</p>\n<p>For example, suppose we want to create a \u201c2D\u201d map that uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys to access <em>nested maps</em> that hold pairs of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues. Since maps cannot use other collections as values, we will first\ncreate a <em>wrapper type</em> with a field to hold a <code dir=\"auto\">map&lt;string, float&gt;</code>\ninstance, like so:</p>\n<div class=\"pine-colorizer not-content\">//@type A wrapper type for maps with `string` keys and `float` values.\ntype Wrapper\n    map&lt;string, float&gt; data</div>\n<p>With our <code dir=\"auto\">Wrapper</code> type defined, we can create maps of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nkeys and <code dir=\"auto\">Wrapper</code> values, where the <code dir=\"auto\">data</code> field of each value in the\nmap points to a <code dir=\"auto\">map&lt;string, float&gt;</code> instance:</p>\n<div class=\"pine-colorizer not-content\">mapOfMaps = map.new&lt;string, Wrapper&gt;()</div>\n<p>The script below uses this concept to construct a map containing maps\nthat hold OHLCV data requested from multiple tickers. The user-defined\n<code dir=\"auto\">requestData()</code> function requests price and volume data from a ticker,\ncreates a <code dir=\"auto\">&lt;string, float&gt;</code> map,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">puts</a>\nthe data into it, then returns a <code dir=\"auto\">Wrapper</code> instance containing the new\nmap.</p>\n<p>The script\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">puts</a>\nthe results from each call to <code dir=\"auto\">requestData()</code> into the <code dir=\"auto\">mapOfMaps</code>, then\ncreates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nrepresentation of the nested maps with a user-defined <code dir=\"auto\">toString()</code>\nmethod, which it displays on the chart in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"362\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Maps-Maps-of-other-collections-1.DtwJ2MOI_Z172Q8n.webp\" width=\"1268\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Nested map demo\")\n\n//@variable The timeframe of the requested data.\nstring tf = input.timeframe(\"D\", \"Timeframe\")\n// Symbol inputs.\nstring symbol1 = input.symbol(\"EURUSD\", \"Symbol 1\")\nstring symbol2 = input.symbol(\"GBPUSD\", \"Symbol 2\")\nstring symbol3 = input.symbol(\"EURGBP\", \"Symbol 3\")\n\n//@type A wrapper type for maps with `string` keys and `float` values.\ntype Wrapper\n    map&lt;string, float&gt; data\n\n//@function Returns a wrapped map containing OHLCV data from the `tickerID` at the `timeframe`.\nrequestData(string tickerID, string timeframe) =&gt;\n    // Request a tuple of OHLCV values from the specified ticker and timeframe.\n    [o, h, l, c, v] = request.security(\n         tickerID, timeframe,\n         [open, high, low, close, volume]\n     )\n    //@variable A map containing requested OHLCV data.\n    result = map.new&lt;string, float&gt;()\n    // Put key-value pairs into the `result`.\n    result.put(\"Open\", o)\n    result.put(\"High\", h)\n    result.put(\"Low\", l)\n    result.put(\"Close\", c)\n    result.put(\"Volume\", v)\n    //Return the wrapped `result`.\n    Wrapper.new(result)\n\n//@function Returns a string representing `this` map of `string` keys and `Wrapper` values.\nmethod toString(map&lt;string, Wrapper&gt; this) =&gt;\n    //@variable A string representation of `this` map.\n    string result = \"{\"\n\n    // Iterate over each `key1` and associated `wrapper` in `this`.\n    for [key1, wrapper] in this\n        // Add `key1` to the `result`.\n        result += key1\n\n        //@variable A string representation of the `wrapper.data` map.\n        string innerStr = \": {\"\n        // Iterate over each `key2` and associated `value` in the wrapped map.\n        for [key2, value] in wrapper.data\n            // Add the key-value pair's representation to `innerStr`.\n            innerStr += str.format(\"{0}: {1}, \", key2, str.tostring(value))\n\n        // Replace the end of `innerStr` with \"}\" and add to `result`.\n        result += str.replace(innerStr, \", \", \"},\\n\", wrapper.data.size() - 1)\n\n    // Replace the blank line at the end of `result` with \"}\".\n    result := str.replace(result, \",\\n\", \"}\", this.size() - 1)\n    result\n\n//@variable A map of wrapped maps containing OHLCV data from multiple tickers.\nvar mapOfMaps = map.new&lt;string, Wrapper&gt;()\n\n//@variable A label showing the contents of the `mapOfMaps`.\nvar debugLabel = label.new(\n     bar_index, 0, color = color.navy, textcolor = color.white, size = size.huge,\n     style = label.style_label_center, text_font_family = font.family_monospace\n )\n\n// Put wrapped maps into `mapOfMaps`.\nmapOfMaps.put(symbol1, requestData(symbol1, tf))\nmapOfMaps.put(symbol2, requestData(symbol2, tf))\nmapOfMaps.put(symbol3, requestData(symbol3, tf))\n\n// Update the label.\ndebugLabel.set_text(mapOfMaps.toString())\ndebugLabel.set_x(bar_index)</div>", "segment_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "ceacd058f1cdf7297df0c84861269e5f936dedf4c38c23f16090c568211aadfb", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/matrices\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"matrices\"><a href=\"#matrices\">Matrices<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script Matrices are <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> that store value references in a\nrectangular format. They are the equivalent of two-dimensional <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a> objects with functions and methods for inspection, modification, and specialized calculations. As with <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, all matrix elements must be of the same <a href=\"/pine-script-docs/v5/language/type-system/#types\">type</a>, <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a>, or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum type</a>.</p>\n<p>Matrices reference their elements using <em>two</em> indices: one index for their\n<em>rows</em> and the other for their <em>columns</em>. Each index starts at 0 and extends\nto the number of rows/columns in the matrix minus one. Matrices in Pine\ncan have dynamic numbers of rows and columns that vary across bars. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.elements_count\">total number of\nelements</a>\nwithin a matrix is the <em>product</em> of the number of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">rows</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.columns\">columns</a>\n(e.g., a 5x5 matrix has a total of 25). Like\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, the total number of\nelements in a matrix cannot exceed 100,000.</p>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaring-a-matrix\"><a href=\"#declaring-a-matrix\">Declaring a matrix<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script uses the following syntax for matrix declaration:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[var/varip ][matrix&lt;type&gt; ]&lt;identifier&gt; = &lt;expression&gt;</span></div></div></code></pre></figure></link></div>\n<p>Where <code dir=\"auto\">&lt;type&gt;</code> is a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> for the matrix that declares the type of values it will\ncontain, and the <code dir=\"auto\">&lt;expression&gt;</code> returns either a matrix instance of the\ntype or <code dir=\"auto\">na</code>.</p>\n<p>When declaring a matrix variable as <code dir=\"auto\">na</code>, users must specify that the\nidentifier will reference matrices of a specific type by including the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>\nkeyword followed by a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a>.</p>\n<p>This line declares a new <code dir=\"auto\">myMatrix</code> variable with a value of <code dir=\"auto\">na</code>. It\nexplicitly declares the variable as <code dir=\"auto\">matrix&lt;float&gt;</code>, which tells the\ncompiler that the variable can only accept\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>\nobjects containing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nvalues:</p>\n<div class=\"pine-colorizer not-content\">matrix&lt;float&gt; myMatrix = na</div>\n<p>When a matrix variable is not assigned to <code dir=\"auto\">na</code>, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>\nkeyword and its type template are optional, as the compiler will use the\ntype information from the object the variable references.</p>\n<p>Here, we declare a <code dir=\"auto\">myMatrix</code> variable referencing a new <code dir=\"auto\">matrix&lt;float&gt;</code>\ninstance with two rows, two columns, and an <code dir=\"auto\">initial_value</code> of 0. The\nvariable gets its type information from the new object in this case, so\nit doesn\u2019t require an explicit type declaration:</p>\n<div class=\"pine-colorizer not-content\">myMatrix = matrix.new&lt;float&gt;(2, 2, 0.0)</div>\n<h3 class=\"md-heading\" id=\"using-var-and-varip-keywords\"><a href=\"#using-var-and-varip-keywords\"><span>Using \u200b<code dir=\"auto\">var</code>\u200b and \u200b<code dir=\"auto\">varip</code>\u200b keywords</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>As with other variables, users can include the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeywords to instruct a script to declare a matrix variable only once\nrather than on every bar. A matrix variable declared with this keyword\nwill point to the same instance throughout the span of the chart unless\nthe script explicitly assigns another matrix to it, allowing a matrix\nand its element references to persist between script iterations.</p>\n<p>This script declares an <code dir=\"auto\">m</code> variable assigned to a matrix that holds a\nsingle row of two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nelements using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword. On every 20th bar, the script adds 1 to the first element on\nthe first row of the <code dir=\"auto\">m</code> matrix. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall displays this element on the chart. As we see from the plot, the\nvalue of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">m.get(0,\n0)</a>\npersists between bars, never returning to the initial value of 0:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"372\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Declaring-a-matrix-Using-var-and-varip-keywords-1.DaUqe-zB_10ShDW.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"var matrix demo\")\n\n//@variable A 1x2 rectangular matrix declared only at `bar_index == 0`, i.e., the first bar.\nvar m = matrix.new&lt;int&gt;(1, 2, 0)\n\n//@variable Is `true` on every 20th bar.\nbool update = bar_index % 20 == 0\n\nif update\n    int currentValue = m.get(0, 0) // Get the current value of the first row and column.\n    m.set(0, 0, currentValue + 1)  // Set the first row and column element value to `currentValue + 1`.\n\nplot(m.get(0, 0), linewidth = 3) // Plot the value from the first row and column.</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Matrix variables declared using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nbehave as ones using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> on\nhistorical data, but they update their values for realtime bars (i.e.,\nthe bars since the script\u2019s last compilation) on each new price tick.\nMatrices assigned to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nvariables can only hold\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_bool\">bool</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_color\">color</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\ntypes or\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a> that exclusively contain within their fields these types or\ncollections (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>,\nmatrices, or <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) of these\ntypes.</p></div></aside>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"reading-and-writing-matrix-elements\"><a href=\"#reading-and-writing-matrix-elements\">Reading and writing matrix elements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"matrixget-and-matrixset\"><a href=\"#matrixget-and-matrixset\"><span>\u200b<code dir=\"auto\">matrix.get()</code>\u200b and \u200b<code dir=\"auto\">matrix.set()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To retrieve the value from a matrix at a specified <code dir=\"auto\">row</code> and <code dir=\"auto\">column</code>\nindex, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">matrix.get()</a>.\nThis function locates the specified matrix element and returns its\nvalue. Similarly, to overwrite a specific element\u2019s value, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">matrix.set()</a>\nto assign the element at the specified <code dir=\"auto\">row</code> and <code dir=\"auto\">column</code> to a new\n<code dir=\"auto\">value</code>.</p>\n<p>The example below defines a square matrix <code dir=\"auto\">m</code> with two rows and columns\nand an <code dir=\"auto\">initial_value</code> of 0 for all elements on the first bar. The\nscript adds 1 to each element\u2019s value on different bars using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">m.get()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">m.set()</a>\nmethods. It updates the first row\u2019s first value once every 11 bars, the\nfirst row\u2019s second value once every seven bars, the second row\u2019s first\nvalue once every five bars, and the second row\u2019s second value once\nevery three bars. The script plots each element\u2019s value on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"380\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Reading-and-writing-matrix-elements-1.Cpd5xwu1_Z2j5Ymv.webp\" width=\"1340\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reading and writing elements demo\")\n\n//@variable A 2x2 square matrix of `float` values.\nvar m = matrix.new&lt;float&gt;(2, 2, 0.0)\n\nswitch\n    bar_index % 11 == 0 =&gt; m.set(0, 0, m.get(0, 0) + 1.0) // Adds 1 to the value at row 0, column 0 every 11th bar.\n    bar_index % 7  == 0 =&gt; m.set(0, 1, m.get(0, 1) + 1.0) // Adds 1 to the value at row 0, column 1 every 7th bar.\n    bar_index % 5  == 0 =&gt; m.set(1, 0, m.get(1, 0) + 1.0) // Adds 1 to the value at row 1, column 0 every 5th bar.\n    bar_index % 3  == 0 =&gt; m.set(1, 1, m.get(1, 1) + 1.0) // Adds 1 to the value at row 1, column 1 every 3rd bar.\n\nplot(m.get(0, 0), \"Row 0, Column 0 Value\", color.red, 2)\nplot(m.get(0, 1), \"Row 0, Column 1 Value\", color.orange, 2)\nplot(m.get(1, 0), \"Row 1, Column 0 Value\", color.green, 2)\nplot(m.get(1, 1), \"Row 1, Column 1 Value\", color.blue, 2)</div>\n<h3 class=\"md-heading\" id=\"matrixfill\"><a href=\"#matrixfill\"><span>\u200b<code dir=\"auto\">matrix.fill()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To overwrite all matrix elements with a specific value, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.fill\">matrix.fill()</a>.\nThis function points all items in the entire matrix or within the\n<code dir=\"auto\">from_row/column</code> and <code dir=\"auto\">to_row/column</code> index range to the <code dir=\"auto\">value</code>\nspecified in the call. For example, this snippet declares a 4x4 square\nmatrix, then fills its elements with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.random\">random</a>\nvalue:</p>\n<div class=\"pine-colorizer not-content\">myMatrix = matrix.new&lt;float&gt;(4, 4)\nmyMatrix.fill(math.random())</div>\n<p>Note when using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.fill\">matrix.fill()</a>\nwith matrices containing special types\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>)\nor <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>, all replaced elements will point to the same object passed\nin the function call.</p>\n<p>This script declares a matrix with four rows and columns of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nreferences, which it fills with a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nobject on the first bar. On each bar, the script sets the <code dir=\"auto\">x</code> attribute\nof the label referenced at row 0, column 0 to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>,\nand the <code dir=\"auto\">text</code> attribute of the one referenced at row 3, column 3 to the\nnumber of labels on the chart. Although the matrix can reference 16\n(4x4) labels, each element points to the <em>same</em> instance, resulting in\nonly one label on the chart that updates its <code dir=\"auto\">x</code> and <code dir=\"auto\">text</code> attributes\non each bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"350\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Reading-and-writing-matrix-elements-2.EKhiO87r_27PkSE.webp\" width=\"986\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Object matrix fill demo\")\n\n//@variable A 4x4 label matrix.\nvar matrix&lt;label&gt; m = matrix.new&lt;label&gt;(4, 4)\n\n// Fill `m` with a new label object on the first bar.\nif bar_index == 0\n    m.fill(label.new(0, 0, textcolor = color.white, size = size.huge))\n\n//@variable The number of label objects on the chart.\nint numLabels = label.all.size()\n\n// Set the `x` of the label from the first row and column to `bar_index`.\nm.get(0, 0).set_x(bar_index)\n// Set the `text` of the label at the last row and column to the number of labels.\nm.get(3, 3).set_text(str.format(\"Total labels on the chart: {0}\", numLabels))</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"rows-and-columns\"><a href=\"#rows-and-columns\">Rows and columns<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"retrieving\"><a href=\"#retrieving\">Retrieving<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Matrices facilitate the retrieval of all values from a specific row or\ncolumn via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">matrix.col()</a>\nfunctions. These functions return the values as an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nobject sized according to the other dimension of the matrix, i.e., the\nsize of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a>\narray equals the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.columns\">number of\ncolumns</a>\nand the size of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">matrix.col()</a>\narray equals the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">number of\nrows</a>.</p>\n<p>The script below populates a 3x2 <code dir=\"auto\">m</code> matrix with the values 1 - 6 on the\nfirst chart bar. It calls the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">m.row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">m.col()</a>\nmethods to access the first row and column arrays from the matrix and\ndisplays them on the chart in a label along with the array sizes:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"340\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Retrieving-1.BTrlXXxp_Zjj8GI.webp\" width=\"954\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Retrieving rows and columns demo\")\n\n//@variable A 3x2 rectangular matrix.\nvar matrix&lt;float&gt; m = matrix.new&lt;float&gt;(3, 2)\n\nif bar_index == 0\n    m.set(0, 0, 1.0) // Set row 0, column 0 value to 1.\n    m.set(0, 1, 2.0) // Set row 0, column 1 value to 2.\n    m.set(1, 0, 3.0) // Set row 1, column 0 value to 3.\n    m.set(1, 1, 4.0) // Set row 1, column 1 value to 4.\n    m.set(2, 0, 5.0) // Set row 1, column 0 value to 5.\n    m.set(2, 1, 6.0) // Set row 1, column 1 value to 6.\n\n//@variable The first row of the matrix.\narray&lt;float&gt; row0 = m.row(0)\n//@variable The first column of the matrix.\narray&lt;float&gt; column0 = m.col(0)\n\n//@variable Displays the first row and column of the matrix and their sizes in a label.\nvar label debugLabel = label.new(0, 0, color = color.blue, textcolor = color.white, size = size.huge)\ndebugLabel.set_x(bar_index)\ndebugLabel.set_text(str.format(\"Row 0: {0}, Size: {1}\\nCol 0: {2}, Size: {3}\", row0, m.columns(), column0, m.rows()))</div>\n<p>Note that:</p>\n<ul>\n<li>To get the sizes of the arrays displayed in the label, we used\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">rows()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.columns\">columns()</a>\nmethods rather than\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a>\nto demonstrate that the size of the <code dir=\"auto\">row0</code> array equals the\nnumber of columns and the size of the <code dir=\"auto\">column0</code> array equals the\nnumber of rows.</li>\n</ul>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">matrix.col()</a>\ncopy the references in a row/column to a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.\nModifications to the <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>\nreturned by these functions do not directly affect the elements or the\nshape of a matrix.</p>\n<p>Here, we\u2019ve modified the previous script to set the first element of\n<code dir=\"auto\">row0</code> to 10 via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.set\">array.set()</a>\nmethod before displaying the label. This script also plots the value\nfrom row 0, column 0. As we see, the label shows that the first element\nof the <code dir=\"auto\">row0</code> array is 10. However, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot</a>\nshows that the corresponding matrix element still has a value of 1:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"372\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Retrieving-2.CJgBcT5Y_1sKqb7.webp\" width=\"1324\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Retrieving rows and columns demo\")\n\n//@variable A 3x2 rectangular matrix.\nvar matrix&lt;float&gt; m = matrix.new&lt;float&gt;(3, 2)\n\nif bar_index == 0\n    m.set(0, 0, 1.0) // Set row 0, column 0 value to 1.\n    m.set(0, 1, 2.0) // Set row 0, column 1 value to 2.\n    m.set(1, 0, 3.0) // Set row 1, column 0 value to 3.\n    m.set(1, 1, 4.0) // Set row 1, column 1 value to 4.\n    m.set(2, 0, 5.0) // Set row 1, column 0 value to 5.\n    m.set(2, 1, 6.0) // Set row 1, column 1 value to 6.\n\n//@variable The first row of the matrix.\narray&lt;float&gt; row0 = m.row(0)\n//@variable The first column of the matrix.\narray&lt;float&gt; column0 = m.col(0)\n\n// Set the first `row` element to 10.\nrow0.set(0, 10)\n\n//@variable Displays the first row and column of the matrix and their sizes in a label.\nvar label debugLabel = label.new(0, m.get(0, 0), color = color.blue, textcolor = color.white, size = size.huge)\ndebugLabel.set_x(bar_index)\ndebugLabel.set_text(str.format(\"Row 0: {0}, Size: {1}\\nCol 0: {2}, Size: {3}\", row0, m.columns(), column0, m.rows()))\n\n// Plot the first element of `m`.\nplot(m.get(0, 0), linewidth = 3)</div>\n<p>Although changes to an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nreturned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">matrix.row()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">matrix.col()</a>\ndo not directly affect a parent matrix, it\u2019s important to note the\nresulting array from a matrix containing\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>\nor special types, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>,\nbehaves as a <em>shallow copy</em> of a row/column, i.e., the elements within\nan array returned from these functions point to the same objects as the\ncorresponding matrix elements.</p>\n<p>This script contains a custom <code dir=\"auto\">myUDT</code> type containing a <code dir=\"auto\">value</code> field\nwith an initial value of 0. It declares a 1x1 <code dir=\"auto\">m</code> matrix to hold a\nsingle <code dir=\"auto\">myUDT</code> instance on the first bar, then calls <code dir=\"auto\">m.row(0)</code> to copy\nthe first row of the matrix as an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.\nOn every chart bar, the script adds 1 to the <code dir=\"auto\">value</code> field of the first\n<code dir=\"auto\">row</code> array element. In this case, the <code dir=\"auto\">value</code> field of the matrix\nelement increases on every bar as well since both elements reference the\nsame object:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Row with reference types demo\")\n\n//@type A custom type that holds a float value.\ntype myUDT\n    float value = 0.0\n\n//@variable A 1x1 matrix of `myUDT` type.\nvar matrix&lt;myUDT&gt; m = matrix.new&lt;myUDT&gt;(1, 1, myUDT.new())\n//@variable A shallow copy of the first row of `m`.\narray&lt;myUDT&gt; row = m.row(0)\n//@variable The first element of the `row`.\nmyUDT firstElement = row.get(0)\n\nfirstElement.value += 1.0 // Add 1 to the `value` field of `firstElement`. Also affects the element in the matrix.\n\nplot(m.get(0, 0).value, linewidth = 3) // Plot the `value` of the `myUDT` object from the first row and column of `m`.</div>\n<h3 class=\"md-heading\" id=\"inserting\"><a href=\"#inserting\">Inserting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can add new rows and columns to a matrix via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_row\">matrix.add_row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_col\">matrix.add_col()</a>.\nThese functions insert the value references from an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ninto a matrix at the specified <code dir=\"auto\">row/column</code> index. If the <code dir=\"auto\">id</code> matrix is\nempty (has no rows or columns), the <code dir=\"auto\">array_id</code> in the call can be of any\nsize. If a row/column exists at the specified index, the matrix\nincreases the index value for the existing row/column and all after it\nby 1.</p>\n<p>The script below declares an empty <code dir=\"auto\">m</code> matrix and inserts rows and\ncolumns using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_row\">m.add_row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_col\">m.add_col()</a>\nmethods. It first inserts an array with three elements at row 0, turning\n<code dir=\"auto\">m</code> into a 1x3 matrix, then another at row 1, changing the shape to 2x3.\nAfter that, the script inserts another array at row 0, which changes the\nshape of <code dir=\"auto\">m</code> to 3x3 and shifts the index of all rows previously at index\n0 and higher. It inserts another array at the last column index,\nchanging the shape to 3x4. Finally, it adds an array with four values at\nthe end row index.</p>\n<p>The resulting matrix has four rows and columns and contains values 1-16\nin ascending order. The script displays the rows of <code dir=\"auto\">m</code> after each\nrow/column insertion with a user-defined <code dir=\"auto\">debugLabel()</code> function to\nvisualize the process:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"396\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Inserting-1.SBCXGGVm_ZyieEL.webp\" width=\"1282\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Rows and columns demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//Create an empty matrix.\nvar m = matrix.new&lt;float&gt;()\n\nif bar_index == last_bar_index - 1\n    debugLabel(m, bar_index - 30, note = \"Empty matrix\")\n\n    // Insert an array at row 0. `m` will now have 1 row and 3 columns.\n    m.add_row(0, array.from(5, 6, 7))\n    debugLabel(m, bar_index - 20, note = \"New row at\\nindex 0\")\n\n    // Insert an array at row 1. `m` will now have 2 rows and 3 columns.\n    m.add_row(1, array.from(9, 10, 11))\n    debugLabel(m, bar_index - 10, note = \"New row at\\nindex 1\")\n\n    // Insert another array at row 0. `m` will now have 3 rows and 3 columns.\n    // The values previously on row 0 will now be on row 1, and the values from row 1 will be on row 2.\n    m.add_row(0, array.from(1, 2, 3))\n    debugLabel(m, bar_index, note = \"New row at\\nindex 0\")\n\n    // Insert an array at column 3. `m` will now have 3 rows and 4 columns.\n    m.add_col(3, array.from(4, 8, 12))\n    debugLabel(m, bar_index + 10, note = \"New column at\\nindex 3\")\n\n    // Insert an array at row 3. `m` will now have 4 rows and 4 columns.\n    m.add_row(3, array.from(13, 14, 15, 16))\n    debugLabel(m, bar_index + 20, note = \"New row at\\nindex 3\")</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Just as the row or column arrays\n<a href=\"/pine-script-docs/v5/language/matrices/#retrieving\">retrieved</a> from a matrix of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>,\nor <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\ninstances behave as shallow copies, the elements of matrices containing\nsuch types reference the same objects as the\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> inserted into them.\nModifications to the element values in either object affect the other in\nsuch cases.</p></div></aside>\n<h3 class=\"md-heading\" id=\"removing\"><a href=\"#removing\">Removing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To remove a specific row or column from a matrix, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_row\">matrix.remove_row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_col\">matrix.remove_col()</a>.\nThese functions remove the specified row/column and decrease the index\nvalues of all rows/columns after it by 1.</p>\n<p>For this example, we\u2019ve added these lines of code to our \u201cRows and\ncolumns demo\u201d script from the\n<a href=\"/pine-script-docs/v5/language/matrices/#inserting\">section above</a>:</p>\n<div class=\"pine-colorizer not-content\">// Removing example\n\n    // Remove the first row and last column from the matrix. `m` will now have 3 rows and 3 columns.\n    m.remove_row(0)\n    m.remove_col(3)\n    debugLabel(m, bar_index + 30, color.red, note = \"Removed row 0\\nand column 3\")</div>\n<p>This code removes the first row and the last column of the <code dir=\"auto\">m</code> matrix\nusing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_row\">m.remove_row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_col\">m.remove_col()</a>\nmethods and displays the rows in a label at <code dir=\"auto\">bar_index + 30</code>. As we can\nsee, <code dir=\"auto\">m</code> has a 3x3 shape after executing this block, and the index\nvalues for all existing rows are reduced by 1:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"394\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Removing-1.Bi1zJWmd_ZpgTSa.webp\" width=\"1044\"/></p>\n<h3 class=\"md-heading\" id=\"swapping\"><a href=\"#swapping\">Swapping<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To swap the rows and columns of a matrix without altering its\ndimensions, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.swap_rows\">matrix.swap_rows()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.swap_columns\">matrix.swap_columns()</a>.\nThese functions swap the locations of the elements at the <code dir=\"auto\">row1/column1</code>\nand <code dir=\"auto\">row2/column2</code> indices.</p>\n<p>Let\u2019s add the following lines to the\n<a href=\"/pine-script-docs/v5/language/matrices/#removing\">previous example</a>, which swap the first and last rows of <code dir=\"auto\">m</code> and display the\nchanges in a label at <code dir=\"auto\">bar_index + 40</code>:</p>\n<div class=\"pine-colorizer not-content\">// Swapping example\n\n    // Swap the first and last row. `m` retains the same dimensions.\n    m.swap_rows(0, 2)\n    debugLabel(m, bar_index + 40, color.purple, note = \"Swapped rows 0\\nand 2\")</div>\n<p>In the new label, we see the matrix has the same number of rows as\nbefore, and the first and last rows have traded places:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"392\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Swapping-1.CEKWu0X8_ZXVDWE.webp\" width=\"1044\"/></p>\n<h3 class=\"md-heading\" id=\"replacing\"><a href=\"#replacing\">Replacing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It may be desirable in some cases to completely <em>replace</em> a row or\ncolumn in a matrix. To do so,\n<a href=\"/pine-script-docs/v5/language/matrices/#inserting\">insert</a> the new array at the desired <code dir=\"auto\">row/column</code> and\n<a href=\"/pine-script-docs/v5/language/matrices/#removing\">remove</a> the old elements previously at that index.</p>\n<p>In the following code, we\u2019ve defined a <code dir=\"auto\">replaceRow()</code> method that uses\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_row\">add_row()</a>\nmethod to insert the new <code dir=\"auto\">values</code> at the <code dir=\"auto\">row</code> index and uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_row\">remove_row()</a>\nmethod to remove the old row that moved to the <code dir=\"auto\">row + 1</code> index. This\nscript uses the <code dir=\"auto\">replaceRow()</code> method to fill the rows of a 3x3 matrix\nwith the numbers 1-9. It draws a label on the chart before and after\nreplacing the rows using the custom <code dir=\"auto\">debugLabel()</code> method:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"296\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Rows-and-columns-Replacing-1.DOIpvAMN_ZBuSGC.webp\" width=\"706\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Replacing rows demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@function Replaces the `row` of `this` matrix with a new array of `values`.\n//@param    row The row index to replace.\n//@param    values The array of values to insert.\nmethod replaceRow(matrix&lt;float&gt; this, int row, array&lt;float&gt; values) =&gt;\n    this.add_row(row, values) // Inserts a copy of the `values` array at the `row`.\n    this.remove_row(row + 1)  // Removes the old elements previously at the `row`.\n\n//@variable A 3x3 matrix.\nvar matrix&lt;float&gt; m = matrix.new&lt;float&gt;(3, 3, 0.0)\n\nif bar_index == last_bar_index - 1\n    m.debugLabel(note = \"Original\")\n    // Replace each row of `m`.\n    m.replaceRow(0, array.from(1.0, 2.0, 3.0))\n    m.replaceRow(1, array.from(4.0, 5.0, 6.0))\n    m.replaceRow(2, array.from(7.0, 8.0, 9.0))\n    m.debugLabel(bar_index + 10, note = \"Replaced rows\")</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"looping-through-a-matrix\"><a href=\"#looping-through-a-matrix\">Looping through a matrix<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"for\"><a href=\"#for\"><span>\u200b<code dir=\"auto\">for</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a script only needs to iterate over the row/column indices in a\nmatrix, the most common method is to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloops. For example, this line creates a loop with a <code dir=\"auto\">row</code> value that\nstarts at 0 and increases by one until it reaches one less than the\nnumber of rows in the <code dir=\"auto\">m</code> matrix (i.e., the last row index):</p>\n<div class=\"pine-colorizer not-content\">for row = 0 to m.rows() - 1</div>\n<p>To iterate over all index values in the <code dir=\"auto\">m</code> matrix, we can create a\n<em>nested</em> loop that iterates over each <code dir=\"auto\">column</code> index on each <code dir=\"auto\">row</code>\nvalue:</p>\n<div class=\"pine-colorizer not-content\">for row = 0 to m.rows() - 1\n    for column = 0 to m.columns() - 1</div>\n<p>Let\u2019s use this nested structure to create a\n<a href=\"/pine-script-docs/v5/language/methods/\">method</a> that visualizes\nmatrix elements. In the script below, we\u2019ve defined a <code dir=\"auto\">toTable()</code>\nmethod that displays the elements of a matrix within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nobject. It iterates over each <code dir=\"auto\">row</code> index and over each <code dir=\"auto\">column</code> index\non every <code dir=\"auto\">row</code>. Within the loop, it converts each element to a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>\nto display in the corresponding table cell.</p>\n<p>On the first bar, the script creates an empty <code dir=\"auto\">m</code> matrix, populates it\nwith rows, and calls <code dir=\"auto\">m.toTable()</code> to display its elements:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"392\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Looping-through-a-matrix-For-1.AD9eoMUJ_ZEOwGG.webp\" width=\"1258\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"for loop demo\", \"Matrix to table\")\n\n//@function Displays the elements of `this` matrix in a table.\n//@param    this The matrix to display.\n//@param    position The position of the table on the chart.\n//@param    bgColor The background color of the table.\n//@param    textColor The color of the text in each cell.\n//@param    note A note string to display on the bottom row of the table.\n//@returns  A new `table` object with cells corresponding to each element of `this` matrix.\nmethod toTable(\n     matrix&lt;float&gt; this, string position = position.middle_center,\n     color bgColor = color.blue, color textColor = color.white,\n     string note = na\n ) =&gt;\n    //@variable The number of rows in `this` matrix.\n    int rows = this.rows()\n    //@variable The number of columns in `this` matrix.\n    int columns = this.columns()\n    //@variable A table that displays the elements of `this` matrix with an optional `note` cell.\n    table result = table.new(position, columns, rows + 1, bgColor)\n\n    // Iterate over each row index of `this` matrix.\n    for row = 0 to rows - 1\n        // Iterate over each column index of `this` matrix on each `row`.\n        for col = 0 to columns - 1\n            //@variable The element from `this` matrix at the `row` and `col` index.\n            float element = this.get(row, col)\n            // Initialize the corresponding `result` cell with the `element` value.\n            result.cell(col, row, str.tostring(element), text_color = textColor, text_size = size.huge)\n\n    // Initialize a merged cell on the bottom row if a `note` is provided.\n    if not na(note)\n        result.cell(0, rows, note, text_color = textColor, text_size = size.huge)\n        result.merge_cells(0, rows, columns - 1, rows)\n\n    result // Return the `result` table.\n\n//@variable A 3x4 matrix of values.\nvar m = matrix.new&lt;float&gt;()\n\nif bar_index == 0\n    // Add rows to `m`.\n    m.add_row(0, array.from(1, 2, 3))\n    m.add_row(1, array.from(5, 6, 7))\n    m.add_row(2, array.from(9, 10, 11))\n    // Add a column to `m`.\n    m.add_col(3, array.from(4, 8, 12))\n    // Display the elements of `m` in a table.\n    m.toTable()</div>\n<h3 class=\"md-heading\" id=\"forin\"><a href=\"#forin\"><span>\u200b<code dir=\"auto\">for...in</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a script needs to iterate over and retrieve the rows of a matrix,\nusing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_for%7Bdot%7D%7Bdot%7D%7Bdot%7Din\">for\u2026in</a>\nstructure is often preferred over the standard <code dir=\"auto\">for</code> loop. This\nstructure directly references the row\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> in a matrix, making\nit a more convenient option for such use cases. For example, this line\ncreates a loop that returns a <code dir=\"auto\">row</code> array for each row in the <code dir=\"auto\">m</code>\nmatrix:</p>\n<div class=\"pine-colorizer not-content\">for row in m</div>\n<p>The following indicator calculates the moving average of OHLC data with\nan input <code dir=\"auto\">length</code> and displays the values on the chart. The custom\n<code dir=\"auto\">rowWiseAvg()</code> method loops through the rows of a matrix using a\n<code dir=\"auto\">for...in</code> structure to produce an array containing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">array.avg()</a>\nof each <code dir=\"auto\">row</code>.</p>\n<p>On the first chart bar, the script creates a new <code dir=\"auto\">m</code> matrix with four\nrows and <code dir=\"auto\">length</code> columns, which it queues a new column of OHLC data\ninto via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_col\">m.add_col()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.remove_col\">m.remove_col()</a>\nmethods on each subsequent bar. It uses <code dir=\"auto\">m.rowWiseAvg()</code> to calculate\nthe array of row-wise <code dir=\"auto\">averages</code>, then it plots the element values on\nthe chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"682\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Looping-through-a-matrix-For-in-1.DsFiIU_K_Z1Fdgid.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"for...in loop demo\", \"Average OHLC\", overlay = true)\n\n//@variable The number of terms in the average.\nint length = input.int(20, \"Length\", minval = 1)\n\n//@function Calculates the average of each matrix row.\nmethod rowWiseAvg(matrix&lt;float&gt; this) =&gt;\n    //@variable An array with elements corresponding to each row's average.\n    array&lt;float&gt; result = array.new&lt;float&gt;()\n    // Iterate over each `row` of `this` matrix.\n    for row in this\n        // Push the average of each `row` into the `result`.\n        result.push(row.avg())\n    result // Return the resulting array.\n\n//@variable A 4x`length` matrix of values.\nvar matrix&lt;float&gt; m = matrix.new&lt;float&gt;(4, length)\n\n// Add a new column containing OHLC values to the matrix.\nm.add_col(m.columns(), array.from(open, high, low, close))\n// Remove the first column.\nm.remove_col(0)\n\n//@variable An array containing averages of `open`, `high`, `low`, and `close` over `length` bars.\narray&lt;float&gt; averages = m.rowWiseAvg()\n\nplot(averages.get(0), \"Average Open\",  color.blue,   2)\nplot(averages.get(1), \"Average High\",  color.green,  2)\nplot(averages.get(2), \"Average Low\",   color.red,    2)\nplot(averages.get(3), \"Average Close\", color.orange, 2)</div>\n<p>Note that:</p>\n<ul>\n<li><code dir=\"auto\">for...in</code> loops can also reference the index value of each row.\nFor example, <code dir=\"auto\">for [i, row] in m</code> creates a tuple containing the\n<code dir=\"auto\">i</code> row index and the corresponding <code dir=\"auto\">row</code> array from the <code dir=\"auto\">m</code>\nmatrix on each loop iteration.</li>\n</ul>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"copying-a-matrix\"><a href=\"#copying-a-matrix\">Copying a matrix<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"shallow-copies\"><a href=\"#shallow-copies\">Shallow copies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine scripts can copy matrices via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.copy\">matrix.copy()</a>.\nThis function returns a <em>shallow copy</em> of a matrix that does not affect\nthe shape of the original matrix or its references.</p>\n<p>For example, this script assigns a new matrix to the <code dir=\"auto\">myMatrix</code> variable\nand adds two columns. It creates a new <code dir=\"auto\">myCopy</code> matrix from <code dir=\"auto\">myMatrix</code>\nusing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.copy\">myMatrix.copy()</a>\nmethod, then adds a new row. It displays the rows of both matrices in\nlabels via the user-defined <code dir=\"auto\">debugLabel()</code> function:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"328\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Copying-a-matrix-Shallow-copies-1.Bwmv7fvt_Z2gUKoY.webp\" width=\"774\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shallow copy demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 2x2 `float` matrix.\nmatrix&lt;float&gt; myMatrix = matrix.new&lt;float&gt;()\nmyMatrix.add_col(0, array.from(1.0, 3.0))\nmyMatrix.add_col(1, array.from(2.0, 4.0))\n\n//@variable A shallow copy of `myMatrix`.\nmatrix&lt;float&gt; myCopy = myMatrix.copy()\n// Add a row to the last index of `myCopy`.\nmyCopy.add_row(myCopy.rows(), array.from(5.0, 6.0))\n\nif bar_index == last_bar_index - 1\n    // Display the rows of both matrices in separate labels.\n    myMatrix.debugLabel(note = \"Original\")\n    myCopy.debugLabel(bar_index + 10, color.green, note = \"Shallow Copy\")</div>\n<p>It\u2019s important to note that the elements within shallow copies of a\nmatrix point to the same values as the original matrix. When matrices\ncontain special types\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>)\nor\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>, the elements of a shallow copy reference the same objects\nas the original.</p>\n<p>This script declares a <code dir=\"auto\">myMatrix</code> variable with a <code dir=\"auto\">newLabel</code> as the\ninitial value. It then copies <code dir=\"auto\">myMatrix</code> to a <code dir=\"auto\">myCopy</code> variable via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.copy\">myMatrix.copy()</a>\nand plots the number of labels. As we see below, there\u2019s only one\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\non the chart, as the element in <code dir=\"auto\">myCopy</code> references the same object as\nthe element in <code dir=\"auto\">myMatrix</code>. Consequently, changes to the element values\nin <code dir=\"auto\">myCopy</code> affect the values in both matrices:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"236\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Copying-a-matrix-Shallow-copies-2.CimkBVuC_XKEfb.webp\" width=\"522\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shallow copy demo\")\n\n//@variable Initial value of the original matrix elements.\nvar label newLabel = label.new(\n     bar_index, 1, \"Original\", color = color.blue, textcolor = color.white, size = size.huge\n )\n\n//@variable A 1x1 matrix containing a new `label` instance.\nvar matrix&lt;label&gt; myMatrix = matrix.new&lt;label&gt;(1, 1, newLabel)\n//@variable A shallow copy of `myMatrix`.\nvar matrix&lt;label&gt; myCopy = myMatrix.copy()\n\n//@variable The first label from the `myCopy` matrix.\nlabel testLabel = myCopy.get(0, 0)\n\n// Change the `text`, `style`, and `x` values of `testLabel`. Also affects the `newLabel`.\ntestLabel.set_text(\"Copy\")\ntestLabel.set_style(label.style_label_up)\ntestLabel.set_x(bar_index)\n\n// Plot the total number of labels.\nplot(label.all.size(), linewidth = 3)</div>\n<h3 class=\"md-heading\" id=\"deep-copies\"><a href=\"#deep-copies\">Deep copies<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One can produce a <em>deep copy</em> of a matrix (i.e., a matrix whose elements\npoint to copies of the original values) by explicitly copying each\nobject the matrix references.</p>\n<p>Here, we\u2019ve added a <code dir=\"auto\">deepCopy()</code> user-defined method to our previous\nscript. The method creates a new matrix and uses\n<a href=\"/pine-script-docs/v5/language/matrices/#for\">nested for loops</a> to assign all elements to copies of the originals. When the\nscript calls this method instead of the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.copy\">copy()</a>,\nwe see that there are now two labels on the chart, and any changes to\nthe label from <code dir=\"auto\">myCopy</code> do not affect the one from <code dir=\"auto\">myMatrix</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"248\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Copying-a-matrix-Deep-copies-1.DxEfU-j0_1Lkpmy.webp\" width=\"624\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Deep copy demo\")\n\n//@function Returns a deep copy of a label matrix.\nmethod deepCopy(matrix&lt;label&gt; this) =&gt;\n    //@variable A deep copy of `this` matrix.\n    matrix&lt;label&gt; that = this.copy()\n    for row = 0 to that.rows() - 1\n        for column = 0 to that.columns() - 1\n            // Assign the element at each `row` and `column` of `that` matrix to a copy of the retrieved label.\n            that.set(row, column, that.get(row, column).copy())\n    that\n\n//@variable Initial value of the original matrix.\nvar label newLabel = label.new(\n     bar_index, 2, \"Original\", color = color.blue, textcolor = color.white, size = size.huge\n )\n\n//@variable A 1x1 matrix containing a new `label` instance.\nvar matrix&lt;label&gt; myMatrix = matrix.new&lt;label&gt;(1, 1, newLabel)\n//@variable A deep copy of `myMatrix`.\nvar matrix&lt;label&gt; myCopy = myMatrix.deepCopy()\n\n//@variable The first label from the `myCopy` matrix.\nlabel testLabel = myCopy.get(0, 0)\n\n// Change the `text`, `style`, and `x` values of `testLabel`. Does not affect the `newLabel`.\ntestLabel.set_text(\"Copy\")\ntestLabel.set_style(label.style_label_up)\ntestLabel.set_x(bar_index)\n\n// Change the `x` value of `newLabel`.\nnewLabel.set_x(bar_index)\n\n// Plot the total number of labels.\nplot(label.all.size(), linewidth = 3)</div>\n<h3 class=\"md-heading\" id=\"submatrices\"><a href=\"#submatrices\">Submatrices<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In Pine, a <em>submatrix</em> is a\n<a href=\"/pine-script-docs/v5/language/matrices/#shallow-copies\">shallow copy</a> of an existing matrix that only includes the rows and\ncolumns specified by the <code dir=\"auto\">from_row/column</code> and <code dir=\"auto\">to_row/column</code>\nparameters. In essence, it is a sliced copy of a matrix.</p>\n<p>For example, the script below creates an <code dir=\"auto\">mSub</code> matrix from the <code dir=\"auto\">m</code>\nmatrix via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.submatrix\">m.submatrix()</a>\nmethod, then calls our user-defined <code dir=\"auto\">debugLabel()</code> function to display\nthe rows of both matrices in labels:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Copying-a-matrix-Submatrices-1.BTbnoi2I_Z7HBh.webp\" width=\"774\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Submatrix demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 3x3 matrix of values.\nvar m = matrix.new&lt;float&gt;()\n\nif bar_index == last_bar_index - 1\n    // Add columns to `m`.\n    m.add_col(0, array.from(9, 6, 3))\n    m.add_col(1, array.from(8, 5, 2))\n    m.add_col(2, array.from(7, 4, 1))\n    // Display the rows of `m`.\n    m.debugLabel(note = \"Original Matrix\")\n\n    //@variable A 2x2 submatrix of `m` containing the first two rows and columns.\n    matrix&lt;float&gt; mSub = m.submatrix(from_row = 0, to_row = 2, from_column = 0, to_column = 2)\n    // Display the rows of `mSub`\n    debugLabel(mSub, bar_index + 10, bgColor = color.green, note = \"Submatrix\")</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"scope-and-history\"><a href=\"#scope-and-history\">Scope and history<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Matrix variables leave historical trails on each bar, allowing scripts\nto use the history-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nto interact with past matrix instances previously assigned to a\nvariable. Additionally, scripts can modify matrices assigned to global\nvariables from within the scopes of\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a>,\n<a href=\"/pine-script-docs/v5/language/methods/\">methods</a>, and\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>.</p>\n<p>This script calculates the average ratios of body and wick distances\nrelative to the bar range over <code dir=\"auto\">length</code> bars. It displays the data along\nwith values from <code dir=\"auto\">length</code> bars ago in a table. The user-defined\n<code dir=\"auto\">addData()</code> function adds columns of current and historical ratios to\nthe <code dir=\"auto\">globalMatrix</code>, and the <code dir=\"auto\">calcAvg()</code> function references <code dir=\"auto\">previous</code>\nmatrices assigned to <code dir=\"auto\">globalMatrix</code> using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator to calculate a matrix of averages:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"650\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Scope-and-history-1.iA9FQFRn_Z1tlC9r.webp\" width=\"1282\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scope and history demo\", \"Bar ratio comparison\")\n\nint length = input.int(10, \"Length\", 1)\n\n//@variable A global matrix.\nmatrix&lt;float&gt; globalMatrix = matrix.new&lt;float&gt;()\n\n//@function Calculates the ratio of body range to candle range.\nbodyRatio() =&gt;\n    math.abs(close - open) / (high - low)\n\n//@function Calculates the ratio of upper wick range to candle range.\nupperWickRatio() =&gt;\n    (high - math.max(open, close)) / (high - low)\n\n//@function Calculates the ratio of lower wick range to candle range.\nlowerWickRatio() =&gt;\n    (math.min(open, close) - low) / (high - low)\n\n//@function Adds data to the `globalMatrix`.\naddData() =&gt;\n    // Add a new column of data at `column` 0.\n    globalMatrix.add_col(0, array.from(bodyRatio(), upperWickRatio(), lowerWickRatio()))\n    //@variable The column of `globalMatrix` from index 0 `length` bars ago.\n    array&lt;float&gt; pastValues = globalMatrix.col(0)[length]\n    // Add `pastValues` to the `globalMatrix`, or an array of `na` if `pastValues` is `na`.\n    if na(pastValues)\n        globalMatrix.add_col(1, array.new&lt;float&gt;(3))\n    else\n        globalMatrix.add_col(1, pastValues)\n\n//@function Returns the `length`-bar average of matrices assigned to `globalMatrix` on historical bars.\ncalcAvg() =&gt;\n    //@variable The sum historical `globalMatrix` matrices.\n    matrix&lt;float&gt; sums = matrix.new&lt;float&gt;(globalMatrix.rows(), globalMatrix.columns(), 0.0)\n    for i = 0 to length - 1\n        //@variable The `globalMatrix` matrix `i` bars before the current bar.\n        matrix&lt;float&gt; previous = globalMatrix[i]\n        // Break the loop if `previous` is `na`.\n        if na(previous)\n            sums.fill(na)\n            break\n        // Assign the sum of `sums` and `previous` to `sums`.\n        sums := matrix.sum(sums, previous)\n    // Divide the `sums` matrix by the `length`.\n    result = sums.mult(1.0 / length)\n\n// Add data to the `globalMatrix`.\naddData()\n\n//@variable The historical average of the `globalMatrix` matrices.\nglobalAvg = calcAvg()\n\n//@variable A `table` displaying information from the `globalMatrix`.\nvar table infoTable = table.new(\n     position.middle_center, globalMatrix.columns() + 1, globalMatrix.rows() + 1, bgcolor = color.navy\n )\n\n// Define value cells.\nfor [i, row] in globalAvg\n    for [j, value] in row\n        color textColor = value &gt; 0.333 ? color.orange : color.gray\n        infoTable.cell(j + 1, i + 1, str.tostring(value), text_color = textColor, text_size = size.huge)\n\n// Define header cells.\ninfoTable.cell(0, 1, \"Body ratio\", text_color = color.white, text_size = size.huge)\ninfoTable.cell(0, 2, \"Upper wick ratio\", text_color = color.white, text_size = size.huge)\ninfoTable.cell(0, 3, \"Lower wick ratio\", text_color = color.white, text_size = size.huge)\ninfoTable.cell(1, 0, \"Current average\", text_color = color.white, text_size = size.huge)\ninfoTable.cell(2, 0, str.format(\"{0} bars ago\", length), text_color = color.white, text_size = size.huge)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">addData()</code> and <code dir=\"auto\">calcAvg()</code> functions have no parameters, as\nthey directly interact with the <code dir=\"auto\">globalMatrix</code> and <code dir=\"auto\">length</code>\nvariables declared in the outer scope.</li>\n<li><code dir=\"auto\">calcAvg()</code> calculates the average by adding <code dir=\"auto\">previous</code> matrices\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sum\">matrix.sum()</a>\nand multiplying all elements by <code dir=\"auto\">1 / length</code> using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>.\nWe discuss these and other specialized functions in our\n<a href=\"/pine-script-docs/v5/language/matrices/#matrix-calculations\">Matrix calculations</a> section below.</li>\n</ul>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"inspecting-a-matrix\"><a href=\"#inspecting-a-matrix\">Inspecting a matrix<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The ability to inspect the shape of a matrix and patterns within its\nelements is crucial, as it helps reveal important information about a\nmatrix and its compatibility with various calculations and\ntransformations. Pine Script includes several built-ins for matrix\ninspection, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_square\">matrix.is_square()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_identity\">matrix.is_identity()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_diagonal\">matrix.is_diagonal()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_antidiagonal\">matrix.is_antidiagonal()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_symmetric\">matrix.is_symmetric()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_antisymmetric\">matrix.is_antisymmetric()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_triangular\">matrix.is_triangular()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_stochastic\">matrix.is_stochastic()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_binary\">matrix.is_binary()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_zero\">matrix.is_zero()</a>.</p>\n<p>To demonstrate these features, this example contains a custom\n<code dir=\"auto\">inspect()</code> method that uses conditional blocks with <code dir=\"auto\">matrix.is_*()</code>\nfunctions to return information about a matrix. It displays a string\nrepresentation of an <code dir=\"auto\">m</code> matrix and the description returned from\n<code dir=\"auto\">m.inspect()</code> in labels on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"424\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Inspecting-a-matrix-1.CnldBvch_25YXn4.webp\" width=\"1196\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix inspection demo\")\n\n//@function Inspects a matrix using `matrix.is_*()` functions and returns a `string` describing some of its features.\nmethod inspect(matrix&lt;int&gt; this)=&gt;\n    //@variable A string describing `this` matrix.\n    string result = \"This matrix:\\n\"\n    if this.is_square()\n        result += \"- Has an equal number of rows and columns.\\n\"\n    if this.is_binary()\n        result += \"- Contains only 1s and 0s.\\n\"\n    if this.is_zero()\n        result += \"- Is filled with 0s.\\n\"\n    if this.is_triangular()\n        result += \"- Contains only 0s above and/or below its main diagonal.\\n\"\n    if this.is_diagonal()\n        result += \"- Only has nonzero values in its main diagonal.\\n\"\n    if this.is_antidiagonal()\n        result += \"- Only has nonzero values in its main antidiagonal.\\n\"\n    if this.is_symmetric()\n        result += \"- Equals its transpose.\\n\"\n    if this.is_antisymmetric()\n        result += \"- Equals the negative of its transpose.\\n\"\n    if this.is_identity()\n        result += \"- Is the identity matrix.\\n\"\n    result\n\n//@variable A 4x4 identity matrix.\nmatrix&lt;int&gt; m = matrix.new&lt;int&gt;()\n\n// Add rows to the matrix.\nm.add_row(0, array.from(1, 0, 0, 0))\nm.add_row(1, array.from(0, 1, 0, 0))\nm.add_row(2, array.from(0, 0, 1, 0))\nm.add_row(3, array.from(0, 0, 0, 1))\n\nif bar_index == last_bar_index - 1\n    // Display the `m` matrix in a blue label.\n    label.new(\n         bar_index, 0, str.tostring(m), color = color.blue, style = label.style_label_right,\n         textcolor = color.white, size = size.huge\n     )\n    // Display the result of `m.inspect()` in a purple label.\n    label.new(\n         bar_index, 0, m.inspect(), color = color.purple, style = label.style_label_left,\n         textcolor = color.white, size = size.huge\n     )</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"manipulating-a-matrix\"><a href=\"#manipulating-a-matrix\">Manipulating a matrix<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"reshaping\"><a href=\"#reshaping\">Reshaping<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The shape of a matrix can determine its compatibility with various\nmatrix operations. In some cases, it is necessary to change the\ndimensions of a matrix without affecting the number of elements or the\nvalues they reference, otherwise known as <em>reshaping</em>. To reshape a\nmatrix in Pine, use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.reshape\">matrix.reshape()</a>\nfunction.</p>\n<p>This example demonstrates the results of multiple reshaping operations\non a matrix. The initial <code dir=\"auto\">m</code> matrix has a 1x8 shape (one row and eight\ncolumns). Through successive calls to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.reshape\">m.reshape()</a>\nmethod, the script changes the shape of <code dir=\"auto\">m</code> to 2x4, 4x2, and 8x1. It\ndisplays each reshaped matrix in a label on the chart using the custom\n<code dir=\"auto\">debugLabel()</code> method:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"430\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Reshaping-1.DYGzopbC_Z2j7E98.webp\" width=\"1206\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reshaping example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A matrix containing the values 1-8.\nmatrix&lt;int&gt; m = matrix.new&lt;int&gt;()\n\nif bar_index == last_bar_index - 1\n    // Add the initial vector of values.\n    m.add_row(0, array.from(1, 2, 3, 4, 5, 6, 7, 8))\n    m.debugLabel(note = \"Initial 1x8 matrix\")\n\n    // Reshape. `m` now has 2 rows and 4 columns.\n    m.reshape(2, 4)\n    m.debugLabel(bar_index + 10, note = \"Reshaped to 2x4\")\n\n    // Reshape. `m` now has 4 rows and 2 columns.\n    m.reshape(4, 2)\n    m.debugLabel(bar_index + 20, note = \"Reshaped to 4x2\")\n\n    // Reshape. `m` now has 8 rows and 1 column.\n    m.reshape(8, 1)\n    m.debugLabel(bar_index + 30, note = \"Reshaped to 8x1\")</div>\n<p>Note that:</p>\n<ul>\n<li>The order of elements in <code dir=\"auto\">m</code> does not change with each\n<code dir=\"auto\">m.reshape()</code> call.</li>\n<li>When reshaping a matrix, the product of the <code dir=\"auto\">rows</code> and <code dir=\"auto\">columns</code>\narguments must equal the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.elements_count\">matrix.elements_count()</a>\nvalue, as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.reshape\">matrix.reshape()</a>\ncannot change the number of elements in a matrix.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"reversing\"><a href=\"#reversing\">Reversing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One can reverse the order of all elements in a matrix using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.reverse\">matrix.reverse()</a>.\nThis function moves the references of an m-by-n matrix <code dir=\"auto\">id</code> at the i-th\nrow and j-th column to the m - 1 - i row and n - 1 - j column.</p>\n<p>For example, this script creates a 3x3 matrix containing the values 1-9\nin ascending order, then uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.reverse\">reverse()</a>\nmethod to reverse its contents. It displays the original and modified\nversions of the matrix in labels on the chart via <code dir=\"auto\">m.debugLabel()</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"242\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Reversing-1.Cgfm4aYH_1ccxk3.webp\" width=\"634\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reversing demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 3x3 matrix.\nmatrix&lt;float&gt; m = matrix.new&lt;float&gt;()\n\n// Add rows to `m`.\nm.add_row(0, array.from(1, 2, 3))\nm.add_row(1, array.from(4, 5, 6))\nm.add_row(2, array.from(7, 8, 9))\n\nif bar_index == last_bar_index - 1\n    // Display the contents of `m`.\n    m.debugLabel(note = \"Original\")\n    // Reverse `m`, then display its contents.\n    m.reverse()\n    m.debugLabel(bar_index + 10, color.red, note = \"Reversed\")</div>\n<h3 class=\"md-heading\" id=\"transposing\"><a href=\"#transposing\">Transposing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Transposing a matrix is a fundamental operation that flips all rows and\ncolumns in a matrix about its <em>main diagonal</em> (the diagonal vector of\nall values in which the row index equals the column index). This process\nproduces a new matrix with reversed row and column dimensions, known as\nthe <em>transpose</em>. Scripts can calculate the transpose of a matrix using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">matrix.transpose()</a>.</p>\n<p>For any m-row, n-column matrix, the matrix returned from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">matrix.transpose()</a>\nwill have n rows and m columns. All elements in a matrix at the i-th row\nand j-th column correspond to the elements in its transpose at the j-th\nrow and i-th column.</p>\n<p>This example declares a 2x4 <code dir=\"auto\">m</code> matrix, calculates its transpose using\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">m.transpose()</a>\nmethod, and displays both matrices on the chart using our custom\n<code dir=\"auto\">debugLabel()</code> method. As we can see below, the transposed matrix has a\n4x2 shape, and the rows of the transpose match the columns of the\noriginal:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"294\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Transposing-1.DLTkeyZ__ZDefeU.webp\" width=\"744\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Transpose example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 2x4 matrix.\nmatrix&lt;int&gt; m = matrix.new&lt;int&gt;()\n\n// Add columns to `m`.\nm.add_col(0, array.from(1, 5))\nm.add_col(1, array.from(2, 6))\nm.add_col(2, array.from(3, 7))\nm.add_col(3, array.from(4, 8))\n\n//@variable The transpose of `m`. Has a 4x2 shape.\nmatrix&lt;int&gt; mt = m.transpose()\n\nif bar_index == last_bar_index - 1\n    m.debugLabel(note = \"Original\")\n    mt.debugLabel(bar_index + 10, note = \"Transpose\")</div>\n<h3 class=\"md-heading\" id=\"sorting\"><a href=\"#sorting\">Sorting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can sort the contents of a matrix via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sort\">matrix.sort()</a>.\nUnlike\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.sort\">array.sort()</a>,\nwhich sorts <em>elements</em>, this function organizes all <em>rows</em> in a matrix\nin a specified <code dir=\"auto\">order</code>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_order.ascending\">order.ascending</a>\nby default) based on the values in a specified <code dir=\"auto\">column</code>.</p>\n<p>This script declares a 3x3 <code dir=\"auto\">m</code> matrix, sorts the rows of the <code dir=\"auto\">m1</code> copy\nin ascending order based on the first column, then sorts the rows of the\n<code dir=\"auto\">m2</code> copy in descending order based on the second column. It displays\nthe original matrix and sorted copies in labels using our <code dir=\"auto\">debugLabel()</code>\nmethod:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"320\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Sorting-1.7v_kYwQL_ZOu1j2.webp\" width=\"892\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Sorting rows example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 3x3 matrix.\nmatrix&lt;int&gt; m = matrix.new&lt;int&gt;()\n\nif bar_index == last_bar_index - 1\n    // Add rows to `m`.\n    m.add_row(0, array.from(3, 2, 4))\n    m.add_row(1, array.from(1, 9, 6))\n    m.add_row(2, array.from(7, 8, 9))\n    m.debugLabel(note = \"Original\")\n\n    // Copy `m` and sort rows in ascending order based on the first column (default).\n    matrix&lt;int&gt; m1 = m.copy()\n    m1.sort()\n    m1.debugLabel(bar_index + 10, color.green, note = \"Sorted using col 0\\n(Ascending)\")\n\n    // Copy `m` and sort rows in descending order based on the second column.\n    matrix&lt;int&gt; m2 = m.copy()\n    m2.sort(1, order.descending)\n    m2.debugLabel(bar_index + 20, color.red, note = \"Sorted using col 1\\n(Descending)\")</div>\n<p>It\u2019s important to note that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sort\">matrix.sort()</a>\ndoes not sort the columns of a matrix. However, one <em>can</em> use this\nfunction to sort matrix columns with the help of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">matrix.transpose()</a>.</p>\n<p>As an example, this script contains a <code dir=\"auto\">sortColumns()</code> method that uses\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sort\">sort()</a>\nmethod to sort the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">transpose</a>\nof a matrix using the column corresponding to the <code dir=\"auto\">row</code> of the original\nmatrix. The script uses this method to sort the <code dir=\"auto\">m</code> matrix based on the\ncontents of its first row:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"316\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Sorting-2.BaU7IEP__2g88Bo.webp\" width=\"826\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Sorting columns example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@function Sorts the columns of `this` matrix based on the values in the specified `row`.\nmethod sortColumns(matrix&lt;int&gt; this, int row = 0, bool ascending = true) =&gt;\n    //@variable The transpose of `this` matrix.\n    matrix&lt;int&gt; thisT = this.transpose()\n    //@variable Is `order.ascending` when `ascending` is `true`, `order.descending` otherwise.\n    order = ascending ? order.ascending : order.descending\n    // Sort the rows of `thisT` using the `row` column.\n    thisT.sort(row, order)\n    //@variable A copy of `this` matrix with sorted columns.\n    result = thisT.transpose()\n\n//@variable A 3x3 matrix.\nmatrix&lt;int&gt; m = matrix.new&lt;int&gt;()\n\nif bar_index == last_bar_index - 1\n    // Add rows to `m`.\n    m.add_row(0, array.from(3, 2, 4))\n    m.add_row(1, array.from(1, 9, 6))\n    m.add_row(2, array.from(7, 8, 9))\n    m.debugLabel(note = \"Original\")\n\n    // Sort the columns of `m` based on the first row and display the result.\n    m.sortColumns(0).debugLabel(bar_index + 10, note = \"Sorted using row 0\\n(Ascending)\")</div>\n<h3 class=\"md-heading\" id=\"concatenating\"><a href=\"#concatenating\">Concatenating<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can <em>concatenate</em> two matrices using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.concat\">matrix.concat()</a>.\nThis function appends the rows of an <code dir=\"auto\">id2</code> matrix to the end of an <code dir=\"auto\">id1</code>\nmatrix with the same number of columns.</p>\n<p>To create a matrix with elements representing the <em>columns</em> of a matrix\nappended to another,\n<a href=\"/pine-script-docs/v5/language/matrices/#transposing\">transpose</a> both matrices, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.concat\">matrix.concat()</a>\non the transposed matrices, then\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">transpose()</a>\nthe result.</p>\n<p>For example, this script appends the rows of the <code dir=\"auto\">m2</code> matrix to the <code dir=\"auto\">m1</code>\nmatrix and appends their columns using <em>transposed copies</em> of the\nmatrices. It displays the <code dir=\"auto\">m1</code> and <code dir=\"auto\">m2</code> matrices and the results after\nconcatenating their rows and columns in labels using the custom\n<code dir=\"auto\">debugLabel()</code> method:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"366\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Manipulating-a-matrix-Concatenating-1.Dk8fPc4l_1FGbFm.webp\" width=\"1222\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Concatenation demo\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 2x3 matrix filled with 1s.\nmatrix&lt;int&gt; m1 = matrix.new&lt;int&gt;(2, 3, 1)\n//@variable A 2x3 matrix filled with 2s.\nmatrix&lt;int&gt; m2 = matrix.new&lt;int&gt;(2, 3, 2)\n\n//@variable The transpose of `m1`.\nt1 = m1.transpose()\n//@variable The transpose of `m2`.\nt2 = m2.transpose()\n\nif bar_index == last_bar_index - 1\n    // Display the original matrices.\n    m1.debugLabel(note = \"Matrix 1\")\n    m2.debugLabel(bar_index + 10, note = \"Matrix 2\")\n    // Append the rows of `m2` to the end of `m1` and display `m1`.\n    m1.concat(m2)\n    m1.debugLabel(bar_index + 20, color.blue, note = \"Appended rows\")\n    // Append the rows of `t2` to the end of `t1`, then display the transpose of `t1.\n    t1.concat(t2)\n    t1.transpose().debugLabel(bar_index + 30, color.purple, note = \"Appended columns\")</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"matrix-calculations\"><a href=\"#matrix-calculations\">Matrix calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"element-wise-calculations\"><a href=\"#element-wise-calculations\">Element-wise calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine scripts can calculate the <em>average</em>, <em>minimum</em>, <em>maximum</em>, and\n<em>mode</em> of all elements within a matrix via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.avg\">matrix.avg()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.min\">matrix.min()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.max\">matrix.max()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mode\">matrix.mode()</a>.\nThese functions operate the same as their <code dir=\"auto\">array.*</code> equivalents,\nallowing users to run element-wise calculations on a matrix, its\n<a href=\"/pine-script-docs/v5/language/matrices/#submatrices\">submatrices</a>, and its\n<a href=\"/pine-script-docs/v5/language/matrices/#rows-and-columns\">rows and columns</a> using the same syntax. For example, the built-in <code dir=\"auto\">*.avg()</code>\nfunctions called on a 3x3 matrix with values 1-9 and an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nwith the same nine elements will both return a value of 5.</p>\n<p>The script below uses <code dir=\"auto\">*.avg()</code>, <code dir=\"auto\">*.max()</code>, and <code dir=\"auto\">*.min()</code> methods to\ncalculate developing averages and extremes of OHLC data in a period. It\nadds a new column of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues to the end of the <code dir=\"auto\">ohlcData</code> matrix whenever <code dir=\"auto\">queueColumn</code> is\n<code dir=\"auto\">true</code>. When <code dir=\"auto\">false</code>, the script uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">get()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">set()</a>\nmatrix methods to adjust the elements in the last column for developing\nHLC values in the current period. It uses the <code dir=\"auto\">ohlcData</code> matrix, a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.submatrix\">submatrix()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.row\">row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.col\">col()</a>\narrays to calculate the developing OHLC4 and HL2 averages over <code dir=\"auto\">length</code>\nperiods, the maximum high and minimum low over <code dir=\"auto\">length</code> periods, and the\ncurrent period\u2019s developing OHLC4 price:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"678\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Element-wise-calculations-1.qqvZC3jo_uJ39n.webp\" width=\"1338\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Element-wise calculations example\", \"Developing values\", overlay = true)\n\n//@variable The number of data points in the averages.\nint length = input.int(3, \"Length\", 1)\n//@variable The timeframe of each reset period.\nstring timeframe = input.timeframe(\"D\", \"Reset Timeframe\")\n\n//@variable A 4x`length` matrix of OHLC values.\nvar matrix&lt;float&gt; ohlcData = matrix.new&lt;float&gt;(4, length)\n\n//@variable Is `true` at the start of a new bar at the `timeframe`.\nbool queueColumn = timeframe.change(timeframe)\n\nif queueColumn\n    // Add new values to the end column of `ohlcData`.\n    ohlcData.add_col(length, array.from(open, high, low, close))\n    // Remove the oldest column from `ohlcData`.\n    ohlcData.remove_col(0)\nelse\n    // Adjust the last element of column 1 for new highs.\n    if high &gt; ohlcData.get(1, length - 1)\n        ohlcData.set(1, length - 1, high)\n    // Adjust the last element of column 2 for new lows.\n    if low &lt; ohlcData.get(2, length - 1)\n        ohlcData.set(2, length - 1, low)\n    // Adjust the last element of column 3 for the new closing price.\n    ohlcData.set(3, length - 1, close)\n\n//@variable The `matrix.avg()` of all elements in `ohlcData`.\navgOHLC4 = ohlcData.avg()\n//@variable The `matrix.avg()` of all elements in rows 1 and 2, i.e., the average of all `high` and `low` values.\navgHL2   = ohlcData.submatrix(from_row = 1, to_row = 3).avg()\n//@variable The `matrix.max()` of all values in `ohlcData`. Equivalent to `ohlcData.row(1).max()`.\nmaxHigh = ohlcData.max()\n//@variable The `array.min()` of all `low` values in `ohlcData`. Equivalent to `ohlcData.min()`.\nminLow = ohlcData.row(2).min()\n//@variable The `array.avg()` of the last column in `ohlcData`, i.e., the current OHLC4.\nohlc4Value = ohlcData.col(length - 1).avg()\n\nplot(avgOHLC4, \"Average OHLC4\", color.purple, 2)\nplot(avgHL2, \"Average HL2\", color.navy, 2)\nplot(maxHigh, \"Max High\", color.green)\nplot(minLow, \"Min Low\", color.red)\nplot(ohlc4Value, \"Current OHLC4\", color.blue)</div>\n<p>Note that:</p>\n<ul>\n<li>In this example, we used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array.*()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix.*()</a>\nmethods interchangeably to demonstrate their similarities in\nsyntax and behavior.</li>\n<li>Users can calculate the matrix equivalent of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.sum\">array.sum()</a>\nby multiplying the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.avg\">matrix.avg()</a>\nby the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.elements_count\">matrix.elements_count()</a>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"special-calculations\"><a href=\"#special-calculations\">Special calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script features several built-in functions for performing\nessential matrix arithmetic and linear algebra operations, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sum\">matrix.sum()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.diff\">matrix.diff()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.pow\">matrix.pow()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.det\">matrix.det()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">matrix.inv()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.pinv\">matrix.pinv()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rank\">matrix.rank()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.trace\">matrix.trace()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.eigenvalues\">matrix.eigenvalues()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.eigenvectors\">matrix.eigenvectors()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.kron\">matrix.kron()</a>.\nThese functions are advanced features that facilitate a variety of\nmatrix calculations and transformations.</p>\n<p>Below, we explain a few fundamental functions with some basic examples.</p>\n<h4 class=\"md-heading\" id=\"matrixsum-and-matrixdiff\"><a href=\"#matrixsum-and-matrixdiff\"><span>\u200b<code dir=\"auto\">matrix.sum()</code>\u200b and \u200b<code dir=\"auto\">matrix.diff()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Scripts can perform addition and subtraction of two matrices with the\nsame shape or a matrix and a scalar value using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sum\">matrix.sum()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.diff\">matrix.diff()</a>\nfunctions. These functions use the values from the <code dir=\"auto\">id2</code> matrix or\nscalar to add to or subtract from the elements in <code dir=\"auto\">id1</code>.</p>\n<p>This script demonstrates a simple example of matrix addition and\nsubtraction in Pine. It creates a 3x3 matrix, calculates its\n<a href=\"/pine-script-docs/v5/language/matrices/#transposing\">transpose</a>, then calculates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.sum\">matrix.sum()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.diff\">matrix.diff()</a>\nof the two matrices. This example displays the original matrix, its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.transpose\">transpose</a>,\nand the resulting sum and difference matrices in labels on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"332\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Special-calculations-1.CqDsJl37_RrqVF.webp\" width=\"1056\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix sum and diff example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 3x3 matrix.\nm = matrix.new&lt;float&gt;()\n\n// Add rows to `m`.\nm.add_row(0, array.from(0.5, 1.0, 1.5))\nm.add_row(1, array.from(2.0, 2.5, 3.0))\nm.add_row(2, array.from(3.5, 4.0, 4.5))\n\nif bar_index == last_bar_index - 1\n    // Display `m`.\n    m.debugLabel(note = \"A\")\n    // Get and display the transpose of `m`.\n    matrix&lt;float&gt; t = m.transpose()\n    t.debugLabel(bar_index + 10, note = \"A\u1d40\")\n    // Calculate the sum of the two matrices. The resulting matrix is symmetric.\n    matrix.sum(m, t).debugLabel(bar_index + 20, color.green, note = \"A + A\u1d40\")\n    // Calculate the difference between the two matrices. The resulting matrix is antisymmetric.\n    matrix.diff(m, t).debugLabel(bar_index + 30, color.red, note = \"A - A\u1d40\")</div>\n<p>Note that:</p>\n<ul>\n<li>In this example, we\u2019ve labeled the original matrix as \u201cA\u201d and\nthe transpose as \u201cA\u1d40\u201d.</li>\n<li>Adding \u201cA\u201d and \u201cA\u1d40\u201d produces a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_symmetric\">symmetric</a>\nmatrix, and subtracting them produces an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_antisymmetric\">antisymmetric</a>\nmatrix.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"matrixmult\"><a href=\"#matrixmult\"><span>\u200b<code dir=\"auto\">matrix.mult()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Scripts can multiply two matrices via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>\nfunction. This function also facilitates the multiplication of a matrix\nby an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nor a scalar value.</p>\n<p>In the case of multiplying two matrices, unlike addition and\nsubtraction, matrix multiplication does not require two matrices to\nshare the same shape. However, the number of columns in the first matrix\nmust equal the number of rows in the second one. The resulting matrix\nreturned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>\nwill contain the same number of rows as <code dir=\"auto\">id1</code> and the same number of\ncolumns as <code dir=\"auto\">id2</code>. For instance, a 2x3 matrix multiplied by a 3x4 matrix\nwill produce a matrix with two rows and four columns, as shown below.\nEach value within the resulting matrix is the <a href=\"https://en.wikipedia.org/wiki/Dot_product\" rel=\"nofollow\">dot\nproduct</a> of the corresponding\nrow in <code dir=\"auto\">id1</code> and column in <code dir=\"auto\">id2</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"338\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Special-calculations-2.B9VMtj33_ZXAisD.webp\" width=\"1010\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix mult example\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 2x3 matrix.\na = matrix.new&lt;float&gt;()\n//@variable A 3x4 matrix.\nb = matrix.new&lt;float&gt;()\n\n// Add rows to `a`.\na.add_row(0, array.from(1, 2, 3))\na.add_row(1, array.from(4, 5, 6))\n\n// Add rows to `b`.\nb.add_row(0, array.from(0.5, 1.0, 1.5, 2.0))\nb.add_row(1, array.from(2.5, 3.0, 3.5, 4.0))\nb.add_row(0, array.from(4.5, 5.0, 5.5, 6.0))\n\nif bar_index == last_bar_index - 1\n    //@variable The result of `a` * `b`.\n    matrix&lt;float&gt; ab = a.mult(b)\n    // Display `a`, `b`, and `ab` matrices.\n    debugLabel(a, note = \"A\")\n    debugLabel(b, bar_index + 10, note = \"B\")\n    debugLabel(ab, bar_index + 20, color.green, note = \"A * B\")</div>\n<p>Note that:</p>\n<ul>\n<li>In contrast to the multiplication of scalars, matrix\nmultiplication is <em>non-commutative</em>, i.e., <code dir=\"auto\">matrix.mult(a, b)</code>\ndoes not necessarily produce the same result as\n<code dir=\"auto\">matrix.mult(b, a)</code>. In the context of our example, the latter\nwill raise a runtime error because the number of columns in <code dir=\"auto\">b</code>\ndoesn\u2019t equal the number of rows in <code dir=\"auto\">a</code>.</li>\n</ul>\n<p>When multiplying a matrix and an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nthis function treats the operation the same as multiplying <code dir=\"auto\">id1</code> by a\nsingle-column matrix, but it returns an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nwith the same number of elements as the number of rows in <code dir=\"auto\">id1</code>. When\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>\npasses a scalar as its <code dir=\"auto\">id2</code> value, the function returns a new matrix\nwhose elements are the elements in <code dir=\"auto\">id1</code> multiplied by the <code dir=\"auto\">id2</code> value.</p>\n<h4 class=\"md-heading\" id=\"matrixdet\"><a href=\"#matrixdet\"><span>\u200b<code dir=\"auto\">matrix.det()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>A <em>determinant</em> is a scalar value associated with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_square\">square</a>\nmatrix that describes some of its characteristics, namely its\ninvertibility. If a matrix has an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">inverse</a>,\nits determinant is nonzero. Otherwise, the matrix is <em>singular</em>\n(non-invertible). Scripts can calculate the determinant of a matrix via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.det\">matrix.det()</a>.</p>\n<p>Programmers can use determinants to detect similarities between\nmatrices, identify <em>full-rank</em> and <em>rank-deficient</em> matrices, and solve\nsystems of linear equations, among other applications.</p>\n<p>For example, this script utilizes determinants to solve a system of\nlinear equations with a matching number of unknown values using\n<a href=\"https://en.wikipedia.org/wiki/Cramer's_rule\" rel=\"nofollow\">Cramer\u2019s rule</a>. The\nuser-defined <code dir=\"auto\">solve()</code> function returns an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\ncontaining solutions for each unknown value in the system, where the\nn-th element of the array is the determinant of the coefficient matrix\nwith the n-th column replaced by the column of constants divided by the\ndeterminant of the original coefficients.</p>\n<p>In this script, we\u2019ve defined the matrix <code dir=\"auto\">m</code> that holds coefficients\nand constants for these three equations:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">3 * x0 + 4 * x1 - 1 * x2 = 8</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">5 * x0 - 2 * x1 + 1 * x2 = 4</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">2 * x0 - 2 * x1 + 1 * x2 = 1</span></div></div></code></pre></figure></div>\n<p>The solution to this system is <code dir=\"auto\">(x0 = 1, x1 = 2, x2 = 3)</code>. The script\ncalculates these values from <code dir=\"auto\">m</code> via <code dir=\"auto\">m.solve()</code> and plots them on the\nchart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"344\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Special-calculations-3.Bq84ZoEi_1X2sQR.webp\" width=\"1336\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Determinants example\", \"Cramer's Rule\")\n\n//@function Solves a system of linear equations with a matching number of unknowns using Cramer's rule.\n//@param    this An augmented matrix containing the coefficients for each unknown and the results of\n//          the equations. For example, a row containing the values 2, -1, and 3 represents the equation\n//          `2 * x0 + (-1) * x1 = 3`, where `x0` and `x1` are the unknown values in the system.\n//@returns  An array containing solutions for each variable in the system.\nsolve(matrix&lt;float&gt; this) =&gt;\n    //@variable The coefficient matrix for the system of equations.\n    matrix&lt;float&gt; coefficients = this.submatrix(from_column = 0, to_column = this.columns() - 1)\n    //@variable The array of resulting constants for each equation.\n    array&lt;float&gt; constants = this.col(this.columns() - 1)\n    //@variable An array containing solutions for each unknown in the system.\n    array&lt;float&gt; result = array.new&lt;float&gt;()\n\n    //@variable The determinant value of the coefficient matrix.\n    float baseDet = coefficients.det()\n    matrix&lt;float&gt; modified = na\n    for col = 0 to coefficients.columns() - 1        \n        modified := coefficients.copy()\n        modified.add_col(col, constants)\n        modified.remove_col(col + 1)\n\n        // Calculate the solution for the column's unknown by dividing the determinant of `modified` by the `baseDet`.\n        result.push(modified.det() / baseDet)\n\n    result\n\n//@variable A 3x4 matrix containing coefficients and results for a system of three equations.\nm = matrix.new&lt;float&gt;()\n\n// Add rows for the following equations:\n// Equation 1: 3 * x0 + 4 * x1 - 1 * x2 = 8\n// Equation 2: 5 * x0 - 2 * x1 + 1 * x2 = 4\n// Equation 3: 2 * x0 - 2 * x1 + 1 * x2 = 1\nm.add_row(0, array.from(3.0, 4.0, -1.0, 8.0))\nm.add_row(1, array.from(5.0, -2.0, 1.0, 4.0))\nm.add_row(2, array.from(2.0, -2.0, 1.0, 1.0))\n\n//@variable An array of solutions to the unknowns in the system of equations represented by `m`.\nsolutions = solve(m)\n\nplot(solutions.get(0), \"x0\", color.red, 3)   // Plots 1.\nplot(solutions.get(1), \"x1\", color.green, 3) // Plots 2.\nplot(solutions.get(2), \"x2\", color.blue, 3)  // Plots 3.</div>\n<p>Note that:</p>\n<ul>\n<li>Solving systems of equations is particularly useful for\n<em>regression analysis</em>, e.g., linear and polynomial regression.</li>\n<li>Cramer\u2019s rule works fine for small systems of equations.\nHowever, it\u2019s computationally inefficient on larger systems.\nOther methods, such as <a href=\"https://en.wikipedia.org/wiki/Gaussian_elimination\" rel=\"nofollow\">Gaussian\nelimination</a>,\nare often preferred for such use cases.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"matrixinv-and-matrixpinv\"><a href=\"#matrixinv-and-matrixpinv\"><span>\u200b<code dir=\"auto\">matrix.inv()</code>\u200b and \u200b<code dir=\"auto\">matrix.pinv()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>For any non-singular\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_square\">square</a>\nmatrix, there is an inverse matrix that yields the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_identity\">identity</a>\nmatrix when\n<a href=\"/pine-script-docs/v5/language/matrices/#matrixmult\">multiplied</a> by the original. Inverses have utility in various matrix\ntransformations and solving systems of equations. Scripts can calculate\nthe inverse of a matrix <strong>when one exists</strong> via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">matrix.inv()</a>\nfunction.</p>\n<p>For singular (non-invertible) matrices, one can calculate a generalized\ninverse\n(<a href=\"https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_inverse\" rel=\"nofollow\">pseudoinverse</a>),\nregardless of whether the matrix is square or has a nonzero\n<code dir=\"auto\">determinant &lt;_PageMatrices_MatrixCalculations_SpecialCalculations_MatrixDet&gt;</code>, via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.pinv\">matrix.pinv()</a>\nfunction. Keep in mind that unlike a true inverse, the product of a\npseudoinverse and the original matrix does not necessarily equal the\nidentity matrix unless the original matrix <em>is invertible</em>.</p>\n<p>The following example forms a 2x2 <code dir=\"auto\">m</code> matrix from user inputs, then uses\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">m.inv()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.pinv\">m.pinv()</a>\nmethods to calculate the inverse or pseudoinverse of <code dir=\"auto\">m</code>. The script\ndisplays the original matrix, its inverse or pseudoinverse, and their\nproduct in labels on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"314\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Special-calculations-4.BXfICGI-_Z1Y52Ud.webp\" width=\"844\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inverse example\")\n\n// Element inputs for the 2x2 matrix.\nfloat r0c0 = input.float(4.0, \"Row 0, Col 0\")\nfloat r0c1 = input.float(3.0, \"Row 0, Col 1\")\nfloat r1c0 = input.float(2.0, \"Row 1, Col 0\")\nfloat r1c1 = input.float(1.0, \"Row 1, Col 1\")\n\n//@function Displays the rows of a matrix in a label with a note.\n//@param    this The matrix to display.\n//@param    barIndex The `bar_index` to display the label at.\n//@param    bgColor The background color of the label.\n//@param    textColor The color of the label's text.\n//@param    note The text to display above the rows.\nmethod debugLabel(\n     matrix&lt;float&gt; this, int barIndex = bar_index, color bgColor = color.blue,\n     color textColor = color.white, string note = \"\"\n ) =&gt;\n    labelText = note + \"\\n\" + str.tostring(this)\n    if barstate.ishistory\n        label.new(\n             barIndex, 0, labelText, color = bgColor, style = label.style_label_center,\n             textcolor = textColor, size = size.huge\n         )\n\n//@variable A 2x2 matrix of input values.\nm = matrix.new&lt;float&gt;()\n\n// Add input values to `m`.\nm.add_row(0, array.from(r0c0, r0c1))\nm.add_row(1, array.from(r1c0, r1c1))\n\n//@variable Is `true` if `m` is square with a nonzero determinant, indicating invertibility.\nbool isInvertible = m.is_square() and m.det()\n\n//@variable The inverse or pseudoinverse of `m`.\nmInverse = isInvertible ? m.inv() : m.pinv()\n\n//@variable The product of `m` and `mInverse`. Returns the identity matrix when `isInvertible` is `true`.\nmatrix&lt;float&gt; product = m.mult(mInverse)\n\nif bar_index == last_bar_index - 1\n    // Display `m`, `mInverse`, and their `product`.\n    m.debugLabel(note = \"Original\")\n    mInverse.debugLabel(bar_index + 10, color.purple, note = isInvertible ? \"Inverse\" : \"Pseudoinverse\")\n    product.debugLabel(bar_index + 20, color.green, note = \"Product\")</div>\n<p>Note that:</p>\n<ul>\n<li>This script will only call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">m.inv()</a>\nwhen <code dir=\"auto\">isInvertible</code> is <code dir=\"auto\">true</code>, i.e., when <code dir=\"auto\">m</code> is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.is_square\">square</a>\nand has a nonzero\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.det\">determinant</a>.\nOtherwise, it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.pinv\">m.pinv()</a>\nto calculate the generalized inverse.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"matrixrank\"><a href=\"#matrixrank\"><span>\u200b<code dir=\"auto\">matrix.rank()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <em>rank</em> of a matrix represents the number of linearly independent\nvectors (rows or columns) it contains. In essence, matrix rank measures\nthe number of vectors one cannot express as a linear combination of\nothers, or in other words, the number of vectors that contain <strong>unique</strong>\ninformation. Scripts can calculate the rank of a matrix via\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rank\">matrix.rank()</a>.</p>\n<p>This script identifies the number of linearly independent vectors in two\n3x3 matrices (<code dir=\"auto\">m1</code> and <code dir=\"auto\">m2</code>) and plots the values in a separate pane. As\nwe see on the chart, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rank\">m1.rank()</a>\nvalue is 3 because each vector is unique. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rank\">m2.rank()</a>\nvalue, on the other hand, is 1 because it has just one unique vector:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"338\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Matrices-Matrix-calculations-Special-calculations-5.DU77KrgW_Z14e0aC.webp\" width=\"952\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix rank example\")\n\n//@variable A 3x3 full-rank matrix.\nm1 = matrix.new&lt;float&gt;()\n//@variable A 3x3 rank-deficient matrix.\nm2 = matrix.new&lt;float&gt;()\n\n// Add linearly independent vectors to `m1`.\nm1.add_row(0, array.from(3, 2, 3))\nm1.add_row(1, array.from(4, 6, 6))\nm1.add_row(2, array.from(7, 4, 9))\n\n// Add linearly dependent vectors to `m2`.\nm2.add_row(0, array.from(1, 2, 3))\nm2.add_row(1, array.from(2, 4, 6))\nm2.add_row(2, array.from(3, 6, 9))\n\n// Plot `matrix.rank()` values.\nplot(m1.rank(), color = color.green, linewidth = 3)\nplot(m2.rank(), color = color.red, linewidth = 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The highest rank value a matrix can have is the minimum of its\nnumber of rows and columns. A matrix with the maximum possible\nrank is known as a <em>full-rank</em> matrix, and any matrix without\nfull rank is known as a <em>rank-deficient</em> matrix.</li>\n<li>The\n<a href=\"/pine-script-docs/v5/language/matrices/#matrixdet\">determinants</a> of full-rank square matrices are nonzero, and such\nmatrices have\n<a href=\"/pine-script-docs/v5/language/matrices/#matrixinv-and-matrixpinv\">inverses</a>. Conversely, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.det\">determinant</a>\nof a rank-deficient matrix is always 0.</li>\n<li>For any matrix that contains nothing but the same value in each\nof its elements (e.g., a matrix filled with 0), the rank is\nalways 0 since none of the vectors hold unique information. For\nany other matrix with distinct values, the minimum possible rank\nis 1.</li>\n</ul>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/matrices", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"error-handling\"><a href=\"#error-handling\">Error handling<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In addition to usual <strong>compiler</strong> errors, which occur during a script\u2019s\ncompilation due to improper syntax, scripts using matrices can raise\nspecific <strong>runtime</strong> errors during their execution. When a script raises\na runtime error, it displays a red exclamation point next to the script\ntitle. Users can view the error message by clicking this icon.</p>\n<p>In this section, we discuss runtime errors that users may encounter\nwhile utilizing matrices in their scripts.</p>\n<h3 class=\"md-heading\" id=\"the-rowcolumn-index-xx-is-out-of-bounds-rowcolumn-size-is-yy\"><a href=\"#the-rowcolumn-index-xx-is-out-of-bounds-rowcolumn-size-is-yy\">The row/column index (xx) is out of bounds, row/column size is (yy).<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This runtime error occurs when trying to access indices outside the\nmatrix dimensions with functions including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.get\">matrix.get()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">matrix.set()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.fill\">matrix.fill()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.submatrix\">matrix.submatrix()</a>,\nas well as some of the functions relating to the\n<a href=\"/pine-script-docs/v5/language/matrices/#rows-and-columns\">rows and columns</a> of a matrix.</p>\n<p>For example, this code contains two lines that will produce this runtime\nerror. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.set\">m.set()</a>\nmethod references a <code dir=\"auto\">row</code> index that doesn\u2019t exist (2). The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.submatrix\">m.submatrix()</a>\nmethod references all column indices up to <code dir=\"auto\">to_column - 1</code>. A\n<code dir=\"auto\">to_column</code> value of 4 results in a runtime error because the last\ncolumn index referenced (3) does not exist in <code dir=\"auto\">m</code>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Out of bounds demo\")\n\n//@variable A 2x3 matrix with a max row index of 1 and max column index of 2. \nmatrix&lt;float&gt; m = matrix.new&lt;float&gt;(2, 3, 0.0)\n\nm.set(row = 2, column = 0, value = 1.0)     // The `row` index is out of bounds on this line. The max value is 1.\nm.submatrix(from_column = 1, to_column = 4) // The `to_column` index is invalid on this line. The max value is 3.\n\nif bar_index == last_bar_index - 1\n    label.new(bar_index, 0, str.tostring(m), color = color.navy, textcolor = color.white, size = size.huge)</div>\n<p>Users can avoid this error in their scripts by ensuring their function\ncalls do not reference indices greater than or equal to the number of\nrows/columns.</p>\n<h3 class=\"md-heading\" id=\"the-array-size-does-not-match-the-number-of-rowscolumns-in-the-matrix\"><a href=\"#the-array-size-does-not-match-the-number-of-rowscolumns-in-the-matrix\">The array size does not match the number of rows/columns in the matrix.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_row\">matrix.add_row()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.add_col\">matrix.add_col()</a>\nfunctions to\n<a href=\"/pine-script-docs/v5/language/matrices/#inserting\">insert</a> rows and columns into a non-empty matrix, the size of the\ninserted array must align with the matrix dimensions. The size of an\ninserted row must match the number of columns, and the size of an\ninserted column must match the number of rows. Otherwise, the script\nwill raise this runtime error. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Invalid array size demo\")\n\n// Declare an empty matrix.\nm = matrix.new&lt;float&gt;()\n\nm.add_col(0, array.from(1, 2))    // Add a column. Changes the shape of `m` to 2x1.\nm.add_col(1, array.from(1, 2, 3)) // Raises a runtime error because `m` has 2 rows, not 3. \n\nplot(m.col(0).get(1))</div>\n<p>Note that:</p>\n<ul>\n<li>When <code dir=\"auto\">m</code> is empty, one can insert a row or column array of <em>any</em>\nsize, as shown in the first <code dir=\"auto\">m.add_col()</code> line.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"cannot-call-matrix-methods-when-the-id-of-matrix-is-na\"><a href=\"#cannot-call-matrix-methods-when-the-id-of-matrix-is-na\">Cannot call matrix methods when the ID of matrix is \u2018na\u2019.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a matrix variable is assigned to <code dir=\"auto\">na</code>, it means that the variable\ndoesn\u2019t reference an existing object. Consequently, one cannot use\nbuilt-in <code dir=\"auto\">matrix.*()</code> functions and methods with it. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"na matrix methods demo\") \n\n//@variable A `matrix` variable assigned to `na`.\nmatrix&lt;float&gt; m = na\n\nmCopy = m.copy() // Raises a runtime error. You can't copy a matrix that doesn't exist.\n\nif bar_index == last_bar_index - 1\n    label.new(bar_index, 0, str.tostring(mCopy), color = color.navy, textcolor = color.white, size = size.huge)</div>\n<p>To resolve this error, assign <code dir=\"auto\">m</code> to a valid matrix instance before\nusing <code dir=\"auto\">matrix.*()</code> functions.</p>\n<h3 class=\"md-heading\" id=\"matrix-is-too-large-maximum-size-of-the-matrix-is-100000-elements\"><a href=\"#matrix-is-too-large-maximum-size-of-the-matrix-is-100000-elements\">Matrix is too large. Maximum size of the matrix is 100,000 elements.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The total number of elements in a matrix\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.elements_count\">matrix.elements_count()</a>)\ncannot exceed <strong>100,000</strong>, regardless of its shape. For example, this\nscript will raise an error because it\n<a href=\"/pine-script-docs/v5/language/matrices/#inserting\">inserts</a> 1000 rows with 101 elements into the <code dir=\"auto\">m</code> matrix:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Matrix too large demo\") \n\nvar matrix&lt;float&gt; m = matrix.new&lt;float&gt;()\n\nif bar_index == 0\n    for i = 1 to 1000\n        // This raises an error because the script adds 101 elements on each iteration.\n        // 1000 rows * 101 elements per row = 101000 total elements. This is too large.\n        m.add_row(m.rows(), array.new&lt;float&gt;(101, i))\n\nplot(m.get(0, 0))</div>\n<h3 class=\"md-heading\" id=\"the-rowcolumn-index-must-be-0--from_rowcolumn--to_rowcolumn\"><a href=\"#the-rowcolumn-index-must-be-0--from_rowcolumn--to_rowcolumn\">The row/column index must be 0 &lt;= from_row/column &lt; to_row/column.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When using <code dir=\"auto\">matrix.*()</code> functions with <code dir=\"auto\">from_row/column</code> and\n<code dir=\"auto\">to_row/column</code> indices, the <code dir=\"auto\">from_*</code> values must be less than the\ncorresponding <code dir=\"auto\">to_*</code> values, with the minimum possible value being 0.\nOtherwise, the script will raise a runtime error.</p>\n<p>For example, this script shows an attempt to declare a\n<a href=\"/pine-script-docs/v5/language/matrices/#submatrices\">submatrix</a> from a 4x4 <code dir=\"auto\">m</code> matrix with a <code dir=\"auto\">from_row</code> value of 2 and a\n<code dir=\"auto\">to_row</code> value of 2, which will result in an error:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Invalid from_row, to_row demo\") \n\n//@variable A 4x4 matrix filled with a random value. \nmatrix&lt;float&gt; m = matrix.new&lt;float&gt;(4, 4, math.random())\n\nmatrix&lt;float&gt; mSub = m.submatrix(from_row = 2, to_row = 2) // Raises an error. `from_row` can't equal `to_row`.\n\nplot(mSub.get(0, 0))</div>\n<h3 class=\"md-heading\" id=\"matrices-id1-and-id2-must-have-an-equal-number-of-rows-and-columns-to-be-added\"><a href=\"#matrices-id1-and-id2-must-have-an-equal-number-of-rows-and-columns-to-be-added\">Matrices \u2018id1\u2019 and \u2018id2\u2019 must have an equal number of rows and columns to be added.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When using\n<a href=\"/pine-script-docs/v5/language/matrices/#matrixsum-and-matrixdiff\">matrix.sum() and matrix.diff()</a> functions, the <code dir=\"auto\">id1</code> and <code dir=\"auto\">id2</code> matrices must have the same\nnumber of rows and the same number of columns. Attempting to add or\nsubtract two matrices with mismatched dimensions will raise an error, as\ndemonstrated by this code:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Invalid sum dimensions demo\") \n\n//@variable A 2x3 matrix. \nmatrix&lt;float&gt; m1 = matrix.new&lt;float&gt;(2, 3, 1)\n//@variable A 3x4 matrix.\nmatrix&lt;float&gt; m2 = matrix.new&lt;float&gt;(3, 4, 2)\n\nmSum = matrix.sum(m1, m2) // Raises an error. `m1` and `m2` don't have matching dimensions.\n\nplot(mSum.get(0, 0))</div>\n<h3 class=\"md-heading\" id=\"the-number-of-columns-in-the-id1-matrix-must-equal-the-number-of-rows-in-the-matrix-or-the-number-of-elements-in-the-array-id2\"><a href=\"#the-number-of-columns-in-the-id1-matrix-must-equal-the-number-of-rows-in-the-matrix-or-the-number-of-elements-in-the-array-id2\">The number of columns in the \u2018id1\u2019 matrix must equal the number of rows in the matrix (or the number of elements in the array) \u2018id2\u2019.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When using\n<a href=\"/pine-script-docs/v5/language/matrices/#matrixmult\">matrix.mult()</a> to multiply an <code dir=\"auto\">id1</code> matrix by an <code dir=\"auto\">id2</code> matrix or array, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.rows\">matrix.rows()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a>\nof <code dir=\"auto\">id2</code> must equal the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.columns\">matrix.columns()</a>\nin <code dir=\"auto\">id1</code>. If they don\u2019t align, the script will raise this error.</p>\n<p>For example, this script tries to multiply two 2x3 matrices. While\n<em>adding</em> these matrices is possible, <em>multiplying</em> them is not:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Invalid mult dimensions demo\") \n\n//@variable A 2x3 matrix. \nmatrix&lt;float&gt; m1 = matrix.new&lt;float&gt;(2, 3, 1)\n//@variable A 2x3 matrix.\nmatrix&lt;float&gt; m2 = matrix.new&lt;float&gt;(2, 3, 2)\n\nmSum = matrix.mult(m1, m2) // Raises an error. The number of columns in `m1` and rows in `m2` aren't equal.\n\nplot(mSum.get(0, 0))</div>\n<h3 class=\"md-heading\" id=\"operation-not-available-for-non-square-matrices\"><a href=\"#operation-not-available-for-non-square-matrices\">Operation not available for non-square matrices.<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Some matrix operations, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">matrix.inv()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.det\">matrix.det()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.eigenvalues\">matrix.eigenvalues()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.inv\">matrix.eigenvectors()</a>\nonly work with <strong>square</strong> matrices, i.e., matrices with the same number\nof rows and columns. When attempting to execute such functions on\nnon-square matrices, the script will raise an error stating the\noperation isn\u2019t available or that it cannot calculate the result for\nthe matrix <code dir=\"auto\">id</code>. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Non-square demo\") \n\n//@variable A 3x5 matrix. \nmatrix&lt;float&gt; m = matrix.new&lt;float&gt;(3, 5, 1)\n\nplot(m.det()) // Raises a runtime error. You can't calculate the determinant of a 3x5 matrix.</div>", "segment_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "da9ef317404e51b596f02987c901763dc19c5e12ee489c2f1c8f125671e14fc3", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/methods\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"methods\"><a href=\"#methods\">Methods<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script methods are specialized functions associated with values of specific <a href=\"/pine-script-docs/v5/language/type-system/#types\">built-in types</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>, or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a>.\nThey behave the same as regular functions in most regards while offering a shorter, more convenient syntax.\nUsers can access methods using <em>dot notation</em> syntax on variables of the associated type, similar to accessing the fields\nof a Pine Script <a href=\"/pine-script-docs/v5/language/objects/\">object</a>.</p>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"built-in-methods\"><a href=\"#built-in-methods\">Built-in methods<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script includes built-in methods for all <em>special types</em>,\nincluding\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>.\nThese methods provide users with a more concise way to call specialized\nroutines for these types within their scripts.</p>\n<p>When using these special types, the expressions:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;namespace&gt;.&lt;functionName&gt;([paramName =] &lt;objectName&gt;, \u2026)</span></div></div></code></pre></figure></link></div>\n<p>and:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;objectName&gt;.&lt;functionName&gt;(\u2026)</span></div></div></code></pre></figure></div>\n<p>are equivalent. For example, rather than using:</p>\n<div class=\"pine-colorizer not-content\">array.get(id, index)</div>\n<p>to get the value from an array <code dir=\"auto\">id</code> at the specified <code dir=\"auto\">index</code>, we can\nsimply use:</p>\n<div class=\"pine-colorizer not-content\">id.get(index)</div>\n<p>to achieve the same effect. This notation eliminates the need for users\nto reference the function\u2019s namespace, as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.get\">get()</a>\nis a method of <code dir=\"auto\">id</code> in this context.</p>\n<p>Written below is a practical example to demonstrate the usage of\nbuilt-in methods in place of functions.</p>\n<p>The following script computes Bollinger Bands over a specified number of\nprices sampled once every <code dir=\"auto\">n</code> bars. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">array.shift()</a>\nto queue <code dir=\"auto\">sourceInput</code> values through the <code dir=\"auto\">sourceArray</code>, then\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">array.avg()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.stdev\">array.stdev()</a>\nto compute the <code dir=\"auto\">sampleMean</code> and <code dir=\"auto\">sampleDev</code>. The script then uses these\nvalues to calculate the <code dir=\"auto\">highBand</code> and <code dir=\"auto\">lowBand</code>, which it plots on the\nchart along with the <code dir=\"auto\">sampleMean</code>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"844\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Methods_custom_bb.DR1SlFGg_2tQfSW.webp\" width=\"1814\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Custom Sample BB\", overlay = true)\n\nfloat sourceInput  = input.source(close, \"Source\")\nint   samplesInput = input.int(20, \"Samples\")\nint   n            = input.int(10, \"Bars\")\nfloat multiplier   = input.float(2.0, \"StdDev\")\n\nvar array&lt;float&gt; sourceArray = array.new&lt;float&gt;(samplesInput)\nvar float        sampleMean  = na\nvar float        sampleDev   = na\n\n// Identify if `n` bars have passed.\nif bar_index % n == 0\n    // Update the queue.\n    array.push(sourceArray, sourceInput)\n    array.shift(sourceArray)\n    // Update the mean and standard deviaiton values.\n    sampleMean := array.avg(sourceArray)\n    sampleDev  := array.stdev(sourceArray) * multiplier\n\n// Calculate bands.\nfloat highBand = sampleMean + sampleDev\nfloat lowBand  = sampleMean - sampleDev\n\nplot(sampleMean, \"Basis\", color.orange)\nplot(highBand, \"Upper\", color.lime)\nplot(lowBand, \"Lower\", color.red)</div>\n<p>Let\u2019s rewrite this code to utilize methods rather than built-in\nfunctions. In this version, we have replaced all built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array.*</a>\nfunctions in the script with equivalent methods:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Custom Sample BB\", overlay = true)\n\nfloat sourceInput  = input.source(close, \"Source\")\nint   samplesInput = input.int(20, \"Samples\")\nint   n            = input.int(10, \"Bars\")\nfloat multiplier   = input.float(2.0, \"StdDev\")\n\nvar array&lt;float&gt; sourceArray = array.new&lt;float&gt;(samplesInput)\nvar float        sampleMean  = na\nvar float        sampleDev   = na\n\n// Identify if `n` bars have passed.\nif bar_index % n == 0\n    // Update the queue.\n    sourceArray.push(sourceInput)\n    sourceArray.shift()\n    // Update the mean and standard deviaiton values.\n    sampleMean := sourceArray.avg()\n    sampleDev  := sourceArray.stdev() * multiplier\n\n// Calculate band values.\nfloat highBand = sampleMean + sampleDev\nfloat lowBand  = sampleMean - sampleDev\n\nplot(sampleMean, \"Basis\", color.orange)\nplot(highBand, \"Upper\", color.lime)\nplot(lowBand, \"Lower\", color.red)</div>\n<p>Note that:</p>\n<ul>\n<li>We call the array methods using <code dir=\"auto\">sourceArray.*</code> rather than\nreferencing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nnamespace.</li>\n<li>We do not include <code dir=\"auto\">sourceArray</code> as a parameter when we call the\nmethods since they already reference the object.</li>\n</ul>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"user-defined-methods\"><a href=\"#user-defined-methods\">User-defined methods<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script allows users to define custom methods for use with objects\nof any built-in or user-defined type. Defining a method is essentially\nthe same as defining a function, but with two key differences:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_method\">method</a>\nkeyword must be included before the function name.</li>\n<li>The type of the first parameter in the signature must be explicitly\ndeclared, as it represents the type of object that the method will\nbe associated with.</li>\n</ul>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[export] method &lt;functionName&gt;(&lt;paramType&gt; &lt;paramName&gt; [= &lt;defaultValue&gt;], \u2026) =&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;functionBlock&gt;</span></div></div></code></pre></figure></div>\n<p>Let\u2019s apply user-defined methods to our previous Bollinger Bands\nexample to encapsulate operations from the global scope, which will\nsimplify the code and promote reusability. See this portion from the\nexample:</p>\n<div class=\"pine-colorizer not-content\">// Identify if `n` bars have passed.\nif bar_index % n == 0\n    // Update the queue.\n    sourceArray.push(sourceInput)\n    sourceArray.shift()\n    // Update the mean and standard deviaiton values.\n    sampleMean := sourceArray.avg()\n    sampleDev  := sourceArray.stdev() * multiplier\n\n// Calculate band values.\nfloat highBand = sampleMean + sampleDev\nfloat lowBand  = sampleMean - sampleDev</div>\n<p>We will start by defining a simple method to queue values through an\narray in a single call.</p>\n<p>This <code dir=\"auto\">maintainQueue()</code> method invokes the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">push()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.shift\">shift()</a>\nmethods on a <code dir=\"auto\">srcArray</code> when <code dir=\"auto\">takeSample</code> is true and returns the\nobject:</p>\n<div class=\"pine-colorizer not-content\">// @function         Maintains a queue of the size of `srcArray`. \n//                   It appends a `value` to the array and removes its oldest element at position zero.\n// @param srcArray   (array&lt;float&gt;) The array where the queue is maintained.\n// @param value      (float) The new value to be added to the queue. \n//                   The queue's oldest value is also removed, so its size is constant.\n// @param takeSample (bool) A new `value` is only pushed into the queue if this is true.\n// @returns          (array&lt;float&gt;) `srcArray` object.\nmethod maintainQueue(array&lt;float&gt; srcArray, float value, bool takeSample = true) =&gt;\n    if takeSample\n        srcArray.push(value)\n        srcArray.shift()\n    srcArray</div>\n<p>Note that:</p>\n<ul>\n<li>Just as with user-defined functions, we use the <code dir=\"auto\">@function</code>\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation</a> to document method descriptions.</li>\n</ul>\n<p>Now we can replace <code dir=\"auto\">sourceArray.push()</code> and <code dir=\"auto\">sourceArray.shift()</code> with\n<code dir=\"auto\">sourceArray.maintainQueue()</code> in our example:</p>\n<div class=\"pine-colorizer not-content\">// Identify if `n` bars have passed.\nif bar_index % n == 0\n    // Update the queue.\n    sourceArray.maintainQueue(sourceInput)\n    // Update the mean and standard deviaiton values.\n    sampleMean  := sourceArray.avg()\n    sampleDev   := sourceArray.stdev() * multiplier\n\n// Calculate band values.\nfloat highBand  = sampleMean + sampleDev\nfloat lowBand   = sampleMean - sampleDev</div>\n<p>From here, we will further simplify our code by defining a method that\nhandles all Bollinger Band calculations within its scope.</p>\n<p>This <code dir=\"auto\">calcBB()</code> method invokes the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">avg()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.stdev\">stdev()</a>\nmethods on a <code dir=\"auto\">srcArray</code> to update <code dir=\"auto\">mean</code> and <code dir=\"auto\">dev</code> values when\n<code dir=\"auto\">calculate</code> is true. The method uses these values to return a tuple\ncontaining the basis, upper band, and lower band values respectively:</p>\n<div class=\"pine-colorizer not-content\">// @function         Computes Bollinger Band values from an array of data.\n// @param srcArray   (array&lt;float&gt;) The array where the queue is maintained.\n// @param multiplier (float) Standard deviaiton multiplier.\n// @param calcuate   (bool) The method will only calculate new values when this is true.\n// @returns          A tuple containing the basis, upper band, and lower band respectively.\nmethod calcBB(array&lt;float&gt; srcArray, float mult, bool calculate = true) =&gt;\n    var float mean = na\n    var float dev  = na\n    if calculate\n        // Compute the mean and standard deviation of the array.\n        mean := srcArray.avg()\n        dev  := srcArray.stdev() * mult\n    [mean, mean + dev, mean - dev]</div>\n<p>With this method, we can now remove Bollinger Band calculations from the\nglobal scope and improve code readability:</p>\n<div class=\"pine-colorizer not-content\">// Identify if `n` bars have passed.\nbool newSample = bar_index % n == 0\n\n// Update the queue and compute new BB values on each new sample.\n[sampleMean, highBand, lowBand] = sourceArray.maintainQueue(sourceInput, newSample).calcBB(multiplier, newSample)</div>\n<p>Note that:</p>\n<ul>\n<li>Rather than using an <code dir=\"auto\">if</code> block in the global scope, we have\ndefined a <code dir=\"auto\">newSample</code> variable that is only true once every <code dir=\"auto\">n</code>\nbars. The <code dir=\"auto\">maintainQueue()</code> and <code dir=\"auto\">calcBB()</code> methods use this\nvalue for their respective <code dir=\"auto\">takeSample</code> and <code dir=\"auto\">calculate</code>\nparameters.</li>\n<li>Since the <code dir=\"auto\">maintainQueue()</code> method returns the object that it\nreferences, we\u2019re able to call <code dir=\"auto\">calcBB()</code> from the same line of\ncode, as both methods apply to <code dir=\"auto\">array&lt;float&gt;</code> instances.</li>\n</ul>\n<p>Here is how the full script example looks now that we\u2019ve applied our\nuser-defined methods:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Custom Sample BB\", overlay = true)\n\nfloat sourceInput  = input.source(close, \"Source\")\nint   samplesInput = input.int(20, \"Samples\")\nint   n            = input.int(10, \"Bars\")\nfloat multiplier   = input.float(2.0, \"StdDev\")\n\nvar array&lt;float&gt; sourceArray = array.new&lt;float&gt;(samplesInput)\n\n// @function         Maintains a queue of the size of `srcArray`. \n//                   It appends a `value` to the array and removes its oldest element at position zero.\n// @param srcArray   (array&lt;float&gt;) The array where the queue is maintained.\n// @param value      (float) The new value to be added to the queue. \n//                   The queue's oldest value is also removed, so its size is constant.\n// @param takeSample (bool) A new `value` is only pushed into the queue if this is true.\n// @returns          (array&lt;float&gt;) `srcArray` object.\nmethod maintainQueue(array&lt;float&gt; srcArray, float value, bool takeSample = true) =&gt;\n    if takeSample\n        srcArray.push(value)\n        srcArray.shift()\n    srcArray\n\n// @function         Computes Bollinger Band values from an array of data.\n// @param srcArray   (array&lt;float&gt;) The array where the queue is maintained.\n// @param multiplier (float) Standard deviaiton multiplier.\n// @param calcuate   (bool) The method will only calculate new values when this is true.\n// @returns          A tuple containing the basis, upper band, and lower band respectively.\nmethod calcBB(array&lt;float&gt; srcArray, float mult, bool calculate = true) =&gt;\n    var float mean = na\n    var float dev  = na\n    if calculate\n        // Compute the mean and standard deviation of the array.\n        mean := srcArray.avg()\n        dev  := srcArray.stdev() * mult\n    [mean, mean + dev, mean - dev]\n\n// Identify if `n` bars have passed.\nbool newSample = bar_index % n == 0\n\n// Update the queue and compute new BB values on each new sample.\n[sampleMean, highBand, lowBand] = sourceArray.maintainQueue(sourceInput, newSample).calcBB(multiplier, newSample)\n\nplot(sampleMean, \"Basis\", color.orange)\nplot(highBand, \"Upper\", color.lime)\nplot(lowBand, \"Lower\", color.red)</div>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"method-overloading\"><a href=\"#method-overloading\">Method overloading<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>User-defined methods can override and overload existing built-in and\nuser-defined methods with the same identifier. This capability allows\nusers to define multiple routines associated with different parameter\nsignatures under the same method name.</p>\n<p>As a simple example, suppose we want to define a method to identify a\nvariable\u2019s type. Since we must explicitly specify the type of object\nassociated with a user-defined method, we will need to define overloads\nfor each type that we want it to recognize.</p>\n<p>Below, we have defined a <code dir=\"auto\">getType()</code> method that returns a string\nrepresentation of a variable\u2019s type with overloads for the five\nprimitive types:</p>\n<div class=\"pine-colorizer not-content\">// @function   Identifies an object's type.\n// @param this Object to inspect.\n// @returns    (string) A string representation of the type.\nmethod getType(int this) =&gt;\n    na(this) ? \"int(na)\" : \"int\"\n\nmethod getType(float this) =&gt;\n    na(this) ? \"float(na)\" : \"float\"\n\nmethod getType(bool this) =&gt;\n    na(this) ? \"bool(na)\" : \"bool\"\n\nmethod getType(color this) =&gt;\n    na(this) ? \"color(na)\" : \"color\"\n\nmethod getType(string this) =&gt;\n    na(this) ? \"string(na)\" : \"string\"</div>\n<p>Now we can use these overloads to inspect some variables. This script\nuses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nto format the results from calling the <code dir=\"auto\">getType()</code> method on five\ndifferent variables into a single <code dir=\"auto\">results</code> string, then displays the\nstring in the <code dir=\"auto\">lbl</code> label using the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.set_text\">set_text()</a>\nmethod:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"328\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Methods_overloads_type_inspection.BxAK0zpG_2p2qvn.webp\" width=\"1210\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Type Inspection\")\n\n// @function   Identifies an object's type.\n// @param this Object to inspect.\n// @returns    (string) A string representation of the type.\nmethod getType(int this) =&gt;\n    na(this) ? \"int(na)\" : \"int\"\n\nmethod getType(float this) =&gt;\n    na(this) ? \"float(na)\" : \"float\"\n\nmethod getType(bool this) =&gt;\n    na(this) ? \"bool(na)\" : \"bool\"\n\nmethod getType(color this) =&gt;\n    na(this) ? \"color(na)\" : \"color\"\n\nmethod getType(string this) =&gt;\n    na(this) ? \"string(na)\" : \"string\"\n\na = 1\nb = 1.0\nc = true\nd = color.white\ne = \"1\"\n\n// Inspect variables and format results.\nresults = str.format(\n \"a: {0}\\nb: {1}\\nc: {2}\\nd: {3}\\ne: {4}\", \n a.getType(), b.getType(), c.getType(), d.getType(), e.getType()\n )\n\nvar label lbl = label.new(0, 0)\nlbl.set_x(bar_index)\nlbl.set_text(results)</div>\n<p>Note that:</p>\n<ul>\n<li>The underlying type of each variable determines which overload\nof <code dir=\"auto\">getType()</code> the compiler will use.</li>\n<li>The method will append \u201c(na)\u201d to the output string when a\nvariable is <code dir=\"auto\">na</code> to demarcate that it is empty.</li>\n</ul>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/methods", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"advanced-example\"><a href=\"#advanced-example\">Advanced example<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Let\u2019s apply what we\u2019ve learned to construct a script that estimates\nthe cumulative distribution of elements in an array, meaning the\nfraction of elements in the array that are less than or equal to any\ngiven value.</p>\n<p>There are many ways in which we could choose to tackle this objective.\nFor this example, we will start by defining a method to replace elements\nof an array, which will help us count the occurrences of elements within\na range of values.</p>\n<p>Written below is an overload of the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.fill\">fill()</a>\nmethod for <code dir=\"auto\">array&lt;float&gt;</code> instances. This overload replaces elements in\na <code dir=\"auto\">srcArray</code> within the range between the <code dir=\"auto\">lowerBound</code> and <code dir=\"auto\">upperBound</code>\nwith an <code dir=\"auto\">innerValue</code>, and replaces all elements outside the range with\nan <code dir=\"auto\">outerValue</code>:</p>\n<div class=\"pine-colorizer not-content\">// @function          Replaces elements in a `srcArray` between `lowerBound` and `upperBound` with an `innerValue`,\n//                    and replaces elements outside the range with an `outerValue`.\n// @param srcArray    (array&lt;float&gt;) Array to modify.\n// @param innerValue  (float) Value to replace elements within the range with.\n// @param outerValue  (float) Value to replace elements outside the range with.\n// @param lowerBound  (float) Lowest value to replace with `innerValue`.\n// @param upperBound  (float) Highest value to replace with `innerValue`.\n// @returns           (array&lt;float&gt;) `srcArray` object.\nmethod fill(array&lt;float&gt; srcArray, float innerValue, float outerValue, float lowerBound, float upperBound) =&gt;\n    for [i, element] in srcArray\n        if (element &gt;= lowerBound or na(lowerBound)) and (element &lt;= upperBound or na(upperBound))\n            srcArray.set(i, innerValue)\n        else\n            srcArray.set(i, outerValue)\n    srcArray</div>\n<p>With this method, we can filter an array by value ranges to produce an\narray of occurrences. For example, the expression:</p>\n<div class=\"pine-colorizer not-content\">srcArray.copy().fill(1.0, 0.0, min, val)</div>\n<p>copies the <code dir=\"auto\">srcArray</code> object, replaces all elements between <code dir=\"auto\">min</code> and\n<code dir=\"auto\">val</code> with 1.0, then replaces all elements above <code dir=\"auto\">val</code> with 0.0. From\nhere, it\u2019s easy to estimate the output of the cumulative distribution\nfunction at the <code dir=\"auto\">val</code>, as it\u2019s simply the average of the resulting\narray:</p>\n<div class=\"pine-colorizer not-content\">srcArray.copy().fill(1.0, 0.0, min, val).avg()</div>\n<p>Note that:</p>\n<ul>\n<li>The compiler will only use this <code dir=\"auto\">fill()</code> overload instead of the\nbuilt-in when the user provides <code dir=\"auto\">innerValue</code>, <code dir=\"auto\">outerValue</code>,\n<code dir=\"auto\">lowerBound</code>, and <code dir=\"auto\">upperBound</code> arguments in the call.</li>\n<li>If either <code dir=\"auto\">lowerBound</code> or <code dir=\"auto\">upperBound</code> is <code dir=\"auto\">na</code>, its value is\nignored while filtering the fill range.</li>\n<li>We are able to call <code dir=\"auto\">copy()</code>, <code dir=\"auto\">fill()</code>, and <code dir=\"auto\">avg()</code> successively\non the same line of code because the first two methods return an\n<code dir=\"auto\">array&lt;float&gt;</code> instance.</li>\n</ul>\n<p>We can now use this to define a method that will calculate our empirical\ndistribution values. The following <code dir=\"auto\">eCDF()</code> method estimates a number of\nevenly spaced ascending <code dir=\"auto\">steps</code> from the cumulative distribution\nfunction of a <code dir=\"auto\">srcArray</code> and pushes the results into a <code dir=\"auto\">cdfArray</code>:</p>\n<div class=\"pine-colorizer not-content\">// @function       Estimates the empirical CDF of a `srcArray`.\n// @param srcArray (array&lt;float&gt;) Array to calculate on.\n// @param steps    (int) Number of steps in the estimation.\n// @returns        (array&lt;float&gt;) Array of estimated CDF ratios.\nmethod eCDF(array&lt;float&gt; srcArray, int steps) =&gt;\n    float min = srcArray.min()\n    float rng = srcArray.range() / steps\n    array&lt;float&gt; cdfArray = array.new&lt;float&gt;()\n    // Add averages of `srcArray` filtered by value region to the `cdfArray`.\n    float val = min\n    for i = 1 to steps\n        val += rng\n        cdfArray.push(srcArray.copy().fill(1.0, 0.0, min, val).avg())\n    cdfArray</div>\n<p>Lastly, to ensure that our <code dir=\"auto\">eCDF()</code> method functions properly for arrays\ncontaining small and large values, we will define a method to normalize\nour arrays.</p>\n<p>This <code dir=\"auto\">featureScale()</code> method uses array\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">min()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.range\">range()</a>\nmethods to produce a rescaled copy of a <code dir=\"auto\">srcArray</code>. We will use this to\nnormalize our arrays prior to invoking the <code dir=\"auto\">eCDF()</code> method:</p>\n<div class=\"pine-colorizer not-content\">// @function        Rescales the elements within a `srcArray` to the interval [0, 1].\n// @param srcArray  (array&lt;float&gt;) Array to normalize.\n// @returns         (array&lt;float&gt;) Normalized copy of the `srcArray`.\nmethod featureScale(array&lt;float&gt; srcArray) =&gt;\n    float min = srcArray.min()\n    float rng = srcArray.range()\n    array&lt;float&gt; scaledArray = array.new&lt;float&gt;()\n    // Push normalized `element` values into the `scaledArray`.\n    for element in srcArray\n        scaledArray.push((element - min) / rng)\n    scaledArray</div>\n<p>Note that:</p>\n<ul>\n<li>This method does not include special handling for divide by zero\nconditions. If <code dir=\"auto\">rng</code> is 0, the value of the array element will\nbe <code dir=\"auto\">na</code>.</li>\n</ul>\n<p>The full example below queues a <code dir=\"auto\">sourceArray</code> of size <code dir=\"auto\">length</code> with\n<code dir=\"auto\">sourceInput</code> values using our previous <code dir=\"auto\">maintainQueue()</code> method,\nnormalizes the array\u2019s elements using the <code dir=\"auto\">featureScale()</code> method, then\ncalls the <code dir=\"auto\">eCDF()</code> method to get an array of estimates for <code dir=\"auto\">n</code> evenly\nspaced steps on the distribution. The script then calls a user-defined\n<code dir=\"auto\">makeLabel()</code> function to display the estimates and prices in a label on\nthe right side of the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"844\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Methods_empirical_distribution.BdS9hiv6_Z1t1cl8.webp\" width=\"1814\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Empirical Distribution\", overlay = true)\n\nfloat sourceInput = input.source(close, \"Source\")\nint length        = input.int(20, \"Length\")\nint n             = input.int(20, \"Steps\")\n\n// @function         Maintains a queue of the size of `srcArray`. \n//                   It appends a `value` to the array and removes its oldest element at position zero.\n// @param srcArray   (array&lt;float&gt;) The array where the queue is maintained.\n// @param value      (float) The new value to be added to the queue. \n//                   The queue's oldest value is also removed, so its size is constant.\n// @param takeSample (bool) A new `value` is only pushed into the queue if this is true.\n// @returns          (array&lt;float&gt;) `srcArray` object.\nmethod maintainQueue(array&lt;float&gt; srcArray, float value, bool takeSample = true) =&gt;\n    if takeSample\n        srcArray.push(value)\n        srcArray.shift()\n    srcArray\n\n// @function          Replaces elements in a `srcArray` between `lowerBound` and `upperBound` with an `innerValue`,\n//                    and replaces elements outside the range with an `outerValue`.\n// @param srcArray    (array&lt;float&gt;) Array to modify.\n// @param innerValue  (float) Value to replace elements within the range with.\n// @param outerValue  (float) Value to replace elements outside the range with.\n// @param lowerBound  (float) Lowest value to replace with `innerValue`.\n// @param upperBound  (float) Highest value to replace with `innerValue`.\n// @returns           (array&lt;float&gt;) `srcArray` object.\nmethod fill(array&lt;float&gt; srcArray, float innerValue, float outerValue, float lowerBound, float upperBound) =&gt;\n    for [i, element] in srcArray\n        if (element &gt;= lowerBound or na(lowerBound)) and (element &lt;= upperBound or na(upperBound))\n            srcArray.set(i, innerValue)\n        else\n            srcArray.set(i, outerValue)\n    srcArray\n\n// @function       Estimates the empirical CDF of a `srcArray`.\n// @param srcArray (array&lt;float&gt;) Array to calculate on.\n// @param steps    (int) Number of steps in the estimation.\n// @returns        (array&lt;float&gt;) Array of estimated CDF ratios.\nmethod eCDF(array&lt;float&gt; srcArray, int steps) =&gt;\n    float min = srcArray.min()\n    float rng = srcArray.range() / steps\n    array&lt;float&gt; cdfArray = array.new&lt;float&gt;()\n    // Add averages of `srcArray` filtered by value region to the `cdfArray`.\n    float val = min\n    for i = 1 to steps\n        val += rng\n        cdfArray.push(srcArray.copy().fill(1.0, 0.0, min, val).avg())\n    cdfArray\n\n// @function        Rescales the elements within a `srcArray` to the interval [0, 1].\n// @param srcArray  (array&lt;float&gt;) Array to normalize.\n// @returns         (array&lt;float&gt;) Normalized copy of the `srcArray`.\nmethod featureScale(array&lt;float&gt; srcArray) =&gt;\n    float min = srcArray.min()\n    float rng = srcArray.range()\n    array&lt;float&gt; scaledArray = array.new&lt;float&gt;()\n    // Push normalized `element` values into the `scaledArray`.\n    for element in srcArray\n        scaledArray.push((element - min) / rng)\n    scaledArray\n\n// @function        Draws a label containing eCDF estimates in the format \"{price}: {percent}%\" \n// @param srcArray  (array&lt;float&gt;) Array of source values.\n// @param cdfArray  (array&lt;float&gt;) Array of CDF estimates.\n// @returns         (void)\nmakeLabel(array&lt;float&gt; srcArray, array&lt;float&gt; cdfArray) =&gt;\n    float max      = srcArray.max()\n    float rng      = srcArray.range() / cdfArray.size()\n    string results = \"\"\n    var label lbl  = label.new(0, 0, \"\", style = label.style_label_left, text_font_family = font.family_monospace)\n    // Add percentage strings to `results` starting from the `max`.\n    cdfArray.reverse()\n    for [i, element] in cdfArray\n        results += str.format(\"{0}: {1}%\\n\", max - i * rng, element * 100)\n    // Update `lbl` attributes.\n    lbl.set_xy(bar_index + 1, srcArray.avg())\n    lbl.set_text(results)\n\nvar array&lt;float&gt; sourceArray = array.new&lt;float&gt;(length)\n\n// Add background color for the last `length` bars.\nbgcolor(bar_index &gt; last_bar_index - length ? color.new(color.orange, 80) : na)\n\n// Queue `sourceArray`, feature scale, then estimate the distribution over `n` steps.\narray&lt;float&gt; distArray = sourceArray.maintainQueue(sourceInput).featureScale().eCDF(n)\n// Draw label.\nmakeLabel(sourceArray, distArray)</div>", "segment_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "af61c66ab127ac434c8636085b84d523bc15a8e3ea90e703997b6608332c7cc0", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/objects\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"objects\"><a href=\"#objects\">Objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This page contains advanced material. If you are a beginning Pine\nScript\u00ae programmer, we recommend you become familiar with other, more\naccessible Pine Script features before you venture here.</p></div></aside>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script objects are instances of <em>user-defined types</em> (UDTs). They\nare the equivalent of variables containing parts called <em>fields</em>, each\nable to hold independent values that can be of various types.</p>\n<p>Experienced programmers can think of UDTs as methodless classes. They\nallow users to create custom types that organize different values under\none logical entity.</p>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"creating-objects\"><a href=\"#creating-objects\">Creating objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Before an object can be created, its type must be defined. The\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">User-defined types</a> section of the\n<a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a> page\nexplains how to do so.</p>\n<p>Let\u2019s define a <code dir=\"auto\">pivotPoint</code> type to hold pivot information:</p>\n<div class=\"pine-colorizer not-content\">type pivotPoint\n    int x\n    float y\n    string xloc = xloc.bar_time</div>\n<p>Note that:</p>\n<ul>\n<li>We use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a>\nkeyword to declare the creation of a UDT.</li>\n<li>We name our new UDT <code dir=\"auto\">pivotPoint</code>.</li>\n<li>After the first line, we create a local block containing the type\nand name of each field.</li>\n<li>The <code dir=\"auto\">x</code> field will hold the x-coordinate of the pivot. It is\ndeclared as an \u201cint\u201d because it will hold either a timestamp or a\nbar index of \u201cint\u201d type.</li>\n<li><code dir=\"auto\">y</code> is a \u201cfloat\u201d because it will hold the pivot\u2019s price.</li>\n<li><code dir=\"auto\">xloc</code> is a field that will specify the units of <code dir=\"auto\">x</code>:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_index\">xloc.bar_index</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>.\nWe set its default value to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>\nby using the <code dir=\"auto\">=</code> operator. When an object is created from that UDT,\nits <code dir=\"auto\">xloc</code> field will thus be set to that value.</li>\n</ul>\n<p>Now that our <code dir=\"auto\">pivotPoint</code> UDT is defined, we can proceed to create\nobjects from it. We create objects using the UDT\u2019s <code dir=\"auto\">new()</code> built-in\nmethod. To create a new <code dir=\"auto\">foundPoint</code> object from our <code dir=\"auto\">pivotPoint</code> UDT,\nwe use:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new()</div>\n<p>We can also specify field values for the created object using the\nfollowing:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new(time, high)</div>\n<p>Or the equivalent:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new(x = time, y = high)</div>\n<p>At this point, the <code dir=\"auto\">foundPoint</code> object\u2019s <code dir=\"auto\">x</code> field will contain the\nvalue of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nbuilt-in when it is created, <code dir=\"auto\">y</code> will contain the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand the <code dir=\"auto\">xloc</code> field will contain its default value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_xloc%7Bdot%7Dbar_time\">xloc.bar_time</a>\nbecause no value was defined for it when creating the object.</p>\n<p>Object placeholders can also be created by declaring\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nobject names using the following:</p>\n<div class=\"pine-colorizer not-content\">pivotPoint foundPoint = na</div>\n<p>This example displays a label where high pivots are detected. The pivots\nare detected <code dir=\"auto\">legsInput</code> bars after they occur, so we must plot the\nlabel in the past for it to appear on the pivot:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pivot labels\", overlay = true)\nint legsInput = input(10)\n\n// Define the `pivotPoint` UDT.\ntype pivotPoint\n    int x\n    float y\n    string xloc = xloc.bar_time\n\n// Detect high pivots.\npivotHighPrice = ta.pivothigh(legsInput, legsInput)\nif not na(pivotHighPrice)\n    // A new high pivot was found; display a label where it occurred `legsInput` bars back.\n    foundPoint = pivotPoint.new(time[legsInput], pivotHighPrice)\n    label.new(\n      foundPoint.x,\n      foundPoint.y,\n      str.tostring(foundPoint.y, format.mintick),\n      foundPoint.xloc,\n      textcolor = color.white)</div>\n<p>Take note of this line from the above example:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new(time[legsInput], pivotHighPrice)</div>\n<p>This could also be written using the following:</p>\n<div class=\"pine-colorizer not-content\">pivotPoint foundPoint = na\nfoundPoint := pivotPoint.new(time[legsInput], pivotHighPrice)</div>\n<p>When using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword while declaring a variable assigned to an object of a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a>, the keyword automatically applies to all the object\u2019s\nfields:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Objects using `var` demo\")\n\n//@type A custom type to hold index, price, and volume information.\ntype BarInfo\n    int   index = bar_index\n    float price = close\n    float vol   = volume\n\n//@variable A `BarInfo` instance whose fields persist through all iterations, starting from the first bar.\nvar BarInfo firstBar = BarInfo.new()\n//@variable A `BarInfo` instance declared on every bar.\nBarInfo currentBar = BarInfo.new()\n\n// Plot the `index` fields of both instances to compare the difference. \nplot(firstBar.index)\nplot(currentBar.index)</div>\n<p>It\u2019s important to note that assigning an object to a variable that uses\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeyword does <em>not</em> automatically allow the object\u2019s fields to persist\nwithout rolling back on each <em>intrabar</em> update. One must apply the\nkeyword to each desired field in the type declaration to achieve this\nbehavior. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Objects using `varip` fields demo\")\n\n//@type A custom type that counts the bars and ticks in the script's execution.\ntype Counter\n    int       bars  = 0\n    varip int ticks = 0\n\n//@variable A `Counter` object whose reference persists throughout all bars.\nvar Counter counter = Counter.new()\n\n// Add 1 to the `bars` and `ticks` fields. The `ticks` field is not subject to rollback on unconfirmed bars.\ncounter.bars  += 1\ncounter.ticks += 1\n\n// Plot both fields for comparison. \nplot(counter.bars, \"Bar counter\", color.blue, 3)\nplot(counter.ticks, \"Tick counter\", color.purple, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>We used the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to specify that the <code dir=\"auto\">Counter</code> object assigned to the\n<code dir=\"auto\">counter</code> variable persists throughout the script\u2019s execution.</li>\n<li>The <code dir=\"auto\">bars</code> field rolls back on realtime bars, whereas the\n<code dir=\"auto\">ticks</code> field does not since we included\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nin its declaration.</li>\n</ul>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"changing-field-values\"><a href=\"#changing-field-values\">Changing field values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The value of an object\u2019s fields can be changed using the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a>\nreassignment operator.</p>\n<p>This line of our previous example:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new(time[legsInput], pivotHighPrice)</div>\n<p>Could be written using the following:</p>\n<div class=\"pine-colorizer not-content\">foundPoint = pivotPoint.new()\nfoundPoint.x := time[legsInput]\nfoundPoint.y := pivotHighPrice</div>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"collecting-objects\"><a href=\"#collecting-objects\">Collecting objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script collections (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) can contain\nobjects, allowing users to add virtual dimensions to their data\nstructures. To declare a collection of objects, pass a UDT name into its\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a>.</p>\n<p>This example declares an empty\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nthat will hold objects of a <code dir=\"auto\">pivotPoint</code> user-defined type:</p>\n<div class=\"pine-colorizer not-content\">pivotHighArray = array.new&lt;pivotPoint&gt;()</div>\n<p>To explicitly declare the type of a variable as an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>,\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nof a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a>, use the collection\u2019s type keyword followed by its\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a>. For example:</p>\n<div class=\"pine-colorizer not-content\">var array&lt;pivotPoint&gt; pivotHighArray = na\npivotHighArray := array.new&lt;pivotPoint&gt;()</div>\n<p>Let\u2019s use what we have learned to create a script that detects high\npivot points. The script first collects historical pivot information in\nan\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.\nIt then loops through the array on the last historical bar, creating a\nlabel for each pivot and connecting the pivots with lines:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"952\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Objects-CollectingObjects-1.Or5ovJGC_Zw2Kvh.webp\" width=\"2018\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pivot Points High\", overlay = true)\n\nint legsInput = input(10)\n\n// Define the `pivotPoint` UDT containing the time and price of pivots.\ntype pivotPoint\n    int openTime\n    float level\n\n// Create an empty `pivotPoint` array.\nvar pivotHighArray = array.new&lt;pivotPoint&gt;()\n\n// Detect new pivots (`na` is returned when no pivot is found).\npivotHighPrice = ta.pivothigh(legsInput, legsInput)\n\n// Add a new `pivotPoint` object to the end of the array for each detected pivot.\nif not na(pivotHighPrice)\n    // A new pivot is found; create a new object of `pivotPoint` type, setting its `openTime` and `level` fields.\n    newPivot = pivotPoint.new(time[legsInput], pivotHighPrice)\n    // Add the new pivot object to the array.\n    array.push(pivotHighArray, newPivot)\n\n// On the last historical bar, draw pivot labels and connecting lines.\nif barstate.islastconfirmedhistory\n    var pivotPoint previousPoint = na\n    for eachPivot in pivotHighArray\n        // Display a label at the pivot point.\n        label.new(eachPivot.openTime, eachPivot.level, str.tostring(eachPivot.level, format.mintick), xloc.bar_time, textcolor = color.white)\n        // Create a line between pivots.\n        if not na(previousPoint)\n            // Only create a line starting at the loop's second iteration because lines connect two pivots.\n            line.new(previousPoint.openTime, previousPoint.level, eachPivot.openTime, eachPivot.level, xloc = xloc.bar_time)\n        // Save the pivot for use in the next iteration.\n        previousPoint := eachPivot</div>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"copying-objects\"><a href=\"#copying-objects\">Copying objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine, objects are assigned by reference. When an existing object is\nassigned to a new variable, both point to the same object.</p>\n<p>In the example below, we create a <code dir=\"auto\">pivot1</code> object and set its <code dir=\"auto\">x</code> field\nto 1000. Then, we declare a <code dir=\"auto\">pivot2</code> variable containing the reference\nto the <code dir=\"auto\">pivot1</code> object, so both point to the same instance. Changing\n<code dir=\"auto\">pivot2.x</code> will thus also change <code dir=\"auto\">pivot1.x</code>, as both refer to the <code dir=\"auto\">x</code>\nfield of the same object:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\ntype pivotPoint\n    int x\n    float y\npivot1 = pivotPoint.new()\npivot1.x := 1000\npivot2 = pivot1\npivot2.x := 2000\n// Both plot the value 2000.\nplot(pivot1.x)\nplot(pivot2.x)</div>\n<p>To create a copy of an object that is independent of the original, we\ncan use the built-in <code dir=\"auto\">copy()</code> method in this case.</p>\n<p>In this example, we declare the <code dir=\"auto\">pivot2</code> variable referring to a copied\ninstance of the <code dir=\"auto\">pivot1</code> object. Now, changing <code dir=\"auto\">pivot2.x</code> will not\nchange <code dir=\"auto\">pivot1.x</code>, as it refers to the <code dir=\"auto\">x</code> field of a separate object:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\ntype pivotPoint\n    int x\n    float y\npivot1 = pivotPoint.new()\npivot1.x := 1000\npivot2 = pivotPoint.copy(pivot1)\npivot2.x := 2000\n// Plots 1000 and 2000.\nplot(pivot1.x)\nplot(pivot2.x)</div>\n<p>It\u2019s important to note that the built-in <code dir=\"auto\">copy()</code> method produces a\n<em>shallow copy</em> of an object. If an object has fields with <em>special\ntypes</em>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>),\nthose fields in a shallow copy of the object will point to the same\ninstances as the original.</p>\n<p>In the following example, we have defined an <code dir=\"auto\">InfoLabel</code> type with a\nlabel as one of its fields. The script instantiates a <code dir=\"auto\">shallow</code> copy of\nthe <code dir=\"auto\">parent</code> object, then calls a user-defined <code dir=\"auto\">set()</code>\n<a href=\"/pine-script-docs/v5/language/methods/\">method</a> to update the\n<code dir=\"auto\">info</code> and <code dir=\"auto\">lbl</code> fields of each object. Since the <code dir=\"auto\">lbl</code> field of both\nobjects points to the same label instance, changes to this field in\neither object affect the other:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shallow Copy\")\n\ntype InfoLabel\n    string info\n    label  lbl\n\nmethod set(InfoLabel this, int x = na, int y = na, string info = na) =&gt;\n    if not na(x)\n        this.lbl.set_x(x)\n    if not na(y)\n        this.lbl.set_y(y)\n    if not na(info)\n        this.info := info\n        this.lbl.set_text(this.info)\n\nvar parent  = InfoLabel.new(\"\", label.new(0, 0))\nvar shallow = parent.copy()\n\nparent.set(bar_index, 0, \"Parent\")\nshallow.set(bar_index, 1, \"Shallow Copy\")</div>\n<p>To produce a <em>deep copy</em> of an object with all of its special type\nfields pointing to independent instances, we must explicitly copy those\nfields as well.</p>\n<p>In this example, we have defined a <code dir=\"auto\">deepCopy()</code> method that instantiates\na new <code dir=\"auto\">InfoLabel</code> object with its <code dir=\"auto\">lbl</code> field pointing to a copy of the\noriginal\u2019s field. Changes to the <code dir=\"auto\">deep</code> copy\u2019s <code dir=\"auto\">lbl</code> field will not\naffect the <code dir=\"auto\">parent</code> object, as it points to a separate instance:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Deep Copy\")\n\ntype InfoLabel\n    string info\n    label  lbl\n\nmethod set(InfoLabel this, int x = na, int y = na, string info = na) =&gt;\n    if not na(x)\n        this.lbl.set_x(x)\n    if not na(y)\n        this.lbl.set_y(y)\n    if not na(info)\n        this.info := info\n        this.lbl.set_text(this.info)\n\nmethod deepCopy(InfoLabel this) =&gt;\n    InfoLabel.new(this.info, this.lbl.copy())\n\nvar parent = InfoLabel.new(\"\", label.new(0, 0))\nvar deep   = parent.deepCopy()\n\nparent.set(bar_index, 0, \"Parent\")\ndeep.set(bar_index, 1, \"Deep Copy\")</div>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/objects", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"shadowing\"><a href=\"#shadowing\">Shadowing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To avoid potential conflicts in the eventuality where namespaces added\nto Pine Script in the future would collide with UDTs or object names in\nexisting scripts; as a rule, UDTs and object names shadow the\nlanguage\u2019s namespaces. For example, a UDT or object can use the name of\nbuilt-in types, such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>.</p>\n<p>Only the language\u2019s five primitive types cannot be used to name UDTs or\nobjects:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_string\">string</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_bool\">bool</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_color\">color</a>.</p>", "segment_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "d54e85ff4fbe1454abde24238380d9d030a32cbb82ab1197edb51239abd7804b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/operators\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"operators\"><a href=\"#operators\">Operators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Some operators are used to build <em>expressions</em> returning a result:</p>\n<ul>\n<li>Arithmetic operators</li>\n<li>Comparison operators</li>\n<li>Logical operators</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%7Bquestion%7D%7Bcolon%7D\">?:</a>\nternary operator</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nhistory-referencing operator</li>\n</ul>\n<p>Other operators are used to assign values to variables:</p>\n<ul>\n<li><code dir=\"auto\">=</code> is used to assign a value to a variable, <strong>but only when you\ndeclare the variable</strong> (the first time you use it)</li>\n<li><code dir=\"auto\">:=</code> is used to assign a value to a <strong>previously declared\nvariable</strong>. The following operators can also be used in such a way:\n<code dir=\"auto\">+=</code>, <code dir=\"auto\">-=</code>, <code dir=\"auto\">*=</code>, <code dir=\"auto\">/=</code>, <code dir=\"auto\">%=</code></li>\n</ul>\n<p>As is explained in the <a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a> page, <em>qualifiers</em> and <em>types</em> play a critical role in\ndetermining the type of results that expressions yield. This, in turn,\nhas an impact on how and with what functions you will be allowed to use\nthose results. Expressions always return a value with the strongest\nqualifier used in the expression, e.g., if you multiply an \u201cinput int\u201d\nwith a \u201cseries int\u201d, the expression will produce a \u201cseries int\u201d\nresult, which you will not be able to use as the argument to <code dir=\"auto\">length</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>.</p>\n<p>This script will produce a compilation error:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nlenInput = input.int(14, \"Length\")\nfactor = year &gt; 2020 ? 3 : 1\nadjustedLength = lenInput * factor\nma = ta.ema(close, adjustedLength)  // Compilation error!\nplot(ma)</div>\n<p>The compiler will complain: <em>Cannot call \u2018ta.ema\u2019 with argument\n\u2018length\u2019=\u2018adjustedLength\u2019. An argument of \u2018series int\u2019 type was\nused but a \u2018simple int\u2019 is expected;</em>. This is happening because\n<code dir=\"auto\">lenInput</code> is an \u201cinput int\u201d but <code dir=\"auto\">factor</code> is a \u201cseries int\u201d (it can\nonly be determined by looking at the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_year\">year</a>\non each bar). The <code dir=\"auto\">adjustedLength</code> variable is thus assigned a \u201cseries\nint\u201d value. Our problem is that the Reference Manual entry for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>\ntells us that its <code dir=\"auto\">length</code> parameter requires a \u201csimple\u201d value, which\nis a weaker qualifier than \u201cseries\u201d, so a \u201cseries int\u201d value is not\nallowed.</p>\n<p>The solution to our conundrum requires:</p>\n<ul>\n<li>Using another moving average function that supports a \u201cseries int\u201d\nlength, such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>,\nor</li>\n<li>Not using a calculation producing a \u201cseries int\u201d value for our\nlength.</li>\n</ul>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"arithmetic-operators\"><a href=\"#arithmetic-operators\">Arithmetic operators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are five arithmetic operators in Pine Script\u00ae:</p>\n<table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code dir=\"auto\">+</code></td><td>Addition and string concatenation</td></tr><tr><td><code dir=\"auto\">-</code></td><td>Subtraction</td></tr><tr><td><code dir=\"auto\">*</code></td><td>Multiplication</td></tr><tr><td><code dir=\"auto\">/</code></td><td>Division</td></tr><tr><td><code dir=\"auto\">%</code></td><td>Modulo (remainder after division)</td></tr></tbody></table>\n<p>The arithmetic operators above are all binary (means they need two\n<em>operands</em> \u2014 or values \u2014 to work on, like in <code dir=\"auto\">1 + 2</code>). The <code dir=\"auto\">+</code> and\n<code dir=\"auto\">-</code> also serve as unary operators (means they work on one operand, like\n<code dir=\"auto\">-1</code> or <code dir=\"auto\">+1</code>).</p>\n<p>If both operands are numbers but at least one of these is of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\ntype, the result will also be a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>.\nIf both operands are of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\ntype, the result will also be an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>.\nIf at least one operand is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, the\nresult is also\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>The <code dir=\"auto\">+</code> operator also serves as the concatenation operator for strings.\n<code dir=\"auto\">\"EUR\"+\"USD\"</code> yields the <code dir=\"auto\">\"EURUSD\"</code> string.</p>\n<p>The <code dir=\"auto\">%</code> operator calculates the modulo by rounding down the quotient to\nthe lowest possible value. Here is an easy example that helps illustrate\nhow the modulo is calculated behind the scenes:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Modulo function\")\nmodulo(series int a, series int b) =&gt;\n    a - b * math.floor(nz(a/b))\nplot(modulo(-1, 100))</div>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"comparison-operators\"><a href=\"#comparison-operators\">Comparison operators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are six comparison operators in Pine Script:</p>\n<table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code dir=\"auto\">&lt;</code></td><td>Less Than</td></tr><tr><td><code dir=\"auto\">&lt;=</code></td><td>Less Than or Equal To</td></tr><tr><td><code dir=\"auto\">!=</code></td><td>Not Equal</td></tr><tr><td><code dir=\"auto\">==</code></td><td>Equal</td></tr><tr><td><code dir=\"auto\">&gt;</code></td><td>Greater Than</td></tr><tr><td><code dir=\"auto\">&gt;=</code></td><td>Greater Than or Equal To</td></tr></tbody></table>\n<p>Comparison operations are binary. If both operands have a numerical\nvalue, the result will be of type <em>bool</em>, i.e., <code dir=\"auto\">true</code>, <code dir=\"auto\">false</code> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>Examples:</p>\n<div class=\"pine-colorizer not-content\">1 &gt; 2  // false\n1 != 1 // false\nclose &gt;= open  // Depends on values of `close` and `open`</div>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"logical-operators\"><a href=\"#logical-operators\">Logical operators<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There are three logical operators in Pine Script:</p>\n<table><thead><tr><th>Operator</th><th>Meaning</th></tr></thead><tbody><tr><td><code dir=\"auto\">not</code></td><td>Negation</td></tr><tr><td><code dir=\"auto\">and</code></td><td>Logical Conjunction</td></tr><tr><td><code dir=\"auto\">or</code></td><td>Logical Disjunction</td></tr></tbody></table>\n<p>The operator <code dir=\"auto\">not</code> is unary. When applied to a <code dir=\"auto\">true</code>, operand the\nresult will be <code dir=\"auto\">false</code>, and vice versa.</p>\n<p><code dir=\"auto\">and</code> operator truth table:</p>\n<table><thead><tr><th>a</th><th>b</th><th>a and b</th></tr></thead><tbody><tr><td>true</td><td>true</td><td>true</td></tr><tr><td>true</td><td>false</td><td>false</td></tr><tr><td>false</td><td>true</td><td>false</td></tr><tr><td>false</td><td>false</td><td>false</td></tr></tbody></table>\n<p><code dir=\"auto\">or</code> operator truth table:</p>\n<table><thead><tr><th>a</th><th>b</th><th>a or b</th></tr></thead><tbody><tr><td>true</td><td>true</td><td>true</td></tr><tr><td>true</td><td>false</td><td>true</td></tr><tr><td>false</td><td>true</td><td>true</td></tr><tr><td>false</td><td>false</td><td>false</td></tr></tbody></table>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"-ternary-operator\"><a href=\"#-ternary-operator\"><span>\u200b<code dir=\"auto\">?:</code>\u200b ternary operator</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%7Bquestion%7D%7Bcolon%7D\">?:</a>\nternary operator is used to create expressions of the form:</p>\n<div class=\"pine-colorizer not-content\">condition ? valueWhenConditionIsTrue : valueWhenConditionIsFalse</div>\n<p>The ternary operator returns a result that depends on the value of\n<code dir=\"auto\">condition</code>. If it is <code dir=\"auto\">true</code>, then <code dir=\"auto\">valueWhenConditionIsTrue</code> is\nreturned. If <code dir=\"auto\">condition</code> is <code dir=\"auto\">false</code> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, then\n<code dir=\"auto\">valueWhenConditionIsFalse</code> is returned.</p>\n<p>A combination of ternary expressions can be used to achieve the same\neffect as a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure, e.g.:</p>\n<div class=\"pine-colorizer not-content\">timeframe.isintraday ? color.red : timeframe.isdaily ? color.green : timeframe.ismonthly ? color.blue : na</div>\n<p>The example is calculated from left to right:</p>\n<ul>\n<li>If\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disintraday\">timeframe.isintraday</a>\nis <code dir=\"auto\">true</code>, then <code dir=\"auto\">color.red</code> is returned. If it is <code dir=\"auto\">false</code>, then\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdaily\">timeframe.isdaily</a>\nis evaluated.</li>\n<li>If\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Disdaily\">timeframe.isdaily</a>\nis <code dir=\"auto\">true</code>, then <code dir=\"auto\">color.green</code> is returned. If it is <code dir=\"auto\">false</code>, then\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dismonthly\">timeframe.ismonthly</a>\nis evaluated.</li>\n<li>If\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe%7Bdot%7Dismonthly\">timeframe.ismonthly</a>\nis <code dir=\"auto\">true</code>, then <code dir=\"auto\">color.blue</code> is returned, otherwise\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nis returned.</li>\n</ul>\n<p>Note that the return values on each side of the <code dir=\"auto\">:</code> are expressions ---\nnot local blocks, so they will not affect the limit of 500 local blocks\nper scope.</p>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"-history-referencing-operator\"><a href=\"#-history-referencing-operator\"><span>\u200b<code dir=\"auto\">[]</code>\u200b history-referencing operator</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>It is possible to refer to past values of\n<a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nhistory-referencing operator. Past values are values a variable had on\nbars preceding the bar where the script is currently executing \u2014 the\n<em>current bar</em>. See the\n<a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>\npage for more information about the way scripts are executed on bars.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator is used after a variable, expression or function call. The\nvalue used inside the square brackets of the operator is the offset in\nthe past we want to refer to. To refer to the value of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nbuilt-in variable two bars away from the current bar, one would use\n<code dir=\"auto\">volume[2]</code>.</p>\n<p>Because series grow dynamically, as the script moves on sucessive bars,\nthe offset used with the operator will refer to different bars. Let\u2019s\nsee how the value returned by the same offset is dynamic, and why series\nare very different from arrays. In Pine Script, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvariable, or <code dir=\"auto\">close[0]</code> which is equivalent, holds the value of the\ncurrent bar\u2019s \u201cclose\u201d. If your code is now executing on the <strong>third</strong>\nbar of the <em>dataset</em> (the set of all bars on your chart), <code dir=\"auto\">close</code> will\ncontain the price at the close of that bar, <code dir=\"auto\">close[1]</code> will contain the\nprice at the close of the preceding bar (the dataset\u2019s second bar), and\n<code dir=\"auto\">close[2]</code>, the first bar. <code dir=\"auto\">close[3]</code> will return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nbecause no bar exists in that position, and thus its value is <em>not\navailable</em>.</p>\n<p>When the same code is executed on the next bar, the <strong>fourth</strong> in the\ndataset, <code dir=\"auto\">close</code> will now contain the closing price of that bar, and the\nsame <code dir=\"auto\">close[1]</code> used in your code will now refer to the \u201cclose\u201d of the\nthird bar in the dataset. The close of the first bar in the dataset will\nnow be <code dir=\"auto\">close[3]</code>, and this time <code dir=\"auto\">close[4]</code> will return\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.</p>\n<p>In the Pine Script runtime environment, as your code is executed once\nfor each historical bar in the dataset, starting from the left of the\nchart, Pine Script is adding a new element in the series at index 0 and\npushing the pre-existing elements in the series one index further away.\nArrays, in comparison, can have constant or variable sizes, and their\ncontent or indexing structure is not modified by the runtime\nenvironment. Pine Script series are thus very different from arrays and\nonly share familiarity with them through their indexing syntax.</p>\n<p>When the market for the chart\u2019s symbol is open and the script is\nexecuting on the chart\u2019s last bar, the <em>realtime bar</em>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nreturns the value of the current price. It will only contain the actual\nclosing price of the realtime bar the last time the script is executed\non that bar, when it closes.</p>\n<p>Pine Script has a variable that contains the number of the bar the\nscript is executing on:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.\nOn the first bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nis equal to 0 and it increases by 1 on each successive bar the script\nexecutes on. On the last bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nis equal to the number of bars in the dataset minus one.</p>\n<p>There is another important consideration to keep in mind when using the\n<code dir=\"auto\">[]</code> operator in Pine Script. We have seen cases when a history\nreference may return the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalue.\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nrepresents a value which is not a number and using it in any expression\nwill produce a result that is also\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\n(similar to <a href=\"https://en.wikipedia.org/wiki/NaN\" rel=\"nofollow\">NaN</a>). Such cases often\nhappen during the script\u2019s calculations in the early bars of the\ndataset, but can also occur in later bars under certain conditions. If\nyour code does not explicitly provide for handling these special cases,\nthey can introduce invalid results in your script\u2019s calculations which\ncan ripple through all the way to the realtime bar. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_na\">na</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz</a>\nfunctions are designed to allow for handling such cases.</p>\n<p>These are all valid uses of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator:</p>\n<div class=\"pine-colorizer not-content\">high[10]\nta.sma(close, 10)[1]\nta.highest(high, 10)[20]\nclose &gt; nz(close[1], open)</div>\n<p>Note that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator can only be used once on the same value. This is not allowed:</p>\n<div class=\"pine-colorizer not-content\">close[1][2] // Error: incorrect use of [] operator</div>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"operator-precedence\"><a href=\"#operator-precedence\">Operator precedence<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The order of calculations is determined by the operators\u2019 precedence.\nOperators with greater precedence are calculated first. Below is a list\nof operators sorted by decreasing precedence:</p>\n<table><thead><tr><th>Precedence</th><th>Operator</th></tr></thead><tbody><tr><td>9</td><td><code dir=\"auto\">[]</code></td></tr><tr><td>8</td><td>unary <code dir=\"auto\">+</code>, unary <code dir=\"auto\">-</code>, <code dir=\"auto\">not</code></td></tr><tr><td>7</td><td><code dir=\"auto\">*</code>, <code dir=\"auto\">/</code>, <code dir=\"auto\">%</code></td></tr><tr><td>6</td><td><code dir=\"auto\">+</code>, <code dir=\"auto\">-</code></td></tr><tr><td>5</td><td><code dir=\"auto\">&gt;</code>, <code dir=\"auto\">&lt;</code>, <code dir=\"auto\">&gt;=</code>, <code dir=\"auto\">&lt;=</code></td></tr><tr><td>4</td><td><code dir=\"auto\">==</code>, <code dir=\"auto\">!=</code></td></tr><tr><td>3</td><td><code dir=\"auto\">and</code></td></tr><tr><td>2</td><td><code dir=\"auto\">or</code></td></tr><tr><td>1</td><td><code dir=\"auto\">?:</code></td></tr></tbody></table>\n<p>If in one expression there are several operators with the same\nprecedence, then they are calculated left to right.</p>\n<p>If the expression must be calculated in a different order than\nprecedence would dictate, then parts of the expression can be grouped\ntogether with parentheses.</p>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"-assignement-operator\"><a href=\"#-assignement-operator\"><span>\u200b<code dir=\"auto\">=</code>\u200b assignement operator</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">=</code> operator is used to assign a variable when it is initialized ---\nor declared ---, i.e., the first time you use it. It says <em>this is a new\nvariable that I will be using, and I want it to start on each bar with\nthis value</em>.</p>\n<p>These are all valid variable declarations:</p>\n<div class=\"pine-colorizer not-content\">i = 1\nMS_IN_ONE_MINUTE = 1000 * 60\nshowPlotInput = input.bool(true, \"Show plots\")\npHi = pivothigh(5, 5)\nplotColor = color.green</div>\n<p>See the\n<a href=\"/pine-script-docs/v5/language/variable-declarations/\">Variable declarations</a> page for more information on how to declare variables.</p>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/operators", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"-reassignment-operator\"><a href=\"#-reassignment-operator\"><span>\u200b<code dir=\"auto\">:=</code>\u200b reassignment operator</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">:=</code> is used to <em>reassign</em> a value to an existing variable. It says\n<em>use this variable that was declared earlier in my script, and give it a\nnew value</em>.</p>\n<p>Variables which have been first declared, then reassigned using <code dir=\"auto\">:=</code>,\nare called <em>mutable</em> variables. All the following examples are valid\nvariable reassignments. You will find more information on how\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nworks in the section on the\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#var\">`var` declaration mode</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\n// Declare `pHi` and initilize it on the first bar only.\nvar float pHi = na\n// Reassign a value to `pHi`\npHi := nz(ta.pivothigh(5, 5), pHi)\nplot(pHi)</div>\n<p>Note that:</p>\n<ul>\n<li>We declare <code dir=\"auto\">pHi</code> with this code: <code dir=\"auto\">var float pHi = na</code>. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword tells Pine Script that we only want that variable\ninitialized with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\non the dataset\u2019s first bar. The <code dir=\"auto\">float</code> keyword tells the compiler\nwe are declaring a variable of type \u201cfloat\u201d. This is necessary\nbecause, contrary to most cases, the compiler cannot automatically\ndetermine the type of the value on the right side of the <code dir=\"auto\">=</code> sign.</li>\n<li>While the variable declaration will only be executed on the first\nbar because it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>,\nthe <code dir=\"auto\">pHi := nz(ta.pivothigh(5, 5), pHi)</code> line will be executed on\nall the chart\u2019s bars. On each bar, it evaluates if the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">pivothigh()</a>\ncall returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nbecause that is what the function does when it hasn\u2019t found a new\npivot. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a>\nfunction is the one doing the \u201cchecking for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\u201d\npart. When its first argument (<code dir=\"auto\">ta.pivothigh(5, 5)</code>) is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nit returns the second argument (<code dir=\"auto\">pHi</code>) instead of the first. When\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivothigh\">pivothigh()</a>\nreturns the price point of a newly found pivot, that value is\nassigned to <code dir=\"auto\">pHi</code>. When it returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nbecause no new pivot was found, we assign the previous value of\n<code dir=\"auto\">pHi</code> to itself, in effect preserving its previous value.</li>\n</ul>\n<p>The output of our script looks like this:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"476\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Operators-ReassignmentOperator-1.D7pw1mZ8_Z2fUVUR.webp\" width=\"1402\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The line preserves its previous value until a new pivot is found.</li>\n<li>Pivots are detected five bars after the pivot actually occurs\nbecause our <code dir=\"auto\">ta.pivothigh(5, 5)</code> call says that we require five\nlower highs on both sides of a high point for it to be detected as a\npivot.</li>\n</ul>\n<p>See the\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#variable-reassignment\">Variable reassignment</a> section for more information on how to reassign values to\nvariables.</p>", "segment_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "503d6be2287a1daee379daa8083841b7e6c7bd7e0057d834c65c61ce56899273", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/pine-grammar", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"pine-script-v5-grammar\"><a href=\"#pine-script-v5-grammar\">Pine Script\u00ae v5 grammar<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/pine-grammar", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This page contains a formal definition of the grammar of Pine Script\u00ae. A\nprogramming language\u2019s grammar expresses how language keywords, special\ncharacters and literal values can be combined to form valid programs.</p>", "segment_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/pine-grammar", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"conventions\"><a href=\"#conventions\">Conventions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ul>\n<li><code dir=\"auto\">{}</code> Curly braces content can be repeated zero or more times: {,\n&lt;parameter&gt;}</li>\n<li><code dir=\"auto\">[]</code> Square brackets content can appear zero or one time: [ by\n&lt;expression&gt;]</li>\n<li><code dir=\"auto\">()</code> Parentheses group syntactic elements</li>\n<li><code dir=\"auto\">\\</code> Backslash escapes one character: <code dir=\"auto\">\\[</code> means a literal <code dir=\"auto\">[</code> in the\nsyntax.</li>\n<li><code dir=\"auto\">|</code> Pipe means \u201cor\u201d.</li>\n<li>Token names (non-terminal symbols) use uppercase: <code dir=\"auto\">TOKEN_NAME</code>.</li>\n<li>Lowercase is used for language keywords.</li>\n</ul>", "segment_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/pine-grammar", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"grammar\"><a href=\"#grammar\">Grammar<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">PINE_INDICATOR\n    [VERSION]\n    DECLARATION_STATEMENT\n    {STATEMENT{,STATEMENT}}\n    DISPLAY_STATEMENT\n\nPINE_STRATEGY\n    [VERSION]\n    DECLARATION_STATEMENT\n    {STATEMENT{,STATEMENT}}\n    STRATEGY_STATEMENT\n\nPINE_LIBRARY\n    [VERSION]\n    DECLARATION_STATEMENT\n    {STATEMENT{,STATEMENT}}\n\nVERSION\n    //@version = (1 | 2 | 3 | 4 | 5)\n\nDECLARATION_STATEMENT\n    indicator() | strategy() | library()\n\nSTATEMENT\n    &lt;variable_declaration&gt; | &lt;variable_reassignment&gt; | &lt;function_declaration&gt; | &lt;function_call&gt; | &lt;structure&gt;\n\nDISPLAY_STATEMENT\n    plot() | plotcandle() | plotbar() | plotchar() | plotarrow() | label.new() | line.new() | table.cell() | alertcondition()\n\n&lt;variable_initialization&gt;\n    &lt;variable_declaration&gt; = &lt;expression&gt; | &lt;structure&gt;\n\n&lt;variable_declaration&gt;\n    [&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt;\n    |\n    &lt;tuple_declaration&gt;\n\n&lt;declaration_mode&gt;\n    [var | varip]\n\n&lt;type&gt;\n    [int  | float   | bool   | color   | string   | label   | line   | box   | table |\n    int[] | float[] | bool[] | color[] | string[] | label[] | line[] | box[] | table[]]\n\n&lt;variable_reassignment&gt;\n    &lt;identifier&gt; := &lt;expression&gt; | &lt;function_call&gt; | &lt;structure&gt;\n\n&lt;function_declaration&gt;\n    &lt;identifier&gt;(&lt;parameter_list&gt;) =&gt; \n        &lt;local_block&gt;\n    |\n    &lt;identifier&gt;(&lt;parameter_list&gt;) =&gt; &lt;return_value&gt;\n\n&lt;parameter_list&gt;\n    {&lt;parameter_definition&gt;{, &lt;parameter_definition&gt;}}\n\n&lt;parameter_definition&gt;\n    [&lt;identifier&gt; = &lt;default_value&gt;]\n\n&lt;structure&gt;\n    &lt;if_structure&gt; | &lt;for_structure&gt; | &lt;while_structure&gt; | &lt;switch_structure&gt;\n\n&lt;if_structure&gt;\n    if &lt;expression&gt;\n        &lt;local_block&gt;\n    {else if &lt;expression&gt;\n        &lt;local_block&gt;}\n    [else\n        &lt;local_block&gt;]\n\n&lt;for_structure&gt;\n    for &lt;identifier&gt; = &lt;expression&gt; to &lt;expression&gt;[ by &lt;expression&gt;]\n        &lt;local_block_loop&gt;\n\n&lt;for_structure&gt;\n    for &lt;identifier&gt; = &lt;expression&gt; to &lt;expression&gt;[ by &lt;expression&gt;]\n        &lt;local_block_loop&gt;\n\n&lt;while_structure&gt;\n    while &lt;expression&gt;\n        &lt;local_block_loop&gt;\n\n&lt;local_block_loop&gt;\n    {&lt;statement&gt; | break | continue}\n    &lt;return_value&gt;\n\n&lt;switch_structure&gt;\n    &lt;switch_structure_expression&gt; | &lt;switch_structure_values&gt;\n\n&lt;switch_structure_expression&gt;\n    switch &lt;expression&gt;\n        {&lt;expression&gt; =&gt; &lt;local_block&gt;}\n        =&gt; &lt;local_block&gt;\n\n&lt;switch_structure_values&gt;\n    switch\n        {&lt;expression&gt; =&gt; &lt;local_block&gt;}\n        =&gt; &lt;local_block&gt;\n\n&lt;local_block&gt;\n    {&lt;statement&gt;}\n    &lt;return_value&gt;\n\n&lt;return_value&gt;\n    &lt;statement&gt; | &lt;expression&gt; | &lt;tuple&gt;\n\n&lt;tuple_declaration&gt;\n    \\[&lt;identifier&gt;{, &lt;identifier&gt;}\\]\n\n&lt;tuple&gt;\n    \\[&lt;expression&gt;{, &lt;expression&gt;]\\]\n\n&lt;expression&gt;\n    &lt;literal&gt; | &lt;identifier&gt; | &lt;function_call&gt; | \n    &lt;arithmetic_expression&gt; | &lt;comparison_expression&gt; | &lt;logical_expression&gt;\n\n&lt;function_call&gt;\n    functionName({&lt;expression&gt;{, &lt;expression&gt;}})\n\n&lt;arithmetic_expression&gt;\n\n\n&lt;comparison_expression&gt;\n\n\n&lt;logical_expression&gt;\n\n\n&lt;ternary_expression&gt;\n\n\n&lt;identifier&gt;\n    &lt;letter&gt; | &lt;underscore&gt; {&lt;letter&gt;&lt;underscore&gt;&lt;digit&gt;}\n\n&lt;arithmetic_operators&gt;\n    + | - | * | / | %\n\n&lt;comparison_operators&gt;\n    &lt; | &lt;= | != | == | &gt; | &gt;=\n\n&lt;logical_operators&gt;\n    not | and | or\n\n&lt;literal&gt;\n    &lt;literal_int&gt; | &lt;literal_float&gt; | &lt;literal_bool&gt; | &lt;literal_color&gt; | &lt;literal_string&gt;\n\n&lt;literal_int&gt;\n    [- | +]&lt;digit&gt;{&lt;digit&gt;}\n\n&lt;literal_float&gt;\n    [- | +]&lt;digit&gt;{&lt;digit&gt;}[.][E|e&lt;digit&gt;{&lt;digit&gt;}]\n\n&lt;literal_bool&gt;\n    true | false | bool(na)\n\n&lt;literal_color&gt;\n    #RRGGBB | #RRGGBBAA | &lt;built-in_color_constant&gt;\n\n&lt;literal_string&gt;\n    \"&lt;characters&gt;\" | '&lt;characters&gt;'</div>", "segment_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "b61b9e2a75b4a564e71942cba9ac0c920df67e84d25713ec3ef708215836141c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/script-structure\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"script-structure\"><a href=\"#script-structure\">Script structure<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>A Pine script follows this general structure:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;version&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;declaration_statement&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;code&gt;</span></div></div></code></pre></figure></link></div>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"version\"><a href=\"#version\">Version<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation</a> in the following form tells the compiler which of the\nversions of Pine Script\u00ae the script is written in:</p>\n<div class=\"pine-colorizer not-content\">//@version=5</div>\n<ul>\n<li>The version number can be 1 to 5.</li>\n<li>The compiler annotation is not mandatory. When omitted, version 1 is\nassumed. It is strongly recommended to always use the latest version\nof the language.</li>\n<li>While it is synctactically correct to place the version compiler\nannotation anywhere in the script, it is much more useful to readers\nwhen it appears at the top of the script.</li>\n</ul>\n<p>Notable changes to the current version of Pine Script are documented in\nthe <a href=\"/pine-script-docs/v5/release-notes/\">Release notes</a>.</p>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaration-statement\"><a href=\"#declaration-statement\">Declaration statement<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>All Pine scripts must contain one declaration statement, which is a call\nto one of these functions:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a></li>\n</ul>\n<p>The declaration statement:</p>\n<ul>\n<li>Identifies the type of the script, which in turn dictates which\ncontent is allowed in it, and how it can be used and executed.</li>\n<li>Sets key properties of the script such as its name, where it will\nappear when it is added to a chart, the precision and format of the\nvalues it displays, and certain values that govern its runtime\nbehavior, such as the maximum number of drawing objects it will\ndisplay on the chart. With strategies, the properties include\nparameters that control backtesting, such as initial capital,\ncommission, slippage, etc.</li>\n</ul>\n<p>Each type of script has distinct requirements:</p>\n<ul>\n<li>Indicators must contain at least one function call which produces\noutput on the chart (e.g.,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line%7Bdot%7Dnew\">line.new()</a>,\netc.).</li>\n<li>Strategies must contain at least one <code dir=\"auto\">strategy.*()</code> call, e.g.,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>.</li>\n<li>Libraries must contain at least one exported\n<a href=\"/pine-script-docs/v5/concepts/libraries/#library-functions\">function</a>\nor <a href=\"/pine-script-docs/v5/concepts/libraries/#user-defined-types-and-objects\">user-defined type</a>.</li>\n</ul>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"code\"><a href=\"#code\">Code<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Lines in a script that are not\n<a href=\"/pine-script-docs/v5/language/script-structure/#comments\">comments</a>\nor\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotations</a> are <em>statements</em>, which implement the script\u2019s algorithm. A\nstatement can be one of these:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/language/variable-declarations/\">variable declaration</a></li>\n<li><a href=\"/pine-script-docs/v5/language/variable-declarations/#variable-reassignment\">variable reassignment</a></li>\n<li><a href=\"/pine-script-docs/v5/language/user-defined-functions/#multi-line-functions\">function declaration</a></li>\n<li><a href=\"/pine-script-docs/v5/language/built-ins/#built-in-functions\">built-in function call</a>,\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function call</a> or\n<a href=\"/pine-script-docs/v5/concepts/libraries/#using-a-library\">a library function call</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a>, or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_enum\">enum</a>\n<em>structure</em>.</li>\n</ul>\n<p>Statements can be arranged in multiple ways:</p>\n<ul>\n<li>Some statements can be expressed in one line, like most variable\ndeclarations, lines containing only a function call or single-line\nfunction declarations. Lines can also be\n<a href=\"/pine-script-docs/v5/language/script-structure/#line-wrapping\">wrapped</a> (continued on multiple lines). Multiple one-line\nstatements can be concatenated on a single line by using the comma\nas a separator.</li>\n<li>Others statements such as structures or multi-line function\ndeclarations always require multiple lines because they require a\n<em>local block</em>. A local block must be indented by a tab or four\nspaces. Each local block defines a distinct <em>local scope</em>.</li>\n<li>Statements in the <em>global scope</em> of the script (i.e., which are not\npart of local blocks) cannot begin with white space (a space or a\ntab). Their first character must also be the line\u2019s first\ncharacter. Lines beginning in a line\u2019s first position become by\ndefinition part of the script\u2019s <em>global scope</em>.</li>\n</ul>\n<p>A simple valid Pine Script v5 indicator can be generated in the Pine\nScript Editor by using the \u201cOpen\u201d button and choosing \u201cNew blank\nindicator\u201d:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nplot(close)</div>\n<p>This indicator includes three local blocks, one in the <code dir=\"auto\">barIsUp()</code> function\ndeclaration, and two in the variable declaration using an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\nindicator(\"\", \"\", true)    // Declaration statement (global scope)\n\nbarIsUp() =&gt;    // Function declaration (global scope)\n    close &gt; open    // Local block (local scope)\n\nplotColor = if barIsUp()  // Variable declaration (global scope)\n    color.green     // Local block (local scope)\nelse\n    color.red       // Local block (local scope)\n\nbgcolor(color.new(plotColor, 70))   // Call to a built-in function  (global scope)</div>\n<p>You can bring up a simple Pine Script v5 strategy by selecting \u201cNew\nblank strategy\u201d instead:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"My Strategy\", overlay=true, margin_long=100, margin_short=100)\n\nlongCondition = ta.crossover(ta.sma(close, 14), ta.sma(close, 28))\nif (longCondition)\n    strategy.entry(\"My Long Entry Id\", strategy.long)\n\nshortCondition = ta.crossunder(ta.sma(close, 14), ta.sma(close, 28))\nif (shortCondition)\n    strategy.entry(\"My Short Entry Id\", strategy.short)</div>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"comments\"><a href=\"#comments\">Comments<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Double slashes (<code dir=\"auto\">//</code>) define comments in Pine Script. Comments can\nbegin anywhere on the line. They can also follow Pine Script code on\nthe same line:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\n// This line is a comment\na = close // This is also a comment\nplot(a)</div>\n<p>The Pine Editor has a keyboard shortcut to comment/uncomment lines:\n<code dir=\"auto\">ctrl</code> + <code dir=\"auto\">/</code>. You can use it on multiple lines by highlighting them\nfirst.</p>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"line-wrapping\"><a href=\"#line-wrapping\">Line wrapping<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Long lines can be split on multiple lines, or \u201cwrapped\u201d. Wrapped lines\nmust be indented with any number of spaces, provided it\u2019s not a\nmultiple of four (those boundaries are used to indent local blocks):</p>\n<div class=\"pine-colorizer not-content\">a = open + high + low + close</div>\n<p>may be wrapped as:</p>\n<div class=\"pine-colorizer not-content\">a = open +\n      high +\n          low +\n             close</div>\n<p>A long\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall may be wrapped as:</p>\n<div class=\"pine-colorizer not-content\">plot(ta.correlation(src, ovr, length),\n   color = color.new(color.purple, 40),\n   style = plot.style_area,\n   trackprice = true)</div>\n<p>Statements inside user-defined function declarations can also be\nwrapped. However, since a local block must syntactically begin with an\nindentation (4 spaces or 1 tab), when splitting it onto the following\nline, the continuation of the statement must start with more than one\nindentation (not equal to a multiple of four spaces). For example:</p>\n<div class=\"pine-colorizer not-content\">updown(s) =&gt;\n    isEqual = s == s[1]\n    isGrowing = s &gt; s[1]\n    ud = isEqual ?\n           0 :\n           isGrowing ?\n               (nz(ud[1]) &lt;= 0 ?\n                     1 :\n                   nz(ud[1])+1) :\n               (nz(ud[1]) &gt;= 0 ?\n                   -1 :\n                   nz(ud[1])-1)</div>\n<p>You can use comments in wrapped lines:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nc = open &gt; close ? color.red :\n  high &gt; high[1] ? color.lime : // A comment\n  low &lt; low[1] ? color.blue : color.black\nbgcolor(c)</div>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/script-structure", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"compiler-annotations\"><a href=\"#compiler-annotations\">Compiler annotations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Compiler annotations are\n<a href=\"/pine-script-docs/v5/language/script-structure/#comments\">comments</a>\nthat issue special instructions for a script:</p>\n<ul>\n<li><code dir=\"auto\">//@version=</code> specifies the PineScript version that the compiler\nwill use. The number in this annotation should not be confused with\nthe script\u2019s version number, which updates on every saved change\nto the code.</li>\n<li><code dir=\"auto\">//@description</code> sets a custom description for scripts that use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>\ndeclaration statement.</li>\n<li><code dir=\"auto\">//@function</code>, <code dir=\"auto\">//@param</code> and <code dir=\"auto\">//@returns</code> add custom descriptions\nfor a <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> or <a href=\"/pine-script-docs/v5/language/methods/\">method</a>, its parameters, and its result when placed above the function declaration.</li>\n<li><code dir=\"auto\">//@type</code> adds a custom description for a <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a> when placed\nabove the type declaration.</li>\n<li><code dir=\"auto\">//@enum</code> adds a custom description for an <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a> when placed above the enum declaration.</li>\n<li><code dir=\"auto\">//@field</code> adds a custom description for the field of a <a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a> or an <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a> when placed above the type or enum declaration.</li>\n<li><code dir=\"auto\">//@variable</code> adds a custom description for a variable when placed\nabove its declaration.</li>\n<li><code dir=\"auto\">//@strategy_alert_message</code> provides a default message for strategy\nscripts to pre-fill the \u201cMessage\u201d field in the alert creation\ndialog.</li>\n</ul>\n<p>The Pine Editor also features two specialized annotations, <code dir=\"auto\">//#region</code> and <code dir=\"auto\">//#endregion</code>, that create <em>collapsible</em> code regions.\nClicking the dropdown arrow next to a <code dir=\"auto\">//#region</code> line collapses all the code between that line and the nearest <code dir=\"auto\">//#endregion</code> annotation\nbelow it.</p>\n<p>This example draws a triangle using three interactively selected points on the chart.\nThe script illustrates how one can use compiler and Editor annotations to document code and make it easier to navigate:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"794\" loading=\"lazy\" src=\"/pine-script-docs/_astro/ScriptStructure-CompilerAnnotations01.CdT2JzaQ_2sKSpL.webp\" width=\"1848\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Triangle\", \"\", true)\n\n//#region \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 Constants and inputs\n\nint   TIME_DEFAULT  = 0\nfloat PRICE_DEFAULT = 0.0\n\nx1Input = input.time(TIME_DEFAULT,   \"Point 1\", inline = \"1\", confirm = true)\ny1Input = input.price(PRICE_DEFAULT, \"\",        inline = \"1\", tooltip = \"Pick point 1\", confirm = true)\nx2Input = input.time(TIME_DEFAULT,   \"Point 2\", inline = \"2\", confirm = true)\ny2Input = input.price(PRICE_DEFAULT, \"\",        inline = \"2\", tooltip = \"Pick point 2\", confirm = true)\nx3Input = input.time(TIME_DEFAULT,   \"Point 3\", inline = \"3\", confirm = true)\ny3Input = input.price(PRICE_DEFAULT, \"\",        inline = \"3\", tooltip = \"Pick point 3\", confirm = true)\n//#endregion\n\n//#region \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 Types and functions\n\n// @type            Used to represent the coordinates and color to draw a triangle.\n// @field time1     Time of first point.\n// @field time2     Time of second point.\n// @field time3     Time of third point.\n// @field price1    Price of first point.\n// @field price2    Price of second point.\n// @field price3    Price of third point.\n// @field lineColor Color to be used to draw the triangle lines.\ntype Triangle\n    int   time1\n    int   time2\n    int   time3\n    float price1\n    float price2\n    float price3\n    color lineColor\n\n//@function Draws a triangle using the coordinates of the `t` object.\n//@param t  (Triangle) Object representing the triangle to be drawn.\n//@returns  The ID of the last line drawn.\ndrawTriangle(Triangle t) =&gt;\n    line.new(t.time1, t.price1, t.time2, t.price2, xloc = xloc.bar_time, color = t.lineColor)\n    line.new(t.time2, t.price2, t.time3, t.price3, xloc = xloc.bar_time, color = t.lineColor)\n    line.new(t.time1, t.price1, t.time3, t.price3, xloc = xloc.bar_time, color = t.lineColor)\n//#endregion\n\n//#region \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 Calculations\n\n// Draw the triangle only once on the last historical bar.\nif barstate.islastconfirmedhistory\n    //@variable Used to hold the Triangle object to be drawn.\n    Triangle triangle = Triangle.new()\n\n    triangle.time1  := x1Input\n    triangle.time2  := x2Input\n    triangle.time3  := x3Input\n    triangle.price1 := y1Input\n    triangle.price2 := y2Input\n    triangle.price3 := y3Input\n    triangle.lineColor := color.purple\n\n    drawTriangle(triangle)\n//#endregion</div>", "segment_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "af0cf9933ded218410f800840bb44014530fd31363b2e8a6e1338fe3b8c3705b", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/type-system\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"type-system\"><a href=\"#type-system\">Type system<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The Pine Script\u00ae type system determines the compatibility of a script\u2019s\nvalues with various functions and operations. While it\u2019s possible to\nwrite simple scripts without knowing anything about the type system, a\nreasonable understanding of it is necessary to achieve any degree of\nproficiency with the language, and an in-depth knowledge of its\nsubtleties allows programmers to harness its full potential.</p>\n<p>Pine Script uses <a href=\"/pine-script-docs/v5/language/type-system/#types\">types</a> to classify all values, and it uses <a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">qualifiers</a> to determine whether values and references are constant, established on the first script execution, or dynamic across executions. This system applies to all Pine values and references, including literals, variables, expressions, function returns, and function arguments.</p>\n<p>The type system closely intertwines with Pine\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and\n<a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> concepts.\nUnderstanding all three is essential for making the most of the power of\nPine Script.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>For the sake of brevity, we often use \u201ctype\u201d to refer to a \u201cqualified\ntype\u201d.</p></div></aside>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"qualifiers\"><a href=\"#qualifiers\">Qualifiers<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script <em>qualifiers</em> identify when values are accessible to a\nscript:</p>\n<ul>\n<li>Values and references qualified as\n<a href=\"/pine-script-docs/v5/language/type-system/#const\">const</a> are established at compile time (i.e., when saving the\nscript in the Pine Editor or adding it to the chart).</li>\n<li>Values qualified as\n<a href=\"/pine-script-docs/v5/language/type-system/#input\">input</a> are established at input time (i.e., when confirming values\nbased on user input, primarily from the \u201cSettings/Inputs\u201d tab).</li>\n<li>Values qualified as\n<a href=\"/pine-script-docs/v5/language/type-system/#simple\">simple</a> are established at bar zero (i.e., the first\nscript execution).</li>\n<li>Values qualified as\n<a href=\"/pine-script-docs/v5/language/type-system/#series\">series</a> can change throughout the script\u2019s executions.</li>\n</ul>\n<p>Pine Script bases the dominance of type qualifiers on the following\nhierarchy: <strong>const &lt; input &lt; simple &lt; series</strong>, where \u201cconst\u201d is\nthe <em>weakest</em> qualifier and \u201cseries\u201d is the <em>strongest</em>. The qualifier\nhierarchy translates to this rule: whenever a variable, function, or\noperation is compatible with a specific qualified type, values with\n<em>weaker</em> qualifiers are also allowed.</p>\n<p>Scripts always qualify their expressions\u2019 returned types based on the\n<em>dominant qualifier</em> in their calculations. For example, evaluating an\nexpression that involves \u201cinput\u201d and \u201cseries\u201d values will return a\nvalue qualified as \u201cseries\u201d. Furthermore, scripts <strong>cannot</strong> change a\nvalue\u2019s qualifier to one that\u2019s <em>lower</em> on the hierarchy. If a value\nacquires a <em>stronger</em> qualifier (e.g., a value initially inferred as\n\u201csimple\u201d becomes \u201cseries\u201d later in the script\u2019s executions), that\nstate is irreversible.</p>\n<p>It\u2019s important to note that \u201cseries\u201d values are the <strong>only</strong> ones\nthat can change across script executions, including those from various\nbuilt-ins, such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>,\nas well as the results of expressions involving \u201cseries\u201d values. All\nvalues qualified as \u201cconst\u201d, \u201cinput\u201d, or \u201csimple\u201d remain\nconsistent across all script executions.</p>\n<h3 class=\"md-heading\" id=\"const\"><a href=\"#const\">const<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values or references qualified as \u201cconst\u201d are established at <em>compile\ntime</em>, before the script starts its executions. Compilation initially\noccurs when saving a script in the Pine Editor, which does not require\nit to run on a chart. Values or references with the \u201cconst\u201d qualifier\n<em>never change</em> between script executions, not even on the first\nexecution.</p>\n<p>All <em>literal</em> values and the results returned by expressions involving\nonly values qualified as \u201cconst\u201d automatically adopt the \u201cconst\u201d\nqualifier.</p>\n<p>These are some examples of literal values:</p>\n<ul>\n<li><em>literal int</em>: <code dir=\"auto\">1</code>, <code dir=\"auto\">-1</code>, <code dir=\"auto\">42</code></li>\n<li><em>literal float</em>: <code dir=\"auto\">1.</code>, <code dir=\"auto\">1.0</code>, <code dir=\"auto\">3.14</code>, <code dir=\"auto\">6.02E-23</code>, <code dir=\"auto\">3e8</code></li>\n<li><em>literal bool</em>: <code dir=\"auto\">true</code>, <code dir=\"auto\">false</code></li>\n<li><em>literal color</em>: <code dir=\"auto\">#FF55C6</code>, <code dir=\"auto\">#FF55C6ff</code></li>\n<li><em>literal string</em>: <code dir=\"auto\">\"A text literal\"</code>,\n<code dir=\"auto\">\"Embedded single quotes 'text'\"</code>, <code dir=\"auto\">'Embedded double quotes \"text\"'</code></li>\n</ul>\n<p>Our <a href=\"/pine-script-docs/v5/writing/style-guide/\">Style guide</a>\nrecommends using uppercase SNAKE_CASE to name \u201cconst\u201d variables for\nreadability. While not a requirement, one can also use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword when declaring \u201cconst\u201d variables so the script only\ninitializes them on the <em>first bar</em> of the dataset. See\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#var\">this section</a> of our User Manual for more information.</p>\n<p>Below is an example that uses \u201cconst\u201d values within the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nfunctions, which both require a value of the \u201cconst string\u201d qualified\ntype as their <code dir=\"auto\">title</code> argument:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// The following global variables are all of the \"const string\" qualified type:\n\n//@variable The title of the indicator.\nINDICATOR_TITLE = \"const demo\"\n//@variable The title of the first plot.\nvar PLOT1_TITLE = \"High\"\n//@variable The title of the second plot.\nconst string PLOT2_TITLE = \"Low\"\n//@variable The title of the third plot.\nPLOT3_TITLE = \"Midpoint between \" + PLOT1_TITLE + \" and \" + PLOT2_TITLE\n\nindicator(INDICATOR_TITLE, overlay = true)\n\nplot(high, PLOT1_TITLE)\nplot(low, PLOT2_TITLE)\nplot(hl2, PLOT3_TITLE)</div>\n<p>The following example will raise a compilation error since it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.ticker\">syminfo.ticker</a>,\nwhich returns a \u201csimple\u201d value because it depends on chart information\nthat\u2019s only accessible after the script\u2019s first execution:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n//@variable The title in the `indicator()` call.\nvar NAME = \"My indicator for \" + syminfo.ticker\n\nindicator(NAME, \"\", true) // Causes an error because `NAME` is qualified as a \"simple string\".\nplot(close)</div>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_const\">const</a>\nkeyword allows the declaration of variables and parameters with constant\n<em>value assignments</em>. Declaring a variable with this keyword instructs\nthe script to forbid using <em>reassignment</em> and <em>compound assignment</em>\noperations on it. For example, this script declares the <code dir=\"auto\">myVar</code> variable\nwith the keyword, then attempts to assign a new \u201cfloat\u201d value to the\nvariable with the addition assignment operator\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_+=\">+=</a>),\nresulting in a compilation error:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Cannot reassign const demo\")\n\n//@variable A \"float\" variable declared as `const`, preventing reassignment. \nconst float myVar = 0.0\n\nmyVar += 1.0 // Causes an error. Reassignment and compound assignments are not allowed on `const` variables.\n\nplot(myVar)</div>\n<p>It\u2019s crucial to note that declaring a variable with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_const\">const</a>\nkeyword forces it to maintain a constant reference to the value returned\nby a specific expression, but that <em>does not</em> necessarily define the\nnature of the assigned value. For example, a script can declare a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_const\">const</a>\nvariable that maintains a constant reference to an expression returning\nthe <em>ID</em> of a <em>special type</em>. Although the script cannot <em>reassign</em> the\nvariable, the assigned ID is a \u201cseries\u201d value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Constant reference to 'series' ID demo\")\n\n//@variable A `label` variable declared as `const`, preventing reassignment.\n//          Although the reference is constant, the ID of the `label` is a \"series\" value.\nconst label myVar = label.new(bar_index, close)</div>\n<h3 class=\"md-heading\" id=\"input\"><a href=\"#input\">input<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Most values qualified as \u201cinput\u201d are established after initialization\nvia the <code dir=\"auto\">input.*()</code> functions. These functions produce values that users\ncan modify within the \u201cInputs\u201d tab of the script\u2019s settings. When one\nchanges any of the values in this tab, the script <em>restarts</em> from the\nbeginning of the chart\u2019s history to ensure its inputs are consistent\nthroughout its executions. Some of Pine\u2019s built-in variables, such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.bg_color\">chart.bg_color</a>\nalso use the \u201cinput\u201d qualifier, even though <code dir=\"auto\">input.*()</code> functions do\nnot return them, since the script receives their values at <em>input time</em>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nfunctions are exceptions in the <code dir=\"auto\">input.*()</code> namespace, as they <em>do not</em>\nreturn values qualified as \u201cinput\u201d. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a>\nfunction returns \u201cseries\u201d values since built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\nas well as the values from another script\u2019s plots, have the \u201cseries\u201d\nqualifier. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nfunction returns a \u201csimple\u201d result because all values belonging to\n<a href=\"/pine-script-docs/v5/language/type-system/#types\">enums</a> are\navailable on the first script execution. See this manual\u2019s\n<a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a> page for more\ninformation.</p></div></aside>\n<p>The following script plots the value of a <code dir=\"auto\">sourceInput</code> from the\n<code dir=\"auto\">symbolInput</code> and <code dir=\"auto\">timeframeInput</code> context. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall is valid in this script since its <code dir=\"auto\">symbol</code> and <code dir=\"auto\">timeframe</code>\nparameters allow \u201csimple string\u201d arguments, meaning they can also\naccept \u201cinput string\u201d values because the \u201cinput\u201d qualifier is\n<em>lower</em> on the hierarchy:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"input demo\", overlay = true)\n\n//@variable The symbol to request data from. Qualified as \"input string\".\nsymbolInput = input.symbol(\"AAPL\", \"Symbol\")\n//@variable The timeframe of the data request. Qualified as \"input string\".\ntimeframeInput = input.timeframe(\"D\", \"Timeframe\")\n//@variable The source of the calculation. Qualified as \"series float\".\nsourceInput = input.source(close, \"Source\")\n\n//@variable The `sourceInput` value from the requested context. Qualified as \"series float\".\nrequestedSource = request.security(symbolInput, timeframeInput, sourceInput)\n\nplot(requestedSource)</div>\n<h3 class=\"md-heading\" id=\"simple\"><a href=\"#simple\">simple<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values qualified as \u201csimple\u201d are available on the first script\nexecution, and they remain consistent across subsequent executions.</p>\n<p>Users can explicitly define variables and parameters that accept\n\u201csimple\u201d values by including the <code dir=\"auto\">simple</code> keyword in their\ndeclaration.</p>\n<p>Many built-in variables return \u201csimple\u201d qualified values because they\ndepend on information that a script can only obtain once it starts\nrunning on the chart. Additionally, many built-in functions require\n\u201csimple\u201d arguments that do not change over time. Wherever a script\nallows \u201csimple\u201d values, it can also accept values qualified as\n\u201cinput\u201d or \u201cconst\u201d.</p>\n<p>This script highlights the background to warn users that they\u2019re using\na non-standard chart type. It uses the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.is_standard\">chart.is_standard</a>\nto calculate the <code dir=\"auto\">isNonStandard</code> variable, then uses that variable\u2019s\nvalue to calculate a <code dir=\"auto\">warningColor</code> that also references a \u201csimple\u201d\nvalue. The <code dir=\"auto\">color</code> parameter of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nallows a \u201cseries color\u201d argument, meaning it can also accept a\n\u201csimple color\u201d value since \u201csimple\u201d is lower on the hierarchy:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"simple demo\", overlay = true)\n\n//@variable Is `true` when the current chart is non-standard. Qualified as \"simple bool\".\nisNonStandard = not chart.is_standard\n//@variable Is orange when the the current chart is non-standard. Qualified as \"simple color\".\nsimple color warningColor = isNonStandard ? color.new(color.orange, 70) : na\n\n// Colors the chart's background to warn that it's a non-standard chart type.\nbgcolor(warningColor, title = \"Non-standard chart color\")</div>\n<h3 class=\"md-heading\" id=\"series\"><a href=\"#series\">series<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values qualified as \u201cseries\u201d provide the most flexibility in scripts\nsince they can change across executions.</p>\n<p>Users can explicitly define variables and parameters that accept\n\u201cseries\u201d values by including the <code dir=\"auto\">series</code> keyword in their\ndeclarations.</p>\n<p>Built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>,\nand the result from any expression using such built-ins, are qualified\nas \u201cseries\u201d. The result of any function or operation that returns a\ndynamic value will always be a \u201cseries\u201d, as will the results from\nusing the history-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nto access historical values. Wherever a script allows \u201cseries\u201d values,\nit will also accept values with any other qualifier, as \u201cseries\u201d is\nthe <em>highest</em> qualifier on the hierarchy.</p>\n<p>This script displays the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">highest</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.lowest\">lowest</a>\nvalue of a <code dir=\"auto\">sourceInput</code> over <code dir=\"auto\">lengthInput</code> bars. The values assigned to\nthe <code dir=\"auto\">highest</code> and <code dir=\"auto\">lowest</code> variables are of the \u201cseries float\u201d\nqualified type, as they can change throughout the script\u2019s execution:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"series demo\", overlay = true)\n\n//@variable The source value to calculate on. Qualified as \"series float\".\nseries float sourceInput = input.source(close, \"Source\")\n//@variable The number of bars in the calculation. Qualified as \"input int\".\nlengthInput = input.int(20, \"Length\")\n\n//@variable The highest `sourceInput` value over `lengthInput` bars. Qualified as \"series float\".\nseries float highest = ta.highest(sourceInput, lengthInput)\n//@variable The lowest `sourceInput` value over `lengthInput` bars. Qualified as \"series float\".\nlowest = ta.lowest(sourceInput, lengthInput)\n\nplot(highest, \"Highest source\", color.green)\nplot(lowest, \"Lowest source\", color.red)</div>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"types\"><a href=\"#types\">Types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script <em>types</em> classify values and determine the functions and\noperations they\u2019re compatible with. They include:</p>\n<ul>\n<li>The fundamental types:\n<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#bool\">bool</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>,\nand <a href=\"/pine-script-docs/v5/language/type-system/#string\">string</a></li>\n<li>The special types:\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">plot</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#plot-and-hline\">hline</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">line</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">linefill</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">box</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">polyline</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">label</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">table</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart.point</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">array</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">matrix</a>, and\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">map</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">User-defined types (UDTs)</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">Enums</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#void\">void</a></li>\n</ul>\n<p>Fundamental types refer to the underlying nature of a value, e.g., a\nvalue of 1 is of the \u201cint\u201d type, 1.0 is of the \u201cfloat\u201d type,\n\u201cAAPL\u201d is of the \u201cstring\u201d type, etc. Special types and user-defined\ntypes utilize <em>IDs</em> that refer to objects of a specific type. For\nexample, a value of the \u201clabel\u201d type contains an ID that acts as a\n<em>pointer</em> referring to a \u201clabel\u201d object. The \u201cvoid\u201d type refers to\nthe output from a function or <a href=\"/pine-script-docs/v5/language/methods/\">method</a> that does not return a usable value.</p>\n<p>Pine Script can automatically convert values from some types into\nothers. The auto-casting rules are: <strong>int \u2192 float \u2192 bool</strong>. See the\n<a href=\"/pine-script-docs/v5/language/type-system/#type-casting\">Type casting</a> section of this page for more information.</p>\n<p>In most cases, Pine Script can automatically determine a value\u2019s type.\nHowever, we can also use type keywords to <em>explicitly</em> specify types for\nreadability and for code that requires explicit definitions (e.g.,\ndeclaring a variable assigned to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>). For\nexample:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Types demo\", overlay = true)\n\n//@variable A value of the \"const string\" type for the `ma` plot's title.\nstring MA_TITLE = \"MA\"\n\n//@variable A value of the \"input int\" type. Controls the length of the average.\nint lengthInput = input.int(100, \"Length\", minval = 2)\n\n//@variable A \"series float\" value representing the last `close` that crossed over the `ma`.\nvar float crossValue = na\n\n//@variable A \"series float\" value representing the moving average of `close`.\nfloat ma = ta.sma(close, lengthInput)\n//@variable A \"series bool\" value that's `true` when the `close` crosses over the `ma`.\nbool crossUp = ta.crossover(close, ma)\n//@variable A \"series color\" value based on whether `close` is above or below its `ma`.\ncolor maColor = close &gt; ma ? color.lime : color.fuchsia\n\n// Update the `crossValue`.\nif crossUp\n    crossValue := close\n\nplot(ma, MA_TITLE, maColor)\nplot(crossValue, \"Cross value\", style = plot.style_circles)\nplotchar(crossUp, \"Cross Up\", \"\u25b2\", location.belowbar, size = size.small)</div>\n<h3 class=\"md-heading\" id=\"int\"><a href=\"#int\">int<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values of the \u201cint\u201d type represent integers, i.e., whole numbers\nwithout any fractional quantities.</p>\n<p>Integer literals are numeric values written in <em>decimal</em> notation. For\nexample:</p>\n<div class=\"pine-colorizer not-content\">1\n-1\n750</div>\n<p>Built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timenow\">timenow</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dayofmonth\">dayofmonth</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.wintrades\">strategy.wintrades</a>\nall return values of the \u201cint\u201d type.</p>\n<h3 class=\"md-heading\" id=\"float\"><a href=\"#float\">float<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values of the \u201cfloat\u201d type represent floating-point numbers, i.e.,\nnumbers that can contain whole and fractional quantities.</p>\n<p>Floating-point literals are numeric values written with a <code dir=\"auto\">.</code> delimiter.\nThey may also contain the symbol <code dir=\"auto\">e</code> or <code dir=\"auto\">E</code> (which means \u201c10 raised to\nthe power of X\u201d, where X is the number after the <code dir=\"auto\">e</code> or <code dir=\"auto\">E</code> symbol).\nFor example:</p>\n<div class=\"pine-colorizer not-content\">3.14159    // Rounded value of Pi (\u03c0)\n- 3.0\n6.02e23    // 6.02 * 10^23 (a very large value)\n1.6e-19    // 1.6 * 10^-19 (a very small value)</div>\n<p>The internal precision of \u201cfloat\u201d values in Pine Script is 1e-16.</p>\n<p>Built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlcc4\">hlcc4</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ta.vwap\">ta.vwap</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.position_size\">strategy.position_size</a>\nall return values of the \u201cfloat\u201d type.</p>\n<h3 class=\"md-heading\" id=\"bool\"><a href=\"#bool\">bool<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values of the \u201cbool\u201d type represent the truth value of a comparison or\ncondition, which scripts can use in\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> and other expressions.</p>\n<p>There are only two literals that represent boolean values:</p>\n<div class=\"pine-colorizer not-content\">true    // true value\nfalse   // false value</div>\n<p>When an expression of the \u201cbool\u201d type returns\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nscripts treat its value as <code dir=\"auto\">false</code> when evaluating conditional\nstatements and operators.</p>\n<p>Built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isfirst\">barstate.isfirst</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.is_heikinashi\">chart.is_heikinashi</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session.ismarket\">session.ismarket</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.isdaily\">timeframe.isdaily</a>\nall return values of the \u201cbool\u201d type.</p>\n<h3 class=\"md-heading\" id=\"color\"><a href=\"#color\">color<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Color literals have the following format: <code dir=\"auto\">#RRGGBB</code> or <code dir=\"auto\">#RRGGBBAA</code>. The\nletter pairs represent <em>hexadecimal</em> values between <code dir=\"auto\">00</code> and <code dir=\"auto\">FF</code> (0 to\n255 in decimal) where:</p>\n<ul>\n<li><code dir=\"auto\">RR</code>, <code dir=\"auto\">GG</code> and <code dir=\"auto\">BB</code> pairs respectively represent the values for the\ncolor\u2019s red, green and blue components.</li>\n<li><code dir=\"auto\">AA</code> is an optional value for the color\u2019s opacity (or <em>alpha</em>\ncomponent) where <code dir=\"auto\">00</code> is invisible and <code dir=\"auto\">FF</code> opaque. When the literal\ndoes not include an <code dir=\"auto\">AA</code> pair, the script treats it as fully opaque\n(the same as using <code dir=\"auto\">FF</code>).</li>\n<li>The hexadecimal letters in the literals can be uppercase or\nlowercase.</li>\n</ul>\n<p>These are examples of \u201ccolor\u201d literals:</p>\n<div class=\"pine-colorizer not-content\">#000000      // black color\n#FF0000      // red color\n#00FF00      // green color\n#0000FF      // blue color\n#FFFFFF      // white color\n#808080      // gray color\n#3ff7a0      // some custom color\n#FF000080    // 50% transparent red color\n#FF0000ff    // same as #FF0000, fully opaque red color\n#FF000000    // completely transparent red color</div>\n<p>Pine Script also has\n<a href=\"/pine-script-docs/v5/concepts/colors/#constant-colors\">built-in color constants</a>, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dgreen\">color.green</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dred\">color.red</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dorange\">color.orange</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_color%7Bdot%7Dblue\">color.blue</a>\n(the default color in <code dir=\"auto\">plot*()</code> functions and many of the default\ncolor-related properties in\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a>), etc.</p>\n<p>When using built-in color constants, it is possible to add transparency\ninformation to them via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.new\">color.new()</a>\nfunction.</p>\n<p>Note that when specifying red, green or blue components in <code dir=\"auto\">color.*()</code>\nfunctions, we use \u201cint\u201d or \u201cfloat\u201d arguments with values between 0\nand 255. When specifying transparency, we use a value between 0 and 100,\nwhere 0 means fully opaque and 100 means completely transparent. For\nexample:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Shading the chart's background\", overlay = true)\n\n//@variable A \"const color\" value representing the base for each day's color. \ncolor BASE_COLOR = color.rgb(0, 99, 165)\n\n//@variable A \"series int\" value that modifies the transparency of the `BASE_COLOR` in `color.new()`.\nint transparency = 50 + int(40 * dayofweek / 7)\n\n// Color the background using the modified `BASE_COLOR`.\nbgcolor(color.new(BASE_COLOR, transparency))</div>\n<p>See the User Manual\u2019s page on <a href=\"/pine-script-docs/v5/concepts/colors/\">colors</a> for more information on using colors in scripts.</p>\n<h3 class=\"md-heading\" id=\"string\"><a href=\"#string\">string<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Values of the \u201cstring\u201d type represent sequences of letters, numbers,\nsymbols, spaces, and other characters.</p>\n<p>String literals in Pine are characters enclosed in single or double\nquotation marks. For example:</p>\n<div class=\"pine-colorizer not-content\">\"This is a string literal using double quotes.\"\n'This is a string literal using single quotes.'</div>\n<p>Single and double quotation marks are functionally equivalent in Pine\nScript. A \u201cstring\u201d enclosed within double quotation marks can contain\nany number of single quotation marks and vice versa:</p>\n<div class=\"pine-colorizer not-content\">\"It's an example\"\n'The \"Star\" indicator'</div>\n<p>Scripts can <em>escape</em> the enclosing delimiter in a \u201cstring\u201d using the\nbackslash character (<code dir=\"auto\">\\</code>). For example:</p>\n<div class=\"pine-colorizer not-content\">'It\\'s an example'\n\"The \\\"Star\\\" indicator\"</div>\n<p>We can create \u201cstring\u201d values containing the new line escape character\n(<code dir=\"auto\">\\n</code>) for displaying multi-line text with <code dir=\"auto\">plot*()</code> and <code dir=\"auto\">log.*()</code>\nfunctions and objects of\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a>. For example:</p>\n<div class=\"pine-colorizer not-content\">\"This\\nString\\nHas\\nOne\\nWord\\nPer\\nLine\"</div>\n<p>We can use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_+\">+</a> operator\nto concatenate \u201cstring\u201d values:</p>\n<div class=\"pine-colorizer not-content\">\"This is a \" + \"concatenated string.\"</div>\n<p>The built-ins in the <code dir=\"auto\">str.*()</code> namespace create \u201cstring\u201d values using\nspecialized operations. For instance, this script creates a <em>formatted\nstring</em> to represent \u201cfloat\u201d price values and displays the result\nusing a label:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Formatted string demo\", overlay = true)\n\n//@variable A \"series string\" value representing the bar's OHLC data.\nstring ohlcString = str.format(\"Open: {0}\\nHigh: {1}\\nLow: {2}\\nClose: {3}\", open, high, low, close)\n\n// Draw a label containing the `ohlcString`.\nlabel.new(bar_index, high, ohlcString, textcolor = color.white)</div>\n<p>See our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/\">Text and shapes</a> for\nmore information about displaying \u201cstring\u201d values from a script.</p>\n<p>Built-in variables such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.tickerid\">syminfo.tickerid</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.currency\">syminfo.currency</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_timeframe.period\">timeframe.period</a>\nreturn values of the \u201cstring\u201d type.</p>\n<h3 class=\"md-heading\" id=\"plot-and-hline\"><a href=\"#plot-and-hline\">plot and hline<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfunctions return IDs that respectively reference instances of the\n\u201cplot\u201d and \u201chline\u201d types. These types display calculated values and\nhorizontal levels on the chart, and one can assign their IDs to\nvariables for use with the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction.</p>\n<p>For example, this script plots two EMAs on the chart and fills the space\nbetween them using a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\ncall:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"plot fill demo\", overlay = true)\n\n//@variable A \"series float\" value representing a 10-bar EMA of `close`.\nfloat emaFast = ta.ema(close, 10)\n//@variable A \"series float\" value representing a 20-bar EMA of `close`.\nfloat emaSlow = ta.ema(close, 20)\n\n//@variable The plot of the `emaFast` value.\nemaFastPlot = plot(emaFast, \"Fast EMA\", color.orange, 3)\n//@variable The plot of the `emaSlow` value.\nemaSlowPlot = plot(emaSlow, \"Slow EMA\", color.gray, 3)\n\n// Fill the space between the `emaFastPlot` and `emaSlowPlot`.\nfill(emaFastPlot, emaSlowPlot, color.new(color.purple, 50), \"EMA Fill\")</div>\n<p>It\u2019s important to note that unlike other special types, there is no\n<code dir=\"auto\">plot</code> or <code dir=\"auto\">hline</code> keyword in Pine to explicitly declare a variable\u2019s\ntype as \u201cplot\u201d or \u201chline\u201d.</p>\n<p>Users can control where their scripts\u2019 plots display via the variables\nin the <code dir=\"auto\">display.*</code> namespace and a <code dir=\"auto\">plot*()</code> function\u2019s <code dir=\"auto\">force_overlay</code>\nparameter. Additionally, one script can use the values from another\nscript\u2019s plots as <em>external inputs</em> via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.source\">input.source()</a>\nfunction (see our User Manual\u2019s section on\n<a href=\"/pine-script-docs/v5/concepts/inputs/#source-input\">source inputs</a>).</p>\n<h3 class=\"md-heading\" id=\"drawing-types\"><a href=\"#drawing-types\">Drawing types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script drawing types allow scripts to create custom drawings on\ncharts. They include the following:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>.</p>\n<p>Each type also has a namespace containing all the built-ins that create\nand manage drawing instances. For example, the following <code dir=\"auto\">*.new()</code>\nconstructors create new objects of these types in a script:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill.new\">linefill.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.new\">table.new()</a>.</p>\n<p>Each of these functions returns an <em>ID</em> which is a reference that\nuniquely identifies a drawing object. IDs are always qualified as\n\u201cseries\u201d, meaning their qualified types are \u201cseries line\u201d, \u201cseries\nlabel\u201d, etc. Drawing IDs act like pointers, as each ID references a\nspecific instance of a drawing in all the functions from that drawing\u2019s\nnamespace. For instance, the ID of a line returned by a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>\ncall is used later to refer to that specific object once it\u2019s time to\ndelete it with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.delete\">line.delete()</a>.</p>\n<h3 class=\"md-heading\" id=\"chart-points\"><a href=\"#chart-points\">Chart points<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Chart points are special types that represent coordinates on the chart.\nScripts use the information from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobjects to determine the chart locations of\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nand <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>.</p>\n<p>Objects of this type contain three <em>fields</em>: <code dir=\"auto\">time</code>, <code dir=\"auto\">index</code>, and\n<code dir=\"auto\">price</code>. Whether a drawing instance uses the <code dir=\"auto\">time</code> or <code dir=\"auto\">price</code> field\nfrom a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nas an x-coordinate depends on the drawing\u2019s <code dir=\"auto\">xloc</code> property.</p>\n<p>We can use any of the following functions to create chart points in a\nscript:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.new\">chart.point.new()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nwith a specified <code dir=\"auto\">time</code>, <code dir=\"auto\">index</code>, and <code dir=\"auto\">price</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nwith a specified <code dir=\"auto\">price</code> y-coordinate. The <code dir=\"auto\">time</code> and <code dir=\"auto\">index</code> fields\ncontain the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nof the bar the function executes on.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.from_index\">chart.point_from_index()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nwith an <code dir=\"auto\">index</code> x-coordinate and <code dir=\"auto\">price</code> y-coordinate. The <code dir=\"auto\">time</code>\nfield of the resulting instance is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nmeaning it will not work with drawing objects that use an <code dir=\"auto\">xloc</code>\nvalue of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_time\">xloc.bar_time</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.from_time\">chart.point.from_time()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nwith a <code dir=\"auto\">time</code> x-coordinate and <code dir=\"auto\">price</code> y-coordinate. The <code dir=\"auto\">index</code>\nfield of the resulting instance is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nmeaning it will not work with drawing objects that use an <code dir=\"auto\">xloc</code>\nvalue of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_xloc.bar_index\">xloc.bar_index</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.copy\">chart.point.copy()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\ncontaining the same <code dir=\"auto\">time</code>, <code dir=\"auto\">index</code>, and <code dir=\"auto\">price</code> information as the\n<code dir=\"auto\">id</code> in the function call.</li>\n</ul>\n<p>This example draws lines connecting the previous bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nto the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a> on\neach chart bar. It also displays labels at both points of each line. The\nline and labels get their information from the <code dir=\"auto\">firstPoint</code> and\n<code dir=\"auto\">secondPoint</code> variables, which reference chart points created using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.from_index\">chart.point_from_index()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.now\">chart.point.now()</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Chart points demo\", overlay = true)\n\n//@variable A new `chart.point` at the previous `bar_index` and `high`.\nfirstPoint = chart.point.from_index(bar_index - 1, high[1])\n//@variable A new `chart.point` at the current bar's `low`.\nsecondPoint = chart.point.now(low)\n\n// Draw a new line connecting coordinates from the `firstPoint` and `secondPoint`.\n// This line uses the `index` fields from the points as x-coordinates.\nline.new(firstPoint, secondPoint, color = color.purple, width = 3)\n// Draw a label at the `firstPoint`. Uses the point's `index` field as its x-coordinate.\nlabel.new(\n     firstPoint, str.tostring(firstPoint.price), color = color.green, \n     style = label.style_label_down, textcolor = color.white\n )\n// Draw a label at the `secondPoint`. Uses the point's `index` field as its x-coordinate.\nlabel.new(\n     secondPoint, str.tostring(secondPoint.price), color = color.red, \n     style = label.style_label_up, textcolor = color.white\n )</div>\n<h3 class=\"md-heading\" id=\"collections\"><a href=\"#collections\">Collections<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Collections in Pine Script (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>,\nand <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) utilize reference\nIDs, much like other special types (e.g., labels). The type of the ID\ndefines the type of <em>elements</em> the collection will contain. In Pine, we\nspecify array, matrix, and map types by appending a\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type template</a> to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>,\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nkeywords:</p>\n<ul>\n<li><code dir=\"auto\">array&lt;int&gt;</code> defines an array containing \u201cint\u201d elements.</li>\n<li><code dir=\"auto\">array&lt;label&gt;</code> defines an array containing \u201clabel\u201d IDs.</li>\n<li><code dir=\"auto\">array&lt;UDT&gt;</code> defines an array containing IDs referencing objects of\na\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a>.</li>\n<li><code dir=\"auto\">matrix&lt;float&gt;</code> defines a matrix containing \u201cfloat\u201d elements.</li>\n<li><code dir=\"auto\">matrix&lt;UDT&gt;</code> defines a matrix containing IDs referencing objects of\na\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a>.</li>\n<li><code dir=\"auto\">map&lt;string, float&gt;</code> defines a map containing \u201cstring\u201d keys and\n\u201cfloat\u201d values.</li>\n<li><code dir=\"auto\">map&lt;int, UDT&gt;</code> defines a map containing \u201cint\u201d keys and IDs of\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a> instances as values.</li>\n</ul>\n<p>For example, one can declare an \u201cint\u201d array with a single element\nvalue of 10 in any of the following, equivalent ways:</p>\n<div class=\"pine-colorizer not-content\">a1 = array.new&lt;int&gt;(1, 10)\narray&lt;int&gt; a2 = array.new&lt;int&gt;(1, 10)\na3 = array.from(10)\narray&lt;int&gt; a4 = array.from(10)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">int[]</code> syntax can also specify an array of \u201cint\u201d\nelements, but its use is discouraged. No equivalent exists to\nspecify the types of matrices or maps in that way.</li>\n<li>Type-specific built-ins exist for arrays, such as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dnew_int\">array.new_int()</a>,\nbut the more generic <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array.new&lt;type&gt;</a>\nform is preferred, which would be <code dir=\"auto\">array.new&lt;int&gt;()</code> to create\nan array of \u201cint\u201d elements.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"user-defined-types\"><a href=\"#user-defined-types\">User-defined types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a>\nkeyword allows the creation of <em>user-defined types</em> (UDTs) from which\nscripts can create <a href=\"/pine-script-docs/v5/language/objects/\">objects</a>. UDTs are composite types; they contain an arbitrary number\nof <em>fields</em> that can be of any type, including other user-defined types.</p>\n<p>The syntax to declare a user-defined type is:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[export ]type &lt;UDT_identifier&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_type&gt; &lt;field_name&gt;[ = &lt;value&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">...</span></div></div></code></pre></figure></link></div>\n<p>where:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_export\">export</a>\nis the keyword that a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library</a>\nscript uses to export the user-defined type. To learn more about\nexporting UDTs, see our User Manual\u2019s\n<a href=\"/pine-script-docs/v5/concepts/libraries/#user-defined-types-and-objects\">Libraries</a>\npage.</li>\n<li><code dir=\"auto\">&lt;UDT_identifier&gt;</code> is the name of the user-defined type.</li>\n<li><code dir=\"auto\">&lt;field_type&gt;</code> is the type of the field.</li>\n<li><code dir=\"auto\">&lt;field_name&gt;</code> is the name of the field.</li>\n<li><code dir=\"auto\">&lt;value&gt;</code> is an optional default value for the field, which the\nscript will assign to it when creating new objects of that UDT. If\none does not provide a value, the field\u2019s default is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>.\nThe same rules as those governing the default values of parameters\nin function signatures apply to the default values of fields. For\nexample, a UDT\u2019s default values cannot use results from the\nhistory-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\nor expressions.</li>\n</ul>\n<p>This example declares a <code dir=\"auto\">pivotPoint</code> UDT with an \u201cint\u201d <code dir=\"auto\">pivotTime</code>\nfield and a \u201cfloat\u201d <code dir=\"auto\">priceLevel</code> field that will respectively hold\ntime and price information about a calculated pivot:</p>\n<div class=\"pine-colorizer not-content\">    //@type             A user-defined type containing pivot information.\n    //@field pivotTime  Contains time information about the pivot.\n    //@field priceLevel Contains price information about the pivot.\n    type pivotPoint\n        int   pivotTime\n        float priceLevel</div>\n<p>User-defined types support <em>type recursion</em>, i.e., the fields of a UDT\ncan reference objects of the same UDT. Here, we\u2019ve added a <code dir=\"auto\">nextPivot</code>\nfield to our previous <code dir=\"auto\">pivotPoint</code> type that references another\n<code dir=\"auto\">pivotPoint</code> instance:</p>\n<div class=\"pine-colorizer not-content\">    //@type             A user-defined type containing pivot information.\n    //@field pivotTime  Contains time information about the pivot.\n    //@field priceLevel Contains price information about the pivot.\n    //@field nextPivot  A `pivotPoint` instance containing additional pivot information.\n    type pivotPoint\n        int        pivotTime\n        float      priceLevel\n        pivotPoint nextPivot</div>\n<p>Scripts can use two built-in methods to create and copy UDTs: <code dir=\"auto\">new()</code>\nand <code dir=\"auto\">copy()</code>. See our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/language/objects/\">Objects</a> to learn more\nabout working with UDTs.</p>\n<h3 class=\"md-heading\" id=\"enum-types\"><a href=\"#enum-types\">Enum types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_enum\">enum</a> keyword allows the creation of an <em>enum</em>, otherwise known as an <em>enumeration</em>, <em>enumerated type</em>, or <em>enum type</em>. An enum is a unique type construct containing distinct, named fields representing <em>members</em> (i.e., possible values) of the type. Enums allow programmers to control the values accepted by variables, conditional expressions, and <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>, and they facilitate convenient dropdown <a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">input</a> creation with the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a> function.</p>\n<p>The syntax to declare an enum is as follows:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[export ]enum &lt;enumName&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_1&gt;[ = &lt;title_1&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_2&gt;[ = &lt;title_2&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;field_N&gt;[ = &lt;title_N&gt;]</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_export\">export</a>\nis the optional keyword allowing a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library</a>\nto export the enum for use in other scripts. See\n<a href=\"/pine-script-docs/v5/concepts/libraries/#enum-types\">this section</a> to learn more about exporting enum types.</li>\n<li><code dir=\"auto\">&lt;enumName&gt;</code> is the name of the enum type. Scripts can use the\nenum\u2019s name as the type keyword in\n<a href=\"/pine-script-docs/v5/language/variable-declarations/\">variable declarations</a> and\n<a href=\"/pine-script-docs/v5/language/type-system/#type-templates\">type templates</a>.</li>\n<li><code dir=\"auto\">&lt;field_*&gt;</code> is the name of an enum field, representing a named\nmember (value) of the <code dir=\"auto\">enumName</code> type. Each field must have a unique\nname that does not match the name or title of any other field in the\nenum. To retrieve an enum member, reference its field name using dot\nnotation syntax (i.e., <code dir=\"auto\">enumName.fieldName</code>).</li>\n<li><code dir=\"auto\">&lt;title_*&gt;</code> is a \u201cconst string\u201d title assigned to a field. If one\ndoes not specify a title, the field\u2019s title is the \u201cstring\u201d\nrepresentation of its name. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\nfunction displays field titles within its dropdown in the script\u2019s\n\u201cSettings/Inputs\u201d tab. Users can also retrieve a field\u2019s title\nwith the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\nfunction. As with field names, each field\u2019s title must not match\nthe name or title of any other field in the enum.</li>\n</ul>\n<p>This example declares an <code dir=\"auto\">maChoice</code> enum. Each field within this\ndeclaration represents a distinct member of the <code dir=\"auto\">maChoice</code> enum type:</p>\n<div class=\"pine-colorizer not-content\">//@enum       An enumeration of named values for moving average selection.\n//@field sma  Selects a Simple Moving Average.\n//@field ema  Selects an Exponential Moving Average.\n//@field wma  Selects a Weighted Moving Average.\n//@field hma  Selects a Hull Moving Average.\nenum maChoice\n    sma  = \"Simple Moving Average\"\n    ema  = \"Exponential Moving Average\"\n    wma  = \"Weighted Moving Average\"\n    hma  = \"Hull Moving Average\"</div>\n<p>Note that:</p>\n<ul>\n<li>All the enum\u2019s possible values are available upon the <em>first</em>\nscript execution and do not change across subsequent executions.\nHence, they automatically adopt the\n<a href=\"/pine-script-docs/v5/language/type-system/#simple\">simple</a> qualifier.</li>\n</ul>\n<p>The script below uses the <code dir=\"auto\">maChoice</code> enum within an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.enum\">input.enum()</a>\ncall to create a <em>dropdown</em> input in the \u201cSettings/Inputs\u201d tab that\ndisplays all the field titles. The <code dir=\"auto\">maInput</code> value represents the member\nof the enum that corresponds to the user-selected title. The script uses\nthe selected member within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure to determine the built-in moving average it calculates:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Enum types demo\", overlay = true)\n\n//@enum       An enumeration of named values for moving average selection.\n//@field sma  Selects a Simple Moving Average.\n//@field ema  Selects an Exponential Moving Average.\n//@field wma  Selects a Weighted Moving Average.\n//@field hma  Selects a Hull Moving Average.\nenum maChoice\n    sma  = \"Simple Moving Average\"\n    ema  = \"Exponential Moving Average\"\n    wma  = \"Weighted Moving Average\"\n    hma  = \"Hull Moving Average\"\n\n//@variable The `maChoice` member representing a selected moving average name.\nmaChoice maInput = input.enum(maChoice.sma, \"Moving average type\")\n//@variable The length of the moving average.\nint lengthInput = input.int(20, \"Length\", 1, 4999)\n\n//@variable The moving average selected by the `maInput`. \nfloat selectedMA = switch maInput\n    maChoice.sma =&gt; ta.sma(close, lengthInput)\n    maChoice.ema =&gt; ta.ema(close, lengthInput)\n    maChoice.wma =&gt; ta.wma(close, lengthInput)\n    maChoice.hma =&gt; ta.hma(close, lengthInput)\n\n// Plot the `selectedMA`.\nplot(selectedMA, \"Selected moving average\", color.teal, 3)</div>\n<p>See the <a href=\"/pine-script-docs/v5/language/enums/\">Enums</a> page and the\n<a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">Enum input</a> section of the <a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a> page to learn more about using enums and enum inputs.</p>\n<h3 class=\"md-heading\" id=\"void\"><a href=\"#void\">void<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>There is a \u201cvoid\u201d type in Pine Script. Functions having only\nside-effects and returning no usable result return the \u201cvoid\u201d type. An\nexample of such a function is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alert\">alert()</a>;\nit does something (triggers an alert event), but it returns no usable\nvalue.</p>\n<p>Scripts cannot use \u201cvoid\u201d results in expressions or assign them to\nvariables. No <code dir=\"auto\">void</code> keyword exists in Pine Script since one cannot\ndeclare a variable of the \u201cvoid\u201d type.</p>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"na-value\"><a href=\"#na-value\"><span>\u200b<code dir=\"auto\">na</code>\u200b value</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>There is a special value in Pine Script called\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>,\nwhich is an acronym for <em>not available</em>. We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> to\nrepresent an undefined value from a variable or expression. It is\nsimilar to <code dir=\"auto\">null</code> in Java and <code dir=\"auto\">None</code> in Python.</p>\n<p>Scripts can automatically cast\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues to almost any type. However, in some cases, the compiler cannot\ninfer the type associated with an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value\nbecause more than one type-casting rule may apply. For example:</p>\n<div class=\"pine-colorizer not-content\">// Compilation error!\nmyVar = na</div>\n<p>The above line of code causes a compilation error because the compiler\ncannot determine the nature of the <code dir=\"auto\">myVar</code> variable, i.e., whether the\nvariable will reference numeric values for plotting, string values for\nsetting text in a label, or other values for some other purpose later in\nthe script\u2019s execution.</p>\n<p>To resolve such errors, we must explicitly declare the type associated\nwith the variable. Suppose the <code dir=\"auto\">myVar</code> variable will reference \u201cfloat\u201d\nvalues in subsequent script iterations. We can resolve the error by\ndeclaring the variable with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\nkeyword:</p>\n<div class=\"pine-colorizer not-content\">float myVar = na</div>\n<p>or by explicitly casting the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value\nto the \u201cfloat\u201d type via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_float\">float()</a>\nfunction:</p>\n<div class=\"pine-colorizer not-content\">myVar = float(na)</div>\n<p>To test if the value from a variable or expression is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, we\ncall the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_na\">na()</a>\nfunction, which returns <code dir=\"auto\">true</code> if the value is undefined. For example:</p>\n<div class=\"pine-colorizer not-content\">//@variable Is 0 if the `myVar` is `na`, `close` otherwise.\nfloat myClose = na(myVar) ? 0 : close</div>\n<p>Do not use the <code dir=\"auto\">==</code> comparison operator to test for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues, as scripts cannot determine the equality of an undefined value:</p>\n<div class=\"pine-colorizer not-content\">//@variable Returns the `close` value. The script cannot compare the equality of `na` values, as they're undefined.\nfloat myClose = myVar == na ? 0 : close</div>\n<p>Best coding practices often involve handling\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues to prevent undefined values in calculations.</p>\n<p>We can ensure the expression also returns an actionable value on the\nfirst bar by replacing the undefined past value with a value from the\ncurrent bar. This line of code uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a>\nfunction to replace the past bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nwith the current bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_open\">open</a>\nwhen the value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>:</p>\n<div class=\"pine-colorizer not-content\">//@variable Is `true` when the `close` exceeds the last bar's `close` (or the current `open` if the value is `na`).\nbool risingClose = close &gt; nz(close[1], open)</div>\n<p>Protecting scripts against\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\ninstances helps to prevent undefined values from propagating in a\ncalculation\u2019s results. For example, this script declares an\n<code dir=\"auto\">allTimeHigh</code> variable on the first bar. It then uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.max\">math.max()</a>\nbetween the <code dir=\"auto\">allTimeHigh</code> and the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nto update the <code dir=\"auto\">allTimeHigh</code> throughout its execution:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"na protection demo\", overlay = true)\n\n//@variable The result of calculating the all-time high price with an initial value of `na`.\nvar float allTimeHigh = na\n\n// Reassign the value of the `allTimeHigh`.\n// Returns `na` on all bars because `math.max()` can't compare the `high` to an undefined value.\nallTimeHigh := math.max(allTimeHigh, high)\n\nplot(allTimeHigh) // Plots `na` on all bars.</div>\n<p>This script plots a value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> on\nall bars, as we have not included any\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nprotection in the code. To fix the behavior and plot the intended result\n(i.e., the all-time high of the chart\u2019s prices), we can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_nz\">nz()</a> to\nreplace\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues in the <code dir=\"auto\">allTimeHigh</code> series:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"na protection demo\", overlay = true)\n\n//@variable The result of calculating the all-time high price with an initial value of `na`.\nvar float allTimeHigh = na\n\n// Reassign the value of the `allTimeHigh`.\n// We've used `nz()` to prevent the initial `na` value from persisting throughout the calculation.\nallTimeHigh := math.max(nz(allTimeHigh), high)\n\nplot(allTimeHigh)</div>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"type-templates\"><a href=\"#type-templates\">Type templates<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Type templates specify the data types that collections\n(<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>,\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and\n<a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) can contain.</p>\n<p>Templates for <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a> consist of a\nsingle type identifier surrounded by angle brackets, e.g., <code dir=\"auto\">&lt;int&gt;</code>,\n<code dir=\"auto\">&lt;label&gt;</code>, and <code dir=\"auto\">&lt;PivotPoint&gt;</code> (where <code dir=\"auto\">PivotPoint</code> is a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a>).</p>\n<p>Templates for <a href=\"/pine-script-docs/v5/language/maps/\">maps</a> consist of\ntwo type identifiers enclosed in angle brackets, where the first\nspecifies the type of <em>keys</em> in each key-value pair, and the second\nspecifies the <em>value</em> type. For example, <code dir=\"auto\">&lt;string, float&gt;</code> is a type\ntemplate for a map that holds <code dir=\"auto\">string</code> keys and <code dir=\"auto\">float</code> values.</p>\n<p>Users can construct type templates from:</p>\n<ul>\n<li>Fundamental types:\n<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#bool\">bool</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>,\nand <a href=\"/pine-script-docs/v5/language/type-system/#string\">string</a></li>\n<li>The following special types:\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">line</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">linefill</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">box</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">polyline</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">label</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">table</a>, and\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart.point</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">User-defined types (UDTs)</a></li>\n<li><a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">Enum types</a></li>\n</ul>\n<p>Note that:</p>\n<ul>\n<li><a href=\"/pine-script-docs/v5/language/maps/\">Maps</a> can use any of\nthese types as <em>values</em>, but they can only accept fundamental\ntypes or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a> as <em>keys</em>.</li>\n</ul>\n<p>Scripts use type templates to declare variables that reference\ncollections, and when creating new collection instances. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Type templates demo\")\n\n//@variable A variable initially assigned to `na` that accepts arrays of \"int\" values.\narray&lt;int&gt; intArray = na\n//@variable An empty matrix that holds \"float\" values.\nfloatMatrix = matrix.new&lt;float&gt;()\n//@variable An empty map that holds \"string\" keys and \"color\" values.\nstringColorMap = map.new&lt;string, color&gt;()</div>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"type-casting\"><a href=\"#type-casting\">Type casting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script includes an automatic type-casting mechanism that <em>casts</em>\n(converts) <strong>\u201cint\u201d</strong> values to <strong>\u201cfloat\u201d</strong> when necessary. Variables\nor expressions requiring \u201cfloat\u201d values can also use \u201cint\u201d values\nbecause any integer can be represented as a floating point number with\nits fractional part equal to 0.</p>\n<p>For the sake of backward compatibility, Pine Script also automatically\ncasts <strong>\u201cint\u201d</strong> and <strong>\u201cfloat\u201d</strong> values to <strong>\u201cbool\u201d</strong> when\nnecessary. When passing numeric values to the parameters of functions\nand operations that expect \u201cbool\u201d types, Pine auto-casts them to\n\u201cbool\u201d. However, we do not recommend relying on this behavior. Most\nscripts that automatically cast numeric values to the \u201cbool\u201d type will\nproduce a <em>compiler warning</em>. One can avoid the compiler warning and\npromote code readability by using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bool\">bool()</a>\nfunction, which explicitly casts a numeric value to the \u201cbool\u201d type.</p>\n<p>When casting an \u201cint\u201d or \u201cfloat\u201d to \u201cbool\u201d, a value of 0 converts\nto <code dir=\"auto\">false</code> and any other numeric value always converts to <code dir=\"auto\">true</code>.</p>\n<p>This code below demonstrates deprecated auto-casting behavior in Pine.\nIt creates a <code dir=\"auto\">randomValue</code> variable with a \u201cseries float\u201d value on\nevery bar, which it passes to the <code dir=\"auto\">condition</code> parameter in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure and the <code dir=\"auto\">series</code> parameter in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nfunction call. Since both parameters accept \u201cbool\u201d values, the script\nautomatically casts the <code dir=\"auto\">randomValue</code> to \u201cbool\u201d when evaluating them:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Auto-casting demo\", overlay = true)\n\n//@variable A random rounded value between -1 and 1.\nfloat randomValue = math.round(math.random(-1, 1))\n//@variable The color of the chart background.\ncolor bgColor = na\n\n// This raises a compiler warning since `randomValue` is a \"float\", but `if` expects a \"bool\".\nif randomValue\n    bgColor := color.new(color.blue, 60)\n// This does not raise a warning, as the `bool()` function explicitly casts the `randomValue` to \"bool\".\nif bool(randomValue)\n    bgColor := color.new(color.blue, 60)\n\n// Display unicode characters on the chart based on the `randomValue`.\n// Whenever `math.random()` returns 0, no character will appear on the chart because 0 converts to `false`.\nplotchar(randomValue)\n// We recommend explicitly casting the number with the `bool()` function to make the type transformation more obvious.\nplotchar(bool(randomValue))\n\n// Highlight the background with the `bgColor`.\nbgcolor(bgColor)</div>\n<p>It\u2019s sometimes necessary to cast one type to another when auto-casting\nrules do not suffice. For such cases, the following type-casting\nfunctions are available:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_int\">int()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_float\">float()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bool\">bool()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color\">color()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_string\">string()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line\">line()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill\">linefill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label\">label()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box\">box()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table\">table()</a>.</p>\n<p>The example below shows a code that tries to use a \u201cconst float\u201d value\nas the <code dir=\"auto\">length</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\nfunction call. The script will fail to compile, as it cannot\nautomatically convert the \u201cfloat\u201d value to the required \u201cint\u201d type:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Explicit casting demo\", overlay = true)\n\n//@variable The length of the SMA calculation. Qualified as \"const float\".\nfloat LENGTH = 10.0\n\nfloat sma = ta.sma(close, LENGTH) // Compilation error. The `length` parameter requires an \"int\" value.\n\nplot(sma)</div>\n<p>The code raises the following error: <em>\u201cCannot call \u2018ta.sma\u2019 with\nargument \u2018length\u2019=\u2018LENGTH\u2019. An argument of \u2018const float\u2019 type was\nused but a \u2018series int\u2019 is expected.\u201d</em></p>\n<p>The compiler is telling us that the code is using a \u201cfloat\u201d value\nwhere an \u201cint\u201d is required. There is no auto-casting rule to cast a\n\u201cfloat\u201d to an \u201cint\u201d, so we must do the job ourselves. In this\nversion of the code, we\u2019ve used the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_int\">int()</a>\nfunction to explicitly convert our \u201cfloat\u201d <code dir=\"auto\">LENGTH</code> value to the\n\u201cint\u201d type within the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\ncall:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"explicit casting demo\")\n\n//@variable The length of the SMA calculation. Qualified as \"const float\".\nfloat LENGTH = 10.0\n\nfloat sma = ta.sma(close, int(LENGTH)) // Compiles successfully since we've converted the `LENGTH` to \"int\".\n\nplot(sma)</div>\n<p>Explicit type casting is also handy when declaring variables assigned to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, as\nexplained in the\n<a href=\"/pine-script-docs/v5/language/type-system/#na-value\">previous section</a>.</p>\n<p>For example, once could explicitly declare a variable with a value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> as a\n\u201clabel\u201d type in either of the following, equivalent ways:</p>\n<div class=\"pine-colorizer not-content\">// Explicitly specify that the variable references \"label\" objects:\nlabel myLabel = na\n\n// Explicitly cast the `na` value to the \"label\" type:\nmyLabel = label(na)</div>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/type-system", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tuples\"><a href=\"#tuples\">Tuples<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A <em>tuple</em> is a comma-separated set of expressions enclosed in brackets.\nWhen a function, <a href=\"/pine-script-docs/v5/language/methods/\">method</a>,\nor other local block returns more than one value, scripts return those\nvalues in the form of a tuple.</p>\n<p>For example, the following\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> returns the sum and product of two \u201cfloat\u201d values:</p>\n<div class=\"pine-colorizer not-content\">//@function Calculates the sum and product of two values.\ncalcSumAndProduct(float a, float b) =&gt;\n    //@variable The sum of `a` and `b`.\n    float sum = a + b\n    //@variable The product of `a` and `b`.\n    float product = a * b\n    // Return a tuple containing the `sum` and `product`.\n    [sum, product]</div>\n<p>When we call this function later in the script, we use a <em>tuple\ndeclaration</em> to declare multiple variables corresponding to the values\nreturned by the function call:</p>\n<div class=\"pine-colorizer not-content\">// Declare a tuple containing the sum and product of the `high` and `low`, respectively.\n[hlSum, hlProduct] = calcSumAndProduct(high, low)</div>\n<p>Keep in mind that unlike declaring single variables, we cannot\nexplicitly define the types the tuple\u2019s variables (<code dir=\"auto\">hlSum</code> and\n<code dir=\"auto\">hlProduct</code> in this case), will contain. The compiler automatically\ninfers the types associated with the variables in a tuple.</p>\n<p>In the above example, the resulting tuple contains values of the same\ntype (\u201cfloat\u201d). However, it\u2019s important to note that tuples can\ncontain values of <em>multiple types</em>. For example, the <code dir=\"auto\">chartInfo()</code>\nfunction below returns a tuple containing \u201cint\u201d, \u201cfloat\u201d, \u201cbool\u201d,\n\u201ccolor\u201d, and \u201cstring\u201d values:</p>\n<div class=\"pine-colorizer not-content\">//@function Returns information about the current chart.\nchartInfo() =&gt;\n    //@variable The first visible bar's UNIX time value.\n    int firstVisibleTime = chart.left_visible_bar_time\n    //@variable The `close` value at the `firstVisibleTime`.\n    float firstVisibleClose = ta.valuewhen(ta.cross(time, firstVisibleTime), close, 0)\n    //@variable Is `true` when using a standard chart type, `false` otherwise.\n    bool isStandard = chart.is_standard\n    //@variable The foreground color of the chart.\n    color fgColor = chart.fg_color\n    //@variable The ticker ID of the current chart.\n    string symbol = syminfo.tickerid\n    // Return a tuple containing the values. \n    [firstVisibleTime, firstVisibleClose, isStandard, fgColor, symbol]</div>\n<p>Tuples are especially handy for requesting multiple values in one\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall.</p>\n<p>For instance, this <code dir=\"auto\">roundedOHLC()</code> function returns a tuple containing\nOHLC values rounded to the nearest prices that are divisible by the\nsymbol\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.mintick\">minimum\ntick</a>\nvalue. We call this function as the <code dir=\"auto\">expression</code> argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto request a tuple containing daily OHLC values:</p>\n<div class=\"pine-colorizer not-content\">//@function Returns a tuple of OHLC values, rounded to the nearest tick.\nroundedOHLC() =&gt;\n    [math.round_to_mintick(open), math.round_to_mintick(high), math.round_to_mintick(low), math.round_to_mintick(close)]\n\n[op, hi, lo, cl] = request.security(syminfo.tickerid, \"D\", roundedOHLC())</div>\n<p>We can also achieve the same result by directly passing a tuple of\nrounded values as the <code dir=\"auto\">expression</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall:</p>\n<div class=\"pine-colorizer not-content\">[op, hi, lo, cl] = request.security(\n     syminfo.tickerid, \"D\", \n     [math.round_to_mintick(open), math.round_to_mintick(high), math.round_to_mintick(low), math.round_to_mintick(close)]\n )</div>\n<p>Local blocks of\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>, including\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstatements, can return tuples. For example:</p>\n<div class=\"pine-colorizer not-content\">[v1, v2] = if close &gt; open\n    [high, close]\nelse\n    [close, low]</div>\n<p>and:</p>\n<div class=\"pine-colorizer not-content\">[v1, v2] = switch \nclose &gt; open =&gt; [high, close]\n=&gt;              [close, low]</div>\n<p>However, ternaries cannot contain tuples, as the return values in a\nternary statement are not considered local blocks:</p>\n<div class=\"pine-colorizer not-content\">// Not allowed.\n[v1, v2] = close &gt; open ? [high, close] : [close, low]</div>\n<p>Note that all items within a tuple returned from a function are\nqualified as \u201csimple\u201d or \u201cseries\u201d, depending on its contents. If a\ntuple contains a \u201cseries\u201d value, all other elements within the tuple\nwill also adopt the \u201cseries\u201d qualifier. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Qualified types in tuples demo\")\n\nmakeTicker(simple string prefix, simple string ticker) =&gt;\n    tId = prefix + \":\" + ticker // simple string\n    source = close  // series float\n    [tId, source]\n\n// Both variables are series now. \n[tId, source] = makeTicker(\"BATS\", \"AAPL\") \n\n// Error cannot call 'request.security' with 'series string' tId.\nr = request.security(tId, \"\", source)\n\nplot(r)</div>", "segment_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "8b681cb3c4e5846e4dd25cede285ec924d24b9e4269de7c7022d170a4139f124", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/user-defined-functions\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"user-defined-functions\"><a href=\"#user-defined-functions\">User-defined functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>User-defined functions are functions that you write, as opposed to the\nbuilt-in functions in Pine Script\u00ae. They are useful to define\ncalculations that you must do repetitevely, or that you want to isolate\nfrom your script\u2019s main section of calculations. Think of user-defined\nfunctions as a way to extend the capabilities of Pine Script, when no\nbuilt-in function will do what you need.</p>\n<p>You can write your functions in two ways:</p>\n<ul>\n<li>In a single line, when they are simple, or</li>\n<li>On multiple lines</li>\n</ul>\n<p>Functions can be located in two places:</p>\n<ul>\n<li>If a function is only used in one script, you can include it in the\nscript where it is used. See our\n<a href=\"/pine-script-docs/v5/writing/style-guide/#function_declarations\">Style guide</a> for recommendations on where to place functions in your\nscript.</li>\n<li>You can create a Pine Script\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">library</a> to include\nyour functions, which makes them reusable in other scripts without\nhaving to copy their code. Distinct requirements exist for library\nfunctions. They are explained in the page on\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">libraries</a>.</li>\n</ul>\n<p>Whether they use one line or multiple lines, user-defined functions have\nthe following characteristics:</p>\n<ul>\n<li>They cannot be embedded. All functions are defined in the script\u2019s\nglobal scope.</li>\n<li>They do not support recursion. It is <strong>not allowed</strong> for a function\nto call itself from within its own code.</li>\n<li>The type of the value returned by a function is determined\nautomatically and depends on the type of arguments used in each\nparticular function call.</li>\n<li>A function\u2019s returned value is that of the last value in the\nfunction\u2019s body.</li>\n<li>Each instance of a function call in a script maintains its own,\nindependent history.</li>\n</ul>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"single-line-functions\"><a href=\"#single-line-functions\">Single-line functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Simple functions can often be written in one line. This is the formal\ndefinition of single-line functions:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;function_declaration&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;identifier&gt;(&lt;parameter_list&gt;) =&gt; &lt;return_value&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;parameter_list&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">{&lt;parameter_definition&gt;{, &lt;parameter_definition&gt;}}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;parameter_definition&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">[&lt;identifier&gt; = &lt;default_value&gt;]</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;return_value&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;statement&gt; | &lt;expression&gt; | &lt;tuple&gt;</span></div></div></code></pre></figure></link></div>\n<p>Here is an example:</p>\n<div class=\"pine-colorizer not-content\">f(x, y) =&gt; x + y</div>\n<p>After the function <code dir=\"auto\">f()</code> has been declared, it\u2019s possible to call it\nusing different types of arguments:</p>\n<div class=\"pine-colorizer not-content\">a = f(open, close)\nb = f(2, 2)\nc = f(open, 2)</div>\n<p>In the example above, the type of variable <code dir=\"auto\">a</code> is <em>series</em> because the\narguments are both <em>series</em>. The type of variable <code dir=\"auto\">b</code> is <em>integer</em>\nbecause arguments are both <em>literal integers</em>. The type of variable <code dir=\"auto\">c</code>\nis <em>series</em> because the addition of a <em>series</em> and <em>literal integer</em>\nproduces a <em>series</em> result.</p>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"multi-line-functions\"><a href=\"#multi-line-functions\">Multi-line functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script also supports multi-line functions with the following\nsyntax:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;identifier&gt;(&lt;parameter_list&gt;) =&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;local_block&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;identifier&gt;(&lt;list of parameters&gt;) =&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;variable declaration&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">...</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;variable declaration or expression&gt;</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;parameter_list&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">{&lt;parameter_definition&gt;{, &lt;parameter_definition&gt;}}</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;parameter_definition&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">[&lt;identifier&gt; = &lt;default_value&gt;]</span></div></div></code></pre></figure></div>\n<p>The body of a multi-line function consists of several statements. Each\nstatement is placed on a separate line and must be preceded by 1\nindentation (4 spaces or 1 tab). The indentation before the statement\nindicates that it is a part of the body of the function and not part of\nthe script\u2019s global scope. After the function\u2019s code, the first\nstatement without an indent indicates the body of the function has\nended.</p>\n<p>Either an expression or a declared variable should be the last statement\nof the function\u2019s body. The result of this expression (or variable)\nwill be the result of the function\u2019s call. For example:</p>\n<div class=\"pine-colorizer not-content\">geom_average(x, y) =&gt;\n    a = x*x\n    b = y*y\n    math.sqrt(a + b)</div>\n<p>The function <code dir=\"auto\">geom_average</code> has two arguments and creates two variables\nin the body: <code dir=\"auto\">a</code> and <code dir=\"auto\">b</code>. The last statement calls the function\n<code dir=\"auto\">math.sqrt</code> (an extraction of the square root). The <code dir=\"auto\">geom_average</code> call\nwill return the value of the last expression: <code dir=\"auto\">(math.sqrt(a + b))</code>.</p>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"scopes-in-the-script\"><a href=\"#scopes-in-the-script\">Scopes in the script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Variables declared outside the body of a function or of other local\nblocks belong to the <em>global</em> scope. User-declared and built-in\nfunctions, as well as built-in variables also belong to the global\nscope.</p>\n<p>Each function has its own <em>local</em> scope. All the variables declared\nwithin the function, as well as the function\u2019s arguments, belong to the\nscope of that function, meaning that it is impossible to reference them\nfrom outside --- e.g., from the global scope or the local scope of\nanother function.</p>\n<p>On the other hand, since it is possible to refer to any variable or\nfunction declared in the global scope from the scope of a function\n(except for self-referencing recursive calls), one can say that the\nlocal scope is embedded into the global scope.</p>\n<p>In Pine Script, nested functions are not allowed, i.e., one cannot\ndeclare a function inside another one. All user functions are declared\nin the global scope. Local scopes cannot intersect with each other.</p>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"functions-that-return-multiple-results\"><a href=\"#functions-that-return-multiple-results\">Functions that return multiple results<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In most cases a function returns only one result, but it is possible to\nreturn a list of results (a <em>tuple</em>-like result):</p>\n<div class=\"pine-colorizer not-content\">fun(x, y) =&gt;\n    a = x+y\n    b = x-y\n    [a, b]</div>\n<p>Special syntax is required for calling such functions:</p>\n<div class=\"pine-colorizer not-content\">[res0, res1] = fun(open, close)\nplot(res0)\nplot(res1)</div>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/user-defined-functions", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"limitations\"><a href=\"#limitations\">Limitations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>User-defined functions can use any of the Pine Script built-ins,\nexcept:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>.</p>", "segment_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "89428d92d93ba60cb114190522646ef0d47732f5d84bc67ce03faddee0bf6cab", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/variable-declarations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/language/variable-declarations\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"variable-declarations\"><a href=\"#variable-declarations\">Variable declarations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/variable-declarations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Variables are <a href=\"/pine-script-docs/v5/language/identifiers/\">identifiers</a> that hold values. They must be <em>declared</em> in your code\nbefore you use them. The syntax of variable declarations is:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">[&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt; = &lt;expression&gt; | &lt;structure&gt;</span></div></div></code></pre></figure></link></div>\n<p>or</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;tuple_declaration&gt; = &lt;function_call&gt; | &lt;structure&gt;</span></div></div></code></pre></figure></div>\n<p>where:</p>\n<ul>\n<li><code dir=\"auto\">|</code> means \u201cor\u201d, and parts enclosed in square brackets (<code dir=\"auto\">[]</code>) can\nappear zero or one time.</li>\n<li>&lt;declaration_mode&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#declaration-modes\">declaration mode</a>. It can be\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>,\nor nothing.</li>\n<li>&lt;type&gt; is optional, as in almost all Pine Script\u00ae variable\ndeclarations (see <a href=\"/pine-script-docs/v5/language/type-system/#types\">types</a>).</li>\n<li>&lt;identifier&gt; is the variable\u2019s\n<a href=\"/pine-script-docs/v5/language/identifiers/\">name</a>.</li>\n<li>&lt;expression&gt; can be a literal, a variable, an expression or a\nfunction call.</li>\n<li>&lt;structure&gt; can be an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\n<em>structure</em>.</li>\n<li>&lt;tuple_declaration&gt; is a comma-separated list of variable names\nenclosed in square brackets (<code dir=\"auto\">[]</code>), e.g.,\n<code dir=\"auto\">[ma, upperBand, lowerBand]</code>.</li>\n</ul>\n<p>These are all valid variable declarations. The last one requires four\nlines:</p>\n<div class=\"pine-colorizer not-content\">BULL_COLOR = color.lime\ni = 1\nlen = input(20, \"Length\")\nfloat f = 10.5\ncloseRoundedToTick = math.round_to_mintick(close)\nst = ta.supertrend(4, 14)\nvar barRange = float(na)\nvar firstBarOpen = open\nvarip float lastClose = na\n[macdLine, signalLine, histLine] = ta.macd(close, 12, 26, 9)\nplotColor = if close &gt; open\n    color.green\nelse\n    color.red</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The above statements all contain the <code dir=\"auto\">=</code> assignment operator because\nthey are <strong>variable declarations</strong>. When you see similar lines using the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a>\nreassignment operator, the code is <strong>reassigning</strong> a value to a variable\nthat was <strong>already declared</strong>. Those are <strong>variable reassignments</strong>. Be\nsure you understand the distinction as this is a common stumbling block\nfor newcomers to Pine Script. See the next\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#variable-reassignment\">Variable reassignment</a> section for details.</p></div></aside>\n<p>The formal syntax of a variable declaration is:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;variable_declaration&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">[&lt;declaration_mode&gt;] [&lt;type&gt;] &lt;identifier&gt; = &lt;expression&gt; | &lt;structure&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">|</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;tuple_declaration&gt; = &lt;function_call&gt; | &lt;structure&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;declaration_mode&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">var | varip</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;type&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span class=\"indent\"><span style=\"--0:#e1e4e8;--1:#24292e\">    </span></span><span style=\"--0:#e1e4e8;--1:#24292e\">int | float | bool | color | string | line | linefill | label | box | table | array&lt;type&gt; | matrix&lt;type&gt; | UDF</span></div></div></code></pre></figure></div>\n<h3 class=\"md-heading\" id=\"initialization-with-na\"><a href=\"#initialization-with-na\"><span>Initialization with \u200b<code dir=\"auto\">na</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In most cases, an explicit type declaration is redundant because type is\nautomatically inferred from the value on the right of the <code dir=\"auto\">=</code> at compile\ntime, so the decision to use them is often a matter of preference. For\nexample:</p>\n<div class=\"pine-colorizer not-content\">baseLine0 = na          // compile time error!\nfloat baseLine1 = na    // OK\nbaseLine2 = float(na)   // OK</div>\n<p>In the first line of the example, the compiler cannot determine the type\nof the <code dir=\"auto\">baseLine0</code> variable because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> is a\ngeneric value of no particular type. The declaration of the <code dir=\"auto\">baseLine1</code>\nvariable is correct because its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\ntype is declared explicitly. The declaration of the <code dir=\"auto\">baseLine2</code> variable\nis also correct because its type can be derived from the expression\n<code dir=\"auto\">float(na)</code>, which is an explicit cast of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> value\nto the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\ntype. The declarations of <code dir=\"auto\">baseLine1</code> and <code dir=\"auto\">baseLine2</code> are equivalent.</p>\n<h3 class=\"md-heading\" id=\"tuple-declarations\"><a href=\"#tuple-declarations\">Tuple declarations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Function calls or structures are allowed to return multiple values. When\nwe call them and want to store the values they return, a <em>tuple\ndeclaration</em> must be used, which is a comma-separated set of one or more\nvalues enclosed in brackets. This allows us to declare multiple\nvariables simultaneously. As an example, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dbb\">ta.bb()</a>\nbuilt-in function for Bollinger bands returns three values:</p>\n<div class=\"pine-colorizer not-content\">[bbMiddle, bbUpper, bbLower] = ta.bb(close, 5, 4)</div>\n<h3 class=\"md-heading\" id=\"using-an-underscore-_-as-an-identifier\"><a href=\"#using-an-underscore-_-as-an-identifier\"><span>Using an underscore (\u200b<code dir=\"auto\">_</code>\u200b) as an identifier</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When declaring a variable, it is possible to use a single underscore (<code dir=\"auto\">_</code>) as its identifier. A value assigned to such a variable cannot be accessed. You can assign any number of values to a <code dir=\"auto\">_</code> identifier anywhere in the script, even if the current scope already has such an assignment.</p>\n<p>This is particularly useful when a tuple returns unneeded values. Let\u2019s write another Bollinger Bands script. Here, we only need the bands themselves, without the center line:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Underscore demo\")\n\n// We do not need the middle Bollinger Bands value, and do not use it.\n// To make this clear, we assign it to the `_` identifier.\n[_, bbUpper, bbLower] = ta.bb(close, 5, 4)\n\n// We can continue to use `_` in the same code without causing compilation errors:\n[bbMiddleLong, _, _] = ta.bb(close, 20, 2)\n\nplot(bbUpper)</div>", "segment_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/variable-declarations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"variable-reassignment\"><a href=\"#variable-reassignment\">Variable reassignment<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A variable reassignment is done using the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a>\nreassignment operator. It can only be done after a variable has been\nfirst declared and given an initial value. Reassigning a new value to a\nvariable is often necessary in calculations, and it is always necessary\nwhen a variable from the global scope must be assigned a new value from\nwithin a structure\u2019s local block, e.g.:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\", \"\", true)\nsensitivityInput = input.int(2, \"Sensitivity\", minval = 1, tooltip = \"Higher values make color changes less sensitive.\")\nma = ta.sma(close, 20)\nmaUp = ta.rising(ma, sensitivityInput)\nmaDn = ta.falling(ma, sensitivityInput)\n\n// On first bar only, initialize color to gray\nvar maColor = color.gray\nif maUp\n    // MA has risen for two bars in a row; make it lime.\n    maColor := color.lime\nelse if maDn\n    // MA has fallen for two bars in a row; make it fuchsia.\n    maColor := color.fuchsia\n\nplot(ma, \"MA\", maColor, 2)</div>\n<p>Note that:</p>\n<ul>\n<li>We initialize <code dir=\"auto\">maColor</code> on the first bar only, so it preserves its\nvalue across bars.</li>\n<li>On every bar, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstatement checks if the MA has been rising or falling for the\nuser-specified number of bars (the default is 2). When that happens,\nthe value of <code dir=\"auto\">maColor</code> must be reassigned a new value from within\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nlocal blocks. To do this, we use the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a> reassignment operator.</li>\n<li>If we did not use the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a> reassignment operator, the effect would be to initialize\na new <code dir=\"auto\">maColor</code> local variable which would have the same name as\nthat of the global scope, but actually be a very confusing\nindependent entity that would persist only for the length of the\nlocal block, and then disappear without a trace.</li>\n</ul>\n<p>All user-defined variables in Pine Script are <em>mutable</em>, which means\ntheir value can be changed using the\n<a href=\"/pine-script-docs/v5/language/operators/#-reassignment-operator\">:=</a>\nreassignment operator. Assigning a new value to a variable may change\nits <em>type qualifier</em> (see the page on Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/\">type system</a> for more\ninformation). A variable can be assigned a new value as many times as\nneeded during the script\u2019s execution on one bar, so a script can\ncontain any number of reassignments of one variable. A variable\u2019s\n<a href=\"/pine-script-docs/v5/language/variable-declarations/#declaration-modes\">declaration mode</a> determines how new values assigned to a variable will be\nsaved.</p>", "segment_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/language/variable-declarations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"declaration-modes\"><a href=\"#declaration-modes\">Declaration modes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Understanding the impact that declaration modes have on the behavior of\nvariables requires prior knowledge of Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a>.</p>\n<p>When you declare a variable, if a declaration mode is specified, it must\ncome first. Three modes can be used:</p>\n<ul>\n<li>\u201cOn each bar\u201d, when none is specified</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a></li>\n</ul>\n<h3 class=\"md-heading\" id=\"on-each-bar\"><a href=\"#on-each-bar\">On each bar<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When no explicit declaration mode is specified, i.e. no\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeyword is used, the variable is declared and initialized on each bar,\ne.g., the following declarations from our first set of examples in this\npage\u2019s introduction:</p>\n<div class=\"pine-colorizer not-content\">BULL_COLOR = color.lime\ni = 1\nlen = input(20, \"Length\")\nfloat f = 10.5\ncloseRoundedToTick = math.round_to_mintick(close)\nst = ta.supertrend(4, 14)\n[macdLine, signalLine, histLine] = ta.macd(close, 12, 26, 9)\nplotColor = if close &gt; open\n    color.green\nelse\n    color.red</div>\n<h3 class=\"md-heading\" id=\"var\"><a href=\"#var\"><span>\u200b<code dir=\"auto\">var</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword is used, the variable is only initialized once, on the first bar\nif the declaration is in the global scope, or the first time the local\nblock is executed if the declaration is inside a local block. After\nthat, it will preserve its last value on successive bars, until we\nreassign a new value to it. This behavior is very useful in many cases\nwhere a variable\u2019s value must persist through the iterations of a\nscript across successive bars. For example, suppose we\u2019d like to count\nthe number of green bars on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Green Bars Count\")\nvar count = 0\nisGreen = close &gt;= open\nif isGreen\n    count := count + 1\nplot(count)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/GreenBarsCount.Cx1nQdL0_Z2kYId.webp\" width=\"1600\"/></p>\n<p>Without the <code dir=\"auto\">var</code> modifier, variable <code dir=\"auto\">count</code> would be reset to zero\n(thus losing its value) every time a new bar update triggered a script\nrecalculation.</p>\n<p>Declaring variables on the first bar only is often useful to manage\ndrawings more efficiently. Suppose we want to extend the last bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nline to the right of the right chart. We could write:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inefficient version\", \"\", true)\ncloseLine = line.new(bar_index - 1, close, bar_index, close, extend = extend.right, width = 3)\nline.delete(closeLine[1])</div>\n<p>but this is inefficient because we are creating and deleting the line on\neach historical bar and on each update in the realtime bar. It is more\nefficient to use:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Efficient version\", \"\", true)\nvar closeLine = line.new(bar_index - 1, close, bar_index, close, extend = extend.right, width = 3)\nif barstate.islast\n    line.set_xy1(closeLine, bar_index - 1, close)\n    line.set_xy2(closeLine, bar_index, close)</div>\n<p>Note that:</p>\n<ul>\n<li>We initialize <code dir=\"auto\">closeLine</code> on the first bar only, using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\ndeclaration mode</li>\n<li>We restrict the execution of the rest of our code to the chart\u2019s\nlast bar by enclosing our code that updates the line in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Dislast\">barstate.islast</a>\nstructure.</li>\n</ul>\n<p>There is a very slight penalty performance for using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\ndeclaration mode. For that reason, when declaring constants, it is\npreferable not to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> if\nperformance is a concern, unless the initialization involves\ncalculations that take longer than the maintenance penalty, e.g.,\nfunctions with complex code or string manipulations.</p>\n<h3 class=\"md-heading\" id=\"varip\"><a href=\"#varip\"><span>\u200b<code dir=\"auto\">varip</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Understanding the behavior of variables using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\ndeclaration mode requires prior knowledge of Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and\n<a href=\"/pine-script-docs/v5/concepts/bar-states/\">bar states</a>.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeyword can be used to declare variables that escape the <em>rollback\nprocess</em>, which is explained in the page on Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a>.</p>\n<p>Whereas scripts only execute once at the close of historical bars, when\na script is running in realtime, it executes every time the chart\u2019s\nfeed detects a price or volume update. At every realtime update, Pine\nScript\u2019s runtime normally resets the values of a script\u2019s variables\nto their last committed value, i.e., the value they held when the\nprevious bar closed. This is generally handy, as each realtime script\nexecution starts from a known state, which simplifies script logic.</p>\n<p>Sometimes, however, script logic requires code to be able to save\nvariable values <strong>between different executions</strong> in the realtime bar.\nDeclaring variables with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nmakes that possible. The \u201cip\u201d in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nstands for <em>intrabar persist</em>.</p>\n<p>Let\u2019s look at the following code, which does not use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nint updateNo = na\nif barstate.isnew\n    updateNo := 1\nelse\n    updateNo := updateNo + 1\n\nplot(updateNo, style = plot.style_circles)</div>\n<p>On historical bars,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nis always true, so the plot shows a value of \u201c1\u201d because the <code dir=\"auto\">else</code>\npart of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure is never executed. On realtime bars,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nis only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_true\">true</a>\nwhen the script first executes on the bar\u2019s \u201copen\u201d. The plot will\nthen briefly display \u201c1\u201d until subsequent executions occur. On the\nnext executions during the realtime bar, the second branch of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstatement is executed because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nis no longer true. Since <code dir=\"auto\">updateNo</code> is initialized to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> at\neach execution, the <code dir=\"auto\">updateNo + 1</code> expression yields\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>, so\nnothing is plotted on further realtime executions of the script.</p>\n<p>If we now use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nto declare the <code dir=\"auto\">updateNo</code> variable, the script behaves very differently:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"\")\nvarip int updateNo = na\nif barstate.isnew\n    updateNo := 1\nelse\n    updateNo := updateNo + 1\n\nplot(updateNo, style = plot.style_circles)</div>\n<p>The difference now is that <code dir=\"auto\">updateNo</code> tracks the number of realtime\nupdates that occur on each realtime bar. This can happen because the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\ndeclaration allows the value of <code dir=\"auto\">updateNo</code> to be preserved between\nrealtime updates; it is no longer rolled back at each realtime execution\nof the script. The test on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate%7Bdot%7Disnew\">barstate.isnew</a>\nallows us to reset the update count when a new realtime bar comes in.</p>\n<p>Because\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nonly affects the behavior of your code in the realtime bar, it follows\nthat backtest results on strategies designed using logic based on\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nvariables will not be able to reproduce that behavior on historical\nbars, which will invalidate test results on them. This also entails that\nplots on historical bars will not be able to reproduce the script\u2019s\nbehavior in realtime.</p>", "segment_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "d24d46c2a4a6f1562214a8c7cba4d89b50ba04430f43751b3bb171eda8985d8d", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/migration-guides/to-pine-version-3\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"to-pine-script-version-3\"><a href=\"#to-pine-script-version-3\">To Pine Script\u00ae version 3<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>This document helps to migrate Pine Script\u00ae code from <code dir=\"auto\">@version=2</code> to\n<code dir=\"auto\">@version=3</code>.</p>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"default-behaviour-of-security-function-has-changed\"><a href=\"#default-behaviour-of-security-function-has-changed\">Default behaviour of security function has changed<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Let\u2019s look at the simple <code dir=\"auto\">security</code> function use case. Add this\nindicator on an intraday chart:</p>\n<div class=\"pine-colorizer not-content\">// Add this indicator on an intraday (e.g., 30 minutes) chart\n//@version=2\nstudy(\"My Script\", overlay=true)\ns = security(tickerid, 'D', high, false)\nplot(s)</div>\n<p>This indicator is calculated based on historical data and looks somewhat\n<em>into the future</em>. At the first bar of every session an indicator plots\nthe high price of the entire day. This could be useful in some cases for\nanalysis, but doesn\u2019t work for backtesting strategies.</p>\n<p>We worked on this and made changes in Pine Script version 3. If this\nindicator is compiled with <code dir=\"auto\">//@version=3</code> directive, we get a completely\ndifferent picture: <img alt=\"\" decoding=\"async\" height=\"1120\" loading=\"lazy\" src=\"/pine-script-docs/_astro/V3.Dt4jGTcd_256NgY.webp\" width=\"1920\"/></p>\n<p>The old behaviour is still available though. We added a parameter to the\n<code dir=\"auto\">security</code> function (the fifth one) called <code dir=\"auto\">lookahead</code>.</p>\n<p>It can take on the form of two different values:\n<code dir=\"auto\">barmerge.lookahead_off</code> (and this is the default for Pine Script\nversion 3) or <code dir=\"auto\">barmerge.lookahead_on</code> (which is the default for Pine\nScript version 2).</p>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"self-referenced-variables-are-removed\"><a href=\"#self-referenced-variables-are-removed\">Self-referenced variables are removed<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script version 2 pieces of code, containing a self-referencing\nvariable:</p>\n<div class=\"pine-colorizer not-content\">//@version=2\n//...\ns = nz(s[1]) + close</div>\n<p>Compiling this piece of code with Pine Script version 3 will give you\nan <code dir=\"auto\">Undeclared identifier 's'</code> error. It should be rewritten as:</p>\n<div class=\"pine-colorizer not-content\">//@version=3\n//...\ns = 0.0\ns := nz(s[1]) + close</div>\n<p><code dir=\"auto\">s</code> is now a <em>mutable variable</em> that is initialized at line 3. At line 3\nthe initial value gives the Pine Script compiler the information about\nthe variable type. It\u2019s a float in this example.</p>\n<p>In some cases you may initialize that mutable variable (like <code dir=\"auto\">s</code>) with a\n<code dir=\"auto\">na</code> value. But in complex cases that won\u2019t work.</p>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"forward-referenced-variables-are-removed\"><a href=\"#forward-referenced-variables-are-removed\">Forward-referenced variables are removed<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<div class=\"pine-colorizer not-content\">//@version=2\n//...\nd = nz(f[1])\ne = d + 1\nf = e + close</div>\n<p>In this example <code dir=\"auto\">f</code> is a forward-referencing variable, because it\u2019s\nreferenced at line 3 before it was declared and initialized. In Pine\nScript version 3 this will give you an error\n<code dir=\"auto\">Undeclared identifier 'f'</code>. This example should be rewritten in Pine\nScript version 3 as follows:</p>\n<div class=\"pine-colorizer not-content\">//@version=3\n//...\nf = 0.0\nd = nz(f[1])\ne = d + 1\nf := e + close</div>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"resolving-a-problem-with-a-mutable-variable-in-a-security-expression\"><a href=\"#resolving-a-problem-with-a-mutable-variable-in-a-security-expression\">Resolving a problem with a mutable variable in a security expression<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When you migrate script to version 3 it\u2019s possible that after removing\nself-referencing and forward-referencing variables the Pine Script\ncompiler will give you an error:</p>\n<div class=\"pine-colorizer not-content\">//@version=3\n//...\ns = 0.0\ns := nz(s[1]) + close\nt = security(tickerid, period, s)</div>\n<p><code dir=\"auto\">Cannot use mutable variable as an argument for security function!</code></p>\n<p>This limitation exists since mutable variables were introduced in Pine\nScript, i.e., in version 2. It can be resolved as before: wrap the code\nwith a mutable variable in a function:</p>\n<div class=\"pine-colorizer not-content\">//@version=3\n//...\ncalcS() =&gt;\n    s = 0.0\n    s := nz(s[1]) + close\nt = security(tickerid, period, calcS())</div>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-3", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"math-operations-with-booleans-are-forbidden\"><a href=\"#math-operations-with-booleans-are-forbidden\">Math operations with booleans are forbidden<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script v2 there were rules of implicit conversion of booleans\ninto numeric types. In v3 this is forbidden. There is a conversion of\nnumeric types into booleans instead (0 and <code dir=\"auto\">na</code> values are <code dir=\"auto\">false</code>, all\nthe other numbers are <code dir=\"auto\">true</code>). Example (In v2 this code compiles fine):</p>\n<div class=\"pine-colorizer not-content\">//@version=2\nstudy(\"My Script\")\ns = close &gt;= open\ns1 = close[1] &gt;= open[1]\ns2 = close[2] &gt;= open[2]\nsum = s + s1 + s2\ncol = sum == 1 ? white : sum == 2 ? blue : sum == 3 ? red : na\nbgcolor(col)</div>\n<p>Variables <code dir=\"auto\">s</code>, <code dir=\"auto\">s1</code> and <code dir=\"auto\">s2</code> are of <em>bool</em> type. But at line 6 we add\nthree of them and store the result in a variable <code dir=\"auto\">sum</code>. <code dir=\"auto\">sum</code> is a\nnumber, since we cannot add booleans. Booleans were implicitly converted\nto numbers (<code dir=\"auto\">true</code> values to <code dir=\"auto\">1.0</code> and <code dir=\"auto\">false</code> to <code dir=\"auto\">0.0</code>) and then they\nwere added.</p>\n<p>This approach leads to unintentional errors in more complicated scripts.\nThat\u2019s why we no longer allow implicit conversion of booleans to\nnumbers.</p>\n<p>If you try to compile this example as a Pine Script v3 code, you\u2019ll\nget an error:\n<code dir=\"auto\">Cannot call `operator +` with arguments (series__bool, series__bool); &lt;...&gt;</code>\nIt means that you cannot use the addition operator with boolean values.\nTo make this example work in Pine Script v3 you can do the following:</p>\n<div class=\"pine-colorizer not-content\">//@version=3\nstudy(\"My Script\")\nbton(b) =&gt;\n    b ? 1 : 0\ns = close &gt;= open\ns1 = close[1] &gt;= open[1]\ns2 = close[2] &gt;= open[2]\nsum = bton(s) + bton(s1) + bton(s2)\ncol = sum == 1 ? white : sum == 2 ? blue : sum == 3 ? red : na\nbgcolor(col)</div>\n<p>Function <code dir=\"auto\">bton</code> (abbreviation of boolean-to-number) explicitly converts\nany boolean value to a number if you really need this.</p>", "segment_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "4ce0c72122434155fb3c33d5f216285ae22a3420aabac3c2f54ca148a497465a", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-4", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/migration-guides/to-pine-version-4\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"to-pine-script-version-4\"><a href=\"#to-pine-script-version-4\">To Pine Script\u00ae version 4<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>This is a guide to converting Pine Script\u00ae code from <code dir=\"auto\">@version=3</code> to\n<code dir=\"auto\">@version=4</code>.</p>", "segment_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-4", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"converter\"><a href=\"#converter\">Converter<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The Pine Editor comes with a utility to automatically convert v3\nindicators and strategies to v4. To access it, open a script with\n<code dir=\"auto\">//@version=3</code> in it and select the <code dir=\"auto\">Convert to v4</code> option in the <code dir=\"auto\">More</code>\ndropdown menu:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"812\" loading=\"lazy\" src=\"/pine-script-docs/_astro/v3_to_v4_convert_button.CO0b2GMj_ZnOmqr.webp\" width=\"1136\"/></p>\n<p>Not all scripts can be automatically converted from v3 to v4. If you\nwant to convert the script manually or if your indicator returns a\ncompilation error after conversion, consult the guide below for more\ninformation.</p>", "segment_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-4", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"renaming-of-built-in-constants-variables-and-functions\"><a href=\"#renaming-of-built-in-constants-variables-and-functions\">Renaming of built-in constants, variables, and functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script v4 the following built-in constants, variables, and\nfunctions were renamed:</p>\n<ul>\n<li>Color constants (e.g <code dir=\"auto\">red</code>) are moved to the <code dir=\"auto\">color.*</code> namespace\n(e.g. <code dir=\"auto\">color.red</code>).</li>\n<li>The <code dir=\"auto\">color</code> function has been renamed to <code dir=\"auto\">color.new</code>.</li>\n<li>Constants for <code dir=\"auto\">input()</code> types (e.g. <code dir=\"auto\">integer</code>) are moved to the\n<code dir=\"auto\">input.*</code> namespace (e.g. <code dir=\"auto\">input.integer</code>).</li>\n<li>The plot style constants (e.g. <code dir=\"auto\">histogram</code> style) are moved to the\n<code dir=\"auto\">plot.style_*</code> namespace (e.g. <code dir=\"auto\">plot.style_histogram</code>).</li>\n<li>Style constants for the <code dir=\"auto\">hline</code> function (e.g. the <code dir=\"auto\">dotted</code> style)\nare moved to the <code dir=\"auto\">hline.style_*</code> namespace (e.g.\n<code dir=\"auto\">hline.style_dotted</code>).</li>\n<li>Constants of days of the week (e.g. <code dir=\"auto\">sunday</code>) are moved to the\n<code dir=\"auto\">dayofweek.*</code> namespace (e.g. <code dir=\"auto\">dayofweek.sunday</code>).</li>\n<li>The variables of the current chart timeframe (e.g. <code dir=\"auto\">period</code>,\n<code dir=\"auto\">isintraday</code>) are moved to the <code dir=\"auto\">timeframe.*</code> namespace (e.g.\n<code dir=\"auto\">timeframe.period</code>, <code dir=\"auto\">timeframe.isintraday</code>).</li>\n<li>The <code dir=\"auto\">interval</code> variable was renamed to <code dir=\"auto\">timeframe.multiplier</code>.</li>\n<li>The <code dir=\"auto\">ticker</code> and <code dir=\"auto\">tickerid</code> variables are renamed to\n<code dir=\"auto\">syminfo.ticker</code> and <code dir=\"auto\">syminfo.tickerid</code> respectively.</li>\n<li>The <code dir=\"auto\">n</code> variable that contains the bar index value has been renamed\nto <code dir=\"auto\">bar_index</code>.</li>\n</ul>\n<p>The reason behind renaming all of the above was to structure the\nstandard language tools and make working with code easier. New names are\ngrouped according to assignments under common prefixes. For example, you\nwill see a list with all available color constants if you type \u2018color\u2019\nin the editor and press Ctrl + Space.</p>", "segment_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-4", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"explicit-variable-type-declaration\"><a href=\"#explicit-variable-type-declaration\">Explicit variable type declaration<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In Pine Script v4 it\u2019s no longer possible to create variables with an\nunknown data type at the time of their declaration. This was done to\navoid a number of issues that arise when the variable type changes after\nits initialization with the na value. From now on, you need to\nexplicitly specify their type using keywords or type functions (for\nexample, <code dir=\"auto\">float</code>) when declaring variables with the na value:</p>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"Green Candle Close\")\n// We expect `src` to hold float values, so we declare in with the `float` keyword\nfloat src = na\nif close &gt; open\n    src := close\nplot(src)</div>", "segment_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "d46771eb12e30c45c5f4ff23d84d1a14cc7f1c68489c32d8363403f3607bf785", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/migration-guides/to-pine-version-5\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"to-pine-script-version-5\"><a href=\"#to-pine-script-version-5\">To Pine Script\u00ae version 5<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This guide documents the <strong>changes</strong> made to Pine Script\u00ae from v4 to v5.\nIt will guide you in the adaptation of existing Pine scripts to Pine\nScript v5. See our\n<a href=\"/pine-script-docs/v5/release-notes/#october-2021\">Release notes</a> for a list of the <strong>new</strong> features in Pine Script v5.</p>\n<p>The most frequent adaptations required to convert older scripts to v5\nare:</p>\n<ul>\n<li>Changing\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_study\">study()</a>\nfor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\n(the function\u2019s signature has not changed).</li>\n<li>Renaming built-in function calls to include their new namespace\n(e.g.,\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_highest\">highest()</a>\nin v4 becomes\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dhighest\">ta.highest()</a>\nin v5).</li>\n<li>Restructuring inputs to use the more specialized <code dir=\"auto\">input.*()</code>\nfunctions.</li>\n<li>Eliminating uses of the deprecated <code dir=\"auto\">transp</code> parameter by using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.new()</a>\nto simultaneously define color and transparency for use with the\n<code dir=\"auto\">color</code> parameter.</li>\n<li>If you used the <code dir=\"auto\">resolution</code> and <code dir=\"auto\">resolution_gaps</code> parameters in\nv4\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_study\">study()</a>,\nthey will require changing to <code dir=\"auto\">timeframe</code> and <code dir=\"auto\">timeframe_gaps</code> in\nv5\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>.</li>\n</ul>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"v4-to-v5-converter\"><a href=\"#v4-to-v5-converter\">v4 to v5 converter<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The Pine Editor includes a utility to automatically convert v4 scripts\nto v5. To access it, open a script with <code dir=\"auto\">//@version=4</code> in it and select\nthe \u201cConvert to v5\u201d option in the \u201cMore\u201d menu identified by three\ndots at the top-right of the Editor\u2019s pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"816\" loading=\"lazy\" src=\"/pine-script-docs/_astro/v4_to_v5_convert_button.B6QYFNWm_1b9vBk.webp\" width=\"1232\"/></p>\n<p>Not all scripts can be automatically converted from v4 to v5. If you\nwant to convert the script manually or if your indicator returns a\ncompilation error after conversion, use the following sections to\ndetermine how to complete the conversion. A list of some errors you can\nencounter during the automatic conversion and how to fix them can be\nfound in the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#common-script-conversion-errors\">Common script conversion errors</a> section of this guide.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"renamed-functions-and-variables\"><a href=\"#renamed-functions-and-variables\">Renamed functions and variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>For clarity and consistency, many built-in functions and variables were\nrenamed in v5. The inclusion of v4 function names in a new namespace is\nthe cause of most changes. For example, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_sma\">sma()</a>\nfunction in v4 is moved to the <code dir=\"auto\">ta.</code> namespace in v5:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dsma\">ta.sma()</a>.\nRemembering the new namespaces is not necessary; if you type the older\nname of a function without its namespace in the Editor and press the\n\u2018Auto-complete\u2019 hotkey (<code dir=\"auto\">Ctrl</code> +\n<code dir=\"auto\">Space</code>, or <code dir=\"auto\">Cmd</code> on MacOS), a popup\nshowing matching suggestions appears:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"521\" loading=\"lazy\" src=\"/pine-script-docs/_astro/v5_autocomplete.R-4HP09V_Z1R3GAs.webp\" width=\"956\"/></p>\n<p>Not counting functions moved to new namespaces, only two functions have\nbeen renamed:</p>\n<ul>\n<li><code dir=\"auto\">study()</code> is now\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>.</li>\n<li><code dir=\"auto\">tickerid()</code> is now\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dnew\">ticker.new()</a>.</li>\n</ul>\n<p>The full list of renamed functions and variables can be found in the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#all-variable-function-and-parameter-name-changes\">All variable, function, and parameter name changes</a> section of this guide.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"renamed-function-parameters\"><a href=\"#renamed-function-parameters\">Renamed function parameters<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The parameter names of some built-in functions were changed to improve\nthe nomenclature. This has no bearing on most scripts, but if you used\nthese parameter names when calling functions, they will require\nadaptation. For example, we have standardized all mentions:</p>\n<div class=\"pine-colorizer not-content\">// Valid in v4. Not valid in v5.\ntimev4 = time(resolution = \"1D\")\n// Valid in v5.\ntimev5 = time(timeframe = \"1D\")\n// Valid in v4 and v5.\ntimeBoth = time(\"1D\")</div>\n<p>The full list of renamed function parameters can be found in the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#all-variable-function-and-parameter-name-changes\">All variable, function, and parameter name changes</a> section of this guide.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"removed-an-rsi-overload\"><a href=\"#removed-an-rsi-overload\"><span>Removed an \u200b<code dir=\"auto\">rsi()</code>\u200b overload</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In v4, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_rsi\">rsi()</a>\nfunction had two different overloads:</p>\n<ul>\n<li><code dir=\"auto\">rsi(series float, simple int)</code> for the normal RSI calculation, and</li>\n<li><code dir=\"auto\">rsi(series float, series float)</code> for an overload used in the MFI\nindicator, which did a calculation equivalent to\n<code dir=\"auto\">100.0 - (100.0 / (1.0 + arg1 / arg2))</code>.</li>\n</ul>\n<p>This caused a single built-in function to behave in two very different\nways, and it was difficult to distinguish which one applied because it\ndepended on the type of the second argument. As a result, a number of\nindicators misused the function and were displaying incorrect results.\nTo avoid this, the second overload was removed in v5.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Drsi\">ta.rsi()</a>\nfunction in v5 only accepts a \u201csimple int\u201d argument for its <code dir=\"auto\">length</code>\nparameter. If your v4 code used the now deprecated overload of the\nfunction with a <code dir=\"auto\">float</code> second argument, you can replace the whole\n<code dir=\"auto\">rsi()</code> call with the following formula, which is equivalent:</p>\n<div class=\"pine-colorizer not-content\">100.0 - (100.0 / (1.0 + arg1 / arg2))</div>\n<p>Note that when your v4 code used a \u201cseries int\u201d value as the second\nargument to\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_rsi\">rsi()</a>,\nit was automatically cast to \u201cseries float\u201d and the second overload of\nthe function was used. While this was syntactically correct, it most\nprobably did <strong>not</strong> yield the result you expected. In v5,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Drsi\">ta.rsi()</a>\nrequires a \u201csimple int\u201d for the argument to <code dir=\"auto\">length</code>, which precludes\ndynamic (or \u201cseries\u201d) lengths. The reason for this is that RSI\ncalculations use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Drma\">ta.rma()</a>\nmoving average, which is similar to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dema\">ta.ema()</a>\nin that it relies on a length-dependent recursive process using the\nvalues of previous bars. This makes it impossible to achieve correct\nresults with a \u201cseries\u201d length that could vary bar to bar.</p>\n<p>If your v4 code used a length that was \u201cconst int\u201d, \u201cinput int\u201d or\n\u201csimple int\u201d, no changes are required.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"reserved-keywords\"><a href=\"#reserved-keywords\">Reserved keywords<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A number of words are reserved and cannot be used for variable or\nfunction names. They are: <code dir=\"auto\">catch</code>, <code dir=\"auto\">class</code>, <code dir=\"auto\">do</code>, <code dir=\"auto\">ellipse</code>, <code dir=\"auto\">in</code>, <code dir=\"auto\">is</code>,\n<code dir=\"auto\">polygon</code>, <code dir=\"auto\">range</code>, <code dir=\"auto\">return</code>, <code dir=\"auto\">struct</code>, <code dir=\"auto\">text</code>, <code dir=\"auto\">throw</code>, <code dir=\"auto\">try</code>. If your\nv4 indicator uses any of these, rename your variable or function for the\nscript to work in v5.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"removed-iff-and-offset\"><a href=\"#removed-iff-and-offset\"><span>Removed \u200b<code dir=\"auto\">iff()</code>\u200b and \u200b<code dir=\"auto\">offset()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_iff\">iff()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_offset\">offset()</a>\nfunctions have been removed. Code using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_iff\">iff()</a>\nfunction can be rewritten using the ternary operator:</p>\n<div class=\"pine-colorizer not-content\">// iff(&lt;condition&gt;, &lt;return_when_true&gt;, &lt;return_when_false&gt;)\n// Valid in v4, not valid in v5\nbarColorIff = iff(close &gt;= open, color.green, color.red)\n// &lt;condition&gt; ? &lt;return_when_true&gt; : &lt;return_when_false&gt;\n// Valid in v4 and v5\nbarColorTernary = close &gt;= open ? color.green : color.red</div>\n<p>Note that the ternary operator is evaluated \u201clazily\u201d; only the\nrequired value is calculated (depending on the condition\u2019s evaluation\nto <code dir=\"auto\">true</code> or <code dir=\"auto\">false</code>). This is different from\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_iff\">iff()</a>,\nwhich always evaluated both values but returned only the relevant one.</p>\n<p>Some functions require evaluation on every bar to correctly calculate,\nso you will need to make special provisions for these by pre-evaluating\nthem before the ternary:</p>\n<div class=\"pine-colorizer not-content\">// `iff()` in v4: `highest()` and `lowest()` are calculated on every bar\nv1 = iff(close &gt; open, highest(10), lowest(10)) \nplot(v1)\n// In v5: forced evaluation on every bar prior to the ternary statement.\nh1 = ta.highest(10)\nl1 = ta.lowest(10)\nv1 = close &gt; open ? h1 : l1\nplot(v1)</div>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_offset\">offset()</a>\nfunction was deprecated because the more readable\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator is equivalent:</p>\n<div class=\"pine-colorizer not-content\">// Valid in v4. Not valid in v5.\nprevClosev4 = offset(close, 1)\n// Valid in v4 and v5.\nprevClosev5 = close[1]</div>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"split-of-input-into-several-functions\"><a href=\"#split-of-input-into-several-functions\"><span>Split of \u200b<code dir=\"auto\">input()</code>\u200b into several functions</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The v4\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_input\">input()</a>\nfunction was becoming crowded with a plethora of overloads and\nparameters. We split its functionality into different functions to clear\nthat space and provide a more robust structure to accommodate the\nadditions planned for inputs. Each new function uses the name of the\n<code dir=\"auto\">input.*</code> type of the v4 <code dir=\"auto\">input()</code> call it replaces. E.g., there is now\na specialized\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dfloat\">input.float()</a>\nfunction replacing the v4 <code dir=\"auto\">input(1.0, type = input.float)</code> call. Note\nthat you can still use <code dir=\"auto\">input(1.0)</code> in v5, but because only\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dfloat\">input.float()</a>\nallows for parameters such as <code dir=\"auto\">minval</code>, <code dir=\"auto\">maxval</code>, etc., it is more\npowerful. Also note that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dint\">input.int()</a>\nis the only specialized input function that does not use its equivalent\nv4 <code dir=\"auto\">input.integer</code> name. The <code dir=\"auto\">input.*</code> constants have been removed\nbecause they were used as arguments for the <code dir=\"auto\">type</code> parameter, which was\ndeprecated.</p>\n<p>To convert, for example, a v4 script using an input of type\n<code dir=\"auto\">input.symbol</code>, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsymbol\">input.symbol()</a>\nfunction must be used in v5:</p>\n<div class=\"pine-colorizer not-content\">// Valid in v4. Not valid in v5.\naaplTicker = input(\"AAPL\", type = input.symbol)\n// Valid in v5\naaplTicker = input.symbol(\"AAPL\")</div>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input\">input()</a>\nfunction persists in v5, but in a simpler form, with less parameters. It\nhas the advantage of automatically detecting input types\n\u201cbool/color/int/float/string/source\u201d from the argument used for\n<code dir=\"auto\">defval</code>:</p>\n<div class=\"pine-colorizer not-content\">// Valid in v4 and v5.\n// While \"AAPL\" is a valid symbol, it is only a string here because `input.symbol()` is not used.\ntickerString = input(\"AAPL\", title = \"Ticker string\")</div>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"some-function-parameters-now-require-built-in-arguments\"><a href=\"#some-function-parameters-now-require-built-in-arguments\">Some function parameters now require built-in arguments<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>In v4, built-in constants such as <code dir=\"auto\">plot.style_area</code> used as arguments\nwhen calling Pine Script functions corresponded to pre-defined values\nof a specific type. For example, the value of <code dir=\"auto\">barmerge.lookahead_on</code>\nwas <code dir=\"auto\">true</code>, so you could use <code dir=\"auto\">true</code> instead of the named constant when\nsupplying an argument to the <code dir=\"auto\">lookahead</code> parameter in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_security\">security()</a>\nfunction call. We found this to be a common source of confusion, which\ncaused unsuspecting programmers to produce code yielding unintended\nresults.</p>\n<p>In v5, the use of correct built-in named constants as arguments to\nfunction parameters requiring them is mandatory:</p>\n<div class=\"pine-colorizer not-content\">// Not valid in v5: `true` is used as an argument for `lookahead`.\nrequest.security(syminfo.tickerid, \"1D\", close, lookahead = true)\n// Valid in v5: uses a named constant instead of `true`.\nrequest.security(syminfo.tickerid, \"1D\", close, lookahead = barmerge.lookahead_on)\n\n// Would compile in v4 because `plot.style_columns` was equal to 5.\n// Won't compile in v5.\na = 2 * plot.style_columns\nplot(a)</div>\n<p>To convert your script from v4 to v5, make sure you use the correct\nnamed built-in constants as function arguments.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"deprecated-the-transp-parameter\"><a href=\"#deprecated-the-transp-parameter\"><span>Deprecated the \u200b<code dir=\"auto\">transp</code>\u200b parameter</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The <code dir=\"auto\">transp=</code> parameter used in the signature of many v4 plotting\nfunctions was deprecated because it interfered with RGB functionality.\nTransparency must now be specified along with the color as an argument\nto parameters such as <code dir=\"auto\">color</code>, <code dir=\"auto\">textcolor</code>, etc. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Dnew\">color.new()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color%7Bdot%7Drgb\">color.rgb()</a>\nfunctions will be needed in those cases to join a color and its\ntransparency.</p>\n<p>Note that in v4, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunctions had an optional <code dir=\"auto\">transp</code> parameter that used a default value\nof 90. This meant that the code below could display Bollinger Bands with\na semi-transparent fill between two bands and a semi-transparent\nbackround color where bands cross price, even though no argument is used\nfor the <code dir=\"auto\">transp</code> parameter in its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\ncalls:</p>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"Bollinger Bands\", overlay = true)\n[middle, upper, lower] = bb(close, 5, 4)\nplot(middle, color=color.blue)\np1PlotID = plot(upper, color=color.green)\np2PlotID = plot(lower, color=color.green)\ncrossUp = crossover(high, upper)\ncrossDn = crossunder(low, lower)\n// Both `fill()` and `bgcolor()` have a default `transp` of 90\nfill(p1PlotID, p2PlotID, color = color.green)\nbgcolor(crossUp ? color.green : crossDn ? color.red : na)</div>\n<p>In v5 we need to explictly mention the 90 transparency with the color,\nyielding:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Bollinger Bands\", overlay = true)\n[middle, upper, lower] = ta.bb(close, 5, 4)\nplot(middle, color=color.blue)\np1PlotID = plot(upper, color=color.green)\np2PlotID = plot(lower, color=color.green)\ncrossUp = ta.crossover(high, upper)\ncrossDn = ta.crossunder(low, lower)\nvar TRANSP = 90\n// We use `color.new()` to explicitly pass transparency to both functions\nfill(p1PlotID, p2PlotID, color = color.new(color.green, TRANSP))\nbgcolor(crossUp ? color.new(color.green, TRANSP) : crossDn ? color.new(color.red, TRANSP) : na)</div>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"changed-the-default-session-days-for-time-and-time_close\"><a href=\"#changed-the-default-session-days-for-time-and-time_close\"><span>Changed the default session days for \u200b<code dir=\"auto\">time()</code>\u200b and \u200b<code dir=\"auto\">time_close()</code>\u200b</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The default set of days for <code dir=\"auto\">session</code> strings used in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a>\nfunctions, and returned by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsession\">input.session()</a>,\nhas changed from <code dir=\"auto\">\"23456\"</code> (Monday to Friday) to <code dir=\"auto\">\"1234567\"</code> (Sunday to\nSaturday):</p>\n<div class=\"pine-colorizer not-content\">// On symbols that are traded during weekends, this will behave differently in v4 and v5.\nt0 = time(\"1D\", \"1000-1200\")\n// v5 equivalent of the behavior of `t0` in v4.\nt1 = time(\"1D\", \"1000-1200:23456\")\n// v5 equivalent of the behavior of `t0` in v5.\nt2 = time(\"1D\", \"1000-1200:1234567\")</div>\n<p>This change in behavior should not have much impact on scripts running\non conventional markets that are closed during weekends. If it is\nimportant for you to ensure your session definitions preserve their v4\nbehavior in v5 code, add <code dir=\"auto\">\":23456\"</code> to your session strings. See this\nmanual\u2019s page on <a href=\"/pine-script-docs/v5/concepts/sessions/\">Sessions</a> for more information.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"strategyexit-now-must-do-something\"><a href=\"#strategyexit-now-must-do-something\"><span>\u200b<code dir=\"auto\">strategy.exit()</code>\u200b now must do something</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Gone are the days when the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nfunction was allowed to loiter. Now it must actually have an effect on\nthe strategy by using at least one of the following parameters:\n<code dir=\"auto\">profit</code>, <code dir=\"auto\">limit</code>, <code dir=\"auto\">loss</code>, <code dir=\"auto\">stop</code>, or one of the following pairs:\n<code dir=\"auto\">trail_offset</code> combined with either <code dir=\"auto\">trail_price</code> or <code dir=\"auto\">trail_points</code>.\nWhen uses of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nnot meeting these criteria trigger an error while converting a strategy\nto v5, you can safely eliminate these lines, as they didn\u2019t do anything\nin your code anyway.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"common-script-conversion-errors\"><a href=\"#common-script-conversion-errors\">Common script conversion errors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"invalid-argument-stylelinestyle-in-plothline-call\"><a href=\"#invalid-argument-stylelinestyle-in-plothline-call\">Invalid argument \u2018style\u2019/\u2018linestyle\u2019 in \u2018plot\u2019/\u2018hline\u2019 call<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To make this work, you need to change the \u201cint\u201d arguments used for the\n<code dir=\"auto\">style</code> and <code dir=\"auto\">linestyle</code> arguments in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a>\nfor built-in constants:</p>\n<div class=\"pine-colorizer not-content\">// Will cause an error during conversion\nplotStyle = input(1)\nhlineStyle = input(1)\nplot(close, style = plotStyle)\nhline(100, linestyle = hlineStyle)\n\n// Will work in v5\n//@version=5\nindicator(\"\")\nplotStyleInput = input.string(\"Line\", options = [\"Line\", \"Stepline\", \"Histogram\", \"Cross\", \"Area\", \"Columns\", \"Circles\"])\nhlineStyleInput = input.string(\"Solid\", options = [\"Solid\", \"Dashed\", \"Dotted\"])\n\nplotStyle = plotStyleInput == \"Line\" ? plot.style_line : \n      plotStyleInput == \"Stepline\" ? plot.style_stepline :\n      plotStyleInput == \"Histogram\" ? plot.style_histogram :\n      plotStyleInput == \"Cross\" ? plot.style_cross :\n      plotStyleInput == \"Area\" ? plot.style_area :\n      plotStyleInput == \"Columns\" ? plot.style_columns :\n      plot.style_circles\n\nhlineStyle = hlineStyleInput == \"Solid\" ? hline.style_solid :\n      hlineStyleInput == \"Dashed\" ? hline.style_dashed :\n      hline.style_dotted\n\nplot(close, style = plotStyle)\nhline(100, linestyle = hlineStyle)</div>\n<p>See the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#some-function-parameters-now-require-built-in-arguments\">Some function parameters now require built-in arguments</a> section of this guide for more information.</p>\n<h3 class=\"md-heading\" id=\"undeclared-identifier-inputinput_name\"><a href=\"#undeclared-identifier-inputinput_name\">Undeclared identifier \u2018input.%input_name%\u2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To fix this issue, remove the <code dir=\"auto\">input.*</code> constants from your code:</p>\n<div class=\"pine-colorizer not-content\">// Will cause an error during conversion\n_integer = input.integer\n_bool = input.bool\ni1 = input(1, \"Integer\", _integer)\ni2 = input(true, \"Boolean\", _bool)\n\n// Will work in v5\ni1 = input.int(1, \"Integer\")\ni2 = input.bool(true, \"Boolean\")</div>\n<p>See the User Manual\u2019s page on <a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a>, and the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#some-function-parameters-now-require-built-in-arguments\">Some function parameters now require built-in arguments</a> section of this guide for more information.</p>\n<h3 class=\"md-heading\" id=\"invalid-argument-when-in-strategyclose-call\"><a href=\"#invalid-argument-when-in-strategyclose-call\">Invalid argument \u2018when\u2019 in \u2018strategy.close\u2019 call<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This is caused by a confusion between\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>.</p>\n<p>The second parameter of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>\nis <code dir=\"auto\">when</code>, which expects a \u201cbool\u201d argument. In v4, it was allowed to\nuse <code dir=\"auto\">strategy.long</code> an argument because it was a \u201cbool\u201d. With v5,\nhowever, named built-in constants must be used as arguments, so\n<code dir=\"auto\">strategy.long</code> is no longer allowed as an argument to the <code dir=\"auto\">when</code>\nparameter.</p>\n<p>The <code dir=\"auto\">strategy.close(\"Short\", strategy.long)</code> call in this code is\nequivalent to <code dir=\"auto\">strategy.close(\"Short\")</code>, which is what must be used in\nv5:</p>\n<div class=\"pine-colorizer not-content\">// Will cause an error during conversion\nif (longCondition)\n    strategy.close(\"Short\", strategy.long)\n    strategy.entry(\"Long\", strategy.long)\n\n// Will work in v5:\nif (longCondition)\n    strategy.close(\"Short\")\n    strategy.entry(\"Long\", strategy.long)</div>\n<p>See the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#some-function-parameters-now-require-built-in-arguments\">Some function parameters now require built-in arguments</a> section of this guide for more information.</p>\n<h3 class=\"md-heading\" id=\"cannot-call-inputint-with-argument-minvalvalue-an-argument-of-literal-float-type-was-used-but-a-const-int-is-expected\"><a href=\"#cannot-call-inputint-with-argument-minvalvalue-an-argument-of-literal-float-type-was-used-but-a-const-int-is-expected\">Cannot call \u2018input.int\u2019 with argument \u2018minval\u2019=\u2018%value%\u2018. An argument of \u2018literal float\u2019 type was used but a \u2018const int\u2019 is expected<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>In v4, it was possible to pass a \u201cfloat\u201d argument to <code dir=\"auto\">minval</code> when an\n\u201cint\u201d value was being input. This is no longer possible in v5; \u201cint\u201d\nvalues are required for \u201cint\u201d inputs:</p>\n<div class=\"pine-colorizer not-content\">// Works in v4, will break on conversion because minval is a 'float' value\nint_input = input(1, \"Integer\", input.integer, minval = 1.0)\n\n// Works in v5\nint_input = input.int(1, \"Integer\", minval = 1)</div>\n<p>See the User Manual\u2019s page on <a href=\"/pine-script-docs/v5/concepts/inputs/\">Inputs</a>, and the\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5/#some-function-parameters-now-require-built-in-arguments\">Some function parameters now require built-in arguments</a> section of this guide for more information.</p>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:14", "segment_order": 14, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/migration-guides/to-pine-version-5", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"all-variable-function-and-parameter-name-changes\"><a href=\"#all-variable-function-and-parameter-name-changes\">All variable, function, and parameter name changes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"removed-functions-and-variables\"><a href=\"#removed-functions-and-variables\">Removed functions and variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">input.bool</code> input</td><td>Replaced by <code dir=\"auto\">input.bool()</code></td></tr><tr><td><code dir=\"auto\">input.color</code> input</td><td>Replaced by <code dir=\"auto\">input.color()</code></td></tr><tr><td><code dir=\"auto\">input.float</code> input</td><td>Replaced by <code dir=\"auto\">input.float()</code></td></tr><tr><td><code dir=\"auto\">input.integer</code> input</td><td>Replaced by <code dir=\"auto\">input.int()</code></td></tr><tr><td><code dir=\"auto\">input.resolution</code> input</td><td>Replaced by <code dir=\"auto\">input.timeframe()</code></td></tr><tr><td><code dir=\"auto\">input.session</code> input</td><td>Replaced by <code dir=\"auto\">input.session()</code></td></tr><tr><td><code dir=\"auto\">input.source</code> input</td><td>Replaced by <code dir=\"auto\">input.source()</code></td></tr><tr><td><code dir=\"auto\">input.string</code> input</td><td>Replaced by <code dir=\"auto\">input.string()</code></td></tr><tr><td><code dir=\"auto\">input.symbol</code> input</td><td>Replaced by <code dir=\"auto\">input.symbol()</code></td></tr><tr><td><code dir=\"auto\">input.time</code> input</td><td>Replaced by <code dir=\"auto\">input.time()</code></td></tr><tr><td><code dir=\"auto\">iff()</code></td><td>Use the <code dir=\"auto\">?:</code> operator instead</td></tr><tr><td><code dir=\"auto\">offset()</code></td><td>Use the <code dir=\"auto\">[]</code> operator instead</td></tr></tbody></table>\n<h3 class=\"md-heading\" id=\"renamed-functions-and-parameters\"><a href=\"#renamed-functions-and-parameters\">Renamed functions and parameters<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"no-namespace-change\"><a href=\"#no-namespace-change\">No namespace change<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">study(&lt;...&gt;, resolution, resolution_gaps, &lt;...&gt;)</code></td><td><code dir=\"auto\">indicator(&lt;...&gt;, timeframe, timeframe_gaps, &lt;...&gt;)</code></td></tr><tr><td><code dir=\"auto\">strategy.entry(long)</code></td><td><code dir=\"auto\">strategy.entry(direction)</code></td></tr><tr><td><code dir=\"auto\">strategy.order(long)</code></td><td><code dir=\"auto\">strategy.order(direction)</code></td></tr><tr><td><code dir=\"auto\">time(resolution)</code></td><td><code dir=\"auto\">time(timeframe)</code></td></tr><tr><td><code dir=\"auto\">time_close(resolution)</code></td><td><code dir=\"auto\">time_close(timeframe)</code></td></tr><tr><td><code dir=\"auto\">nz(x, y)</code></td><td><code dir=\"auto\">nz(source, replacement)</code></td></tr></tbody></table>\n<h4 class=\"md-heading\" id=\"ta-namespace-for-technical-analysis-functions-and-variables\"><a href=\"#ta-namespace-for-technical-analysis-functions-and-variables\">\u201dta\u201d namespace for technical analysis functions and variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<h5 class=\"md-heading\" id=\"indicator-functions-and-variables\"><a href=\"#indicator-functions-and-variables\">Indicator functions and variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h5>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">accdist</code></td><td><code dir=\"auto\">ta.accdist</code></td></tr><tr><td><code dir=\"auto\">alma()</code></td><td><code dir=\"auto\">ta.alma()</code></td></tr><tr><td><code dir=\"auto\">atr()</code></td><td><code dir=\"auto\">ta.atr()</code></td></tr><tr><td><code dir=\"auto\">bb()</code></td><td><code dir=\"auto\">ta.bb()</code></td></tr><tr><td><code dir=\"auto\">bbw()</code></td><td><code dir=\"auto\">ta.bbw()</code></td></tr><tr><td><code dir=\"auto\">cci()</code></td><td><code dir=\"auto\">ta.cci()</code></td></tr><tr><td><code dir=\"auto\">cmo()</code></td><td><code dir=\"auto\">ta.cmo()</code></td></tr><tr><td><code dir=\"auto\">cog()</code></td><td><code dir=\"auto\">ta.cog()</code></td></tr><tr><td><code dir=\"auto\">dmi()</code></td><td><code dir=\"auto\">ta.dmi()</code></td></tr><tr><td><code dir=\"auto\">ema()</code></td><td><code dir=\"auto\">ta.ema()</code></td></tr><tr><td><code dir=\"auto\">hma()</code></td><td><code dir=\"auto\">ta.hma()</code></td></tr><tr><td><code dir=\"auto\">iii</code></td><td><code dir=\"auto\">ta.iii</code></td></tr><tr><td><code dir=\"auto\">kc()</code></td><td><code dir=\"auto\">ta.kc()</code></td></tr><tr><td><code dir=\"auto\">kcw()</code></td><td><code dir=\"auto\">ta.kcw()</code></td></tr><tr><td><code dir=\"auto\">linreg()</code></td><td><code dir=\"auto\">ta.linreg()</code></td></tr><tr><td><code dir=\"auto\">macd()</code></td><td><code dir=\"auto\">ta.macd()</code></td></tr><tr><td><code dir=\"auto\">mfi()</code></td><td><code dir=\"auto\">ta.mfi()</code></td></tr><tr><td><code dir=\"auto\">mom()</code></td><td><code dir=\"auto\">ta.mom()</code></td></tr><tr><td><code dir=\"auto\">nvi</code></td><td><code dir=\"auto\">ta.nvi</code></td></tr><tr><td><code dir=\"auto\">obv</code></td><td><code dir=\"auto\">ta.obv</code></td></tr><tr><td><code dir=\"auto\">pvi</code></td><td><code dir=\"auto\">ta.pvi</code></td></tr><tr><td><code dir=\"auto\">pvt</code></td><td><code dir=\"auto\">ta.pvt</code></td></tr><tr><td><code dir=\"auto\">rma()</code></td><td><code dir=\"auto\">ta.rma()</code></td></tr><tr><td><code dir=\"auto\">roc()</code></td><td><code dir=\"auto\">ta.roc()</code></td></tr><tr><td><code dir=\"auto\">rsi(x, y)</code></td><td><code dir=\"auto\">ta.rsi(source, length)</code></td></tr><tr><td><code dir=\"auto\">sar()</code></td><td><code dir=\"auto\">ta.sar()</code></td></tr><tr><td><code dir=\"auto\">sma()</code></td><td><code dir=\"auto\">ta.sma()</code></td></tr><tr><td><code dir=\"auto\">stoch()</code></td><td><code dir=\"auto\">ta.stoch()</code></td></tr><tr><td><code dir=\"auto\">supertrend()</code></td><td><code dir=\"auto\">ta.supertrend()</code></td></tr><tr><td><code dir=\"auto\">swma(x)</code></td><td><code dir=\"auto\">ta.swma(source)</code></td></tr><tr><td><code dir=\"auto\">tr</code></td><td><code dir=\"auto\">ta.tr</code></td></tr><tr><td><code dir=\"auto\">tr()</code></td><td><code dir=\"auto\">ta.tr()</code></td></tr><tr><td><code dir=\"auto\">tsi()</code></td><td><code dir=\"auto\">ta.tsi()</code></td></tr><tr><td><code dir=\"auto\">vwap</code></td><td><code dir=\"auto\">ta.vwap</code></td></tr><tr><td><code dir=\"auto\">vwap(x)</code></td><td><code dir=\"auto\">ta.vwap(source)</code></td></tr><tr><td><code dir=\"auto\">vwma()</code></td><td><code dir=\"auto\">ta.vwma()</code></td></tr><tr><td><code dir=\"auto\">wad</code></td><td><code dir=\"auto\">ta.wad</code></td></tr><tr><td><code dir=\"auto\">wma()</code></td><td><code dir=\"auto\">ta.wma()</code></td></tr><tr><td><code dir=\"auto\">wpr()</code></td><td><code dir=\"auto\">ta.wpr()</code></td></tr><tr><td><code dir=\"auto\">wvad</code></td><td><code dir=\"auto\">ta.wvad</code></td></tr></tbody></table>\n<h5 class=\"md-heading\" id=\"supporting-functions\"><a href=\"#supporting-functions\">Supporting functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h5>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">barsince()</code></td><td><code dir=\"auto\">ta.barsince()</code></td></tr><tr><td><code dir=\"auto\">change()</code></td><td><code dir=\"auto\">ta.change()</code></td></tr><tr><td><code dir=\"auto\">correlation(source_a, source_b, length)</code></td><td><code dir=\"auto\">ta.correlation(source1, source2, length)</code></td></tr><tr><td><code dir=\"auto\">cross(x, y)</code></td><td><code dir=\"auto\">ta.cross(source1, source2)</code></td></tr><tr><td><code dir=\"auto\">crossover(x, y)</code></td><td><code dir=\"auto\">ta.crossover(source1, source2)</code></td></tr><tr><td><code dir=\"auto\">crossunder(x, y)</code></td><td><code dir=\"auto\">ta.crossunder(source1, source2)</code></td></tr><tr><td><code dir=\"auto\">cum(x)</code></td><td><code dir=\"auto\">ta.cum(source)</code></td></tr><tr><td><code dir=\"auto\">dev()</code></td><td><code dir=\"auto\">ta.dev()</code></td></tr><tr><td><code dir=\"auto\">falling()</code></td><td><code dir=\"auto\">ta.falling()</code></td></tr><tr><td><code dir=\"auto\">highest()</code></td><td><code dir=\"auto\">ta.highest()</code></td></tr><tr><td><code dir=\"auto\">highestbars()</code></td><td><code dir=\"auto\">ta.highestbars()</code></td></tr><tr><td><code dir=\"auto\">lowest()</code></td><td><code dir=\"auto\">ta.lowest()</code></td></tr><tr><td><code dir=\"auto\">lowestbars()</code></td><td><code dir=\"auto\">ta.lowestbars()</code></td></tr><tr><td><code dir=\"auto\">median()</code></td><td><code dir=\"auto\">ta.median()</code></td></tr><tr><td><code dir=\"auto\">mode()</code></td><td><code dir=\"auto\">ta.mode()</code></td></tr><tr><td><code dir=\"auto\">percentile_linear_interpolation()</code></td><td><code dir=\"auto\">ta.percentile_linear_interpolation()</code></td></tr><tr><td><code dir=\"auto\">percentile_nearest_rank()</code></td><td><code dir=\"auto\">ta.percentile_nearest_rank()</code></td></tr><tr><td><code dir=\"auto\">percentrank()</code></td><td><code dir=\"auto\">ta.percentrank()</code></td></tr><tr><td><code dir=\"auto\">pivothigh()</code></td><td><code dir=\"auto\">ta.pivothigh()</code></td></tr><tr><td><code dir=\"auto\">pivotlow()</code></td><td><code dir=\"auto\">ta.pivotlow()</code></td></tr><tr><td><code dir=\"auto\">range()</code></td><td><code dir=\"auto\">ta.range()</code></td></tr><tr><td><code dir=\"auto\">rising()</code></td><td><code dir=\"auto\">ta.rising()</code></td></tr><tr><td><code dir=\"auto\">stdev()</code></td><td><code dir=\"auto\">ta.stdev()</code></td></tr><tr><td><code dir=\"auto\">valuewhen()</code></td><td><code dir=\"auto\">ta.valuewhen()</code></td></tr><tr><td><code dir=\"auto\">variance()</code></td><td><code dir=\"auto\">ta.variance()</code></td></tr></tbody></table>\n<h4 class=\"md-heading\" id=\"math-namespace-for-math-related-functions-and-variables\"><a href=\"#math-namespace-for-math-related-functions-and-variables\">\u201dmath\u201d namespace for math-related functions and variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">abs(x)</code></td><td><code dir=\"auto\">math.abs(number)</code></td></tr><tr><td><code dir=\"auto\">acos(x)</code></td><td><code dir=\"auto\">math.acos(number)</code></td></tr><tr><td><code dir=\"auto\">asin(x)</code></td><td><code dir=\"auto\">math.asin(number)</code></td></tr><tr><td><code dir=\"auto\">atan(x)</code></td><td><code dir=\"auto\">math.atan(number)</code></td></tr><tr><td><code dir=\"auto\">avg()</code></td><td><code dir=\"auto\">math.avg()</code></td></tr><tr><td><code dir=\"auto\">ceil(x)</code></td><td><code dir=\"auto\">math.ceil(number)</code></td></tr><tr><td><code dir=\"auto\">cos(x)</code></td><td><code dir=\"auto\">math.cos(angle)</code></td></tr><tr><td><code dir=\"auto\">exp(x)</code></td><td><code dir=\"auto\">math.exp(number)</code></td></tr><tr><td><code dir=\"auto\">floor(x)</code></td><td><code dir=\"auto\">math.floor(number)</code></td></tr><tr><td><code dir=\"auto\">log(x)</code></td><td><code dir=\"auto\">math.log(number)</code></td></tr><tr><td><code dir=\"auto\">log10(x)</code></td><td><code dir=\"auto\">math.log10(number)</code></td></tr><tr><td><code dir=\"auto\">max()</code></td><td><code dir=\"auto\">math.max()</code></td></tr><tr><td><code dir=\"auto\">min()</code></td><td><code dir=\"auto\">math.min()</code></td></tr><tr><td><code dir=\"auto\">pow()</code></td><td><code dir=\"auto\">math.pow()</code></td></tr><tr><td><code dir=\"auto\">random()</code></td><td><code dir=\"auto\">math.random()</code></td></tr><tr><td><code dir=\"auto\">round(x, precision)</code></td><td><code dir=\"auto\">math.round(number, precision)</code></td></tr><tr><td><code dir=\"auto\">round_to_mintick(x)</code></td><td><code dir=\"auto\">math.round_to_mintick(number)</code></td></tr><tr><td><code dir=\"auto\">sign(x)</code></td><td><code dir=\"auto\">math.sign(number)</code></td></tr><tr><td><code dir=\"auto\">sin(x)</code></td><td><code dir=\"auto\">math.sin(angle)</code></td></tr><tr><td><code dir=\"auto\">sqrt(x)</code></td><td><code dir=\"auto\">math.sqrt(number)</code></td></tr><tr><td><code dir=\"auto\">sum()</code></td><td><code dir=\"auto\">math.sum()</code></td></tr><tr><td><code dir=\"auto\">tan(x)</code></td><td><code dir=\"auto\">math.tan(angle)</code></td></tr><tr><td><code dir=\"auto\">todegrees()</code></td><td><code dir=\"auto\">math.todegrees()</code></td></tr><tr><td><code dir=\"auto\">toradians()</code></td><td><code dir=\"auto\">math.toradians()</code></td></tr></tbody></table>\n<h4 class=\"md-heading\" id=\"request-namespace-for-functions-that-request-external-data\"><a href=\"#request-namespace-for-functions-that-request-external-data\">\u201drequest\u201d namespace for functions that request external data<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">financial()</code></td><td><code dir=\"auto\">request.financial()</code></td></tr><tr><td><code dir=\"auto\">quandl()</code></td><td><code dir=\"auto\">request.quandl()</code></td></tr><tr><td><code dir=\"auto\">security(&lt;...&gt;, resolution, &lt;...&gt;)</code></td><td><code dir=\"auto\">request.security(&lt;...&gt;, timeframe, &lt;...&gt;)</code></td></tr><tr><td><code dir=\"auto\">splits()</code></td><td><code dir=\"auto\">request.splits()</code></td></tr><tr><td><code dir=\"auto\">dividends()</code></td><td><code dir=\"auto\">request.dividends()</code></td></tr><tr><td><code dir=\"auto\">earnings()</code></td><td><code dir=\"auto\">request.earnings()</code></td></tr></tbody></table>\n<h4 class=\"md-heading\" id=\"ticker-namespace-for-functions-that-help-create-tickers\"><a href=\"#ticker-namespace-for-functions-that-help-create-tickers\">\u201dticker\u201d namespace for functions that help create tickers<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">heikinashi()</code></td><td><code dir=\"auto\">ticker.heikinashi()</code></td></tr><tr><td><code dir=\"auto\">kagi()</code></td><td><code dir=\"auto\">ticker.kagi()</code></td></tr><tr><td><code dir=\"auto\">linebreak()</code></td><td><code dir=\"auto\">ticker.linebreak()</code></td></tr><tr><td><code dir=\"auto\">pointfigure()</code></td><td><code dir=\"auto\">ticker.pointfigure()</code></td></tr><tr><td><code dir=\"auto\">renko()</code></td><td><code dir=\"auto\">ticker.renko()</code></td></tr><tr><td><code dir=\"auto\">tickerid()</code></td><td><code dir=\"auto\">ticker.new()</code></td></tr></tbody></table>\n<h4 class=\"md-heading\" id=\"str-namespace-for-functions-that-manipulate-strings\"><a href=\"#str-namespace-for-functions-that-manipulate-strings\">\u201dstr\u201d namespace for functions that manipulate strings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<table><thead><tr><th>v4</th><th>v5</th></tr></thead><tbody><tr><td><code dir=\"auto\">tostring(x, y)</code></td><td><code dir=\"auto\">str.tostring(value, format)</code></td></tr><tr><td><code dir=\"auto\">tonumber(x)</code></td><td><code dir=\"auto\">str.tonumber(string)</code></td></tr></tbody></table>", "segment_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c:15", "segment_order": 15, "segment_type": "guide_section", "source_artifact_id": "5599eb63f2718567a1876bdbca465451272ff86f720778ca445cf12f7a84ec4c", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-indicator", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/primer/first-indicator\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"first-indicator\"><a href=\"#first-indicator\">First indicator<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-indicator", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"the-pine-editor\"><a href=\"#the-pine-editor\">The Pine Editor<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The Pine Editor is where you will be working on your scripts. While you\ncan use any text editor you want to write your Pine scripts, using our\nEditor has many advantages:</p>\n<ul>\n<li>It highlights your code following Pine Script\u00ae syntax.</li>\n<li>It pops up syntax reminders when you hover over language constructs.</li>\n<li>It provides quick access to the Pine Script v5 Reference Manual popup when you <code dir=\"auto\">ctrl</code> / <code dir=\"auto\">cmd</code> + <code dir=\"auto\">click</code> on built-in Pine Script constructs, and opens the library publication page when doing the same with construsts imported from libraries.</li>\n<li>It provides an auto-complete feature that you can activate with <code dir=\"auto\">ctrl</code> + <code dir=\"auto\">space</code> or <code dir=\"auto\">cmd</code> + <code dir=\"auto\">I</code>, depending on your OS.</li>\n<li>It makes the write/compile/run cycle fast because saving a new version of a script loaded on the chart also executes it immediately.</li>\n</ul>\n<p>To open the Editor, click on the \u201cPine Editor\u201d tab at the bottom of your TradingView chart. This will open up the Editor\u2019s pane.</p>", "segment_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-indicator", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"first-version\"><a href=\"#first-version\">First version<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We will now create our first working Pine script, an implementation of\nthe\n<a href=\"https://www.tradingview.com/support/solutions/43000502344-macd-moving-average-convergence-divergence/\">MACD</a>\nindicator in Pine Script:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MACD #1\")\nfast = 12\nslow = 26\nfastMA = ta.ema(close, fast)\nslowMA = ta.ema(close, slow)\nmacd = fastMA - slowMA\nsignal = ta.ema(macd, 9)\nplot(macd, color = color.blue)\nplot(signal, color = color.orange)</div>\n<ul>\n<li>Start by bringing up the \u201cOpen\u201d dropdown menu at the top right of the Editor and choose \u201cNew indicator\u201d.</li>\n<li>Copy the example script above. The button on the top-right of the code widget allows you to do it with a single click.</li>\n<li>Select all the code already in the editor and replace it with the example script.</li>\n<li>Click \u201cSave\u201d and choose a name for your script. Your script is now saved in TradingView\u2019s cloud, but under your account\u2019s name. Nobody but you can use it.</li>\n<li>Click \u201cAdd to Chart\u201d in the Editor\u2019s menu bar. The MACD indicator appears in a separate <em>pane</em> under your chart.</li>\n</ul>\n<p>Your first Pine script is running on your chart, which should look like this:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1360\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstIndicator-Version1.KmK30ixb_ZYtPVL.webp\" width=\"1602\"/></p>\n<p>Let\u2019s look at our script\u2019s code, line by line:</p>\n<p>Line 1: <code dir=\"auto\">//@version=5</code></p>\n<p class=\"spacer-wrapper\"><spacer/> This is a\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation </a> telling the compiler the script will use version 5 of\nPine Script.</p>\n<p>Line 2: <code dir=\"auto\">indicator(\"MACD #1\")</code></p>\n<p class=\"spacer-wrapper\"><spacer/>  Defines the name of the script that will appear on the chart as\n\u201cMACD\u201d.</p>\n<p>Line 3: <code dir=\"auto\">fast = 12</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines a <code dir=\"auto\">fast</code> integer variable which will be the length of the\nfast EMA.</p>\n<p>Line 4: <code dir=\"auto\">slow = 26</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines a <code dir=\"auto\">slow</code> integer variable which will be the length of the\nslow EMA.</p>\n<p>Line 5: <code dir=\"auto\">fastMA = ta.ema(close, fast)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines the variable <code dir=\"auto\">fastMA</code>, containing the result of the EMA\ncalculation (Exponential Moving Average) with a length equal to\n<code dir=\"auto\">fast</code> (12), on the <code dir=\"auto\">close</code> series, i.e., the closing price of bars.</p>\n<p>Line 6: <code dir=\"auto\">slowMA = ta.ema(close, slow)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines the variable <code dir=\"auto\">slowMA</code>, containing the result of the EMA\ncalculation with a length equal to <code dir=\"auto\">slow</code> (26), from <code dir=\"auto\">close</code>.</p>\n<p>Line 7: <code dir=\"auto\">macd = fastMA - slowMA</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines the variable <code dir=\"auto\">macd</code> as the difference between the two EMAs.</p>\n<p>Line 8: <code dir=\"auto\">signal = ta.ema(macd, 9)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Defines the variable <code dir=\"auto\">signal</code> as a smoothed value of <code dir=\"auto\">macd</code> using\nthe EMA algorithm (Exponential Moving Average) with a length of 9.</p>\n<p>Line 9: <code dir=\"auto\">plot(macd, color = color.blue)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Calls the <code dir=\"auto\">plot</code> function to output the variable <code dir=\"auto\">macd</code> using a blue\nline.</p>\n<p>Line 10: <code dir=\"auto\">plot(signal, color = color.orange)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Calls the <code dir=\"auto\">plot</code> function to output the variable <code dir=\"auto\">signal</code> using an\norange line.</p>", "segment_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-indicator", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"second-version\"><a href=\"#second-version\">Second version<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The first version of our script calculated MACD \u201cmanually\u201d, but\nbecause Pine Script is designed to write indicators and strategies,\nbuilt-in Pine Script functions exist for many common indicators,\nincluding one for MACD:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmacd\">ta.macd()</a>.</p>\n<p>This is the second version of our script:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"MACD #2\")\nfastInput = input(12, \"Fast length\")\nslowInput = input(26, \"Slow length\")\n[macdLine, signalLine, histLine] = ta.macd(close, fastInput, slowInput, 9)\nplot(macdLine, color = color.blue)\nplot(signalLine, color = color.orange)</div>\n<p>Note that we have:</p>\n<ul>\n<li>Added inputs so we can change the lengths for the MAs</li>\n<li>We now use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmacd\">ta.macd()</a>\nbuilt-in to calculate our MACD, which saves us three line and makes\nour code easier to read.</li>\n</ul>\n<p>Let\u2019s repeat the same process as before to copy that code in a new\nindicator:</p>\n<ul>\n<li>Start by bringing up the \u201cOpen\u201d dropdown menu at the top right of\nthe Editor and choose \u201cNew indicator\u201d.</li>\n<li>Then copy the example script above.</li>\n<li>Select all the code already in the editor and replace it with the\nsecond version of our script.</li>\n<li>Click \u201cSave\u201d and choose a name for your script different than the\nprevious one.</li>\n<li>Click \u201cAdd to Chart\u201d in the Editor\u2019s menu bar. The \u201cMACD #2\u201d\nindicator appears in a separate <em>pane</em> under the \u201cMACD #1\u201d\nindicator.</li>\n</ul>\n<p>Your second Pine script is running on your chart. If you double-click on\nthe indicator\u2019s name on your chart, you will bring up the script\u2019s\n\u201cSettings/Inputs\u201d tab, where you can now change the slow and fast\nlengths:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1360\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstIndicator-Version2.C81ViZRN_ZPOHgP.webp\" width=\"1602\"/></p>\n<p>Let\u2019s look at the lines that have changed in the second version of our\nscript:</p>\n<p>Line 2: <code dir=\"auto\">indicator(\"MACD #2\")</code></p>\n<p class=\"spacer-wrapper\"><spacer/> We have changed <code dir=\"auto\">#1</code> to <code dir=\"auto\">#2</code> so the second version of our indicator\ndisplays a different name on the chart.</p>\n<p>Line 3: <code dir=\"auto\">fastInput = input(12, \"Fast length\")</code></p>\n<p class=\"spacer-wrapper\"><spacer/> Instead of assigning a constant value to a variable, we have used\nthe\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input\">input()</a>\nfunction so we can change the value in our script\u2019s\n\u201cSettings/Inputs\u201d tab. <code dir=\"auto\">12</code> will be the default value and the\nfield\u2019s label will be <code dir=\"auto\">\"Fast length\"</code>. If the value is changed in\nthe \u201cInputs\u201d tab, the <code dir=\"auto\">fastInput</code> variable\u2019s content will contain\nthe new value and the script will re-execute on the chart with that\nnew value. Note that, as our Pine Script\n<a href=\"/pine-script-docs/v5/writing/style-guide/\">Style Guide </a>\nrecommends, we add <code dir=\"auto\">Input</code> to the end of the variable\u2019s name to\nremind us, later in the script, that its value comes from a user\ninput.</p>\n<p>Line 4: <code dir=\"auto\">slowInput = input(26, \"Slow length\")</code></p>\n<p class=\"spacer-wrapper\"><spacer/> We do the same for the slow length, taking care to use a different\nvariable name, default value and text string for the field\u2019s label.</p>\n<p>Line 5: <code dir=\"auto\">[macdLine, signalLine, histLine] = ta.macd(close, fastInput, slowInput, 9)</code></p>\n<p class=\"spacer-wrapper\"><spacer/> This is where we call the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmacd\">ta.macd()</a>\nbuilt-in to perform all the first version\u2019s calculations in one\nline only. The function requires four parameters (the values after\nthe function name, enclosed in parentheses). It returns three values\ninto the three variables instead of only one, like the functions we\nused until now, which is why we need to enclose the list of three\nvariables receiving the function\u2019s result in square brackets, to\nthe left of the <code dir=\"auto\">=</code> sign. Note that two of the values we pass to the\nfunction are the \u201cinput\u201d variables containing the fast and slow\nlengths: <code dir=\"auto\">fastInput</code> and <code dir=\"auto\">slowInput</code>.</p>\n<p>Line 6 and 7:</p>\n<p class=\"spacer-wrapper\"><spacer/> The variable names we are plotting there have changed, but the lines\nare doing the same thing as in our first version.</p>\n<p>Our second version performs the same calculations as our first, but we\ncan change the two lengths used to calculate it. Our code is also\nsimpler and shorter by three lines. We have improved our script.</p>", "segment_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-indicator", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"next\"><a href=\"#next\">Next<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We now recommend you go to our\n<a href=\"/pine-script-docs/v5/primer/next-steps/\">Next Steps </a> page.</p>", "segment_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "df6bf430b999fdbee62c31c848227866b2e887bf2220ede8e57fae993de29822", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/primer/first-steps\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"first-steps\"><a href=\"#first-steps\">First steps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Welcome to the Pine Script\u00ae <a href=\"/pine-script-docs/v5/welcome/\">v5 User\nManual</a>,\nwhich will accompany you in your journey to learn to program your own\ntrading tools in Pine Script. Welcome also to the very active community\nof Pine Script programmers on TradingView.</p>\n<p>In this page, we present a step-by-step approach that you can follow to\ngradually become more familiar with indicators and strategies (also\ncalled <em>scripts</em>) written in the Pine Script programming language on\n<a href=\"https://www.tradingview.com/\">TradingView</a>. We will get you started on\nyour journey to:</p>\n<ol>\n<li><strong>Use</strong> some of the tens of thousands of existing scripts on the\nplatform.</li>\n<li><strong>Read</strong> the Pine Script code of existing scripts.</li>\n<li><strong>Write</strong> Pine Script scripts.</li>\n</ol>\n<p>If you are already familiar with the use of Pine scripts on TradingView\nand are now ready to learn how to write your own, then jump to the\n<a href=\"/pine-script-docs/v5/primer/first-steps/#writing-scripts\">Writing scripts</a> section of this page.</p>\n<p>If you are new to our platform, then please read on!</p>", "segment_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"using-scripts\"><a href=\"#using-scripts\">Using scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>If you are interested in using technical indicators or strategies on\nTradingView, you can first start exploring the thousands of indicators\nalready available on our platform. You can access existing indicators on\nthe platform in two different ways:</p>\n<ul>\n<li>By using the chart\u2019s \u201cIndicators, Metrics &amp; Strategies\u201d button, or</li>\n<li>By browsing TradingView\u2019s <a href=\"https://www.tradingview.com/scripts/\">Community\nScripts</a>, the largest\nrepository of trading scripts in the world, with more than 100,000\nscripts, most of which are free and open-source, which means you can\nsee their Pine Script code.</li>\n</ul>\n<p>If you can find the tools you need already written for you, it can be a\ngood way to get started and gradually become proficient as a script\nuser, until you are ready to start your programming journey in Pine\nScript.</p>\n<h3 class=\"md-heading\" id=\"loading-scripts-from-the-chart\"><a href=\"#loading-scripts-from-the-chart\">Loading scripts from the chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>To explore and load scripts from your chart, use the \u201cIndicators, Metrics &amp;\nStrategies\u201d button:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"690\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-LoadingScriptsFromTheChart-01.sUP7fNRn_2hhzUU.webp\" width=\"1370\"/></p>\n<p>The dialog box presents different categories of scripts in its left\npane:</p>\n<ul>\n<li><strong>Favorites</strong> lists the scripts you have \u201cfavorited\u201d by clicking\non the star that appears to the left of its name when you mouse over\nit.</li>\n<li><strong>Personal</strong> displays the scipts you have written and saved in the\nPine Editor. They are saved in TradingView\u2019s cloud.</li>\n<li><strong>Technicals</strong> groups most TradingView built-ins organized in four\ncategories: indicators, strategies, profiles, and patterns. Most are written in Pine Script and available for free.</li>\n<li><strong>Financials</strong> contains all built-in indicators that display financial metrics. The contents of that tab and the subcategories they are grouped into depend on the symbol currently open on the chart.</li>\n<li><strong>Community</strong> is where you can search from the 100,000+ published scripts written by TradingView users. The scripts can be sorted by one of the three different filters \u2014 Editor\u2019s Picks only shows open-source scripts hand-picked my our script moderatots, Top shows the most popular scripts of all time, and Trending displays the most-popular scripts that were published recently.</li>\n<li><strong>Invite-only</strong> contains the list of the invite-only scripts you have been granted access to by their authors.</li>\n</ul>\n<p>Here, the section containing the TradingView built-ins is selected:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"902\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-LoadingScriptsFromTheChart-02.B0l60fcX_yPIjb.webp\" width=\"1360\"/></p>\n<p>When you click on one of the indicators or strategies (the ones marked with a symbol with two arrows), it loads on your chart.</p>\n<h3 class=\"md-heading\" id=\"browsing-community-scripts\"><a href=\"#browsing-community-scripts\">Browsing Community Scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>From <a href=\"https://www.tradingview.com/\">TradingView\u2019s homepage</a>, you can\nbring up the Community Scripts stream from the \u201cCommunity\u201d menu. Here,\nwe are pointing to the \u201cEditors\u2019 Picks\u201d section, but there are many\nother categories you can choose from:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1194\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-BrowsingCommunityScripts-01.Div4R2G3_1GVDJ1.webp\" width=\"2044\"/></p>\n<p>You can also search for scripts using the homepage\u2019s \u201cSearch\u201d field,\nand filter scripts using different criteria. The Help Center has a page\nexplaining the <a href=\"https://www.tradingview.com/support/solutions/43000558522\">different types of\nscripts</a> that\nare available.</p>\n<p>The scripts stream shows script <em>widgets</em>, i.e., placeholders showing a\nminiature view of each publication\u2019s chart and description, and its\nauthor. By clicking on it you will open the <em>script\u2019s page</em>, where you\ncan see the script on a chart, read the author\u2019s description, like the\nscript, leave comments or read the script\u2019s source code if it was\npublished open-source.</p>\n<p>Once you find an interesting script in the Community Scripts, follow the\ninstructions in the Help Center to <a href=\"https://www.tradingview.com/support/solutions/43000555216\">load it on your\nchart</a>.</p>\n<h3 class=\"md-heading\" id=\"changing-script-settings\"><a href=\"#changing-script-settings\">Changing script settings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Once a script is loaded on the chart, you can double-click on its name or hover over the name and press the \u201cSettings\u201d button to bring up its \u201cSettings/Inputs\u201d tab:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1286\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-ChangingScriptSettings-01.D-SAixbh_Z1UAbp6.webp\" width=\"1720\"/></p>\n<p>The \u201cInputs\u201d tab allows you to change the settings which the script\u2019s\nauthor has decided to make editable. You can configure some of the\nscript\u2019s visuals using the \u201cStyle\u201d tab of the same dialog box, and\nwhich timeframes the script should appear on using the \u201cVisibility\u201d\ntab.</p>\n<p>Other settings are available to all scripts from the buttons that appear\nto the right of its name when you mouse over it, and from the \u201cMore\u201d\nmenu (the three dots):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1284\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-ChangingScriptSettings-02.CJECCf_u_rSCqQ.webp\" width=\"1420\"/></p>", "segment_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"reading-scripts\"><a href=\"#reading-scripts\">Reading scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Reading code written by <strong>good</strong> programmers is the best way to develop\nyour understanding of the language. This is as true for Pine Script as\nit is for all other programming languages. Finding good open-source Pine\nScript code is relatively easy. These are reliable sources of code\nwritten by good programmers on TradingView:</p>\n<ul>\n<li>The TradingView built-in indicators</li>\n<li>Scripts selected as <a href=\"https://www.tradingview.com/scripts/editors-picks/\">Editors\u2019\nPicks</a></li>\n<li>Scripts by the <a href=\"https://www.tradingview.com/u/PineCoders/#following-people\">authors the PineCoders account\nfollows</a></li>\n<li>Many scripts by authors with high reputation and open-source\npublications.</li>\n</ul>\n<p>Reading code from <a href=\"https://www.tradingview.com/scripts/\">Community\nScripts</a> is easy; if you don\u2019t\nsee a grey or red \u201clock\u201d icon in the upper-right corner of the\nscript\u2019s widget, this indicates the script is open-source. By opening\nits script page, you will be able to see its source.</p>\n<p>To see the code of TradingView built-ins, load the indicator on your\nchart, then hover over its name and select the \u201cSource code\u201d curly\nbraces icon (if you don\u2019t see it, it\u2019s because the indicator\u2019s source\nis unavailable). When you click on the icon, the Pine Editor will open\nand from there, you can see the script\u2019s code. If you want to play with\nit, you will need to press the \u201ccreate a working copy\u201d button. You\nwill then be able to modify and save the code. Because you will have\ncreated a different version of the script, you will need to use the\nEditor\u2019s \u201cAdd to Chart\u201d button to add that new copy to the chart.</p>\n<p>This shows the Pine Editor having just opened after we selected the \u201cView source\u201d button from the indicator on our chart. We are about to create a working copy of its source because it is read-only for now, as indicated by the orange warning text:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"1294\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FirstSteps-ReadingScripts-01.CECYLblz_1ijCDs.webp\" width=\"1614\"/></p>\n<p>You can also open TradingView built-in indicators from the Pine Editor\n(accessible from the \u201cPine Editor\u201d tab at the bottom of the chart) by\nusing the \u201cOpen\u201d -&gt; \u201cBuilt-in script\u2026\u201d menu selection.</p>", "segment_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/first-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"writing-scripts\"><a href=\"#writing-scripts\">Writing scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We have built Pine Script to empower both budding and seasoned traders\nto create their own trading tools. We have designed it so it is\nrelatively easy to learn for first-time programmers \u2014 although\nlearning a first programming language, like trading, is rarely <strong>very</strong>\neasy for anyone \u2014 yet powerful enough for knowledgeable programmers to\nbuild tools of moderate complexity.</p>\n<p>Pine Script allows you to write three types of scripts:</p>\n<ul>\n<li><strong>Indicators</strong> like RSI, MACD, etc.</li>\n<li><strong>Strategies</strong> which include logic to issue trading orders and can\nbe backtested and forward-tested.</li>\n<li><strong>Libraries</strong> which are used by more advanced programmers to package\noft-used functions that can be reused by other scripts.</li>\n</ul>\n<p>The next step we recommend is to write your\n<a href=\"/pine-script-docs/v5/primer/first-indicator/\">first indicator</a>.</p>", "segment_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "e2aa07ee9fe493d42f8ee006eae3edc1c8d27ee3e8ab5c623c733c3c348e54b5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/primer/next-steps\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"next-steps\"><a href=\"#next-steps\">Next steps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>After your <a href=\"/pine-script-docs/v5/primer/first-steps/\">first steps</a>\nand your <a href=\"/pine-script-docs/v5/primer/first-indicator/\">first indicator</a>, let us explore a bit more of the Pine Script\u00ae landscape by\nsharing some pointers to guide you in your journey to learn Pine\nScript.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"indicators-vs-strategies\"><a href=\"#indicators-vs-strategies\">\u201dindicators\u201d vs \u201cstrategies\u201d<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script <a href=\"/pine-script-docs/v5/concepts/strategies/\">strategies</a>\nare used to backtest on historical data and forward test on open\nmarkets. In addition to indicator calculations, they contain\n<code dir=\"auto\">strategy.*()</code> calls to send trade orders to Pine Script\u2019s broker\nemulator, which can then simulate their execution. Strategies display\nbacktest results in the \u201cStrategy Tester\u201d tab at the bottom of the\nchart, next to the \u201cPine Editor\u201d tab.</p>\n<p>Pine Script indicators also contain calculations, but cannot be used in\nbacktesting. Because they do not require the broker emulator, they use\nless resources and will run faster. It is thus advantageous to use\nindicators whenever you can.</p>\n<p>Both indicators and strategies can run in either overlay mode (over the\nchart\u2019s bars) or pane mode (in a separate section below or above the\nchart). Both can also plot information in their respective space, and\nboth can generate <a href=\"/pine-script-docs/v5/concepts/alerts/\">alert events</a>.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"how-scripts-are-executed\"><a href=\"#how-scripts-are-executed\">How scripts are executed<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A Pine script is <strong>not</strong> like programs in many programming languages\nthat execute once and then stop. In the Pine Script <em>runtime</em>\nenvironment, a script runs in the equivalent of an invisible loop where\nit is executed once on each bar of whatever chart you are on, from left\nto right. Chart bars that have already closed when the script executes\non them are called <em>historical bars</em>. When execution reaches the\nchart\u2019s last bar and the market is open, it is on the <em>realtime bar</em>.\nThe script then executes once every time a price or volume change is\ndetected, and one last time for that realtime bar when it closes. That\nrealtime bar then becomes an <em>elapsed realtime bar</em>. Note that when the\nscript executes in realtime, it does not recalculate on all the chart\u2019s\nhistorical bars on every price/volume update. It has already calculated\nonce on those bars, so it does not need to recalculate them on every\nchart tick. See the\n<a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>\npage for more information.</p>\n<p>When a script executes on a historical bar, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nbuilt-in variable holds the value of that bar\u2019s close. When a script\nexecutes on the realtime bar,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nreturns the <strong>current</strong> price of the symbol until the bar closes.</p>\n<p>Contrary to indicators, strategies normally execute only once on\nrealtime bars, when they close. They can also be configured to execute\non each price/volume update if that is what you need. See the page on\n<a href=\"/pine-script-docs/v5/concepts/strategies/\">Strategies</a> for more\ninformation, and to understand how strategies calculate differently than\nindicators.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"time-series\"><a href=\"#time-series\">Time series<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The main data structure used in Pine Script is called a\n<a href=\"/pine-script-docs/v5/language/time-series/\">time series</a>. Time\nseries contain one value for each bar the script executes on, so they\ncontinuously expand as the script executes on more bars. Past values of\nthe time series can be referenced using the history-referencing\noperator:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>.\n<code dir=\"auto\">close[1]</code>, for example, refers to the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\non the bar preceding the one where the script is executing.</p>\n<p>While this indexing mechanism may remind many programmers of arrays, a\ntime series is different and thinking in terms of arrays will be\ndetrimental to understanding this key Pine Script concept. A good\ncomprehension of both the\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and\n<a href=\"/pine-script-docs/v5/language/time-series/\">time series</a> is\nessential in understanding how Pine scripts work. If you have never\nworked with data organized in time series before, you will need practice\nto put them to work for you. Once you familiarize yourself with these\nkey concepts, you will discover that by combining the use of time series\nwith our built-in functions specifically designed to handle them\nefficiently, much can be accomplished in very few lines of code.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"publishing-scripts\"><a href=\"#publishing-scripts\">Publishing scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView is home to a large community of Pine Script programmers and\nmillions of traders from all around the world. Once you become\nproficient enough in Pine Script, you can choose to share your scripts\nwith other traders. Before doing so, please take the time to learn Pine\nScript well-enough to supply traders with an original and reliable\ntool. All publicly published scripts are analyzed by our team of\nmoderators and must comply with our <a href=\"https://www.tradingview.com/support/solutions/43000590599\">Script Publishing\nRules</a>, which\nrequire them to be original and well-documented.</p>\n<p>If want to use Pine scripts for your own use, simply write them in the\nPine Editor and add them to your chart from there; you don\u2019t have to\npublish them to use them. If you want to share your scripts with just a\nfew friends, you can publish them privately and send your friends the\nbrowser\u2019s link to your private publication. See the page on\n<a href=\"/pine-script-docs/v5/writing/publishing/\">Publishing</a> for more\ninformation.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"getting-around-the-pine-script-documentation\"><a href=\"#getting-around-the-pine-script-documentation\">Getting around the Pine Script documentation<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>While reading code from published scripts is no doubt useful, spending\ntime in our documentation will be necessary to attain any degree of\nproficiency in Pine Script. Our two main sources of documentation on\nPine Script are:</p>\n<ul>\n<li>This Pine Script <a href=\"/pine-script-docs/v5/welcome/\">v5 User\nManual</a></li>\n<li>Our Pine Script <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">v5 Reference\nManual</a></li>\n</ul>\n<p>The Pine Script <a href=\"/pine-script-docs/v5/welcome/\">v5 User Manual</a>, which is located on its separate page and in English only.</p>\n<p>The Pine Script <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">v5 Reference\nManual</a> documents\nwhat each language construct does. It is an essential tool\nfor all Pine Script programmers; your life will be miserable if you try\nto write scripts of any reasonable complexity without consulting it. It\nexists in two formats: a separate page linked above, and the popup\nversion, which can be accessed from the Pine Editor, by either\n<code dir=\"auto\">ctrl</code> / <code dir=\"auto\">cmd</code> + <code dir=\"auto\">clicking</code> on a keyword, or by using the Editor\u2019s \u201cMore/Reference Manual\u2026\u201d menu. The Reference Manual is translated in other\nlanguages.</p>\n<p>There are five different versions of Pine Script. Ensure the\ndocumentation you use corresponds to the Pine Script version you are\ncoding with.</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/primer/next-steps", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"where-to-go-from-here\"><a href=\"#where-to-go-from-here\">Where to go from here?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This Pine Script <a href=\"/pine-script-docs/v5/welcome/\">v5 User Manual</a> contains numerous examples of code used to illustrate the concepts we discuss. By going through it, you will be able to both learn the\nfoundations of Pine Script and study the example scripts. Reading about\nkey concepts and trying them out right away with real code is a\nproductive way to learn any programming language. As you hopefully have\nalready done in the\n<a href=\"/pine-script-docs/v5/primer/first-indicator/\">First indicator</a>\npage, copy this documentation\u2019s examples in the Editor and play with\nthem. Explore! You won\u2019t break anything.</p>\n<p>This is how the Pine Script <a href=\"/pine-script-docs/v5/welcome/\">v5 User Manual</a> you are reading is organized:</p>\n<ul>\n<li>The <a href=\"/pine-script-docs/v5/language/\">Language</a> section\nexplains the main components of the Pine Script language and how\nscripts execute.</li>\n<li>The <a href=\"/pine-script-docs/v5/concepts/\">Concepts</a> section\nis more task-oriented. It explains how to do things in Pine Script.</li>\n<li>The <a href=\"/pine-script-docs/v5/writing/\">Writing</a> section\nexplores tools and tricks that will help you write and publish\nscripts.</li>\n<li>The <a href=\"/pine-script-docs/v5/faq/\">FAQ</a> section answers\ncommon questions from Pine Script programmers.</li>\n<li>The <a href=\"/pine-script-docs/v5/error-messages/\">Error messages</a> page documents causes and fixes for the most common\nruntime and compiler errors.</li>\n<li>The <a href=\"/pine-script-docs/v5/release-notes/\">Release Notes</a>\npage is where you can follow the frequent updates to Pine Script.</li>\n<li>The <a href=\"/pine-script-docs/v5/migration-guides/\">Migration guides</a> section explains how to port between different versions\nof Pine Script.</li>\n<li>The\n<a href=\"/pine-script-docs/v5/where-can-i-get-more-information/\">Where can I get more information</a> page lists other useful Pine Script-related content,\nincluding where to ask questions when you are stuck on code.</li>\n</ul>\n<p>We wish you a successful journey with Pine Script\u2026 and trading!</p>", "segment_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "81be0897a8ec1be51a913c62a844dfc2a950ddf8f8cd07a3d1920e01a3cbdab5", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/public-library", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/welcome\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"public-library\"><a href=\"#public-library\">Public Library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/public-library", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"description\"><a href=\"#description\">Description<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>On TradingView you may choose from our built-in scripts, from the\nuser-published scripts in the <em>Public Library</em>, or write your own custom\nscripts using Pine Script\u00ae. You can search the library for scripts\nbefore writing one. You may also ask users who publish scripts for help\nby sending them a private message (PM) on TradingView.</p>\n<p>The Public Library contains all user-published scripts. All published\nscripts can be viewed either from the\n<a href=\"https://www.tradingview.com/script/\">Scripts</a> section of\ntradingview.com\u2019s page, or from the <em>Indicators</em> <em>Public Library</em> tab:</p>\n<p><img alt=\"Public_Library_tab\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Public_Library_tab.Ch5LOSIU_JheNI.webp\" width=\"1600\"/></p>", "segment_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/public-library", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"copying-a-script-from-the-public-to-your-personal-library\"><a href=\"#copying-a-script-from-the-public-to-your-personal-library\">Copying a script from the Public to your Personal Library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To copy a script, use one of the two following methods:</p>\n<ol>\n<li>Click the star next to the needed script in the Indicators window:</li>\n</ol>\n<p><img alt=\"Add_to_Personal_Library\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Add_to_Personal_Library.CfCpaV_7_1NOVjD.webp\" width=\"1600\"/></p>\n<ol start=\"2\">\n<li>Open the needed script from the\n<a href=\"https://www.tradingview.com/script/\">Scripts</a> section and click the\n<em>Add to Favorite Scripts</em> button:</li>\n</ol>\n<p><img alt=\"Add_to_Personal_Library_2\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Add_to_Personal_Library_2.BLRqKbzE_1cpFdO.webp\" width=\"1600\"/></p>\n<p>The script will be added to your Favorites section in the Indicators\nwindow, where you can easily find it when needed:</p>\n<p><img alt=\"Favorites_section\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Favorites_section.CI29iwSR_Z2fHMS9.webp\" width=\"1600\"/></p>\n<p>Scripts in the <em>Indicators</em> window are sorted by popularity. Scripts\nwith the most likes appear first:</p>\n<p><img alt=\"Sorted_by_popularity\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Sorted_by_popularity.Dbap3fbH_ZUbsQe.webp\" width=\"1600\"/></p>", "segment_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/public-library", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"editing-a-script-from-the-public-library\"><a href=\"#editing-a-script-from-the-public-library\">Editing a script from the Public Library<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To edit a script from the Public Library:</p>\n<ol>\n<li>Open the script (the script will be unavailable for editing and will\nbe colored lighter than normal):</li>\n</ol>\n<p><img alt=\"Open_the_script\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Open_the_script.CO34BjeA_gWRKW.webp\" width=\"1600\"/></p>\n<ol start=\"2\">\n<li>Click on the <em>Make a Copy\u2026</em> button, enter the desired name and\nsave a copy in your personal library:</li>\n</ol>\n<p><img alt=\"Save_as\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Save_as.BN5WcFZj_Z2hsRBy.webp\" width=\"1600\"/></p>\n<p>A saved copy of the script will appear in the list of your scripts in\nthe <em>Indicators</em> <em>My Scripts</em> tab:</p>\n<p><img alt=\"My_Scripts\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/My_Scripts.DjwlYDLf_Z2mCxeg.webp\" width=\"1600\"/></p>\n<p>Now you can open and edit the script.</p>\n<p>If the same script is published more than once, a notification on older\nversions will appear, indicating a new version is available.</p>", "segment_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/public-library", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"searching-for-a-script\"><a href=\"#searching-for-a-script\">Searching for a script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>To search for a script, use the <em>Search</em> field in the <em>Indicators</em>\ndialog:</p>\n<p><img alt=\"Search\" decoding=\"async\" height=\"800\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Search.Ds77F4Kh_ZAlf6k.webp\" width=\"1600\"/></p>\n<p>This will search both your Personal and Public Library at the same time.</p>\n<p>You may also search for scripts from the tradingview.com home page by\nfirst selecting <em>Scripts</em> from the <em>Ticker</em> dropdown menu and entering\nyour search criteria.</p>", "segment_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "c50a3004105dd1b8e26df50b6bc46862205c0abd2d2fb870d126ed20ded04338", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/release-notes\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"release-notes\"><a href=\"#release-notes\">Release notes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>This page contains release notes describing notable changes to the Pine Script\u00ae experience.</p>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2024\"><a href=\"#2024\">2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"october-2024\"><a href=\"#october-2024\">October 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added an optional <code dir=\"auto\">behind_chart</code> parameter to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> functions. This parameter specifies where plots and drawings appear relative to the main chart display when the <code dir=\"auto\">overlay</code> parameter is <code dir=\"auto\">true</code>. If <code dir=\"auto\">behind_chart</code> is <code dir=\"auto\">true</code>, the script\u2019s visuals appear behind the chart display. If <code dir=\"auto\">false</code>, they appear in front of the chart display. The default is <code dir=\"auto\">true</code>.</p>\n<h3 class=\"md-heading\" id=\"august-2024\"><a href=\"#august-2024\">August 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.new\">ticker.new()</a> and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.modify\">ticker.modify()</a> functions feature two new parameters: <code dir=\"auto\">settlement_as_close</code> and <code dir=\"auto\">backadjustment</code>. Users can specify whether these parameters are on, off, or set to inherit the symbol\u2019s default settings. These settings only affect the data from futures symbols with these options available on their charts. They have no effect on other symbols.</p>\n<ul>\n<li>\n<p>The <code dir=\"auto\">backadjustment</code> parameter specifies whether past contract data on continuous futures symbols is back-adjusted. Its possible values are: <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_backadjustment.on\">backadjustment.on</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_backadjustment.off\">backadjustment.off</a>, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_backadjustment.inherit\">backadjustment.inherit</a>.</p>\n</li>\n<li>\n<p>The <code dir=\"auto\">settlement_as_close</code> parameter specifies whether a futures symbol\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a> value represents the actual closing price or the settlement price on \u201c1D\u201d and higher timeframes. Its possible values are: <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_settlement_as_close.on\">settlement_as_close.on</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_settlement_as_close.off\">settlement_as_close.off</a>, or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_settlement_as_close.inherit\">settlement_as_close.inherit</a>.</p>\n</li>\n<li>\n<p>The Sharpe and Sortino ratios in the Strategy Tester module have updated calculations. Previously, the ratios used strategy returns over monthly periods if the trading range was three or more months and daily periods if the range was three or more days but less than three months. Both ratios now always use monthly periods for consistency.</p>\n</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2024\"><a href=\"#june-2024\">June 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added a new parameter to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_polyline.new\">polyline.new()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.new\">table.new()</a> functions:</p>\n<ul>\n<li><code dir=\"auto\">force_overlay</code> - If true, the drawing will display on the main chart pane, even when the script occupies a separate pane. Optional. The default is false.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"pine-script-enums\"><a href=\"#pine-script-enums\">Pine Script Enums<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Enums, also known as <em>enumerations</em>, <em>enumerated types</em>, or <a href=\"/pine-script-docs/v5/language/type-system/#enum-types\">enum types</a>, are unique data types with all possible values declared by the programmer. They can help programmers maintain more strict control over the values allowed by variables, conditional expressions, and <a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>, and they enable convenient dropdown input creation with the new <a href=\"/pine-script-docs/v5/concepts/inputs/#enum-input\">input.enum()</a> function. See our User Manual\u2019s <a href=\"/pine-script-docs/v5/language/enums/\">Enums</a> page to learn more about these new types and how to use them.</p>\n<h3 class=\"md-heading\" id=\"may-2024\"><a href=\"#may-2024\">May 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added an optional <code dir=\"auto\">calc_bars_count</code> parameter to the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>, <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>, and <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a> functions that allows users to limit the number of recent historical bars a script or data request can execute across. When a script\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a> declaration statement includes a <code dir=\"auto\">calc_bars_count</code> argument, its \u201cSettings/Inputs\u201d tab will include a \u201cCalculated bars\u201d input in the \u201cCalculation\u201d section. The default value in all these functions is 0, which signifies that the script or request executes across all the available data.</p>\n<p>The <code dir=\"auto\">strategy.*</code> namespace features several new built-in variables:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_trade\">strategy.avg_trade</a> -\nReturns the average amount of money gained or lost per trade.\nCalculated as the sum of all profits and losses divided by the\nnumber of closed trades.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_trade_percent\">strategy.avg_trade_percent</a> -\nReturns the average percentage gain or loss per trade. Calculated as\nthe sum of all profit and loss percentages divided by the number of\nclosed trades.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_winning_trade\">strategy.avg_winning_trade</a> -\nReturns the average amount of money gained per winning trade.\nCalculated as the sum of profits divided by the number of winning\ntrades.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_winning_trade_percent\">strategy.avg_winning_trade_percent</a> -\nReturns the average percentage gain per winning trade. Calculated as\nthe sum of profit percentages divided by the number of winning\ntrades.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_losing_trade\">strategy.avg_losing_trade</a> -\nReturns the average amount of money lost per losing trade.\nCalculated as the sum of losses divided by the number of losing\ntrades.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.avg_losing_trade_percent\">strategy.avg_losing_trade_percent</a> -\nReturns the average percentage loss per losing trade. Calculated as\nthe sum of loss percentages divided by the number of losing trades.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"pine-profiler\"><a href=\"#pine-profiler\">Pine Profiler<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Our new\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Pine Profiler</a> is a powerful utility that analyzes the executions of all\nsignificant code in a script and displays helpful performance\ninformation next to the code lines <em>inside</em> the Pine Editor. The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a>\u2019s information provides insight into a script\u2019s runtime,\nthe distribution of runtime across significant code regions, and the\nnumber of times each code region executes. With these insights,\nprogrammers can effectively pinpoint performance <em>bottlenecks</em> and\nensure they focus on\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#optimization\">optimizing</a> their code where it truly matters when they need to improve\nexecution times.</p>\n<p>See the new\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/\">Profiling and optimization</a> page to learn more about the Profiler, how it works, and how\nto use it to analyze a script\u2019s performance and identify optimization\nopportunities.</p>\n<h4 class=\"md-heading\" id=\"pine-editor-improvements\"><a href=\"#pine-editor-improvements\">Pine Editor improvements<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When opening the detached Pine Editor from a tab with a chart, it now\nlinks directly to that tab, as indicated by the \u201cLinked\u201d status and\ngreen icon in the bottom-right corner. While linked, the \u201cAdd to\nchart\u201d, \u201cUpdate on chart\u201d, and \u201cApply to entire layout\u201d buttons\naffect the charts on the main tab.</p>\n<p>The detached Pine Editor now includes the Pine console.</p>\n<h3 class=\"md-heading\" id=\"april-2024\"><a href=\"#april-2024\">April 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added a new parameter to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nfunctions:</p>\n<ul>\n<li><code dir=\"auto\">force_overlay</code> - If true, the output will display on the main chart\npane, even when the script occupies a separate pane.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2024\"><a href=\"#march-2024\">March 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">syminfo.*</code> namespace features a new built-in variable:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.expiration_date\">syminfo.expiration_date</a> -\nOn non-continuous futures symbols, returns a UNIX timestamp\nrepresenting the start of the last day of the current contract.</li>\n</ul>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time\">time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_time_close\">time_close()</a>\nfunctions have a new parameter:</p>\n<ul>\n<li><code dir=\"auto\">bars_back</code> - If specified, the function will calculate the\ntimestamp from the bar N bars back relative to the current bar on\nits timeframe. It can also calculate the expected time of a future\nbar up to 500 bars away if the argument is a negative value.\nOptional. The default is 0.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2024\"><a href=\"#february-2024\">February 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added two new functions for working with strings:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.repeat\">str.repeat()</a> -\nConstructs a new string containing the source string repeated a\nspecified number of times with a separator injected between each\nrepeated instance.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.trim\">str.trim()</a> -\nConstructs a new string with all consecutive whitespaces and other\ncontrol characters removed from the left and right of the source\nstring.</li>\n</ul>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a>\nfunction now accepts \u201cD\u201d as a <code dir=\"auto\">period</code> argument, allowing scripts to\nrequest available daily financial data.</p>\n<p>For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Daily financial data demo\")\n\n//@variable The daily Premium/Discount to Net Asset Value for \"AMEX:SPY\"\nfloat f1 = request.financial(\"AMEX:SPY\", \"NAV\", \"D\")\nplot(f1)</div>\n<p>The <code dir=\"auto\">strategy.*</code> namespace features a new variable for monitoring\navailable capital in a strategy\u2019s simulation:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.opentrades.capital_held\">strategy.opentrades.capital_held</a> -\nReturns the capital amount currently held by open trades.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"january-2024\"><a href=\"#january-2024\">January 2024<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">syminfo.*</code> namespace features new built-in variables:</p>\n<p>Syminfo:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.employees\">syminfo.employees</a> -\nThe number of employees the company has.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.shareholders\">syminfo.shareholders</a> -\nThe number of shareholders the company has.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.shares_outstanding_float\">syminfo.shares_outstanding_float</a> -\nThe total number of shares outstanding a company has available,\nexcluding any of its restricted shares.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.shares_outstanding_total\">syminfo.shares_outstanding_total</a> -\nThe total number of shares outstanding a company has available,\nincluding restricted shares held by insiders, major shareholders,\nand employees.</li>\n</ul>\n<p>Target price:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_average\">syminfo.target_price_average</a> -\nThe average of the last yearly price targets for the symbol\npredicted by analysts.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_date\">syminfo.target_price_date</a> -\nThe starting date of the last price target prediction for the\ncurrent symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_estimates\">syminfo.target_price_estimates</a> -\nThe latest total number of price target predictions for the current\nsymbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_high\">syminfo.target_price_high</a> -\nThe last highest yearly price target for the symbol predicted by\nanalysts.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_low\">syminfo.target_price_low</a> -\nThe last lowest yearly price target for the symbol predicted by\nanalysts.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.target_price_median\">syminfo.target_price_median</a> -\nThe median of the last yearly price targets for the symbol predicted\nby analysts.</li>\n</ul>\n<p>Recommendations:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_buy\">syminfo.recommendations_buy</a> -\nThe number of analysts who gave the current symbol a \u201cBuy\u201d rating.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_buy_strong\">syminfo.recommendations_buy_strong</a> -\nThe number of analysts who gave the current symbol a \u201cStrong Buy\u201d\nrating.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_date\">syminfo.recommendations_date</a> -\nThe starting date of the last set of recommendations for the current\nsymbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_hold\">syminfo.recommendations_hold</a> -\nThe number of analysts who gave the current symbol a \u201cHold\u201d\nrating.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_total\">syminfo.recommendations_total</a> -\nThe total number of recommendations for the current symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_sell\">ssyminfo.recommendations_sell</a> -\nThe number of analysts who gave the current symbol a \u201cSell\u201d\nrating.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo.recommendations_sell_strong\">syminfo.recommendations_sell_strong</a> -\nThe number of analysts who gave the current symbol a \u201cStrong Sell\u201d\nrating.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2023\"><a href=\"#2023\">2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2023\"><a href=\"#december-2023\">December 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added <code dir=\"auto\">format</code> and <code dir=\"auto\">precision</code> parameters to all <code dir=\"auto\">plot*()</code>\nfunctions, allowing indicators and strategies to selectively apply\nformatting and decimal precision settings to plotted results in the\nchart pane\u2019s y-axis, the script\u2019s status line, and the Data Window.\nThe arguments passed to these parameters supersede the values in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nfunctions. Both are optional. The defaults for these parameters are the\nsame as the values specified in the script\u2019s declaration statement.</p>\n<p>For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\", format = format.percent, precision = 4)\n\nplot(close, format = format.price)           // Price format with 4-digit precision.\nplot(100 * bar_index / close, precision = 2) // Percent format with 2-digit precision. </div>\n<h3 class=\"md-heading\" id=\"november-2023\"><a href=\"#november-2023\">November 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>We\u2019ve added the following variables and functions to the <code dir=\"auto\">strategy.*</code>\nnamespace:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossloss_percent\">strategy.grossloss_percent</a> -\nThe total gross loss value of all completed losing trades, expressed\nas a percentage of the initial capital.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.grossprofit_percent\">strategy.grossprofit_percent</a> -\nThe total gross profit value of all completed winning trades,\nexpressed as a percentage of the initial capital.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_runup_percent\">strategy.max_runup_percent</a> -\nThe maximum rise from a trough in the equity curve, expressed as a\npercentage of the trough value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.max_drawdown_percent\">strategy.max_drawdown_percent</a> -\nThe maximum drop from a peak in the equity curve, expressed as a\npercentage of the peak value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.netprofit_percent\">strategy.netprofit_percent</a> -\nThe total value of all completed trades, expressed as a percentage\nof the initial capital.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy.openprofit_percent\">strategy.openprofit_percent</a> -\nThe current unrealized profit or loss for all open positions,\nexpressed as a percentage of realized equity.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_drawdown_percent\">strategy.closedtrades.max_drawdown_percent()</a> -\nReturns the maximum drawdown of the closed trade, i.e., the maximum\npossible loss during the trade, expressed as a percentage.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.max_runup_percent\">strategy.closedtrades.max_runup_percent()</a> -\nReturns the maximum run-up of the closed trade, i.e., the maximum\npossible profit during the trade, expressed as a percentage.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.closedtrades.profit_percent\">strategy.closedtrades.profit_percent()</a> -\nReturns the profit/loss value of the closed trade, expressed as a\npercentage. Losses are expressed as negative values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_drawdown_percent\">strategy.opentrades.max_drawdown_percent()</a> -\nReturns the maximum drawdown of the open trade, i.e., the maximum\npossible loss during the trade, expressed as a percentage.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.max_runup_percent\">strategy.opentrades.max_runup_percent()</a> -\nReturns the maximum run-up of the open trade, i.e., the maximum\npossible profit during the trade, expressed as a percentage.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.opentrades.profit_percent\">strategy.opentrades.profit_percent()</a> -\nReturns the profit/loss of the open trade, expressed as a\npercentage. Losses are expressed as negative values.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"october-2023\"><a href=\"#october-2023\">October 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"pine-script-polylines\"><a href=\"#pine-script-polylines\">Pine Script Polylines<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Polylines are drawings that sequentially connect the coordinates from an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nof up to 10,000\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> using straight or <em>curved</em> line segments, allowing scripts\nto draw custom formations that are difficult or impossible to achieve\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nobjects. To learn more about this new drawing type, see the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">Polylines</a>\nsection of our User Manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">Lines and boxes</a>.</p>\n<h3 class=\"md-heading\" id=\"september-2023\"><a href=\"#september-2023\">September 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.default_entry_qty\">strategy.default_entry_qty()</a> -\nCalculates the default quantity, in units, of an entry order from\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.entry\">strategy.entry()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy.order\">strategy.order()</a>\nif it were to fill at the specified <code dir=\"auto\">fill_price</code> value.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_chart.point.new\">chart.point.new()</a> -\nCreates a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_chart.point\">chart.point</a>\nobject with the specified <code dir=\"auto\">time</code>, <code dir=\"auto\">index</code>, and <code dir=\"auto\">price</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dseed\">request.seed()</a> -\nRequests data from a user-maintained GitHub repository and returns\nit as a series. An in-depth tutorial on how to add new data can be\nfound <a href=\"https://github.com/tradingview-pine-seeds/docs\" rel=\"nofollow\">here</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dinherit\">ticker.inherit()</a> -\nConstructs a ticker ID for the specified <code dir=\"auto\">symbol</code> with additional\nparameters inherited from the ticker ID passed into the function\ncall, allowing the script to request a symbol\u2019s data using the same\nmodifiers that the <code dir=\"auto\">from_tickerid</code> has, including extended session,\ndividend adjustment, currency conversion, non-standard chart types,\nback-adjustment, settlement-as-close, etc.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe.from_seconds\">timeframe.from_seconds()</a> -\nConverts a specified number of <code dir=\"auto\">seconds</code> into a valid timeframe\nstring based on our <a href=\"/pine-script-docs/v5/concepts/timeframes/#timeframe-string-specifications\">timeframe specification\nformat</a>.</li>\n</ul>\n<p>The <code dir=\"auto\">dividends.*</code> namespace now includes variables for retrieving future\ndividend information:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dividends.future_amount\">dividends.future_amount</a> -\nReturns the payment amount of the upcoming dividend in the currency\nof the current instrument, or <code dir=\"auto\">na</code> if this data isn\u2019t available.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dividends.future_ex_date\">dividends.future_ex_date</a> -\nReturns the Ex-dividend date (Ex-date) of the current instrument\u2019s\nnext dividend payment, or <code dir=\"auto\">na</code> if this data isn\u2019t available.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_dividends.future_pay_date\">dividends.future_pay_date</a> -\nReturns the Payment date (Pay date) of the current instrument\u2019s\nnext dividend payment, or <code dir=\"auto\">na</code> if this data isn\u2019t available.</li>\n</ul>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\nfunction has a new parameter:</p>\n<ul>\n<li><code dir=\"auto\">ignore_invalid_timeframe</code> - Determines how the function behaves\nwhen the chart\u2019s timeframe is smaller than the <code dir=\"auto\">timeframe</code> value in\nthe function call. If <code dir=\"auto\">false</code>, the function will raise a runtime\nerror and halt the script\u2019s execution. If <code dir=\"auto\">true</code>, the function will\nreturn <code dir=\"auto\">na</code> without raising an error.</li>\n</ul>\n<p>Users can now explicitly declare variables with the <code dir=\"auto\">const</code>, <code dir=\"auto\">simple</code>,\nand <code dir=\"auto\">series</code> type qualifiers, allowing more precise control over the\ntypes of variables in their scripts. For example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My script\")\n\n//@variable A constant `string` used as the `title` in the `plot()` function.\nconst string plotTitle = \"My plot\"\n//@variable An `int` variable whose value is consistent after the first chart bar.\nsimple int a = 10\n//@variable An `int` variable whose value can change on every bar.\nseries int b = bar_index\n\nplot(b % a, title = plotTitle)</div>\n<h3 class=\"md-heading\" id=\"august-2023\"><a href=\"#august-2023\">August 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Added the following alert\n<a href=\"https://www.tradingview.com/support/solutions/43000531021\">placeholders</a>:</p>\n<ul>\n<li><code dir=\"auto\">{{syminfo.currency}}</code> - Returns the currency code of the current\nsymbol (\u201cEUR\u201d, \u201cUSD\u201d, etc.).</li>\n<li><code dir=\"auto\">{{syminfo.basecurrency}}</code> - Returns the base currency code of the\ncurrent symbol if the symbol refers to a currency pair. Otherwise,\nit returns <code dir=\"auto\">na</code>. For example, it returns \u201cEUR\u201d when the symbol is\n\u201cEURUSD\u201d.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"pine-script-maps\"><a href=\"#pine-script-maps\">Pine Script Maps<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Maps are collections that hold elements in the form of <em>key-value\npairs</em>. They associate unique keys of a <em>fundamental type</em> with values\nof a <em>built-in</em> or\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined</a> type. Unlike <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>,\nthese collections are <em>unordered</em> and do not utilize an internal lookup\nindex. Instead, scripts access the values of maps by referencing the\n<em>keys</em> from the key-value pairs put into them. For more information on\nthese new collections, see our\n<a href=\"/pine-script-docs/v5/language/maps/\">User Manual\u2019s page on Maps</a>.</p>\n<h3 class=\"md-heading\" id=\"july-2023\"><a href=\"#july-2023\">July 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Fixed an issue that caused strategies to occasionally calculate the\nsizes of limit orders incorrectly due to improper tick rounding of the\n<code dir=\"auto\">limit</code> price.</p>\n<p>Added a new built-in variable to the <code dir=\"auto\">strategy.*</code> namespace:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dmargin_liquidation_price\">strategy.margin_liquidation_price</a> -\nWhen a strategy uses margin, returns the price value after which a\nmargin call will occur.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2023\"><a href=\"#june-2023\">June 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New <code dir=\"auto\">syminfo.*</code> built-in variables were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dsector\">syminfo.sector</a> -\nReturns the sector of the symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dindustry\">syminfo.industry</a> -\nReturns the industry of the symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dcountry\">syminfo.country</a> -\nReturns the two-letter code of the country where the symbol is\ntraded.</li>\n</ul>\n<p>A new display parameter for all <code dir=\"auto\">input.*()</code> functions was added.\nIt provides you with more control over the display of input values next to a script\u2019s name.\nFour arguments can be used:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_display%7Bdot%7Dstatus_line\">display.status_line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_display%7Bdot%7Ddata_window\">display.data_window</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_display%7Bdot%7Dall\">display.all</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_display%7Bdot%7Dnone\">display.none</a>.\nCombinations of these arguments using plus or minus signs are allowed, and regardless of the argument used,\ninput values will always continue to appear in the <code dir=\"auto\">Inputs</code> tab of the script\u2019s settings.</p>\n<h3 class=\"md-heading\" id=\"may-2023\"><a href=\"#may-2023\">May 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New parameter added to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dentry\">strategy.entry()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dorder\">strategy.order()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose_all\">strategy.close_all()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nfunctions:</p>\n<ul>\n<li><code dir=\"auto\">disable_alert</code> - Disables order fill alerts for any orders placed\nby the function.</li>\n</ul>\n<p>Our \u201cIndicator on indicator\u201d feature, which allows a script to pass\nanother indicator\u2019s plot as a source value via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dsource\">input.source()</a>\nfunction, now supports multiple external inputs. Scripts can use a\nmultitude of external inputs originating from up to 10 different\nindicators.</p>\n<p>We\u2019ve added the following array functions:</p>\n<ul>\n<li>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Devery\">array.every()</a> -\nReturns <code dir=\"auto\">true</code> if all elements of the <code dir=\"auto\">id</code> array are <code dir=\"auto\">true</code>, <code dir=\"auto\">false</code>\notherwise.</p>\n</li>\n<li>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dsome\">array.some()</a> -\nReturns <code dir=\"auto\">true</code> if at least one element of the <code dir=\"auto\">id</code> array is <code dir=\"auto\">true</code>,\n<code dir=\"auto\">false</code> otherwise. These functions also work with arrays of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_float\">float</a>\ntypes, in which case zero values are considered <code dir=\"auto\">false</code>, and all others\n<code dir=\"auto\">true</code>.</p>\n</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2023\"><a href=\"#april-2023\">April 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Fixed an issue with trailing stops in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nbeing filled on high/low prices rather than on intrabar prices.</p>\n<p>Fixed behavior of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dmode\">array.mode()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmode\">matrix.mode()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmode\">ta.mode()</a>.\nNow these functions will return the smallest value when the data has no\nmost frequent value.</p>\n<h3 class=\"md-heading\" id=\"march-2023\"><a href=\"#march-2023\">March 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It is now possible to use seconds-based timeframe strings for the\n<code dir=\"auto\">timeframe</code> parameter in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity_lower_tf\">request.security_lower_tf()</a>.</p>\n<p>A new function was added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dcurrency_rate\">request.currency_rate()</a> -\nprovides a daily rate to convert a value expressed in the <code dir=\"auto\">from</code>\ncurrency to another in the <code dir=\"auto\">to</code> currency.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2023\"><a href=\"#february-2023\">February 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"pine-script-methods\"><a href=\"#pine-script-methods\">Pine Script Methods<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Pine Script methods are specialized functions associated with specific\ninstances of built-in or user-defined types. They offer a more\nconvenient syntax than standard functions, as users can access methods\nin the same way as object fields using the handy dot notation syntax.\nPine Script includes built-in methods for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_linefill\">linefill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\ntypes and facilitates user-defined methods with the new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_method\">method</a>\nkeyword. For more details on this new feature, see our\n<a href=\"/pine-script-docs/v5/language/methods/\">User Manual\u2019s page on methods</a>.</p>\n<h3 class=\"md-heading\" id=\"january-2023\"><a href=\"#january-2023\">January 2023<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New array functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dfirst\">array.first()</a> -\nReturns the array\u2019s first element.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dlast\">array.last()</a> -\nReturns the array\u2019s last element.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2022\"><a href=\"#2022\">2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2022\"><a href=\"#december-2022\">December 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"pine-objects\"><a href=\"#pine-objects\">Pine Objects<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Pine objects are instantiations of the new user-defined composite types\n(UDTs) declared using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a>\nkeyword. Experienced programmers can think of UDTs as method-less\nclasses. They allow users to create custom types that organize different\nvalues under one logical entity. A detailed rundown of the new\nfunctionality can be found in our <a href=\"/pine-script-docs/v5/language/objects/\">User Manual\u2019s page on\nobjects</a>.</p>\n<p>A new function was added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker%7Bdot%7Dstandard\">ticker.standard()</a> -\nCreates a ticker to request data from a standard chart that is\nunaffected by modifiers like extended session, dividend adjustment,\ncurrency conversion, and the calculations of non-standard chart\ntypes: Heikin Ashi, Renko, etc.</li>\n</ul>\n<p>New <code dir=\"auto\">strategy.*</code> functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_comment\">strategy.opentrades.entry_comment()</a> -\nThe function returns the comment message of the open trade\u2019s entry.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_comment\">strategy.closedtrades.entry_comment()</a> -\nThe function returns the comment message of the closed trade\u2019s\nentry.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_comment\">strategy.closedtrades.exit_comment()</a> -\nThe function returns the comment message of the closed trade\u2019s\nexit.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"november-2022\"><a href=\"#november-2022\">November 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Fixed behaviour of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math%7Bdot%7Dround_to_mintick\">math.round_to_mintick()</a>\nfunction. For \u2018na\u2019 values it returns \u2018na\u2019.</p>\n<h3 class=\"md-heading\" id=\"october-2022\"><a href=\"#october-2022\">October 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script now has a new, more powerful and better-integrated editor.\nRead <a href=\"https://www.tradingview.com/blog/en/new-vsc-style-pine-script-editor-34159/\">our\nblog</a>\nto find out everything to know about all the new features and upgrades.</p>\n<p>New overload for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>\nfunction was added. Now it can create vertical gradients. More info\nabout it in the <a href=\"https://www.tradingview.com/blog/en/pine-script-vertical-gradients-33586/\">blog\npost</a>.</p>\n<p>A new function was added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dformat_time\">str.format_time()</a> -\nConverts a timestamp to a formatted string using the specified\nformat and time zone.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"september-2022\"><a href=\"#september-2022\">September 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The <code dir=\"auto\">text_font_family</code> parameter now allows the selection of a monospace\nfont in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\nfunction calls, which makes it easier to align text vertically. Its\narguments can be:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_font%7Bdot%7Dfamily_default\">font.family_default</a> -\nSpecifies the default font.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_font%7Bdot%7Dfamily_monospace\">font.family_monospace</a> -\nSpecifies a monospace font.</li>\n</ul>\n<p>The accompanying setter functions are:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dset_text_font_family\">label.set_text_font_family()</a> -\nThe function sets the font family of the text inside the label.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_font_family\">box.set_text_font_family()</a> -\nThe function sets the font family of the text inside the box.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_text_font_family\">table.cell_set_text_font_family()</a> -\nThe function sets the font family of the text inside the cell.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"august-2022\"><a href=\"#august-2022\">August 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A new label style\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_label%7Bdot%7Dstyle_text_outline\">label.style_text_outline</a>\nwas added.</p>\n<p>A new parameter for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivot_point_levels\">ta.pivot_point_levels()</a>\nfunction was added:</p>\n<ul>\n<li><code dir=\"auto\">developing</code> - If <code dir=\"auto\">false</code>, the values are those calculated the last\ntime the anchor condition was true. They remain constant until the\nanchor condition becomes true again. If <code dir=\"auto\">true</code>, the pivots are\ndeveloping, i.e., they constantly recalculate on the data developing\nbetween the point of the last anchor (or bar zero if the anchor\ncondition was never true) and the current bar. Cannot be <code dir=\"auto\">true</code> when\n<code dir=\"auto\">type</code> is set to <code dir=\"auto\">\"Woodie\"</code>.</li>\n</ul>\n<p>A new parameter for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new()</a>\nfunction was added:</p>\n<ul>\n<li><code dir=\"auto\">text_wrap</code> - It defines whether the text is presented in a single\nline, extending past the width of the box if necessary, or wrapped\nso every line is no wider than the box itself.</li>\n</ul>\n<p>This parameter supports two arguments:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_text%7Bdot%7Dwrap_none\">text.wrap_none</a> -\nDisabled wrapping mode for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_wrap\">box.set_text_wrap</a>\nfunctions.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_text%7Bdot%7Dwrap_auto\">text.wrap_auto</a> -\nAutomatic wrapping mode for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_wrap\">box.set_text_wrap</a>\nfunctions.</li>\n</ul>\n<p>New built-in functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmin\">ta.min()</a> -\nReturns the all-time low value of <code dir=\"auto\">source</code> from the beginning of the\nchart up to the current bar.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dmax\">ta.max()</a> -\nReturns the all-time high value of <code dir=\"auto\">source</code> from the beginning of\nthe chart up to the current bar.</li>\n</ul>\n<p>A new annotation <code dir=\"auto\">//@strategy_alert_message</code> was added. If the\nannotation is added to the strategy, the text written after it will be\nautomatically set as the default alert message in the [Create\nAlert] window.</p>\n<div class=\"pine-colorizer not-content\">//@version=5\n// @strategy_alert_message My Default Alert Message\nstrategy(\"My Strategy\")\nplot(close)</div>\n<h3 class=\"md-heading\" id=\"july-2022\"><a href=\"#july-2022\">July 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It is now possible to fine-tune where a script\u2019s plot values are\ndisplayed through the introduction of new arguments for the <code dir=\"auto\">display</code>\nparameter of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a>\nfunctions.</p>\n<p>Four new arguments were added, complementing the previously available\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dall\">display.all</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dnone\">display.none</a>:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Ddata_window\">display.data_window</a>\ndisplays the plot values in the Data Window, one of the items\navailable from the chart\u2019s right sidebar.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dpane\">display.pane</a>\ndisplays the plot in the pane where the script resides, as defined\nin with the <code dir=\"auto\">overlay</code> parameter of the script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>\ndeclaration statement.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dprice_scale\">display.price_scale</a>\ncontrols the display of the plot\u2019s label and price in the price\nscale, if the chart\u2019s settings allow them.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display%7Bdot%7Dstatus_line\">display.status_line</a>\ndisplays the plot values in the script\u2019s status line, next to the\nscript\u2019s name on the chart, if the chart\u2019s settings allow them.</li>\n</ul>\n<p>The <code dir=\"auto\">display</code> parameter supports the addition and subtraction of its\narguments:</p>\n<ul>\n<li><code dir=\"auto\">display.all - display.status_line</code> will display the plot\u2019s\ninformation everywhere except in the script\u2019s status line.</li>\n<li><code dir=\"auto\">display.price_scale + display.status_line</code> will display the plot in\nthe price scale and status line only.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2022\"><a href=\"#june-2022\">June 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The behavior of the argument used with the <code dir=\"auto\">qty_percent</code> parameter of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nhas changed. Previously, the percentages used on successive exit orders\nof the same position were calculated from the remaining position at any\ngiven time. Instead, the percentages now always apply to the initial\nposition size. When executing the following strategy, for example:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nstrategy(\"strategy.exit() example\", overlay = true)\nstrategy.entry(\"Long\", strategy.long, qty = 100)\nstrategy.exit(\"Exit Long1\", \"Long\", trail_points = 50, trail_offset = 0, qty_percent = 20)\nstrategy.exit(\"Exit Long2\", \"Long\", trail_points = 100, trail_offset = 0, qty_percent = 20)</div>\n<p>20% of the initial position will be closed on each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\ncall. Before, the first call would exit 20% of the initial position, and\nthe second would exit 20% of the remaining 80% of the position, so only\n16% of the initial position.</p>\n<p>Two new parameters for the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dvwap\">ta.vwap()</a>\nfunction were added:</p>\n<ul>\n<li><code dir=\"auto\">anchor</code> - Specifies the condition that triggers the reset of VWAP\ncalculations. When <code dir=\"auto\">true</code>, calculations reset; when <code dir=\"auto\">false</code>,\ncalculations proceed using the values accumulated since the previous\nreset.</li>\n<li><code dir=\"auto\">stdev_mult</code> - If specified, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dvwap\">ta.vwap()</a>\ncalculates the standard deviation bands based on the main VWAP\nseries and returns a <code dir=\"auto\">[vwap, upper_band, lower_band]</code> tuple.</li>\n</ul>\n<p>New overloaded versions of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose\">strategy.close()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclose_all\">strategy.close_all()</a>\nfunctions with the <code dir=\"auto\">immediately</code> parameter. When <code dir=\"auto\">immediately</code> is set to\n<code dir=\"auto\">true</code>, the closing order will be executed on the tick where it has been\nplaced, ignoring the strategy parameters that restrict the order\nexecution to the open of the next bar.</p>\n<p>New built-in functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe%7Bdot%7Dchange\">timeframe.change()</a> -\nReturns <code dir=\"auto\">true</code> on the first bar of a new <code dir=\"auto\">timeframe</code>, <code dir=\"auto\">false</code>\notherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dpivot_point_levels\">ta.pivot_point_levels()</a> -\nReturns a float array with numerical values representing 11 pivot\npoint levels: <code dir=\"auto\">[P, R1, S1, R2, S2, R3, S3, R4, S4, R5, S5]</code>. Levels\nabsent from the specified <code dir=\"auto\">type</code> return na values.</li>\n</ul>\n<p>New built-in variables were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Disfirstbar\">session.isfirstbar</a> -\nreturns <code dir=\"auto\">true</code> if the current bar is the first bar of the day\u2019s\nsession, <code dir=\"auto\">false</code> otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dislastbar\">session.islastbar</a> -\nreturns <code dir=\"auto\">true</code> if the current bar is the last bar of the day\u2019s\nsession, <code dir=\"auto\">false</code> otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Disfirstbar_regular\">session.isfirstbar_regular</a> -\nreturns <code dir=\"auto\">true</code> on the first regular session bar of the day, <code dir=\"auto\">false</code>\notherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_session%7Bdot%7Dislastbar_regular\">session.islastbar_regular</a> -\nreturns <code dir=\"auto\">true</code> on the last regular session bar of the day, <code dir=\"auto\">false</code>\notherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dleft_visible_bar_time\">chart.left_visible_bar_time</a> -\nreturns the <code dir=\"auto\">time</code> of the leftmost bar currently visible on the\nchart.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dright_visible_bar_time\">chart.right_visible_bar_time</a> -\nreturns the <code dir=\"auto\">time</code> of the rightmost bar currently visible on the\nchart.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"may-2022\"><a href=\"#may-2022\">May 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">Matrix</a>\nsupport has been added to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>\nfunction.</p>\n<p>The historical states of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">arrays</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrices</a>\ncan now be referenced with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>\noperator. In the example below, we reference the historic state of a\nmatrix 10 bars ago:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"matrix.new&lt;float&gt; example\")\nm = matrix.new&lt;float&gt;(1, 1, close)\nfloat x = na\nif bar_index &gt; 10\n    x := matrix.get(m[10], 0, 0)\nplot(x)\nplot(close)</div>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta%7Bdot%7Dchange\">ta.change()</a>\nfunction now can take values of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_int\">int</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_bool\">bool</a>\ntypes as its <code dir=\"auto\">source</code> parameter and return the difference in the\nrespective type.</p>\n<p>New built-in variables were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dbg_color\">chart.bg_color</a> -\nReturns the color of the chart\u2019s background from the\n<code dir=\"auto\">\"Chart settings/Appearance/Background\"</code> field.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dfg_color\">chart.fg_color</a> -\nReturns a color providing optimal contrast with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dbg_color\">chart.bg_color</a>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_standard\">chart.is_standard</a> -\nReturns true if the chart type is bars, candles, hollow candles,\nline, area or baseline, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_currency%7Bdot%7DUSDT\">currency.USDT</a> -\nA constant for the Tether currency code.</li>\n</ul>\n<p>New functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_syminfo%7Bdot%7Dprefix\">syminfo.prefix()</a> -\nreturns the exchange prefix of the <code dir=\"auto\">symbol</code> passed to it, e.g.\n\u201cNASDAQ\u201d for \u201cNASDAQ:AAPL\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_syminfo%7Bdot%7Dticker\">syminfo.ticker()</a> -\nreturns the ticker of the <code dir=\"auto\">symbol</code> passed to it without the exchange\nprefix, e.g. \u201cAAPL\u201d for \u201cNASDAQ:AAPL\u201d.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity_lower_tf\">request.security_lower_tf()</a> -\nrequests data from a lower timeframe than the chart\u2019s.</li>\n</ul>\n<p>Added <code dir=\"auto\">use_bar_magnifier</code> parameter for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nfunction. When <code dir=\"auto\">true</code>, the <a href=\"/pine-script-docs/v5/concepts/strategies/#broker-emulator\">Broker\nEmulator</a>\nuses lower timeframe data during history backtesting to achieve more\nrealistic results.</p>\n<p>Fixed behaviour of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nfunction when stop loss triggered at prices outside the bars price\nrange.</p>\n<p>Added new <code dir=\"auto\">comment</code> and <code dir=\"auto\">alert</code> message parameters for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dexit\">strategy.exit()</a>\nfunction:</p>\n<ul>\n<li><code dir=\"auto\">comment_profit</code> - additional notes on the order if the exit was\ntriggered by crossing <code dir=\"auto\">profit</code> or <code dir=\"auto\">limit</code> specifically.</li>\n<li><code dir=\"auto\">comment_loss</code> - additional notes on the order if the exit was\ntriggered by crossing <code dir=\"auto\">stop</code> or <code dir=\"auto\">loss</code> specifically.</li>\n<li><code dir=\"auto\">comment_trailing</code> - additional notes on the order if the exit was\ntriggered by crossing <code dir=\"auto\">trail_offset</code> specifically.</li>\n<li><code dir=\"auto\">alert_profit</code> - text that will replace the\n<code dir=\"auto\">'{{strategy.order.alert_message}}'</code> placeholder if the exit was\ntriggered by crossing <code dir=\"auto\">profit</code> or <code dir=\"auto\">limit</code> specifically.</li>\n<li><code dir=\"auto\">alert_loss</code> - text that will replace the\n<code dir=\"auto\">'{{strategy.order.alert_message}}'</code> placeholder if the exit was\ntriggered by crossing <code dir=\"auto\">stop</code> or <code dir=\"auto\">loss</code> specifically.</li>\n<li><code dir=\"auto\">alert_trailing</code> - text that will replace the\n<code dir=\"auto\">'{{strategy.order.alert_message}}'</code> placeholder if the exit was\ntriggered by crossing <code dir=\"auto\">trail_offset</code> specifically.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2022\"><a href=\"#april-2022\">April 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Added the <code dir=\"auto\">display</code> parameter to the following functions:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline</a>.</p>\n<p>A new function was added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Deconomic\">request.economic()</a> -\nEconomic data includes information such as the state of a country\u2019s\neconomy or of a particular industry.</li>\n</ul>\n<p>New built-in variables were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Dmax_runup\">strategy.max_runup</a> -\nReturns the maximum equity run-up value for the whole trading\ninterval.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_syminfo%7Bdot%7Dvolumetype\">syminfo.volumetype</a> -\nReturns the volume type of the current symbol.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_heikinashi\">chart.is_heikinashi</a> -\nReturns true if the chart type is Heikin Ashi, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_kagi\">chart.is_kagi</a> -\nReturns true if the chart type is Kagi, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_linebreak\">chart.is_linebreak</a> -\nReturns true if the chart type is Line break, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_pnf\">chart.is_pnf</a> -\nReturns true if the chart type is Point &amp; figure, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_range\">chart.is_range</a> -\nReturns true if the chart type is Range, false otherwise.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart%7Bdot%7Dis_renko\">chart.is_renko</a> -\nReturns true if the chart type is Renko, false otherwise.</li>\n</ul>\n<p>New matrix functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dnew%3Ctype%3E\">matrix.new&lt;type&gt;()</a> -\nCreates a new matrix object. A matrix is a two-dimensional data\nstructure containing rows and columns. All elements in the matrix\nmust be of the type specified in the type template (\u201c&lt;type&gt;\u201d).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Drow\">matrix.row()</a> -\nCreates a one-dimensional array from the elements of a matrix row.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dcol\">matrix.col()</a> -\nCreates a one-dimensional array from the elements of a matrix\ncolumn.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dget\">matrix.get()</a> -\nReturns the element with the specified index of the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dset\">matrix.set()</a> -\nAssigns <code dir=\"auto\">value</code> to the element at the <code dir=\"auto\">column</code> and <code dir=\"auto\">row</code> index of\nthe matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Drows\">matrix.rows()</a> -\nReturns the number of rows in the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dcolumns\">matrix.columns()</a> -\nReturns the number of columns in the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Delements_count\">matrix.elements_count()</a> -\nReturns the total number of matrix elements.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dadd_row\">matrix.add_row()</a> -\nAdds a row to the matrix. The row can consist of <code dir=\"auto\">na</code> values, or an\narray can be used to provide values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dadd_col\">matrix.add_col()</a> -\nAdds a column to the matrix. The column can consist of <code dir=\"auto\">na</code> values,\nor an array can be used to provide values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dremove_row\">matrix.remove_row()</a> -\nRemoves the row of the matrix and returns an array containing the\nremoved row\u2019s values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dremove_col\">matrix.remove_col()</a> -\nRemoves the column of the matrix and returns an array containing the\nremoved column\u2019s values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dswap_rows\">matrix.swap_rows()</a> -\nSwaps the rows in the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dswap_columns\">matrix.swap_columns()</a> -\nSwaps the columns in the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dfill\">matrix.fill()</a> -\nFills a rectangular area of the matrix defined by the indices\n<code dir=\"auto\">from_column</code> to <code dir=\"auto\">to_column</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dcopy\">matrix.copy()</a> -\nCreates a new matrix which is a copy of the original.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dsubmatrix\">matrix.submatrix()</a> -\nExtracts a submatrix within the specified indices.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dreverse\">matrix.reverse()</a> -\nReverses the order of rows and columns in the matrix. The first row\nand first column become the last, and the last become the first.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dreshape\">matrix.reshape()</a> -\nRebuilds the matrix to <code dir=\"auto\">rows</code> x <code dir=\"auto\">cols</code> dimensions.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dconcat\">matrix.concat()</a> -\nAppend one matrix to another.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dsum\">matrix.sum()</a> -\nReturns a new matrix resulting from the sum of two matrices, or of a\nmatrix and a scalar (a numerical value).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Ddiff\">matrix.diff()</a> -\nReturns a new matrix resulting from the subtraction between\nmatrices, or of matrix and a scalar (a numerical value).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmult\">matrix.mult()</a> -\nReturns a new matrix resulting from the product between the\nmatrices, or between a matrix and a scalar (a numerical value), or\nbetween a matrix and a vector (an array of values).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dsort\">matrix.sort()</a> -\nRearranges the rows in the <code dir=\"auto\">id</code> matrix following the sorted order of\nthe values in the <code dir=\"auto\">column</code>.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Davg\">matrix.avg()</a> -\nCalculates the average of all elements in the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmax\">matrix.max()</a> -\nReturns the largest value from the matrix elements.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmin\">matrix.min()</a> -\nReturns the smallest value from the matrix elements.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmedian\">matrix.median()</a> -\nCalculates the median (\u201cthe middle\u201d value) of matrix elements.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dmode\">matrix.mode()</a> -\nCalculates the mode of the matrix, which is the most frequently\noccurring value from the matrix elements. When there are multiple\nvalues occurring equally frequently, the function returns the\nsmallest of those values.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dpow\">matrix.pow()</a> -\nCalculates the product of the matrix by itself <code dir=\"auto\">power</code> times.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Ddet\">matrix.det()</a> -\nReturns the determinant of a square matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dtranspose\">matrix.transpose()</a> -\nCreates a new, transposed version of the matrix by interchanging the\nrow and column index of each element.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dpinv\">matrix.pinv()</a> -\nReturns the pseudoinverse of a matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dinv\">matrix.inv()</a> -\nReturns the inverse of a square matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Drank\">matrix.rank()</a> -\nCalculates the rank of the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Deigenvalues\">matrix.trace()</a> -\nCalculates the trace of a matrix (the sum of the main diagonal\u2019s\nelements).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Deigenvectors\">matrix.eigenvalues()</a> -\nReturns an array containing the eigenvalues of a square matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7D\">matrix.eigenvectors()</a> -\nReturns a matrix of eigenvectors, in which each column is an\neigenvector of the matrix.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dkronis_zero\">matrix.kron()</a> -\nReturns the Kronecker product for the two matrices.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_zero\">matrix.is_zero()</a> -\nDetermines if all elements of the matrix are zero.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_identity\">matrix.is_identity()</a> -\nDetermines if a matrix is an identity matrix (elements with ones on\nthe main diagonal and zeros elsewhere).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_binary\">matrix.is_binary()</a> -\nDetermines if the matrix is binary (when all elements of the matrix\nare 0 or 1).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_symmetric\">matrix.is_symmetric()</a> -\nDetermines if a square matrix is symmetric (elements are symmetric\nwith respect to the main diagonal).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_antisymmetric\">matrix.is_antisymmetric()</a> -\nDetermines if a matrix is antisymmetric (its transpose equals its\nnegative).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_diagonal\">matrix.is_diagonal()</a> -\nDetermines if the matrix is diagonal (all elements outside the main\ndiagonal are zero).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_antidiagonal\">matrix.is_antidiagonal()</a> -\nDetermines if the matrix is anti-diagonal (all elements outside the\nsecondary diagonal are zero).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_triangular\">matrix.is_triangular()</a> -\nDetermines if the matrix is triangular (if all elements above or\nbelow the main diagonal are zero).</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_stochastic\">matrix.is_stochastic()</a> -\nDetermines if the matrix is stochastic.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix%7Bdot%7Dis_square\">matrix.is_square()</a> -\nDetermines if the matrix is square (it has the same number of rows\nand columns).</li>\n</ul>\n<p>Added a new parameter for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\nfunction:</p>\n<ul>\n<li><code dir=\"auto\">risk_free_rate</code> - The risk-free rate of return is the annual\npercentage change in the value of an investment with minimal or zero\nrisk, used to calculate the Sharpe and Sortino ratios.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2022\"><a href=\"#march-2022\">March 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New array functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dsort_indices\">array.sort_indices()</a> -\nreturns an array of indices which, when used to index the original\narray, will access its elements in their sorted order.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpercentrank\">array.percentrank()</a> -\nreturns the percentile rank of a value in the array.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpercentile_nearest_rank\">array.percentile_nearest_rank()</a> -\nreturns the value for which the specified percentage of array values\n(percentile) are less than or equal to it, using the nearest-rank\nmethod.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dpercentile_linear_interpolation\">array.percentile_linear_interpolation()</a> -\nreturns the value for which the specified percentage of array values\n(percentile) are less than or equal to it, using linear\ninterpolation.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dabs\">array.abs()</a> -\nreturns an array containing the absolute value of each element in\nthe original array.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dbinary_search\">array.binary_search()</a> -\nreturns the index of the value, or -1 if the value is not found.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dbinary_search_leftmost\">array.binary_search_leftmost()</a> -\nreturns the index of the value if it is found or the index of the\nnext smallest element to the left of where the value would lie if it\nwas in the array.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dbinary_search_rightmost\">array.binary_search_rightmost()</a> -\nreturns the index of the value if it is found or the index of the\nelement to the right of where the value would lie if it was in the\narray.</li>\n</ul>\n<p>Added a new optional <code dir=\"auto\">nth</code> parameter for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dmin\">array.min()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dmax\">array.max()</a>\nfunctions.</p>\n<p>Added <code dir=\"auto\">index</code> in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_for%7Bdot%7D%7Bdot%7D%7Bdot%7Din\">for..in</a>\noperator. It tracks the current iteration\u2019s index.</p>\n<h4 class=\"md-heading\" id=\"table-merging-and-cell-tooltips\"><a href=\"#table-merging-and-cell-tooltips\">Table merging and cell tooltips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<ul>\n<li>It is now possible to merge several cells in a table. A merged cell\ndoesn\u2019t have to be a header: you can merge cells in any direction,\nas long as the resulting cell doesn\u2019t affect any already merged\ncells and doesn\u2019t go outside of the table\u2019s bounds. Cells can be\nmerged with the new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dmerge_cells\">table.merge_cells()</a>\nfunction.</li>\n<li>Tables now support tooltips, floating labels that appear when you\nhover over a table\u2019s cell. To add a tooltip, pass a string to the\n<code dir=\"auto\">tooltip</code> argument of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell\">table.cell()</a>\nfunction or use the new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dcell_set_tooltip\">table.cell_set_tooltip()</a>\nfunction.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2022\"><a href=\"#february-2022\">February 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Added templates and the ability to create arrays via templates. Instead\nof using one of the <code dir=\"auto\">array.new_*()</code> functions, a template function\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dnew%3Ctype%3E\">array.new&lt;type&gt;()</a>\ncan be used. In the example below, we use this functionality to create\nan array filled with <code dir=\"auto\">float</code> values:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"array.new&lt;float&gt; example\")\nlength = 5\nvar a = array.new&lt;float&gt;(length, close)\nif array.size(a) == length\n    array.remove(a, 0)\n    array.push(a, close)\nplot(array.sum(a) / length, \"SMA\")</div>\n<p>New functions were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_timeframe%7Bdot%7Din_seconds\">timeframe.in_seconds(timeframe)</a> -\nconverts the timeframe passed to the <code dir=\"auto\">timeframe</code> argument into\nseconds.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dtext_area\">input.text_area()</a> -\nadds multiline text input area to the Script settings.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_id\">strategy.closedtrades.entry_id()</a> -\nreturns the id of the closed trade\u2019s entry.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_id\">strategy.closedtrades.exit_id()</a> -\nreturns the id of the closed trade\u2019s exit.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_id\">strategy.opentrades.entry_id()</a> -\nreturns the id of the open trade\u2019s entry.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"january-2022\"><a href=\"#january-2022\">January 2022<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Added new functions to clone drawings:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line%7Bdot%7Dcopy\">line.copy()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dcopy\">label.copy()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dcopy\">box.copy()</a></li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2021\"><a href=\"#2021\">2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2021\"><a href=\"#december-2021\">December 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"linefills\"><a href=\"#linefills\">Linefills<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The space between lines drawn in Pine Script can now be filled! We\u2019ve\nadded a new <code dir=\"auto\">linefill</code> drawing type, along with a number of functions\ndedicated to manipulating it. Linefills are created by passing two lines\nand a color to the <code dir=\"auto\">linefill.new()</code> function, and their behavior is\nbased on the lines they\u2019re tied to: they extend in the same direction\nas the lines, move when their lines move, and are deleted when one of\nthe two lines is deleted.</p>\n<p>New linefill-related functions:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array%7Bdot%7Dnew_linefill\">array.new_linefill()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill\">linefill()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill%7Bdot%7Ddelete\">linefill.delete()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill%7Bdot%7Dget_line1\">linefill.get_line1()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill%7Bdot%7Dget_line2\">linefill.get_line2()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill%7Bdot%7Dnew\">linefill.new()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_linefill%7Bdot%7Dset_color\">linefill.set_color()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_linefill%7Bdot%7Dall\">linefill.all()</a></li>\n</ul>\n<h4 class=\"md-heading\" id=\"new-functions-for-string-manipulation\"><a href=\"#new-functions-for-string-manipulation\">New functions for string manipulation<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Added a number of new functions that provide more ways to process\nstrings, and introduce regular expressions to Pine Script:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dcontains\">str.contains(source,\nstr)</a> -\nDetermines if the <code dir=\"auto\">source</code> string contains the <code dir=\"auto\">str</code> substring.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dpos\">str.pos(source,\nstr)</a> -\nReturns the position of the <code dir=\"auto\">str</code> string in the <code dir=\"auto\">source</code> string.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dsubstring\">str.substring(source, begin_pos,\nend_pos)</a> -\nExtracts a substring from the <code dir=\"auto\">source</code> string.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dreplace\">str.replace(source, target, replacement,\noccurrence)</a> -\nContrary to the existing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dreplace_all\">str.replace_all()</a>\nfunction, <code dir=\"auto\">str.replace()</code> allows the selective replacement of a\nmatched substring with a replacement string.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dlower\">str.lower(source)</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dupper\">str.upper(source)</a> -\nConvert all letters of the <code dir=\"auto\">source</code> string to lower or upper case:</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dstartswith\">str.startswith(source,\nstr)</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dendswith\">str.endswith(source,\nstr)</a> -\nDetermine if the <code dir=\"auto\">source</code> string starts or ends with the <code dir=\"auto\">str</code>\nsubstring.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str%7Bdot%7Dmatch\">str.match(source,\nregex)</a> -\nExtracts the substring matching the specified <a href=\"https://en.wikipedia.org/wiki/Regular_expression#Perl_and_PCRE\" rel=\"nofollow\">regular\nexpression</a>.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"textboxes\"><a href=\"#textboxes\">Textboxes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Box drawings now supports text. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new()</a>\nfunction has five new parameters for text manipulation: <code dir=\"auto\">text</code>,\n<code dir=\"auto\">text_size</code>, <code dir=\"auto\">text_color</code>, <code dir=\"auto\">text_valign</code>, and <code dir=\"auto\">text_halign</code>.\nAdditionally, five new functions to set the text properties of existing\nboxes were added:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text\">box.set_text()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_color\">box.set_text_color()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_size\">box.set_text_size()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_valign\">box.set_text_valign()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dset_text_halign\">box.set_text_halign()</a></li>\n</ul>\n<h4 class=\"md-heading\" id=\"new-built-in-variables\"><a href=\"#new-built-in-variables\">New built-in variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Added new built-in variables that return the <code dir=\"auto\">bar_index</code> and <code dir=\"auto\">time</code>\nvalues of the last bar in the dataset. Their values are known at the\nbeginning of the script\u2019s calculation:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_index\">last_bar_index</a> -\nBar index of the last chart bar.</li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a> -\nUNIX time of the last chart bar.</li>\n</ul>\n<p>New built-in <code dir=\"auto\">source</code> variable:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_hlcc4\">hlcc4</a> -\nA shortcut for <code dir=\"auto\">(high + low + close + close)/4</code>. It averages the\nhigh and low values with the double-weighted close.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"november-2021\"><a href=\"#november-2021\">November 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"forin\"><a href=\"#forin\">for\u2026in<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Added a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_for%7Bdot%7D%7Bdot%7D%7Bdot%7Din\">for\u2026in</a>\noperator to iterate over all elements of an array:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nint[] a1 = array.from(1, 3, 6, 3, 8, 0, -9, 5)\n\nhighest(array) =&gt;\n    var int highestNum = na\n    for item in array\n            if na(highestNum) or item &gt; highestNum\n        highestNum := item\n    highestNum\n\nplot(highest(a1))</div>\n<h4 class=\"md-heading\" id=\"function-overloads\"><a href=\"#function-overloads\">Function overloads<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Added function overloads. Several functions in a script can now share\nthe same name, as long one of the following conditions is true:</p>\n<ul>\n<li>Each overload has a different number of parameters:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Function overload\")\n\n// Two parameters\nmult(x1, x2) =&gt;\n    x1 * x2\n\n// Three parameters\nmult(x1, x2, x3) =&gt;\n    x1 * x2 * x3\n\nplot(mult(7, 4))\nplot(mult(7, 4, 2))</div>\n<ul>\n<li>When overloads have the same number of parameters, all parameters in\neach overload must be explicitly typified, and their type\ncombinations must be unique:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Function overload\")\n\n// Accepts both 'int' and 'float' values - any 'int' can be automatically cast to 'float'\nmult(float x1, float x2) =&gt;\n    x1 * x2\n\n// Returns a 'bool' value instead of a number\nmult(bool x1, bool x2) =&gt;\n    x1 and x2 ? true : false\n\nmult(string x1, string x2) =&gt;\n    str.tonumber(x1) * str.tonumber(x2)\n\n// Has three parameters, so explicit types are not required\nmult(x1, x2, x3) =&gt;\n    x1 * x2 * x3\n\nplot(mult(7, 4))\nplot(mult(7.5, 4.2))\nplot(mult(true, false) ? 1 : 0)\nplot(mult(\"5\", \"6\"))\nplot(mult(7, 4, 2))</div>\n<h4 class=\"md-heading\" id=\"currency-conversion\"><a href=\"#currency-conversion\">Currency conversion<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Added a new [currency] argument to most <code dir=\"auto\">request.*()</code>\nfunctions. If specified, price values returned by the function will be\nconverted from the source currency to the target currency. The following\nfunctions are affected:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Ddividends\">request.dividends()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dearnings\">request.earnings()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dfinancial\">request.financial()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a></li>\n</ul>\n<h3 class=\"md-heading\" id=\"october-2021\"><a href=\"#october-2021\">October 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script v5 is here! This is a list of the <strong>new</strong> features added to\nthe language, and a few of the <strong>changes</strong> made. See the Pine Script v5\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5\">Migration guide</a> for\na complete list of the <strong>changes</strong> in v5.</p>\n<h4 class=\"md-heading\" id=\"new-features\"><a href=\"#new-features\">New features<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Libraries are a new type of publication. They allow you to create custom\nfunctions for reuse in other scripts. See this manual\u2019s page on\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">Libraries</a>.</p>\n<p>Pine Script now supports\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructures! They provide a more convenient and readable alternative to\nlong ternary operators and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstatements.</p>\n<p><a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nloops are here! They allow you to create a loop that will only stop when\nits controlling condition is false, or a <code dir=\"auto\">break</code> command is used in the\nloop.</p>\n<p>New built-in array variables are maintained by the Pine Script runtime\nto hold the IDs of all the active objects of the same type drawn by your\nscript. They are\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_label%7Bdot%7Dall\">label.all</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_line%7Bdot%7Dall\">line.all</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_box%7Bdot%7Dall\">box.all</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_table%7Bdot%7Dall\">table.all</a>.</p>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_runtime%7Bdot%7Derror\">runtime.error()</a>\nfunction makes it possible to halt the execution of a script and display\na runtime error with a custom message. You can use any condition in your\nscript to trigger the call.</p>\n<p>Parameter definitions in user-defined functions can now include a\ndefault value: a function defined as <code dir=\"auto\">f(x = 1) =&gt; x</code> will return 1 when\ncalled as <code dir=\"auto\">f()</code>, i.e., without providing an argument for its <code dir=\"auto\">x</code>\nparameter.</p>\n<p>New variables and functions provide better script visibility on strategy\ninformation:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_price\">strategy.closedtrades.entry_price()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_price\">strategy.opentrades.entry_price()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_bar_index\">strategy.closedtrades.entry_bar_index()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_bar_index\">strategy.opentrades.entry_bar_index()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dentry_time\">strategy.closedtrades.entry_time()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dentry_time\">strategy.opentrades.entry_time()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dsize\">strategy.closedtrades.size()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dsize\">strategy.opentrades.size()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dprofit\">strategy.closedtrades.profit()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dprofit\">strategy.opentrades.profit()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dcommission\">strategy.closedtrades.commission()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dcommission\">strategy.opentrades.commission()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dmax_runup\">strategy.closedtrades.max_runup()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dmax_runup\">strategy.opentrades.max_runup()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dmax_drawdown\">strategy.closedtrades.max_drawdown()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dopentrades%7Bdot%7Dmax_drawdown\">strategy.opentrades.max_drawdown()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_price\">strategy.closedtrades.exit_price()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_bar_index\">strategy.closedtrades.exit_bar_index()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dclosedtrades%7Bdot%7Dexit_time\">strategy.closedtrades.exit_time()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dconvert_to_account\">strategy.convert_to_account()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy%7Bdot%7Dconvert_to_symbol\">strategy.convert_to_symbol()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_strategy%7Bdot%7Daccount_currency\">strategy.account_currency</a></li>\n</ul>\n<p>A new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_earnings%7Bdot%7Dstandardized\">earnings.standardized</a>\nconstant for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dearnings\">request.earnings()</a>\nfunction allows requesting standardized earnings data.</p>\n<p>A v4 to v5 converter is now included in the Pine Script Editor. See the\nPine Script v5 <a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5\">Migration guide</a> for more information on converting your scripts to v5.</p>\n<p>The <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">Reference\nManual</a> now\nincludes the systematic mention of the form and type (e.g., \u201csimple\nint\u201d) required for each function parameter.</p>\n<p>The User Manual was\nreorganized and new content was added.</p>\n<h4 class=\"md-heading\" id=\"changes\"><a href=\"#changes\">Changes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Many built-in variables, functions and function arguments were renamed\nor moved to new namespaces in v5. The venerable <code dir=\"auto\">study()</code>, for example,\nis now\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\nand <code dir=\"auto\">security()</code> is now\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request%7Bdot%7Dsecurity\">request.security()</a>.\nNew namespaces now group related functions and variables together. This\nconsolidation implements a more rational nomenclature and provides an\norderly space to accommodate the many additions planned for Pine\nScript.</p>\n<p>See the Pine Script v5\n<a href=\"/pine-script-docs/v5/migration-guides/to-pine-version-5\">Migration guide</a> for\na complete list of the <strong>changes</strong> made in v5.</p>\n<h3 class=\"md-heading\" id=\"september-2021\"><a href=\"#september-2021\">September 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New parameter has been added for the <code dir=\"auto\">dividends()</code>, <code dir=\"auto\">earnings()</code>,\n<code dir=\"auto\">financial()</code>, <code dir=\"auto\">quandl()</code>, <code dir=\"auto\">security()</code>, and <code dir=\"auto\">splits()</code> functions:</p>\n<ul>\n<li><code dir=\"auto\">ignore_invalid_symbol</code> - determines the behavior of the function if\nthe specified symbol is not found: if <code dir=\"auto\">false</code>, the script will halt\nand return a runtime error; if <code dir=\"auto\">true</code>, the function will return <code dir=\"auto\">na</code>\nand execution will continue.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"july-2021\"><a href=\"#july-2021\">July 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><code dir=\"auto\">tostring</code> now accepts \u201cbool\u201d and \u201cstring\u201d types.</p>\n<p>New argument for <code dir=\"auto\">time</code> and <code dir=\"auto\">time_close</code> functions was added:</p>\n<ul>\n<li><code dir=\"auto\">timezone</code> - timezone of the <code dir=\"auto\">session</code> argument, can only be used\nwhen a session is specified. Can be written out in GMT notation\n(e.g. \u201cGMT-5\u201d) or as an <a href=\"https://en.wikipedia.org/wiki/List_of_tz_database_time_zones\" rel=\"nofollow\">IANA time zone database\nname</a>\n(e.g. \u201cAmerica/New_York\u201d).</li>\n</ul>\n<p>It is now possible to place a drawing object in the future with\n<code dir=\"auto\">xloc = xloc.bar_index</code>.</p>\n<p>New argument for <code dir=\"auto\">study</code> and <code dir=\"auto\">strategy</code> functions was added:</p>\n<ul>\n<li><code dir=\"auto\">explicit_plot_zorder</code> - specifies the order in which the\nindicator\u2019s plots, fills, and hlines are rendered. If true, the\nplots will be drawn based on the order in which they appear in the\nindicator\u2019s code, each newer plot being drawn above the previous\nones.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2021\"><a href=\"#june-2021\">June 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New variable was added:</p>\n<ul>\n<li><code dir=\"auto\">barstate.islastconfirmedhistory</code> - returns <code dir=\"auto\">true</code> if script is\nexecuting on the dataset\u2019s last bar when market is closed, or\nscript is executing on the bar immediately preceding the real-time\nbar, if market is open. Returns <code dir=\"auto\">false</code> otherwise.</li>\n</ul>\n<p>New function was added:</p>\n<ul>\n<li><code dir=\"auto\">round_to_mintick(x)</code> - returns the value rounded to the symbol\u2019s\nmintick, i.e. the nearest value that can be divided by\n<code dir=\"auto\">syminfo.mintick</code>, without the remainder, with ties rounding up.</li>\n</ul>\n<p>Expanded <code dir=\"auto\">tostring()</code> functionality. The function now accepts three new\nformatting arguments:</p>\n<ul>\n<li><code dir=\"auto\">format.mintick</code> to format to tick precision.</li>\n<li><code dir=\"auto\">format.volume</code> to abbreviate large values.</li>\n<li><code dir=\"auto\">format.percent</code> to format percentages.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"may-2021\"><a href=\"#may-2021\">May 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Improved backtesting functionality by adding the Leverage mechanism.</p>\n<p>Added support for table drawings and functions for working with them.\nTables are unique objects that are not anchored to specific bars; they\nfloat in a script\u2019s space, independently of the chart bars being viewed\nor the zoom factor used. For more information, see the\n<a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a> User Manual page.</p>\n<p>New functions were added:</p>\n<ul>\n<li><code dir=\"auto\">color.rgb(red, green, blue, transp)</code> - creates a new color with\ntransparency using the RGB color model.</li>\n<li><code dir=\"auto\">color.from_gradient(value, bottom_value, top_value, bottom_color, top_color)</code> -\nreturns color calculated from the linear gradient between\nbottom_color to top_color.</li>\n<li><code dir=\"auto\">color.r(color)</code>, <code dir=\"auto\">color.g(color)</code>, <code dir=\"auto\">color.b(color)</code>,\n<code dir=\"auto\">color.t(color)</code> - retrieves the value of one of the color\ncomponents.</li>\n<li><code dir=\"auto\">array.from()</code> - takes a variable number of arguments with one of\nthe types: <code dir=\"auto\">int</code>, <code dir=\"auto\">float</code>, <code dir=\"auto\">bool</code>, <code dir=\"auto\">string</code>, <code dir=\"auto\">label</code>, <code dir=\"auto\">line</code>,\n<code dir=\"auto\">color</code>, <code dir=\"auto\">box</code>, <code dir=\"auto\">table</code> and returns an array of the corresponding\ntype.</li>\n</ul>\n<p>A new <code dir=\"auto\">box</code> drawing has been added to Pine Script, making it possible\nto draw rectangles on charts using the Pine Script syntax. For more\ndetails see the Pine Script\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">reference</a>\nand the <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">Lines and boxes</a> User Manual page.</p>\n<p>The <code dir=\"auto\">color.new</code> function can now accept series and input arguments, in\nwhich case, the colors will be calculated at runtime. For more\ninformation about this, see our <a href=\"/pine-script-docs/v5/concepts/colors/\">Colors</a> User Manual page.</p>\n<h3 class=\"md-heading\" id=\"april-2021\"><a href=\"#april-2021\">April 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New math constants were added:</p>\n<ul>\n<li><code dir=\"auto\">math.pi</code> - is a named constant for Archimedes\u2019 constant. It is\nequal to 3.1415926535897932.</li>\n<li><code dir=\"auto\">math.phi</code> - is a named constant for the golden ratio. It is equal\nto 1.6180339887498948.</li>\n<li><code dir=\"auto\">math.rphi</code> - is a named constant for the golden ratio conjugate. It\nis equal to 0.6180339887498948.</li>\n<li><code dir=\"auto\">math.e</code> - is a named constant for Euler\u2019s number. It is equal to\n2.7182818284590452.</li>\n</ul>\n<p>New math functions were added:</p>\n<ul>\n<li><code dir=\"auto\">round(x, precision)</code> - returns the value of <code dir=\"auto\">x</code> rounded to the\nnearest integer, with ties rounding up. If the precision parameter\nis used, returns a float value rounded to that number of decimal\nplaces.</li>\n<li><code dir=\"auto\">median(source, length)</code> - returns the median of the series.</li>\n<li><code dir=\"auto\">mode(source, length)</code> - returns the mode of the series. If there\nare several values with the same frequency, it returns the smallest\nvalue.</li>\n<li><code dir=\"auto\">range(source, length)</code> - returns the difference between the <code dir=\"auto\">min</code>\nand <code dir=\"auto\">max</code> values in a series.</li>\n<li><code dir=\"auto\">todegrees(radians)</code> - returns an approximately equivalent angle in\ndegrees from an angle measured in radians.</li>\n<li><code dir=\"auto\">toradians(degrees)</code> - returns an approximately equivalent angle in\nradians from an angle measured in degrees.</li>\n<li><code dir=\"auto\">random(min, max, seed)</code> - returns a pseudo-random value. The\nfunction will generate a different sequence of values for each\nscript execution. Using the same value for the optional seed\nargument will produce a repeatable sequence.</li>\n</ul>\n<p>New functions were added:</p>\n<ul>\n<li><code dir=\"auto\">session.ismarket</code> - returns <code dir=\"auto\">true</code> if the current bar is a part of\nthe regular trading hours (i.e. market hours), <code dir=\"auto\">false</code> otherwise.</li>\n<li><code dir=\"auto\">session.ispremarket</code> - returns <code dir=\"auto\">true</code> if the current bar is a part\nof the pre-market, <code dir=\"auto\">false</code> otherwise.</li>\n<li><code dir=\"auto\">session.ispostmarket</code> - returns <code dir=\"auto\">true</code> if the current bar is a part\nof the post-market, <code dir=\"auto\">false</code> otherwise.</li>\n<li><code dir=\"auto\">str.format</code> - converts the values to strings based on the specified\nformats. Accepts certain <code dir=\"auto\">number</code> modifiers: <code dir=\"auto\">integer</code>, <code dir=\"auto\">currency</code>,\n<code dir=\"auto\">percent</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2021\"><a href=\"#march-2021\">March 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New assignment operators were added:</p>\n<ul>\n<li><code dir=\"auto\">+=</code> - addition assignment</li>\n<li><code dir=\"auto\">-=</code> - subtraction assignment</li>\n<li><code dir=\"auto\">*=</code> - multiplication assignment</li>\n<li><code dir=\"auto\">/=</code> - division assignment</li>\n<li><code dir=\"auto\">%=</code> - modulus assignment</li>\n</ul>\n<p>New parameters for inputs customization were added:</p>\n<ul>\n<li><code dir=\"auto\">inline</code> - combines all the input calls with the same inline value\nin one line.</li>\n<li><code dir=\"auto\">group</code> - creates a header above all inputs that use the same group\nstring value. The string is also used as the header text.</li>\n<li><code dir=\"auto\">tooltip</code> - adds a tooltip icon to the <code dir=\"auto\">Inputs</code> menu. The tooltip\nstring is shown when hovering over the tooltip icon.</li>\n</ul>\n<p>New argument for <code dir=\"auto\">fill</code> function was added:</p>\n<ul>\n<li><code dir=\"auto\">fillgaps</code> - controls whether fills continue on gaps when one of the\n<code dir=\"auto\">plot</code> calls returns an <code dir=\"auto\">na</code> value.</li>\n</ul>\n<p>A new keyword was added:</p>\n<ul>\n<li><code dir=\"auto\">varip</code> - is similar to the <code dir=\"auto\">var</code> keyword, but variables declared\nwith <code dir=\"auto\">varip</code> retain their values between the updates of a real-time\nbar.</li>\n</ul>\n<p>New functions were added:</p>\n<ul>\n<li><code dir=\"auto\">tonumber()</code> - converts a string value into a float.</li>\n<li><code dir=\"auto\">time_close()</code> - returns the UNIX timestamp of the close of the\ncurrent bar, based on the resolution and session that is passed to\nthe function.</li>\n<li><code dir=\"auto\">dividends()</code> - requests dividends data for the specified symbol.</li>\n<li><code dir=\"auto\">earnings()</code> - requests earnings data for the specified symbol.</li>\n<li><code dir=\"auto\">splits()</code> - requests splits data for the specified symbol.</li>\n</ul>\n<p>New arguments for the study() function were added:</p>\n<ul>\n<li><code dir=\"auto\">resolution_gaps</code> - fills the gaps between values fetched from\nhigher timeframes when using <code dir=\"auto\">resolution</code>.</li>\n<li><code dir=\"auto\">format.percent</code> - formats the script output values as a percentage.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2021\"><a href=\"#february-2021\">February 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New variable was added:</p>\n<ul>\n<li><code dir=\"auto\">time_tradingday</code> - the beginning time of the trading day the\ncurrent bar belongs to.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"january-2021\"><a href=\"#january-2021\">January 2021<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The following functions now accept a series length parameter:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_bb\">bb()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_bbw\">bbw()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_cci\">cci()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_cmo\">cmo()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_cog\">cog()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_correlation\">correlation()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_dev\">dev()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_falling\">falling()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_mfi\">mfi()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_percentile_linear_interpolation\">percentile_linear_interpolation()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_percentile_nearest_rank\">percentile_nearest_rank()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_percentrank\">percentrank()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_rising\">rising()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_roc\">roc()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_stdev\">stdev()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_stoch\">stoch()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_variance\">variance()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_wpr\">wpr()</a></li>\n</ul>\n<p>A new type of alerts was added - script alerts. More information can be\nfound in our <a href=\"https://www.tradingview.com/support/solutions/43000597494/\">Help\nCenter</a>.</p>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2020\"><a href=\"#2020\">2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2020\"><a href=\"#december-2020\">December 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New array types were added:</p>\n<ul>\n<li><code dir=\"auto\">array.new_line()</code></li>\n<li><code dir=\"auto\">array.new_label()</code></li>\n<li><code dir=\"auto\">array.new_string()</code></li>\n</ul>\n<p>New functions were added:</p>\n<ul>\n<li><code dir=\"auto\">str.length()</code> - returns number of chars in source string.</li>\n<li><code dir=\"auto\">array.join()</code> - concatenates all of the elements in the array into\na string and separates these elements with the specified separator.</li>\n<li><code dir=\"auto\">str.split()</code> - splits a string at a given substring separator.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"november-2020\"><a href=\"#november-2020\">November 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>New <code dir=\"auto\">max_labels_count</code> and <code dir=\"auto\">max_lines_count</code> parameters were added\nto the study and strategy functions. Now you can manage the number\nof lines and labels by setting values for these parameters from 1 to\n500.</li>\n</ul>\n<p>New function was added:</p>\n<ul>\n<li><code dir=\"auto\">array.range()</code> - return the difference between the min and max\nvalues in the array.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"october-2020\"><a href=\"#october-2020\">October 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The behavior of <code dir=\"auto\">rising()</code> and <code dir=\"auto\">falling()</code> functions have changed. For\nexample, <code dir=\"auto\">rising(close,3)</code> is now calculated as following:</p>\n<div class=\"pine-colorizer not-content\">close[0] &gt; close[1] and close[1] &gt; close[2] and close[2] &gt; close[3]</div>\n<h3 class=\"md-heading\" id=\"september-2020\"><a href=\"#september-2020\">September 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Added support for <code dir=\"auto\">input.color</code> to the <code dir=\"auto\">input()</code> function. Now you can\nprovide script users with color selection through the script\u2019s\n\u201cSettings/Inputs\u201d tab with the same color widget used throughout the\nTradingView user interface. Learn more about this feature in our\n<a href=\"https://www.tradingview.com/blog/en/create-color-inputs-in-pine-20751/\">blog</a></p>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\", overlay = true)\ncolor c_labelColor = input(color.green, \"Main Color\", input.color)\nvar l = label.new(bar_index, close, yloc = yloc.abovebar, text = \"Colored label\")\nlabel.set_x(l, bar_index)\nlabel.set_color(l, c_labelColor)</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"423\" loading=\"lazy\" src=\"/pine-script-docs/_astro/input_color.BV9qKm_h_2a3e7N.webp\" width=\"600\"/></p>\n<p>Added support for arrays and functions for working with them. You can\nnow use the powerful new array feature to build custom datasets. See our\n<a href=\"/pine-script-docs/v5/language/arrays/\">User Manual page on\narrays</a>\nand our\n<a href=\"https://www.tradingview.com/blog/en/arrays-are-now-available-in-pine-script-20052/\">blog</a></p>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\")\na = array.new_float(0)\nfor i = 0 to 5\n    array.push(a, close[i] - open[i])\nplot(array.get(a, 4))</div>\n<p>The following functions now accept a series length parameter. Learn more\nabout this feature in our\n<a href=\"https://www.tradingview.com/blog/en/pine-functions-support-dynamic-length-arguments-20554/\">blog</a>:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_alma\">alma()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_change\">change()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_highest\">highest()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_highestbars\">highestbars()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_linreg\">linreg()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_lowest\">lowest()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_lowestbars\">lowestbars()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_mom\">mom()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_sma\">sma()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_sum\">sum()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_vwma\">vwma()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_wma\">wma()</a></li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\", overlay = true)\nlength = input(10, \"Length\", input.integer, minval = 1, maxval = 100)\navgBar = avg(highestbars(length), lowestbars(length))\nfloat dynLen = nz(abs(avgBar) + 1, length)\ndynSma = sma(close, int(dynLen))\nplot(dynSma)</div>\n<h3 class=\"md-heading\" id=\"august-2020\"><a href=\"#august-2020\">August 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Optimized script compilation time. Scripts now compile 1.5 to 2\ntimes faster.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"july-2020\"><a href=\"#july-2020\">July 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Minor bug fixes and improvements.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2020\"><a href=\"#june-2020\">June 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>New <code dir=\"auto\">resolution</code> parameter was added to the <code dir=\"auto\">study</code> function. Now\nyou can add MTF functionality to scripts and decide the timeframe\nyou want the indicator to run on.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"399\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Mtf.CuSZJR6J_1zhU1M.webp\" width=\"365\"/></p>\n<p>Please note that you need to reapply the indicator in order for the\n[resolution] parameter to appear.</p>\n<ul>\n<li>The <code dir=\"auto\">tooltip</code> argument was added to the <code dir=\"auto\">label.new</code> function along\nwith the <code dir=\"auto\">label.set_tooltip</code> function:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\", overlay=true)\nvar l=label.new(bar_index, close, yloc=yloc.abovebar, text=\"Label\")\nlabel.set_x(l,bar_index)\nlabel.set_tooltip(l, \"Label Tooltip\")</div>\n<p><img alt=\"image\" decoding=\"async\" height=\"312\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Tooltip.6OxddeKb_xxgi6.webp\" width=\"551\"/></p>\n<ul>\n<li>Added an ability to create <a href=\"https://www.tradingview.com/support/solutions/43000481368\">alerts on\nstrategies</a>.</li>\n<li>A new function\n<a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_line%7Bdot%7Dget_price\">line.get_price()</a>\ncan be used to determine the price level at which the line is\nlocated on a certain bar.</li>\n<li>New <a href=\"https://www.tradingview.com/pine-script-reference/v4/#fun_label%7Bdot%7Dnew\">label\nstyles</a>\nallow you to position the label pointer in any direction.</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"316\" loading=\"lazy\" src=\"/pine-script-docs/_astro/new_label_styles.CnpdeFiL_1DmAE3.webp\" width=\"584\"/></p>\n<ul>\n<li>Find and Replace was added to Pine Editor. To use this, press CTRL+F\n(find) or CTRL+H (find and replace).</li>\n</ul>\n<p><img alt=\"image\" decoding=\"async\" height=\"185\" loading=\"lazy\" src=\"/pine-script-docs/_astro/FindReplace.COurJNjE_sFMux.webp\" width=\"444\"/></p>\n<ul>\n<li><code dir=\"auto\">timezone</code> argument was added for time functions. Now you can\nspecify timezone for <code dir=\"auto\">second</code>, <code dir=\"auto\">minute</code>, <code dir=\"auto\">hour</code>, <code dir=\"auto\">year</code>, <code dir=\"auto\">month</code>,\n<code dir=\"auto\">dayofmonth</code>, <code dir=\"auto\">dayofweek</code> functions:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\")\nplot(hour(1591012800000, \"GMT+1\"))</div>\n<ul>\n<li><code dir=\"auto\">syminfo.basecurrency</code> variable was added. Returns the base currency\ncode of the current symbol. For EURUSD symbol returns EUR.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"may-2020\"><a href=\"#may-2020\">May 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li><code dir=\"auto\">else if</code> statement was added</li>\n<li>The behavior of <code dir=\"auto\">security()</code> function has changed: the <code dir=\"auto\">expression</code>\nparameter can be series or tuple.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2020\"><a href=\"#april-2020\">April 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New function was added:</p>\n<ul>\n<li><code dir=\"auto\">quandl()</code> - request quandl data for a symbol</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2020\"><a href=\"#march-2020\">March 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New function was added:</p>\n<ul>\n<li><code dir=\"auto\">financial()</code> - request financial data for a symbol</li>\n</ul>\n<p>New functions for common indicators were added:</p>\n<ul>\n<li><code dir=\"auto\">cmo()</code> - Chande Momentum Oscillator</li>\n<li><code dir=\"auto\">mfi()</code> - Money Flow Index</li>\n<li><code dir=\"auto\">bb()</code> - Bollinger Bands</li>\n<li><code dir=\"auto\">bbw()</code> - Bollinger Bands Width</li>\n<li><code dir=\"auto\">kc()</code> - Keltner Channels</li>\n<li><code dir=\"auto\">kcw()</code> - Keltner Channels Width</li>\n<li><code dir=\"auto\">dmi()</code> - DMI/ADX</li>\n<li><code dir=\"auto\">wpr()</code> - Williams % R</li>\n<li><code dir=\"auto\">hma()</code> - Hull Moving Average</li>\n<li><code dir=\"auto\">supertrend()</code> - SuperTrend</li>\n</ul>\n<p>Added a detailed description of all the fields in the <a href=\"https://www.tradingview.com/support/folders/43000587044-i-d-like-to-know-more-about-values-in-the-strategy-tester-report/\">Strategy Tester\nReport</a>.</p>\n<h3 class=\"md-heading\" id=\"february-2020\"><a href=\"#february-2020\">February 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>New Pine Script indicator VWAP Anchored was added. Now you can\nspecify the time period: Session, Month, Week, Year.</li>\n<li>Fixed a problem with calculating <code dir=\"auto\">percentrank</code> function. Now it can\nreturn a zero value, which did not happen before due to an incorrect\ncalculation.</li>\n<li>The default <code dir=\"auto\">transparency</code> parameter for the <code dir=\"auto\">plot()</code>,\n<code dir=\"auto\">plotshape()</code>, and <code dir=\"auto\">plotchar()</code> functions is now 0%.</li>\n<li>For the functions <code dir=\"auto\">plot()</code>, <code dir=\"auto\">plotshape()</code>, <code dir=\"auto\">plotchar()</code>,\n<code dir=\"auto\">plotbar()</code>, <code dir=\"auto\">plotcandle()</code>, <code dir=\"auto\">plotarrow()</code>, you can set the\n<code dir=\"auto\">display</code> parameter, which controls the display of the plot. The\nfollowing values can be assigned to it:\n<ul>\n<li><code dir=\"auto\">display.none</code> - the plot is not displayed</li>\n<li><code dir=\"auto\">display.all</code> - the plot is displayed (Default)</li>\n</ul>\n</li>\n<li>The <code dir=\"auto\">textalign</code> argument was added to the <code dir=\"auto\">label.new</code> function along\nwith the <code dir=\"auto\">label.set_textalign</code> function. Using those, you can\ncontrol the alignment of the label\u2019s text:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\", overlay = true)\nvar l = label.new(bar_index, high, text=\"Right\\n aligned\\n text\", textalign=text.align_right)\nlabel.set_xy(l, bar_index, high)\n\n.. image:: images/ReleaseNotes-Label_text_align.png</div>\n<h3 class=\"md-heading\" id=\"january-2020\"><a href=\"#january-2020\">January 2020<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New built-in variables were added:</p>\n<ul>\n<li><code dir=\"auto\">iii</code> - Intraday Intensity Index</li>\n<li><code dir=\"auto\">wvad</code> - Williams Variable Accumulation/Distribution</li>\n<li><code dir=\"auto\">wad</code> - Williams Accumulation/Distribution</li>\n<li><code dir=\"auto\">obv</code> - On Balance Volume</li>\n<li><code dir=\"auto\">pvt</code> - Price-Volume Trend</li>\n<li><code dir=\"auto\">nvi</code> - Negative Volume Index</li>\n<li><code dir=\"auto\">pvi</code> - Positive Volume Index</li>\n</ul>\n<p>New parameters were added for <code dir=\"auto\">strategy.close()</code>:</p>\n<ul>\n<li><code dir=\"auto\">qty</code> - the number of contracts/shares/lots/units to exit a trade\nwith</li>\n<li><code dir=\"auto\">qty_percent</code> - defines the percentage of entered\ncontracts/shares/lots/units to exit a trade with</li>\n<li><code dir=\"auto\">comment</code> - addtional notes on the order</li>\n</ul>\n<p>New parameter was added for <code dir=\"auto\">strategy.close_all</code>:</p>\n<ul>\n<li><code dir=\"auto\">comment</code> - additional notes on the order</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2019\"><a href=\"#2019\">2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2019\"><a href=\"#december-2019\">December 2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>\n<p>Warning messages were added.</p>\n<p>For example, if you don\u2019t specify exit parameters for\n<code dir=\"auto\">strategy.exit</code> - <code dir=\"auto\">profit</code>, <code dir=\"auto\">limit</code>, <code dir=\"auto\">loss</code>, <code dir=\"auto\">stop</code> or one of the\nfollowing pairs: <code dir=\"auto\">trail_offset</code> and <code dir=\"auto\">trail_price</code> / <code dir=\"auto\">trail_points</code> -\nyou will see a warning message in the console in the Pine Script\neditor.</p>\n</li>\n<li>\n<p>Increased the maximum number of arguments in <code dir=\"auto\">max</code>, <code dir=\"auto\">min</code>, <code dir=\"auto\">avg</code>\nfunctions. Now you can use up to ten arguments in these functions.</p>\n</li>\n</ul>\n<h3 class=\"md-heading\" id=\"october-2019\"><a href=\"#october-2019\">October 2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li><code dir=\"auto\">plotchar()</code> function now supports most of the Unicode symbols:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\", overlay=true)\nplotchar(open &gt; close, char=\"\ud83d\udc3b\")\n\n\n.. image:: images/ReleaseNotes-Bears_in_plotchar.png</div>\n<ul>\n<li>New <code dir=\"auto\">bordercolor</code> argument of the <code dir=\"auto\">plotcandle()</code> function allows you\nto change the color of candles\u2019 borders:</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=4\nstudy(\"My Script\")\nplotcandle(open, high, low, close, title='Title', color = open &lt; close ? color.green : color.red, wickcolor=color.black, bordercolor=color.orange)</div>\n<ul>\n<li>New variables added:\n<ul>\n<li><code dir=\"auto\">syminfo.description</code> - returns a description of the current\nsymbol</li>\n<li><code dir=\"auto\">syminfo.currency</code> - returns the currency code of the current\nsymbol (EUR, USD, etc.)</li>\n<li><code dir=\"auto\">syminfo.type</code> - returns the type of the current symbol (stock,\nfutures, index, etc.)</li>\n</ul>\n</li>\n</ul>\n<h3 class=\"md-heading\" id=\"september-2019\"><a href=\"#september-2019\">September 2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New parameters to the <code dir=\"auto\">strategy</code> function were added:</p>\n<ul>\n<li><code dir=\"auto\">process_orders_on_close</code> allows the broker emulator to try to\nexecute orders after calculating the strategy at the bar\u2019s close</li>\n<li><code dir=\"auto\">close_entries_rule</code> allows to define the sequence used for closing\npositions</li>\n</ul>\n<p>Some fixes were made:</p>\n<ul>\n<li><code dir=\"auto\">fill()</code> function now works correctly with <code dir=\"auto\">na</code> as the <code dir=\"auto\">color</code>\nparameter value</li>\n<li><code dir=\"auto\">sign()</code> function now calculates correctly for literals and\nconstants</li>\n</ul>\n<p><code dir=\"auto\">str.replace_all(source, target, replacement)</code> function was added. It\nreplaces each occurrence of a <code dir=\"auto\">target</code> string in the <code dir=\"auto\">source</code> string\nwith a <code dir=\"auto\">replacement</code> string</p>\n<h3 class=\"md-heading\" id=\"july-august-2019\"><a href=\"#july-august-2019\">July-August 2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>New variables added:</p>\n<ul>\n<li><code dir=\"auto\">timeframe.isseconds</code> returns true when current resolution is in\nseconds</li>\n<li><code dir=\"auto\">timeframe.isminutes</code> returns true when current resolution is in\nminutes</li>\n<li><code dir=\"auto\">time_close</code> returns the current bar\u2019s close time</li>\n</ul>\n<p>The behavior of some functions, variables and operators has changed:</p>\n<ul>\n<li>\n<p>The <code dir=\"auto\">time</code> variable returns the correct open time of the bar for\nmore special cases than before</p>\n</li>\n<li>\n<p>An optional <em>seconds</em> parameter of the <code dir=\"auto\">timestamp()</code> function allows\nyou to set the time to within seconds</p>\n</li>\n<li>\n<p><code dir=\"auto\">security()</code> function:</p>\n<ul>\n<li>\n<p>Added the possibility of requesting resolutions in seconds:</p>\n<p>1, 5, 15, 30 seconds (chart resolution should be less than or\nequal to the requested resolution)</p>\n</li>\n<li>\n<p>Reduced the maximum value that can be requested in some of the\nother resolutions:</p>\n<p>from 1 to 1440 minutes</p>\n<p>from 1 to 365 days</p>\n<p>from 1 to 52 weeks</p>\n<p>from 1 to 12 months</p>\n</li>\n</ul>\n</li>\n<li>\n<p>Changes to the evaluation of ternary operator branches:</p>\n<p>In Pine Script v3, during the execution of a ternary operator, both\nits branches are calculated, so when this script is added to the\nchart, a long position is opened, even if the long() function is not\ncalled:</p>\n</li>\n</ul>\n<div class=\"pine-colorizer not-content\">//@version=3\nstrategy(title = \"My Strategy\")\nlong() =&gt;\n    strategy.entry(\"long\", true, 1, when = open &gt; high[1])\n    1\nc = 0\nc := true ? 1 : long()\nplot(c)\n\nPine Script v4 contains built-in functions with side effects ( ``line.new`` and ``label.new`` ). If calls to these functions are present in both branches of a ternary operator, both function calls would be executed following v3 conventions. Thus, in Pine Script v4, only the branch corresponding to the evaluated condition is calculated. While this provides a viable solution in some cases, it will modify the behavior of scripts which depended on the fact that both branches of a ternary were evaluated. The solution is to pre-evaluate expressions prior to the ternary operator. The conversion utility takes this requirement into account when converting scripts from v3 to v4, so that script behavior will be identical in v3 and v4.</div>\n<h3 class=\"md-heading\" id=\"june-2019\"><a href=\"#june-2019\">June 2019<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Support for drawing objects. Added <em>label</em> and <em>line</em> drawings</li>\n<li><code dir=\"auto\">var</code> keyword for one time variable initialization</li>\n<li>Type system improvements:\n<ul>\n<li><em>series string</em> data type</li>\n<li>functions for explicit type casting</li>\n<li>syntax for explicit variable type declaration</li>\n<li>new <em>input</em> type forms</li>\n</ul>\n</li>\n<li>Renaming of built-ins and a version 3 to 4 converter utility</li>\n<li><code dir=\"auto\">max_bars_back</code> function to control series variables internal\nhistory buffer sizes</li>\n<li>Pine Script documentation versioning</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2018\"><a href=\"#2018\">2018<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"october-2018\"><a href=\"#october-2018\">October 2018<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>To increase the number of indicators available to the whole\ncommunity, Invite-Only scripts can now be published by Premium users\nonly.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2018\"><a href=\"#april-2018\">April 2018<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Improved the Strategy Tester by reworking the Maximum Drawdown\ncalculation formula.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2017\"><a href=\"#2017\">2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"august-2017\"><a href=\"#august-2017\">August 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>With the new argument <code dir=\"auto\">show_last</code> in the plot-type functions, you\ncan restrict the number of bars that the plot is displayed on.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2017\"><a href=\"#june-2017\">June 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>A major script publishing improvement: it is now possible to update\nyour script without publishing a new one via the Update button in\nthe publishing dialog.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"may-2017\"><a href=\"#may-2017\">May 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Expanded the type system by adding a new type of constants that can\nbe calculated during compilation.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2017\"><a href=\"#april-2017\">April 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Expanded the keyword argument functionality: it is now possible to\nuse keyword arguments in all built-in functions.</li>\n<li>A new <code dir=\"auto\">barstate.isconfirmed</code> variable has been added to the list of\nvariables that return bar status. It lets you create indicators that\nare calculated based on the closed bars only.</li>\n<li>The <code dir=\"auto\">options</code> argument for the <code dir=\"auto\">input()</code> function creates an input\nwith a set of options defined by the script\u2019s author.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2017\"><a href=\"#march-2017\">March 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Pine Script v3 is here! Some important changes:\n<ul>\n<li>Changes to the default behavior of the <code dir=\"auto\">security()</code> function: it\ncan no longer access the future data by default. This can be\nchanges with the <code dir=\"auto\">lookahead</code> parameter.</li>\n<li>An implicit conversion of boolean values to numeric values was\nreplaced with an implicit conversion of numeric values (integer\nand float) to boolean values.</li>\n<li>Self-referenced and forward-referenced variables were removed.\nAny PineScript code that used those language constructions can\nbe equivalently rewritten using mutable variables.</li>\n</ul>\n</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2017\"><a href=\"#february-2017\">February 2017<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Several improvements to the strategy tester and the strategy report:\n<ul>\n<li>New Buy &amp; Hold equity graph \u2014 a new graph that lets you compare\nperformance of your strategy versus a \u201cbuy and hold\u201d, i.e if\nyou just bought a security and held onto it without trading.</li>\n<li>Added percentage values to the absolute currency values.</li>\n<li>Added Buy &amp; Hold Return to display the final value of Buy &amp; Hold\nEquity based on last price.</li>\n<li>Added Sharpe Ratio \u2014 it shows the relative effectiveness of the\ninvestment portfolio (security), a measure that indicates the\naverage return minus the risk-free return divided by the\nstandard deviation of return on an investment.</li>\n<li>Slippage lets you simulate a situation when orders are filled at\na worse price than expected. It can be set through the\nProperties dialog or through the slippage argument in the\n<code dir=\"auto\">strategy()</code> function.</li>\n<li>Commission allows yot to add commission for placed orders in\npercent of order value, fixed price or per contract. The amount\nof commission paid is shown in the Commission Paid field. The\ncommission size and its type can be set through the Properties\ndialog or through the commission_type and commission_value\narguments in the <code dir=\"auto\">strategy()</code> function.</li>\n</ul>\n</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2016\"><a href=\"#2016\">2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"december-2016\"><a href=\"#december-2016\">December 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added invite-only scripts. The invite-only indicators are visible in\nthe Community Scripts, but nobody can use them without explicit\npermission from the author, and only the author can see the source\ncode.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"october-2016\"><a href=\"#october-2016\">October 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Introduded indicator revisions. Each time an indicator is saved, it\ngets a new revision, and it is possible to easily switch to any past\nrevision from the Pine Editor.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"september-2016\"><a href=\"#september-2016\">September 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>It is now possible to publish indicators with protected source code.\nThese indicators are available in the public Script Library, and any\nuser can use them, but only the author can see the source code.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"july-2016\"><a href=\"#july-2016\">July 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Improved the behavior of the <code dir=\"auto\">fill()</code> function: one call can now\nsupport several different colors.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2016\"><a href=\"#march-2016\">March 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Color type variables now have an additional parameter to set default\ntransparency. The transparency can be set with the <code dir=\"auto\">color.new()</code>\nfunction, or by adding an alpha-channel value to a hex color code.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2016\"><a href=\"#february-2016\">February 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added <code dir=\"auto\">for</code> loops and keywords <code dir=\"auto\">break</code> and <code dir=\"auto\">continue</code>.</li>\n<li>Pine Script now supports mutable variables! Use the <code dir=\"auto\">:=</code> operator\nto assign a new value to a variable that has already been defined.</li>\n<li>Multiple improvements and bug fixes for strategies.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"january-2016\"><a href=\"#january-2016\">January 2016<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>A new <code dir=\"auto\">alertcondition()</code> function allows for creating custom alert\nconditions in Pine Script-based indicators.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2015\"><a href=\"#2015\">2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"october-2015\"><a href=\"#october-2015\">October 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Pine has graduated to v2! The new version of Pine Script added\nsupport for <code dir=\"auto\">if</code> statements, making it easier to write more readable\nand concise code.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"september-2015\"><a href=\"#september-2015\">September 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added backtesting functionality to Pine Script. It is now possible\nto create trading strategies, i.e. scripts that can send, modify and\ncancel orders to buy or sell. Strategies allow you to perform\nbacktesting (emulation of strategy trading on historical data) and\nforward testing (emulation of strategy trading on real-time data)\naccording to your algorithms. Detailed information about the\nstrategy\u2019s calculations and the order fills can be seen in the\nnewly added Strategy Tester tab.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"july-2015\"><a href=\"#july-2015\">July 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>A new <code dir=\"auto\">editable</code> parameter allows hiding the plot from the Style\nmenu in the indicator settings so that it is not possible to edit\nits style. The parameter has been added to all the following\nfunctions: all plot-type functions, <code dir=\"auto\">barcolor()</code>, <code dir=\"auto\">bgcolor()</code>,\n<code dir=\"auto\">hline()</code>, and <code dir=\"auto\">fill()</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2015\"><a href=\"#june-2015\">June 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added two new functions to display custom barsets using PineScipt:\n<code dir=\"auto\">plotbar()</code> and <code dir=\"auto\">plotcandle()</code>.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2015\"><a href=\"#april-2015\">April 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added two new shapes to the <code dir=\"auto\">plotshape()</code> function: shape.labelup\nand shape.labeldown.</li>\n<li>PineScipt Editor has been improved and moved to a new panel at the\nbottom of the page.</li>\n<li>Added a new <code dir=\"auto\">step</code> argument for the <code dir=\"auto\">input()</code> function, allowing to\nspecify the step size for the indicator\u2019s inputs.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"march-2015\"><a href=\"#march-2015\">March 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added support for inputs with the <code dir=\"auto\">source</code> type to the <code dir=\"auto\">input()</code>\nfunction, allowing to select the data source for the indicator\u2019s\ncalculations from its settings.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2015\"><a href=\"#february-2015\">February 2015<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added a new <code dir=\"auto\">text</code> argument to <code dir=\"auto\">plotshape()</code> and <code dir=\"auto\">plotchar()</code>\nfunctions.</li>\n<li>Added four new shapes to the <code dir=\"auto\">plotshape()</code> function: shape.arrowup,\nshape.arrowdown, shape.square, shape.diamond.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:11", "segment_order": 11, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2014\"><a href=\"#2014\">2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"august-2014\"><a href=\"#august-2014\">August 2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Improved the script sharing capabilities, changed the layout of the\nIndicators menu and separated published scripts from ideas.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"july-2014\"><a href=\"#july-2014\">July 2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added three new plotting functions, <code dir=\"auto\">plotshape()</code>, <code dir=\"auto\">plotchar()</code>, and\n<code dir=\"auto\">plotarrow()</code> for situations when you need to highlight specific\nbars on a chart without drawing a line.</li>\n<li>Integrated QUANDL data into Pine Script. The data can be accessed\nby passing the QUANDL ticker to the <code dir=\"auto\">security</code> function.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"june-2014\"><a href=\"#june-2014\">June 2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added Pine Script sharing, enabling programmers and traders to\nshare their scripts with the rest of the TradingView community.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"april-2014\"><a href=\"#april-2014\">April 2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added line wrapping.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"february-2014\"><a href=\"#february-2014\">February 2014<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>Added support for inputs, allowing users to edit the indicator\ninputs through the properties window, without needing to edit the\nPine script.</li>\n<li>Added self-referencing variables.</li>\n<li>Added support for multiline functions.</li>\n<li>Implemented the type-casting mechanism, automatically casting\nconstant and simple float and int values to series when it is\nrequired.</li>\n<li>Added several new functions and improved the existing ones:\n<ul>\n<li><code dir=\"auto\">barssince()</code> and <code dir=\"auto\">valuewhen()</code> allow you to check conditions on\nhistorical data easier.</li>\n<li>The new <code dir=\"auto\">barcolor()</code> function lets you specify a color for a bar\nbased on filling of a certain condition.</li>\n<li>Similar to the <code dir=\"auto\">barcolor()</code> function, the <code dir=\"auto\">bgcolor()</code> function\nchanges the color of the background.</li>\n<li>Reworked the <code dir=\"auto\">security()</code> function, further expanding its\nfunctionality.</li>\n<li>Improved the <code dir=\"auto\">fill()</code> function, enabling it to be used more than\nonce in one script.</li>\n<li>Added the <code dir=\"auto\">round()</code> function to round and convert float values\nto integers.</li>\n</ul>\n</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:12", "segment_order": 12, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/release-notes", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"2013\"><a href=\"#2013\">2013<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ul>\n<li>The first version of Pine Script is introduced to all TradingView\nusers, initially as an open beta, on December 13th.</li>\n</ul>", "segment_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401:13", "segment_order": 13, "segment_type": "guide_section", "source_artifact_id": "5428906a3bd06b04714c0de7e66c9fcc3ea5cf51edf3d639696ad64e0e723401", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/where-can-i-get-more-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/where-can-i-get-more-information\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"where-can-i-get-more-information\"><a href=\"#where-can-i-get-more-information\">Where can I get more information?<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<ul>\n<li>A description of all the Pine Script\u00ae operators, variables and\nfunctions can be found in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/\">Reference\nManual</a>.</li>\n<li>Use the code from one of TradingView\u2019s built-in scripts to start\nfrom. Open a new chart and click the \u201cPine Editor\u201d button on the\ntoolbar. Once in the editor window, click the \u201cOpen\u201d button, then\nselect \u201cBuilt-in script\u2026\u201d from the dropdown list to open a\ndialog box containing a list of TradingView\u2019s built-in scripts.</li>\n<li>There is a TradingView public chat dedicated to Pine Script\n<a href=\"https://www.tradingview.com/chat/#BfmVowG1TZkKO235\">Q&amp;A</a> where\nactive developers of our community help each other out.</li>\n<li>Information about major releases and modifications to Pine Script\n(as well as other features) is regularly published on\n<a href=\"https://www.tradingview.com/blog/en/category/market-analysis/pine/\">TradingView\u2019s\nblog</a>.</li>\n<li>TradingView\u2019s <a href=\"https://www.tradingview.com/script/\">Community\nScripts</a> contain all\nuser-published scripts. They can also be accessed from charts using\nthe \u201cIndicators &amp; Strategies\u201d button and the \u201cCommunity Scripts\u201d\ntab of the script searching dialog box.</li>\n</ul>", "segment_id": "317c8c80a43e2425f72d0ec5cba41a3355e00e53f8420d045689f5920b543932:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "317c8c80a43e2425f72d0ec5cba41a3355e00e53f8420d045689f5920b543932", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/where-can-i-get-more-information", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"external-resources\"><a href=\"#external-resources\">External resources<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/u/PineCoders/#published-scripts\">PineCoders</a>\naccount on TradingView publishes useful information for Pine Script\nprogrammers. They also have content on their\n<a href=\"https://www.pinecoders.com/\" rel=\"nofollow\">website</a>.</li>\n<li><a href=\"https://kodify.net/tradingview-programming-articles\" rel=\"nofollow\">Kodify</a> has\nTradingView tutorials on various topics for beginners and more\nexperienced programmers alike. Topics include plotting, alerts,\nstrategy orders, and complete example indicators and strategies.</li>\n<li>You can ask questions about programming in Pine Script in the\n<code dir=\"auto\">[pine-script]</code> tag on\n<a href=\"https://stackoverflow.com/questions/tagged/pine-script\" rel=\"nofollow\">StackOverflow</a>.</li>\n</ul>", "segment_id": "317c8c80a43e2425f72d0ec5cba41a3355e00e53f8420d045689f5920b543932:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "317c8c80a43e2425f72d0ec5cba41a3355e00e53f8420d045689f5920b543932", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/writing/debugging\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"debugging\"><a href=\"#debugging\">Debugging<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>TradingView\u2019s close integration between the Pine Editor and the chart\ninterface facilitates efficient, interactive debugging of Pine Script\u00ae\ncode, as scripts can produce dynamic results in multiple locations, on\nand off the chart. Programmers can utilize such results to refine their\nscript\u2019s behaviors and ensure everything works as expected.</p>\n<p>When a programmer understands the appropriate techniques for inspecting\nthe variety of behaviors one may encounter while writing a script, they\ncan quickly and thoroughly identify and resolve potential problems in\ntheir code, which allows for a more seamless overall coding experience.\nThis page demonstrates some of the handiest ways to debug code when\nworking with Pine Script.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Before venturing further on this page, we recommend familiarizing\nyourself with Pine\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a> and\n<a href=\"/pine-script-docs/v5/language/type-system/\">Type system</a>, as it\u2019s\ncrucial to understand these details when debugging in the Pine Script\nenvironment.</p></div></aside>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"the-lay-of-the-land\"><a href=\"#the-lay-of-the-land\">The lay of the land<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine scripts can output their results in multiple different ways, any of\nwhich programmers can utilize for debugging.</p>\n<p>The <code dir=\"auto\">plot*()</code> functions can display results in a chart pane, the\nscript\u2019s status line, the price (y-axis) scale, and the Data Window,\nproviding simple, convenient ways to debug numeric and conditional\nvalues:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"590\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-The-lay-of-the-land-1.BMFtSmLt_rnRYW.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"The lay of the land - Plots\")\n\n// Plot the `bar_index` in all available locations.\nplot(bar_index, \"bar_index\", color.teal, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>A script\u2019s status line outputs will only show when enabling the\n\u201cValues\u201d checkbox within the \u201cIndicators\u201d section of the\nchart\u2019s \u201cStatus line\u201d settings.</li>\n<li>Price scales will only show plot values or names when enabling\nthe options from the \u201cIndicators and financials\u201d dropdown in\nthe chart\u2019s \u201cScales and lines\u201d settings.</li>\n</ul>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nfunction displays colors in the script pane\u2019s background, and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>\nfunction changes the colors of the main chart\u2019s bars or candles. Both\nof these functions provide a simple way to visualize conditions:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"556\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-The-lay-of-the-land-2.Dt_T7jt8_Zx7tBv.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"The lay of the land - Background and bar colors\")\n\n//@variable Is `true` if the `close` is rising over 2 bars.\nbool risingPrice = ta.rising(close, 2)\n\n// Highlight the chart background and color the main chart bars based on `risingPrice`.\nbgcolor(risingPrice ? color.new(color.green, 70) : na, title= \"`risingPrice` highlight\")\nbarcolor(risingPrice ? color.aqua : chart.bg_color, title = \"`risingPrice` bar color\")</div>\n<p>Pine\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> (<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">line</a>, <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">box</a>, <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polyline</a>, <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">label</a>)\nproduce drawings in the script\u2019s pane. While they don\u2019t return results\nin other locations, such as the status line or Data Window, they provide\nalternative, flexible solutions for inspecting numeric values,\nconditions, and strings directly on the chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"562\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-The-lay-of-the-land-3.BR7JNYrd_Z2s1rX.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"The lay of the land - Drawings\", overlay = true)\n\n//@variable Is `true` when the time changes on the \"1D\" timeframe.\nbool newDailyBar = timeframe.change(\"1D\")\n//@variable The previous bar's `bar_index` from when `newDailyBar` last occurred.\nint closedIndex = ta.valuewhen(newDailyBar, bar_index - 1, 0)\n//@variable The previous bar's `close` from when `newDailyBar` last occurred.\nfloat closedPrice = ta.valuewhen(newDailyBar, close[1], 0)\n\nif newDailyBar\n    //@variable Draws a line from the previous `closedIndex` and `closedPrice` to the current values.\n    line debugLine = line.new(closedIndex[1], closedPrice[1], closedIndex, closedPrice, width = 2)\n    //@variable Variable info to display in a label.\n    string debugText = \"'1D' bar closed at: \\n(\" + str.tostring(closedIndex) + \", \" + str.tostring(closedPrice) + \")\"\n    //@variable Draws a label at the current `closedIndex` and `closedPrice`.\n    label.new(closedIndex, closedPrice, debugText, color = color.purple, textcolor = color.white)</div>\n<p>The <code dir=\"auto\">log.*()</code> functions produce\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>\nresults. Every time a script calls any of these functions, the script\nlogs a message in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane,\nalong with a timestamp and navigation options to identify the specific\ntimes, chart bars, and lines of code that triggered a log:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"666\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-The-lay-of-the-land-4.fSt39wX6_2urrNy.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"The lay of the land - Pine Logs\")\n\n//@variable The natural logarithm of the current `high - low` range.\nfloat logRange = math.log(high - low)\n\n// Plot the `logRange`.\nplot(logRange, \"logRange\")\n\nif barstate.isconfirmed\n    // Generate an \"error\" or \"info\" message on the confirmed bar, depending on whether `logRange` is defined.\n    switch \n        na(logRange) =&gt; log.error(\"Undefined `logRange` value.\")\n        =&gt;              log.info(\"`logRange` value: \" + str.tostring(logRange))\nelse\n    // Generate a \"warning\" message for unconfirmed values.\n    log.warning(\"Unconfirmed `logRange` value: \" + str.tostring(logRange))</div>\n<p>One can apply any of the above, or a combination, to establish debugging\nroutines to fit their needs and preferences, depending on the data types\nand structures they\u2019re working with. See the sections below for\ndetailed explanations of various debugging techniques.</p>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"numeric-values\"><a href=\"#numeric-values\">Numeric values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When creating code in Pine Script, working with numbers is inevitable.\nTherefore, to ensure a script works as intended, it\u2019s crucial to\nunderstand how to inspect the numeric\n(<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a> and\n<a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>)\nvalues it receives and calculates.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This section discusses fundamental <em>chart-based</em> approaches for\ndebugging numbers. Scripts can also convert numbers to\n<a href=\"/pine-script-docs/v5/language/type-system/#string\">strings</a>,\nallowing one to inspect numbers using string-related techniques. For\nmore information, see the\n<a href=\"/pine-script-docs/v5/writing/debugging/#strings\">Strings</a> and\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>\nsections.</p></div></aside>\n<h3 class=\"md-heading\" id=\"plotting-numbers\"><a href=\"#plotting-numbers\">Plotting numbers<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One of the most straightforward ways to inspect a script\u2019s numeric\nvalues is to use <code dir=\"auto\">plot*()</code> functions, which can display results\ngraphically on the chart and show formatted numbers in the script\u2019s\nstatus line, the price scale, and the Data Window. The locations where a\n<code dir=\"auto\">plot*()</code> function displays its results depend on the <code dir=\"auto\">display</code>\nparameter. By default, its value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display.all\">display.all</a>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Only a script\u2019s <em>global scope</em> can contain <code dir=\"auto\">plot*()</code> calls, meaning\nthese functions can only accept global variables and literals. They\ncannot use variables declared from the local scopes of\n<a href=\"/pine-script-docs/v5/language/loops/\">loops</a>,\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>, or\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>.</p></div></aside>\n<p>The following example uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nfunction to display the 1-bar change in the value of the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nvariable measured in chart timeframes (e.g., a plotted value of 1 on the\n\u201c1D\u201d chart means there is a one-day difference between the opening\ntimes of the current and previous bars). Inspecting this series can help\nto identify time gaps in a chart\u2019s data, which is helpful information\nwhen designing time-based indicators.</p>\n<p>Since we have not specified a <code dir=\"auto\">display</code> argument, the function uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display.all\">display.all</a>,\nmeaning it will show data in <em>all</em> possible locations, as we see below:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"590\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-1.CPWsJyU1_26SArq.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting numbers demo\", \"Time changes\")\n\n//@variable The one-bar change in the chart symbol's `time` value, measured in units of the chart timeframe.\nfloat timeChange = ta.change(time) / (1000.0 * timeframe.in_seconds())\n\n// Display the `timeChange` in all possible locations.\nplot(timeChange, \"Time difference (in chart bar units)\", color.purple, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The numbers displayed in the script\u2019s status line and the Data\nWindow reflect the plotted values at the location of the\nchart\u2019s cursor. These areas will show the latest bar\u2019s value\nwhen the mouse pointer isn\u2019t on the chart.</li>\n<li>The number in the price scale reflects the latest available\nvalue on the visible chart.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"without-affecting-the-scale\"><a href=\"#without-affecting-the-scale\">Without affecting the scale<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When debugging multiple numeric values in a script, programmers may wish\nto inspect them without interfering with the price scales or cluttering\nthe visual outputs in the chart\u2019s pane, as distorted scales and\noverlapping plots may make it harder to evaluate the results.</p>\n<p>A simple way to inspect numbers without adding more visuals to the\nchart\u2019s pane is to change the <code dir=\"auto\">display</code> values in the script\u2019s\n<code dir=\"auto\">plot*()</code> calls to other <code dir=\"auto\">display.*</code> variables or expressions using\nthem.</p>\n<p>Let\u2019s look at a practical example. Here, we\u2019ve drafted the following\nscript that calculates a custom-weighted moving average by dividing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.sum\">sum</a>\nof <code dir=\"auto\">weight * close</code> values by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.sum\">sum</a>\nof the <code dir=\"auto\">weight</code> series:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-Without-affecting-the-scale-1.D9lHNsXL_mUjuG.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting without affecting the scale demo\", \"Weighted Average\", true)\n\n//@variable The number of bars in the average.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@variable The weight applied to the price on each bar.\nfloat weight = math.pow(close - open, 2)\n\n//@variable The numerator of the average.\nfloat numerator = math.sum(weight * close, lengthInput)\n//@variable The denominator of the average.\nfloat denominator = math.sum(weight, lengthInput)\n\n//@variable The `lengthInput`-bar weighted average.\nfloat average = numerator / denominator\n\n// Plot the `average`.\nplot(average, \"Weighted Average\", linewidth = 3)</div>\n<p>Suppose we\u2019d like to inspect the variables used in the <code dir=\"auto\">average</code>\ncalculation to understand and fine-tune the result. If we were to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nto display the script\u2019s <code dir=\"auto\">weight</code>, <code dir=\"auto\">numerator</code>, and <code dir=\"auto\">denominator</code> in all\nlocations, we can no longer easily identify our <code dir=\"auto\">average</code> line on the\nchart since each variable has a radically different scale:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-Without-affecting-the-scale-2.CNBE_Mtb_2rATc4.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting without affecting the scale demo\", \"Weighted Average\", true)\n\n//@variable The number of bars in the average.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@variable The weight applied to the price on each bar.\nfloat weight = math.pow(close - open, 2)\n\n//@variable The numerator of the average.\nfloat numerator = math.sum(close * weight, lengthInput)\n//@variable The denominator of the average.\nfloat denominator = math.sum(weight, lengthInput)\n\n//@variable The `lengthInput`-bar weighted average.\nfloat average = numerator / denominator\n\n// Plot the `average`.\nplot(average, \"Weighted Average\", linewidth = 3)\n\n// Create debug plots for the `weight`, `numerator`, and `denominator`.\nplot(weight, \"weight\", color.purple)\nplot(numerator, \"numerator\", color.teal)\nplot(denominator, \"denominator\", color.maroon)</div>\n<p>While we could hide individual plots from the \u201cStyle\u201d tab of the\nscript\u2019s settings, doing so also prevents us from inspecting the\nresults in any other location. To simultaneously view the variables\u2019\nvalues and preserve the scale of our chart, we can change the <code dir=\"auto\">display</code>\nvalues in our debug plots.</p>\n<p>The version below includes a <code dir=\"auto\">debugLocations</code> variable in the debug\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncalls with a value of <code dir=\"auto\">display.all - display.pane</code> to specify that all\nlocations <em>except</em> the chart pane will show the results. Now we can\ninspect the calculation\u2019s values without the extra clutter:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"558\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-Without-affecting-the-scale-3.iomfmsC__26l9R3.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting without affecting the scale demo\", \"Weighted Average\", true)\n\n//@variable The number of bars in the average.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@variable The weight applied to the price on each bar.\nfloat weight = math.pow(close - open, 2)\n\n//@variable The numerator of the average.\nfloat numerator = math.sum(close * weight, lengthInput)\n//@variable The denominator of the average.\nfloat denominator = math.sum(weight, lengthInput)\n\n//@variable The `lengthInput`-bar weighted average.\nfloat average = numerator / denominator\n\n// Plot the `average`.\nplot(average, \"Weighted Average\", linewidth = 3)\n\n//@variable The display locations of all debug plots.\ndebugLocations = display.all - display.pane\n// Create debug plots for the `weight`, `numerator`, and `denominator`.\nplot(weight, \"weight\", color.purple, display = debugLocations)\nplot(numerator, \"numerator\", color.teal, display = debugLocations)\nplot(denominator, \"denominator\", color.maroon, display = debugLocations)</div>\n<h4 class=\"md-heading\" id=\"from-local-scopes\"><a href=\"#from-local-scopes\">From local scopes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>A script\u2019s <em>local scopes</em> are sections of indented code within\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>,\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a>,\nand <a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>. When working with variables declared within these scopes,\nusing the <code dir=\"auto\">plot*()</code> functions to display their values directly <em>will\nnot</em> work, as plots only work with literals and <em>global</em> variables.</p>\n<p>To display a local variable\u2019s values using plots, one can assign its\nresults to a global variable and pass that variable to the <code dir=\"auto\">plot*()</code>\ncall.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The approach described below works for local variables declared within\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a>.\nEmploying a similar process for\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nrequires\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>, or other built-in reference types. See the\n<a href=\"/pine-script-docs/v5/writing/debugging/#debugging-functions\">Debugging functions</a> section for more information.</p></div></aside>\n<p>For example, this script calculates the all-time maximum and minimum\nchange in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice over a <code dir=\"auto\">lengthInput</code> period. It uses an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure to declare a local <code dir=\"auto\">change</code> variable and update the global\n<code dir=\"auto\">maxChange</code> and <code dir=\"auto\">minChange</code> once every <code dir=\"auto\">lengthInput</code> bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"554\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-From-local-scopes-1.DEllI76K_2tIueB.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting numbers from local scopes demo\", \"Periodic changes\")\n\n//@variable The number of chart bars in each period.\nint lengthInput = input.int(20, \"Period length\", 1)\n\n//@variable The maximum `close` change over each `lengthInput` period on the chart.\nvar float maxChange = na\n//@variable The minimum `close` change over each `lengthInput` period on the chart.\nvar float minChange = na\n\n//@variable Is `true` once every `lengthInput` bars.\nbool periodClose = bar_index % lengthInput == 0\n\nif periodClose\n    //@variable The change in `close` prices over `lengthInput` bars.\n    float change = close - close[lengthInput]\n    // Update the global `maxChange` and `minChange`.\n    maxChange := math.max(nz(maxChange, change), change)\n    minChange := math.min(nz(minChange, change), change)\n\n// Plot the `maxChange` and `minChange`.\nplot(maxChange, \"Max periodic change\", color.teal, 3)\nplot(minChange, \"Min periodic change\", color.maroon, 3)\nhline(0.0, color = color.gray, linestyle = hline.style_solid)</div>\n<p>Suppose we want to inspect the history of the <code dir=\"auto\">change</code> variable using a\nplot. While we cannot plot the variable directly since the script\ndeclares it in a local scope, we can assign its value to another\n<em>global</em> variable for use in a <code dir=\"auto\">plot*()</code> function.</p>\n<p>Below, we\u2019ve added a <code dir=\"auto\">debugChange</code> variable with an initial value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> to\nthe global scope, and the script reassigns its value within the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure using the local <code dir=\"auto\">change</code> variable. Now, we can use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nwith the <code dir=\"auto\">debugChange</code> variable to view the history of available\n<code dir=\"auto\">change</code> values:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"554\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-Plotting-numbers-From-local-scopes-2.CPaEqcWa_i20qC.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plotting numbers from local scopes demo\", \"Periodic changes\")\n\n//@variable The number of chart bars in each period.\nint lengthInput = input.int(20, \"Period length\", 1)\n\n//@variable The maximum `close` change over each `lengthInput` period on the chart.\nvar float maxChange = na\n//@variable The minimum `close` change over each `lengthInput` period on the chart.\nvar float minChange = na\n\n//@variable Is `true` once every `lengthInput` bars.\nbool periodClose = bar_index % lengthInput == 0\n\n//@variable Tracks the history of the local `change` variable.\nfloat debugChange = na\n\nif periodClose\n    //@variable The change in `close` prices over `lengthInput` bars.\n    float change = close - close[lengthInput]\n    // Update the global `maxChange` and `minChange`.\n    maxChange := math.max(nz(maxChange, change), change)\n    minChange := math.min(nz(minChange, change), change)\n    // Assign the `change` value to the `debugChange` variable.\n    debugChange := change\n\n// Plot the `maxChange` and `minChange`.\nplot(maxChange, \"Max periodic change\", color.teal, 3)\nplot(minChange, \"Min periodic change\", color.maroon, 3)\nhline(0.0, color = color.gray, linestyle = hline.style_solid)\n\n// Create a debug plot to visualize the `change` history.\nplot(debugChange, \"Extracted change\", color.purple, 15, plot.style_areabr)</div>\n<p>Note that:</p>\n<ul>\n<li>The script uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_plot.style_areabr\">plot.style_areabr</a>\nin the debug plot, which doesn\u2019t bridge over\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues as the default style does.</li>\n<li>When the rightmost visible bar\u2019s plotted value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nthe number in the price scale represents the latest <em>non-na</em>\nvalue before that bar, if one exists.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"with-drawings\"><a href=\"#with-drawings\">With drawings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>An alternative approach to graphically inspecting the history of a\nscript\u2019s numeric values is to use Pine\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a>, including\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nand <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>.</p>\n<p>While Pine drawings don\u2019t display results anywhere other than the chart\npane, scripts can create them from within <em>local scopes</em>, including the\nscopes of <a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\n(see the\n<a href=\"/pine-script-docs/v5/writing/debugging/#debugging-functions\">Debugging functions</a> section to learn more). Additionally, scripts can position\ndrawings at <em>any</em> available chart location, irrespective of the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>.</p>\n<p>For example, let\u2019s revisit the \u201cPeriodic changes\u201d script from the\n<a href=\"/pine-script-docs/v5/writing/debugging/#from-local-scopes\">previous section</a>. Suppose we\u2019d like to inspect the history of the local\n<code dir=\"auto\">change</code> variable <em>without</em> using a plot. In this case, we can avoid\ndeclaring a separate global variable and instead create drawing objects\ndirectly from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s local scope.</p>\n<p>The script below is a modification of the previous script that uses\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> to\nvisualize the <code dir=\"auto\">change</code> variable\u2019s behavior. Inside the scope of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure, it calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nto create a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nthat spans from the bar <code dir=\"auto\">lengthInput</code> bars ago to the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"554\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Numeric-values-With-drawings-1.DsvQ-qM2_Z2i05an.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Drawing numbers from local scopes demo\", \"Periodic changes\", max_boxes_count = 500)\n\n//@variable The number of chart bars in each period.\nint lengthInput = input.int(20, \"Period length\", 1)\n\n//@variable The maximum `close` change over each `lengthInput` period on the chart.\nvar float maxChange = na\n//@variable The minimum `close` change over each `lengthInput` period on the chart.\nvar float minChange = na\n\n//@variable Is `true` once every `lengthInput` bars.\nbool periodClose = bar_index % lengthInput == 0\n\nif periodClose\n    //@variable The change in `close` prices over `lengthInput` bars.\n    float change = close - close[lengthInput]\n    // Update the global `maxChange` and `minChange`.\n    maxChange := math.max(nz(maxChange, change), change)\n    minChange := math.min(nz(minChange, change), change)\n    //@variable Draws a box on the chart to visualize the `change` value.\n    box debugBox = box.new(\n         bar_index - lengthInput, math.max(change, 0.0), bar_index, math.min(change, 0.0),\n         color.purple, bgcolor = color.new(color.purple, 80), text = str.tostring(change)\n     )\n\n// Plot the `maxChange` and `minChange`.\nplot(maxChange, \"Max periodic change\", color.teal, 3)\nplot(minChange, \"Min periodic change\", color.maroon, 3)\nhline(0.0, color = color.gray, linestyle = hline.style_solid)</div>\n<p>Note that:</p>\n<ul>\n<li>The script includes <code dir=\"auto\">max_boxes_count = 500</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction, which allows it to show up to 500\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>\non the chart.</li>\n<li>We used <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.max\">math.max(change,\n0.0)</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.min\">math.min(change,\n0.0)</a>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\nfunction as the <code dir=\"auto\">top</code> and <code dir=\"auto\">bottom</code> values.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\ncall includes\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring(change)</a>\nas its <code dir=\"auto\">text</code> argument to display a <em>\u201cstring\u201d representation</em>\nof the <code dir=\"auto\">change</code> variable\u2019s \u201cfloat\u201d value in each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\ndrawing. See\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">this</a> portion of the\n<a href=\"/pine-script-docs/v5/writing/debugging/#strings\">Strings</a>\nsection below to learn more about representing data with\nstrings.</li>\n</ul>\n<p>For more information about using\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> and\nother related\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a>, see our User Manual\u2019s\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/\">Lines and boxes</a>\npage.</p>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"conditions\"><a href=\"#conditions\">Conditions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Many scripts one will create in Pine involve declaring and evaluating\n<em>conditions</em> to dictate specific script actions, such as triggering\ndifferent calculation patterns, visuals, signals, alerts, strategy\norders, etc. As such, it\u2019s imperative to understand how to inspect the\nconditions a script uses to ensure proper execution.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This section discusses debugging techniques based on chart visuals. To\nlearn about <em>logging</em> conditions, see the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>\nsection below.</p></div></aside>\n<h3 class=\"md-heading\" id=\"as-numbers\"><a href=\"#as-numbers\">As numbers<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>One possible way to debug a script\u2019s conditions is to define <em>numeric\nvalues</em> based on them, which allows programmers to inspect them using\nnumeric approaches, such as those outlined in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#numeric-values\">previous section</a>.</p>\n<p>Let\u2019s look at a simple example. This script calculates the ratio\nbetween the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_ohlc4\">ohlc4</a>\nprice and the <code dir=\"auto\">lengthInput</code>-bar <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">moving\naverage</a>.\nIt assigns a condition to the <code dir=\"auto\">priceAbove</code> variable that returns <code dir=\"auto\">true</code>\nwhenever the value of the ratio exceeds 1 (i.e., the price is above the\naverage).</p>\n<p>To inspect the occurrences of the condition, we created a <code dir=\"auto\">debugValue</code>\nvariable assigned to the result of an expression that uses the ternary\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_?:\">?:</a>\noperator to return 1 when <code dir=\"auto\">priceAbove</code> is <code dir=\"auto\">true</code> and 0 otherwise. The\nscript plots the variable\u2019s value in all available locations:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"498\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-As-numbers-1.BoeptaNB_2nR2E8.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditions as numbers demo\", \"MA signal\")\n\n//@variable The number of bars in the moving average calculation.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@variable The ratio of the `ohlc4` price to its `lengthInput`-bar moving average.\nfloat ratio = ohlc4 / ta.sma(ohlc4, lengthInput)\n\n//@variable The condition to inspect. Is `true` when `ohlc4` is above its moving average, `false` otherwise.\nbool priceAbove = ratio &gt; 1.0\n//@variable Returns 1 when the `priceAbove` condition is `true`, 0 otherwise.\nint debugValue = priceAbove ? 1 : 0\n\n// Plot the `debugValue.\nplot(debugValue, \"Conditional number\", color.teal, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>Representing \u201cbool\u201d values using numbers also allows scripts\nto display conditional shapes or characters at specific y-axis\nlocations with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\nand it facilitates conditional debugging with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>.\nSee the\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-conditional-shapes\">next section</a> to learn more.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"plotting-conditional-shapes\"><a href=\"#plotting-conditional-shapes\">Plotting conditional shapes<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nfunctions provide utility for debugging conditions, as they can plot\nshapes or characters at absolute or relative chart locations whenever\nthey contain a <code dir=\"auto\">true</code> or non-na <code dir=\"auto\">series</code> argument.</p>\n<p>These functions can also display <em>numeric</em> representations of the\n<code dir=\"auto\">series</code> in the script\u2019s status line and the Data Window, meaning\nthey\u2019re also helpful for debugging\n<a href=\"/pine-script-docs/v5/writing/debugging/#numeric-values\">numbers</a>.\nWe show a simple, practical way to debug numbers with these functions in\nthe <a href=\"/pine-script-docs/v5/writing/debugging/#tips\">Tips</a> section.</p>\n<p>The chart locations of the plots depend on the <code dir=\"auto\">location</code> parameter,\nwhich is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.abovebar\">location.abovebar</a>\nby default.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>When using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.abovebar\">location.abovebar</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.belowbar\">location.belowbar</a>,\nthe function positions the shapes/characters relative to the <em>main\nchart</em> prices. If the script plots its values in a separate chart pane,\nwe recommend debugging with other <code dir=\"auto\">location</code> options to avoid affecting\nthe pane\u2019s scale.</p></div></aside>\n<p>Let\u2019s inspect a condition using these functions. The following script\ncalculates an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rsi\">RSI</a>\nwith a <code dir=\"auto\">lengthInput</code> length and a <code dir=\"auto\">crossBelow</code> variable whose value is\nthe result of a condition that returns <code dir=\"auto\">true</code> when the RSI crosses below\n30. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nto display a circle near the top of the pane each time the condition\noccurs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Plotting-conditional-shapes-1.B_YUlhVQ_Z1ARRXr.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional shapes demo\", \"RSI cross under 30\")\n\n//@variable The length of the RSI.\nint lengthInput = input.int(14, \"Length\", 1)\n\n//@variable The calculated RSI value.\nfloat rsi = ta.rsi(close, lengthInput)\n\n//@variable Is `true` when the `rsi` crosses below 30, `false` otherwise.\nbool crossBelow = ta.crossunder(rsi, 30.0)\n\n// Plot the `rsi`.\nplot(rsi, \"RSI\", color.rgb(136, 76, 146), linewidth = 3)\n// Plot the `crossBelow` condition as circles near the top of the pane.\nplotshape(crossBelow, \"RSI crossed below 30\", shape.circle, location.top, color.red, size = size.small)</div>\n<p>Note that:</p>\n<ul>\n<li>The status line and Data Window show a value of 1 when\n<code dir=\"auto\">crossBelow</code> is <code dir=\"auto\">true</code> and 0 when it\u2019s <code dir=\"auto\">false</code>.</li>\n</ul>\n<p>Suppose we\u2019d like to display the shapes at <em>precise</em> locations rather\nthan relative to the chart pane. We can achieve this by using\n<a href=\"/pine-script-docs/v5/writing/debugging/#as-numbers\">conditional numbers</a> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.absolute\">location.absolute</a>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\ncall.</p>\n<p>In this example, we\u2019ve modified the previous script by creating a\n<code dir=\"auto\">debugNumber</code> variable that returns the <code dir=\"auto\">rsi</code> value when <code dir=\"auto\">crossBelow</code> is\n<code dir=\"auto\">true</code> and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\notherwise. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nfunction uses this new variable as its <code dir=\"auto\">series</code> argument and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.absolute\">location.absolute</a>\nas its <code dir=\"auto\">location</code> argument:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Plotting-conditional-shapes-2.Daveblc1_ZgMwC0.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional shapes demo\", \"RSI cross under 30\")\n\n//@variable The length of the RSI.\nint lengthInput = input.int(14, \"Length\", 1)\n\n//@variable The calculated RSI value.\nfloat rsi = ta.rsi(close, lengthInput)\n\n//@variable Is `true` when the `rsi` crosses below 30, `false` otherwise.\nbool crossBelow = ta.crossunder(rsi, 30.0)\n//@variable Returns the `rsi` when `crossBelow` is `true`, `na` otherwise.\nfloat debugNumber = crossBelow ? rsi : na\n\n// Plot the `rsi`.\nplot(rsi, \"RSI\", color.rgb(136, 76, 146), linewidth = 3)\n// Plot circles at the `debugNumber`.\nplotshape(debugNumber, \"RSI when it crossed below 30\", shape.circle, location.absolute, color.red, size = size.small)</div>\n<p>Note that:</p>\n<ul>\n<li>Since we passed a <em>numeric</em> series to the function, our\nconditional plot now shows the values of the <code dir=\"auto\">debugNumber</code> in\nthe status line and Data Window instead of 1 or 0.</li>\n</ul>\n<p>Another handy way to debug conditions is to use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>.\nThis function plots an arrow with a location relative to the <em>main chart\nprices</em> whenever the <code dir=\"auto\">series</code> argument is nonzero and not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>. The\nlength of each arrow varies with the <code dir=\"auto\">series</code> value supplied. As with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\ncan also display numeric results in the status line and the Data Window.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Since this function always positions arrows relative to the main chart\nprices, we recommend only using it if the script occupies the main chart\npane to avoid otherwise interfering with the scale.</p></div></aside>\n<p>This example shows an alternative way to inspect our <code dir=\"auto\">crossBelow</code>\ncondition using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>.\nIn this version, we\u2019ve set <code dir=\"auto\">overlay</code> to <code dir=\"auto\">true</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction and added a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>\ncall to visualize the conditional values. The <code dir=\"auto\">debugNumber</code> in this\nexample measures how far the <code dir=\"auto\">rsi</code> dropped below 30 each time the\ncondition occurs:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Plotting-conditional-shapes-3.IZzMwtM0_Z1HvpVm.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional shapes demo\", \"RSI cross under 30\", true)\n\n//@variable The length of the RSI.\nint lengthInput = input.int(14, \"Length\", 1)\n\n//@variable The calculated RSI value.\nfloat rsi = ta.rsi(close, lengthInput)\n\n//@variable Is `true` when the `rsi` crosses below 30, `false` otherwise.\nbool crossBelow = ta.crossunder(rsi, 30.0)\n//@variable Returns `rsi - 30.0` when `crossBelow` is `true`, `na` otherwise.\nfloat debugNumber = crossBelow ? rsi - 30.0 : na\n\n// Plot the `rsi`.\nplot(rsi, \"RSI\", color.rgb(136, 76, 146), display = display.data_window)\n// Plot circles at the `debugNumber`.\nplotarrow(debugNumber, \"RSI cross below 30 distnce\")</div>\n<p>Note that:</p>\n<ul>\n<li>We set the <code dir=\"auto\">display</code> value in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nof the <code dir=\"auto\">rsi</code> to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_display.data_window\">display.data_window</a>\nto\n<a href=\"/pine-script-docs/v5/writing/debugging/#without-affecting-the-scale\">preserve the chart\u2019s scale</a>.</li>\n</ul>\n<p>To learn more about\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a>,\nsee this manual\u2019s\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/\">Text and shapes</a>\npage.</p>\n<h3 class=\"md-heading\" id=\"conditional-colors\"><a href=\"#conditional-colors\">Conditional colors<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>An elegant way to visually represent conditions in Pine is to create\nexpressions that return\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>\nvalues based on <code dir=\"auto\">true</code> or <code dir=\"auto\">false</code> states, as scripts can use them to\ncontrol the appearance of\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing objects</a> or the results of <code dir=\"auto\">plot*()</code>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>\ncalls.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>As with <code dir=\"auto\">plot*()</code> functions, scripts can only call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>\nfrom the <em>global scope</em>, and the functions cannot accept any local\nvariables.</p></div></aside>\n<p>For example, this script calculates the change in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices over <code dir=\"auto\">lengthInput</code> bars and declares two \u201cbool\u201d variables to\nidentify when the price change is positive or negative.</p>\n<p>The script uses these \u201cbool\u201d values as conditions in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_?:\">ternary</a>\nexpressions to assign the values of three \u201ccolor\u201d variables, then uses\nthose variables as the <code dir=\"auto\">color</code> arguments in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>\nto debug the results:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Conditional-colors-1.B5Y6dhKf_Z1jtyTu.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional colors demo\", \"Price change colors\")\n\n//@variable The number of bars in the price change calculation.\nint lengthInput = input.int(10, \"Length\", 1)\n\n//@variable The change in `close` prices over `lengthInput` bars.\nfloat priceChange = ta.change(close, lengthInput)\n\n//@variable Is `true` when the `priceChange` is a positive value, `false` otherwise.\nbool isPositive = priceChange &gt; 0\n//@variable Is `true` when the `priceChange` is a negative value, `false` otherwise.\nbool isNegative = priceChange &lt; 0\n\n//@variable Returns a color for the `priceChange` plot to show when `isPositive`, `isNegative`, or neither occurs.\ncolor plotColor = isPositive ? color.teal : isNegative ? color.maroon : chart.fg_color\n//@variable Returns an 80% transparent color for the background when `isPositive` or `isNegative`, `na` otherwise.\ncolor bgColor = isPositive ? color.new(color.aqua, 80) : isNegative ? color.new(color.fuchsia, 80) : na\n//@variable Returns a color to emphasize chart bars when `isPositive` occurs. Otherwise, returns the `chart.bg_color`.\ncolor barColor = isPositive ? color.orange : chart.bg_color\n\n// Plot the `priceChange` and color it with the `plotColor`.\nplot(priceChange, \"Price change\", plotColor, style = plot.style_area)\n// Highlight the pane's background with the `bgColor`.\nbgcolor(bgColor, title = \"Background highlight\")\n// Emphasize the chart bars with positive price change using the `barColor`.\nbarcolor(barColor, title = \"Positive change bars\")</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_barcolor\">barcolor()</a>\nfunction always colors the main chart\u2019s bars, regardless of\nwhether the script occupies another chart pane, and the chart\nwill only display the results if the bars are visible.</li>\n</ul>\n<p>See the <a href=\"/pine-script-docs/v5/concepts/colors/\">Colors</a>,\n<a href=\"/pine-script-docs/v5/concepts/fills/\">Fills</a>,\n<a href=\"/pine-script-docs/v5/concepts/backgrounds/\">Backgrounds</a>, and\n<a href=\"/pine-script-docs/v5/concepts/bar-coloring/\">Bar coloring</a> pages for\nmore information about working with colors, filling plots, highlighting\nbackgrounds, and coloring bars.</p>\n<h3 class=\"md-heading\" id=\"using-drawings\"><a href=\"#using-drawings\">Using drawings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> provide flexible ways to visualize conditions on the chart,\nespecially when the conditions are within local scopes.</p>\n<p>Consider the following script, which calculates a custom <code dir=\"auto\">filter</code> with a\nsmoothing parameter (<code dir=\"auto\">alpha</code>) that changes its value within an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure based on recent\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_volume\">volume</a>\nconditions:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Using-drawings-1.bqLda39j_Z13aGwI.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional drawings demo\", \"Volume-based filter\", true)\n\n//@variable The number of bars in the volume average.\nint lengthInput = input.int(20, \"Volume average length\", 1)\n\n//@variable The average `volume` over `lengthInput` bars.\nfloat avgVolume = ta.sma(volume, lengthInput)\n\n//@variable A custom price filter based on volume activity.\nfloat filter = close\n//@variable The smoothing parameter of the filter calculation. Its value depends on multiple volume conditions.\nfloat alpha = na\n\n// Set the `alpha` to 1 if `volume` exceeds its `lengthInput`-bar moving average.\nif volume &gt; avgVolume\n    alpha := 1.0\n// Set the `alpha` to 0.5 if `volume` exceeds its previous value.\nelse if volume &gt; volume[1]\n    alpha := 0.5\n// Set the `alpha` to 0.01 otherwise.\nelse\n    alpha := 0.01\n\n// Calculate the new `filter` value.\nfilter := (1.0 - alpha) * nz(filter[1], filter) + alpha * close\n\n// Plot the `filter`.\nplot(filter, \"Filter\", linewidth = 3)</div>\n<p>Suppose we\u2019d like to inspect the conditions that control the <code dir=\"auto\">alpha</code>\nvalue. There are several ways we could approach the task with chart\nvisuals. However, some approaches will involve more code and careful\nhandling.</p>\n<p>For example, to visualize the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure\u2019s conditions using\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-conditional-shapes\">plotted shapes</a> or\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditional-colors\">background colors</a>, we\u2019d have to create additional variables or expressions in\nthe global scope for the <code dir=\"auto\">plot*()</code> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nfunctions to access.</p>\n<p>Alternatively, we can use\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> to visualize the conditions concisely without those extra\nsteps.</p>\n<p>The following is a modification of the previous script that calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\nwithin specific branches of the\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structure</a> to draw\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on the\nchart whenever those branches execute. These simple changes allow us to\nidentify those conditions on the chart without much extra code:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Using-drawings-2.6tfkMr81_1G1BSn.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Conditional drawings demo\", \"Volume-based filter\", true, max_labels_count = 500)\n\n//@variable The number of bars in the volume average.\nint lengthInput = input.int(20, \"Volume average length\", 1)\n\n//@variable The average `volume` over `lengthInput` bars.\nfloat avgVolume = ta.sma(volume, lengthInput)\n\n//@variable A custom price filter based on volume activity.\nfloat filter = close\n//@variable The smoothing parameter of the filter calculation. Its value depends on multiple volume conditions.\nfloat alpha = na\n\n// Set the `alpha` to 1 if `volume` exceeds its `lengthInput`-bar moving average.\nif volume &gt; avgVolume\n    // Add debug label.\n    label.new(chart.point.now(high), \"alpha = 1\", color = color.teal, textcolor = color.white)\n    alpha := 1.0\n// Set the `alpha` to 0.5 if `volume` exceeds its previous value.\nelse if volume &gt; volume[1]\n    // Add debug label.\n    label.new(chart.point.now(high), \"alpha = 0.5\", color = color.green, textcolor = color.white)\n    alpha := 0.5\n// Set the `alpha` to 0.01 otherwise.\nelse\n    alpha := 0.01\n\n// Calculate the new `filter` value.\nfilter := (1.0 - alpha) * nz(filter[1], filter) + alpha * close\n\n// Plot the `filter`.\nplot(filter, \"Filter\", linewidth = 3)</div>\n<p>Note that:</p>\n<ul>\n<li>We added the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\ncalls <em>above</em> the <code dir=\"auto\">alpha</code> reassignment expressions, as the\nreturned types of each branch in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure must match.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction includes <code dir=\"auto\">max_labels_count = 500</code> to specify that the\nscript can show up to 500\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on the chart.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"compound-and-nested-conditions\"><a href=\"#compound-and-nested-conditions\">Compound and nested conditions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a programmer needs to identify situations where more than one\ncondition can occur, they may construct <em>compound conditions</em> by\naggregating individual conditions with logical operators\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_and\">and</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_or\">or</a>).</p>\n<p>For example, this line of code shows a <code dir=\"auto\">compoundCondition</code> variable that\nonly returns <code dir=\"auto\">true</code> if <code dir=\"auto\">condition1</code> and either <code dir=\"auto\">condition2</code> or\n<code dir=\"auto\">condition3</code> occurs:</p>\n<div class=\"pine-colorizer not-content\">bool compoundCondition = condition1 and (condition2 or condition3)</div>\n<p>One may alternatively create <em>nested conditions</em> using\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_?:\">ternary\nexpressions</a>.\nFor example, this\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure assigns <code dir=\"auto\">true</code> to the <code dir=\"auto\">nestedCondition</code> variable if\n<code dir=\"auto\">condition1</code> and <code dir=\"auto\">condition2</code> or <code dir=\"auto\">condition3</code> occurs. However, unlike\nthe logical expression above, the branches of this structure also allow\nthe script to execute additional code before assigning the \u201cbool\u201d\nvalue:</p>\n<div class=\"pine-colorizer not-content\">bool nestedCondition = false\n\nif condition1\n    // [additional_code]\n    if condition2\n        // [additional_code]\n        nestedCondition := true\n    else if condition3\n        // [additional_code]\n        nestedCondition := true</div>\n<p>In either case, whether working with compound or nested conditions in\ncode, one will save many headaches and ensure they work as expected by\nvalidating the behaviors of the <em>individual conditions</em> that compose\nthem.</p>\n<p>For example, this script calculates an <code dir=\"auto\">rsi</code> and the <code dir=\"auto\">median</code> of the\n<code dir=\"auto\">rsi</code> over <code dir=\"auto\">lengthInput</code> bars. Then, it creates five variables to\nrepresent different singular conditions. The script uses these variables\nin a logical expression to assign a \u201cbool\u201d value to the\n<code dir=\"auto\">compoundCondition</code> variable, and it displays the results of the\n<code dir=\"auto\">compoundCondition</code> using a\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditional-colors\">conditional background color</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Compound-conditions-1.BIlbHbn5_Z1hVb8A.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Compound conditions demo\")\n\n//@variable The length of the RSI and median RSI calculations.\nint lengthInput = input.int(14, \"Length\", 2)\n\n//@variable The `lengthInput`-bar RSI.\nfloat rsi = ta.rsi(close, lengthInput)\n//@variable The `lengthInput`-bar median of the `rsi`.\nfloat median = ta.median(rsi, lengthInput)\n\n//@variable Condition #1: Is `true` when the 1-bar `rsi` change switches from 1 to -1.\nbool changeNegative = ta.change(math.sign(ta.change(rsi))) == -2\n//@variable Condition #2: Is `true` when the previous bar's `rsi` is greater than 70.\nbool prevAbove70 = rsi[1] &gt; 70.0\n//@variable Condition #3: Is `true` when the current `close` is lower than the previous bar's `open`.\nbool closeBelow = close &lt; open[1]\n//@variable Condition #4: Is `true` when the `rsi` is between 60 and 70.\nbool betweenLevels = bool(math.max(70.0 - rsi, 0.0) * math.max(rsi - 60.0, 0.0))\n//@variable Condition #5: Is `true` when the `rsi` is above the `median`.\nbool aboveMedian = rsi &gt; median\n\n//@variable Is `true` when the first condition occurs alongside conditions 2 and 3 or 4 and 5.\nbool compundCondition = changeNegative and ((prevAbove70 and closeBelow) or (betweenLevels and aboveMedian))\n\n//Plot the `rsi` and the `median`.\nplot(rsi, \"RSI\", color.rgb(201, 109, 34), 3)\nplot(median, \"RSI Median\", color.rgb(180, 160, 102), 2)\n\n// Highlight the background red when the `compundCondition` occurs.\nbgcolor(compundCondition ? color.new(color.red, 60) : na, title = \"compundCondition\")</div>\n<p>As we see above, it\u2019s not necessarily easy to understand the behavior\nof the <code dir=\"auto\">compoundCondition</code> by only visualizing its end result, as five\nunderlying singular conditions determine the final value. To effectively\ndebug the <code dir=\"auto\">compoundCondition</code> in this case, we must also inspect the\nconditions that compose it.</p>\n<p>In the example below, we\u2019ve added five\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\ncalls to display\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-conditional-shapes\">characters</a> on the chart and numeric values in the status line and Data\nWindow when each singular condition occurs. Inspecting each of these\nresults provides us with more complete information about the\n<code dir=\"auto\">compoundCondition</code>\u2019s behavior:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"590\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Conditions-Compound-conditions-2.CqS0Ugyz_Z181FHW.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Compound conditions demo\")\n\n//@variable The length of the RSI and median RSI calculations.\nint lengthInput = input.int(14, \"Length\", 2)\n\n//@variable The `lengthInput`-bar RSI.\nfloat rsi = ta.rsi(close, lengthInput)\n//@variable The `lengthInput`-bar median of the `rsi`.\nfloat median = ta.median(rsi, lengthInput)\n\n//@variable Condition #1: Is `true` when the 1-bar `rsi` change switches from 1 to -1.\nbool changeNegative = ta.change(math.sign(ta.change(rsi))) == -2\n//@variable Condition #2: Is `true` when the previous bar's `rsi` is greater than 70.\nbool prevAbove70 = rsi[1] &gt; 70.0\n//@variable Condition #3: Is `true` when the current `close` is lower than the previous bar's `open`.\nbool closeBelow = close &lt; open[1]\n//@variable Condition #4: Is `true` when the `rsi` is between 60 and 70.\nbool betweenLevels = bool(math.max(70.0 - rsi, 0.0) * math.max(rsi - 60.0, 0.0))\n//@variable Condition #5: Is `true` when the `rsi` is above the `median`.\nbool aboveMedian = rsi &gt; median\n\n//@variable Is `true` when the first condition occurs alongside conditions 2 and 3 or 4 and 5.\nbool compundCondition = changeNegative and ((prevAbove70 and closeBelow) or (betweenLevels and aboveMedian))\n\n//Plot the `rsi` and the `median`.\nplot(rsi, \"RSI\", color.rgb(201, 109, 34), 3)\nplot(median, \"RSI Median\", color.rgb(180, 160, 102), 2)\n\n// Highlight the background red when the `compundCondition` occurs.\nbgcolor(compundCondition ? color.new(color.red, 60) : na, title = \"compundCondition\")\n\n// Plot characters on the chart when conditions 1-5 occur.\nplotchar(changeNegative ? rsi : na, \"changeNegative (1)\", \"1\", location.absolute, chart.fg_color)\nplotchar(prevAbove70 ? 70.0 : na, \"prevAbove70 (2)\", \"2\", location.absolute, chart.fg_color)\nplotchar(closeBelow ? close : na, \"closeBelow (3)\", \"3\", location.bottom, chart.fg_color)\nplotchar(betweenLevels ? 60 : na, \"betweenLevels (4)\", \"4\", location.absolute, chart.fg_color)\nplotchar(aboveMedian ? median : na, \"aboveMedian (5)\", \"5\", location.absolute, chart.fg_color)</div>\n<p>Note that:</p>\n<ul>\n<li>Each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\ncall uses a\n<a href=\"/pine-script-docs/v5/writing/debugging/#as-numbers\">conditional number</a> as the <code dir=\"auto\">series</code> argument. The functions display the\nnumeric values in the status line and Data Window.</li>\n<li>All the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\ncalls, excluding the one for the <code dir=\"auto\">closeBelow</code> condition, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.absolute\">location.absolute</a>\nas the <code dir=\"auto\">location</code> argument to display characters at precise\nlocations whenever their <code dir=\"auto\">series</code> is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\n(i.e., the condition occurs). The call for <code dir=\"auto\">closeBelow</code> uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_location.bottom\">location.bottom</a>\nto display its characters near the bottom of the pane.</li>\n<li>In this section\u2019s examples, we assigned individual conditions\nto separate variables with straightforward names and\nannotations. While this format isn\u2019t required to create a\ncompound condition since one can combine conditions directly\nwithin a logical expression, it makes for more readable code\nthat\u2019s easier to debug, as explained in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#tips\">Tips</a>\nsection.</li>\n</ul>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"strings\"><a href=\"#strings\">Strings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"/pine-script-docs/v5/language/type-system/#string\">Strings</a>\nare sequences of alphanumeric, control, and other characters (e.g.,\nUnicode). They provide utility when debugging scripts, as programmers\ncan use them to represent a script\u2019s data types as human-readable text\nand inspect them with\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> that have text-related properties, or by using\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This section discusses \u201cstring\u201d conversions and inspecting strings via\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> and\n<a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a>.\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">Boxes</a> can also\ndisplay text. However, their utility for debugging strings is more\nlimited than the techniques covered in this section and the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>\nsection below.</p></div></aside>\n<h3 class=\"md-heading\" id=\"representing-other-types\"><a href=\"#representing-other-types\">Representing other types<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Users can create \u201cstring\u201d representations of virtually any data type,\nfacilitating effective debugging when other approaches may not suffice.\nBefore exploring \u201cstring\u201d inspection techniques, let\u2019s briefly review\nways to <em>represent</em> a script\u2019s data using strings.</p>\n<p>Pine Script includes predefined logic to construct \u201cstring\u201d\nrepresentations of several other built-in types, such as\n<a href=\"/pine-script-docs/v5/language/type-system/#int\">int</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#float\">float</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#bool\">bool</a>,\n<a href=\"/pine-script-docs/v5/language/arrays/\">array</a>, and\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrix</a>. Scripts can\nconveniently represent such types as strings via the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nfunctions.</p>\n<p>For example, this snippet creates strings to represent multiple values\nusing these functions:</p>\n<div class=\"pine-colorizer not-content\">//@variable Returns: \"1.25\"\nstring floatRepr = str.tostring(1.25)\n//@variable Returns: \"1\"\nstring rounded0 = str.tostring(1.25, \"#\")\n//@variable Returns: \"1.3\"\nstring rounded1 = str.tostring(1.25, \"#.#\")\n//@variable Returns: \"1.2500\"\nstring trailingZeros = str.tostring(1.25, \"#.0000\")\n//@variable Returns: \"true\"\nstring trueRepr = str.tostring(true)\n//@variable Returns: \"false\"\nstring falseRepr = str.tostring(5 == 3)\n//@variable Returns: \"[1, 2, -3.14]\"\nstring floatArrayRepr = str.tostring(array.from(1, 2.0, -3.14))\n//@variable Returns: \"[2, 20, 0]\"\nstring roundedArrayRepr = str.tostring(array.from(2.22, 19.6, -0.43), \"#\")\n//@variable Returns: \"[Hello, World, !]\"\nstring stringArrayRepr = str.tostring(array.from(\"Hello\", \"World\", \"!\"))\n//@variable Returns: \"Test: 2.718 ^ 2 &gt; 5: true\"\nstring mixedTypeRepr = str.format(\"{0}{1, number, #.###} ^ 2 &gt; {2}: {3}\", \"Test: \", math.e, 5, math.e * math.e &gt; 5)\n\n//@variable Combines all the above strings into a multi-line string.\nstring combined = str.format(\n     \"{0}\\n{1}\\n{2}\\n{3}\\n{4}\\n{5}\\n{6}\\n{7}\\n{8}\\n{9}\",\n     floatRepr, rounded0, rounded1, trailingZeros, trueRepr,\n     falseRepr, floatArrayRepr, roundedArrayRepr, stringArrayRepr,\n     mixedTypeRepr\n )</div>\n<p>When working with \u201cint\u201d values that symbolize UNIX timestamps, such as\nthose returned from time-related functions and variables, one can also\nuse\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format_time\">str.format_time()</a>\nto convert them to human-readable date strings. This code block\ndemonstrates multiple ways to convert a timestamp using these functions:</p>\n<div class=\"pine-colorizer not-content\">//@variable A UNIX timestamp, in milliseconds.\nint unixTime = 1279411200000\n\n//@variable Returns: \"2010-07-18T00:00:00+0000\"\nstring default = str.format_time(unixTime)\n//@variable Returns: \"2010-07-18\"\nstring ymdRepr = str.format_time(unixTime, \"yyyy-MM-dd\")\n//@variable Returns: \"07-18-2010\"\nstring mdyRepr = str.format_time(unixTime, \"MM-dd-yyyy\")\n//@variable Returns: \"20:00:00, 2010-07-17\"\nstring hmsymdRepr = str.format_time(unixTime, \"HH:mm:ss, yyyy-MM-dd\", \"America/New_York\")\n//@variable Returns: \"Year: 2010, Month: 07, Day: 18, Time: 12:00:00\"\nstring customFormat = str.format(\n     \"Year: {0, time, yyyy}, Month: {1, time, MM}, Day: {2, time, dd}, Time: {3, time, hh:mm:ss}\",\n     unixTime, unixTime, unixTime, unixTime\n )</div>\n<p>When working with types that <em>don\u2019t</em> have built-in \u201cstring\u201d\nrepresentations, e.g.,\n<a href=\"/pine-script-docs/v5/language/type-system/#color\">color</a>,\n<a href=\"/pine-script-docs/v5/language/maps/\">map</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>, etc., programmers can use custom logic or formatting to\nconstruct representations. For example, this code calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nto represent a \u201ccolor\u201d value using its\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.r\">r</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.g\">g</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.b\">b</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_color.t\">t</a>\ncomponents:</p>\n<div class=\"pine-colorizer not-content\">//@variable The built-in `color.maroon` value with 17% transparency.\ncolor myColor = color.new(color.maroon, 17)\n\n// Get the red, green, blue, and transparency components from `myColor`.\nfloat r = color.r(myColor)\nfloat g = color.g(myColor)\nfloat b = color.b(myColor)\nfloat t = color.t(myColor)\n\n//@variable Returns: \"color (r = 136, g = 14, b = 79, t = 17)\"\nstring customRepr = str.format(\"color (r = {0}, g = {1}, b = {2}, t = {3})\", r, g, b, t)</div>\n<p>There are countless ways one can represent data using strings. When\nchoosing string formats for debugging, ensure the results are\n<strong>readable</strong> and provide enough information for proper inspection. The\nfollowing segments explain ways to validate strings by displaying them\non the chart using <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>, and\nthe section after these segments explains how to display strings as\nmessages in the <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane.</p>\n<h3 class=\"md-heading\" id=\"using-labels\"><a href=\"#using-labels\">Using labels<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">Labels</a> allow\nscripts to display dynamic text (\u201cseries strings\u201d) at any available\nlocation on the chart. Where to display such text on the chart depends\non the information the programmer wants to inspect and their debugging\npreferences.</p>\n<h4 class=\"md-heading\" id=\"on-successive-bars\"><a href=\"#on-successive-bars\">On successive bars<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When inspecting the history of values that affect the chart\u2019s scale or\nworking with multiple series that have different types, a simple, handy\ndebugging approach is to draw\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> that\ndisplay\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representations</a> on successive bars.</p>\n<p>For example, this script calculates four series: <code dir=\"auto\">highestClose</code>,\n<code dir=\"auto\">percentRank</code>, <code dir=\"auto\">barsSinceHigh</code>, and <code dir=\"auto\">isLow</code>. It uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nto create a formatted \u201cstring\u201d representing the series values and a\ntimestamp, then it calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\nto draw a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nthat display the results at the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\non each bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"506\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Strings-Using-labels-On-successive-bars-1.QDEDvANn_xLWsm.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Labels on successive bars demo\", \"Inspecting multiple series\", true, max_labels_count = 500)\n\n//@variable The number of bars in the calculation window.\nint lengthInput = input.int(50, \"Length\", 1)\n\n//@variable The highest `close` over `lengthInput` bars.\nfloat highestClose = ta.highest(close, lengthInput)\n//@variable The percent rank of the current `close` compared to previous values over `lengthInput` bars.\nfloat percentRank = ta.percentrank(close, lengthInput)\n//@variable The number of bars since the `close` was equal to the `highestClose`.\nint barsSinceHigh = ta.barssince(close == highestClose)\n//@variable Is `true` when the `percentRank` is 0, i.e., when the `close` is the lowest.\nbool isLow = percentRank == 0.0\n\n//@variable A multi-line string representing the `time`, `highestClose`, `percentRank`, `barsSinceHigh`, and `isLow`.\nstring debugString = str.format(\n     \"time (GMT): {0, time, yyyy-MM-dd'T'HH:mm:ss}\\nhighestClose: {1, number, #.####}\n     \\npercentRank: {2, number, #.##}%\\nbarsSinceHigh: {3, number, integer}\\nisLow: {4}\",\n     time, highestClose, percentRank, barsSinceHigh, isLow\n )\n\n//@variable Draws a label showing the `debugString` at each bar's `high`.\nlabel debugLabel = label.new(chart.point.now(high), debugString, textcolor = color.white)</div>\n<p>While the above example allows one to inspect the results of the\nscript\u2019s series on any bar with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\ndrawing, consecutive drawings like these can clutter the chart,\nespecially when viewing longer strings.</p>\n<p>An alternative, more visually compact way to inspect successive bars\u2019\nvalues with <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> is to utilize the <code dir=\"auto\">tooltip</code> property instead of the <code dir=\"auto\">text</code>\nproperty, as a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nwill only show its tooltip when the cursor <em>hovers</em> over it.</p>\n<p>Below, we\u2019ve modified the previous script by using the <code dir=\"auto\">debugString</code> as\nthe <code dir=\"auto\">tooltip</code> argument instead of the <code dir=\"auto\">text</code> argument in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\ncall. Now, we can view the results on specific bars without the extra\nnoise:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"528\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Strings-Using-labels-On-successive-bars-2.GO5WpodJ_Z1KqWXN.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Tooltips on successive bars demo\", \"Inspecting multiple series\", true, max_labels_count = 500)\n\n//@variable The number of bars in the calculation window.\nint lengthInput = input.int(50, \"Length\", 1)\n\n//@variable The highest `close` over `lengthInput` bars.\nfloat highestClose = ta.highest(close, lengthInput)\n//@variable The percent rank of the current `close` compared to previous values over `lengthInput` bars.\nfloat percentRank = ta.percentrank(close, lengthInput)\n//@variable The number of bars since the `close` was equal to the `highestClose`.\nint barsSinceHigh = ta.barssince(close == highestClose)\n//@variable Is `true` when the `percentRank` is 0, i.e., when the `close` is the lowest.\nbool isLow = percentRank == 0.0\n\n//@variable A multi-line string representing the `time`, `highestClose`, `percentRank`, `barsSinceHigh`, and `isLow`.\nstring debugString = str.format(\n     \"time (GMT): {0, time, yyyy-MM-dd'T'HH:mm:ss}\\nhighestClose: {1, number, #.####}\n     \\npercentRank: {2, number, #.##}%\\nbarsSinceHigh: {3, number, integer}\\nisLow: {4}\",\n     time, highestClose, percentRank, barsSinceHigh, isLow\n )\n\n//@variable Draws a label showing the `debugString` in a tooltip at each bar's `high`.\nlabel debugLabel = label.new(chart.point.now(high), tooltip = debugString)</div>\n<p>It\u2019s important to note that a script can display up to 500\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\ndrawings, meaning the above examples will only allow users to inspect\nthe strings from the most recent 500 chart bars.</p>\n<p>If a programmer wants to see the results from <em>earlier</em> chart bars, one\napproach is to create conditional logic that only allows drawings within\na specific time range, e.g.:</p>\n<div class=\"pine-colorizer not-content\">if time &gt;= startTime and time &lt;= endTime\n    &lt;create_drawing_id&gt;</div>\n<p>If we use this structure in our previous example with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.left_visible_bar_time\">chart.left_visible_bar_time</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a>\nas the <code dir=\"auto\">startTime</code> and <code dir=\"auto\">endTime</code> values, the script will only create\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on\n<strong>visible chart bars</strong> and avoid drawing on others. With this logic, we\ncan scroll to view labels on <em>any</em> chart bar, as long as there are up to\n<code dir=\"auto\">max_labels_count</code> bars in the visible range:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Strings-Using-labels-On-successive-bars-3.Dr46dKLS_Z1WAyIK.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Tooltips on visible bars demo\", \"Inspecting multiple series\", true, max_labels_count = 500)\n\n//@variable The number of bars in the calculation window.\nint lengthInput = input.int(50, \"Length\", 1)\n\n//@variable The highest `close` over `lengthInput` bars.\nfloat highestClose = ta.highest(close, lengthInput)\n//@variable The percent rank of the current `close` compared to previous values over `lengthInput` bars.\nfloat percentRank = ta.percentrank(close, lengthInput)\n//@variable The number of bars since the `close` was equal to the `highestClose`.\nint barsSinceHigh = ta.barssince(close == highestClose)\n//@variable Is `true` when the `percentRank` is 0, i.e., when the `close` is the lowest.\nbool isLow = percentRank == 0.0\n\n//@variable A multi-line string representing the `time`, `highestClose`, `percentRank`, `barsSinceHigh`, and `isLow`.\nstring debugString = str.format(\n     \"time (GMT): {0, time, yyyy-MM-dd'T'HH:mm:ss}\\nhighestClose: {1, number, #.####}\n     \\npercentRank: {2, number, #.##}%\\nbarsSinceHigh: {3, number, integer}\\nisLow: {4}\",\n     time, highestClose, percentRank, barsSinceHigh, isLow\n )\n\nif time &gt;= chart.left_visible_bar_time and time &lt;= chart.right_visible_bar_time\n    //@variable Draws a label showing the `debugString` in a tooltip at each visible bar's `high`.\n    label debugLabel = label.new(chart.point.now(high), tooltip = debugString)</div>\n<p>Note that:</p>\n<ul>\n<li>If the visible chart contains more bars than allowed drawings,\nthe script will only show results on the latest bars in the\nvisible range. For best results with this technique, zoom on the\nchart to keep the visible range limited to the allowed number of\ndrawings.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"at-the-end-of-the-chart\"><a href=\"#at-the-end-of-the-chart\">At the end of the chart<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>A frequent approach to debugging a script\u2019s strings with\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> is to\ndisplay them at the <em>end</em> of the chart, namely when the strings do not\nchange or when only a specific bar\u2019s values require analysis.</p>\n<p>The script below contains a user-defined <code dir=\"auto\">printLabel()</code> function that\ndraws a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nat the last available time on the chart, regardless of when the script\ncalls it. We\u2019ve used the function in this example to display a \u201cHello\nworld!\u201d string, some basic chart information, and the data feed\u2019s\ncurrent OHLCV values:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Strings-Using-labels-At-the-end-of-the-chart-1.C-6hYXkR_Z1lpCgi.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Labels at the end of the chart demo\", \"Chart info\", true)\n\n//@function     Draws a label to print the `txt` at the last available time on the chart.\n//              When called from the global scope, the label updates its text using the specified `txt` on every bar.\n//@param txt    The string to display on the chart.\n//@param price  The optional y-axis location of the label. If not specified, draws the label above the last chart bar.\n//@returns      The resulting label ID.\nprintLabel(string txt, float price = na) =&gt;\n    int labelTime = math.max(last_bar_time, chart.right_visible_bar_time)\n    var label result = label.new(\n         labelTime, na, txt, xloc.bar_time, na(price) ? yloc.abovebar : yloc.price, na,\n         label.style_none, chart.fg_color, size.large\n     )\n    label.set_text(result, txt)\n    label.set_y(result, price)\n    result\n\n//@variable A formatted string containing information about the current chart.\nstring chartInfo = str.format(\n     \"Symbol: {0}:{1}\\nTimeframe: {2}\\nStandard chart: {3}\\nReplay active: {4}\",\n     syminfo.prefix, syminfo.ticker, timeframe.period, chart.is_standard,\n     str.contains(syminfo.tickerid, \"replay\")\n )\n\n//@variable A formatted string containing OHLCV values.\nstring ohlcvInfo = str.format(\n     \"O: {0, number, #.#####}, H: {1, number, #.#####}, L: {2, number, #.#####}, C: {3, number, #.#####}, V: {4}\",\n     open, high, low, close, str.tostring(volume, format.volume)\n )\n\n// Print \"Hello world!\" and the `chartInfo` at the end of the chart on the first bar.\nif barstate.isfirst\n    printLabel(\"Hello world!\" + \"\\n\\n\\n\\n\\n\\n\\n\")\n    printLabel(chartInfo + \"\\n\\n\")\n\n// Print current `ohlcvInfo` at the end of the chart, updating the displayed text as new data comes in.\nprintLabel(ohlcvInfo)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">printLabel()</code> function sets the x-coordinate of the drawn\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nusing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.max\">max</a>\nof the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_last_bar_time\">last_bar_time</a>\nand the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_chart.right_visible_bar_time\">chart.right_visible_bar_time</a>\nto ensure it always shows the results at the last available bar.</li>\n<li>When called from the <em>global scope</em>, the function creates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nwith <code dir=\"auto\">text</code> and <code dir=\"auto\">y</code> properties that update on every bar.</li>\n<li>We\u2019ve made three calls to the function and added linefeed\ncharacters (<code dir=\"auto\">\\n</code>) to demonstrate that users can superimpose the\nresults from multiple\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> at the end of the chart if the strings have adequate\nline spacing.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"using-tables\"><a href=\"#using-tables\">Using tables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a> display strings\nwithin cells arranged in columns and rows at fixed locations relative to\na chart pane\u2019s visual space. They can serve as versatile chart-based\ndebugging tools, as unlike\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a>, they\nallow programmers to inspect one or <em>more</em> \u201cseries strings\u201d in an\norganized visual structure agnostic to the chart\u2019s scale or bar index.</p>\n<p>For example, this script calculates a custom <code dir=\"auto\">filter</code> whose result is\nthe ratio of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.ema\">EMA</a>\nof weighted\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.ema\">EMA</a>\nof the <code dir=\"auto\">weight</code> series. For inspection of the variables used in the\ncalculation, it creates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\ninstance on the first bar, initializes the table\u2019s cells on the last\nhistorical bar, then updates necessary cells with \u201cstring\u201d\nrepresentations of the values from <code dir=\"auto\">barsBack</code> bars ago on the latest\nchart bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Strings-Using-tables-1.Bfvract8_Z20ywVF.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debugging with tables demo\", \"History inspection\", true)\n\n//@variable The number of bars back in the chart's history to inspect.\nint barsBack = input.int(10, \"Bars back\", 0, 4999)\n\n//@variable The percent rank of `volume` over 10 bars.\nfloat weight = ta.percentrank(volume, 10)\n//@variable The 10-bar EMA of `weight * close` values.\nfloat numerator = ta.ema(weight * close, 10)\n//@variable The 10-bar EMA of `weight` values.\nfloat denominator = ta.ema(weight, 10)\n//@variable The ratio of the `numerator` to the `denominator`.\nfloat filter = numerator / denominator\n\n// Plot the `filter`.\nplot(filter, \"Custom filter\")\n\n//@variable The color of the frame, border, and text in the `debugTable`.\ncolor tableColor = chart.fg_color\n\n//@variable A table that contains \"string\" representations of variable names and values on the latest chart bar.\nvar table debugTable = table.new(\n     position.top_right, 2, 5, frame_color = tableColor, frame_width = 1, border_color = tableColor, border_width = 1\n )\n\n// Initialize cells on the last confirmed historical bar.\nif barstate.islastconfirmedhistory\n    table.cell(debugTable, 0, 0, \"Variable\", text_color = tableColor)\n    table.cell(debugTable, 1, 0, str.format(\"Value {0, number, integer} bars ago\", barsBack), text_color = tableColor)\n    table.cell(debugTable, 0, 1, \"weight\", text_color = tableColor)\n    table.cell(debugTable, 1, 1, \"\", text_color = tableColor)\n    table.cell(debugTable, 0, 2, \"numerator\", text_color = tableColor)\n    table.cell(debugTable, 1, 2, \"\", text_color = tableColor)\n    table.cell(debugTable, 0, 3, \"denominator\", text_color = tableColor)\n    table.cell(debugTable, 1, 3, \"\", text_color = tableColor)\n    table.cell(debugTable, 0, 4, \"filter\", text_color = tableColor)\n    table.cell(debugTable, 1, 4, \"\", text_color = tableColor)\n\n// Update value cells on the last available bar.\nif barstate.islast\n    table.cell_set_text(debugTable, 1, 1, str.tostring(weight[barsBack], format.percent))\n    table.cell_set_text(debugTable, 1, 2, str.tostring(numerator[barsBack]))\n    table.cell_set_text(debugTable, 1, 3, str.tostring(denominator[barsBack]))\n    table.cell_set_text(debugTable, 1, 4, str.tostring(filter[barsBack]))</div>\n<p>Note that:</p>\n<ul>\n<li>The script uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to specify that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nassigned to the <code dir=\"auto\">debugTable</code> variable on the first bar persists\nthroughout the script\u2019s execution.</li>\n<li>This script modifies the table within two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructures. The first structure initializes the cells with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.cell\">table.cell()</a>\nonly on the last confirmed historical bar\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islastconfirmedhistory\">barstate.islastconfirmedhistory</a>).\nThe second structure updates the <code dir=\"auto\">text</code> properties of relevant\ncells with\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representations</a> of our variables\u2019 values using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table.cell_set_text\">table.cell_set_text()</a>\ncalls on the latest available bar\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">barstate.islast</a>).</li>\n</ul>\n<p>It\u2019s important to note that although tables can provide debugging\nutility, namely when working with multiple series or creating on-chart\nlogs, they carry a higher computational cost than other techniques\ndiscussed on this page and may require <em>more code</em>. Additionally, unlike\n<a href=\"/pine-script-docs/v5/writing/debugging/#using-labels\">labels</a>, one can only view a table\u2019s state from the latest script\nexecution. We therefore recommend using them <em>wisely</em> and <em>sparingly</em>\nwhile debugging, opting for <em>simplified</em> approaches where possible. For\nmore information about using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nobjects, see the <a href=\"/pine-script-docs/v5/concepts/tables/\">Tables</a>\npage.</p>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"pine-logs\"><a href=\"#pine-logs\">Pine Logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Logs are <em>interactive messages</em> that scripts can output at specific\npoints in their execution. They provide a powerful way for programmers\nto inspect a script\u2019s data, conditions, and execution flow with minimal\ncode.</p>\n<p>Unlike the other tools discussed on this page, Pine Logs have a\ndeliberate design for in-depth script debugging. Scripts do not display\nPine Logs on the chart or in the Data Window. Instead, they print\nmessages with timestamps in the dedicated <em>Pine Logs pane</em>, which\nprovides specialized navigation features and filtering options.</p>\n<p>To access the Pine Logs pane, select \u201cPine Logs\u2026\u201d from the\nEditor\u2019s \u201cMore\u201d menu or from the \u201cMore\u201d menu of a script loaded on\nthe chart that uses <code dir=\"auto\">log.*()</code> functions:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"296\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-1.D3YhPfKI_1eBx6z.webp\" width=\"720\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Only <strong>personal scripts</strong> can generate Pine Logs. A published script\n<em>cannot</em> create logs, even if it has <code dir=\"auto\">log.*()</code> function calls in its\ncode. One must consider alternative approaches, such as those outlined\nin the sections above, when\n<a href=\"/pine-script-docs/v5/writing/publishing/\">publishing scripts</a> with\ndebugging functionality.</p></div></aside>\n<h3 class=\"md-heading\" id=\"creating-logs\"><a href=\"#creating-logs\">Creating logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can create logs by calling the functions in the <code dir=\"auto\">log.*()</code>\nnamespace.</p>\n<p>All <code dir=\"auto\">log.*()</code> functions have the following signatures:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">log.*(message) \u2192 void</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">log.*(formatString, arg0, arg1, ...) \u2192 void</span></div></div></code></pre></figure></link></div>\n<p>The first overload logs a specified <code dir=\"auto\">message</code> in the Pine Logs pane. The\nsecond overload is similar to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>,\nas it logs a formatted message based on the <code dir=\"auto\">formatString</code> and the\nadditional arguments supplied in the call.</p>\n<p>Each <code dir=\"auto\">log.*()</code> function has a different <em>debug level</em>, allowing\nprogrammers to categorize and\n<a href=\"/pine-script-docs/v5/writing/debugging/#filtering-logs\">filter</a> results shown in the pane:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\nfunction logs an entry with the <em>\u201cinfo\u201d</em> level that appears in the\npane with gray text.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.warning\">log.warning()</a>\nfunction logs an entry with the <em>\u201cwarning\u201d</em> level that appears in\nthe pane with orange text.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.error\">log.error()</a>\nfunction logs an entry with the <em>\u201cerror\u201d</em> level that appears in\nthe pane with red text.</li>\n</ul>\n<p>This code demonstrates the difference between all three <code dir=\"auto\">log.*()</code>\nfunctions. It calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.warning\">log.warning()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.error\">log.error()</a>\non the first available bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"428\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Creating-logs-1.B6M1BlvN_1OBeQe.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debug levels demo\", overlay = true)\n\nif barstate.isfirst\n    log.info(\"This is an 'info' message.\")\n    log.warning(\"This is a 'warning' message.\")\n    log.error(\"This is an 'error' message.\")</div>\n<p>Pine Logs can execute anywhere within a script\u2019s execution. They allow\nprogrammers to track information from historical bars and monitor how\ntheir scripts behave on realtime, <em>unconfirmed</em> bars. When executing on\nhistorical bars, scripts generate a new message once for each <code dir=\"auto\">log.*()</code>\ncall on a bar. On realtime bars, calls to <code dir=\"auto\">log.*()</code> functions can create\nnew entries on <em>each new tick</em>.</p>\n<p>For example, this script calculates the average ratio between each\nbar\u2019s <code dir=\"auto\">close - open</code> value to its <code dir=\"auto\">high - low</code> range. When the\n<code dir=\"auto\">denominator</code> is nonzero, the script calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\nto print the values of the calculation\u2019s variables on confirmed bars\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.warning\">log.warning()</a>\nto print the values on unconfirmed bars. Otherwise, it uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.error\">log.error()</a>\nto indicate that division by zero occurred, as such cases can affect the\n<code dir=\"auto\">average</code> result:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"666\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Creating-logs-2.DgOgH4xb_ZRjj9G.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Logging historical and realtime data demo\", \"Average bar ratio\")\n\n//@variable The current bar's change from the `open` to `close`.\nfloat numerator = close - open\n//@variable The current bar's `low` to `high` range.\nfloat denominator = high - low\n//@variable The ratio of the bar's open-to-close range to its full range.\nfloat ratio = numerator / denominator\n//@variable The average `ratio` over 10 non-na values.\nfloat average = ta.sma(ratio, 10)\n\n// Plot the `average`.\nplot(average, \"average\", color.purple, 3)\n\nif barstate.isconfirmed\n    // Log a division by zero error if the `denominator` is 0.\n    if denominator == 0.0\n        log.error(\"Division by 0 in confirmed results!\")\n    // Otherwise, log the confirmed values.\n    else\n        log.info(\n             \"Values (confirmed):\\nnumerator: {1, number, #.########}\\ndenominator: {2, number, #.########}\n             \\nratio: {0, number, #.########}\\naverage: {3, number, #.########}\",\n             ratio, numerator, denominator, average\n         )\nelse\n    // Log a division by zero error if the `denominator` is 0.\n    if denominator == 0.0\n        log.error(\"Division by 0 on unconfirmed bar.\")\n    // Otherwise, log the unconfirmed values.\n    else\n        log.warning(\n             \"Values (unconfirmed):\\nnumerator: {1, number, #.########}\\ndenominator: {2, number, #.########}\n             \\nratio: {0, number, #.########}\\naverage: {3, number, #.########}\",\n             ratio, numerator, denominator, average\n         )</div>\n<p>Note that:</p>\n<ul>\n<li>Pine Logs <em>do not roll back</em> on each tick in an unconfirmed bar,\nmeaning the results for those ticks show in the pane until the\nscript restarts its execution. To only log messages on\n<em>confirmed</em> bars, use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isconfirmed\">barstate.isconfirmed</a>\nin the conditions that trigger a <code dir=\"auto\">log.*()</code> call.</li>\n<li>When logging on unconfirmed bars, we recommend ensuring those\nlogs contain <em>unique information</em> or use different <em>debug\nlevels</em> so you can\n<a href=\"/pine-script-docs/v5/writing/debugging/#filtering-logs\">filter</a> the results as needed.</li>\n<li>The Pine Logs pane will show up to the most recent 10,000\nentries for historical bars. If a script generates more than\n10,000 logs on historical bars and a programmer needs to view\nearlier entries, they can use conditional logic to limit\n<code dir=\"auto\">log.*()</code> calls to specific occurrences. See\n<a href=\"/pine-script-docs/v5/writing/debugging/#using-inputs\">this</a> section for an example that limits log generation to\na user-specified time range.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"inspecting-logs\"><a href=\"#inspecting-logs\">Inspecting logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Logs include some helpful features that simplify the inspection\nprocess. Whenever a script generates a log, it automatically prefixes\nthe message with a granular timestamp to signify where the log event\noccurred in the time series. Additionally, each entry contains\n<strong>\u201cSource code\u201d</strong> and <strong>\u201cScroll to bar\u201d</strong> icons, which appear when\nhovering over it in the Pine Logs pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"470\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Inspecting-logs-1.CEw5SsHB_27329j.webp\" width=\"1342\"/></p>\n<p>Clicking an entry\u2019s \u201cSource code\u201d icon opens the script in the Pine\nEditor and highlights the specific line of code that triggered the log:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"434\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Inspecting-logs-2.1cfqckmg_1omSJk.webp\" width=\"1342\"/></p>\n<p>Clicking an entry\u2019s \u201cScroll to bar\u201d icon navigates the chart to the\nspecific bar where the log occurred, then temporarily displays a tooltip\ncontaining time information for that bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"560\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Inspecting-logs-3.AJrWQdc2_ZHsjQK.webp\" width=\"1342\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The time information in the tooltip depends on the chart\u2019s\ntimeframe, just like the x-axis label linked to the chart\u2019s\ncursor and drawing tools. For example, the tooltip on an EOD\nchart will only show the weekday and the date, whereas the\ntooltip on a 10-second chart will also contain the time of day,\nincluding seconds.</li>\n</ul>\n<p>When a chart includes more than one script that generates logs, it\u2019s\nimportant to note that each script maintains its own <em>independent</em>\nmessage history. To inspect the messages from a specific script when\nmultiple are on the chart, select its title from the dropdown at the top\nof the Pine Logs pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"374\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Inspecting-logs-4.CY8OpkgY_Z10JTlu.webp\" width=\"1342\"/></p>\n<h3 class=\"md-heading\" id=\"filtering-logs\"><a href=\"#filtering-logs\">Filtering logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A single script can generate numerous logs, depending on the conditions\nthat trigger its <code dir=\"auto\">log.*()</code> calls. While directly scrolling through the\nlog history to find specific entries may suffice when a script only\ngenerates a few, it can become unwieldy when searching through hundreds\nor thousands of messages.</p>\n<p>The Pine Logs pane includes multiple options for filtering messages,\nwhich allows one to simplify their results by isolating specific\n<em>character sequences</em>, <em>start times</em>, and <em>debug levels</em>.</p>\n<p>Clicking the \u201cSearch\u201d icon at the top of the pane opens a search bar,\nwhich matches text to filter logged messages. The search filter also\nhighlights the matched portion of each message in blue for visual\nreference. For example, here, we entered \u201cconfirmed\u201d to match all\nresults generated by our previous script with the word somewhere in\ntheir text:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-1.Bo6VZioU_Cbru5.webp\" width=\"1342\"/></p>\n<p>Notice that the results from this search also considered messages with\n<em>\u201cunconfirmed\u201d</em> as matches since the word contains our query. We can\nomit these matches by selecting the \u201cWhole Word\u201d checkbox in the\noptions at the right of the search bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-2.75PYAT31_Z8HPfP.webp\" width=\"1342\"/></p>\n<p>This filter also supports <a href=\"https://en.wikipedia.org/wiki/Regular_expression\" rel=\"nofollow\">regular expressions\n(regex)</a>, which allow\nusers to perform advanced searches that match custom <em>character\npatterns</em> when selecting the \u201cRegex\u201d checkbox in the search options.\nFor example, this regex matches all entries that contain \u201caverage\u201d\nfollowed by a sequence representing a number greater than 0.5 and less\nthan or equal to 1:</p>\n<p><code dir=\"auto\">average:\\s*(0\\.[6-9]\\d*|0\\.5\\d*[1-9]\\d*|1\\.0*)</code></p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-3.C8CgIgDR_ZwuDXw.webp\" width=\"1342\"/></p>\n<p>Clicking the \u201cStart date\u201d icon opens a dialog that allows users to\nspecify the date and time of the first log shown in the results:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"566\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-4.ByHNqBMd_1OJ3LK.webp\" width=\"1342\"/></p>\n<p>After specifying the starting point, a tag containing the starting time\nwill appear above the log history:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"388\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-5.Dv8F4vq1_1DX0la.webp\" width=\"1342\"/></p>\n<p>Users can filter results by <em>debug level</em> using the checkboxes available\nwhen selecting the rightmost icon in the filtering options. Here, we\u2019ve\ndeactivated the \u201cinfo\u201d and \u201cwarning\u201d levels so the results will only\ncontain \u201cerror\u201d messages:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-6.CJM074om_Z1UkF5.webp\" width=\"1342\"/></p>\n<h4 class=\"md-heading\" id=\"using-inputs\"><a href=\"#using-inputs\">Using inputs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Another, more involved way to interactively filter a script\u2019s logged\nresults is to create <a href=\"/pine-script-docs/v5/concepts/inputs/\">inputs</a>\nlinked to conditional logic that activates specific <code dir=\"auto\">log.*()</code> calls in\nthe code.</p>\n<p>Let\u2019s look at an example. This code calculates an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rma\">RMA</a>\nof\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices and declares a few unique conditions to form a\n<a href=\"/pine-script-docs/v5/writing/debugging/#compound-and-nested-conditions\">compound condition</a>. The script uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\nto display important debugging information in the Pine Logs pane,\nincluding the values of the <code dir=\"auto\">compoundCondition</code> variable and the\n\u201cbool\u201d variables that determine its result.</p>\n<p>We declared the <code dir=\"auto\">filterLogsInput</code>, <code dir=\"auto\">logStartInput</code>, and <code dir=\"auto\">logEndInput</code>\nvariables respectively assigned to an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.bool\">input.bool()</a>\nand two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a>\ncalls for custom log filtering. When <code dir=\"auto\">filterLogsInput</code> is <code dir=\"auto\">true</code>, the\nscript will only generate a new log if the bar\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_time\">time</a>\nis between the <code dir=\"auto\">logStartInput</code> and <code dir=\"auto\">logEndInput</code> values, allowing us to\ninteractively isolate the entries that occurred within a specific time\nrange:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"524\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Pine-logs-Filtering-logs-Using-inputs-1.BCr7IdYS_ZmAWLn.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Filtering logs using inputs demo\", \"Compound condition in input range\", true)\n\n//@variable The length for moving average calculations.\nint lengthInput = input.int(20, \"Length\", 2)\n\n//@variable If `true`, only allows logs within the input time range.\nbool filterLogsInput = input.bool(true, \"Only log in time range\", group = \"Log filter\")\n//@variable The starting time for logs if `filterLogsInput` is `true`.\nint logStartInput = input.time(0, \"Start time\", group = \"Log filter\", confirm = true)\n//@variable The ending time for logs if `filterLogsInput` is `true`.\nint logEndInput = input.time(0, \"End time\", group = \"Log filter\", confirm = true)\n\n//@variable The RMA of `close` prices.\nfloat rma = ta.rma(close, lengthInput)\n\n//@variable Is `true` when `close` exceeds the `rma`.\nbool priceBelow = close &lt;= rma\n//@variable Is `true` when the current `close` is greater than the max of the previous `hl2` and `close`.\nbool priceRising = close &gt; math.max(hl2[1], close[1])\n//@variable Is `true` when the `rma` is positively accelerating.\nbool rmaAccelerating = rma - 2.0 * rma[1] + rma[2] &gt; 0.0\n//@variable Is `true` when the difference between `rma` and `close` exceeds 2 times the current ATR.\nbool closeAtThreshold = rma - close &gt; ta.atr(lengthInput) * 2.0\n//@variable Is `true` when all the above conditions occur.\nbool compoundCondition = priceBelow and priceRising and rmaAccelerating and closeAtThreshold\n\n// Plot the `rma`.\nplot(rma, \"RMA\", color.teal, 3)\n// Highlight the chart background when the `compoundCondition` occurs.\nbgcolor(compoundCondition ? color.new(color.aqua, 80) : na, title = \"Compound condition highlight\")\n\n//@variable If `filterLogsInput` is `true`, is only `true` in the input time range. Otherwise, always `true`.\nbool showLog = filterLogsInput ? time &gt;= logStartInput and time &lt;= logEndInput : true\n\n// Log results for a confirmed bar when `showLog` is `true`.\nif barstate.isconfirmed and showLog\n    log.info(\n         \"\\nclose: {0, number, #.#####}\\nrma: {1, number, #.#####}\\npriceBelow: {2}\\npriceRising: {3}\n         \\nrmaAccelerating: {4}\\ncloseAtThreshold: {5}\\n\\ncompoundCondition: {6}\",\n         close, rma, priceBelow, priceRising, rmaAccelerating, closeAtThreshold, compoundCondition\n     )</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">input.*()</code> functions assigned to the <code dir=\"auto\">filterLogsInput</code>,\n<code dir=\"auto\">logStartInput</code>, and <code dir=\"auto\">logEndInput</code> variables include a <code dir=\"auto\">group</code>\nargument to oragnize and distinguish them in the script\u2019s\nsettings.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.time\">input.time()</a>\ncalls include <code dir=\"auto\">confirm = true</code> so that we can interactively set\nthe start and end times directly on the chart. To reset the\ninputs, select \u201cReset points\u2026\u201d from the options in the\nscript\u2019s \u201cMore\u201d menu.</li>\n<li>The condition that triggers each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\ncall includes\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isconfirmed\">barstate.isconfirmed</a>\nto limit log generation to <em>confirmed</em> bars.</li>\n</ul>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"debugging-functions\"><a href=\"#debugging-functions\">Debugging functions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"/pine-script-docs/v5/language/user-defined-functions/\">User-defined functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nare custom functions written by users. They encapsulate sequences of\noperations that a script can invoke later in its execution.</p>\n<p>Every\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\nhas a <em>local scope</em> that embeds into the script\u2019s global scope. The\nparameters in a function\u2019s signature and the variables declared within\nthe function body belong to that function\u2019s local scope, and they are\n<em>not</em> directly accessible to a script\u2019s outer scope or the scopes of\nother functions.</p>\n<p>The segments below explain a few ways programmers can debug the values\nfrom a function\u2019s local scope. We will use this script as the starting\npoint for our subsequent examples. It contains a <code dir=\"auto\">customMA()</code> function\nthat returns an exponential moving average whose smoothing parameter\nvaries based on the <code dir=\"auto\">source</code> distance outside the 25th and 75th\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.percentile_linear_interpolation\">percentiles</a>\nover <code dir=\"auto\">length</code> bars:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-functions-1.C82H9E7R_Z1zqdTD.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debugging functions demo\", \"Custom MA\", true)\n\n//@variable The number of bars in the `customMA()` calculation.\nint lengthInput = input.int(50, \"Length\", 2)\n\n//@function      Calculates a moving average that only responds to values outside the first and third quartiles.\n//@param source  The series of values to process.\n//@param length  The number of bars in the calculation.\n//@returns       The moving average value.\ncustomMA(float source, int length) =&gt;\n    //@variable The custom moving average.\n    var float result = na\n    // Calculate the 25th and 75th `source` percentiles.\n    float q1 = ta.percentile_linear_interpolation(source, length, 25)\n    float q3 = ta.percentile_linear_interpolation(source, length, 75)\n    // Calculate the range values.\n    float outerRange = math.max(source - q3, q1 - source, 0.0)\n    float totalRange = ta.range(source, length)\n    //@variable Half the ratio of the `outerRange` to the `totalRange`.\n    float alpha = 0.5 * outerRange / totalRange\n    // Mix the `source` with the `result` based on the `alpha` value.\n    result := (1.0 - alpha) * nz(result, source) + alpha * source\n    // Return the `result`.\n    result\n\n//@variable The `customMA()` result over `lengthInput` bars.\nfloat maValue = customMA(close, lengthInput)\n\n// Plot the `maValue`.\nplot(maValue, \"Custom MA\", color.blue, 3)</div>\n<h3 class=\"md-heading\" id=\"extracting-local-variables\"><a href=\"#extracting-local-variables\">Extracting local variables<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a programmer wants to inspect a\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function\u2019s</a> local variables by\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-numbers\">plotting</a> its values,\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditional-colors\">coloring</a> the background or chart bars, etc., they must <em>extract</em> the\nvalues to the <em>global scope</em>, as the built-in functions that produce\nsuch outputs can only accept global variables and literals.</p>\n<p>Since the values returned by a function are available to the scope where\na call occurs, one straightforward extraction approach is to have the\nfunction return a <a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> containing all the values that need inspection.</p>\n<p>Here, we\u2019ve modified the <code dir=\"auto\">customMA()</code> function to return a\n<a href=\"/pine-script-docs/v5/language/type-system/#tuples\">tuple</a> containing\nall the function\u2019s calculated variables. Now, we can call the function\nwith a <em>tuple declaration</em> to make the values available in the global\nscope and inspect them with\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-numbers\">plots</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-functions-Extracting-local-variables-1.Crv6Jvx8_Z2qevgh.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Extracting local variables with tuples demo\", \"Custom MA\", true)\n\n//@variable The number of bars in the `customMA()` calculation.\nint lengthInput = input.int(50, \"Length\", 2)\n\n//@function      Calculates a moving average that only responds to values outside the first and third quartiles.\n//@param source  The series of values to process.\n//@param length  The number of bars in the calculation.\n//@returns       The moving average value.\ncustomMA(float source, int length) =&gt;\n    //@variable The custom moving average.\n    var float result = na\n    // Calculate the 25th and 75th `source` percentiles.\n    float q1 = ta.percentile_linear_interpolation(source, length, 25)\n    float q3 = ta.percentile_linear_interpolation(source, length, 75)\n    // Calculate the range values.\n    float outerRange = math.max(source - q3, q1 - source, 0.0)\n    float totalRange = ta.range(source, length)\n    //@variable Half the ratio of the `outerRange` to the `totalRange`.\n    float alpha = 0.5 * outerRange / totalRange\n    // Mix the `source` with the `result` based on the `alpha` value.\n    result := (1.0 - alpha) * nz(result, source) + alpha * source\n    // Return a tuple containing the `result` and other local variables.\n    [result, q1, q3, outerRange, totalRange, alpha]\n\n// Declare a tuple containing all values returned by `customMA()`.\n[maValue, q1Debug, q3Debug, outerRangeDebug, totalRangeDebug, alphaDebug] = customMA(close, lengthInput)\n\n// Plot the `maValue`.\nplot(maValue, \"Custom MA\", color.blue, 3)\n\n//@variable Display location for plots with different scale.\nnotOnPane = display.all - display.pane\n\n// Display the extracted `q1` and `q3` values in all plot locations.\nplot(q1Debug, \"q1\", color.new(color.maroon, 50))\nplot(q3Debug, \"q3\", color.new(color.teal, 50))\n// Display the other extracted values in the status line and Data Window to avoid impacting the scale.\nplot(outerRangeDebug, \"outerRange\", chart.fg_color, display = notOnPane)\nplot(totalRangeDebug, \"totalRange\", chart.fg_color, display = notOnPane)\nplot(alphaDebug, \"alpha\", chart.fg_color, display = notOnPane)\n// Highlight the chart when `alphaDebug` is 0, i.e., when the `maValue` does not change.\nbgcolor(alphaDebug == 0.0 ? color.new(color.orange, 90) : na, title = \"`alpha == 0.0` highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We used <code dir=\"auto\">display.all - display.pane</code> for the plots of the\n<code dir=\"auto\">outerRangeDebug</code>, <code dir=\"auto\">totalRangeDebug</code>, and <code dir=\"auto\">alphaDebug</code> variables\nto\n<a href=\"/pine-script-docs/v5/writing/debugging/#without-affecting-the-scale\">avoid impacting the chart\u2019s scale</a>.</li>\n<li>The script also uses a\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditional-colors\">conditional color</a> to highlight the chart pane\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">background</a>\nwhen <code dir=\"auto\">debugAlpha</code> is 0, indicating the <code dir=\"auto\">maValue</code> does not\nchange.</li>\n</ul>\n<p>Another, more <em>advanced</em> way to extract the values of a function\u2019s\nlocal variables is to pass them to a <em>reference type</em> variable declared\nin the global scope.</p>\n<p>Function scopes can access global variables for their calculations.\nWhile a script cannot directly reassign the values of global variables\nfrom within a function\u2019s scope, it can update the <em>elements or\nproperties</em> of those values if they are reference types, such as\n<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>,\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>,\n<a href=\"/pine-script-docs/v5/language/maps/\">maps</a>, and\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>.</p>\n<p>This version declares a <code dir=\"auto\">debugData</code> variable in the global scope that\nreferences a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_map\">map</a>\nwith \u201cstring\u201d keys and \u201cfloat\u201d values. Within the local scope of the\n<code dir=\"auto\">customMA()</code> function, the script puts <em>key-value pairs</em> containing each\nlocal variable\u2019s name and value into the map. After calling the\nfunction, the script plots the stored <code dir=\"auto\">debugData</code> values:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Extracting local variables with reference types demo\", \"Custom MA\", true)\n\n//@variable The number of bars in the `customMA()` calculation.\nint lengthInput = input.int(50, \"Length\", 2)\n\n//@variable A map with \"string\" keys and \"float\" values for debugging the `customMA()`.\nmap&lt;string, float&gt; debugData = map.new&lt;string, float&gt;()\n\n//@function      Calculates a moving average that only responds to values outside the first and third quartiles.\n//@param source  The series of values to process.\n//@param length  The number of bars in the calculation.\n//@returns       The moving average value.\ncustomMA(float source, int length) =&gt;\n    //@variable The custom moving average.\n    var float result = na\n    // Calculate the 25th and 75th `source` percentiles.\n    float q1 = ta.percentile_linear_interpolation(source, length, 25),    map.put(debugData, \"q1\", q1)\n    float q3 = ta.percentile_linear_interpolation(source, length, 75),    map.put(debugData, \"q3\", q3)\n    // Calculate the range values.\n    float outerRange = math.max(source - q3, q1 - source, 0.0),           map.put(debugData, \"outerRange\", outerRange)\n    float totalRange = ta.range(source, length),                          map.put(debugData, \"totalRange\", totalRange)\n    //@variable Half the ratio of the `outerRange` to the `totalRange`.\n    float alpha = 0.5 * outerRange / totalRange,                          map.put(debugData, \"alpha\", alpha)\n    // Mix the `source` with the `result` based on the `alpha` value.\n    result := (1.0 - alpha) * nz(result, source) + alpha * source\n    // Return the `result`.\n    result\n\n//@variable The `customMA()` result over `lengthInput` bars.\nfloat maValue = customMA(close, lengthInput)\n\n// Plot the `maValue`.\nplot(maValue, \"Custom MA\", color.blue, 3)\n\n//@variable Display location for plots with different scale.\nnotOnPane = display.all - display.pane\n\n// Display the extracted `q1` and `q3` values in all plot locations.\nplot(map.get(debugData, \"q1\"), \"q1\", color.new(color.maroon, 50))\nplot(map.get(debugData, \"q3\"), \"q3\", color.new(color.teal, 50))\n// Display the other extracted values in the status line and Data Window to avoid impacting the scale.\nplot(map.get(debugData, \"outerRange\"), \"outerRange\", chart.fg_color, display = notOnPane)\nplot(map.get(debugData, \"totalRange\"), \"totalRange\", chart.fg_color, display = notOnPane)\nplot(map.get(debugData, \"alpha\"), \"alpha\", chart.fg_color, display = notOnPane)\n// Highlight the chart when the extracted `alpha` is 0, i.e., when the `maValue` does not change.\nbgcolor(map.get(debugData, \"alpha\") == 0.0 ? color.new(color.orange, 90) : na, title = \"`alpha == 0.0` highlight\")</div>\n<p>Note that:</p>\n<ul>\n<li>We placed each\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.put\">map.put()</a>\ncall on the same line as each variable declaration, separated by\na comma, to keep things concise and avoid adding extra lines to\nthe <code dir=\"auto\">customMA()</code> code.</li>\n<li>We used\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_map.get\">map.get()</a>\nto retrieve each value for the debug\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\ncalls.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"local-drawings-and-logs\"><a href=\"#local-drawings-and-logs\">Local drawings and logs<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Unlike <code dir=\"auto\">plot.*()</code> functions and others that require values accessible to\nthe global scope, scripts can generate\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing objects</a> and <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> from directly within a function, allowing programmers to\nflexibly debug its local variables <em>without</em> extracting values to the\nouter scope.</p>\n<p>In this example, we used\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> and\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> to\ndisplay\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representations</a> of the values within the <code dir=\"auto\">customMA()</code> scope. Inside the\nfunction, the script calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.format\">str.format()</a>\nto create a formatted string representing the local scope\u2019s data, then\ncalls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\nto respectively display the text on the chart in a tooltip and log an\n\u201cinfo\u201d message containing the text in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"528\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-functions-Local-drawings-and-logs-1.iGi0vyrx_2s4zkG.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Local drawings and logs demo\", \"Custom MA\", true, max_labels_count = 500)\n\n//@variable The number of bars in the `customMA()` calculation.\nint lengthInput = input.int(50, \"Length\", 2)\n\n//@function      Calculates a moving average that only responds to values outside the first and third quartiles.\n//@param source  The series of values to process.\n//@param length  The number of bars in the calculation.\n//@returns       The moving average value.\ncustomMA(float source, int length) =&gt;\n    //@variable The custom moving average.\n    var float result = na\n    // Calculate the 25th and 75th `source` percentiles.\n    float q1 = ta.percentile_linear_interpolation(source, length, 25)\n    float q3 = ta.percentile_linear_interpolation(source, length, 75)\n    // Calculate the range values.\n    float outerRange = math.max(source - q3, q1 - source, 0.0)\n    float totalRange = ta.range(source, length)\n    //@variable Half the ratio of the `outerRange` to the `totalRange`.\n    float alpha = 0.5 * outerRange / totalRange\n    // Mix the `source` with the `result` based on the `alpha` value.\n    result := (1.0 - alpha) * nz(result, source) + alpha * source\n\n    //@variable A formatted string containing representations of all local variables.\n    string debugText = str.format(\n         \"\\n`customMA()` data\\n----------\\nsource: {0, number, #.########}\\nlength: {1}\\nq1: {2, number, #.########}\n         \\nq3: {3, number, #.########}\\nouterRange: {4, number, #.########}\\ntotalRange: {5, number, #.########}\n         \\nalpha{6, number, #.########}\\nresult: {7, number, #.########}\",\n         source, length, q1, q3, outerRange, totalRange, alpha, result\n     )\n    // Draw a label with a tooltip displaying the `debugText`.\n    label.new(bar_index, high, color = color.new(chart.fg_color, 80), tooltip = debugText)\n    // Print an \"info\" message in the Pine Logs pane when the bar is confirmed.\n    if barstate.isconfirmed\n        log.info(debugText)\n\n    // Return the `result`.\n    result\n\n//@variable The `customMA()` result over `lengthInput` bars.\nfloat maValue = customMA(close, lengthInput)\n\n// Plot the `maValue`.\nplot(maValue, \"Custom MA\", color.blue, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>We included <code dir=\"auto\">max_labels_count = 500</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction to display\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> for the most recent 500 <code dir=\"auto\">customMA()</code> calls.</li>\n<li>The function uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isconfirmed\">barstate.isconfirmed</a>\nin an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstatement to only call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\non <em>confirmed</em> bars. It does not log a new message on each\nrealtime tick.</li>\n</ul>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"debugging-loops\"><a href=\"#debugging-loops\">Debugging loops<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><a href=\"/pine-script-docs/v5/language/loops/\">Loops</a> are structures that\nrepeatedly execute a code block based on a <em>counter</em>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>),\nthe contents of a\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collection</a>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>),\nor a <em>condition</em>\n(<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>).\nThey allow scripts to perform repetitive tasks without the need for\nredundant lines of code.</p>\n<p>Each loop instance maintains a separate local scope, which all outer\nscopes cannot access. All variables declared within a loop\u2019s scope are\nspecific to that loop, meaning one cannot use them in an outer scope.</p>\n<p>As with other structures in Pine, there are numerous possible ways to\ndebug loops. This section explores a few helpful techniques, including\nextracting local values for <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a>, inspecting values with\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawings</a>, and tracing a loop\u2019s execution with\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>.</p>\n<p>We will use this script as a starting point for the examples in the\nfollowing segments. It aggregates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalue\u2019s rates of change over 1 - <code dir=\"auto\">lookbackInput</code> bars and accumulates\nthem in a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloop, then divides the result by the <code dir=\"auto\">lookbackInput</code> to calculate a\nfinal average value:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"504\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-loops-1.Co481TKA_ZQmJYP.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Debugging loops demo\", \"Aggregate ROC\")\n\n//@variable The number of bars in the calculation.\nint lookbackInput = input.int(20, \"Lookback\", 1)\n\n//@variable The average ROC of `close` prices over each length from 1 to `lookbackInput` bars.\nfloat aroc = 0.0\n\n// Calculation loop.\nfor length = 1 to lookbackInput\n    //@variable The `close` value `length` bars ago.\n    float pastClose = close[length]\n    //@variable The `close` rate of change over `length` bars.\n    float roc = (close - pastClose) / pastClose\n    // Add the `roc` to `aroc`.\n    aroc += roc\n\n// Divide `aroc` by the `lookbackInput`.\naroc /= lookbackInput\n\n// Plot the `aroc`.\nplot(aroc, \"aroc\", color.blue, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">aroc</code> is a <em>global</em> variable modified within the loop,\nwhereas <code dir=\"auto\">pastClose</code> and <code dir=\"auto\">roc</code> are <em>local</em> variables inaccessible\nto the outer scope.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"inspecting-a-single-iteration\"><a href=\"#inspecting-a-single-iteration\">Inspecting a single iteration<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a programmer needs to focus on a specific loop iteration, there are\nmultiple techniques they can use, most of which entail using a\n<em>condition</em> inside the loop to trigger debugging actions, such as\nextracting values to outer variables, creating\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawings</a>, <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">logging</a> messages, etc.</p>\n<p>This example inspects the local <code dir=\"auto\">roc</code> value from a single iteration of\nthe loop in three different ways. When the loop counter\u2019s value equals\nthe <code dir=\"auto\">debugCounterInput</code>, the script assigns the <code dir=\"auto\">roc</code> to an <code dir=\"auto\">rocDebug</code>\nvariable from the global scope for\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-numbers\">plotting</a>, draws a vertical\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>\nfrom 0 to the <code dir=\"auto\">roc</code> value using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line.new\">line.new()</a>,\nand logs a message in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane\nusing\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"664\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-loops-Inspecting-a-single-iteration-1.tCjAEA7s_1OlVrm.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inspecting a single iteration demo\", \"Aggregate ROC\", max_lines_count = 500)\n\n//@variable The number of bars in the calculation.\nint lookbackInput = input.int(20, \"Lookback\", 1)\n//@variable The `length` value in the loop's execution where value extraction occurs.\nint debugCounterInput = input.int(1, \"Loop counter value\", 1, group = \"Debugging\")\n\n//@variable The `roc` value extracted from the loop.\nfloat rocDebug = na\n\n//@variable The average ROC of `close` over lags from 1 to `lookbackInput` bars.\nfloat aroc = 0.0\n\n// Calculation loop.\nfor length = 1 to lookbackInput\n    //@variable The `close` value `length` bars ago.\n    float pastClose = close[length]\n    //@variable The `close` rate of change over `length` bars.\n    float roc = (close - pastClose) / pastClose\n    // Add the `roc` to `aroc`.\n    aroc += roc\n\n    // Trigger debug actions when the `length` equals the `debugCounterInput`.\n    if length == debugCounterInput\n        // Assign `roc` to `rocDebug` so the script can plot its value.\n        rocDebug := roc\n        // Draw a vertical line from 0 to the `roc` at the `bar_index`.\n        line.new(bar_index, 0.0, bar_index, roc, color = color.new(color.gray, 50), width = 4)\n        // Log an \"info\" message in the Pine Logs pane.\n        log.info(\"{0}-bar `roc`{1}: {2, number, #.########}\", length, barstate.isconfirmed ? \" (confirmed)\" : \"\", roc)\n\n// Divide `aroc` by the `lookbackInput`.\naroc /= lookbackInput\n\n// Plot the `aroc`.\nplot(aroc, \"aroc\", color.blue, 3)\n\n// Plot the `rocDebug`.\nplot(rocDebug, \"Extracted roc\", color.new(color.rgb(206, 55, 136), 40), 2)</div>\n<p>Note that:</p>\n<ul>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\ncall assigned to the <code dir=\"auto\">debugCounterInput</code> includes a <code dir=\"auto\">group</code>\nargument to distinguish it in the script\u2019s settings.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\ncall includes \u201c(confirmed)\u201d in the formatted message whenever\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isconfirmed\">barstate.isconfirmed</a>\nis <code dir=\"auto\">true</code>. Searching this text in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane will filter out the entries from unconfirmed\nbars. See the\n<a href=\"/pine-script-docs/v5/writing/debugging/#filtering-logs\">Filtering logs</a> section above.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"inspecting-multiple-iterations\"><a href=\"#inspecting-multiple-iterations\">Inspecting multiple iterations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When inspecting the values from several loop iterations, it\u2019s often\nhelpful to utilize\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> or strings to gather the results for use in output functions\nafter the loop terminates.</p>\n<p>This version demonstrates a few ways to collect and display the loop\u2019s\nvalues from all iterations. It declares a <code dir=\"auto\">logText</code> string and a\n<code dir=\"auto\">debugValues</code> array in the global scope. Inside the local scope of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloop, the script <em>concatenates</em> a\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representation</a> of the <code dir=\"auto\">length</code> and <code dir=\"auto\">roc</code> with the <code dir=\"auto\">logText</code> and calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nto push the iteration\u2019s <code dir=\"auto\">roc</code> value into the <code dir=\"auto\">debugValues</code> array.</p>\n<p>After the loop ends, the script\n<a href=\"/pine-script-docs/v5/writing/debugging/#plotting-numbers\">plots</a> the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.first\">first</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.last\">last</a>\nvalue from the <code dir=\"auto\">debugValues</code> array, draws a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nwith a <em>tooltip</em> showing a\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representation</a> of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nand displays the <code dir=\"auto\">logText</code> in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane\nupon the bar\u2019s confirmation:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-loops-Inspecting-multiple-iterations-1.CYLBy0Wy_ZVV2R6.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inspecting multiple iterations demo\", \"Aggregate ROC\", max_labels_count = 500)\n\n//@variable The number of bars in the calculation.\nint lookbackInput = input.int(20, \"Lookback\", 1)\n\n//@variable An array containing the `roc` value from each loop iteration.\narray&lt;float&gt; debugValues = array.new&lt;float&gt;()\n//@variable A \"string\" containing information about the `roc` on each iteration.\nstring logText = \"\"\n\n//@variable The average ROC of `close` over lags from 1 to `lookbackInput` bars.\nfloat aroc = 0.0\n\n// Calculation loop.\nfor length = 1 to lookbackInput\n    //@variable The `close` value `length` bars ago.\n    float pastClose = close[length]\n    //@variable The `close` rate of change over `length` bars.\n    float roc = (close - pastClose) / pastClose\n    // Add the `roc` to `aroc`.\n    aroc += roc\n\n    // Concatenate a new \"string\" representation with the `debugText`.\n    logText += \"\\nlength: \" + str.tostring(length) + \", roc: \" + str.tostring(roc)\n    // Push the `roc` value into the `debugValues` array.\n    array.push(debugValues, roc)\n\n// Divide `aroc` by the `lookbackInput`.\naroc /= lookbackInput\n\n// Plot the `aroc`.\nplot(aroc, \"aroc\", color.blue, 3)\n\n// Plot the `roc` values from the first and last iteration.\nplot(array.first(debugValues), \"First iteration roc\", color.new(color.rgb(166, 84, 233), 50), 2)\nplot(array.last(debugValues), \"Last iteration roc\", color.new(color.rgb(115, 86, 218), 50), 2)\n// Draw a label with a tooltip containing a \"string\" representation of the `debugValues` array.\nlabel.new(bar_index, aroc, color = color.new(color.rgb(206, 55, 136), 70), tooltip = str.tostring(debugValues))\n// Log the `logText` in the Pine Logs pane when the bar is confirmed.\nif barstate.isconfirmed\n    log.info(logText)</div>\n<p>Another way to inspect a loop over several iterations is to generate\nsequential <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> or create/modify\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing objects</a> within the loop\u2019s scope to trace its execution pattern with\ngranular detail.</p>\n<p>This example uses <a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> to trace the execution flow of our script\u2019s loop. It\ngenerates a new \u201cinfo\u201d message on each iteration to track the local\nscope\u2019s calculations as the loop progresses on each confirmed bar:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"662\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Debugging-Debugging-loops-Inspecting-multiple-iterations-2.CahjoXFr_Z1z4bNL.webp\" width=\"1342\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Inspecting multiple iterations demo\", \"Aggregate ROC\")\n\n//@variable The number of bars in the calculation.\nint lookbackInput = input.int(20, \"Lookback\", 1)\n\n//@variable The average ROC of `close` over lags from 1 to `lookbackInput` bars.\nfloat aroc = 0.0\n\n// Calculation loop.\nfor length = 1 to lookbackInput\n    //@variable The `close` value `length` bars ago.\n    float pastClose = close[length]\n    //@variable The `close` rate of change over `length` bars.\n    float roc = (close - pastClose) / pastClose\n    // Add the `roc` to `aroc`.\n    aroc += roc\n    if barstate.isconfirmed\n        log.info(\n             \"{0}\\nlength (counter): {1}\\npastClose: {2, number, #.#####}\\n\n             distance to pastClose: {3, number, #.########}\\nroc: {4, number, #.########}\\n\n             aroc (before division): {5, number, #.########}\\n{6}\",\n             length == 1 ? \"LOOP START\" : \"\",\n             length, pastClose, close - pastClose, roc, aroc,\n             length == lookbackInput ? \"LOOP END\" : \"\"\n         )\n\n// Divide `aroc` by the `lookbackInput`.\naroc /= lookbackInput\n\n// Plot the `aroc`.\nplot(aroc, \"aroc\", color.blue, 3)</div>\n<p>Note that:</p>\n<ul>\n<li>When iteratively generating\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">logs</a> or\ndrawings from inside a loop, make it a point to avoid\nunnecessary clutter and strive for easy navigation. More is not\nalways better for debugging, especially when working within\nloops.</li>\n</ul>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:9", "segment_order": 9, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/debugging", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tips\"><a href=\"#tips\">Tips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"organization-and-readability\"><a href=\"#organization-and-readability\">Organization and readability<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When writing scripts, it\u2019s wise to prioritize organized, readable\nsource codes. Code that\u2019s organized and easy to read helps streamline\nthe debugging process. Additionally, well-written code is easier to\nmaintain over time.</p>\n<p>Here are a few quick tips based on our\n<a href=\"/pine-script-docs/v5/writing/style-guide/\">Style guide</a> and the\nexamples on this page:</p>\n<ul>\n<li>Aim to follow the general\n<a href=\"/pine-script-docs/v5/writing/style-guide/#script-organization\">script organization</a> recommendations. Organizing scripts using this structure\nmakes things easier to locate and inspect.</li>\n<li>Choose variable and function names that make them easy to <em>identify</em>\nand <em>understand</em>. See the\n<a href=\"/pine-script-docs/v5/writing/style-guide/#naming-conventions\">Naming conventions</a> section for some examples.</li>\n<li>It\u2019s often helpful to temporarily assign important parts of\nexpressions to variables with informative names while debugging.\nBreaking expressions down into reusable parts helps simplify\ninspection processes.</li>\n<li>Use <em>comments</em> and <em>annotations</em> (<code dir=\"auto\">//@function</code>, <code dir=\"auto\">//@variable</code>,\netc.) to document your code. Annotations are particularly helpful,\nas the Pine Editor\u2019s autosuggest displays variable and function\ndescriptions in a pop-up when hovering over their identifiers\nanywhere in the code.</li>\n<li>Remember that <em>less is more</em> in many cases. Don\u2019t overwhelm\nyourself with excessive script outputs or unnecessary information\nwhile debugging. Keep things simple, and only include as much\ninformation as you need.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"speeding-up-repetitive-tasks\"><a href=\"#speeding-up-repetitive-tasks\">Speeding up repetitive tasks<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>There are a few handy techniques we often utilize when debugging our\ncode:</p>\n<ul>\n<li>We use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a>\nto quickly display the results of \u201cint\u201d, \u201cfloat\u201d, or \u201cbool\u201d\nvariables and expressions in the script\u2019s status line and the Data\nWindow.</li>\n<li>We often use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\nto visualize the history of certain\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditions\">conditions</a> on the chart.</li>\n<li>We use a one-line version of our <code dir=\"auto\">printLabel()</code> function from\n<a href=\"/pine-script-docs/v5/writing/debugging/#at-the-end-of-the-chart\">this section</a> to print strings at the end of the chart.</li>\n<li>We use a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\ncall with a <code dir=\"auto\">tooltip</code> argument to display strings in tooltips\n<a href=\"/pine-script-docs/v5/writing/debugging/#on-successive-bars\">on successive bars</a>.</li>\n<li>We use the <code dir=\"auto\">log.*()</code> functions to quickly display data with\n<a href=\"/pine-script-docs/v5/writing/debugging/#representing-other-types\">string representations</a> in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a>\npane.</li>\n</ul>\n<p>When one establishes their typical debugging processes, it\u2019s often\nhelpful to create <em>keyboard macros</em> to speed up repetitive tasks and\nspend less time setting up debug outputs in each code.</p>\n<p>The following is a simple <em>AutoHotkey</em> script (<strong>not</strong> Pine Script\ncode) that includes hotstrings for the above five techniques. The script\ngenerates code snippets by entering a specified character sequence\nfollowed by a whitespace:</p>\n<div class=\"expressive-code not-content\"><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"txt\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">; \u2014\u2014\u2014\u2014\u2014 This is AHK code, not Pine Script. \u2014\u2014\u2014\u2014\u2014</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">; Specify that hotstrings trigger when they end with space, tab, linefeed, or carriage return.</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">#Hotstring EndChars `t `n `r</span></div></div><div class=\"ec-line\"><div class=\"code\">\n</div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">:X:,,show::SendInput, plotchar(%Clipboard%, \"%Clipboard%\", \"\", color = chart.fg_color, display = display.all - display.pane){Enter}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">:X:,,highlight::SendInput, bgcolor(bool(%Clipboard%) ? color.new(color.orange, 80) : na, title = \"%Clipboard% highlight\"){Enter}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">:X:,,print::SendInput, printLabel(string txt, float price = na) =&gt; int labelTime = math.max(last_bar_time, chart.right_visible_bar_time), var label result = label.new(labelTime, na, txt, xloc.bar_time, na(price) ? yloc.abovebar : yloc.price, na, label.style_none, chart.fg_color, size.large), label.set_text(result, txt), label.set_y(result, price), result`nprintLabel(){Left}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">:X:,,tooltip::SendInput, label.new(bar_index, high, color = color.new(chart.fg_color, 70), tooltip = str.tostring(%Clipboard%)){Enter}</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">:X:,,log::SendInput, log.info(str.tostring(%Clipboard%)){Enter}</span></div></div></code></pre></figure></div>\n<p>The \u201c,,show\u201d macro generates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a>\ncall that uses the clipboard\u2019s contents for the <code dir=\"auto\">series</code> and <code dir=\"auto\">title</code>\narguments. Copying a <code dir=\"auto\">variableName</code> variable or the <code dir=\"auto\">close &gt; open</code>\nexpression and typing \u201c,,show\u201d followed by a space will respectively\nyield:</p>\n<div class=\"pine-colorizer not-content\">plotchar(variableName, \"variableName\", \"\", color = chart.fg_color, display = display.all - display.pane)\nplotchar(close &gt; open, \"close &gt; open\", \"\", color = chart.fg_color, display = display.all - display.pane)</div>\n<p>The \u201c,,highlight\u201d macro generates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a>\ncall that highlights the chart pane\u2019s background with a\n<a href=\"/pine-script-docs/v5/writing/debugging/#conditional-colors\">conditional color</a> based on the variable or expression copied to the clipboard.\nFor example, copying the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isrealtime\">barstate.isrealtime</a>\nvariable and typing \u201c,,highlight\u201d followed by a space will yield:</p>\n<div class=\"pine-colorizer not-content\">bgcolor(bool(barstate.isrealtime) ? color.new(color.orange, 80) : na, title = \"barstate.isrealtime highlight\")</div>\n<p>The \u201c,,print\u201d macro generates the one-line <code dir=\"auto\">printLabel()</code> function and\ncreates an empty <code dir=\"auto\">printLabel()</code> call with the cursor placed inside it.\nAll you need to do after typing \u201c,,print\u201d followed by a space is enter\nthe text you want to display:</p>\n<div class=\"pine-colorizer not-content\">printLabel(string txt, float price = na) =&gt; int labelTime = math.max(last_bar_time, chart.right_visible_bar_time), var label result = label.new(labelTime, na, txt, xloc.bar_time, na(price) ? yloc.abovebar : yloc.price, na, label.style_none, chart.fg_color, size.large), label.set_text(result, txt), label.set_y(result, price), result\nprintLabel()</div>\n<p>The \u201c,,tooltip\u201d macro generates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label.new\">label.new()</a>\ncall with a <code dir=\"auto\">tooltip</code> argument that uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\non the clipboard\u2019s contents. Copying the <code dir=\"auto\">variableName</code> variable and\ntyping \u201c,,tooltip\u201d followed by a space yields:</p>\n<div class=\"pine-colorizer not-content\">label.new(bar_index, high, color = color.new(chart.fg_color, 70), tooltip = str.tostring(variableName))</div>\n<p>The \u201c,,log\u201d macro generates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_log.info\">log.info()</a>\ncall with a <code dir=\"auto\">message</code> argument that uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_str.tostring\">str.tostring()</a>\non the clipboard\u2019s contents to display string representations of\nvariables and expressions in the\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">Pine Logs</a> pane.\nCopying the expression <code dir=\"auto\">bar_index % 2 == 0</code> and typing \u201c,,log\u201d\nfollowed by a space yields:</p>\n<div class=\"pine-colorizer not-content\">log.info(str.tostring(bar_index % 2 == 0))</div>\n<p>Note that:</p>\n<ul>\n<li>AHK is available for <em>Windows</em> devices. Research other software\nto employ a similar process if your machine uses a different\noperating system.</li>\n</ul>", "segment_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea:10", "segment_order": 10, "segment_type": "guide_section", "source_artifact_id": "e41da2420c34a714185f4d2c9256f7a1abe9eeafb4790932e5e5a5aff29602ea", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/writing/limitations\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"limitations\"><a href=\"#limitations\">Limitations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>As is mentioned in our <a href=\"/pine-script-docs/v5/welcome/\">Welcome</a> page:</p>\n<blockquote>\n<p><em>Because each script uses computational resources in the cloud, we\nmust impose limits in order to share these resources fairly among our\nusers. We strive to set as few limits as possible, but will of course\nhave to implement as many as needed for the platform to run smoothly.\nLimitations apply to the amount of data requested from additional\nsymbols, execution time, memory usage and script size.</em></p>\n</blockquote>\n<p>If you develop complex scripts using Pine Script\u00ae, sooner or later you\nwill run into some of the limitations we impose. This section provides\nyou with an overview of the limitations that you may encounter. There\nare currently no means for Pine Script programmers to get data on the\nresources consumed by their scripts. We hope this will change in the\nfuture.</p>\n<p>In the meantime, when you are considering large projects, it is safest\nto make a proof of concept in order to assess the probability of your\nscript running into limitations later in your project.</p>\n<p>Below, we describe the limits imposed in the Pine Script environment.</p>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"time\"><a href=\"#time\">Time<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"script-compilation\"><a href=\"#script-compilation\">Script compilation<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts must compile before they are executed on charts. Compilation\noccurs when you save a script from the Pine Editor or when you add a\nscript to the chart. A two-minute limit is imposed on compilation time,\nwhich will depend on the size and complexity of your script, and whether\nor not a cached version of a previous compilation is available. When a\ncompile exceeds the two-minute limit, a warning is issued. Heed that\nwarning by shortening your script because after three consecutives\nwarnings a one-hour ban on compilation attempts is enforced. The first\nthing to consider when optimizing code is to avoid repetitions by using\nfunctions to encapsulate oft-used segments, and call functions instead\nof repeating code.</p>\n<h3 class=\"md-heading\" id=\"script-execution\"><a href=\"#script-execution\">Script execution<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Once a script is compiled it can be executed. See the\n<a href=\"/pine-script-docs/v5/language/execution-model/#events-triggering-the-execution-of-a-script\">Events triggering the execution of a script</a> for a list of the events triggering the execution of a\nscript. The time allotted for the script to execute on all bars of a\ndataset varies with account types. The limit is 20 seconds for basic\naccounts, 40 for others.</p>\n<h3 class=\"md-heading\" id=\"loop-execution\"><a href=\"#loop-execution\">Loop execution<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The execution time for any loop on any single bar is limited to 500\nmilliseconds. The outer loop of embedded loops counts as one loop, so it\nwill time out first. Keep in mind that even though a loop may execute\nunder the 500 ms time limit on a given bar, the time it takes to execute\non all the dataset\u2019s bars may nonetheless cause your script to exceed\nthe total execution time limit. For example, the limit on total\nexecution time will make it impossible for you script to execute a 400\nms loop on each bar of a 20,000-bar dataset because your script would\nthen need 8000 seconds to execute.</p>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"chart-visuals\"><a href=\"#chart-visuals\">Chart visuals<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"plot-limits\"><a href=\"#plot-limits\">Plot limits<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A maximum of 64 plot counts are allowed per script. The functions that\ngenerate plot counts are:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotarrow\">plotarrow()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotbar\">plotbar()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotchar\">plotchar()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotshape\">plotshape()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_alertcondition\">alertcondition()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_bgcolor\">bgcolor()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_fill\">fill()</a>,\nbut only if its <code dir=\"auto\">color</code> is of the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_series\">series</a>\nform.</li>\n</ul>\n<p>The following functions do not generate plot counts:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_hline\">hline()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_line%7Bdot%7Dnew\">line.new()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_label%7Bdot%7Dnew\">label.new()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_table%7Bdot%7Dnew\">table.new()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box%7Bdot%7Dnew\">box.new()</a></li>\n</ul>\n<p>One function call can generate up to seven plot counts, depending on the\nfunction and how it is called. When your script exceeds the maximum of\n64 plot counts, the runtime error message will display the plot count\ngenerated by your script. Once you reach that point, you can determine\nhow many plot counts a function call generates by commenting it out in a\nscript. As long as your script still throws an error, you will be able\nto see how the actual plot count decreases after you have commented out\na line.</p>\n<p>The following example shows different function calls and the number of\nplot counts each one will generate:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Plot count example\")\n\nbool isUp = close &gt; open\ncolor isUpColor = isUp ? color.green : color.red\nbool isDn = not isUp\ncolor isDnColor = isDn ? color.red : color.green\n\n// Uses one plot count each.\np1 = plot(close, color = color.white)\np2 = plot(open, color = na)\n\n// Uses two plot counts for the `close` and `color` series.\nplot(close, color = isUpColor)\n\n// Uses one plot count for the `close` series.\nplotarrow(close, colorup = color.green, colordown = color.red)\n\n// Uses two plot counts for the `close` and `colorup` series.\nplotarrow(close, colorup = isUpColor)\n\n// Uses three plot counts for the `close`, `colorup`, and the `colordown` series.\nplotarrow(close - open, colorup = isUpColor, colordown = isDnColor)\n\n// Uses four plot counts for the `open`, `high`, `low`, and `close` series.\nplotbar(open, high, low, close, color = color.white)\n\n// Uses five plot counts for the `open`, `high`, `low`, `close`, and `color` series.\nplotbar(open, high, low, close, color = isUpColor)\n\n// Uses four plot counts for the `open`, `high`, `low`, and `close` series.\nplotcandle(open, high, low, close, color = color.white, wickcolor = color.white, bordercolor = color.purple)\n\n// Uses five plot counts for the `open`, `high`, `low`, `close`, and `color` series.\nplotcandle(open, high, low, close, color = isUpColor, wickcolor = color.white, bordercolor = color.purple)\n\n// Uses six plot counts for the `open`, `high`, `low`, `close`, `color`, and `wickcolor` series.\nplotcandle(open, high, low, close, color = isUpColor, wickcolor = isUpColor , bordercolor = color.purple)\n\n// Uses seven plot counts for the `open`, `high`, `low`, `close`, `color`, `wickcolor`, and `bordercolor` series.\nplotcandle(open, high, low, close, color = isUpColor, wickcolor = isUpColor , bordercolor = isUp ? color.lime : color.maroon)\n\n// Uses one plot count for the `close` series.\nplotchar(close, color = color.white, text = \"|\", textcolor = color.white)\n\n// Uses two plot counts for the `close`` and `color` series.\nplotchar(close, color = isUpColor, text = \"\u2014\", textcolor = color.white)\n\n// Uses three plot counts for the `close`, `color`, and `textcolor` series.\nplotchar(close, color = isUpColor, text = \"O\", textcolor = isUp ? color.yellow : color.white)\n\n// Uses one plot count for the `close` series.\nplotshape(close, color = color.white, textcolor = color.white)\n\n// Uses two plot counts for the `close` and `color` series.\nplotshape(close, color = isUpColor, textcolor = color.white)\n\n// Uses three plot counts for the `close`, `color`, and `textcolor` series.\nplotshape(close, color = isUpColor, textcolor = isUp ? color.yellow : color.white)\n\n// Uses one plot count.\nalertcondition(close &gt; open, \"close &gt; open\", \"Up bar alert\")\n\n// Uses one plot count.\nbgcolor(isUp ? color.yellow : color.white)\n\n// Uses one plot count for the `color` series.\nfill(p1, p2, color = isUpColor)</div>\n<p>This example generates a plot count of 56. If we were to add two more\ninstances of the last call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>,\nthe script would throw an error stating that the script now uses 70 plot\ncounts, as each additional call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plotcandle\">plotcandle()</a>\ngenerates seven plot counts, and 56 + (7 * 2) is 70.</p>\n<h3 class=\"md-heading\" id=\"line-box-polyline-and-label-limits\"><a href=\"#line-box-polyline-and-label-limits\">Line, box, polyline, and label limits<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Contrary to <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a>, which can\ncover the chart\u2019s entire dataset, scripts will only show the last 50\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#lines\">lines</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a>,\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nand <a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on\nthe chart by default. One can increase the maximum number for each of\nthese\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> via the <code dir=\"auto\">max_lines_count</code>, <code dir=\"auto\">max_boxes_count</code>,\n<code dir=\"auto\">max_polylines_count</code>, and <code dir=\"auto\">max_labels_count</code> parameters of the\nscript\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement. The maximum number of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_line\">line</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\nIDs is 500, and the maximum number of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\nIDs is 100.</p>\n<p>In this example, we set the maximum number of recent labels shown on the\nchart to 100:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Label limits example\", max_labels_count = 100, overlay = true)\nlabel.new(bar_index, high, str.tostring(high, format.mintick))</div>\n<p>It\u2019s important to note when setting any of a drawing object\u2019s\nproperties to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> that\nits ID still exists and thus contributes to a script\u2019s drawing totals.\nTo demonstrate this behavior, the following script draws a \u201cBuy\u201d and\n\u201cSell\u201d\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_label\">label</a>\non each bar, with <code dir=\"auto\">x</code> values determined by the <code dir=\"auto\">longCondition</code> and\n<code dir=\"auto\">shortCondition</code> variables.</p>\n<p>The \u201cBuy\u201d label\u2019s <code dir=\"auto\">x</code> value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> when\nthe bar index is even, and the \u201cSell\u201d label\u2019s <code dir=\"auto\">x</code> value is\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> when\nthe bar index is odd. Although the <code dir=\"auto\">max_labels_count</code> is 10 in this\nexample, we can see that the script displays fewer than 10\n<a href=\"/pine-script-docs/v5/concepts/text-and-shapes/#labels\">labels</a> on the\nchart since the ones with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>\nvalues also count toward the total:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"455\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Limitations-LabelsWithNa-1.BrXz3MoQ_2600rs.webp\" width=\"1395\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// Approximate maximum number of label drawings\nMAX_LABELS = 10\n\nindicator(\"labels with na\", overlay = false, max_labels_count = MAX_LABELS)\n\n// Add background color for the last MAX_LABELS bars.\nbgcolor(bar_index &gt; last_bar_index - MAX_LABELS ? color.new(color.green, 80) : na)\n\nlongCondition =  bar_index % 2 != 0\nshortCondition = bar_index % 2 == 0\n\n// Add \"Buy\" and \"Sell\" labels on each new bar.\nlabel.new(longCondition ? bar_index : na,  0, text = \"Buy\", color = color.new(color.green, 0), style = label.style_label_up)\nlabel.new(shortCondition ? bar_index : na, 0, text = \"Sell\", color = color.new(color.red, 0), style = label.style_label_down)\n\nplot(longCondition  ? 1 : 0)\nplot(shortCondition ? 1 : 0)</div>\n<p>To display the desired number of labels, we must eliminate label\ndrawings we don\u2019t want to show rather than setting their properties to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a>. The\nexample below uses an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure to conditionally draw the \u201cBuy\u201d and \u201cSell\u201d labels,\npreventing the script from creating new label IDs when it isn\u2019t\nnecessary:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"451\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Limitations-LabelsWithNa-2.CiofVUZK_2oXzgA.webp\" width=\"1398\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\n\n// Approximate maximum number of label drawings\nMAX_LABELS = 10\n\nindicator(\"conditional labels\", overlay = false, max_labels_count = MAX_LABELS)\n\n// Add background color for the last MAX_LABELS bars.\nbgcolor(bar_index &gt; last_bar_index - MAX_LABELS ? color.new(color.green, 80) : na)\n\nlongCondition =  bar_index % 2 != 0\nshortCondition = bar_index % 2 == 0\n\n// Add a \"Buy\" label when `longCondition` is true.\nif longCondition\n    label.new(bar_index,  0, text = \"Buy\", color = color.new(color.green, 0), style = label.style_label_up)\n// Add a \"Sell\" label when `shortCondition` is true.\nif shortCondition\n    label.new(bar_index, 0, text = \"Sell\", color = color.new(color.red, 0), style = label.style_label_down)\n\nplot(longCondition  ? 1 : 0)\nplot(shortCondition ? 1 : 0)</div>\n<h3 class=\"md-heading\" id=\"table-limits\"><a href=\"#table-limits\">Table limits<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can display a maximum of nine\n<a href=\"/pine-script-docs/v5/concepts/tables/\">tables</a> on the chart, one\nfor each of the possible locations:\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dbottom_center\">position.bottom_center</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dbottom_left\">position.bottom_left</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dbottom_right\">position.bottom_right</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dmiddle_center\">position.middle_center</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dmiddle_left\">position.middle_left</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dmiddle_right\">position.middle_right</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dtop_center\">position.top_center</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dtop_left\">position.top_left</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#const_position%7Bdot%7Dtop_right\">position.top_right</a>.\nWhen attempting to place two tables in the same location, only the\nnewest instance will show on the chart.</p>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"request-calls\"><a href=\"#request-calls\"><span>\u200b<code dir=\"auto\">request.\\*()</code>\u200b calls</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"number-of-calls\"><a href=\"#number-of-calls\">Number of calls<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A script can use up to 40 <em>unique</em> calls to the functions in the <code dir=\"auto\">request.*()</code> namespace. A subsequent call to the same <code dir=\"auto\">request.*()</code> function with the same arguments is not unique. This limitation applies when using any <code dir=\"auto\">request.*()</code> functions, including:</p>\n<ul>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.currency_rate\">request.currency_rate()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.dividends\">request.dividends()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.splits\">request.splits()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.earnings\">request.earnings()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.quandl\">request.quandl()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.financial\">request.financial()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.economic\">request.economic()</a></li>\n<li><a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a></li>\n</ul>\n<p>When a script executes two or more identical <code dir=\"auto\">request.*()</code> function calls, only the <em>first</em> call counts toward this limit. The repeated calls do not count because they <em>reuse</em> the data from the first call rather than executing a redundant request. Note that when a script imports <a href=\"/pine-script-docs/v5/concepts/libraries/\">library</a> functions containing <code dir=\"auto\">request.*()</code> calls within their scopes, those calls <strong>do</strong> count toward this limit, even if the script already calls the same <code dir=\"auto\">request.*()</code> function with the same arguments in its main scope.</p>\n<p>The script below calls <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> with the same arguments 50 times within a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop. Although the script contains more than 40 <code dir=\"auto\">request.*()</code> calls, it <em>does not</em> raise an error because each call is <strong>identical</strong>. In this case, it reuses the data from the first iteration\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> call for the repeated calls on all subsequent iterations:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`request.*()` call limit demo\", dynamic_requests = true)\n\n//@variable The sum of values requested from all `request.security()` calls.\nfloat reqSum = 0.0\n\n// Call `request.security()` 50 times within a loop. \n// More than 40 `request.*()` calls occur, but each call is identical. Redundant calls do not count toward the limit. \nfor i = 1 to 50\n    reqSum += request.security(syminfo.tickerid, \"1D\", close)\n\nplot(reqSum)</div>\n<p>Here, we modified the above script to call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> with a different <code dir=\"auto\">timeframe</code> argument on each iteration, meaning all 50 calls are now <strong>unique</strong>. This time, the script will reach the <code dir=\"auto\">request.*()</code> call limit while executing the loop and raise a runtime error because it requests a <em>distinct</em> dataset on each iteration:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`request.*()` call limit demo\", dynamic_requests = true)\n\n//@variable The sum of values requested from all `request.security()` calls.\nfloat reqSum = 0.0\n\n// Call `request.security()` 50 times within a loop with different `timeframe` arguments. \n// This loop causes a runtime error when `i == 41` because each iteration executes a unique request.\nfor i = 1 to 50\n    reqSum += request.security(syminfo.tickerid, str.tostring(i), close)\n\nplot(reqSum)</div>\n<p>Note that:</p>\n<ul>\n<li>These example scripts can call <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> within a loop and allow \u201cseries string\u201d <code dir=\"auto\">timeframe</code> arguments because we included <code dir=\"auto\">dynamic_requests = true</code> in the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a> declaration statement. See <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#dynamic-requests\">this section</a> of the <a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data\">Other timeframes and data</a> page for more information.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"intrabars\"><a href=\"#intrabars\">Intrabars<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can retrieve up to the most recent 200,000 <em>intrabars</em>\n(lower-timeframe bars) via the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a> or <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a> functions, depending on the user\u2019s plan:</p>\n<ul>\n<li>All non-professional plans \u2014 Basic, Essential, Plus, and Premium \u2014 can request up to 100K bars of data.</li>\n<li>Expert plans have access to 125K bars of data.</li>\n<li>Ultimate plans can request 200K lower timeframe bars.</li>\n</ul>\n<p>The <code dir=\"auto\">request.*()</code> functions limit requested data via the <code dir=\"auto\">calc_bars_count</code> parameter. If this parameter is not specified, the default is used, which is 100,000 bars. If the plan permits more, this limit can be increased by passing a greater value.</p>\n<p>The number of bars on the chart\u2019s timeframe covered by 100,000\nintrabars varies with the number of intrabars each chart bar contains.\nFor example, requesting data from the 1-minute timeframe while running\nthe script on a 60-minute chart means each chart bar can contain up to\n60 intrabars. In this case, the minimum number of chart bars covered by\nthe intrabar request is 1,666, as 100,000 / 60 = 1,666.67. It\u2019s\nimportant to note, however, that a provider may not report data for\n<em>every</em> minute within an hour. Therefore, such a request may cover more\nchart bars, depending on the available data.</p>\n<h3 class=\"md-heading\" id=\"tuple-element-limit\"><a href=\"#tuple-element-limit\">Tuple element limit<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>All the <code dir=\"auto\">request.*()</code> function calls in a script taken together cannot\nreturn more than 127 tuple elements. When the combined tuple size of all\n<code dir=\"auto\">request.*()</code> calls will exceed 127 elements, one can instead utilize\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types (UDTs)</a> to request a greater number of values.</p>\n<p>The example below outlines this limitation and the way to work around\nit. The first\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall represents using a tuple with 128 elements as the <code dir=\"auto\">expression</code>\nargument. Since the number of elements is greater than 127, it would\nresult in an error.</p>\n<p>To avoid the error, we can use those same values as <em>fields</em> within an\n<a href=\"/pine-script-docs/v5/language/objects/\">object</a> of a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDT</a>\nand pass its ID to the <code dir=\"auto\">expression</code> instead:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Tuple element limit\")\n\ns1 = close\ns2 = close * 2\n...\ns128 = close * 128\n\n// Causes an error. \n[v1, v2, v3, ..., v128] = request.security(syminfo.tickerid, \"1D\", [s1, s2, s3, ..., s128])\n\n// Works fine:\ntype myType\n    float v1\n    float v2\n    float v3\n    ...\n    float v128\n\nmyObj = request.security(syminfo.tickerid, \"1D\", myType.new(s1, s2, s3, ..., s128))</div>\n<p>Note that:</p>\n<ul>\n<li>This example outlines a scenario where the script tries to\nevaluate 128 tuple elements in a single\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall. The same limitation applies if we were to split the tuple\nrequest across <em>multiple</em> calls. For example, two\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncalls that each retrieve a tuple with 64 elements will also\ncause an error.</li>\n</ul>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-size-and-memory\"><a href=\"#script-size-and-memory\">Script size and memory<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"compiled-tokens\"><a href=\"#compiled-tokens\">Compiled tokens<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Before the execution of a script, the compiler translates it into a\ntokenized <em>Intermediate Language</em> (IL). Using an IL allows Pine Script\nto accommodate larger scripts by applying various memory and performance\noptimizations. The compiler determines the size of a script based on the\n<em>number of tokens</em> in its IL form, <strong>not</strong> the number of characters or\nlines in the code viewable in the Pine Editor.</p>\n<p>The compiled form of each indicator, strategy, and library script is\nlimited to 80,000 tokens. If a script imports libraries, the total\nnumber of tokens from all imported libraries cannot exceed 1 million.\nThere is no way to inspect a script\u2019s compiled form, nor its IL token\ncount. As such, you will only know your script exceeds the size limit\nwhen the compiler reaches it.</p>\n<p>In most cases, a script\u2019s compiled size will likely not reach the\nlimit. However, if a compiled script does reach the token limit, the\nmost effective ways to decrease compiled tokens are to reduce repetitive\ncode, encapsulate redundant calls within functions, and utilize\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">libraries</a> when possible.</p>\n<p>It\u2019s important to note that the compilation process omits any <em>unused</em>\nvariables, functions, types, etc. from the final IL form, where\n\u201cunused\u201d refers to anything that <em>does not</em> affect the script\u2019s\noutputs. This optimization prevents superfluous elements in the code\nfrom contributing to the script\u2019s IL token count.</p>\n<p>For example, the script below declares a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> and a\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">user-defined method</a> and defines a sequence of calls using them:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nplot(close)\n\ntype myType\n    float field = 10.0\n\nmethod m(array&lt;myType&gt; a, myType v) =&gt;\n    a.push(v)\n\nvar arr = array.new&lt;myType&gt;()\narr.push(myType.new(25))\narr.m(myType.new())</div>\n<p>Despite the inclusion of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.new%3Ctype%3E\">array.new&lt;myType&gt;()</a>,\n<code dir=\"auto\">myType.new()</code>, and <code dir=\"auto\">arr.m()</code> calls in the script, the only thing\nactually <strong>output</strong> by the script is <code dir=\"auto\">plot(close)</code>. The rest of the code\ndoes not affect the output. Therefore, the compiled form of this script\nwill have the <em>same</em> number of tokens as:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"My Script\")\nplot(close)</div>\n<h3 class=\"md-heading\" id=\"variables-per-scope\"><a href=\"#variables-per-scope\">Variables per scope<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can contain up to 1,000 variables in each of its scopes. Pine\nscripts always contain one global scope, represented by non-indented\ncode, and they may contain zero or more local scopes. Local scopes are\nsections of indented code representing procedures executed within\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>, as well as\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nstructures, which allow for one or more local blocks. Each local block\ncounts as one local scope.</p>\n<p>The branches of a conditional expression using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%7Bquestion%7D%7Bcolon%7D\">?:</a>\nternary operator do not count as local blocks.</p>\n<h3 class=\"md-heading\" id=\"scope-count\"><a href=\"#scope-count\">Scope count<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The total number of scopes in a script, including its global scope and\neach local scope from the\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a>,\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>,\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structures</a> it\nuses, cannot exceed 550.</p>\n<p>It\u2019s important to note that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>,\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a>\nfunctions <em>duplicate</em> the scopes required to evaluate the values of\ntheir <code dir=\"auto\">expression</code> argument in another context. The scopes produced by\neach call to these <code dir=\"auto\">request.*()</code> functions also count toward the\nscript\u2019s scope limit.</p>\n<p>For example, suppose we created a script with a global variable that\ndepends on the local scopes of 300\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructures. The total scope count for this script is <em>301</em> (1 global\nscope + 300 local scopes):</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scopes demo\")\n\nvar x = 0\n\nif close &gt; 0\n    x += 0\nif close &gt; 1\n    x += 1\n// ... Repeat this `if close &gt; n` pattern until `n = 299`.\nif close &gt; 299\n    x += 299\n\nplot(x)</div>\n<p>Since the total number of scopes is within the limit, it will compile\nsuccessfully. Now, suppose we call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto evaluate the value of <code dir=\"auto\">x</code> from another context and\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plot</a> its value as well. In\nthis case, it will effectively <em>double</em> the script\u2019s scope count since\nthe value of <code dir=\"auto\">x</code> depends on <em>all</em> the script\u2019s scopes:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scopes demo\")\n\nvar x = 0\n\nif close &gt; 0\n    x += 0\nif close &gt; 1\n    x += 1\n// ... Repeat this `if close &gt; n` pattern until `n = 299`.\nif close &gt; 299\n    x += 299\n\nplot(x)\nplot(request.security(syminfo.tickerid, \"1D\", x)) // Causes compilation error since the scope count is now 602.</div>\n<p>We can resolve this issue by encapsulating the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> blocks\nwithin a\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a>, as the scope of a function counts as one embedded scope:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Scopes demo\")\n\nf() =&gt;\n    var x = 0\n\n    if close &gt; 0\n        x += 0\n    if close &gt; 1\n        x += 1\n    // ... Repeat this `if close &gt; n` pattern until `n = 299`.\n    if close &gt; 299\n        x += 299\n\nplot(f())\nplot(request.security(syminfo.tickerid, \"1D\", f())) // No compilation error.</div>\n<h3 class=\"md-heading\" id=\"compilation-request-size\"><a href=\"#compilation-request-size\">Compilation request size<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The size of the compilation request for a script cannot exceed 5MB. The compilation request is all of the information that is sent to the compiler. This information comprises the script itself and any libraries the script imports.</p>\n<p>Unlike the limit for compiled tokens, the request size limit includes unused parts of code. This is because the script is not compiled yet, so any unused code has not yet been optimized out.</p>\n<p>To reduce the compilation request size, you can:</p>\n<ul>\n<li>Reduce the size of the script by optimizing the code.</li>\n<li>Reduce the number of script inputs (script inputs are counted separately).</li>\n<li>Remove any imported libraries that are not needed.</li>\n<li>Use smaller libraries. The entire library is sent for compilation, regardless of which functions are called.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"collections\"><a href=\"#collections\">Collections<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script collections (<a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a>, <a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>,\nand <a href=\"/pine-script-docs/v5/language/maps/\">maps</a>) can have a maximum\nof 100,000 elements. Each key-value pair in a map contains two elements,\nmeaning <a href=\"/pine-script-docs/v5/language/maps/\">maps</a> can contain a\nmaximum of 50,000 key-value pairs.</p>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/limitations", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"other-limitations\"><a href=\"#other-limitations\">Other limitations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"maximum-bars-back\"><a href=\"#maximum-bars-back\">Maximum bars back<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>References to past values using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_op_%5B%5D\">[]</a>\nhistory-referencing operator are dependent on the size of the historical\nbuffer maintained by the Pine Script runtime, which is limited to a\nmaximum of 5000 bars. <a href=\"https://www.tradingview.com/support/solutions/43000587849\">This Help Center\npage</a>\ndiscusses the historical buffer and how to change its size using either\nthe <code dir=\"auto\">max_bars_back</code> parameter or the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a>\nfunction.</p>\n<h3 class=\"md-heading\" id=\"maximum-bars-forward\"><a href=\"#maximum-bars-forward\">Maximum bars forward<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When positioning drawings using <code dir=\"auto\">xloc.bar_index</code>, it is possible to use\nbar index values greater than that of the current bar as <em>x</em>\ncoordinates. A maximum of 500 bars in the future can be referenced.</p>\n<p>This example shows how we use the [maxval] parameter in our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input%7Bdot%7Dint\">input.int()</a>\nfunction call to cap the user-defined number of bars forward we draw a\nprojection line so that it never exceeds the limit:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Max bars forward example\", overlay = true)\n\n// This function draws a `line` using bar index x-coordinates.\ndrawLine(bar1, y1, bar2, y2) =&gt;\n    // Only execute this code on the last bar.\n    if barstate.islast\n        // Create the line only the first time this function is executed on the last bar.\n        var line lin = line.new(bar1, y1, bar2, y2, xloc.bar_index)\n        // Change the line's properties on all script executions on the last bar.\n        line.set_xy1(lin, bar1, y1)\n        line.set_xy2(lin, bar2, y2)\n\n// Input determining how many bars forward we draw the `line`.\nint forwardBarsInput = input.int(10, \"Forward Bars to Display\", minval = 1, maxval = 500)\n\n// Calculate the line's left and right points.\nint   leftBar  = bar_index[2]\nfloat leftY    = high[2]\nint   rightBar = leftBar + forwardBarsInput\nfloat rightY   = leftY + (ta.change(high)[1] * forwardBarsInput)\n\n// This function call is executed on all bars, but it only draws the `line` on the last bar.\ndrawLine(leftBar, leftY, rightBar, rightY)</div>\n<h3 class=\"md-heading\" id=\"chart-bars\"><a href=\"#chart-bars\">Chart bars<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The number of bars appearing on charts is dependent on the amount of\nhistorical data available for the chart\u2019s symbol and timeframe, and on\nthe type of account you hold. When the required historical date is\navailable, the minimum number of chart bars is:</p>\n<ul>\n<li>40000 historical bars for the Ultimate plan.</li>\n<li>25000 historical bars for the Expert plan.</li>\n<li>20000 historical bars for the Premium plan.</li>\n<li>10000 historical bars for Essential and Plus plans.</li>\n<li>5000 historical bars for other plans.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"trade-orders-in-backtesting\"><a href=\"#trade-orders-in-backtesting\">Trade orders in backtesting<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>A maximum of 9000 orders can be placed when backtesting strategies. When\nusing Deep Backtesting, the limit is 1,000,000.</p>", "segment_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "c64b4790b8a63924d908aef73570af8f71dd7e70f7d82d9d30db0cdc3c962993", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/profiling-and-optimization", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/writing/profiling-and-optimization\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"profiling-and-optimization\"><a href=\"#profiling-and-optimization\">Profiling and optimization<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/profiling-and-optimization", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Pine Script\u00ae is a cloud-based compiled language geared toward efficient\nrepeated script execution. When a user adds a Pine script to a chart, it\nexecutes <em>numerous</em> times, once for each available bar or tick in the\ndata feeds it accesses, as explained in this manual\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">Execution model</a>\npage.</p>\n<p>The Pine Script compiler automatically performs several internal\noptimizations to accommodate scripts of various sizes and help them run\nsmoothly. However, such optimizations <em>do not</em> prevent performance\nbottlenecks in script executions. As such, it\u2019s up to programmers to\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">profile</a> a script\u2019s runtime performance and identify ways to modify\ncritical code blocks and lines when they need to improve execution\ntimes.</p>\n<p>This page covers how to profile and monitor a script\u2019s runtime and\nexecutions with the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Pine Profiler</a> and explains some ways programmers can modify their code to\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#optimization\">optimize</a> runtime performance.</p>\n<p>For a quick introduction, see the following video, where we profile an example script and optimize it step-by-step, examining several common script inefficiencies and explaining how to avoid them along the way:</p>\n<lite-youtube style=\"background-image: url('https://i.ytimg.com/vi/dQ7sbzWL0Dk/hqdefault.jpg');\" videoid=\"dQ7sbzWL0Dk\"> <a class=\"lty-playbtn\" href=\"https://youtube.com/watch?v=dQ7sbzWL0Dk\"> <span class=\"lyt-visually-hidden\"></span> </a> </lite-youtube>", "segment_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/profiling-and-optimization", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"pine-profiler\"><a href=\"#pine-profiler\">Pine Profiler<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Before diving into\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#optimization\">optimization</a>, it\u2019s prudent to evaluate a script\u2019s runtime and pinpoint\n<em>bottlenecks</em>, i.e., areas in the code that substantially impact overall\nperformance. With these insights, programmers can ensure they focus on\noptimizing where it truly matters instead of spending time and effort on\nlow-impact code.</p>\n<p>Enter the <em>Pine Profiler</em>, a powerful utility that analyzes the\nexecutions of all significant code lines and blocks in a script and\ndisplays helpful performance information next to the lines inside the\nPine Editor. By inspecting the Profiler\u2019s results, programmers can gain\na clearer perspective on a script\u2019s overall runtime, the distribution\nof runtime across its significant code regions, and the critical\nportions that may need extra attention and optimization.</p>\n<h3 class=\"md-heading\" id=\"profiling-a-script\"><a href=\"#profiling-a-script\">Profiling a script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The Pine Profiler can analyze the runtime performance of any <em>editable</em>\nscript coded in Pine Script v5. To profile a script, add it to the\nchart, open the source code in the Pine Editor, and select \u201cEnable\nprofiler mode\u201d from the dropdown next to the \u201cAdd to chart/Update on\nchart\u201d option in the top-right corner:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"286\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-a-script-1.Bm1SQAOz_ZcitjV.webp\" width=\"666\"/></p>\n<p>We will use the script below for our initial profiling example, which\ncalculates a custom <code dir=\"auto\">oscillator</code> based on average distances from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice to upper and lower\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.percentile_linear_interpolation\">percentiles</a>\nover <code dir=\"auto\">lengthInput</code> bars. It includes a few different types of\n<em>significant</em> code regions, which come with some differences in\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">interpretation</a> while profiling:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Pine Profiler demo\")\n\n//@variable The number of bars in the calculations.\nint lengthInput = input.int(100, \"Length\", 2)\n//@variable The percentage for upper percentile calculation.\nfloat upperPercentInput = input.float(75.0, \"Upper percentile\", 50.0, 100.0)\n//@variable The percentage for lower percentile calculation.\nfloat lowerPercentInput = input.float(25.0, \"Lower percentile\", 0.0, 50.0)\n\n// Calculate percentiles using the linear interpolation method.\nfloat upperPercentile = ta.percentile_linear_interpolation(close, lengthInput, upperPercentInput)\nfloat lowerPercentile = ta.percentile_linear_interpolation(close, lengthInput, lowerPercentInput)\n\n// Declare arrays for upper and lower deviations from the percentiles on the same line.\nvar upperDistances = array.new&lt;float&gt;(lengthInput), var lowerDistances = array.new&lt;float&gt;(lengthInput)\n\n// Queue distance values through the `upperDistances` and `lowerDistances` arrays based on excessive price deviations.\nif math.abs(close - 0.5 * (upperPercentile + lowerPercentile)) &gt; 0.5 * (upperPercentile - lowerPercentile)\n    array.push(upperDistances, math.max(close - upperPercentile, 0.0))\n    array.shift(upperDistances)\n    array.push(lowerDistances, math.max(lowerPercentile - close, 0.0))\n    array.shift(lowerDistances)\n\n//@variable The average distance from the `upperDistances` array.\nfloat upperAvg = upperDistances.avg()\n//@variable The average distance from the `lowerDistances` array.\nfloat lowerAvg = lowerDistances.avg()\n//@variable The ratio of the difference between the `upperAvg` and `lowerAvg` to their sum.\nfloat oscillator = (upperAvg - lowerAvg) / (upperAvg + lowerAvg)\n//@variable The color of the plot. A green-based gradient if `oscillator` is positive, a red-based gradient otherwise.\ncolor oscColor = oscillator &gt; 0 ?\n     color.from_gradient(oscillator, 0.0, 1.0, color.gray, color.green) :\n     color.from_gradient(oscillator, -1.0, 0.0, color.red, color.gray)\n\n// Plot the `oscillator` with the `oscColor`.\nplot(oscillator, \"Oscillator\", oscColor, style = plot.style_area)</div>\n<p>Once enabled, the Profiler collects information from all executions of\nthe script\u2019s significant code lines and blocks, then displays bars and\napproximate runtime percentages to the left of the code lines inside the\nPine Editor:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"670\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-a-script-2.Ud_wxirg_1toi2O.webp\" width=\"1342\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The Profiler tracks every execution of a significant code\nregion, including the executions on <em>realtime ticks</em>. Its\ninformation updates over time as new executions occur.</li>\n<li>Profiler results <strong>do not</strong> appear for script declaration\nstatements, type declarations, other <em>insignificant</em> code lines\nsuch as variable declarations with no tangible impact, <em>unused\ncode</em> that the script\u2019s outputs do not depend on, or\n<em>repetitive code</em> that the compiler optimizes during\ntranslation. See\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#insignificant-unused-and-redundant-code\">this section</a> for more information.</li>\n</ul>\n<p>When a script contains at least <em>four</em> significant lines of code, the\nProfiler will include \u201cflame\u201d icons next to the <em>top three</em> code\nregions with the highest performance impact. If one or more of the\nhighest-impact code regions are <em>outside</em> the lines visible inside the\nPine Editor, a \u201cflame\u201d icon and a number indicating how many critical\nlines are outside the view will appear at the top or bottom of the left\nmargin. Clicking the icon will vertically scroll the Editor\u2019s window to\nshow the nearest critical line:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"346\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-a-script-3.CRdP8jVv_Z2lC0Am.webp\" width=\"1342\"/></p>\n<p>Hovering the mouse pointer over the space next to a line highlights the\nanalyzed code and exposes a tooltip with additional information,\nincluding the time spent and the number of executions. The information\nshown next to each line and in the corresponding tooltip depends on the\nprofiled code region. The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">section below</a> explains different types of code the Profiler analyzes and\nhow to interpret their performance results.</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"588\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-a-script-4.B8hBGa6N_2sbc0.webp\" width=\"1342\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span></p><p>As with profiling tools for other languages, the Pine Profiler <em>wraps</em> a\nscript and its significant code with\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#a-look-into-the-profilers-inner-workings\">extra calculations</a> required to collect performance data. As such, a script\u2019s\nresource usage <strong>increases</strong> while profiling, and the Profiler\u2019s\nresults reflect the script\u2019s runtime with those calculations included.\nTherefore, one should interpret the results as <strong>estimates</strong> rather than\nprecise performance measurements.</p><p>Furthermore, the Profiler cannot collect and display individual\nperformance data for the <em>internal calculations</em> that also affect\nruntime, including the calculations required to track performance,\nmeaning the time values shown for all a script\u2019s code regions <strong>will\nnot</strong> add up to exactly 100% of its overall runtime.</p><p></p></div></aside>\n<h3 class=\"md-heading\" id=\"interpreting-profiled-results\"><a href=\"#interpreting-profiled-results\">Interpreting profiled results<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"single-line-results\"><a href=\"#single-line-results\">Single-line results<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>For a code line containing single-line expressions, the Profiler bar and\ndisplayed percentage represent the relative portion of the script\u2019s\ntotal runtime spent on that line. The corresponding tooltip displays\nthree fields:</p>\n<ul>\n<li>The \u201cLine number\u201d field indicates the analyzed code line.</li>\n<li>The \u201cTime\u201d field shows the runtime percentage for the line of\ncode, the runtime spent on that line, and the script\u2019s total\nruntime.</li>\n<li>The \u201cExecutions\u201d field shows the number of times that specific\nline executed while running the script.</li>\n</ul>\n<p>Here, we hovered the pointer over the space next to line 12 of our\nprofiled code to view its tooltip:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Single-line-results-1.DxmafMJF_Z1xuVkr.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">float upperPercentile = ta.percentile_linear_interpolation(close, lengthInput, upperPercentInput)</div>\n<p>Note that:</p>\n<ul>\n<li>The time information for the line represents the time spent\ncompleting <em>all</em> executions, <strong>not</strong> the time spent on a single\nexecution.</li>\n<li>To estimate the <em>average</em> time spent per execution, divide the\nline\u2019s time by the number of executions. In this case, the\ntooltip shows that line 12 took about 14.1 milliseconds to\nexecute 20,685 times, meaning the average time per execution was\napproximately 14.1 ms / 20685 = 0.0006816534 milliseconds\n(0.6816534 microseconds).</li>\n</ul>\n<p>When a line of code consists of more than one expression separated by\ncommas, the number of executions shown in the tooltip represents the\n<em>sum</em> of each expression\u2019s total executions, and the time value\ndisplayed represents the total time spent evaluating all the line\u2019s\nexpressions.</p>\n<p>For instance, this global line from our initial example includes two\n<a href=\"/pine-script-docs/v5/language/variable-declarations/\">variable declarations</a> separated by commas. Each uses the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword, meaning the script only executes them once on the first\navailable bar. As we see in the Profiler tooltip for the line, it\ncounted <em>two</em> executions (one for each expression), and the time value\nshown is the <em>combined</em> result from both expressions on the line:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Single-line-results-2.CGsjIphG_1lBWSK.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">var upperDistances = array.new&lt;float&gt;(lengthInput), var lowerDistances = array.new&lt;float&gt;(lengthInput)</div>\n<p>Note that:</p>\n<ul>\n<li>When analyzing scripts with more than one expression on the same\nline, we recommend moving each expression to a <em>separate line</em>\nfor more detailed insights while profiling, namely if they may\ncontain <em>higher-impact</em> calculations.</li>\n</ul>\n<p>When using\n<a href=\"/pine-script-docs/v5/writing/style-guide/#line-wrapping\">line wrapping</a> for readability or stylistic purposes, the Profiler\nconsiders all portions of a wrapped line as part of the <em>first line</em>\nwhere it starts in the Pine Editor.</p>\n<p>For example, although this code from our initial script occupies more\nthan one line in the Pine Editor, it\u2019s still treated as a <em>single</em> line\nof code, and the Profiler tooltip displays single-line results, with the\n\u201cLine number\u201d field showing the <em>first</em> line in the Editor that the\nwrapped line occupies:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Single-line-results-3.8u0gLHs0_yR0hQ.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">color oscColor = oscillator &gt; 0 ?\n     color.from_gradient(oscillator, 0.0, 1.0, color.gray, color.green) :\n     color.from_gradient(oscillator, -1.0, 0.0, color.red, color.gray)</div>\n<h4 class=\"md-heading\" id=\"code-block-results\"><a href=\"#code-block-results\">Code block results<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>For a line at the start of a <a href=\"/pine-script-docs/v5/language/loops/\">loop</a> or\n<a href=\"/pine-script-docs/v5/language/conditional-structures/\">conditional structure</a>, the Profiler bar and percentage represent the relative\nportion of the script\u2019s runtime spent on the <strong>entire code block</strong>, not\njust the single line. The corresponding tooltip displays four fields:</p>\n<ul>\n<li>The \u201cCode block range\u201d field indicates the range of lines included\nin the structure.</li>\n<li>The \u201cTime\u201d field shows the code block\u2019s runtime percentage, the\ntime spent on all block executions, and the script\u2019s total runtime.</li>\n<li>The \u201cLine time\u201d field shows the runtime percentage for the\nblock\u2019s initial line, the time spent on that line, and the\nscript\u2019s total runtime. The interpretation differs for\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nblocks or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nblocks <em>with</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">else\nif</a>\nstatements, as the values represent the total time spent on <strong>all</strong>\nthe structure\u2019s conditional statements. See below for more\ninformation.</li>\n<li>The \u201cExecutions\u201d field shows the number of times the code block\nexecuted while running the script.</li>\n</ul>\n<p>Here, we hovered over the space next to line 19 in our initial script,\nthe beginning of a simple\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure <em>without</em> <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">else\nif</a>\nstatements. As we see below, the tooltip shows performance information\nfor the entire code block and the current line:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Code-block-results-1.Cp7Cs5Lf_Z1aX7Bw.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">if math.abs(close - 0.5 * (upperPercentile + lowerPercentile)) &gt; 0.5 * (upperPercentile - lowerPercentile)\n    array.push(upperDistances, math.max(close - upperPercentile, 0.0))\n    array.shift(upperDistances)\n    array.push(lowerDistances, math.max(lowerPercentile - close, 0.0))\n    array.shift(lowerDistances)</div>\n<p>Note that:</p>\n<ul>\n<li>The \u201cTime\u201d field shows that the total time spent evaluating\nthe structure 20,685 times was 7.2 milliseconds.</li>\n<li>The \u201cLine time\u201d field indicates that the runtime spent on the\n<em>first line</em> of this\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure was about three milliseconds.</li>\n</ul>\n<p>Users can also inspect the results from lines and nested blocks within a\ncode block\u2019s range to gain more granular performance insights. Here, we\nhovered over the space next to line 20 within the code block to view its\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#single-line-results\">single-line result</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Code-block-results-2.Cy1_m4AY_ZsCh1h.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The number of executions shown is <em>less than</em> the result for the\nentire code block, as the condition that controls the execution\nof this line does not return <code dir=\"auto\">true</code> all the time. The opposite\napplies to the code inside <a href=\"/pine-script-docs/v5/language/loops/\">loops</a> since each execution of a loop statement can trigger\n<strong>several</strong> executions of the loop\u2019s local block.</li>\n</ul>\n<p>When profiling a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure or an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure that includes <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">else\nif</a>\nstatements, the \u201cLine time\u201d field will show the time spent executing\n<strong>all</strong> the structure\u2019s conditional expressions, <strong>not</strong> just the\nblock\u2019s first line. The results for the lines inside the code block\nrange will show runtime and executions for each <strong>local block</strong>. This\nformat is necessary for these structures due to the Profiler\u2019s\ncalculation and display constraints. See\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#a-look-into-the-profilers-inner-workings\">this section</a> for more information.</p>\n<p>For example, the \u201cLine time\u201d for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure in this script represents the time spent evaluating <em>all four</em>\nconditional statements within its body, as the Profiler <em>cannot</em> track\nthem separately. The results for each line in the code block\u2019s range\nrepresent the performance information for each <em>local block</em>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Code-block-results-3.D12wyQyn_ZXHSFp.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`switch` and `if...else if` results demo\")\n\n//@variable The upper band for oscillator calculation.\nvar float upperBand = close\n//@variable The lower band for oscillator calculation.\nvar float lowerBand = close\n\n// Update the `upperBand` and `lowerBand` based on the proximity of the `close` to the current band values.\n// The \"Line time\" field on line 11 represents the time spent on all 4 conditional expressions in the structure.\nswitch\n    close &gt; upperBand                     =&gt; upperBand := close\n    close &lt; lowerBand                     =&gt; lowerBand := close\n    upperBand - close &gt; close - lowerBand =&gt; upperBand := 0.9 * upperBand + 0.1 * close\n    close - lowerBand &gt; upperBand - close =&gt; lowerBand := 0.9 * lowerBand + 0.1 * close\n\n//@variable The ratio of the difference between `close` and `lowerBand` to the band range.\nfloat oscillator = 100.0 * (close - lowerBand) / (upperBand - lowerBand)\n\n// Plot the `oscillator` as columns with a dynamic color.\nplot(\n     oscillator, \"Oscillator\", oscillator &gt; 50.0 ? color.teal : color.maroon,\n     style = plot.style_columns, histbase = 50.0\n )</div>\n<p>When the conditional logic in such structures involves significant\ncalculations, programmers may require more granular performance\ninformation for each calculated condition. An effective way to achieve\nthis analysis is to use <em>nested</em>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> blocks\ninstead of the more compact\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nor <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\u2026else\nif</a>\nstructures. For example, instead of:</p>\n<div class=\"pine-colorizer not-content\">switch\n    &lt;expression1&gt; =&gt; &lt;localBlock1&gt;\n    &lt;expression2&gt; =&gt; &lt;localBlock2&gt;\n    =&gt;               &lt;localBlock3&gt;</div>\n<p>or:</p>\n<div class=\"pine-colorizer not-content\">if &lt;expression1&gt;\n    &lt;localBlock1&gt;\nelse if &lt;expression2&gt;\n    &lt;localBlock2&gt;\nelse\n    &lt;localBlock3&gt;</div>\n<p>one can use nested\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> blocks\nfor more in-depth profiling while maintaining the same logical flow:</p>\n<div class=\"pine-colorizer not-content\">if &lt;expression1&gt;\n    &lt;localBlock1&gt;\nelse\n    if &lt;expression2&gt;\n        &lt;localBlock2&gt;\n    else\n        &lt;localBlock3&gt;</div>\n<p>Below, we changed the previous\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nexample to an equivalent nested\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure. Now, we can view the runtime and executions for each\nsignificant part of the conditional pattern individually:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"338\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Code-block-results-4.OxkZ6XRw_Zs1azS.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"`switch` and `if...else if` results demo\")\n\n//@variable The upper band for oscillator calculation.\nvar float upperBand = close\n//@variable The lower band for oscillator calculation.\nvar float lowerBand = close\n\n// Update the `upperBand` and `lowerBand` based on the proximity of the `close` to the current band values.\nif close &gt; upperBand\n    upperBand := close\nelse\n    if close &lt; lowerBand\n        lowerBand := close\n    else\n        if upperBand - close &gt; close - lowerBand\n            upperBand := 0.9 * upperBand + 0.1 * close\n        else\n            if close - lowerBand &gt; upperBand - close\n                lowerBand := 0.9 * lowerBand + 0.1 * close\n\n//@variable The ratio of the difference between `close` and `lowerBand` to the band range.\nfloat oscillator = 100.0 * (close - lowerBand) / (upperBand - lowerBand)\n\n// Plot the `oscillator` as columns with a dynamic color.\nplot(\n     oscillator, \"Oscillator\", oscillator &gt; 50.0 ? color.teal : color.maroon,\n     style = plot.style_columns, histbase = 50.0\n )</div>\n<p>Note that:</p>\n<ul>\n<li>This same process can also apply to <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_?:\">ternary\nexpressions</a>.\nWhen a complex ternary expression\u2019s operands contain\nsignificant calculations, reorganizing the logic into a nested\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure allows more detailed Profiler results, making it\neasier to spot critical parts.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"user-defined-function-calls\"><a href=\"#user-defined-function-calls\">User-defined function calls<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><a href=\"/pine-script-docs/v5/language/user-defined-functions/\">User-defined functions</a> and\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nare functions written by users. They encapsulate code sequences that a\nscript may execute several times. Users often write functions and\nmethods for improved code modularity, reusability, and maintainability.</p>\n<p>The indented lines of code within a function represent its <em>local\nscope</em>, i.e., the sequence that executes <em>each time</em> the script calls\nit. Unlike code in a script\u2019s global scope, which a script evaluates\nonce on each execution, the code inside a function may activate zero,\none, or <em>multiple times</em> on each script execution, depending on the\nconditions that trigger the calls, the number of calls that occur, and\nthe function\u2019s logic.</p>\n<p>This distinction is crucial to consider while interpreting Profiler\nresults. When a profiled code contains\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\ncalls:</p>\n<ul>\n<li>The results for each <em>function call</em> reflect the runtime allocated\ntoward it and the total number of times the script activated that\nspecific call.</li>\n<li>The time and execution information for all local code <em>inside</em> a\nfunction\u2019s scope reflects the combined results from <strong>all</strong> calls\nto the function.</li>\n</ul>\n<p>This example contains a user-defined <code dir=\"auto\">similarity()</code> function that\nestimates the similarity of two series, which the script calls only\n<em>once</em> from the global scope on each execution. In this case, the\nProfiler\u2019s results for the code inside the function\u2019s body correspond\nto that specific call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"328\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-User-defined-function-calls-1.DUf4uWCa_1zRHzX.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"User-defined function calls demo\")\n\n//@function Estimates the similarity between two standardized series over `length` bars.\n//          Each individual call to this function activates its local scope.\nsimilarity(float sourceA, float sourceB, int length) =&gt;\n    // Standardize `sourceA` and `sourceB` for comparison.\n    float normA = (sourceA - ta.sma(sourceA, length)) / ta.stdev(sourceA, length)\n    float normB = (sourceB - ta.sma(sourceB, length)) / ta.stdev(sourceB, length)\n    // Calculate and return the estimated similarity of `normA` and `normB`.\n    float abSum = math.sum(normA * normB, length)\n    float a2Sum = math.sum(normA * normA, length)\n    float b2Sum = math.sum(normB * normB, length)\n    abSum / math.sqrt(a2Sum * b2Sum)\n\n// Plot the similarity between the `close` and an offset `close` series.\nplot(similarity(close, close[1], 100), \"Similarity 1\", color.red)</div>\n<p>Let\u2019s increase the number of times the script calls the function each\ntime it executes. Here, we changed the script to call our\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> <em>five times</em>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"User-defined function calls demo\")\n\n//@function Estimates the similarity between two standardized series over `length` bars.\n//          Each individual call to this function activates its local scope.\nsimilarity(float sourceA, float sourceB, int length) =&gt;\n    // Standardize `sourceA` and `sourceB` for comparison.\n    float normA = (sourceA - ta.sma(sourceA, length)) / ta.stdev(sourceA, length)\n    float normB = (sourceB - ta.sma(sourceB, length)) / ta.stdev(sourceB, length)\n    // Calculate and return the estimated similarity of `normA` and `normB`.\n    float abSum = math.sum(normA * normB, length)\n    float a2Sum = math.sum(normA * normA, length)\n    float b2Sum = math.sum(normB * normB, length)\n    abSum / math.sqrt(a2Sum * b2Sum)\n\n// Plot the similarity between the `close` and several offset `close` series.\nplot(similarity(close, close[1], 100), \"Similarity 1\", color.red)\nplot(similarity(close, close[2], 100), \"Similarity 2\", color.orange)\nplot(similarity(close, close[4], 100), \"Similarity 3\", color.green)\nplot(similarity(close, close[8], 100), \"Similarity 4\", color.blue)\nplot(similarity(close, close[16], 100), \"Similarity 5\", color.purple)</div>\n<p>In this case, the local code results no longer correspond to a <em>single</em>\nevaluation per script execution. Instead, they represent the <em>combined</em>\nruntime and executions of the local code from <strong>all five</strong> calls. As we\nsee below, the results after running this version of the script across\nthe same data show 137,905 executions of the local code, <em>five times</em>\nthe number from when the script only contained one <code dir=\"auto\">similarity()</code>\nfunction call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"386\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-User-defined-function-calls-2.BJPTeot1_Z1mNfz1.webp\" width=\"1072\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>When the local scopes of a script\u2019s\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\ncontain calls to <code dir=\"auto\">request.*()</code> functions, the <em>translated form</em> of the\nscript extracts such calls <strong>outside</strong> the functions\u2019 scopes and\nevaluates them <strong>separately</strong>. Consequently, the Profiler\u2019s results for\nlines with calls to those\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> <strong>will not</strong> include the time spent on the <code dir=\"auto\">request.*()</code>\ncalls. See the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#when-requesting-other-contexts\">section below</a> to learn more.</p></div></aside>\n<h4 class=\"md-heading\" id=\"when-requesting-other-contexts\"><a href=\"#when-requesting-other-contexts\">When requesting other contexts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>Pine scripts can request data from other <em>contexts</em>, i.e., different\nsymbols, timeframes, or data modifications than what the chart\u2019s data\nuses by calling the <code dir=\"auto\">request.*()</code> family of functions or specifying an\nalternate <code dir=\"auto\">timeframe</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\ndeclaration statement.</p>\n<p>When a script requests data from another context, it evaluates all\nrequired scopes and calculations within that context, as explained in\nthe\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page. This behavior can affect the runtime of a script\u2019s\ncode regions and the number of times they execute.</p>\n<p>The Profiler information for any code\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#single-line-results\">line</a> or\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">block</a> represents the results from executing the code in <em>all\nnecessary contexts</em>, which may or may not include the chart\u2019s data.\nPine Script determines which contexts to execute code within based on\nthe calculations required by a script\u2019s data requests and outputs.</p>\n<p>Let\u2019s look at a simple example. This initial script only uses the\nchart\u2019s data for its calculations. It declares a <code dir=\"auto\">pricesArray</code> variable\nwith the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeyword, meaning the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nassigned to it persists across the data\u2019s history and all available\nrealtime ticks. On each execution, the script calls\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nto push a new\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalue into the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nand it <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array\u2019s\nsize</a>.</p>\n<p>After profiling the script across all the bars on an intraday chart, we\nsee that the number of elements in the <code dir=\"auto\">pricesArray</code> corresponds to the\nnumber of executions the Profiler shows for the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\ncall on line 8:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"384\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-When-requesting-other-contexts-1.4ixtln-7_gTemj.webp\" width=\"1250\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"When requesting other contexts demo\")\n\n//@variable An array containing the `close` value from every available price update.\nvarip array&lt;float&gt; pricesArray = array.new&lt;float&gt;()\n\n// Push a new `close` value into the `pricesArray` on each update.\narray.push(pricesArray, close)\n\n// Plot the size of the `pricesArray`.\nplot(array.size(pricesArray), \"Total number of chart price updates\")</div>\n<p>Now, let\u2019s try evaluating the size of the <code dir=\"auto\">pricesArray</code> from <em>another\ncontext</em> instead of using the chart\u2019s data. Below, we\u2019ve added a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size(pricesArray)</a>\nas its <code dir=\"auto\">expression</code> argument to retrieve the value calculated on the\n\u201c1D\u201d timeframe and plotted that result instead.</p>\n<p>In this case, the number of executions the Profiler shows on line 8\nstill corresponds to the number of elements in the <code dir=\"auto\">pricesArray</code>.\nHowever, it did not execute the same number of times since the script\ndid not require the <em>chart\u2019s data</em> in the calculations. It only needed\nto initialize the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nand evaluate\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nacross all the requested <em>daily data</em>, which has a different number of\nprice updates than our current intraday chart:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"384\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-When-requesting-other-contexts-2.COS2z1lh_s4Tg3.webp\" width=\"1250\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"When requesting other contexts demo\")\n\n//@variable An array containing the `close` value from every available price update.\nvarip array&lt;float&gt; pricesArray = array.new&lt;float&gt;()\n\n// Push a new `close` value into the `pricesArray` on each update.\narray.push(pricesArray, close)\n\n// Plot the size of the `pricesArray` requested from the daily timeframe.\nplot(request.security(syminfo.tickerid, \"1D\", array.size(pricesArray)), \"Total number of daily price updates\")</div>\n<p>Note that:</p>\n<ul>\n<li>The requested EOD data in this example had fewer data points\nthan our intraday chart, so the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\ncall required fewer executions in this case. However, EOD feeds\n<em>do not</em> have history limitations, meaning it\u2019s also possible\nfor requested HTF data to span <strong>more</strong> bars than a user\u2019s\nchart, depending on the timeframe, the data provider, and the\nuser\u2019s <a href=\"https://www.tradingview.com/pricing/\">plan</a>.</li>\n</ul>\n<p>If this script were to plot the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.size\">array.size()</a>\nvalue directly in addition to the requested daily value, it would then\nrequire the creation of <em>two</em> <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> (one for each context) and the execution of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\nacross both the chart\u2019s data <em>and</em> the data from the daily timeframe.\nAs such, the declaration on line 5 will execute <em>twice</em>, and the results\non line 8 will reflect the time and executions accumulated from\nevaluating the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.push\">array.push()</a>\ncall across <strong>both separate datasets</strong>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"384\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-When-requesting-other-contexts-3.CPXHEchh_1SVGGO.webp\" width=\"1250\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"When requesting other contexts demo\")\n\n//@variable An array containing the `close` value from every available price update.\nvarip array&lt;float&gt; pricesArray = array.new&lt;float&gt;()\n\n// Push a new `close` value into the `pricesArray` on each update.\narray.push(pricesArray, close)\n\n// Plot the size of the `pricesArray` from the daily timeframe and the chart's context.\n// Including both in the outputs requires executing line 5 and line 8 across BOTH datasets.  \nplot(request.security(syminfo.tickerid, \"1D\", array.size(pricesArray)), \"Total number of daily price updates\")\nplot(array.size(pricesArray), \"Total number of chart price updates\")</div>\n<p>It\u2019s important to note that when a script calls a\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\nthat contains <code dir=\"auto\">request.*()</code> calls in its local scope, the script\u2019s\n<em>translated form</em> extracts the <code dir=\"auto\">request.*()</code> calls <strong>outside</strong> the scope\nand encapsulates the expressions they depend on within <strong>separate\nfunctions</strong>. When the script executes, it evaluates the required\n<code dir=\"auto\">request.*()</code> calls first, then <em>passes</em> the requested data to a\n<em>modified form</em> of the\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a>.</p>\n<p>Since the translated script executes a\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function\u2019s</a> data requests separately <strong>before</strong> evaluating non-requested\ncalculations in its local scope, the Profiler\u2019s results for lines\ncontaining calls to the function <strong>will not</strong> include the time spent on\nits <code dir=\"auto\">request.*()</code> calls or their required expressions.</p>\n<p>As an example, the following script contains a user-defined\n<code dir=\"auto\">getCompositeAvg()</code> function with a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall that requests the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.avg\">math.avg()</a>\nof 10\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.wma\">ta.wma()</a>\ncalls with different <code dir=\"auto\">length</code> arguments from a specified <code dir=\"auto\">symbol</code>. The\nscript uses the function to request the average result using a <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ticker.heikinashi\">Heikin\nAshi</a>\nticker ID:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"User-defined functions with `request.*()` calls demo\", overlay = true)\n\nint multInput = input.int(10, \"Length multiplier\", 1)\n\nstring tickerID = ticker.heikinashi(syminfo.tickerid)\n\ngetCompositeAvg(string symbol, int lengthMult) =&gt;\n    request.security(\n         symbol, timeframe.period, math.avg(\n             ta.wma(close, lengthMult), ta.wma(close, 2 * lengthMult), ta.wma(close, 3 * lengthMult), \n             ta.wma(close, 4 * lengthMult), ta.wma(close, 5 * lengthMult), ta.wma(close, 6 * lengthMult),\n             ta.wma(close, 7 * lengthMult), ta.wma(close, 8 * lengthMult), ta.wma(close, 9 * lengthMult), \n             ta.wma(close, 10 * lengthMult)\n         )\n     )\n\nplot(getCompositeAvg(tickerID, multInput), \"Composite average\", linewidth = 3)</div>\n<p>After profiling the script, users might be surprised to see that the\nruntime results shown inside the function\u2019s body heavily <strong>exceed</strong> the\nresults shown for the <em>single</em> <code dir=\"auto\">getCompositeAvg()</code> call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"342\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-When-requesting-other-contexts-4.CkN5cmYP_xCyjm.webp\" width=\"1072\"/></p>\n<p>The results appear this way since the translated script includes\ninternal modifications that <em>moved</em> the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall and its expression <strong>outside</strong> the function\u2019s scope, and the\nProfiler has no way to represent the results from those calculations\nother than displaying them next to the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nline in this scenario. The code below roughly illustrates how the\ntranslated script looks:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"User-defined functions with `request.*()` calls demo\", overlay = true)\n\nint multInput = input.int(10, \"Length multiplier\")\n\nstring tickerID = ticker.heikinashi(syminfo.tickerid)\n\nsecExpr(int lengthMult)=&gt;\n    math.avg(\n         ta.wma(close, lengthMult), ta.wma(close, 2 * lengthMult), ta.wma(close, 3 * lengthMult),\n         ta.wma(close, 4 * lengthMult), ta.wma(close, 5 * lengthMult), ta.wma(close, 6 * lengthMult),\n         ta.wma(close, 7 * lengthMult), ta.wma(close, 8 * lengthMult), ta.wma(close, 9 * lengthMult),\n         ta.wma(close, 10 * lengthMult)\n     )\n\nfloat sec = request.security(tickerID, timeframe.period, secExpr(multInput))\n\ngetCompositeAvg(float s) =&gt;\n    s\n\nplot(getCompositeAvg(sec), \"Composite average\", linewidth = 3)</div>\n<p>Note that:</p>\n<ul>\n<li>The <code dir=\"auto\">secExpr()</code> code represents the <em>separate function</em> used by\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nto calculate the required expression in the requested context.</li>\n<li>The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall takes place in the <strong>outer scope</strong>, outside the\n<code dir=\"auto\">getCompositeAvg()</code> function.</li>\n<li>The translation substantially reduced the local code of\n<code dir=\"auto\">getCompositeAvg()</code>. It now solely returns a value passed into\nit, as all the function\u2019s required calculations take place\n<strong>outside</strong> its scope. Due to this reduction, the function\ncall\u2019s performance results <strong>will not</strong> reflect any of the time\nspent on the data request\u2019s required calculations.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"insignificant-unused-and-redundant-code\"><a href=\"#insignificant-unused-and-redundant-code\">Insignificant, unused, and redundant code<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When inspecting a profiled script\u2019s results, it\u2019s crucial to\nunderstand that <em>not all</em> code in a script necessarily impacts runtime\nperformance. Some code has no direct performance impact, such as a\nscript\u2019s declaration statement and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_type\">type</a>\ndeclarations. Other code regions with insignificant expressions, such as\nmost <code dir=\"auto\">input.*()</code> calls, variable references, or\n<a href=\"/pine-script-docs/v5/language/variable-declarations/\">variable declarations</a> without significant calculations, have little to <em>no effect</em>\non a script\u2019s runtime. Therefore, the Profiler will <strong>not</strong> display\nperformance results for these types of code.</p>\n<p>Additionally, Pine scripts do not execute code regions that their\n<em>outputs</em> (<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a>,\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawings</a>,\n<a href=\"/pine-script-docs/v5/writing/debugging/#pine-logs\">logs</a>, etc.) do\nnot depend on, as the compiler automatically <strong>removes</strong> them during\ntranslation. Since unused code regions have <em>zero</em> impact on a script\u2019s\nperformance, the Profiler will <strong>not</strong> display any results for them.</p>\n<p>The following example contains a <code dir=\"auto\">barsInRange</code> variable and a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nthat adds 1 to the variable\u2019s value for each historical\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice between the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_high\">high</a>\nand <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_low\">low</a>\nover <code dir=\"auto\">lengthInput</code> bars. However, the script <strong>does not use</strong> these\ncalculations in its outputs, as it only\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice. Consequently, the script\u2019s compiled form <strong>discards</strong> that\nunused code and only considers the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot(close)</a>\ncall.</p>\n<p>The Profiler does not display <strong>any</strong> results for this script since it\ndoes not execute any <strong>significant</strong> calculations:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"350\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Insignificant-unused-and-redundant-code-1.CVzX40Kz_HGwJR.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Unused code demo\")\n\n//@variable The number of historical bars in the calculation.\nint lengthInput = input.int(100, \"Length\", 1)\n\n//@variable The number of closes over `lengthInput` bars between the current bar's `high` and `low`.\nint barsInRange = 0\n\nfor i = 1 to lengthInput\n    //@variable The `close` price from `i` bars ago.\n    float pastClose = close[i]\n    // Add 1 to `barsInRange` if the `pastClose` is between the current bar's `high` and `low`.\n    if pastClose &gt; low and pastClose &lt; high\n        barsInRange += 1\n\n// Plot the `close` price. This is the only output. \n// Since the outputs do not require any of the above calculations, the compiled script will not execute them.\nplot(close)</div>\n<p>Note that:</p>\n<ul>\n<li>Although this script does not use the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\nfrom line 5 and discards all its associated calculations, the\n\u201cLength\u201d input <em>will</em> still appear in the script\u2019s settings,\nas the compiler <strong>does not</strong> completely remove unused\n<a href=\"/pine-script-docs/v5/concepts/inputs/\">inputs</a>.</li>\n</ul>\n<p>If we change the script to plot the <code dir=\"auto\">barsInRange</code> value instead, the\ndeclared variables and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nare no longer unused since the output depends on them, and the Profiler\nwill now display performance information for that code:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"334\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Insignificant-unused-and-redundant-code-2.TBOBJdXS_Z1yftUf.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Unused code demo\")\n\n//@variable The number of historical bars in the calculation.\nint lengthInput = input.int(100, \"Length\", 1)\n\n//@variable The number of closes over `lengthInput` bars between the current bar's `high` and `low`.\nint barsInRange = 0\n\nfor i = 1 to lengthInput\n    //@variable The `close` price from `i` bars ago.\n    float pastClose = close[i]\n    // Add 1 to `barsInRange` if the `pastClose` is between the current bar's `high` and `low`.\n    if pastClose &gt; low and pastClose &lt; high\n        barsInRange += 1\n\n// Plot the `barsInRange` value. The above calculations will execute since the output requires them.\nplot(barsInRange, \"Bars in range\")</div>\n<p>Note that:</p>\n<ul>\n<li>The Profiler does not show performance information for the\n<code dir=\"auto\">lengthInput</code> declaration on line 5 or the <code dir=\"auto\">barsInRange</code>\ndeclaration on line 8 since the expressions on these lines do\nnot impact the script\u2019s performance.</li>\n</ul>\n<p>When possible, the compiler also simplifies certain instances of\n<em>redundant code</em> in a script, such as some forms of identical\nexpressions with the same\n<a href=\"/pine-script-docs/v5/language/type-system/#types\">fundamental type</a>\nvalues. This optimization allows the compiled script to only execute\nsuch calculations <em>once</em>, on the first occurrence, and <em>reuse</em> the\ncalculated result for each repeated instance that the outputs depend on.</p>\n<p>If a script contains repetitive code and the compiler simplifies it, the\nProfiler will only show results for the <strong>first occurrence</strong> of the code\nsince that\u2019s the only time the script requires the calculation.</p>\n<p>For example, this script contains a code line that plots the value of\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(close,\n100)</a>\nand 12 code lines that plot the value of <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(close,\n500)</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Redundant calculations demo\", overlay = true)\n\n// Plot the 100-bar SMA of `close` values one time.\nplot(ta.sma(close, 100), \"100-bar SMA\", color.teal, 3)\n\n// Plot the 500-bar SMA of `close` values 12 times. After compiler optimizations, only the first `ta.sma(close, 500)`\n// call on line 9 requires calculation in this case.\nplot(ta.sma(close, 500), \"500-bar SMA\", #001aff, 12)\nplot(ta.sma(close, 500), \"500-bar SMA\", #4d0bff, 11)\nplot(ta.sma(close, 500), \"500-bar SMA\", #7306f7, 10)\nplot(ta.sma(close, 500), \"500-bar SMA\", #920be9, 9)\nplot(ta.sma(close, 500), \"500-bar SMA\", #ae11d5, 8)\nplot(ta.sma(close, 500), \"500-bar SMA\", #c618be, 7)\nplot(ta.sma(close, 500), \"500-bar SMA\", #db20a4, 6)\nplot(ta.sma(close, 500), \"500-bar SMA\", #eb2c8a, 5)\nplot(ta.sma(close, 500), \"500-bar SMA\", #f73d6f, 4)\nplot(ta.sma(close, 500), \"500-bar SMA\", #fe5053, 3)\nplot(ta.sma(close, 500), \"500-bar SMA\", #ff6534, 2)\nplot(ta.sma(close, 500), \"500-bar SMA\", #ff7a00, 1)</div>\n<p>Since the last 12 lines all contain identical\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\ncalls, the compiler can automatically simplify the script so that it\nonly needs to evaluate <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma(close,\n500)</a>\n<em>once</em> per execution rather than repeating the calculation 11 more\ntimes.</p>\n<p>As we see below, the Profiler only shows results for lines 5 and 9.\nThese are the only parts of the code requiring significant calculations\nsince the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.sma\">ta.sma()</a>\ncalls on lines 10-20 are redundant in this case:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"368\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Insignificant-unused-and-redundant-code-3.B3yrx82E_2jeci8.webp\" width=\"1072\"/></p>\n<p>Another type of repetitive code optimization occurs when a script\ncontains two or more\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> or\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">methods</a>\nwith identical compiled forms. In such a case, the compiler simplifies\nthe script by <strong>removing</strong> the redundant functions, and the script will\ntreat all calls to the redundant functions as calls to the <strong>first</strong>\ndefined version. Therefore, the Profiler will only show local code\nperformance results for the <em>first</em> function since the discarded\n\u201cclones\u201d will never execute.</p>\n<p>For instance, the script below contains two\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a>, <code dir=\"auto\">metallicRatio()</code> and <code dir=\"auto\">calcMetallic()</code>, that calculate a\n<a href=\"https://en.wikipedia.org/wiki/Metallic_mean\" rel=\"nofollow\">metallic ratio</a> of a given\norder raised to a specified exponent:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Redundant functions demo\")\n\n//@variable Controls the base ratio for the `calcMetallic()` call.\nint order1Input = input.int(1, \"Order 1\", 1)\n//@variable Controls the base ratio for the `metallicRatio()` call.\nint order2Input = input.int(2, \"Order 2\", 1)\n\n//@function       Calculates the value of a metallic ratio with a given `order`, raised to a specified `exponent`.\n//@param order    Determines the base ratio used. 1 = Golden Ratio, 2 = Silver Ratio, 3 = Bronze Ratio, and so on.\n//@param exponent The exponent applied to the ratio.\nmetallicRatio(int order, float exponent) =&gt;\n    math.pow((order + math.sqrt(4.0 + order * order)) * 0.5, exponent)\n\n//@function       A function with the same signature and body as `metallicRatio()`.\n//                The script discards this function and treats `calcMetallic()` as an alias for `metallicRatio()`.\ncalcMetallic(int ord, float exp) =&gt;\n    math.pow((ord + math.sqrt(4.0 + ord * ord)) * 0.5, exp)\n\n// Plot the results from a `calcMetallic()` and `metallicRatio()` call.\nplot(calcMetallic(order1Input, bar_index % 5), \"Ratio 1\", color.orange, 3)\nplot(metallicRatio(order2Input, bar_index % 5), \"Ratio 2\", color.maroon)</div>\n<p>Despite the differences in the function and parameter names, the two\nfunctions are otherwise identical, which the compiler detects while\ntranslating the script. In this case, it <strong>discards</strong> the redundant\n<code dir=\"auto\">calcMetallic()</code> function, and the compiled script treats the\n<code dir=\"auto\">calcMetallic()</code> call as a <code dir=\"auto\">metallicRatio()</code> call.</p>\n<p>As we see here, the Profiler shows performance information for the\n<code dir=\"auto\">calcMetallic()</code> and <code dir=\"auto\">metallicRatio()</code> calls on lines 21 and 22, but it\ndoes <strong>not</strong> show any results for the local code of the <code dir=\"auto\">calcMetallic()</code>\nfunction on line 18. Instead, the Profiler\u2019s information on line 13\nwithin the <code dir=\"auto\">metallicRatio()</code> function reflects the local code results\nfrom <strong>both</strong>\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#user-defined-function-calls\">function calls</a>:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"416\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Interpreting-profiled-results-Insignificant-unused-and-redundant-code-4.DrYo57fh_Z1tHCEy.webp\" width=\"1072\"/></p>\n<h3 class=\"md-heading\" id=\"a-look-into-the-profilers-inner-workings\"><a href=\"#a-look-into-the-profilers-inner-workings\">A look into the Profiler\u2019s inner workings<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The Pine Profiler wraps all necessary code regions with specialized\n<em>internal functions</em> to track and collect required information across\nscript executions. It then passes the information to additional\ncalculations that organize and display the performance results inside\nthe Pine Editor. This section gives users a peek into how the Profiler\napplies internal functions to wrap Pine code and collect performance\ndata.</p>\n<p>There are two main internal <strong>(non-Pine)</strong> functions the Profiler wraps\nsignificant code with to facilitate runtime analysis. The first function\nretrieves the current system time at specific points in the script\u2019s\nexecution, and the second maps cumulative elapsed time and execution\ndata to specific code regions. We represent these functions in this\nexplanation as <code dir=\"auto\">System.timeNow()</code> and <code dir=\"auto\">registerPerf()</code> respectively.</p>\n<p>When the Profiler detects code that requires analysis, it adds\n<code dir=\"auto\">System.timeNow()</code> above the code to get the initial time before\nexecution. Then, it adds <code dir=\"auto\">registerPerf()</code> below the code to map and\naccumulate the elapsed time and number of executions. The elapsed time\nadded on each <code dir=\"auto\">registerPerf()</code> call is the <code dir=\"auto\">System.timeNow()</code> value\n<em>after</em> the execution minus the value <em>before</em> the execution.</p>\n<p>The following <em>pseudocode</em> outlines this process for a\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#single-line-results\">single line</a> of code, where <code dir=\"auto\">_startX</code> represents the starting time for\nthe <code dir=\"auto\">lineX</code> line:</p>\n<div class=\"pine-colorizer not-content\">long _startX = System.timeNow()\n&lt;code_line_to_analyze&gt;\nregisterPerf(System.timeNow() - _startX, lineX)</div>\n<p>The process is similar for\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">code blocks</a>. The difference is that the <code dir=\"auto\">registerPerf()</code> call maps the\ndata to a <em>range of lines</em> rather than a single line. Here, <code dir=\"auto\">lineX</code>\nrepresents the <em>first</em> line in the code block, and <code dir=\"auto\">lineY</code> represents\nthe block\u2019s <em>last</em> line:</p>\n<div class=\"pine-colorizer not-content\">long _startX = System.timeNow()\n&lt;code_block_to_analyze&gt;\nregisterPerf(System.timeNow() - _startX, lineX, lineY)</div>\n<p>Note that:</p>\n<ul>\n<li>In the above snippets, <code dir=\"auto\">long</code>, <code dir=\"auto\">System.timeNow()</code>, and\n<code dir=\"auto\">registerPerf()</code> represent <em>internal code</em>, <strong>not</strong> Pine Script\ncode.</li>\n</ul>\n<p>Let\u2019s now look at how the Profiler wraps a full script and all its\nsignificant code. We will start with this script, which calculates three\npseudorandom series and displays their\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.avg\">average</a>\nresult. The script utilizes an <a href=\"/pine-script-docs/v5/language/objects/\">object</a> of a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type</a> to store a pseudorandom state, a\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\nto calculate new values and update the state, and an <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if\u2026else\nif</a>\nstructure to update each series based on generated values:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Profiler's inner workings demo\")\n\nint seedInput = input.int(12345, \"Seed\")\n\ntype LCG\n    float state\n\nmethod generate(LCG this, int generations = 1) =&gt;\n    float result = 0.0\n    for i = 1 to generations\n        this.state := 16807 * this.state % 2147483647\n        result += this.state / 2147483647\n    result / generations\n\nvar lcg = LCG.new(seedInput)\n\nvar float val0 = 1.0\nvar float val1 = 1.0\nvar float val2 = 1.0\n\nif lcg.generate(10) &lt; 0.5\n    val0 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\nelse if lcg.generate(10) &lt; 0.5\n    val1 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\nelse if lcg.generate(10) &lt; 0.5\n    val2 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\n\nplot(math.avg(val0, val1, val2), \"Average pseudorandom result\", color.purple)</div>\n<p>The Profiler will wrap the entire script and all necessary code regions,\nexcluding any\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#insignificant-unused-and-redundant-code\">insignificant, unused, or redundant code</a>, with the aforementioned <strong>internal</strong> functions to collect\nperformance data. The <em>pseudocode</em> below demonstrates how this process\napplies to the above script:</p>\n<div class=\"pine-colorizer not-content\">long _startMain = System.timeNow() // Start time for the script's overall execution.\n\n// &lt;Additional internal code executes here&gt;\n\n//@version=5\nindicator(\"Profiler's inner workings demo\") // Declaration statements do not require profiling.\n\nint seedInput = input.int(12345, \"Seed\") // Variable declaration without significant calculation.\n\ntype LCG        // Type declarations do not require profiling.\n    float state\n\nmethod generate(LCG this, int generations = 1) =&gt; // Function signature does not affect runtime.\n    float result = 0.0 // Variable declaration without significant calculation.\n\n    long _start11 = System.timeNow() // Start time for the loop block that begins on line 11.\n    for i = 1 to generations // Loop header calculations are not independently wrapped.\n\n        long _start12 = System.timeNow() // Start time for line 12.\n        this.state := 16807 * this.state % 2147483647\n        registerPerf(System.timeNow() - _start12, line12) // Register performance info for line 12.\n\n        long _start13 = System.timeNow() // Start time for line 13.\n        result += this.state / 2147483647\n        registerPerf(System.timeNow() - _start13, line13) // Register performance info for line 13.\n\n    registerPerf(System.timeNow() - _start11, line11, line13) // Register performance info for the block (line 11 - 13).    \n\n    long _start14 = System.timeNow() // Start time for line 14.\n    result / generations\n    registerPerf(System.timeNow() - _start14, line14) // Register performance info for line 14.\n\nlong _start16 = System.timeNow() // Start time for line 16.\nvar lcg = LCG.new(seedInput)\nregisterPerf(System.timeNow() - _start16, line16) // Register performance info for line 16.\n\nvar float val0 = 1.0 // Variable declarations without significant calculations.\nvar float val1 = 1.0\nvar float val2 = 1.0\n\nlong _start22 = System.timeNow() // Start time for the `if` block that begins on line 22.\nif lcg.generate(10) &lt; 0.5 // `if` statement is not independently wrapped.\n\n    long _start23 = System.timeNow() // Start time for line 23.\n    val0 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\n    registerPerf(System.timeNow() - _start23, line23) // Register performance info for line 23.\n\nelse if lcg.generate(10) &lt; 0.5 // `else if` statement is not independently wrapped.\n\n    long _start25 = System.timeNow() // Start time for line 25.\n    val1 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\n    registerPerf(System.timeNow() - _start25, line25) // Register performance info for line 25.\n\nelse if lcg.generate(10) &lt; 0.5 // `else if` statement is not independently wrapped.\n\n    long _start27 = System.timeNow() // Start time for line 27.\n    val2 *= 1.0 + (2.0 * lcg.generate(50) - 1.0) * 0.1\n    registerPerf(System.timeNow() - _start27, line27) // Register performance info for line 27.\n\nregisterPerf(System.timeNow() - _start22, line22, line28) // Register performance info for the block (line 22 - 28).\n\nlong _start29 = System.timeNow() // Start time for line 29.\nplot(math.avg(val0, val1, val2), \"Average pseudorandom result\", color.purple)\nregisterPerf(System.timeNow() - _start29, line29) // Register performance info for line 29.\n\n// &lt;Additional internal code executes here&gt;\n\nregisterPerf(System.timeNow() - _startMain, total) // Register the script's overall performance info.</div>\n<p>Note that:</p>\n<ul>\n<li>This example is <strong>pseudocode</strong> that provides a basic outline of\nthe <strong>internal calculations</strong> the Profiler applies to collect\nperformance data. Saving this example in the Pine Editor will\nresult in a compilation error since <code dir=\"auto\">long</code>, <code dir=\"auto\">System.timeNow()</code>,\nand <code dir=\"auto\">registerPerf()</code> <strong>do not</strong> represent Pine Script code.</li>\n<li>These internal calculations that the Profiler wraps a script\nwith require <strong>additional</strong> computational resources, which is\nwhy a script\u2019s runtime <strong>increases</strong> while profiling.\nProgrammers should always interpret the results as <strong>estimates</strong>\nsince they reflect a script\u2019s performance with the extra\ncalculations included.</li>\n</ul>\n<p>After running the wrapped script to collect performance data,\n<em>additional</em> internal calculations organize the results and display\nrelevant information inside the Pine Editor:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"526\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-A-look-into-the-profilers-inner-workings-1.wt5GoYky_Z1cXiWC.webp\" width=\"1072\"/></p>\n<p>The <em>\u201cLine time\u201d</em> calculation for\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">code blocks</a> also occurs at this stage, as the Profiler cannot\nindividually wrap <a href=\"/pine-script-docs/v5/language/loops/\">loop</a>\nheaders or the conditional statements in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructures. This field\u2019s value represents the <em>difference</em> between a\nblock\u2019s total time and the sum of its local code times, which is why\nthe \u201cLine time\u201d value for a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nblock or an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a> block\nwith <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">else\nif</a>\nexpressions represents the time spent on <strong>all</strong> the structure\u2019s\nconditional statements, not just the block\u2019s <em>initial line</em> of code. If\na programmer requires more granular information for each conditional\nexpression in such a block, they can reorganize the logic into a\n<em>nested</em>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure, as explained\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">here</a>.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>The Profiler <strong>cannot</strong> collect individual performance data for any\nrequired <em>internal</em> calculations and display their results inside the\nPine Editor. Consequently, the time values the Profiler displays for all\ncode regions in a script <strong>will not</strong> add up to 100% of its total\nruntime.</p></div></aside>\n<h3 class=\"md-heading\" id=\"profiling-across-configurations\"><a href=\"#profiling-across-configurations\">Profiling across configurations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a code\u2019s <a href=\"https://en.wikipedia.org/wiki/Time_complexity\" rel=\"nofollow\">time\ncomplexity</a> is not\nconstant or its execution pattern varies with its inputs, function\narguments, or available data, it\u2019s often wise to profile the code\nacross <em>different configurations</em> and data feeds for a more well-rounded\nperspective on its general performance.</p>\n<p>For example, this simple script uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nto calculate the sum of squared distances between the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice and <code dir=\"auto\">lengthInput</code> previous prices, then plots the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.sqrt\">square\nroot</a>\nof that sum on each bar. In this case, the <code dir=\"auto\">lengthInput</code> directly\nimpacts the calculation\u2019s runtime since it determines the number of\ntimes the loop executes its local code:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Profiling across configurations demo\")\n\n//@variable The number of previous bars in the calculation. Directly affects the number of loop iterations.\nint lengthInput = input.int(25, \"Length\", 1)\n\n//@variable The sum of squared distances from the current `close` to `lengthInput` past `close` values.\nfloat total = 0.0\n\n// Look back across `lengthInput` bars and accumulate squared distances.\nfor i = 1 to lengthInput\n    float distance = close - close[i]\n    total += distance * distance\n\n// Plot the square root of the `total`.\nplot(math.sqrt(total))</div>\n<p>Let\u2019s try profiling this script with different <code dir=\"auto\">lengthInput</code> values.\nFirst, we\u2019ll use the default value of 25. The Profiler\u2019s results for\nthis specific run show that the script completed 20,685 executions in\nabout 96.7 milliseconds:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-across-configurations-1.DH6uvleV_15wBst.webp\" width=\"1072\"/></p>\n<p>Here, we\u2019ve increased the input\u2019s value to 50 in the script\u2019s\nsettings. The results for this run show that the script\u2019s total runtime\nwas 194.3 milliseconds, close to <em>twice</em> the time from the previous run:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-across-configurations-2.ggfGlT9L_ZW6q7G.webp\" width=\"1072\"/></p>\n<p>In the next run, we changed the input\u2019s value to 200. This time, the\nProfiler\u2019s results show that the script finished all executions in\napproximately 0.8 seconds, around <em>four times</em> the previous run\u2019s time:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Profiling-across-configurations-3.CZLkQfeW_Z1lXDjU.webp\" width=\"1072\"/></p>\n<p>We can see from these observations that the script\u2019s runtime appears to\nscale <em>linearly</em> with the <code dir=\"auto\">lengthInput</code> value, excluding other factors\nthat may affect performance, as one might expect since the bulk of the\nscript\u2019s calculations occur within the loop and the input\u2019s value\ncontrols how many times the loop must execute.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>It\u2019s often wise to profile each configuration <em>more than once</em> to\nreduce the impact of outliers while assessing how a script\u2019s\nperformance varies with its inputs or data. See the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#repetitive-profiling\">section below</a> for more information.</p></div></aside>\n<h3 class=\"md-heading\" id=\"repetitive-profiling\"><a href=\"#repetitive-profiling\">Repetitive profiling<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The runtime resources available to a script <em>vary</em> over time.\nConsequently, the time it takes to evaluate a code region, even one with\nconstant <a href=\"https://en.wikipedia.org/wiki/Time_complexity\" rel=\"nofollow\">complexity</a>,\n<em>fluctuates</em> across executions, and the cumulative performance results\nshown by the Profiler <strong>will vary</strong> with each independent script run.</p>\n<p>Users can enhance their analysis by <em>restarting</em> a script several times\nand profiling each independent run. Averaging the results from each\nprofiled run and evaluating the dispersion of runtime results can help\nusers establish more robust performance benchmarks and reduce the impact\nof <em>outliers</em> (abnormally long or short runtimes) in their conclusions.</p>\n<p>Incorporating a <em>dummy input</em> (i.e., an input that does nothing) into a\nscript\u2019s code is a simple technique that enables users to <em>restart</em> it\nwhile profiling. The input will not directly affect any calculations or\noutputs. However, as the user changes its value in the script\u2019s\nsettings, the script restarts and the Profiler re-analyzes the executed\ncode.</p>\n<p>For example, this script\n<a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queues</a> pseudorandom values with a constant seed through an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nwith a fixed size, and it calculates and plots the array\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">average</a>\nvalue on each bar. For profiling purposes, the script includes a\n<code dir=\"auto\">dummyInput</code> variable with an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_input.int\">input.int()</a>\nvalue assigned to it. The input does nothing in the code aside from\nallowing us to <em>restart</em> the script each time we change its value:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Repetitive profiling demo\")\n\n//@variable An input not connected to script calculations. Changing its value in the \"Inputs\" tab restarts the script.\nint dummyInput = input.int(0, \"Dummy input\")\n\n//@variable An array of pseudorandom values.\nvar array&lt;float&gt; randValues = array.new&lt;float&gt;(2500, 0.0)\n\n// Push a new `math.random()` value with a fixed `seed` into the `randValues` array and remove the oldest value.\narray.push(randValues, math.random(seed = 12345))\narray.shift(randValues)\n\n// Plot the average of all elements in the `randValues` array.\nplot(array.avg(randValues), \"Pseudorandom average\")</div>\n<p>After the first script run, the Profiler shows that it took 308.6\nmilliseconds to execute across all of the chart\u2019s data:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Repetitive-profiling-1.CfionGK2_pmOYe.webp\" width=\"1072\"/></p>\n<p>Now, let\u2019s change the dummy input\u2019s value in the script\u2019s settings to\nrestart it without changing the calculations. This time, it completed\nthe same code executions in 424.6 milliseconds, 116 milliseconds longer\nthan the previous run:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Repetitive-profiling-2.LouNiZpq_o9WWS.webp\" width=\"1072\"/></p>\n<p>Restarting the script again yields another new result. On the third run,\nthe script finished all code executions in 227.4 milliseconds, the\nshortest time so far:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Pine-profiler-Repetitive-profiling-3.UGJOj4nF_Z1p4czi.webp\" width=\"1072\"/></p>\n<p>After repeating this process several times and documenting the results\nfrom each run, one can manually calculate their <em>average</em> to estimate\nthe script\u2019s expected total runtime:</p>\n<p><code dir=\"auto\">AverageTime = (time1 + time2 + ... + timeN) / N</code></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Whether profiling a script over a single run or multiple, it\u2019s crucial\nto understand that <strong>results will vary</strong>. While averaging results across\nseveral profiled script runs can help derive more stable performance\nestimates, such estimates are <strong>not</strong> impervious to variance.</p></div></aside>", "segment_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/profiling-and-optimization", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"optimization\"><a href=\"#optimization\">Optimization<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p><em>Code optimization</em>, not to be confused with indicator or strategy\noptimization, involves modifying a script\u2019s source code for improved\nexecution time, resource efficiency, and scalability. Programmers may\nuse various approaches to optimize a script when they need enhanced\nruntime performance, depending on what a script\u2019s calculations entail.</p>\n<p>Fundamentally, most techniques one will use to optimize Pine code\ninvolve <em>reducing</em> the number of times critical calculations occur or\n<em>replacing</em> significant calculations with simplified formulas or\nbuilt-ins. Both of these paradigms often overlap.</p>\n<p>The following sections explain several straightforward concepts\nprogrammers can apply to optimize their Pine Script code.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Before looking for ways to optimize a script,\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profile it</a> to gauge its performance and identify the <strong>critical code\nregions</strong> that will benefit the most from optimization.</p></div></aside>\n<h3 class=\"md-heading\" id=\"using-built-ins\"><a href=\"#using-built-ins\">Using built-ins<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script features a variety of <em>built-in</em> functions and variables\nthat help streamline script creation. Many of Pine\u2019s built-ins feature\ninternal optimizations to help maximize efficiency and minimize\nexecution time. As such, one of the simplest ways to optimize Pine code\nis to utilize these efficient built-ins in a script\u2019s calculations when\npossible.</p>\n<p>Let\u2019s look at an example where one can replace user-defined\ncalculations with a concise built-in call to substantially improve\nperformance. Suppose a programmer wants to calculate the highest value\nof a series over a specified number of bars. Someone not familiar with\nall of Pine\u2019s built-ins might approach the task using a code like the\nfollowing, which uses a <a href=\"/pine-script-docs/v5/language/loops/\">loop</a>\non each bar to compare <code dir=\"auto\">length</code> historical values of a <code dir=\"auto\">source</code> series:</p>\n<div class=\"pine-colorizer not-content\">//@variable A user-defined function to calculate the highest `source` value over `length` bars.\npineHighest(float source, int length) =&gt;\n    float result = na\n    if bar_index + 1 &gt;= length\n        result := source\n        if length &gt; 1\n            for i = 1 to length - 1\n                result := math.max(result, source[i])\n    result</div>\n<p>Alternatively, one might devise a more optimized Pine function by\nreducing the number of times the loop executes, as iterating over the\nhistory of the <code dir=\"auto\">source</code> to achieve the result is only necessary when\nspecific conditions occur:</p>\n<div class=\"pine-colorizer not-content\">//@variable A faster user-defined function to calculate the highest `source` value over `length` bars.\n//          This version only requires a loop when the highest value is removed from the window, the `length` \n//          changes, or when the number of bars first becomes sufficient to calculate the result. \nfasterPineHighest(float source, int length) =&gt;\n    var float result = na\n    if source[length] == result or length != length[1] or bar_index + 1 == length\n        result := source\n        if length &gt; 1\n            for i = 1 to length - 1\n                result := math.max(result, source[i])\n    else\n        result := math.max(result, source)\n    result</div>\n<p>The built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\nfunction will outperform <strong>both</strong> of these implementations, as its\ninternal calculations are highly optimized for efficient execution.\nBelow, we created a script that plots the results of calling\n<code dir=\"auto\">pineHighest()</code>, <code dir=\"auto\">fasterPineHighest()</code>, and\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\nto compare their performance using the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a>:</p>\n<div class=\"pine-colorizer not-content\">//@version=5 \nindicator(\"Using built-ins demo\")\n\n//@variable A user-defined function to calculate the highest `source` value over `length` bars.\npineHighest(float source, int length) =&gt;\n    float result = na\n    if bar_index + 1 &gt;= length\n        result := source\n        if length &gt; 1\n            for i = 1 to length - 1\n                result := math.max(result, source[i])\n    result\n\n//@variable A faster user-defined function to calculate the highest `source` value over `length` bars.\n//          This version only requires a loop when the highest value is removed from the window, the `length` \n//          changes, or when the number of bars first becomes sufficient to calculate the result. \nfasterPineHighest(float source, int length) =&gt;\n    var float result = na\n    if source[length] == result or length != length[1] or bar_index + 1 == length\n        result := source\n        if length &gt; 1\n            for i = 1 to length - 1\n                result := math.max(result, source[i])\n    else\n        result := math.max(result, source)\n    result\n\nplot(pineHighest(close, 20))\nplot(fasterPineHighest(close, 20))\nplot(ta.highest(close, 20))</div>\n<p>The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> over 20,735 script executions show the call to\n<code dir=\"auto\">pineHighest()</code> took the most time to execute, with a runtime of 57.9\nmilliseconds, about 69.3% of the script\u2019s total runtime. The\n<code dir=\"auto\">fasterPineHighest()</code> call performed much more efficiently, as it only\ntook about 16.9 milliseconds, approximately 20.2% of the total runtime,\nto calculate the same values.</p>\n<p>The most efficient <em>by far</em>, however, was the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\ncall, which only required 3.2 milliseconds (~3.8% of the total runtime)\nto execute across all the chart\u2019s data and compute the same values in\nthis run:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"564\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Using-built-ins-1.CXnfIZo4_ZWjpAS.webp\" width=\"1072\"/></p>\n<p>While these results effectively demonstrate that the built-in function\noutperforms our\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> with a small <code dir=\"auto\">length</code> argument of 20, it\u2019s crucial to\nconsider that the calculations required by the functions <em>will vary</em>\nwith the argument\u2019s value. Therefore, we can profile the code while\nusing\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-across-configurations\">different arguments</a> to gauge how its runtime scales.</p>\n<p>Here, we changed the <code dir=\"auto\">length</code> argument in each function call from 20 to\n200 and\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiled the script</a> again to observe the changes in performance. The time spent\non the <code dir=\"auto\">pineHighest()</code> function in this run increased to about 0.6\nseconds (~86% of the total runtime), and the time spent on the\n<code dir=\"auto\">fasterPineHighest()</code> function increased to about 75 milliseconds. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\nfunction, on the other hand, <em>did not</em> experience a substantial runtime\nchange. It took about 5.8 milliseconds this time, only a couple of\nmilliseconds more than the previous run.</p>\n<p>In other words, while our\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined functions</a> experienced significant runtime growth with a higher\n<code dir=\"auto\">length</code> argument in this run, the change in the built-in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.highest\">ta.highest()</a>\nfunction\u2019s runtime was relatively marginal in this case, thus further\nemphasizing its performance benefits:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"564\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Using-built-ins-2.wlIsvoLn_Z1yQ1xR.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>In many scenarios, a script\u2019s runtime can benefit from using\nbuilt-ins where applicable. However, the relative performance\nedge achieved from using built-ins depends on a script\u2019s\n<em>high-impact code</em> and the specific built-ins used. In any case,\none should always\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profile their scripts</a>, preferably\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#repetitive-profiling\">several times</a>, when exploring optimized solutions.</li>\n<li>The calculations performed by the functions in this example also\ndepend on the sequence of the chart\u2019s data. Therefore,\nprogrammers can gain further insight into their general\nperformance by profiling the script across\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-across-configurations\">different datasets</a> as well.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"reducing-repetition\"><a href=\"#reducing-repetition\">Reducing repetition<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The Pine Script compiler can automatically simplify some types of\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#insignificant-unused-and-redundant-code\">repetitive code</a> without a programmer\u2019s intervention. However, this\nautomatic process has its limitations. If a script contains repetitive\ncalculations that the compiler <em>cannot</em> reduce, programmers can reduce\nthe repetition <em>manually</em> to improve their script\u2019s performance.</p>\n<p>For example, this script contains a <code dir=\"auto\">valuesAbove()</code>\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method</a>\nthat counts the number of elements in an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nabove the element at a specified index. The script plots the number of\nvalues above the element at the last index of a <code dir=\"auto\">data</code> array with a\ncalculated <code dir=\"auto\">plotColor</code>. It calculates the <code dir=\"auto\">plotColor</code> within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nstructure that calls <code dir=\"auto\">valuesAbove()</code> in all 10 of its conditional\nexpressions:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing repetition demo\")\n\n//@function Counts the number of elements in `this` array above the element at a specified `index`.\nmethod valuesAbove(array&lt;float&gt; this, int index) =&gt;\n    int result = 0\n    float reference = this.get(index)\n    for [i, value] in this\n        if i == index\n            continue\n        if value &gt; reference\n            result += 1\n    result\n\n//@variable An array containing the most recent 100 `close` prices.\nvar array&lt;float&gt; data = array.new&lt;float&gt;(100)\ndata.push(close)\ndata.shift()\n\n//@variable Returns `color.purple` with a varying transparency based on the `valuesAbove()`.\ncolor plotColor = switch\n    data.valuesAbove(99) &lt;= 10  =&gt; color.new(color.purple, 90)\n    data.valuesAbove(99) &lt;= 20  =&gt; color.new(color.purple, 80)\n    data.valuesAbove(99) &lt;= 30  =&gt; color.new(color.purple, 70)\n    data.valuesAbove(99) &lt;= 40  =&gt; color.new(color.purple, 60)\n    data.valuesAbove(99) &lt;= 50  =&gt; color.new(color.purple, 50)\n    data.valuesAbove(99) &lt;= 60  =&gt; color.new(color.purple, 40)\n    data.valuesAbove(99) &lt;= 70  =&gt; color.new(color.purple, 30)\n    data.valuesAbove(99) &lt;= 80  =&gt; color.new(color.purple, 20)\n    data.valuesAbove(99) &lt;= 90  =&gt; color.new(color.purple, 10)\n    data.valuesAbove(99) &lt;= 100 =&gt; color.new(color.purple, 0)\n\n// Plot the number values in the `data` array above the value at its last index. \nplot(data.valuesAbove(99), color = plotColor, style = plot.style_area)</div>\n<p>The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> for this script show that it spent about 2.5 seconds\nexecuting 21,201 times. The code regions with the highest impact on the\nscript\u2019s runtime are the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nwithin the <code dir=\"auto\">valuesAbove()</code> local scope starting on line 8 and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_switch\">switch</a>\nblock that starts on line 21:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"616\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Reducing-repetition-1.DzXiqnj9_Z1IB5Dn.webp\" width=\"1072\"/></p>\n<p>Notice that the number of executions shown for the local code within\n<code dir=\"auto\">valuesAbove()</code> is substantially <em>greater</em> than the number shown for the\ncode in the script\u2019s global scope, as the script calls the method up to\n11 times per execution, and the results for a\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#user-defined-function-calls\">function\u2019s local code</a> reflect the <em>combined</em> time and executions from each\nseparate call:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Reducing-repetition-2.QnMs1Dg3_ZE1OU8.webp\" width=\"1072\"/></p>\n<p>Although each <code dir=\"auto\">valuesAbove()</code> call uses the <em>same</em> arguments and returns\nthe <em>same</em> result, the compiler cannot automatically reduce this code\nfor us during translation. We will need to do the job ourselves. We can\noptimize this script by assigning the value of <code dir=\"auto\">data.valuesAbove(99)</code> to\na <em>variable</em> and <em>reusing</em> the value in all other areas requiring the\nresult.</p>\n<p>In the version below, we modified the script by adding a <code dir=\"auto\">count</code>\nvariable to reference the <code dir=\"auto\">data.valuesAbove(99)</code> value. The script uses\nthis variable in the <code dir=\"auto\">plotColor</code> calculation and the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_plot\">plot()</a>\ncall:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing repetition demo\")\n\n//@function Counts the number of elements in `this` array above the element at a specified `index`.\nmethod valuesAbove(array&lt;float&gt; this, int index) =&gt;\n    int result = 0\n    float reference = this.get(index)\n    for [i, value] in this\n        if i == index\n            continue\n        if value &gt; reference\n            result += 1\n    result\n\n//@variable An array containing the most recent 100 `close` prices.\nvar array&lt;float&gt; data = array.new&lt;float&gt;(100)\ndata.push(close)\ndata.shift()\n\n//@variable The number values in the `data` array above the value at its last index.\nint count = data.valuesAbove(99)\n\n//@variable Returns `color.purple` with a varying transparency based on the `valuesAbove()`.\ncolor plotColor = switch\n    count &lt;= 10  =&gt; color.new(color.purple, 90)\n    count &lt;= 20  =&gt; color.new(color.purple, 80)\n    count &lt;= 30  =&gt; color.new(color.purple, 70)\n    count &lt;= 40  =&gt; color.new(color.purple, 60)\n    count &lt;= 50  =&gt; color.new(color.purple, 50)\n    count &lt;= 60  =&gt; color.new(color.purple, 40)\n    count &lt;= 70  =&gt; color.new(color.purple, 30)\n    count &lt;= 80  =&gt; color.new(color.purple, 20)\n    count &lt;= 90  =&gt; color.new(color.purple, 10)\n    count &lt;= 100 =&gt; color.new(color.purple, 0)\n\n// Plot the `count`.\nplot(count, color = plotColor, style = plot.style_area)</div>\n<p>With this modification, the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> show a significant improvement in performance, as the script\nnow only needs to evaluate the <code dir=\"auto\">valuesAbove()</code> call <strong>once</strong> per\nexecution rather than up to 11 separate times:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"672\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Reducing-repetition-3.Nge1aqtk_2w60SG.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>Since this script only calls <code dir=\"auto\">valuesAbove()</code> once, the\n<a href=\"/pine-script-docs/v5/language/methods/#user-defined-methods\">method\u2019s</a> local code will now reflect the results from that\nspecific call. See\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#user-defined-function-calls\">this section</a> to learn more about interpreting profiled function\nand method call results.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"minimizing-request-calls\"><a href=\"#minimizing-request-calls\"><span>Minimizing \u200b<code dir=\"auto\">request.\\*()</code>\u200b calls</span><span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>The built-in functions in the <code dir=\"auto\">request.*()</code> namespace allow scripts to\nretrieve data from\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">other contexts</a>. While these functions provide utility in many applications,\nit\u2019s important to consider that each call to these functions can have a\nsignificant impact on a script\u2019s resource usage.</p>\n<p>A single script can contain up to 40 calls to the <code dir=\"auto\">request.*()</code> family\nof functions. However, users should strive to keep their scripts\u2019\n<code dir=\"auto\">request.*()</code> calls well <em>below</em> this limit to keep the performance\nimpact of their data requests as low as possible.</p>\n<p>When a script requests the values of several expressions from the <em>same</em>\ncontext with multiple\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>\ncalls, one effective way to optimize such requests is to <em>condense</em> them\ninto a single <code dir=\"auto\">request.*()</code> call that uses a\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">tuple</a> as its <code dir=\"auto\">expression</code> argument. This optimization not only\nhelps improve the runtime of the requests; it also helps reduce the\nscript\u2019s <em>memory usage</em> and compiled size.</p>\n<p>As a simple example, the following script requests nine\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.percentrank\">ta.percentrank()</a>\nvalues with different lengths from a specified symbol using nine\nseparate calls to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>.\nIt then <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> all nine\nrequested values on the chart to utilize them in the outputs:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Minimizing `request.*()` calls demo\")\n\n//@variable The symbol to request data from.\nstring symbolInput = input.symbol(\"BINANCE:BTCUSDT\", \"Symbol\")\n\n// Request 9 `ta.percentrank()` values from the `symbolInput` context using 9 `request.security()` calls.\nfloat reqRank1 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 10))\nfloat reqRank2 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 20))\nfloat reqRank3 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 30))\nfloat reqRank4 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 40))\nfloat reqRank5 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 50))\nfloat reqRank6 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 60))\nfloat reqRank7 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 70))\nfloat reqRank8 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 80))\nfloat reqRank9 = request.security(symbolInput, timeframe.period, ta.percentrank(close, 90))\n\n// Plot the `reqRank*` values.\nplot(reqRank1)\nplot(reqRank2)\nplot(reqRank3)\nplot(reqRank4)\nplot(reqRank5)\nplot(reqRank6)\nplot(reqRank7)\nplot(reqRank8)\nplot(reqRank9)</div>\n<p>The results from\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiling the script</a> show that it took the script 340.8 milliseconds to complete\nits requests and plot the values in this run:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"502\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Minimizing-request-calls-1.Canv49So_1Cn30c.webp\" width=\"1072\"/></p>\n<p>Since all the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncalls request data from the <strong>same context</strong>, we can optimize the\ncode\u2019s resource usage by merging all of them into a single\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>\ncall that uses a\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#tuples\">tuple</a> as its <code dir=\"auto\">expression</code> argument:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Minimizing `request.*()` calls demo\")\n\n//@variable The symbol to request data from.\nstring symbolInput = input.symbol(\"BINANCE:BTCUSDT\", \"Symbol\")\n\n// Request 9 `ta.percentrank()` values from the `symbolInput` context using a single `request.security()` call.\n[reqRank1, reqRank2, reqRank3, reqRank4, reqRank5, reqRank6, reqRank7, reqRank8, reqRank9] = \n request.security(\n     symbolInput, timeframe.period, [\n             ta.percentrank(close, 10), ta.percentrank(close, 20), ta.percentrank(close, 30), \n             ta.percentrank(close, 40), ta.percentrank(close, 50), ta.percentrank(close, 60), \n             ta.percentrank(close, 70), ta.percentrank(close, 80), ta.percentrank(close, 90)\n         ]\n )\n\n// Plot the `reqRank*` values.\nplot(reqRank1)\nplot(reqRank2)\nplot(reqRank3)\nplot(reqRank4)\nplot(reqRank5)\nplot(reqRank6)\nplot(reqRank7)\nplot(reqRank8)\nplot(reqRank9)</div>\n<p>As we see below, the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> from running this version of the script show that it took\n228.3 milliseconds this time, a decent improvement over the previous\nrun:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"486\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Minimizing-request-calls-2.BZ75zb8R_Z21D1UV.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The computational resources available to a script <strong>fluctuate</strong>\nover time. As such, it\u2019s typically a good idea to profile a\nscript\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#repetitive-profiling\">multiple times</a> to help solidify performance conclusions.</li>\n<li>Another way to request multiple values from the same context\nwith a single <code dir=\"auto\">request.*()</code> call is to pass an\n<a href=\"/pine-script-docs/v5/language/objects/\">object</a> of a\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined type (UDT)</a> as the <code dir=\"auto\">expression</code> argument. See\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/#user-defined-types\">this section</a> of the\n<a href=\"/pine-script-docs/v5/concepts/other-timeframes-and-data/\">Other timeframes and data</a> page to learn more about requesting\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">UDTs</a>.</li>\n<li>Programmers can also reduce the total runtime of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security\">request.security()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.security_lower_tf\">request.security_lower_tf()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_request.seed\">request.seed()</a>\ncall by passing an argument to the function\u2019s <code dir=\"auto\">calc_bars_count</code>\nparameter, which <em>restricts</em> the number of <em>historical</em> data\npoints it can access from a context and execute required\ncalculations on. In general, if calls to these <code dir=\"auto\">request.*()</code>\nfunctions retrieve <em>more</em> historical data than what a script\n<em>needs</em>, limiting the requests with <code dir=\"auto\">calc_bars_count</code> can help\nimprove the script\u2019s performance.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"avoiding-redrawing\"><a href=\"#avoiding-redrawing\">Avoiding redrawing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine Script\u2019s\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a> allow scripts to draw custom visuals on a chart that one\ncannot achieve through other outputs such as\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a>. While these types\nprovide greater visual flexibility, they also have a <em>higher</em> runtime\nand memory cost, especially when a script unnecessarily <em>recreates</em>\ndrawings instead of directly updating their properties to change their\nappearance.</p>\n<p>Most\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing types</a>, excluding\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polylines</a>,\nfeature built-in <em>setter functions</em> in their namespaces that allow\nscripts to modify a drawing <em>without</em> deleting and recreating it.\nUtilizing these setters is typically less computationally expensive than\ncreating a new drawing object when only <em>specific properties</em> require\nmodification.</p>\n<p>For example, the script below compares deleting and redrawing\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> to using\n<code dir=\"auto\">box.set*()</code> functions. On the first bar, it declares the <code dir=\"auto\">redrawnBoxes</code>\nand <a href=\"/pine-script-docs/v5/language/arrays/\">updatedBoxes<code dir=\"auto\"> </code>arrays</a>\nand executes a <a href=\"/pine-script-docs/v5/language/loops/\">loop</a> to push\n25 <a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_box\">box</a>\nelements into them.</p>\n<p>The script uses a separate\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nto iterate across the <a href=\"/pine-script-docs/v5/language/arrays/\">arrays</a> and update the drawings on each execution. It <em>recreates</em>\nthe <a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> in\nthe <code dir=\"auto\">redrawnBoxes</code> array using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.delete\">box.delete()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>,\nwhereas it <em>directly modifies</em> the properties of the\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#boxes\">boxes</a> in the\n<code dir=\"auto\">updatedBoxes</code> array using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_lefttop\">box.set_lefttop()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_rightbottom\">box.set_rightbottom()</a>.\nBoth approaches achieve the same visual result. However, the latter is\nmore efficient:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Avoiding redrawing demo\")\n\n//@variable An array of `box` IDs deleted with `box.delete()` and redrawn with `box.new()` on each execution.\nvar array&lt;box&gt; redrawnBoxes = array.new&lt;box&gt;()\n//@variable An array of `box` IDs with properties that update across executions update via `box.set*()` functions.\nvar array&lt;box&gt; updatedBoxes = array.new&lt;box&gt;()\n\n// Populate both arrays with 25 elements on the first bar. \nif barstate.isfirst\n    for i = 1 to 25\n        array.push(redrawnBoxes, box(na))\n        array.push(updatedBoxes, box.new(na, na, na, na))\n\nfor i = 0 to 24\n    // Calculate coordinates.\n    int x = bar_index - i\n    float y = close[i + 1] - close\n    // Get the `box` ID from each array at the `i` index.\n    box redrawnBox = redrawnBoxes.get(i)\n    box updatedBox = updatedBoxes.get(i)\n    // Delete the `redrawnBox`, create a new `box` ID, and replace that element in the `redrawnboxes` array.\n    box.delete(redrawnBox)\n    redrawnBox := box.new(x - 1, y, x, 0.0)\n    array.set(redrawnBoxes, i, redrawnBox)\n    // Update the properties of the `updatedBox` rather than redrawing it. \n    box.set_lefttop(updatedBox, x - 1, y)\n    box.set_rightbottom(updatedBox, x, 0.0)</div>\n<p>The results from\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiling this script</a> show that line 24, which contains the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.new\">box.new()</a>\ncall, is the <em>heaviest</em> line in the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">code block</a> that executes on each bar, with a runtime close to\n<strong>double</strong> the combined time spent on the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_lefttop\">box.set_lefttop()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_box.set_rightbottom\">box.set_rightbottom()</a>\ncalls on lines 27 and 28:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"514\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Avoiding-redrawing-1.CVCJc2lm_ZJcTqr.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>The number of executions shown for the loop\u2019s <em>local code</em> is\n25 times the number shown for the code in the script\u2019s <em>global\nscope</em>, as each execution of the loop statement triggers 25\nexecutions of the local block.</li>\n<li>This script updates its drawings over <em>all bars</em> in the chart\u2019s\nhistory for <strong>testing</strong> purposes. However, it does <strong>not</strong>\nactually need to execute all these historical updates since\nusers will only see the <strong>final</strong> result from the <em>last\nhistorical bar</em> and the changes across <em>realtime bars</em>. See the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#reducing-drawing-updates\">next section</a> to learn more.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"reducing-drawing-updates\"><a href=\"#reducing-drawing-updates\">Reducing drawing updates<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a script produces\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawing objects</a> that change across <em>historical bars</em>, users will only ever\nsee their <strong>final results</strong> on those bars since the script completes its\nhistorical executions when it first loads on the chart. The only time\none will see such drawings <em>evolve</em> across executions is during\n<em>realtime bars</em>, as new data flows in.</p>\n<p>Since the evolving outputs from dynamic\n<a href=\"/pine-script-docs/v5/language/type-system/#drawing-types\">drawings</a> on historical bars are <strong>never visible</strong> to a user, one can\noften improve a script\u2019s performance by <em>eliminating</em> the historical\nupdates that don\u2019t impact the final results.</p>\n<p>For example, this script creates a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nwith two columns and 21 rows to visualize the history of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_ta.rsi\">RSI</a>\nin a paginated, tabular format. The script initializes the cells of the\n<code dir=\"auto\">infoTable</code> on the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isfirst\">first\nbar</a>,\nand it references the history of the calculated <code dir=\"auto\">rsi</code> to update the\n<code dir=\"auto\">text</code> and <code dir=\"auto\">bgcolor</code> of the cells in the second column within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\non each bar:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing drawing updates demo\")\n\n//@variable The first offset shown in the paginated table.\nint offsetInput = input.int(0, \"Page\", 0, 249) * 20\n\n//@variable A table that shows the history of RSI values.\nvar table infoTable = table.new(position.top_right, 2, 21, border_color = chart.fg_color, border_width = 1)\n// Initialize the table's cells on the first bar.\nif barstate.isfirst\n    table.cell(infoTable, 0, 0, \"Offset\", text_color = chart.fg_color)\n    table.cell(infoTable, 1, 0, \"RSI\", text_color = chart.fg_color)\n    for i = 0 to 19\n        table.cell(infoTable, 0, i + 1, str.tostring(offsetInput + i))\n        table.cell(infoTable, 1, i + 1)\n\nfloat rsi = ta.rsi(close, 14)\n\n// Update the history shown in the `infoTable` on each bar. \nfor i = 0 to 19\n    float historicalRSI = rsi[offsetInput + i]\n    table.cell_set_text(infoTable, 1, i + 1, str.tostring(historicalRSI))\n    table.cell_set_bgcolor(\n         infoTable, 1, i + 1, color.from_gradient(historicalRSI, 30, 70, color.red, color.green)\n     )\n\nplot(rsi, \"RSI\")</div>\n<p>After\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiling</a> the script, we see that the code with the highest impact on\nperformance is the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nthat starts on line 20, i.e., the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">code block</a> that updates the table\u2019s cells:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"494\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Reducing-drawing-updates-1.DGjGYc9o_Z2h4bJz.webp\" width=\"1072\"/></p>\n<p>This critical code region executes <strong>excessively</strong> across the chart\u2019s\nhistory, as users will only see the\n<a href=\"/pine-script-docs/v5/concepts/tables/\">table\u2019s</a> <strong>final</strong>\nhistorical result. The only time that users will see the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\nupdate is on the <strong>last historical bar</strong> and across all subsequent\n<strong>realtime bars</strong>. Therefore, we can optimize this script\u2019s resource\nusage by restricting the executions of this code to only the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">last\navailable\nbar</a>.</p>\n<p>In this script version, we placed the\n<a href=\"/pine-script-docs/v5/language/loops/\">loop</a> that updates the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_table\">table</a>\ncells within an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>\nstructure that uses\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">barstate.islast</a>\nas its condition, effectively restricting the code block\u2019s executions\nto only the last historical bar and all realtime bars. Now, the script\n<em>loads</em> more efficiently since all the table\u2019s calculations only\nrequire <strong>one</strong> historical execution:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"520\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Reducing-drawing-updates-2.DVDSH-lG_Z1AqBk6.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing drawing updates demo\")\n\n//@variable The first offset shown in the paginated table.\nint offsetInput = input.int(0, \"Page\", 0, 249) * 20\n\n//@variable A table that shows the history of RSI values.\nvar table infoTable = table.new(position.top_right, 2, 21, border_color = chart.fg_color, border_width = 1)\n// Initialize the table's cells on the first bar.\nif barstate.isfirst\n    table.cell(infoTable, 0, 0, \"Offset\", text_color = chart.fg_color)\n    table.cell(infoTable, 1, 0, \"RSI\", text_color = chart.fg_color)\n    for i = 0 to 19\n        table.cell(infoTable, 0, i + 1, str.tostring(offsetInput + i))\n        table.cell(infoTable, 1, i + 1)\n\nfloat rsi = ta.rsi(close, 14)\n\n// Update the history shown in the `infoTable` on the last available bar.\nif barstate.islast\n    for i = 0 to 19\n        float historicalRSI = rsi[offsetInput + i]\n        table.cell_set_text(infoTable, 1, i + 1, str.tostring(historicalRSI))\n        table.cell_set_bgcolor(\n             infoTable, 1, i + 1, color.from_gradient(historicalRSI, 30, 70, color.red, color.green)\n         )\n\nplot(rsi, \"RSI\")</div>\n<p>Note that:</p>\n<ul>\n<li>The script will still update the cells when new <strong>realtime</strong>\nupdates come in, as users can observe those changes on the\nchart, unlike the changes that the script used to execute across\nhistorical bars.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"storing-calculated-values\"><a href=\"#storing-calculated-values\">Storing calculated values<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>When a script performs a critical calculation that changes\n<em>infrequently</em> throughout all executions, one can reduce its runtime by\n<strong>saving the result</strong> to a variable declared with the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a> or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_varip\">varip</a>\nkeywords and <strong>only</strong> updating the value if the calculation changes. If\nthe script calculates <em>multiple</em> values excessively, one can store them\nwithin\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a>,\n<a href=\"/pine-script-docs/v5/language/matrices/\">matrices</a>, and\n<a href=\"/pine-script-docs/v5/language/maps/\">maps</a> or\n<a href=\"/pine-script-docs/v5/language/objects/\">objects</a> of\n<a href=\"/pine-script-docs/v5/language/type-system/#user-defined-types\">user-defined types</a>.</p>\n<p>Let\u2019s look at an example. This script calculates a weighted moving\naverage with custom weights based on a generalized <a href=\"https://en.wikipedia.org/wiki/Window_function\" rel=\"nofollow\">window\nfunction</a>. The\n<code dir=\"auto\">numerator</code> is the sum of weighted\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues, and the <code dir=\"auto\">denominator</code> is the sum of the calculated weights. The\nscript uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nthat iterates <code dir=\"auto\">lengthInput</code> times to calculate these sums, then it plots\ntheir ratio, i.e., the resulting average:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Storing calculated values demo\", overlay = true)\n\n//@variable The number of bars in the weighted average calculation.\nint lengthInput = input.int(50, \"Length\", 1, 5000)\n//@variable Window coefficient. \nfloat coefInput = input.float(0.5, \"Window coefficient\", 0.0, 1.0, 0.01)\n\n//@variable The sum of weighted `close` prices.\nfloat numerator = 0.0\n//@variable The sum of weights.\nfloat denominator = 0.0\n\n//@variable The angular step in the cosine calculation.\nfloat step = 2.0 * math.pi / lengthInput\n// Accumulate weighted sums.\nfor i = 0 to lengthInput - 1\n    float weight = coefInput - (1 - coefInput) * math.cos(step * i)\n    numerator += close[i] * weight\n    denominator += weight\n\n// Plot the weighted average result.\nplot(numerator / denominator, \"Weighted average\", color.purple, 3)</div>\n<p>After\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiling</a> the script\u2019s performance over our chart\u2019s data, we see\nthat it took about 241.3 milliseconds to calculate the default 50-bar\naverage across 20,155 chart updates, and the critical code with the\n<em>highest impact</em> on the script\u2019s performance is the loop\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#code-block-results\">block</a> that starts on line 17:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"424\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Storing-calculated-values-1.Db6QOvTY_1SK8Tz.webp\" width=\"1072\"/></p>\n<p>Since the number of loop iterations <em>depends</em> on the <code dir=\"auto\">lengthInput</code>\nvalue, let\u2019s test how its runtime scales with\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-across-configurations\">another configuration</a> requiring heavier looping. Here, we set the value to 2500.\nThis time, the script took about 12 seconds to complete all of its\nexecutions:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"424\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Storing-calculated-values-2.DsxEbDvA_DT4zd.webp\" width=\"1072\"/></p>\n<p>Now that we\u2019ve pinpointed the script\u2019s <em>high-impact</em> code and\nestablished a benchmark to improve, we can inspect the critical code\nblock to identify optimization opportunities. After examining the\ncalculations, we can observe the following:</p>\n<ul>\n<li>The only value that causes the <code dir=\"auto\">weight</code> calculation on line 18 to\nvary across loop iterations is the <em>loop index</em>. All other values in\nits calculation remain consistent. Consequently, the <code dir=\"auto\">weight</code>\ncalculated on each loop iteration <strong>does not vary</strong> across chart\nbars. Therefore, rather than calculating the weights on <strong>every\nupdate</strong>, we can calculate them <strong>once</strong>, on the first bar, and\n<strong>store them</strong> in a\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collection</a> for future access across subsequent script executions.</li>\n<li>Since the weights never change, the resulting <code dir=\"auto\">denominator</code> never\nchanges. Therefore, we can add the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword to the\n<a href=\"/pine-script-docs/v5/language/variable-declarations/\">variable declaration</a> and only calculate its value <strong>once</strong> to reduce the\nnumber of executed <a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_+=\">addition\nassignment</a>\noperations.</li>\n<li>Unlike the <code dir=\"auto\">denominator</code>, we <strong>cannot</strong> store the <code dir=\"auto\">numerator</code> value\nto simplify its calculation since it consistently <em>changes</em> over\ntime.</li>\n</ul>\n<p>In the modified script below, we\u2019ve added a <code dir=\"auto\">weights</code> variable to\nreference an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nthat stores each calculated <code dir=\"auto\">weight</code>. This variable and the\n<code dir=\"auto\">denominator</code> both include the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nkeyword in their declarations, meaning the values assigned to them will\n<em>persist</em> throughout all script executions until explicitly reassigned.\nThe script calculates their values using a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nthat only executes on the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.isfirst\">first chart\nbar</a>.\nAcross all other bars, it calculates the <code dir=\"auto\">numerator</code> using a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop that references the <em>saved values</em> from the <code dir=\"auto\">weights</code> array:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Storing calculated values demo\", overlay = true)\n\n//@variable The number of bars in the weighted average calculation.\nint lengthInput = input.int(50, \"Length\", 1, 5000)\n//@variable Window coefficient. \nfloat coefInput = input.float(0.5, \"Window coefficient\", 0.0, 1.0, 0.01)\n\n//@variable An array that stores the `weight` values calculated on the first chart bar. \nvar array&lt;float&gt; weights = array.new&lt;float&gt;()\n\n//@variable The sum of weighted `close` prices.\nfloat numerator = 0.0\n//@variable The sum of weights. The script now only calculates this value on the first bar. \nvar float denominator = 0.0\n\n//@variable The angular step in the cosine calculation.\nfloat step = 2.0 * math.pi / lengthInput\n\n// Populate the `weights` array and calculate the `denominator` only on the first bar.\nif barstate.isfirst\n    for i = 0 to lengthInput - 1\n        float weight = coefInput - (1 - coefInput) * math.cos(step * i)\n        array.push(weights, weight)\n        denominator += weight\n// Calculate the `numerator` on each bar using the stored `weights`. \nfor [i, w] in weights\n    numerator += close[i] * w\n\n// Plot the weighted average result.\nplot(numerator / denominator, \"Weighted average\", color.purple, 3)</div>\n<p>With this optimized structure, the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> show that our modified script with a high <code dir=\"auto\">lengthInput</code>\nvalue of 2500 took about 5.9 seconds to calculate across the same data,\nabout <em>half</em> the time of our previous version:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"566\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Storing-calculated-values-3.k6QQwb-Z_ZqmRWt.webp\" width=\"1072\"/></p>\n<p>Note that:</p>\n<ul>\n<li>Although we\u2019ve significantly improved this script\u2019s\nperformance by saving its <em>execution-invariant</em> values to\nvariables, it does still involve a higher computational cost\nwith <strong>large</strong> <code dir=\"auto\">lengthInput</code> values due to the remaining loop\ncalculations that execute on each bar.</li>\n<li>Another, more <em>advanced</em> way one can further enhance this\nscript\u2019s performance is by storing the weights in a\n<em>single-row</em>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_matrix\">matrix</a>\non the first bar, using an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\nas a\n<a href=\"/pine-script-docs/v5/language/arrays/#using-an-array-as-a-queue\">queue</a> to hold recent\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nvalues, then replacing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop with a call to\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_matrix.mult\">matrix.mult()</a>.\nSee the <a href=\"/pine-script-docs/v5/language/matrices/\">Matrices</a>\npage to learn more about working with <code dir=\"auto\">matrix.*()</code> functions.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"eliminating-loops\"><a href=\"#eliminating-loops\">Eliminating loops<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p><a href=\"/pine-script-docs/v5/language/loops/\">Loops</a> allow Pine scripts to\nperform <em>iterative</em> calculations on each execution. Each time a loop\nactivates, its local code may execute <em>several times</em>, often leading to\na <em>substantial increase</em> in resource usage.</p>\n<p>Pine loops are necessary for <em>some</em> calculations, such as manipulating\nelements within\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> or looking backward through a dataset\u2019s history to\ncalculate values <em>only</em> obtainable on the current bar. However, in many\nother cases, programmers use loops when they <strong>don\u2019t need to</strong>, leading\nto suboptimal runtime performance. In such cases, one may eliminate\nunnecessary loops in any of the following ways, depending on what their\ncalculations entail:</p>\n<ul>\n<li>Identifying simplified, <strong>loop-free expressions</strong> that achieve the\nsame result without iteration</li>\n<li>Replacing a loop with optimized\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#using-built-ins\">built-ins</a> where possible</li>\n<li>Distributing a loop\u2019s iterations <em>across bars</em> when feasible rather\nthan evaluating them all at once</li>\n</ul>\n<p>This simple example contains an <code dir=\"auto\">avgDifference()</code> function that\ncalculates the average difference between the current bar\u2019s <code dir=\"auto\">source</code>\nvalue and all the values from <code dir=\"auto\">length</code> previous bars. The script calls\nthis function to calculate the average difference between the current\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprice and <code dir=\"auto\">lengthInput</code> previous prices, then it\n<a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the result on the\nchart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Eliminating loops demo\")\n\n//@variable The number of bars in the calculation.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@function Calculates the average difference between the current `source` and `length` previous `source` values.\navgDifference(float source, int length) =&gt;\n    float diffSum = 0.0\n    for i = 1 to length\n        diffSum += source - source[i]\n    diffSum / length\n\nplot(avgDifference(close, lengthInput))</div>\n<p>After inspecting the script\u2019s\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> with the default settings, we see that it took about 64\nmilliseconds to execute 20,157 times:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Eliminating-loops-1.CagHTlaL_Z1XidNw.webp\" width=\"1072\"/></p>\n<p>Since we use the <code dir=\"auto\">lengthInput</code> as the <code dir=\"auto\">length</code> argument in the\n<code dir=\"auto\">avgDifference()</code> call and that argument controls how many times the\nloop inside the function must iterate, our script\u2019s runtime will\n<strong>grow</strong> with the <code dir=\"auto\">lengthInput</code> value. Here, we set the input\u2019s value\nto 2000 in the script\u2019s settings. This time, the script completed its\nexecutions in about 3.8 seconds:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"304\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Eliminating-loops-2.GHOgXfCo_Z2hwC8b.webp\" width=\"1072\"/></p>\n<p>As we see from these results, the <code dir=\"auto\">avgDifference()</code> function can be\ncostly to call, depending on the specified <code dir=\"auto\">lengthInput</code> value, due to\nits <a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a>\nloop that executes on each bar. However,\n<a href=\"/pine-script-docs/v5/language/loops/\">loops</a> are <strong>not</strong> necessary\nto achieve the output. To understand why, let\u2019s take a closer look at\nthe loop\u2019s calculations. We can represent them with the following\nexpression:</p>\n<div class=\"pine-colorizer not-content\">(source - source[1]) + (source - source[2]) + ... + (source - source[length])</div>\n<p>Notice that it adds the <em>current</em> <code dir=\"auto\">source</code> value <code dir=\"auto\">length</code> times. These\niterative additions are not necessary. We can simplify that part of the\nexpression to <code dir=\"auto\">source * length</code>, which reduces it to the following:</p>\n<div class=\"pine-colorizer not-content\">source * length - source[1] - source[2] - ... - source[length]</div>\n<p>or equivalently:</p>\n<div class=\"pine-colorizer not-content\">source * length - (source[1] + source[2] + ... + source[length])</div>\n<p>After simplifying and rearranging this representation of the loop\u2019s\ncalculations, we see that we can compute the result in a simpler way and\n<strong>eliminate</strong> the loop by subtracting the previous bar\u2019s <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_math.sum\">rolling\nsum</a>\nof <code dir=\"auto\">source</code> values from the <code dir=\"auto\">source * length</code> value, i.e.:</p>\n<div class=\"pine-colorizer not-content\">source * length - math.sum(source, length)[1]</div>\n<p>The <code dir=\"auto\">fastAvgDifference()</code> function below is a <strong>loop-free</strong> alternative\nto the original <code dir=\"auto\">avgDifference()</code> function that uses the above\nexpression to calculate the sum of <code dir=\"auto\">source</code> differences, then divides\nthe expression by the <code dir=\"auto\">length</code> to return the average difference:</p>\n<div class=\"pine-colorizer not-content\">//@function A faster way to calculate the `avgDifference()` result. \n//          Eliminates the `for` loop using the relationship: \n//          `(x - x[1]) + (x - x[2]) + ... + (x - x[n]) = x * n - math.sum(x, n)[1]`.\nfastAvgDifference(float source, int length) =&gt;\n    (source * length - math.sum(source, length)[1]) / length</div>\n<p>Now that we\u2019ve identified a potential optimized solution, we can\ncompare the performance of <code dir=\"auto\">fastAvgDifference()</code> to the original\n<code dir=\"auto\">avgDifference()</code> function. The script below is a modified form of the\nprevious version that plots the results from calling both functions with\nthe <code dir=\"auto\">lengthInput</code> as the <code dir=\"auto\">length</code> argument:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Eliminating loops demo\")\n\n//@variable The number of bars in the calculation.\nint lengthInput = input.int(20, \"Length\", 1)\n\n//@function Calculates the average difference between the current `source` and `length` previous `source` values.\navgDifference(float source, int length) =&gt;\n    float diffSum = 0.0\n    for i = 1 to length\n        diffSum += source - source[i]\n    diffSum / length\n\n//@function A faster way to calculate the `avgDifference()` result. \n//          Eliminates the `for` loop using the relationship: \n//          `(x - x[1]) + (x - x[2]) + ... + (x - x[n]) = x * n - math.sum(x, n)[1]`.\nfastAvgDifference(float source, int length) =&gt;\n    (source * length - math.sum(source, length)[1]) / length\n\nplot(avgDifference(close, lengthInput))\nplot(fastAvgDifference(close, lengthInput))</div>\n<p>The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> for the script with the default <code dir=\"auto\">lengthInput</code> of 20 show a\nsubstantial difference in runtime spent on the two function calls. The\ncall to the original function took about 47.3 milliseconds to execute\n20,157 times on this run, whereas our optimized function only took 4.5\nmilliseconds:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"410\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Eliminating-loops-3.DiuPpBDh_1dyGfx.webp\" width=\"1072\"/></p>\n<p>Now, let\u2019s compare the performance with the <em>heavier</em> <code dir=\"auto\">lengthInput</code>\nvalue of 2000. As before, the runtime spent on the <code dir=\"auto\">avgDifference()</code>\nfunction increased significantly. However, the time spent executing the\n<code dir=\"auto\">fastAvgDifference()</code> call remained very close to the result from the\nprevious\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-across-configurations\">configuration</a>. In other words, while our original function\u2019s runtime\nscales directly with its <code dir=\"auto\">length</code> argument, our optimized function\ndemonstrates relatively <em>consistent</em> performance since it does not\nrequire a loop:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"410\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Eliminating-loops-4.V8AwhZcD_23XFmP.webp\" width=\"1072\"/></p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Not all iterative calculations will necessarily have loop-free\nalternatives. In the case where a script can <strong>only</strong> achieve its\nresults through iteration, programmers can identify possible ways to\noptimize loops to improve performance. See the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#optimizing-loops\">next section</a> for more information.</p></div></aside>\n<h3 class=\"md-heading\" id=\"optimizing-loops\"><a href=\"#optimizing-loops\">Optimizing loops<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Although Pine\u2019s\n<a href=\"/pine-script-docs/v5/language/execution-model/\">execution model</a> and\nthe available built-ins often <em>eliminate</em> the need for\n<a href=\"/pine-script-docs/v5/language/loops/\">loops</a> in many cases, there\nare still instances where a script <strong>will</strong> require\n<a href=\"/pine-script-docs/v5/language/loops/\">loops</a> for some types of\ntasks, including:</p>\n<ul>\n<li>Manipulating\n<a href=\"/pine-script-docs/v5/language/type-system/#collections\">collections</a> or executing calculations over a collection\u2019s elements\nwhen the available built-ins <strong>will not</strong> suffice</li>\n<li>Performing calculations across historical bars that one <strong>cannot</strong>\nachieve with simplified <em>loop-free</em> expressions or optimized\n<em>built-ins</em></li>\n<li>Calculating values that are <strong>only</strong> obtainable through iteration</li>\n</ul>\n<p>When a script uses <a href=\"/pine-script-docs/v5/language/loops/\">loops</a>\nthat a programmer cannot\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#eliminating-loops\">eliminate</a>, there are <a href=\"https://en.wikipedia.org/wiki/Loop_optimization\" rel=\"nofollow\">several\ntechniques</a> one can use\nto reduce their performance impact. This section explains two of the\nmost common, useful techniques that can help improve a required loop\u2019s\nefficiency.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>Before identifying ways to <em>optimize</em> a loop, we recommend searching for\nways to\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#eliminating-loops\">eliminate</a> it first. If <strong>no solution</strong> exists that makes the loop\nunnecessary, then proceed with attempting to reduce its overhead.</p></div></aside>\n<h4 class=\"md-heading\" id=\"reducing-loop-calculations\"><a href=\"#reducing-loop-calculations\">Reducing loop calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The code executed within a <a href=\"/pine-script-docs/v5/language/loops/\">loop\u2019s</a> local scope can have a <strong>multiplicative</strong> impact on its\noverall runtime, as each time a loop statement executes, it will\ntypically trigger <em>several</em> iterations of the local code. Therefore,\nprogrammers should strive to keep a loop\u2019s calculations as simple as\npossible by eliminating unnecessary structures, function calls, and\noperations to minimize the performance impact, especially when the\nscript must evaluate its loops <em>numerous times</em> throughout all its\nexecutions.</p>\n<p>For example, this script contains a <code dir=\"auto\">filteredMA()</code> function that\ncalculates a moving average of up to <code dir=\"auto\">length</code> unique <code dir=\"auto\">source</code> values,\ndepending on the <code dir=\"auto\">true</code> elements in a specified <code dir=\"auto\">mask</code>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.\nThe function queues the unique <code dir=\"auto\">source</code> values into a <code dir=\"auto\">data</code>\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>,\nuses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop to iterate over the <code dir=\"auto\">data</code> and calculate the <code dir=\"auto\">numerator</code> and\n<code dir=\"auto\">denominator</code> sums, then returns the ratio of those sums. Within the\nloop, it only adds values to the sums when the <code dir=\"auto\">data</code> element is not\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_na\">na</a> and\nthe <code dir=\"auto\">mask</code> element at the <code dir=\"auto\">index</code> is <code dir=\"auto\">true</code>. The script utilizes this\n<a href=\"/pine-script-docs/v5/language/user-defined-functions/\">user-defined function</a> to calculate the average of up to 100 unique\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_close\">close</a>\nprices filtered by a <code dir=\"auto\">randMask</code> and plots the result on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing loop calculations demo\", overlay = true)\n\n//@function Calculates a moving average of up to `length` unique `source` values filtered by a `mask` array.\nfilteredMA(float source, int length, array&lt;bool&gt; mask) =&gt;\n    // Raise a runtime error if the size of the `mask` doesn't equal the `length`.\n    if mask.size() != length\n        runtime.error(\"The size of the `mask` array used in the `filteredMA()` call must match the `length`.\")\n    //@variable An array containing `length` unique `source` values.\n    var array&lt;float&gt; data = array.new&lt;float&gt;(length)\n    // Queue unique `source` values into the `data` array.\n    if not data.includes(source)\n        data.push(source)\n        data.shift()\n    // The numerator and denominator of the average.\n    float numerator   = 0.0\n    float denominator = 0.0\n    // Loop to calculate sums.\n    for item in data\n        if na(item)\n            continue\n        int index = array.indexof(data, item)\n        if mask.get(index)\n            numerator   += item\n            denominator += 1.0\n    // Return the average, or the last non-`na` average value if the current value is `na`.\n    fixnan(numerator / denominator)\n\n//@variable An array of 100 pseudorandom \"bool\" values.\nvar array&lt;bool&gt; randMask = array.new&lt;bool&gt;(100, true)\n// Push the first element from `randMask` to the end and queue a new pseudorandom value.\nrandMask.push(randMask.shift())\nrandMask.push(math.random(seed = 12345) &lt; 0.5)\nrandMask.shift()\n\n// Plot the `filteredMA()` of up to 100 unique `close` values filtered by the `randMask`.\nplot(filteredMA(close, 100, randMask))</div>\n<p>After\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profiling the script</a>, we see it took about two seconds to execute 21,778 times.\nThe code with the highest performance impact is the expression on line\n37, which calls the <code dir=\"auto\">filteredMA()</code> function. Within the <code dir=\"auto\">filteredMA()</code>\nfunction\u2019s scope, the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop has the highest impact, with the <code dir=\"auto\">index</code> calculation in the loop\u2019s\nscope (line 22) contributing the most to the loop\u2019s runtime:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"684\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Optimizing-loops-Reducing-loop-calculations-1.DATOq5cw_2jUPjt.webp\" width=\"1070\"/></p>\n<p>The above code demonstrates suboptimal usage of a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop, as we <strong>do not</strong> need to call\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a>\nto retrieve the <code dir=\"auto\">index</code> in this case. The\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a>\nfunction can be <em>costly</em> to call within a loop since it must search\nthrough the <a href=\"/pine-script-docs/v5/language/arrays/\">array\u2019s</a>\ncontents and locate the corresponding element\u2019s index <em>each time</em> the\nscript calls it.</p>\n<p>To eliminate this costly call from our\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop, we can use the <em>second form</em> of the structure, which produces a\n<em>tuple</em> containing the <strong>index</strong> and the element\u2019s value on each\niteration:</p>\n<div class=\"pine-colorizer not-content\">for [index, item] in data</div>\n<p>In this version of the script, we removed the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.indexof\">array.indexof()</a>\ncall on line 22 since it is <strong>not</strong> necessary to achieve the intended\nresult, and we changed the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop to use the alternative form:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Reducing loop calculations demo\", overlay = true)\n\n//@function Calculates a moving average of up to `length` unique `source` values filtered by a `mask` array.\nfilteredMA(float source, int length, array&lt;bool&gt; mask) =&gt;\n    // Raise a runtime error if the size of the `mask` doesn't equal the `length`.\n    if mask.size() != length\n        runtime.error(\"The size of the `mask` array used in the `filteredMA()` call must match the `length`.\")\n    //@variable An array containing `length` unique `source` values.\n    var array&lt;float&gt; data = array.new&lt;float&gt;(length)\n    // Queue unique `source` values into the `data` array.\n    if not data.includes(source)\n        data.push(source)\n        data.shift()\n    // The numerator and denominator of the average.\n    float numerator   = 0.0\n    float denominator = 0.0\n    // Loop to calculate sums.\n    for [index, item] in data\n        if na(item)\n            continue\n        if mask.get(index)\n            numerator   += item\n            denominator += 1.0\n    // Return the average, or the last non-`na` average value if the current value is `na`.\n    fixnan(numerator / denominator)\n\n//@variable An array of 100 pseudorandom \"bool\" values.\nvar array&lt;bool&gt; randMask = array.new&lt;bool&gt;(100, true)\n// Push the first element from `randMask` to the end and queue a new pseudorandom value.\nrandMask.push(randMask.shift())\nrandMask.push(math.random(seed = 12345) &lt; 0.5)\nrandMask.shift()\n\n// Plot the `filteredMA()` of up to 100 unique `close` values filtered by the `randMask`. \nplot(filteredMA(close, 100, randMask))</div>\n<p>With this simple change, our loop is much more efficient, as it no\nlonger needs to redundantly search through the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>\non each iteration to keep track of the index. The\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> from this script run show that it took only 0.6 seconds to\ncomplete its executions, a significant improvement over the previous\nversion\u2019s result:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"668\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Optimizing-loops-Reducing-loop-calculations-2.ChKixPxa_1dGXff.webp\" width=\"1070\"/></p>\n<h4 class=\"md-heading\" id=\"loop-invariant-code-motion\"><a href=\"#loop-invariant-code-motion\">Loop-invariant code motion<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p><em>Loop-invariant code</em> is any code region within a\n<a href=\"/pine-script-docs/v5/language/loops/\">loop\u2019s</a> scope that produces\nan <strong>unchanging</strong> result on each iteration. When a script\u2019s\n<a href=\"/pine-script-docs/v5/language/loops/\">loops</a> contain loop-invariant\ncode, it can substantially impact performance in some cases due to\nexcessive, <strong>unnecessary</strong> calculations.</p>\n<p>Programmers can optimize a loop with invariant code by <em>moving</em> the\nunchanging calculations <strong>outside</strong> the loop\u2019s scope so the script only\nneeds to evaluate them once per execution rather than repetitively.</p>\n<p>The following example contains a <code dir=\"auto\">featureScale()</code> function that creates\na rescaled version of an\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_array\">array</a>.\nWithin the function\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop, it scales each element by calculating its distance from the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">array.min()</a>\nand dividing the value by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.range\">array.range()</a>.\nThe script uses this function to create a <code dir=\"auto\">rescaled</code> version of a\n<code dir=\"auto\">prices</code> array and <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the\ndifference between the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.first\">rescaled.first()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.avg\">rescaled.avg()</a>\nvalues on the chart:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop-invariant code motion demo\")\n\n//@function Returns a feature scaled version of `this` array.\nfeatureScale(array&lt;float&gt; this) =&gt;\n    array&lt;float&gt; result = array.new&lt;float&gt;()\n    for item in this\n        result.push((item - array.min(this)) / array.range(this))\n    result\n\n//@variable An array containing the most recent 100 `close` prices.\nvar array&lt;float&gt; prices = array.new&lt;float&gt;(100, close)\n// Queue the `close` through the `prices` array.\nprices.unshift(close)\nprices.pop()\n\n//@variable A feature scaled version of the `prices` array.\narray&lt;float&gt; rescaled = featureScale(prices)\n\n// Plot the difference between the first element and the average value in the `rescaled` array.\nplot(rescaled.first() - rescaled.avg())</div>\n<p>As we see below, the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> for this script after 20,187 executions show it completed\nits run in about 3.3 seconds. The code with the highest impact on\nperformance is the line containing the <code dir=\"auto\">featureScale()</code> function call,\nand the function\u2019s critical code is the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop block starting on line 7:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"404\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Optimizing-loops-Loop-invariant-code-motion-1.BAn098-h_10uiO5.webp\" width=\"1072\"/></p>\n<p>Upon examining the loop\u2019s calculations, we can see that the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">array.min()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.range\">array.range()</a>\ncalls on line 8 are <strong>loop-invariant</strong>, as they will always produce the\n<strong>same result</strong> across each iteration. We can make our loop much more\nefficient by assigning the results from these calls to variables\n<strong>outside</strong> its scope and referencing them as needed.</p>\n<p>The <code dir=\"auto\">featureScale()</code> function in the script below assigns the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.min\">array.min()</a>\nand\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_array.range\">array.range()</a>\nvalues to <code dir=\"auto\">minValue</code> and <code dir=\"auto\">rangeValue</code> variables <em>before</em> executing the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for...in\">for\u2026in</a>\nloop. Inside the loop\u2019s local scope, it <em>references</em> the variables\nacross its iterations rather than repetitively calling these <code dir=\"auto\">array.*()</code>\nfunctions:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Loop-invariant code motion demo\")\n\n//@function Returns a feature scaled version of `this` array.\nfeatureScale(array&lt;float&gt; this) =&gt;\n    array&lt;float&gt; result = array.new&lt;float&gt;()\n    float minValue      = array.min(this)\n    float rangeValue    = array.range(this)\n    for item in this\n        result.push((item - minValue) / rangeValue)\n    result\n\n//@variable An array containing the most recent 100 `close` prices.\nvar array&lt;float&gt; prices = array.new&lt;float&gt;(100, close)\n// Queue the `close` through the `prices` array.\nprices.unshift(close)\nprices.pop()\n\n//@variable A feature scaled version of the `prices` array.\narray&lt;float&gt; rescaled = featureScale(prices)\n\n// Plot the difference between the first element and the average value in the `rescaled` array.\nplot(rescaled.first() - rescaled.avg())</div>\n<p>As we see from the script\u2019s\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a>, moving the <em>loop-invariant</em> calculations outside the loop\nleads to a substantial performance improvement. This time, the script\ncompleted its executions in only 289.3 milliseconds:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"438\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Optimizing-loops-Loop-invariant-code-motion-2.9LhBcnjw_Zn7pRo.webp\" width=\"1072\"/></p>\n<h3 class=\"md-heading\" id=\"minimizing-historical-buffer-calculations\"><a href=\"#minimizing-historical-buffer-calculations\">Minimizing historical buffer calculations<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Pine scripts create <em>historical buffers</em> for all variables and function\ncalls their outputs depend on. Each buffer contains information about\nthe range of historical values the script can access with the\nhistory-referencing operator\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#op_%5B%5D\">[]</a>.</p>\n<p>A script <em>automatically</em> determines the required buffer size for all its\nvariables and function calls by analyzing the historical references\nexecuted during the <strong>first 244 bars</strong> in a dataset. When a script only\nreferences the history of a calculated value <em>after</em> those initial bars,\nit will <strong>restart</strong> its executions repetitively across previous bars\nwith successively larger historical buffers until it either determines\nthe appropriate size or raises a runtime error. Those repetitive\nexecutions can significantly increase a script\u2019s runtime in some cases.</p>\n<p>When a script <em>excessively</em> executes across a dataset to calculate\nhistorical buffers, one effective way to improve its performance is\n<em>explicitly</em> defining suitable buffer sizes using the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a>\nfunction. With appropriate buffer sizes declared explicitly, the script\ndoes not need to re-execute across past data to determine the sizes.</p>\n<p>For example, the script below uses a\n<a href=\"/pine-script-docs/v5/concepts/lines-and-boxes/#polylines\">polyline</a>\nto draw a basic histogram representing the distribution of calculated\n<code dir=\"auto\">source</code> values over 500 bars. On the <a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_barstate.islast\">last available\nbar</a>,\nthe script uses a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_for\">for</a> loop\nto look back through historical values of the calculated <code dir=\"auto\">source</code> series\nand determine the\n<a href=\"/pine-script-docs/v5/language/type-system/#chart-points\">chart points</a> used by the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#type_polyline\">polyline</a>\ndrawing. It also <a href=\"/pine-script-docs/v5/concepts/plots/\">plots</a> the\nvalue of <code dir=\"auto\">bar_index + 1</code> to verify the number of bars it executed\nacross:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Minimizing historical buffer calculations demo\", overlay = true)\n\n//@variable A polyline with points that form a histogram of `source` values.\nvar polyline display = na\n//@variable The difference Q3 of `high` prices and Q1 of `low` prices over 500 bars.\nfloat innerRange = ta.percentile_nearest_rank(high, 500, 75) - ta.percentile_nearest_rank(low, 500, 25)\n// Calculate the highest and lowest prices, and the total price range, over 500 bars.\nfloat highest    = ta.highest(500)\nfloat lowest     = ta.lowest(500)\nfloat totalRange = highest - lowest\n\n//@variable The source series for histogram calculation. Its value is the midpoint between the `open` and `close`.\nfloat source = math.avg(open, close)\n\nif barstate.islast\n    polyline.delete(display)\n    // Calculate the number of histogram bins and their size.\n    int   bins    = int(math.round(5 * totalRange / innerRange))\n    float binSize = totalRange / bins\n    //@variable An array of chart points for the polyline.\n    array&lt;chart.point&gt; points = array.new&lt;chart.point&gt;(bins, chart.point.new(na, na, na))\n    // Loop to build the histogram.\n    for i = 0 to 499\n        //@variable The histogram bin number. Uses past values of the `source` for its calculation.\n        //          The script must execute across all previous bars AGAIN to determine the historical buffer for \n        //          `source`, as initial references to the calculated series occur AFTER the first 244 bars. \n        int index = int((source[i] - lowest) / binSize)\n        if na(index)\n            continue\n        chart.point currentPoint = points.get(index)\n        if na(currentPoint.index)\n            points.set(index, chart.point.from_index(bar_index + 1, (index + 0.5) * binSize + lowest))\n            continue\n        currentPoint.index += 1\n    // Add final points to the `points` array and draw the new `display` polyline.\n    points.unshift(chart.point.now(lowest))\n    points.push(chart.point.now(highest))\n    display := polyline.new(points, closed = true)\n\nplot(bar_index + 1, \"Number of bars\", display = display.data_window)</div>\n<p>Since the script <em>only</em> references past <code dir=\"auto\">source</code> values on the <em>last\nbar</em>, it will <strong>not</strong> construct a suitable historical buffer for the\nseries within the first 244 bars on a larger dataset. Consequently, it\nwill <strong>re-execute</strong> across all historical bars to identify the\nappropriate buffer size.</p>\n<p>As we see from the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> after running the script across 20,320 bars, the number of\n<em>global</em> code executions was 162,560, which is <strong>eight times</strong> the\nnumber of chart bars. In other words, the script had to <em>repeat</em> the\nhistorical executions <strong>seven more times</strong> to determine the appropriate\nbuffer for the <code dir=\"auto\">source</code> series in this case:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"532\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Minimizing-historical-buffer-calculations-1.Cyx3FoQJ_Z1xcPM1.webp\" width=\"1318\"/></p>\n<p>This script will only reference the most recent 500 <code dir=\"auto\">source</code> values on\nthe last historical bar and all realtime bars. Therefore, we can help it\nestablish the correct buffer <em>without</em> re-execution by defining a\n500-bar referencing length with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a>.</p>\n<p>In the following script version, we added <a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back(source,\n500)</a>\nafter the variable declaration to explicitly specify that the script\nwill access up to 500 historical <code dir=\"auto\">source</code> values throughout its\nexecutions:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Minimizing historical buffer calculations demo\", overlay = true)\n\n//@variable A polyline with points that form a histogram of `source` values.\nvar polyline display = na\n//@variable The difference Q3 of `high` prices and Q1 of `low` prices over 500 bars.\nfloat innerRange = ta.percentile_nearest_rank(high, 500, 75) - ta.percentile_nearest_rank(low, 500, 25)\n// Calculate the highest and lowest prices, and the total price range, over 500 bars.\nfloat highest    = ta.highest(500)\nfloat lowest     = ta.lowest(500)\nfloat totalRange = highest - lowest\n\n//@variable The source series for histogram calculation. Its value is the midpoint between the `open` and `close`.\nfloat source = math.avg(open, close)\n// Explicitly define a 500-bar historical buffer for the `source` to prevent recalculation.\nmax_bars_back(source, 500)\n\nif barstate.islast\n    polyline.delete(display)\n    // Calculate the number of histogram bins and their size.\n    int   bins    = int(math.round(5 * totalRange / innerRange))\n    float binSize = totalRange / bins\n    //@variable An array of chart points for the polyline.\n    array&lt;chart.point&gt; points = array.new&lt;chart.point&gt;(bins, chart.point.new(na, na, na))\n    // Loop to build the histogram.\n    for i = 0 to 499\n        //@variable The histogram bin number. Uses past values of the `source` for its calculation.\n        //          Since the `source` now has an appropriate predefined buffer, the script no longer needs \n        //          to recalculate across previous bars to determine the referencing length. \n        int index = int((source[i] - lowest) / binSize)\n        if na(index)\n            continue\n        chart.point currentPoint = points.get(index)\n        if na(currentPoint.index)\n            points.set(index, chart.point.from_index(bar_index + 1, (index + 0.5) * binSize + lowest))\n            continue\n        currentPoint.index += 1\n    // Add final points to the `points` array and draw the new `display` polyline.\n    points.unshift(chart.point.now(lowest))\n    points.push(chart.point.now(highest))\n    display := polyline.new(points, closed = true)\n\nplot(bar_index + 1, \"Number of bars\", display = display.data_window)</div>\n<p>With this change, our script no longer needs to re-execute across all\nthe historical data to determine the buffer size. As we see in the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#interpreting-profiled-results\">profiled results</a> below, the number of global code executions now aligns with\nthe number of chart bars, and the script took substantially less time to\ncomplete all of its historical executions:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"532\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Optimization-Minimizing-historical-buffer-calculations-2.DPrfVLfJ_Z1XIu4W.webp\" width=\"1318\"/></p>\n<p>Note that:</p>\n<ul>\n<li>This script only requires up to the most recent 501 historical\nbars to calculate its drawing output. In this case, another way\nto optimize resource usage is to include <code dir=\"auto\">calc_bars_count = 501</code>\nin the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction, which reduces unnecessary script executions by\nrestricting the historical data the script can calculate across\nto 501 bars.</li>\n</ul>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span></p><p>When explicitly defining a buffer size for a problematic historical\nreference with\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_max_bars_back\">max_bars_back()</a>,\nit\u2019s imperative to ensure that the script <strong>will not</strong> use more data\nthan specified later in its executions, as the script will still\nre-execute on historical bars and try to calculate the buffer if the\nuser-specified size is insufficient.</p><p>Another consideration when explicitly defining buffer sizes is that the\nlarger the buffer, the larger the <em>memory cost</em>. As such, programmers\nshould aim to keep the explicit buffer length limited to <strong>only</strong> the\nmaximum number of historical values the script will reference and <strong>not\nmore</strong>. For example, defining a 5000-bar buffer when a script only\nrequires 500 historical values will result in an unnecessary waste of\nmemory.</p><p></p></div></aside>", "segment_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/profiling-and-optimization", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"tips\"><a href=\"#tips\">Tips<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<h3 class=\"md-heading\" id=\"working-around-profiler-overhead\"><a href=\"#working-around-profiler-overhead\">Working around Profiler overhead<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Since the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Pine Profiler</a> must perform <em>extra calculations</em> to collect performance\ndata, as explained in\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#a-look-into-the-profilers-inner-workings\">this section</a>, the time it takes to execute a script <strong>increases</strong> while\nprofiling.</p>\n<p>Most scripts will run as expected with the Profiler\u2019s overhead\nincluded. However, when a complex script\u2019s runtime approaches a\n<a href=\"https://www.tradingview.com/support/solutions/43000579793/\">plan\u2019s\nlimit</a>,\nusing the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a> on it may cause its runtime to <em>exceed</em> the limit. Such a\ncase indicates that the script likely needs\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#optimization\">optimization</a>, but it can be challenging to know where to start without\nbeing able to\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#profiling-a-script\">profile the code</a>. The most effective workaround in this scenario is reducing\nthe number of bars the script must execute on. Users can achieve this\nreduction in any of the following ways:</p>\n<ul>\n<li>Selecting a dataset that has fewer data points in its history, e.g.,\na higher timeframe or a symbol with limited data</li>\n<li>Using conditional logic to limit code executions to a specific time\nor bar range</li>\n<li>Including a <code dir=\"auto\">calc_bars_count</code> argument in the script\u2019s declaration\nstatement to specify how many recent historical bars it can use</li>\n</ul>\n<p>Reducing the number of data points works in most cases because it\ndirectly decreases the number of times the script must execute,\ntypically resulting in less accumulated runtime.</p>\n<p>As a demonstration, this script contains a <code dir=\"auto\">gcd()</code> function that uses a\n<em>naive</em> algorithm to calculate the <a href=\"https://en.wikipedia.org/wiki/Greatest_common_divisor\" rel=\"nofollow\">greatest common\ndivisor</a> of two\nintegers. The function initializes its <code dir=\"auto\">result</code> using the smallest\nabsolute value of the two numbers. Then, it reduces the value of the\n<code dir=\"auto\">result</code> by one within a\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nloop until it can divide both numbers without remainders. This structure\nentails that the loop will iterate up to <em>N</em> times, where <em>N</em> is the\nsmallest of the two arguments.</p>\n<p>In this example, the script plots the value of\n<code dir=\"auto\">gcd(10000, 10000 + bar_index)</code>. The smallest of the two arguments is\nalways 10,000 in this case, meaning the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>\nloop within the function will require up to 10,000 iterations per script\nexecution, depending on the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#var_bar_index\">bar_index</a>\nvalue:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Script takes too long while profiling demo\")\n\n//@function Calculates the greatest common divisor of `a` and `b` using a naive algorithm.\ngcd(int a, int b) =&gt;\n    //@variable The greatest common divisor.\n    int result = math.max(math.min(math.abs(a), math.abs(b)), 1)\n    // Reduce the `result` by 1 until it divides `a` and `b` without remainders. \n    while result &gt; 0\n        if a % result == 0 and b % result == 0\n            break\n        result -= 1\n    // Return the `result`.\n    result\n\nplot(gcd(10000, 10000 + bar_index), \"GCD\")</div>\n<p>When we add the script to our chart, it takes a while to execute across\nour chart\u2019s data, but it does not raise an error. However, <em>after</em>\nenabling the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a>, the script raises a runtime error stating that it exceeded\nthe Premium plan\u2019s <a href=\"https://www.tradingview.com/support/solutions/43000579793/\">runtime\nlimit</a> (40\nseconds):</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"590\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Tips-Working-around-profiler-overhead-The-script-takes-too-long-to-execute-1.ChWuvP-N_1heDWT.webp\" width=\"1072\"/></p>\n<p>Our current chart has over 20,000 historical bars, which may be too many\nfor the script to handle within the alloted time while the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a> is active. We can try limiting the number of historical\nexecutions to work around the issue in this case.</p>\n<p>Below, we included <code dir=\"auto\">calc_bars_count = 10000</code> in the\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nfunction, which limits the script\u2019s available history to the most\nrecent 10,000 historical bars. After restricting the script\u2019s\nhistorical executions, it no longer exceeds the Premium plan\u2019s limit\nwhile profiling, so we can now inspect its performance results:</p>\n<p><img alt=\"image\" decoding=\"async\" height=\"590\" loading=\"lazy\" src=\"/pine-script-docs/_astro/Profiling-and-optimization-Tips-Working-around-profiler-overhead-The-script-takes-too-long-to-execute-2.DN-scZLp_Z1HYEfF.webp\" width=\"1072\"/></p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"Script takes too long while profiling demo\", calc_bars_count = 10000)\n\n//@function Calculates the greatest common divisor of `a` and `b` using a naive algorithm.\ngcd(int a, int b) =&gt;\n    //@variable The greatest common divisor.\n    int result = math.max(math.min(math.abs(a), math.abs(b)), 1)\n    // Reduce the `result` by 1 until it divides `a` and `b` without remainders.\n    while result &gt; 0\n        if a % result == 0 and b % result == 0\n            break\n        result -= 1\n    // Return the `result`.\n    result\n\nplot(gcd(10000, 10000 + bar_index), \"GCD\")</div>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>This process may require trial and error, as determining the number of\nexecutions that a computationally heavy script can handle before timing\nout is not necessarily straightforward. If a script takes too long to\nexecute after enabling the\n<a href=\"/pine-script-docs/v5/writing/profiling-and-optimization/#pine-profiler\">Profiler</a>, experiment with different ways to limit its executions\nuntil you can profile it successfully.</p></div></aside>", "segment_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "004ed1e80b9c1cbbec492b0d83820ab17d1aaf4f9b15233388cf7426348a8f87", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/publishing", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/writing/publishing\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"publishing-scripts\"><a href=\"#publishing-scripts\">Publishing scripts<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>\n<p>Programmers who wish to share their Pine scripts with other traders can\npublish them.</p>\n<aside aria-label=\"Notice!\" class=\"tv-informer not-content\" style=\"--informer-header-color:#FF9800;--informer-back-color-light:#FFF3E0;--informer-back-color-dark:#33261A\"><div class=\"tv-informer-icon\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div><div class=\"tv-informer-content\"><p><span class=\"tv-informer-header\">Notice!</span>If you write scripts for your personal use, there is no need to publish\nthem; you can save them in the Pine Editor and use the \u201cAdd to Chart\u201d\nbutton to add your script to your chart.</p></div></aside>", "segment_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/publishing", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-visibility-and-access\"><a href=\"#script-visibility-and-access\">Script visibility and access<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>When you publish a script, you control its <strong>visibility</strong> and\n<strong>access</strong>:</p>\n<ul>\n<li><strong>Visibility</strong> is controlled by choosing to publish <strong>publicly</strong> or\n<strong>privately</strong>. See <a href=\"https://www.tradingview.com/support/solutions/43000548335\">How do private ideas and scripts differ from\npublic\nones?</a> in\nthe Help Center for more details. Publish publicly when you have\nwritten a script you think can be useful to TradingViewers. Public\nscripts are subject to moderation. To avoid moderation, ensure your\npublication complies with our <a href=\"https://www.tradingview.com/support/solutions/43000591638\">House\nRules</a>\nand <a href=\"https://www.tradingview.com/support/solutions/43000590599\">Script Publishing\nRules</a>.\nPublish privately when you don\u2019t want your script visible to all\nother users, but want to share it with a few friends.</li>\n<li><strong>Access</strong> determines if users will see your source code, and how\nthey will be able to use your script. There are three access types:\n<em>open</em>, <em>protected</em> (reserved to paid accounts) or <em>invite-only</em>\n(reserved to Premium accounts). See <a href=\"https://www.tradingview.com/support/solutions/43000482573\">What are the different types of\npublished\nscripts?</a>\nin the Help Center for more details.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"when-you-publish-a-script\"><a href=\"#when-you-publish-a-script\">When you publish a script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<ul>\n<li>The publication\u2019s title is determined by the argument used for the\n<code dir=\"auto\">title</code> parameter in the script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement. That title is also used when TradingViewers\nsearch for script names.</li>\n<li>The name of your script on the chart will be the argument used for\nthe <code dir=\"auto\">shorttitle</code> parameter in the script\u2019s\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>\ndeclaration statement, or the [title] argument in\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>.</li>\n<li>Your script must have a description explaining what your script does\nand how to use it.</li>\n<li>The chart you are using when you publish will become visible in your\npublication, including any other scripts or drawings on it. Remove\nunrelated scripts or drawings from your chart before publishing your\nscript.</li>\n<li>Your script\u2019s code can later be updated. Each update can include\n<em>release notes</em> which will appear, dated, under your original\ndescription.</li>\n<li>Scripts can be liked, shared, commented on or reported by other\nusers.</li>\n<li>Your published scripts appear under the \u201cSCRIPTS\u201d tab of your user\nprofile.</li>\n<li>A <em>script widget</em> and a <em>script page</em> are created for your script.\nThe script widget is your script\u2019s placeholder showing in script\nfeeds on the platform. It contains your script\u2019s title, chart and\nthe first few lines of your description. When users click on your\nscript <strong>widget</strong>, the script\u2019s <strong>page</strong> opens. It contains all the\ninformation relating to your script.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"visibility\"><a href=\"#visibility\">Visibility<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<h4 class=\"md-heading\" id=\"public\"><a href=\"#public\">Public<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When you publish a public script:</p>\n<ul>\n<li>Your script will be inluded in our <a href=\"https://www.tradingview.com/scripts/\">Community\nScripts</a> where it becomes\nvisible to the millions of TradingViewers on all internationalized\nversions of the site.</li>\n<li>Your publication must comply with <a href=\"https://www.tradingview.com/support/solutions/43000591638\">House\nRules</a>\nand <a href=\"https://www.tradingview.com/support/solutions/43000590599\">Script Publishing\nRules</a>.</li>\n<li>If your script is an invite-only script, you must comply with our\n<a href=\"https://www.tradingview.com/support/solutions/43000549951\">Vendor\nRequirements</a>.</li>\n<li>It becomes accessible through the search functions for scripts.</li>\n<li>You will not be able to edit your original description or its title,\nnor change its public/private visibility, nor its access type\n(open-source, protected, invite-only).</li>\n<li>You will not be able to delete your publication.</li>\n</ul>\n<h4 class=\"md-heading\" id=\"private\"><a href=\"#private\">Private<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>When you publish a private script:</p>\n<ul>\n<li>It will not be visible to other users unless you share its url with\nthem.</li>\n<li>It is visible to you from your user profile\u2019s \u201cSCRIPTS\u201d tab.</li>\n<li>Private scripts are identifiable by the \u201cX\u201d and \u201clock\u201d icons in\nthe top-right of their widget. The \u201cX\u201d is used to delete it.</li>\n<li>It is not moderated, unless you sell access to it or make it\navailable publicly, as it is then no longer \u201cprivate\u201d.</li>\n<li>You can update its original description and title.</li>\n<li>You cannot link to or mentioned it from any public TradingView\ncontent (ideas, script descriptions, comments, chats, etc.).</li>\n<li>It is not accessible through the search functions for scripts.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"access\"><a href=\"#access\">Access<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Public or private scripts can be published using one of three access\ntypes: open, protected or invite-only. The access type you can select\nfrom will vary with the type of account you hold.</p>\n<h4 class=\"md-heading\" id=\"open\"><a href=\"#open\">Open<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The Pine Script\u00ae code of scripts published <strong>open</strong> is visible to all\nusers. Open-source scripts on TradingView use the Mozilla license by\ndefault, but you may choose any license you want. You can find\ninformation on licensing at\n<a href=\"https://help.github.com/articles/licensing-a-repository/\" rel=\"nofollow\">GitHub</a>.</p>\n<h4 class=\"md-heading\" id=\"protected\"><a href=\"#protected\">Protected<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The code of <strong>protected</strong> scripts is hidden from view and no one but its\nauthor can access it. While the script\u2019s code is not accessible,\nprotected scripts can be used freely by any user. Only accounts with paid plans may publish public protected scripts.</p>\n<h4 class=\"md-heading\" id=\"invite-only\"><a href=\"#invite-only\">Invite-only<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h4>\n<p>The <strong>invite-only</strong> access type protects both the script\u2019s code and its\nuse. The publisher of an invite-only script must explicitly grant access\nto individual users. Invite-only scripts are mostly used by script\nvendors providing paid access to their scripts. Only Premium accounts\ncan publish invite-only scripts, and they must comply with our <a href=\"https://www.tradingview.com/support/solutions/43000549951\">Vendor\nRequirements</a>.</p>\n<p>TradingView does not benefit from script sales. Transactions concerning\ninvite-only scripts are strictly between users and vendors; they do not\ninvolve TradingView.</p>\n<p>Public invite-only scripts are the only scripts for which vendors are\nallowed to ask for payment on TradingView.</p>\n<p>On their invite-only script\u2019s page, authors will see a \u201cManage\nAccess\u201d button. The \u201cManage Access\u201d window allows authors to control\nwho has access to their script.</p>\n<p><img alt=\"PublishingScripts-Access-1\" decoding=\"async\" height=\"1142\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-Access-1.DIcfqipE_Z1WwkqA.webp\" width=\"1688\"/></p>", "segment_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/publishing", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"preparing-a-publication\"><a href=\"#preparing-a-publication\">Preparing a publication<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<ol>\n<li>\n<p>Even if you intend to publish publicly, it is always best to start\nwith a private publication because you can use it to validate what\nyour final publication will look like. You can edit the title,\ndescription, code or chart of private publications, and contrary to\npublic scripts, you can delete private scripts when you don\u2019t need\nthem anymore, so they are the perfect way to practice before sharing\na script publicly. You can read more about preparing script\ndescriptions in the <a href=\"https://www.tradingview.com/chart/SSP/aOYEvBxw-How-We-Write-and-Format-Script-Descriptions/\">How We Write and Format Script\nDescriptions</a>\npublication.</p>\n</li>\n<li>\n<p>Prepare your chart. Load your script on the chart and remove other\nscripts or drawings that won\u2019t help users understand your script.\nYour script\u2019s plots should be easy to identify on the chart that\nwill be published with it.</p>\n</li>\n<li>\n<p>Load your code in the Pine Editor if it isn\u2019t already. In the\nEditor, click the \u201cPublish Script\u201d button:</p>\n<p><img alt=\"PublishingScripts-PreparingAPublication-1\" decoding=\"async\" height=\"302\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-PreparingAPublication-1.C49J1o74_2mwn7R.webp\" width=\"1235\"/></p>\n</li>\n<li>\n<p>A popup appears to remind you that if you publish publicly, it\u2019s\nimportant that your publication comply with House Rules. Once\nyou\u2019re through the popup, place your description in the field below\nthe script\u2019s title. The default title proposed for your publication\nis the <code dir=\"auto\">title</code> field from your script\u2019s code. It is always best to\nuse that title; it makes it easier for users to search for your\nscript if it is public. Select the visibility of your publication.\nWe want to publish a private publication, so we check the \u201cPrivate\nScript\u201d checkbox at the bottom-right of the \u201cPublish Script\u201d\nwindow:</p>\n<p><img alt=\"PublishingScripts-PreparingAPublication-2\" decoding=\"async\" height=\"1403\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-PreparingAPublication-2.C_K7eGUQ_2rMfz8.webp\" width=\"1577\"/></p>\n</li>\n<li>\n<p>Select the access type you want for your script: Open, Protected or\nInvite-only. We have selected \u201cOpen\u201d for open-source.</p>\n<p><img alt=\"PublishingScripts-PreparingAPublication-3\" decoding=\"async\" height=\"629\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-PreparingAPublication-3.z3F1bymc_nbxHz.webp\" width=\"1576\"/></p>\n</li>\n<li>\n<p>Select the appropriate categories for your script (at least one is\nmandatory) and enter optional custom tags.</p>\n<p><img alt=\"PublishingScripts-PreparingAPublication-4\" decoding=\"async\" height=\"794\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-PreparingAPublication-4.KMleYe8H_1oxUYD.webp\" width=\"1572\"/></p>\n</li>\n<li>\n<p>Click the \u201cPublish Private Script\u201d button in the lower-right of\nthe window. When the publication is complete, your published\nscript\u2019s page will appear. You are done! You can confirm the\npublication by going to your User Profile and viewing your\n\u201cSCRIPTS\u201d tab. From there, you will be able to open your script\u2019s\npage and edit your private publication by using the \u201cEdit\u201d button\nin the top-right of your script\u2019s page. Note that you can also\nupdate private publications, just like you can public ones. If you\nwant to share your private publication with a friend, privately send\nher the url from your script\u2019s page. Remember you are not allowed\nto share links to private publications in public TradingView\ncontent.</p>\n</li>\n</ol>", "segment_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/publishing", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"publishing-a-script\"><a href=\"#publishing-a-script\">Publishing a script<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Whether you intend to publish privately or publicly, first follow the\nsteps in the previous section. If you intend to publish privately, you\nwill be done. If you intend to publish publicly and are satisfied with\nthe preparatory process of validating your private publication, follow\nthe same steps as above but do not check the \u201cPrivate Script\u201d checkbox\nand click the \u201cPublish Public Script\u201d button at the bottom-right of\nthe \u201cPublish Script\u201d page.</p>\n<p>When you publish a new public script, you have a 15-minute window to\nmake changes to your description or delete the publication. After that\nyou will no longer be able to change your publication\u2019s title,\ndescription, visiblity or access type. If you make an error, send a\nmessage to the <a href=\"https://www.tradingview.com/u/PineCoders/\">PineCoders</a>\nmoderator account; they moderate script publications and will help.</p>", "segment_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/publishing", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"updating-a-publication\"><a href=\"#updating-a-publication\">Updating a publication<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>You can update both public or private script publications. When you\nupdate a script, its code must be different than the previously\npublished version\u2019s code. You can add release notes with your update.\nThey will appear after your script\u2019s original description in the\nscript\u2019s page.</p>\n<p>By default, the chart used when you update will replace the previous\nchart in your script\u2019s page. You can choose not to update your script\npage\u2019s chart, however. Note that while you can update the chart\ndisplayed in the script\u2019s page, the chart from the script\u2019s widget\nwill not update.</p>\n<p>In the same way you can validate a public publication by first\npublishing a private script, you can also validate an update on a\nprivate publication before proceeding with it on your public one. The\nprocess of updating a published script is the same for public and\nprivate scripts.</p>\n<p>If you intend to update both the code and chart of your published\nscript, prepare your chart the same way you would for a new publication.\nIn the following example, we will <strong>not</strong> be updating the publication\u2019s\nchart:</p>\n<ol>\n<li>\n<p>As you would for a new publication, load your script in the Editor\nand click the \u201cPublish Script\u201d button.</p>\n</li>\n<li>\n<p>Once in the \u201cPublish Script\u201d window, select the \u201cUpdate Existing\nScript\u201d button. Then select the script to update from the \u201cChoose\nscript\u201d dropdown menu:</p>\n<p><img alt=\"PublishingScripts-UpdatingAPublication-1\" decoding=\"async\" height=\"402\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-UpdatingAPublication-1.GafJ4pij_Z1sTF9b.webp\" width=\"1577\"/></p>\n</li>\n<li>\n<p>Enter your release notes in the text field. The differences in your\ncode are highlighted below your release notes.</p>\n</li>\n<li>\n<p>We do not want to update the publication\u2019s chart, so we check the\n\u201cDon\u2019t update the chart\u201d checkbox:</p>\n<p><img alt=\"PublishingScripts-UpdatingAPublication-2\" decoding=\"async\" height=\"1404\" loading=\"lazy\" src=\"/pine-script-docs/_astro/PublishingScripts-UpdatingAPublication-2.BMSEQDOQ_Z12mui3.webp\" width=\"1579\"/></p>\n</li>\n<li>\n<p>Click the \u201cPublish New Version\u201d button. You\u2019re done.</p>\n</li>\n</ol>", "segment_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "006aeba10eda66d3b1c87a8335ec3c665f515ee558da8ef633af7eb1999cac58", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<div data-astro-cid-ac2mn7rr=\"\" style=\"margin-top: 24px;\"> <div class=\"informer not-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <div class=\"informer-icon\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"><svg height=\"18\" viewbox=\"0 0 18 18\" width=\"18\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16ZM9 4c-.79 0-1.38.7-1.25 1.48l.67 4.03a.59.59 0 0 0 1.16 0l.67-4.03A1.27 1.27 0 0 0 9 4Zm0 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z\" fill=\"currentColor\" fill-rule=\"evenodd\"></path></svg></div> <div class=\"informer-content\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <p data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\"> <span class=\"informer-header\" data-astro-cid-n74pbcwm=\"\" style=\"--informer-header-color: #FF9800;--informer-back-color-light: #FFF3E0;--informer-back-color-dark: #33261A;\">Notice!</span> \nThis is documentation for v5, which is no longer\n\t\t\t\t\tactively maintained.\n<br data-astro-cid-ac2mn7rr=\"\"/>\nFor up-to-date documentation, see the <a data-astro-cid-ac2mn7rr=\"\" href=\"https://www.tradingview.com/pine-script-docs/writing/style-guide\">latest version</a>.\n </p> <!-- <slot /> --> </div> </div> </div><h1 class=\"md-heading\" id=\"style-guide\"><a href=\"#style-guide\">Style guide<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h1>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:1", "segment_order": 1, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"introduction\"><a href=\"#introduction\">Introduction<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>This style guide provides recommendations on how to name variables and\norganize your Pine scripts in a standard way that works well. Scripts\nthat follow our best practices will be easier to read, understand and\nmaintain.</p>\n<p>You can see scripts using these guidelines published from the\n<a href=\"https://www.tradingview.com/u/TradingView/#published-scripts\">TradingView</a>\nand\n<a href=\"https://www.tradingview.com/u/PineCoders/#published-scripts\">PineCoders</a>\naccounts on the platform.</p>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:2", "segment_order": 2, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"naming-conventions\"><a href=\"#naming-conventions\">Naming Conventions<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>We recommend the use of:</p>\n<ul>\n<li><code dir=\"auto\">camelCase</code> for all identifiers, i.e., variable or function names:\n<code dir=\"auto\">ma</code>, <code dir=\"auto\">maFast</code>, <code dir=\"auto\">maLengthInput</code>, <code dir=\"auto\">maColor</code>, <code dir=\"auto\">roundedOHLC()</code>,\n<code dir=\"auto\">pivotHi()</code>.</li>\n<li>All caps <code dir=\"auto\">SNAKE_CASE</code> for constants: <code dir=\"auto\">BULL_COLOR</code>, <code dir=\"auto\">BEAR_COLOR</code>,\n<code dir=\"auto\">MAX_LOOKBACK</code>.</li>\n<li>The use of qualifying suffixes when it provides valuable clues about\nthe type or provenance of a variable: <code dir=\"auto\">maShowInput</code>, <code dir=\"auto\">bearColor</code>,\n<code dir=\"auto\">bearColorInput</code>, <code dir=\"auto\">volumesArray</code>, <code dir=\"auto\">maPlotID</code>, <code dir=\"auto\">resultsTable</code>,\n<code dir=\"auto\">levelsColorArray</code>.</li>\n</ul>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:3", "segment_order": 3, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"script-organization\"><a href=\"#script-organization\">Script organization<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>The Pine Script\u00ae compiler is quite forgiving of the positioning of\nspecific statements or the version\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation</a> in the script. While other arrangements are syntactically\ncorrect, this is how we recommend organizing scripts:</p>\n<div class=\"expressive-code not-content\"><link href=\"/pine-script-docs/_astro/ec.dtidy.css\" rel=\"stylesheet\"><script src=\"/pine-script-docs/_astro/ec.qopfj.js\" type=\"module\"></script><figure class=\"frame\"><figcaption class=\"header\"></figcaption><pre data-language=\"text\"><code><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;license&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;version&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;declaration_statement&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;import_statements&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;constant_declarations&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;inputs&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;function_declarations&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;calculations&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;strategy_calls&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;visuals&gt;</span></div></div><div class=\"ec-line\"><div class=\"code\"><span style=\"--0:#e1e4e8;--1:#24292e\">&lt;alerts&gt;</span></div></div></code></pre></figure></link></div>\n<h3 class=\"md-heading\" id=\"license\"><a href=\"#license\">&lt;license&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If you publish your open-source scripts publicly on TradingView (scripts\ncan also be published privately), your open-source code is by default\nprotected by the Mozilla license. You may choose any other license you\nprefer.</p>\n<p>The reuse of code from those scripts is governed by our <a href=\"https://www.tradingview.com/support/solutions/43000590599\">House Rules on\nScript\nPublishing</a>\nwhich preempt the author\u2019s license.</p>\n<p>The standard license comments appearing at the beginning of scripts are:</p>\n<div class=\"pine-colorizer not-content\">// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/\n// \u00a9 username</div>\n<h3 class=\"md-heading\" id=\"version\"><a href=\"#version\">&lt;version&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This is the\n<a href=\"/pine-script-docs/v5/language/script-structure/#compiler-annotations\">compiler annotation</a> defining the version of Pine Script the script will use. If\nnone is present, v1 is used. For v5, use:</p>\n<div class=\"pine-colorizer not-content\">//@version=5</div>\n<h3 class=\"md-heading\" id=\"declaration_statement\"><a href=\"#declaration_statement\">&lt;declaration_statement&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This is the mandatory declaration statement which defines the type of\nyour script. It must be a call to either\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_indicator\">indicator()</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_strategy\">strategy()</a>,\nor\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#fun_library\">library()</a>.</p>\n<h3 class=\"md-heading\" id=\"import_statements\"><a href=\"#import_statements\">&lt;import_statements&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>If your script uses one or more Pine Script\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">libraries</a>, your\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_import\">import</a>\nstatements belong here.</p>\n<h3 class=\"md-heading\" id=\"constant_declarations\"><a href=\"#constant_declarations\">&lt;constant_declarations&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Scripts can declare variables qualified as \u201cconst\u201d, i.e., ones\nreferencing a constant value.</p>\n<p>We refer to variables as \u201cconstants\u201d when they meet these criteria:</p>\n<ul>\n<li>Their declaration uses the optional <code dir=\"auto\">const</code> keyword (see our User\nManual\u2019s section on\n<a href=\"/pine-script-docs/v5/language/type-system/#qualifiers\">type qualifiers</a> for more information).</li>\n<li>They are initialized using a literal (e.g., <code dir=\"auto\">100</code> or <code dir=\"auto\">\"AAPL\"</code>) or a\nbuilt-in qualified as \u201cconst\u201d (e.g., <code dir=\"auto\">color.green</code>).</li>\n<li>Their value does not change during the script\u2019s execution.</li>\n</ul>\n<p>We use <code dir=\"auto\">SNAKE_CASE</code> to name these variables and group their declaration\nnear the top of the script. For example:</p>\n<div class=\"pine-colorizer not-content\">// \u2014\u2014\u2014\u2014\u2014 Constants\nint     MS_IN_MIN   = 60 * 1000\nint     MS_IN_HOUR  = MS_IN_MIN  * 60\nint     MS_IN_DAY   = MS_IN_HOUR * 24\n\ncolor   GRAY        = #808080ff\ncolor   LIME        = #00FF00ff\ncolor   MAROON      = #800000ff\ncolor   ORANGE      = #FF8000ff\ncolor   PINK        = #FF0080ff\ncolor   TEAL        = #008080ff\ncolor   BG_DIV      = color.new(ORANGE, 90)\ncolor   BG_RESETS   = color.new(GRAY, 90)\n\nstring  RST1        = \"No reset; cumulate since the beginning of the chart\"\nstring  RST2        = \"On a stepped higher timeframe (HTF)\"\nstring  RST3        = \"On a fixed HTF\"\nstring  RST4        = \"At a fixed time\"\nstring  RST5        = \"At the beginning of the regular session\"\nstring  RST6        = \"At the first visible chart bar\"\nstring  RST7        = \"Fixed rolling period\"\n\nstring  LTF1        = \"Least precise, covering many chart bars\"\nstring  LTF2        = \"Less precise, covering some chart bars\"\nstring  LTF3        = \"More precise, covering less chart bars\"\nstring  LTF4        = \"Most precise, 1min intrabars\"\n\nstring  TT_TOTVOL     = \"The 'Bodies' value is the transparency of the total volume candle bodies. Zero is opaque, 100 is transparent.\"\nstring  TT_RST_HTF    = \"This value is used when '\" + RST3 +\"' is selected.\"\nstring  TT_RST_TIME   = \"These values are used when '\" + RST4 +\"' is selected.\n  A reset will occur when the time is greater or equal to the bar's open time, and less than its close time.\\nHour: 0-23\\nMinute: 0-59\"\nstring  TT_RST_PERIOD = \"This value is used when '\" + RST7 +\"' is selected.\"</div>\n<p>In this example:</p>\n<ul>\n<li>The <code dir=\"auto\">RST*</code> and <code dir=\"auto\">LTF*</code> constants will be used as tuple elements in\nthe <code dir=\"auto\">options</code> argument of <code dir=\"auto\">input.*()</code> calls.</li>\n<li>The <code dir=\"auto\">TT_*</code> constants will be used as <code dir=\"auto\">tooltip</code> arguments in\n<code dir=\"auto\">input.*()</code> calls. Note how we use a line continuation for long\nstring literals.</li>\n<li>We do not use\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nto initialize constants. The Pine Script runtime is optimized to\nhandle declarations on each bar, but using\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nto initialize a variable only the first time it is declared incurs a\nminor penalty on script performance because of the maintenance that\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_var\">var</a>\nvariables require on further bars.</li>\n</ul>\n<p>Note that:</p>\n<ul>\n<li>Literals used in more than one place in a script should always be\ndeclared as a constant. Using the constant rather than the literal\nmakes it more readable if it is given a meaningful name, and the\npractice makes code easier to maintain. Even though the quantity of\nmilliseconds in a day is unlikely to change in the future,\n<code dir=\"auto\">MS_IN_DAY</code> is more meaningful than <code dir=\"auto\">1000 * 60 * 60 * 24</code>.</li>\n<li>Constants only used in the local block of a function or\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_if\">if</a>,\n<a href=\"https://www.tradingview.com/pine-script-reference/v5/#kw_while\">while</a>,\netc., statement for example, can be declared in that local block.</li>\n</ul>\n<h3 class=\"md-heading\" id=\"inputs\"><a href=\"#inputs\">&lt;inputs&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>It is <strong>much</strong> easier to read scripts when all their inputs are in the\nsame code section. Placing that section at the beginning of the script\nalso reflects how they are processed at runtime, i.e., before the rest\nof the script is executed.</p>\n<p>Suffixing input variable names with <code dir=\"auto\">input</code> makes them more readily\nidentifiable when they are used later in the script: <code dir=\"auto\">maLengthInput</code>,\n<code dir=\"auto\">bearColorInput</code>, <code dir=\"auto\">showAvgInput</code>, etc.</p>\n<div class=\"pine-colorizer not-content\">// \u2014\u2014\u2014\u2014\u2014 Inputs\nstring  resetInput              = input.string(RST2,        \"CVD Resets\",                       inline = \"00\", options = [RST1, RST2, RST3, RST4, RST5, RST6, RST7])\nstring  fixedTfInput            = input.timeframe(\"D\",      \"\u2003\u2003Fixed HTF:\u2003\u2003\",                   tooltip = TT_RST_HTF)\nint     hourInput               = input.int(9,              \"\u2003\u2003Fixed time hour:\u2009\u2009\",             inline = \"01\", minval = 0, maxval = 23)\nint     minuteInput             = input.int(30,             \"minute\",                           inline = \"01\", minval = 0, maxval = 59, tooltip = TT_RST_TIME)\nint     fixedPeriodInput        = input.int(20,             \"\u2003\u2003Fixed period:\u2003\u2003\",                inline = \"02\", minval = 1, tooltip = TT_RST_PERIOD)\nstring  ltfModeInput            = input.string(LTF3,        \"Intrabar precision\",               inline = \"03\", options = [LTF1, LTF2, LTF3, LTF4])</div>\n<h3 class=\"md-heading\" id=\"function_declarations\"><a href=\"#function_declarations\">&lt;function_declarations&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>All user-defined functions must be defined in the script\u2019s global\nscope; nested function definitions are not allowed in Pine Script.</p>\n<p>Optimal function design should minimize the use of global variables in\nthe function\u2019s scope, as they undermine function portability. When it\ncan\u2019t be avoided, those functions must follow the global variable\ndeclarations in the code, which entails they can\u2019t always be placed in\nthe &lt;function_declarations&gt; section. Such dependencies on global\nvariables should ideally be documented in the function\u2019s comments.</p>\n<p>It will also help readers if you document the function\u2019s objective,\nparameters and result. The same syntax used in\n<a href=\"/pine-script-docs/v5/concepts/libraries/\">libraries</a> can be used to\ndocument your functions. This can make it easier to port your functions\nto a library should you ever decide to do so:</p>\n<div class=\"pine-colorizer not-content\">//@version=5\nindicator(\"&lt;function_declarations&gt;\", \"\", true)\n\nstring SIZE_LARGE  = \"Large\"\nstring SIZE_NORMAL = \"Normal\"\nstring SIZE_SMALL  = \"Small\"\n\nstring sizeInput = input.string(SIZE_NORMAL, \"Size\", options = [SIZE_LARGE, SIZE_NORMAL, SIZE_SMALL])\n\n// @function        Used to produce an argument for the `size` parameter in built-in functions.\n// @param userSize  (simple string) User-selected size.\n// @returns         One of the `size.*` built-in constants.\n// Dependencies     SIZE_LARGE, SIZE_NORMAL, SIZE_SMALL\ngetSize(simple string userSize) =&gt;\n    result = \n      switch userSize\n        SIZE_LARGE  =&gt; size.large\n        SIZE_NORMAL =&gt; size.normal\n        SIZE_SMALL  =&gt; size.small\n        =&gt; size.auto\n\nif ta.rising(close, 3)\n    label.new(bar_index, na, yloc = yloc.abovebar, style = label.style_arrowup, size = getSize(sizeInput))</div>\n<h3 class=\"md-heading\" id=\"calculations\"><a href=\"#calculations\">&lt;calculations&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This is where the script\u2019s core calculations and logic should be\nplaced. Code can be easier to read when variable declarations are placed\nnear the code segment using the variables. Some programmers prefer to\nplace all their non-constant variable declarations at the beginning of\nthis section, which is not always possible for all variables, as some\nmay require some calculations to have been executed before their\ndeclaration.</p>\n<h3 class=\"md-heading\" id=\"strategy_calls\"><a href=\"#strategy_calls\">&lt;strategy_calls&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Strategies are easier to read when strategy calls are grouped in the\nsame section of the script.</p>\n<h3 class=\"md-heading\" id=\"visuals\"><a href=\"#visuals\">&lt;visuals&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>This section should ideally include all the statements producing the\nscript\u2019s visuals, whether they be plots, drawings, background colors,\ncandle-plotting, etc. See the Pine Script user manual\u2019s section on\n<a href=\"/pine-script-docs/v5/concepts/colors/#z-index\">here</a> for more\ninformation on how the relative depth of visuals is determined.</p>\n<h3 class=\"md-heading\" id=\"alerts\"><a href=\"#alerts\">&lt;alerts&gt;<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h3>\n<p>Alert code will usually require the script\u2019s calculations to have\nexecuted before it, so it makes sense to put it at the end of the\nscript.</p>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:4", "segment_order": 4, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"spacing\"><a href=\"#spacing\">Spacing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>A space should be used on both sides of all operators, except unary\noperators (<code dir=\"auto\">-1</code>). A space is also recommended after all commas and when\nusing named function arguments, as in <code dir=\"auto\">plot(series = close)</code>:</p>\n<div class=\"pine-colorizer not-content\">int a = close &gt; open ? 1 : -1\nvar int newLen = 2\nnewLen := min(20, newlen + 1)\nfloat a = -b\nfloat c = d &gt; e ? d - e : d\nint index = bar_index % 2 == 0 ? 1 : 2\nplot(close, color = color.red)</div>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:5", "segment_order": 5, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"line-wrapping\"><a href=\"#line-wrapping\">Line wrapping<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Line wrapping can make long lines easier to read. Line wraps are defined\nby using an indentation level that is not a multiple of four, as four\nspaces or a tab are used to define local blocks. Here we use two spaces:</p>\n<div class=\"pine-colorizer not-content\">plot(\n   series = close,\n   title = \"Close\",\n   color = color.blue,\n   show_last = 10\n )</div>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:6", "segment_order": 6, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"vertical-alignment\"><a href=\"#vertical-alignment\">Vertical alignment<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Vertical alignment using tabs or spaces can be useful in code sections\ncontaining many similar lines such as constant declarations or inputs.\nThey can make mass edits much easier using the Pine Editor\u2019s\nmulti-cursor feature (<code dir=\"auto\">ctrl</code> +\n<code dir=\"auto\">alt</code> + <code dir=\"auto\">\ud83e\udc05</code>):</p>\n<div class=\"pine-colorizer not-content\">// Colors used as defaults in inputs.\ncolor COLOR_AQUA  = #0080FFff\ncolor COLOR_BLACK = #000000ff\ncolor COLOR_BLUE  = #013BCAff\ncolor COLOR_CORAL = #FF8080ff\ncolor COLOR_GOLD  = #CCCC00ff</div>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:7", "segment_order": 7, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
{"anchor_id": null, "canonical_url": "https://www.tradingview.com/pine-script-docs/v5/writing/style-guide", "doc_type": "guide", "pine_version": "v5", "raw_html": "<h2 class=\"md-heading\" id=\"explicit-typing\"><a href=\"#explicit-typing\">Explicit typing<span aria-hidden=\"true\" class=\"icon icon-link\"><svg height=\"28\" viewbox=\"0 0 28 28\" width=\"28\"><g clip-path=\"url(#a)\" fill=\"currentColor\"><path d=\"M14.908 5.558a5.326 5.326 0 1 1 7.533 7.533l-3.236 3.236-1.061-1.061 3.236-3.236a3.826 3.826 0 1 0-5.411-5.411l-3.236 3.236-1.06-1.06 3.235-3.237ZM5.56 14.907a5.326 5.326 0 0 0 7.532 7.533l3.236-3.236-1.061-1.061-3.236 3.236a3.826 3.826 0 1 1-5.411-5.411l3.236-3.236-1.061-1.06-3.236 3.235Z\"></path><path d=\"m16.346 10.592-5.753 5.753 1.061 1.06 5.753-5.752-1.06-1.06Z\"></path></g><defs><clippath id=\"a\"><path d=\"M0 0h28v28H0z\" fill=\"#fff\"></path></clippath></defs></svg></span></a></h2>\n<p>Including the type of variables when declaring them is not required.\nHowever, it helps make scripts easier to read, navigate, and understand.\nIt can help clarify the expected types at each point in a script\u2019s\nexecution and distinguish a variable\u2019s declaration (using <code dir=\"auto\">=</code>) from its\nreassignments (using <code dir=\"auto\">:=</code>). Using explicit typing can also make scripts\neasier to <a href=\"/pine-script-docs/v5/writing/debugging/\">debug</a>.</p>", "segment_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f:8", "segment_order": 8, "segment_type": "guide_section", "source_artifact_id": "6abbae8634af3856b305ac387eaf9c57e3de79a3501c62a7212c7e3f1f7f0a7f", "symbol_name": null, "symbol_type": null}
